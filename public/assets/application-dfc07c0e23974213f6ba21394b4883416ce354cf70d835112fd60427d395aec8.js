function UploadManager(t){var e=this;e.dropContainer=t.dropContainer,e.inputField=t.inputField,e.cancelContainer=t.cancelContainer,e.uploadsQueue=[],e._xhrs=[],e.activeUploads=0,e.data=t.data,e.key=t.key,e.maxSimultaneousUploads=t.maxSimultaneousUploads||-1,e.onFileAdded=t.onFileAdded||noop,e.uploadUrl=t.uploadUrl,e.onFileAddedProxy=function(t){console.log("Event: onFileAdded, file: "+t.fileName),e.onFileAdded(t)},e.initialize()}function FileUpload(e){var i=this;i.file=e,i.fileName=e.name,i.fileSize=e.size,i.uploadSize=e.size,i.uploadedBytes=0,i.eventHandlers={},i.events={onProgress:function(t,e){var n=e/t*100;console.log("Event: upload onProgress, progress = "+n+", fileSize = "+t+", uploadedBytes = "+e),(i.eventHandlers.onProgress||noop)(n,t,e)},onStart:function(){console.log("Event: upload onStart"),(i.eventHandlers.onStart||noop)()},onAborted:function(){console.log("Event: upload onAborted"),(i.eventHandlers.onAborted||noop)()},onCompleted:function(t){console.log("Event: upload onCompleted, data = "+t),e=null,(i.eventHandlers.onCompleted||noop)(t)}}}function escapeRegExp(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function difference(t,e){var n={};for(var i in t)if(i in e)if(_.isObject(e[i])&&!_.isArray(e[i])){var s=difference(t[i],e[i]);_.isEmpty(s)||(n[i]=s)}else _.isEqual(t[i],e[i])||(n[i]=e[i]);return n}function byteLength(t){for(var e=t.length,n=t.length-1;0<=n;n--){var i=t.charCodeAt(n);127<i&&i<=2047?e++:2047<i&&i<=65535&&(e+=2),56320<=i&&i<=57343&&n--}return e}function clone(t,n){if(!t)return t;var e=t.constructor.name;e===undefined&&(_.isArray(t)?e="Array":_.isNumber(t)?e="Number":_.isString(t)?e="String":_.isBoolean(t)?e="Boolean":_.isFunction(t)?e="Function":_.isObject(t)&&(e="Object"));var i,s=["Object","Number","String","Boolean","Array"];if(n&&s.push("Function"),e&&!_.contains(s,e))return console.log("no acceptedInstances",e,t),void console.trace();if("Array"==e)i=[],t.forEach(function(t,e){i[e]=clone(t,n)});else if("Function"==e)i=t.bind({});else if("Object"==e)for(var r in i={},t)t.hasOwnProperty(r)&&(i[r]=clone(t[r],n));else i=t;return i}function underscored(t){return t.trim().replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()}function toCamelCase(t){return t.replace(/\s(.)/g,function(t){return t.toUpperCase()}).replace(/\s/g,"").replace(/^(.)/,function(t){return t.toUpperCase()})}function isRetina(){if(window.matchMedia){var t=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");return t&&t.matches||1<window.devicePixelRatio}}!function(t,e){"object"!=typeof module||"object"!=typeof module.exports||window.process&&window.process.version&&window.process.versions.electron?e(t):module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}}("undefined"!=typeof window?window:this,function(T,t){function a(t){var e=!!t&&"length"in t&&t.length,n=rt.type(t);return"function"!==n&&!rt.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&0<e&&e-1 in t)}function e(t,n,i){if(rt.isFunction(n))return rt.grep(t,function(t,e){return!!n.call(t,e,t)!==i});if(n.nodeType)return rt.grep(t,function(t){return t===n!==i});if("string"==typeof n){if(mt.test(n))return rt.filter(n,t,i);n=rt.filter(n,t)}return rt.grep(t,function(t){return-1<Q.call(n,t)!==i})}function n(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function p(t){var n={};return rt.each(t.match(wt)||[],function(t,e){n[e]=!0}),n}function i(){V.removeEventListener("DOMContentLoaded",i),T.removeEventListener("load",i),rt.ready()}function s(){this.expando=rt.expando+s.uid++}function l(t,e,n){var i;if(n===undefined&&1===t.nodeType)if(i="data-"+e.replace(xt,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:Ct.test(n)?rt.parseJSON(n):n)}catch(s){}St.set(t,e,n)}else n=undefined;return n}function c(t,e,n,i){var s,r=1,o=20,a=i?function(){return i.cur()}:function(){return rt.css(t,e,"")},l=a(),c=n&&n[3]||(rt.cssNumber[e]?"":"px"),p=(rt.cssNumber[e]||"px"!==c&&+l)&&Pt.exec(rt.css(t,e));if(p&&p[3]!==c)for(c=c||p[3],n=n||[],p=+l||1;p/=r=r||".5",rt.style(t,e,p+c),r!==(r=a()/l)&&1!==r&&--o;);return n&&(p=+p||+l||0,s=n[1]?p+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=p,i.end=s)),s}function m(t,e){var n="undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!=typeof t.querySelectorAll?t.querySelectorAll(e||"*"):[];return e===undefined||e&&rt.nodeName(t,e)?rt.merge([t],n):n}function g(t,e){for(var n=0,i=t.length;n<i;n++)At.set(t[n],"globalEval",!e||At.get(e[n],"globalEval"))}function v(t,e,n,i,s){for(var r,o,a,l,c,p,u=e.createDocumentFragment(),h=[],d=0,f=t.length;d<f;d++)if((r=t[d])||0===r)if("object"===rt.type(r))rt.merge(h,r.nodeType?[r]:r);else if(Lt.test(r)){for(o=o||u.appendChild(e.createElement("div")),a=(Ot.exec(r)||["",""])[1].toLowerCase(),l=Rt[a]||Rt._default,o.innerHTML=l[1]+rt.htmlPrefilter(r)+l[2],p=l[0];p--;)o=o.lastChild;rt.merge(h,o.childNodes),(o=u.firstChild).textContent=""}else h.push(e.createTextNode(r));for(u.textContent="",d=0;r=h[d++];)if(i&&-1<rt.inArray(r,i))s&&s.push(r);else if(c=rt.contains(r.ownerDocument,r),o=m(u.appendChild(r),"script"),c&&g(o),n)for(p=0;r=o[p++];)Nt.test(r.type||"")&&n.push(r);return u}function r(){return!0}function u(){return!1}function o(){try{return V.activeElement}catch(t){}}function h(t,e,n,i,s,r){var o,a;if("object"==typeof e){for(a in"string"!=typeof n&&(i=i||n,n=undefined),e)h(t,a,n,i,e[a],r);return t}if(null==i&&null==s?(s=n,i=n=undefined):null==s&&("string"==typeof n?(s=i,i=undefined):(s=i,i=n,n=undefined)),!1===s)s=u;else if(!s)return t;return 1===r&&(o=s,(s=function(t){return rt().off(t),o.apply(this,arguments)}).guid=o.guid||(o.guid=rt.guid++)),t.each(function(){rt.event.add(this,e,s,i,n)})}function d(t,e){return rt.nodeName(t,"table")&&rt.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function y(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function b(t){var e=Ht.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function f(t,e){var n,i,s,r,o,a,l,c;if(1===e.nodeType){if(At.hasData(t)&&(r=At.access(t),o=At.set(e,r),c=r.events))for(s in delete o.handle,o.events={},c)for(n=0,i=c[s].length;n<i;n++)rt.event.add(e,s,c[s][n]);St.hasData(t)&&(a=St.access(t),l=rt.extend({},a),St.set(e,l))}}function _(t,e){var n=e.nodeName.toLowerCase();"input"===n&&Dt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function w(n,i,s,r){i=X.apply([],i);var t,e,o,a,l,c,p=0,u=n.length,h=u-1,d=i[0],f=rt.isFunction(d);if(f||1<u&&"string"==typeof d&&!it.checkClone&&Jt.test(d))return n.each(function(t){var e=n.eq(t);f&&(i[0]=d.call(this,t,e.html())),w(e,i,s,r)});if(u&&(e=(t=v(i,n[0].ownerDocument,!1,n,r)).firstChild,1===t.childNodes.length&&(t=e),e||r)){for(a=(o=rt.map(m(t,"script"),y)).length;p<u;p++)l=t,p!==h&&(l=rt.clone(l,!0,!0),a&&rt.merge(o,m(l,"script"))),s.call(n[p],l,p);if(a)for(c=o[o.length-1].ownerDocument,rt.map(o,b),p=0;p<a;p++)l=o[p],Nt.test(l.type||"")&&!At.access(l,"globalEval")&&rt.contains(c,l)&&(l.src?rt._evalUrl&&rt._evalUrl(l.src):rt.globalEval(l.textContent.replace(Wt,"")))}return n}function k(t,e,n){for(var i,s=e?rt.filter(e,t):t,r=0;null!=(i=s[r]);r++)n||1!==i.nodeType||rt.cleanData(m(i)),i.parentNode&&(n&&rt.contains(i.ownerDocument,i)&&g(m(i,"script")),i.parentNode.removeChild(i));return t}function A(t,e){var n=rt(e.createElement(t)).appendTo(e.body),i=rt.css(n[0],"display");return n.detach(),i}function S(t){var e=V,n=Kt[t];return n||("none"!==(n=A(t,e))&&n||((e=(Gt=(Gt||rt("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),n=A(t,e),Gt.detach()),Kt[t]=n),n}function C(t,e,n){var i,s,r,o,a=t.style;return""!==(o=(n=n||Xt(t))?n.getPropertyValue(e)||n[e]:undefined)&&o!==undefined||rt.contains(t.ownerDocument,t)||(o=rt.style(t,e)),n&&!it.pixelMarginRight()&&Yt.test(o)&&Vt.test(e)&&(i=a.width,s=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=n.width,a.width=i,a.minWidth=s,a.maxWidth=r),o!==undefined?o+"":o}function x(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}function j(t){if(t in se)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=ie.length;n--;)if((t=ie[n]+e)in se)return t}function P(t,e,n){var i=Pt.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function I(t,e,n,i,s){for(var r=n===(i?"border":"content")?4:"width"===e?1:0,o=0;r<4;r+=2)"margin"===n&&(o+=rt.css(t,n+It[r],!0,s)),i?("content"===n&&(o-=rt.css(t,"padding"+It[r],!0,s)),"margin"!==n&&(o-=rt.css(t,"border"+It[r]+"Width",!0,s))):(o+=rt.css(t,"padding"+It[r],!0,s),"padding"!==n&&(o+=rt.css(t,"border"+It[r]+"Width",!0,s)));return o}function E(t,e,n){var i=!0,s="width"===e?t.offsetWidth:t.offsetHeight,r=Xt(t),o="border-box"===rt.css(t,"boxSizing",!1,r);if(V.msFullscreenElement&&T.top!==T&&t.getClientRects().length&&(s=Math.round(100*t.getBoundingClientRect()[e])),s<=0||null==s){if(((s=C(t,e,r))<0||null==s)&&(s=t.style[e]),Yt.test(s))return s;i=o&&(it.boxSizingReliable()||s===t.style[e]),s=parseFloat(s)||0}return s+I(t,e,n||(o?"border":"content"),i,r)+"px"}function D(t,e){for(var n,i,s,r=[],o=0,a=t.length;o<a;o++)(i=t[o]).style&&(r[o]=At.get(i,"olddisplay"),n=i.style.display,e?(r[o]||"none"!==n||(i.style.display=""),""===i.style.display&&Et(i)&&(r[o]=At.access(i,"olddisplay",S(i.nodeName)))):(s=Et(i),"none"===n&&s||At.set(i,"olddisplay",s?n:rt.css(i,"display"))));for(o=0;o<a;o++)(i=t[o]).style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?r[o]||"":"none"));return t}function O(t,e,n,i,s){return new O.prototype.init(t,e,n,i,s)}function N(){return T.setTimeout(function(){re=undefined}),re=rt.now()}function R(t,e){var n,i=0,s={height:t};for(e=e?1:0;i<4;i+=2-e)s["margin"+(n=It[i])]=s["padding"+n]=t;return e&&(s.opacity=s.width=t),s}function M(t,e,n){for(var i,s=(U.tweeners[e]||[]).concat(U.tweeners["*"]),r=0,o=s.length;r<o;r++)if(i=s[r].call(n,e,t))return i}function $(e,t,n){var i,s,r,o,a,l,c,p=this,u={},h=e.style,d=e.nodeType&&Et(e),f=At.get(e,"fxshow");for(i in n.queue||(null==(a=rt._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,rt.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],"inline"===("none"===(c=rt.css(e,"display"))?At.get(e,"olddisplay")||S(e.nodeName):c)&&"none"===rt.css(e,"float")&&(h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),t)if(s=t[i],pe.exec(s)){if(delete t[i],r=r||"toggle"===s,s===(d?"hide":"show")){if("show"!==s||!f||f[i]===undefined)continue;d=!0}u[i]=f&&f[i]||rt.style(e,i)}else c=undefined;if(rt.isEmptyObject(u))"inline"===("none"===c?S(e.nodeName):c)&&(h.display=c);else for(i in f?"hidden"in f&&(d=f.hidden):f=At.access(e,"fxshow",{}),r&&(f.hidden=!d),d?rt(e).show():p.done(function(){rt(e).hide()}),p.done(function(){var t;for(t in At.remove(e,"fxshow"),u)rt.style(e,t,u[t])}),u)o=M(d?f[i]:0,i,p),i in f||(f[i]=o.start,d&&(o.end=o.start,o.start="width"===i||"height"===i?1:0))}function L(t,e){var n,i,s,r,o;for(n in t)if(s=e[i=rt.camelCase(n)],r=t[n],rt.isArray(r)&&(s=r[1],r=t[n]=r[0]),n!==i&&(t[i]=r,delete t[n]),(o=rt.cssHooks[i])&&"expand"in o)for(n in r=o.expand(r),delete t[i],r)n in t||(t[n]=r[n],e[n]=s);else e[i]=s}function U(r,t,e){var n,o,i=0,s=U.prefilters.length,a=rt.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var t=re||N(),e=Math.max(0,c.startTime+c.duration-t),n=1-(e/c.duration||0),i=0,s=c.tweens.length;i<s;i++)c.tweens[i].run(n);return a.notifyWith(r,[c,n,e]),n<1&&s?e:(a.resolveWith(r,[c]),!1)},c=a.promise({elem:r,props:rt.extend({},t),opts:rt.extend(!0,{specialEasing:{},easing:rt.easing._default},e),originalProperties:t,originalOptions:e,startTime:re||N(),duration:e.duration,tweens:[],createTween:function(t,e){var n=rt.Tween(r,c.opts,t,e,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var e=0,n=t?c.tweens.length:0;if(o)return this;for(o=!0;e<n;e++)c.tweens[e].run(1);return t?(a.notifyWith(r,[c,1,0]),a.resolveWith(r,[c,t])):a.rejectWith(r,[c,t]),this}}),p=c.props;for(L(p,c.opts.specialEasing);i<s;i++)if(n=U.prefilters[i].call(c,r,p,c.opts))return rt.isFunction(n.stop)&&(rt._queueHooks(c.elem,c.opts.queue).stop=rt.proxy(n.stop,n)),n;return rt.map(p,M,c),rt.isFunction(c.opts.start)&&c.opts.start.call(r,c),rt.fx.timer(rt.extend(l,{elem:r,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function z(t){return t.getAttribute&&t.getAttribute("class")||""}function B(r){return function(t,e){"string"!=typeof t&&(e=t,t="*");var n,i=0,s=t.toLowerCase().match(wt)||[];if(rt.isFunction(e))for(;n=s[i++];)"+"===n[0]?(n=n.slice(1)||"*",(r[n]=r[n]||[]).unshift(e)):(r[n]=r[n]||[]).push(e)}}function F(e,s,r,o){function a(t){var i;return l[t]=!0,rt.each(e[t]||[],function(t,e){var n=e(s,r,o);return"string"!=typeof n||c||l[n]?c?!(i=n):void 0:(s.dataTypes.unshift(n),a(n),!1)}),i}var l={},c=e===Pe;return a(s.dataTypes[0])||!l["*"]&&a("*")}function q(t,e){var n,i,s=rt.ajaxSettings.flatOptions||{};for(n in e)e[n]!==undefined&&((s[n]?t:i||(i={}))[n]=e[n]);return i&&rt.extend(!0,t,i),t}function J(t,e,n){for(var i,s,r,o,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),i===undefined&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){l.unshift(s);break}if(l[0]in n)r=l[0];else{for(s in n){if(!l[0]||t.converters[s+" "+l[0]]){r=s;break}o||(o=s)}r=r||o}if(r)return r!==l[0]&&l.unshift(r),n[r]}function H(t,e,n,i){var s,r,o,a,l,c={},p=t.dataTypes.slice();if(p[1])for(o in t.converters)c[o.toLowerCase()]=t.converters[o];for(r=p.shift();r;)if(t.responseFields[r]&&(n[t.responseFields[r]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=p.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(o=c[l+" "+r]||c["* "+r]))for(s in c)if((a=s.split(" "))[1]===r&&(o=c[l+" "+a[0]]||c["* "+a[0]])){!0===o?o=c[s]:!0!==c[s]&&(r=a[0],p.unshift(a[1]));break}if(!0!==o)if(o&&t["throws"])e=o(e);else try{e=o(e)}catch(u){return{state:"parsererror",error:o?u:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}function W(n,t,i,s){var e;if(rt.isArray(t))rt.each(t,function(t,e){i||Oe.test(n)?s(n,e):W(n+"["+("object"==typeof e&&null!=e?t:"")+"]",e,i,s)});else if(i||"object"!==rt.type(t))s(n,t);else for(e in t)W(n+"["+e+"]",t[e],i,s)}function G(t){return rt.isWindow(t)?t:9===t.nodeType&&t.defaultView}var K=[],V=T.document,Y=K.slice,X=K.concat,Z=K.push,Q=K.indexOf,tt={},et=tt.toString,nt=tt.hasOwnProperty,it={},st="2.2.1",rt=function(t,e){return new rt.fn.init(t,e)},ot=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,at=/^-ms-/,lt=/-([\da-z])/gi,ct=function(t,e){return e.toUpperCase()};rt.fn=rt.prototype={jquery:st,constructor:rt,selector:"",length:0,toArray:function(){return Y.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:Y.call(this)},pushStack:function(t){var e=rt.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return rt.each(this,t)},map:function(n){return this.pushStack(rt.map(this,function(t,e){return n.call(t,e,t)}))},slice:function(){return this.pushStack(Y.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(0<=n&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:Z,sort:K.sort,splice:K.splice},rt.extend=rt.fn.extend=function(t){var e,n,i,s,r,o,a=t||{},l=1,c=arguments.length,p=!1;for("boolean"==typeof a&&(p=a,a=arguments[l]||{},l++),"object"==typeof a||rt.isFunction(a)||(a={}),l===c&&(a=this,l--);l<c;l++)if(null!=(e=arguments[l]))for(n in e)i=a[n],a!==(s=e[n])&&(p&&s&&(rt.isPlainObject(s)||(r=rt.isArray(s)))?(r?(r=!1,o=i&&rt.isArray(i)?i:[]):o=i&&rt.isPlainObject(i)?i:{},a[n]=rt.extend(p,o,s)):s!==undefined&&(a[n]=s));return a},rt.extend({expando:"jQuery"+(st+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===rt.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=t&&t.toString();return!rt.isArray(t)&&0<=e-parseFloat(e)+1},isPlainObject:function(t){return"object"===rt.type(t)&&!t.nodeType&&!rt.isWindow(t)&&!(t.constructor&&!nt.call(t.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?tt[et.call(t)]||"object":typeof t},globalEval:function(t){var e,n=eval;(t=rt.trim(t))&&(1===t.indexOf("use strict")?((e=V.createElement("script")).text=t,V.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(at,"ms-").replace(lt,ct)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var n,i=0;if(a(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},trim:function(t){return null==t?"":(t+"").replace(ot,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(a(Object(t))?rt.merge(n,"string"==typeof t?[t]:t):Z.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:Q.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,s=t.length;i<n;i++)t[s++]=e[i];return t.length=s,t},grep:function(t,e,n){for(var i=[],s=0,r=t.length,o=!n;s<r;s++)!e(t[s],s)!==o&&i.push(t[s]);return i},map:function(t,e,n){var i,s,r=0,o=[];if(a(t))for(i=t.length;r<i;r++)null!=(s=e(t[r],r,n))&&o.push(s);else for(r in t)null!=(s=e(t[r],r,n))&&o.push(s);return X.apply([],o)},guid:1,proxy:function(t,e){var n,i,s;return"string"==typeof e&&(n=t[e],e=t,t=n),rt.isFunction(t)?(i=Y.call(arguments,2),(s=function(){return t.apply(e||this,i.concat(Y.call(arguments)))}).guid=t.guid=t.guid||rt.guid++,s):undefined},now:Date.now,support:it}),"function"==typeof Symbol&&(rt.fn[Symbol.iterator]=K[Symbol.iterator]),rt.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){tt["[object "+e+"]"]=e.toLowerCase()});var pt=function(n){function _(t,e,n,i){var s,r,o,a,l,c,p,u,h=e&&e.ownerDocument,d=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==d&&9!==d&&11!==d)return n;if(!i&&((e?e.ownerDocument||e:z)!==D&&E(e),e=e||D,N)){if(11!==d&&(c=vt.exec(t)))if(s=c[1]){if(9===d){if(!(o=e.getElementById(s)))return n;if(o.id===s)return n.push(o),n}else if(h&&(o=h.getElementById(s))&&L(e,o)&&o.id===s)return n.push(o),n}else{if(c[2])return Z.apply(n,e.getElementsByTagName(t)),n;if((s=c[3])&&v.getElementsByClassName&&e.getElementsByClassName)return Z.apply(n,e.getElementsByClassName(s)),n}if(v.qsa&&!H[t+" "]&&(!R||!R.test(t))){if(1!==d)h=e,u=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(bt,"\\$&"):e.setAttribute("id",a=U),r=(p=S(t)).length,l=ht.test(a)?"#"+a:"[id='"+a+"']";r--;)p[r]=l+" "+g(p[r]);u=p.join(","),h=yt.test(t)&&m(e.parentNode)||e}if(u)try{return Z.apply(n,h.querySelectorAll(u)),n}catch(f){}finally{a===U&&e.removeAttribute("id")}}}return x(t.replace(at,"$1"),e,n,i)}function t(){function n(t,e){return i.push(t+" ")>k.cacheLength&&delete n[i.shift()],n[t+" "]=e}var i=[];return n}function l(t){return t[U]=!0,t}function s(t){var e=D.createElement("div");try{return!!t(e)}catch(n){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function e(t,e){for(var n=t.split("|"),i=n.length;i--;)k.attrHandle[n[i]]=e}function c(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||G)-(~t.sourceIndex||G);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function i(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function r(n){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===n}}function o(o){return l(function(r){return r=+r,l(function(t,e){for(var n,i=o([],t.length,r),s=i.length;s--;)t[n=i[s]]&&(t[n]=!(e[n]=t[n]))})})}function m(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function a(){}function g(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function u(a,t,e){var l=t.dir,c=e&&"parentNode"===l,p=F++;return t.first?function(t,e,n){for(;t=t[l];)if(1===t.nodeType||c)return a(t,e,n)}:function(t,e,n){var i,s,r,o=[B,p];if(n){for(;t=t[l];)if((1===t.nodeType||c)&&a(t,e,n))return!0}else for(;t=t[l];)if(1===t.nodeType||c){if((i=(s=(r=t[U]||(t[U]={}))[t.uniqueID]||(r[t.uniqueID]={}))[l])&&i[0]===B&&i[1]===p)return o[2]=i[2];if((s[l]=o)[2]=a(t,e,n))return!0}}}function h(s){return 1<s.length?function(t,e,n){for(var i=s.length;i--;)if(!s[i](t,e,n))return!1;return!0}:s[0]}function y(t,e,n){for(var i=0,s=e.length;i<s;i++)_(t,e[i],n);return n}function w(t,e,n,i,s){for(var r,o=[],a=0,l=t.length,c=null!=e;a<l;a++)(r=t[a])&&(n&&!n(r,i,s)||(o.push(r),c&&e.push(a)));return o}function b(d,f,m,g,v,t){return g&&!g[U]&&(g=b(g)),v&&!v[U]&&(v=b(v,t)),l(function(t,e,n,i){var s,r,o,a=[],l=[],c=e.length,p=t||y(f||"*",n.nodeType?[n]:n,[]),u=!d||!t&&f?p:w(p,a,d,n,i),h=m?v||(t?d:c||g)?[]:e:u;if(m&&m(u,h,n,i),g)for(s=w(h,l),g(s,[],n,i),r=s.length;r--;)(o=s[r])&&(h[l[r]]=!(u[l[r]]=o));if(t){if(v||d){if(v){for(s=[],r=h.length;r--;)(o=h[r])&&s.push(u[r]=o);v(null,h=[],s,i)}for(r=h.length;r--;)(o=h[r])&&-1<(s=v?tt(t,o):a[r])&&(t[s]=!(e[s]=o))}}else h=w(h===e?h.splice(c,h.length):h),v?v(null,e,h,i):Z.apply(e,h)})}function d(t){for(var s,e,n,i=t.length,r=k.relative[t[0].type],o=r||k.relative[" "],a=r?1:0,l=u(function(t){return t===s},o,!0),c=u(function(t){return-1<tt(s,t)},o,!0),p=[function(t,e,n){var i=!r&&(n||e!==j)||((s=e).nodeType?l(t,e,n):c(t,e,n));return s=null,i}];a<i;a++)if(e=k.relative[t[a].type])p=[u(h(p),e)];else{if((e=k.filter[t[a].type].apply(null,t[a].matches))[U]){for(n=++a;n<i&&!k.relative[t[n].type];n++);return b(1<a&&h(p),1<a&&g(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(at,"$1"),e,a<n&&d(t.slice(a,n)),n<i&&d(t=t.slice(n)),n<i&&g(t))}p.push(e)}return h(p)}function p(g,v){var y=0<v.length,b=0<g.length,t=function(t,e,n,i,s){var r,o,a,l=0,c="0",p=t&&[],u=[],h=j,d=t||b&&k.find.TAG("*",s),f=B+=null==h?1:Math.random()||.1,m=d.length;for(s&&(j=e===D||e||s);c!==m&&null!=(r=d[c]);c++){if(b&&r){for(o=0,e||r.ownerDocument===D||(E(r),n=!N);a=g[o++];)if(a(r,e||D,n)){i.push(r);break}s&&(B=f)}y&&((r=!a&&r)&&l--,t&&p.push(r))}if(l+=c,y&&c!==l){for(o=0;a=v[o++];)a(p,u,e,n);if(t){if(0<l)for(;c--;)p[c]||u[c]||(u[c]=Y.call(i));u=w(u)}Z.apply(i,u),s&&!t&&0<u.length&&1<l+v.length&&_.uniqueSort(i)}return s&&(B=f,j=h),p};return y?l(t):t}var f,v,k,T,A,S,C,x,j,P,I,E,D,O,N,R,M,$,L,U="sizzle"+1*new Date,z=n.document,B=0,F=0,q=t(),J=t(),H=t(),W=function(t,e){return t===e&&(I=!0),0},G=1<<31,K={}.hasOwnProperty,V=[],Y=V.pop,X=V.push,Z=V.push,Q=V.slice,tt=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",st="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+it+"))|)"+nt+"*\\]",rt=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+st+")*)|.*)\\)|)",ot=new RegExp(nt+"+","g"),at=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),lt=new RegExp("^"+nt+"*,"+nt+"*"),ct=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),pt=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),ut=new RegExp(rt),ht=new RegExp("^"+it+"$"),dt={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it+"|[*])"),ATTR:new RegExp("^"+st),PSEUDO:new RegExp("^"+rt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},ft=/^(?:input|select|textarea|button)$/i,mt=/^h\d$/i,gt=/^[^{]+\{\s*\[native \w/,vt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,bt=/'|\\/g,_t=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),wt=function(t,e,n){var i="0x"+e-65536;return i!=i||n?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},kt=function(){E()};try{Z.apply(V=Q.call(z.childNodes),z.childNodes),V[z.childNodes.length].nodeType}catch(Tt){Z={apply:V.length?function(t,e){X.apply(t,Q.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}for(f in v=_.support={},A=_.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},E=_.setDocument=function(t){var e,n,i=t?t.ownerDocument||t:z;return i!==D&&9===i.nodeType&&i.documentElement&&(O=(D=i).documentElement,N=!A(D),(n=D.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",kt,!1):n.attachEvent&&n.attachEvent("onunload",kt)),v.attributes=s(function(t){return t.className="i",!t.getAttribute("className")}),v.getElementsByTagName=s(function(t){return t.appendChild(D.createComment("")),!t.getElementsByTagName("*").length}),v.getElementsByClassName=gt.test(D.getElementsByClassName),v.getById=s(function(t){return O.appendChild(t).id=U,!D.getElementsByName||!D.getElementsByName(U).length}),v.getById?(k.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&N){var n=e.getElementById(t);return n?[n]:[]}},k.filter.ID=function(t){var e=t.replace(_t,wt);return function(t){return t.getAttribute("id")===e}}):(delete k.find.ID,k.filter.ID=function(t){var n=t.replace(_t,wt);return function(t){var e="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return e&&e.value===n}}),k.find.TAG=v.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):v.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],s=0,r=e.getElementsByTagName(t);if("*"!==t)return r;for(;n=r[s++];)1===n.nodeType&&i.push(n);return i},k.find.CLASS=v.getElementsByClassName&&function(t,e){if("undefined"!=typeof e.getElementsByClassName&&N)return e.getElementsByClassName(t)},M=[],R=[],(v.qsa=gt.test(D.querySelectorAll))&&(s(function(t){O.appendChild(t).innerHTML="<a id='"+U+"'></a><select id='"+U+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&R.push("[*^$]="+nt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||R.push("\\["+nt+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+U+"-]").length||R.push("~="),t.querySelectorAll(":checked").length||R.push(":checked"),t.querySelectorAll("a#"+U+"+*").length||R.push(".#.+[+~]")}),s(function(t){var e=D.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&R.push("name"+nt+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||R.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),R.push(",.*:")})),(v.matchesSelector=gt.test($=O.matches||O.webkitMatchesSelector||O.mozMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&s(function(t){v.disconnectedMatch=$.call(t,"div"),$.call(t,"[s!='']:x"),M.push("!=",rt)}),R=R.length&&new RegExp(R.join("|")),M=M.length&&new RegExp(M.join("|")),e=gt.test(O.compareDocumentPosition),L=e||gt.test(O.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},W=e?function(t,e){if(t===e)return I=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!v.sortDetached&&e.compareDocumentPosition(t)===n?t===D||t.ownerDocument===z&&L(z,t)?-1:e===D||e.ownerDocument===z&&L(z,e)?1:P?tt(P,t)-tt(P,e):0:4&n?-1:1)}:function(t,e){if(t===e)return I=!0,0;var n,i=0,s=t.parentNode,r=e.parentNode,o=[t],a=[e];if(!s||!r)return t===D?-1:e===D?1:s?-1:r?1:P?tt(P,t)-tt(P,e):0;if(s===r)return c(t,e);for(n=t;n=n.parentNode;)o.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;o[i]===a[i];)i++;return i?c(o[i],a[i]):o[i]===z?-1:a[i]===z?1:0}),D},_.matches=function(t,e){return _(t,null,null,e)},_.matchesSelector=function(t,e){if((t.ownerDocument||t)!==D&&E(t),e=e.replace(pt,"='$1']"),v.matchesSelector&&N&&!H[e+" "]&&(!M||!M.test(e))&&(!R||!R.test(e)))try{var n=$.call(t,e);if(n||v.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(Tt){}return 0<_(e,D,null,[t]).length},_.contains=function(t,e){return(t.ownerDocument||t)!==D&&E(t),L(t,e)},_.attr=function(t,e){(t.ownerDocument||t)!==D&&E(t);var n=k.attrHandle[e.toLowerCase()],i=n&&K.call(k.attrHandle,e.toLowerCase())?n(t,e,!N):undefined;return i!==undefined?i:v.attributes||!N?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},_.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},_.uniqueSort=function(t){var e,n=[],i=0,s=0;if(I=!v.detectDuplicates,P=!v.sortStable&&t.slice(0),t.sort(W),I){for(;e=t[s++];)e===t[s]&&(i=n.push(s));for(;i--;)t.splice(n[i],1)}return P=null,t},T=_.getText=function(t){var e,n="",i=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=T(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[i++];)n+=T(e);return n},(k=_.selectors={cacheLength:50,createPseudo:l,match:dt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(_t,wt),t[3]=(t[3]||t[4]||t[5]||"").replace(_t,wt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||_.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&_.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return dt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&ut.test(n)&&(e=S(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(_t,wt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=q[t+" "];return e||(e=new RegExp("(^|"+nt+")"+t+"("+nt+"|$)"))&&q(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(n,i,s){return function(t){var e=_.attr(t,n);return null==e?"!="===i:!i||(e+="","="===i?e===s:"!="===i?e!==s:"^="===i?s&&0===e.indexOf(s):"*="===i?s&&-1<e.indexOf(s):"$="===i?s&&e.slice(-s.length)===s:"~="===i?-1<(" "+e.replace(ot," ")+" ").indexOf(s):"|="===i&&(e===s||e.slice(0,s.length+1)===s+"-"))}},CHILD:function(f,t,e,m,g){var v="nth"!==f.slice(0,3),y="last"!==f.slice(-4),b="of-type"===t;return 1===m&&0===g?function(t){return!!t.parentNode}:function(t,e,n){var i,s,r,o,a,l,c=v!==y?"nextSibling":"previousSibling",p=t.parentNode,u=b&&t.nodeName.toLowerCase(),h=!n&&!b,d=!1;if(p){if(v){for(;c;){for(o=t;o=o[c];)if(b?o.nodeName.toLowerCase()===u:1===o.nodeType)return!1;l=c="only"===f&&!l&&"nextSibling"}return!0}if(l=[y?p.firstChild:p.lastChild],y&&h){for(d=(a=(i=(s=(r=(o=p)[U]||(o[U]={}))[o.uniqueID]||(r[o.uniqueID]={}))[f]||[])[0]===B&&i[1])&&i[2],o=a&&p.childNodes[a];o=++a&&o&&o[c]||(d=a=0)||l.pop();)if(1===o.nodeType&&++d&&o===t){s[f]=[B,a,d];break}}else if(h&&(d=a=(i=(s=(r=(o=t)[U]||(o[U]={}))[o.uniqueID]||(r[o.uniqueID]={}))[f]||[])[0]===B&&i[1]),!1===d)for(;(o=++a&&o&&o[c]||(d=a=0)||l.pop())&&((b?o.nodeName.toLowerCase()!==u:1!==o.nodeType)||!++d||(h&&((s=(r=o[U]||(o[U]={}))[o.uniqueID]||(r[o.uniqueID]={}))[f]=[B,d]),o!==t)););return(d-=g)===m||d%m==0&&0<=d/m}}},PSEUDO:function(t,r){var e,o=k.pseudos[t]||k.setFilters[t.toLowerCase()]||_.error("unsupported pseudo: "+t)
;return o[U]?o(r):1<o.length?(e=[t,t,"",r],k.setFilters.hasOwnProperty(t.toLowerCase())?l(function(t,e){for(var n,i=o(t,r),s=i.length;s--;)t[n=tt(t,i[s])]=!(e[n]=i[s])}):function(t){return o(t,0,e)}):o}},pseudos:{not:l(function(t){var i=[],s=[],a=C(t.replace(at,"$1"));return a[U]?l(function(t,e,n,i){for(var s,r=a(t,null,i,[]),o=t.length;o--;)(s=r[o])&&(t[o]=!(e[o]=s))}):function(t,e,n){return i[0]=t,a(i,null,n,s),i[0]=null,!s.pop()}}),has:l(function(e){return function(t){return 0<_(e,t).length}}),contains:l(function(e){return e=e.replace(_t,wt),function(t){return-1<(t.textContent||t.innerText||T(t)).indexOf(e)}}),lang:l(function(n){return ht.test(n||"")||_.error("unsupported lang: "+n),n=n.replace(_t,wt).toLowerCase(),function(t){var e;do{if(e=N?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===n||0===e.indexOf(n+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=n.location&&n.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===O},focus:function(t){return t===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!k.pseudos.empty(t)},header:function(t){return mt.test(t.nodeName)},input:function(t){return ft.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:o(function(){return[0]}),last:o(function(t,e){return[e-1]}),eq:o(function(t,e,n){return[n<0?n+e:n]}),even:o(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:o(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:o(function(t,e,n){for(var i=n<0?n+e:n;0<=--i;)t.push(i);return t}),gt:o(function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t})}}).pseudos.nth=k.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})k.pseudos[f]=i(f);for(f in{submit:!0,reset:!0})k.pseudos[f]=r(f);return a.prototype=k.filters=k.pseudos,k.setFilters=new a,S=_.tokenize=function(t,e){var n,i,s,r,o,a,l,c=J[t+" "];if(c)return e?0:c.slice(0);for(o=t,a=[],l=k.preFilter;o;){for(r in n&&!(i=lt.exec(o))||(i&&(o=o.slice(i[0].length)||o),a.push(s=[])),n=!1,(i=ct.exec(o))&&(n=i.shift(),s.push({value:n,type:i[0].replace(at," ")}),o=o.slice(n.length)),k.filter)!(i=dt[r].exec(o))||l[r]&&!(i=l[r](i))||(n=i.shift(),s.push({value:n,type:r,matches:i}),o=o.slice(n.length));if(!n)break}return e?o.length:o?_.error(t):J(t,a).slice(0)},C=_.compile=function(t,e){var n,i=[],s=[],r=H[t+" "];if(!r){for(e||(e=S(t)),n=e.length;n--;)(r=d(e[n]))[U]?i.push(r):s.push(r);(r=H(t,p(s,i))).selector=t}return r},x=_.select=function(t,e,n,i){var s,r,o,a,l,c="function"==typeof t&&t,p=!i&&S(t=c.selector||t);if(n=n||[],1===p.length){if(2<(r=p[0]=p[0].slice(0)).length&&"ID"===(o=r[0]).type&&v.getById&&9===e.nodeType&&N&&k.relative[r[1].type]){if(!(e=(k.find.ID(o.matches[0].replace(_t,wt),e)||[])[0]))return n;c&&(e=e.parentNode),t=t.slice(r.shift().value.length)}for(s=dt.needsContext.test(t)?0:r.length;s--&&(o=r[s],!k.relative[a=o.type]);)if((l=k.find[a])&&(i=l(o.matches[0].replace(_t,wt),yt.test(r[0].type)&&m(e.parentNode)||e))){if(r.splice(s,1),!(t=i.length&&g(r)))return Z.apply(n,i),n;break}}return(c||C(t,p))(i,e,!N,n,!e||yt.test(t)&&m(e.parentNode)||e),n},v.sortStable=U.split("").sort(W).join("")===U,v.detectDuplicates=!!I,E(),v.sortDetached=s(function(t){return 1&t.compareDocumentPosition(D.createElement("div"))}),s(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||e("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),v.attributes&&s(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||e("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),s(function(t){return null==t.getAttribute("disabled")})||e(et,function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),_}(T);rt.find=pt,rt.expr=pt.selectors,rt.expr[":"]=rt.expr.pseudos,rt.uniqueSort=rt.unique=pt.uniqueSort,rt.text=pt.getText,rt.isXMLDoc=pt.isXML,rt.contains=pt.contains;var ut=function(t,e,n){for(var i=[],s=n!==undefined;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(s&&rt(t).is(n))break;i.push(t)}return i},ht=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},dt=rt.expr.match.needsContext,ft=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,mt=/^.[^:#\[\.,]*$/;rt.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?rt.find.matchesSelector(i,t)?[i]:[]:rt.find.matches(t,rt.grep(e,function(t){return 1===t.nodeType}))},rt.fn.extend({find:function(t){var e,n=this.length,i=[],s=this;if("string"!=typeof t)return this.pushStack(rt(t).filter(function(){for(e=0;e<n;e++)if(rt.contains(s[e],this))return!0}));for(e=0;e<n;e++)rt.find(t,s[e],i);return(i=this.pushStack(1<n?rt.unique(i):i)).selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(e(this,t||[],!1))},not:function(t){return this.pushStack(e(this,t||[],!0))},is:function(t){return!!e(this,"string"==typeof t&&dt.test(t)?rt(t):t||[],!1).length}});var gt,vt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(rt.fn.init=function(t,e,n){var i,s;if(!t)return this;if(n=n||gt,"string"!=typeof t)return t.nodeType?(this.context=this[0]=t,this.length=1,this):rt.isFunction(t)?n.ready!==undefined?n.ready(t):t(rt):(t.selector!==undefined&&(this.selector=t.selector,this.context=t.context),rt.makeArray(t,this));if(!(i="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:vt.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof rt?e[0]:e,rt.merge(this,rt.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:V,!0)),ft.test(i[1])&&rt.isPlainObject(e))for(i in e)rt.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(s=V.getElementById(i[2]))&&s.parentNode&&(this.length=1,this[0]=s),this.context=V,this.selector=t,this}).prototype=rt.fn,gt=rt(V);var yt=/^(?:parents|prev(?:Until|All))/,bt={children:!0,contents:!0,next:!0,prev:!0};rt.fn.extend({has:function(t){var e=rt(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(rt.contains(this,e[t]))return!0})},closest:function(t,e){for(var n,i=0,s=this.length,r=[],o=dt.test(t)||"string"!=typeof t?rt(t,e||this.context):0;i<s;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(o?-1<o.index(n):1===n.nodeType&&rt.find.matchesSelector(n,t))){r.push(n);break}return this.pushStack(1<r.length?rt.uniqueSort(r):r)},index:function(t){return t?"string"==typeof t?Q.call(rt(t),this[0]):Q.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(rt.uniqueSort(rt.merge(this.get(),rt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),rt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return ut(t,"parentNode")},parentsUntil:function(t,e,n){return ut(t,"parentNode",n)},next:function(t){return n(t,"nextSibling")},prev:function(t){return n(t,"previousSibling")},nextAll:function(t){return ut(t,"nextSibling")},prevAll:function(t){return ut(t,"previousSibling")},nextUntil:function(t,e,n){return ut(t,"nextSibling",n)},prevUntil:function(t,e,n){return ut(t,"previousSibling",n)},siblings:function(t){return ht((t.parentNode||{}).firstChild,t)},children:function(t){return ht(t.firstChild)},contents:function(t){return t.contentDocument||rt.merge([],t.childNodes)}},function(i,s){rt.fn[i]=function(t,e){var n=rt.map(this,s,t);return"Until"!==i.slice(-5)&&(e=t),e&&"string"==typeof e&&(n=rt.filter(e,n)),1<this.length&&(bt[i]||rt.uniqueSort(n),yt.test(i)&&n.reverse()),this.pushStack(n)}});var _t,wt=/\S+/g;rt.Callbacks=function(i){i="string"==typeof i?p(i):rt.extend({},i);var s,t,e,n,r=[],o=[],a=-1,l=function(){for(n=i.once,e=s=!0;o.length;a=-1)for(t=o.shift();++a<r.length;)!1===r[a].apply(t[0],t[1])&&i.stopOnFalse&&(a=r.length,t=!1);i.memory||(t=!1),s=!1,n&&(r=t?[]:"")},c={add:function(){return r&&(t&&!s&&(a=r.length-1,o.push(t)),function n(t){rt.each(t,function(t,e){rt.isFunction(e)?i.unique&&c.has(e)||r.push(e):e&&e.length&&"string"!==rt.type(e)&&n(e)})}(arguments),t&&!s&&l()),this},remove:function(){return rt.each(arguments,function(t,e){for(var n;-1<(n=rt.inArray(e,r,n));)r.splice(n,1),n<=a&&a--}),this},has:function(t){return t?-1<rt.inArray(t,r):0<r.length},empty:function(){return r&&(r=[]),this},disable:function(){return n=o=[],r=t="",this},disabled:function(){return!r},lock:function(){return n=o=[],t||(r=t=""),this},locked:function(){return!!n},fireWith:function(t,e){return n||(e=[t,(e=e||[]).slice?e.slice():e],o.push(e),s||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!e}};return c},rt.extend({Deferred:function(t){var r=[["resolve","done",rt.Callbacks("once memory"),"resolved"],["reject","fail",rt.Callbacks("once memory"),"rejected"],["notify","progress",rt.Callbacks("memory")]],s="pending",o={state:function(){return s},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var s=arguments;return rt.Deferred(function(i){rt.each(r,function(t,e){var n=rt.isFunction(s[t])&&s[t];a[e[1]](function(){var t=n&&n.apply(this,arguments);t&&rt.isFunction(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[e[0]+"With"](this===o?i.promise():this,n?[t]:arguments)})}),s=null}).promise()},promise:function(t){return null!=t?rt.extend(t,o):o}},a={};return o.pipe=o.then,rt.each(r,function(t,e){var n=e[2],i=e[3];o[e[1]]=n.add,i&&n.add(function(){s=i},r[1^t][2].disable,r[2][2].lock),a[e[0]]=function(){return a[e[0]+"With"](this===a?o:this,arguments),this},a[e[0]+"With"]=n.fireWith}),o.promise(a),t&&t.call(a,a),a},when:function(t){var s,e,n,i=0,r=Y.call(arguments),o=r.length,a=1!==o||t&&rt.isFunction(t.promise)?o:0,l=1===a?t:rt.Deferred(),c=function(e,n,i){return function(t){n[e]=this,i[e]=1<arguments.length?Y.call(arguments):t,i===s?l.notifyWith(n,i):--a||l.resolveWith(n,i)}};if(1<o)for(s=new Array(o),e=new Array(o),n=new Array(o);i<o;i++)r[i]&&rt.isFunction(r[i].promise)?r[i].promise().progress(c(i,e,s)).done(c(i,n,r)).fail(l.reject):--a;return a||l.resolveWith(n,r),l.promise()}}),rt.fn.ready=function(t){return rt.ready.promise().done(t),this},rt.extend({isReady:!1,readyWait:1,holdReady:function(t){t?rt.readyWait++:rt.ready(!0)},ready:function(t){(!0===t?--rt.readyWait:rt.isReady)||(rt.isReady=!0)!==t&&0<--rt.readyWait||(_t.resolveWith(V,[rt]),rt.fn.triggerHandler&&(rt(V).triggerHandler("ready"),rt(V).off("ready")))}}),rt.ready.promise=function(t){return _t||(_t=rt.Deferred(),"complete"===V.readyState||"loading"!==V.readyState&&!V.documentElement.doScroll?T.setTimeout(rt.ready):(V.addEventListener("DOMContentLoaded",i),T.addEventListener("load",i))),_t.promise(t)},rt.ready.promise();var kt=function(t,e,n,i,s,r,o){var a=0,l=t.length,c=null==n;if("object"===rt.type(n))for(a in s=!0,n)kt(t,e,a,n[a],!0,r,o);else if(i!==undefined&&(s=!0,rt.isFunction(i)||(o=!0),c&&(o?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(rt(t),n)})),e))for(;a<l;a++)e(t[a],n,o?i:i.call(t[a],a,e(t[a],n)));return s?t:c?e.call(t):l?e(t[0],n):r},Tt=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};s.uid=1,s.prototype={register:function(t,e){var n=e||{};return t.nodeType?t[this.expando]=n:Object.defineProperty(t,this.expando,{value:n,writable:!0,configurable:!0}),t[this.expando]},cache:function(t){if(!Tt(t))return{};var e=t[this.expando];return e||(e={},Tt(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,s=this.cache(t);if("string"==typeof e)s[e]=n;else for(i in e)s[i]=e[i];return s},get:function(t,e){return e===undefined?this.cache(t):t[this.expando]&&t[this.expando][e]},access:function(t,e,n){var i;return e===undefined||e&&"string"==typeof e&&n===undefined?(i=this.get(t,e))!==undefined?i:this.get(t,rt.camelCase(e)):(this.set(t,e,n),n!==undefined?n:e)},remove:function(t,e){var n,i,s,r=t[this.expando];if(r!==undefined){if(e===undefined)this.register(t);else{rt.isArray(e)?i=e.concat(e.map(rt.camelCase)):(s=rt.camelCase(e),i=e in r?[e,s]:(i=s)in r?[i]:i.match(wt)||[]),n=i.length;for(;n--;)delete r[i[n]]}(e===undefined||rt.isEmptyObject(r))&&(t.nodeType?t[this.expando]=undefined:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return e!==undefined&&!rt.isEmptyObject(e)}};var At=new s,St=new s,Ct=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,xt=/[A-Z]/g;rt.extend({hasData:function(t){return St.hasData(t)||At.hasData(t)},data:function(t,e,n){return St.access(t,e,n)},removeData:function(t,e){St.remove(t,e)},_data:function(t,e,n){return At.access(t,e,n)},_removeData:function(t,e){At.remove(t,e)}}),rt.fn.extend({data:function(i,t){var e,n,s,r=this[0],o=r&&r.attributes;if(i!==undefined)return"object"==typeof i?this.each(function(){St.set(this,i)}):kt(this,function(e){var t,n;if(r&&e===undefined)return(t=St.get(r,i)||St.get(r,i.replace(xt,"-$&").toLowerCase()))!==undefined?t:(n=rt.camelCase(i),(t=St.get(r,n))!==undefined?t:(t=l(r,n,undefined))!==undefined?t:void 0);n=rt.camelCase(i),this.each(function(){var t=St.get(this,n);St.set(this,n,e),-1<i.indexOf("-")&&t!==undefined&&St.set(this,i,e)})},null,t,1<arguments.length,null,!0);if(this.length&&(s=St.get(r),1===r.nodeType&&!At.get(r,"hasDataAttrs"))){for(e=o.length;e--;)o[e]&&0===(n=o[e].name).indexOf("data-")&&(n=rt.camelCase(n.slice(5)),l(r,n,s[n]));At.set(r,"hasDataAttrs",!0)}return s},removeData:function(t){return this.each(function(){St.remove(this,t)})}}),rt.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=At.get(t,e),n&&(!i||rt.isArray(n)?i=At.access(t,e,rt.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=rt.queue(t,e),i=n.length,s=n.shift(),r=rt._queueHooks(t,e),o=function(){rt.dequeue(t,e)};"inprogress"===s&&(s=n.shift(),i--),s&&("fx"===e&&n.unshift("inprogress"),delete r.stop,s.call(t,o,r)),!i&&r&&r.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return At.get(t,n)||At.access(t,n,{empty:rt.Callbacks("once memory").add(function(){At.remove(t,[e+"queue",n])})})}}),rt.fn.extend({queue:function(e,n){var t=2;return"string"!=typeof e&&(n=e,e="fx",t--),arguments.length<t?rt.queue(this[0],e):n===undefined?this:this.each(function(){var t=rt.queue(this,e,n);rt._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&rt.dequeue(this,e)})},dequeue:function(t){return this.each(function(){rt.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,s=rt.Deferred(),r=this,o=this.length,a=function(){--i||s.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=undefined),t=t||"fx";o--;)(n=At.get(r[o],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),s.promise(e)}});var jt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Pt=new RegExp("^(?:([+-])=|)("+jt+")([a-z%]*)$","i"),It=["Top","Right","Bottom","Left"],Et=function(t,e){return t=e||t,"none"===rt.css(t,"display")||!rt.contains(t.ownerDocument,t)},Dt=/^(?:checkbox|radio)$/i,Ot=/<([\w:-]+)/,Nt=/^$|\/(?:java|ecma)script/i,Rt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Rt.optgroup=Rt.option,Rt.tbody=Rt.tfoot=Rt.colgroup=Rt.caption=Rt.thead,Rt.th=Rt.td;var Mt,$t,Lt=/<|&#?\w+;/;Mt=V.createDocumentFragment().appendChild(V.createElement("div")),($t=V.createElement("input")).setAttribute("type","radio"),$t.setAttribute("checked","checked"),$t.setAttribute("name","t"),Mt.appendChild($t),it.checkClone=Mt.cloneNode(!0).cloneNode(!0).lastChild.checked,Mt.innerHTML="<textarea>x</textarea>",it.noCloneChecked=!!Mt.cloneNode(!0).lastChild.defaultValue;var Ut=/^key/,zt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Bt=/^([^.]*)(?:\.(.+)|)/;rt.event={global:{},add:function(e,t,n,i,s){var r,o,a,l,c,p,u,h,d,f,m,g=At.get(e);if(g)for(n.handler&&(n=(r=n).handler,s=r.selector),n.guid||(n.guid=rt.guid++),(l=g.events)||(l=g.events={}),(o=g.handle)||(o=g.handle=function(t){return void 0!==rt&&rt.event.triggered!==t.type?rt.event.dispatch.apply(e,arguments):undefined}),c=(t=(t||"").match(wt)||[""]).length;c--;)d=m=(a=Bt.exec(t[c])||[])[1],f=(a[2]||"").split(".").sort(),d&&(u=rt.event.special[d]||{},d=(s?u.delegateType:u.bindType)||d,u=rt.event.special[d]||{},p=rt.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&rt.expr.match.needsContext.test(s),namespace:f.join(".")},r),(h=l[d])||((h=l[d]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,i,f,o)||e.addEventListener&&e.addEventListener(d,o)),u.add&&(u.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),s?h.splice(h.delegateCount++,0,p):h.push(p),rt.event.global[d]=!0)},remove:function(t,e,n,i,s){var r,o,a,l,c,p,u,h,d,f,m,g=At.hasData(t)&&At.get(t);if(g&&(l=g.events)){for(c=(e=(e||"").match(wt)||[""]).length;c--;)if(d=m=(a=Bt.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),d){for(u=rt.event.special[d]||{},h=l[d=(i?u.delegateType:u.bindType)||d]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=r=h.length;r--;)p=h[r],!s&&m!==p.origType||n&&n.guid!==p.guid||a&&!a.test(p.namespace)||i&&i!==p.selector&&("**"!==i||!p.selector)||(h.splice(r,1),p.selector&&h.delegateCount--,u.remove&&u.remove.call(t,p));o&&!h.length&&(u.teardown&&!1!==u.teardown.call(t,f,g.handle)||rt.removeEvent(t,d,g.handle),delete l[d])}else for(d in l)rt.event.remove(t,d+e[c],n,i,!0);rt.isEmptyObject(l)&&At.remove(t,"handle events")}},dispatch:function(t){t=rt.event.fix(t);var e,n,i,s,r,o=[],a=Y.call(arguments),l=(At.get(this,"events")||{})[t.type]||[],c=rt.event.special[t.type]||{};if((a[0]=t).delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){for(o=rt.event.handlers.call(this,t,l),e=0;(s=o[e++])&&!t.isPropagationStopped();)for(t.currentTarget=s.elem,n=0;(r=s.handlers[n++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(r.namespace)||(t.handleObj=r,t.data=r.data,(i=((rt.event.special[r.origType]||{}).handle||r.handler).apply(s.elem,a))!==undefined&&!1===(t.result=i)&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,i,s,r,o=[],a=e.delegateCount,l=t.target;if(a&&l.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==t.type)){for(i=[],n=0;n<a;n++)i[s=(r=e[n]).selector+" "]===undefined&&(i[s]=r.needsContext?-1<rt(s,this).index(l):rt.find(s,this,null,[l]).length),i[s]&&i.push(r);i.length&&o.push({elem:l,handlers:i})}return a<e.length&&o.push({elem:this,handlers:e.slice(a)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,i,s,r=e.button;return null==t.pageX&&null!=e.clientX&&(i=(n=t.target.ownerDocument||V).documentElement,s=n.body,t.pageX=e.clientX+(i&&i.scrollLeft||s&&s.scrollLeft||0)-(i&&i.clientLeft||s&&s.clientLeft||0),t.pageY=e.clientY+(i&&i.scrollTop||s&&s.scrollTop||0)-(i&&i.clientTop||s&&s.clientTop||0)),t.which||r===undefined||(t.which=1&r?1:2&r?3:4&r?2:0),t}},fix:function(t){if(t[rt.expando])return t;var e,n,i,s=t.type,r=t,o=this.fixHooks[s];for(o||(this.fixHooks[s]=o=zt.test(s)?this.mouseHooks:Ut.test(s)?this.keyHooks:{}),i=o.props?this.props.concat(o.props):this.props,t=new rt.Event(r),e=i.length;e--;)t[n=i[e]]=r[n];return t.target||(t.target=V),3===t.target.nodeType&&(t.target=t.target.parentNode),o.filter?o.filter(t,r):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==o()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===o()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&rt.nodeName(this,"input"))return this.click(),!1},_default:function(t){return rt.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){t.result!==undefined&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},rt.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},rt.Event=function(t,e){if(!(this instanceof rt.Event))return new rt.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.defaultPrevented===undefined&&!1===t.returnValue?r:u):this.type=t,e&&rt.extend(this,e),this.timeStamp=t&&t.timeStamp||rt.now(),this[rt.expando]=!0},rt.Event.prototype={constructor:rt.Event,isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=r,t&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=r,t&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=r,t&&t.stopImmediatePropagation(),this.stopPropagation()}},rt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,r){rt.event.special[t]={delegateType:r,bindType:r,handle:function(t){var e,n=this,i=t.relatedTarget,s=t.handleObj;return i&&(i===n||rt.contains(n,i))||(t.type=s.origType,e=s.handler.apply(this,arguments),t.type=r),e}}}),rt.fn.extend({on:function(t,e,n,i){return h(this,t,e,n,i)},one:function(t,e,n,i){return h(this,t,e,n,i,1)},off:function(t,e,n){var i,s;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,rt(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(n=e,e=undefined),!1===n&&(n=u),this.each(function(){rt.event.remove(this,t,n,e)});for(s in t)this.off(s,e,t[s]);return this}});var Ft=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,qt=/<script|<style|<link/i,Jt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ht=/^true\/(.*)/,Wt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;rt.extend({htmlPrefilter:function(t){return t.replace(Ft,"<$1></$2>")},clone:function(t,e,n){var i,s,r,o,a=t.cloneNode(!0),l=rt.contains(t.ownerDocument,t);if(!(it.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||rt.isXMLDoc(t)))for(o=m(a),i=0,s=(r=m(t)).length;i<s;i++)_(r[i],o[i]);if(e)if(n)for(r=r||m(t),o=o||m(a),i=0,s=r.length;i<s;i++)f(r[i],o[i]);else f(t,a);return 0<(o=m(a,"script")).length&&g(o,!l&&m(t,"script")),a},cleanData:function(t){for(var e,n,i,s=rt.event.special,r=0;(n=t[r])!==undefined;r++)if(Tt(n)){if(e=n[At.expando]){if(e.events)for(i in e.events)s[i]?rt.event.remove(n,i):rt.removeEvent(n,i,e.handle);n[At.expando]=undefined}n[St.expando]&&(n[St.expando]=undefined)}}}),rt.fn.extend({domManip:w,detach:function(t){return k(this,t,!0)},remove:function(t){return k(this,t)},text:function(t){return kt(this,function(t){return t===undefined?rt.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return w(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||d(this,t).appendChild(t)})},prepend:function(){return w(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=d(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return w(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return w(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(rt.cleanData(m(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return rt.clone(this,t,e)})},html:function(t){return kt(this,function(t){var e=this[0]||{},n=0,i=this.length;if(t===undefined&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!qt.test(t)&&!Rt[(Ot.exec(t)||["",""])[1].toLowerCase()]){t=rt.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(rt.cleanData(m(e,!1)),e.innerHTML=t);e=0}catch(s){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var n=[];return w(this,arguments,function(t){var e=this.parentNode;rt.inArray(this,n)<0&&(rt.cleanData(m(this)),e&&e.replaceChild(t,this))},n)}}),rt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,o){rt.fn[t]=function(t){for(var e,n=[],i=rt(t),s=i.length-1,r=0;r<=s;r++)e=r===s?this:this.clone(!0),rt(i[r])[o](e),Z.apply(n,e.get());return this.pushStack(n)}});var Gt,Kt={HTML:"block",BODY:"block"},Vt=/^margin/,Yt=new RegExp("^("+jt+")(?!px)[a-z%]+$","i"),Xt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=T),e.getComputedStyle(t)},Zt=function(t,e,n,i){var s,r,o={};for(r in e)o[r]=t.style[r],t.style[r]=e[r];for(r in s=n.apply(t,i||[]),e)t.style[r]=o[r];return s},Qt=V.documentElement;!function(){function t(){o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",o.innerHTML="",Qt.appendChild(r);var t=T.getComputedStyle(o);e="1%"!==t.top,s="2px"===t.marginLeft,n="4px"===t.width,o.style.marginRight="50%",i="4px"===t.marginRight,Qt.removeChild(r)}var e,n,i,s,r=V.createElement("div"),o=V.createElement("div");o.style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",it.clearCloneStyle="content-box"===o.style.backgroundClip,r.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",r.appendChild(o),rt.extend(it,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return null==n&&t(),n},pixelMarginRight:function(){return null==n&&t(),i},reliableMarginLeft:function(){return null==n&&t(),s},reliableMarginRight:function(){var t,e=o.appendChild(V.createElement("div"));return e.style.cssText=o.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",o.style.width="1px",Qt.appendChild(r),t=!parseFloat(T.getComputedStyle(e).marginRight),Qt.removeChild(r),o.removeChild(e),t}}))}();var te=/^(none|table(?!-c[ea]).+)/,ee={position:"absolute",visibility:"hidden",display:"block"},ne={letterSpacing:"0",fontWeight:"400"},ie=["Webkit","O","Moz","ms"],se=V.createElement("div").style;rt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=C(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var s,r,o,a=rt.camelCase(e),l=t.style;if(e=rt.cssProps[a]||(rt.cssProps[a]=j(a)||a),o=rt.cssHooks[e]||rt.cssHooks[a],n===undefined)return o&&"get"in o&&(s=o.get(t,!1,i))!==undefined?s:l[e];"string"===(r=typeof n)&&(s=Pt.exec(n))&&s[1]&&(n=c(t,e,s),r="number"),null!=n&&n==n&&("number"===r&&(n+=s&&s[3]||(rt.cssNumber[a]?"":"px")),it.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),o&&"set"in o&&(n=o.set(t,n,i))===undefined||(l[e]=n))}},css:function(t,e,n,i){var s,r,o,a=rt.camelCase(e);return e=rt.cssProps[a]||(rt.cssProps[a]=j(a)||a),(o=rt.cssHooks[e]||rt.cssHooks[a])&&"get"in o&&(s=o.get(t,!0,n)),s===undefined&&(s=C(t,e,i)),"normal"===s&&e in ne&&(s=ne[e]),""===n||n?(r=parseFloat(s),!0===n||isFinite(r)?r||0:s):s}}),rt.each(["height","width"],function(t,o){rt.cssHooks[o]={get:function(t,e,n){if(e)return te.test(rt.css(t,"display"))&&0===t.offsetWidth?Zt(t,ee,function(){return E(t,o,n)}):E(t,o,n)},set:function(t,e,n){var i,s=n&&Xt(t),r=n&&I(t,o,n,"border-box"===rt.css(t,"boxSizing",!1,s),s);return r&&(i=Pt.exec(e))&&"px"!==(i[3]||"px")&&(t.style[o]=e,e=rt.css(t,o)),P(t,e,r)}}}),rt.cssHooks.marginLeft=x(it.reliableMarginLeft,function(t,e){if(e)return(parseFloat(C(t,"marginLeft"))||t.getBoundingClientRect().left-Zt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),rt.cssHooks.marginRight=x(it.reliableMarginRight,function(t,e){if(e)return Zt(t,{display:"inline-block"},C,[t,"marginRight"])}),rt.each({margin:"",padding:"",border:"Width"},function(s,r){rt.cssHooks[s+r]={expand:function(t){for(var e=0,n={},i="string"==typeof t?t.split(" "):[t];e<4;e++)n[s+It[e]+r]=i[e]||i[e-2]||i[0];return n}},Vt.test(s)||(rt.cssHooks[s+r].set=P)}),rt.fn.extend({css:function(t,e){return kt(this,function(t,e,n){var i,s,r={},o=0;if(rt.isArray(e)){for(i=Xt(t),s=e.length;o<s;o++)r[e[o]]=rt.css(t,e[o],!1,i);return r}return n!==undefined?rt.style(t,e,n):rt.css(t,e)},t,e,1<arguments.length)},show:function(){return D(this,!0)},hide:function(){return D(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Et(this)?rt(this).show():rt(this).hide()})}}),(rt.Tween=O).prototype={constructor:O,init:function(t,e,n,i,s,r){this.elem=t,this.prop=n,this.easing=s||rt.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=r||(rt.cssNumber[n]?"":"px")},cur:function(){var t=O.propHooks[this.prop];return t&&t.get?t.get(this):O.propHooks._default.get(this)},run:function(t){var e,n=O.propHooks[this.prop];return this.options.duration?this.pos=e=rt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):O.propHooks._default.set(this),this}},O.prototype.init.prototype=O.prototype,O.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=rt.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){rt.fx.step[t.prop]?rt.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[rt.cssProps[t.prop]]&&!rt.cssHooks[t.prop]?t.elem[t.prop]=t.now:rt.style(t.elem,t.prop,t.now+t.unit)}}},O.propHooks.scrollTop=O.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},rt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},rt.fx=O.prototype.init,rt.fx.step={};var re,oe,ae,le,ce,pe=/^(?:toggle|show|hide)$/,ue=/queueHooks$/;rt.Animation=rt.extend(U,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return c(n.elem,t,Pt.exec(e),n),n}]},tweener:function(t,e){rt.isFunction(t)?(e=t,t=["*"]):t=t.match(wt);for(var n,i=0,s=t.length;i<s;i++)n=t[i],U.tweeners[n]=U.tweeners[n]||[],U.tweeners[n].unshift(e)},prefilters:[$],prefilter:function(t,e){e?U.prefilters.unshift(t):U.prefilters.push(t)}}),rt.speed=function(t,e,n){var i=t&&"object"==typeof t?rt.extend({},t):{complete:n||!n&&e||rt.isFunction(t)&&t,duration:t,easing:n&&e||e&&!rt.isFunction(e)&&e};return i.duration=rt.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in rt.fx.speeds?rt.fx.speeds[i.duration]:rt.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){rt.isFunction(i.old)&&i.old.call(this),i.queue&&rt.dequeue(this,i.queue)},i},rt.fn.extend({fadeTo:function(t,e,n,i){return this.filter(Et).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(e,t,n,i){var s=rt.isEmptyObject(e),r=rt.speed(t,n,i),o=function(){var t=U(this,rt.extend({},e),r);(s||At.get(this,"finish"))&&t.stop(!0)};return o.finish=o,s||!1===r.queue?this.each(o):this.queue(r.queue,o)},stop:function(s,t,r){var o=function(t){var e=t.stop;delete t.stop,e(r)};return"string"!=typeof s&&(r=t,
t=s,s=undefined),t&&!1!==s&&this.queue(s||"fx",[]),this.each(function(){var t=!0,e=null!=s&&s+"queueHooks",n=rt.timers,i=At.get(this);if(e)i[e]&&i[e].stop&&o(i[e]);else for(e in i)i[e]&&i[e].stop&&ue.test(e)&&o(i[e]);for(e=n.length;e--;)n[e].elem!==this||null!=s&&n[e].queue!==s||(n[e].anim.stop(r),t=!1,n.splice(e,1));!t&&r||rt.dequeue(this,s)})},finish:function(o){return!1!==o&&(o=o||"fx"),this.each(function(){var t,e=At.get(this),n=e[o+"queue"],i=e[o+"queueHooks"],s=rt.timers,r=n?n.length:0;for(e.finish=!0,rt.queue(this,o,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===o&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<r;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete e.finish})}}),rt.each(["toggle","show","hide"],function(t,i){var s=rt.fn[i];rt.fn[i]=function(t,e,n){return null==t||"boolean"==typeof t?s.apply(this,arguments):this.animate(R(i,!0),t,e,n)}}),rt.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,i){rt.fn[t]=function(t,e,n){return this.animate(i,t,e,n)}}),rt.timers=[],rt.fx.tick=function(){var t,e=0,n=rt.timers;for(re=rt.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||rt.fx.stop(),re=undefined},rt.fx.timer=function(t){rt.timers.push(t),t()?rt.fx.start():rt.timers.pop()},rt.fx.interval=13,rt.fx.start=function(){oe||(oe=T.setInterval(rt.fx.tick,rt.fx.interval))},rt.fx.stop=function(){T.clearInterval(oe),oe=null},rt.fx.speeds={slow:600,fast:200,_default:400},rt.fn.delay=function(i,t){return i=rt.fx&&rt.fx.speeds[i]||i,t=t||"fx",this.queue(t,function(t,e){var n=T.setTimeout(t,i);e.stop=function(){T.clearTimeout(n)}})},ae=V.createElement("input"),le=V.createElement("select"),ce=le.appendChild(V.createElement("option")),ae.type="checkbox",it.checkOn=""!==ae.value,it.optSelected=ce.selected,le.disabled=!0,it.optDisabled=!ce.disabled,(ae=V.createElement("input")).value="t",ae.type="radio",it.radioValue="t"===ae.value;var he,de=rt.expr.attrHandle;rt.fn.extend({attr:function(t,e){return kt(this,rt.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){rt.removeAttr(this,t)})}}),rt.extend({attr:function(t,e,n){var i,s,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return"undefined"==typeof t.getAttribute?rt.prop(t,e,n):(1===r&&rt.isXMLDoc(t)||(e=e.toLowerCase(),s=rt.attrHooks[e]||(rt.expr.match.bool.test(e)?he:undefined)),n!==undefined?null===n?void rt.removeAttr(t,e):s&&"set"in s&&(i=s.set(t,n,e))!==undefined?i:(t.setAttribute(e,n+""),n):s&&"get"in s&&null!==(i=s.get(t,e))?i:null==(i=rt.find.attr(t,e))?undefined:i)},attrHooks:{type:{set:function(t,e){if(!it.radioValue&&"radio"===e&&rt.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i,s=0,r=e&&e.match(wt);if(r&&1===t.nodeType)for(;n=r[s++];)i=rt.propFix[n]||n,rt.expr.match.bool.test(n)&&(t[i]=!1),t.removeAttribute(n)}}),he={set:function(t,e,n){return!1===e?rt.removeAttr(t,n):t.setAttribute(n,n),n}},rt.each(rt.expr.match.bool.source.match(/\w+/g),function(t,e){var r=de[e]||rt.find.attr;de[e]=function(t,e,n){var i,s;return n||(s=de[e],de[e]=i,i=null!=r(t,e,n)?e.toLowerCase():null,de[e]=s),i}});var fe=/^(?:input|select|textarea|button)$/i,me=/^(?:a|area)$/i;rt.fn.extend({prop:function(t,e){return kt(this,rt.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[rt.propFix[t]||t]})}}),rt.extend({prop:function(t,e,n){var i,s,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&rt.isXMLDoc(t)||(e=rt.propFix[e]||e,s=rt.propHooks[e]),n!==undefined?s&&"set"in s&&(i=s.set(t,n,e))!==undefined?i:t[e]=n:s&&"get"in s&&null!==(i=s.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=rt.find.attr(t,"tabindex");return e?parseInt(e,10):fe.test(t.nodeName)||me.test(t.nodeName)&&t.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),it.optSelected||(rt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),rt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){rt.propFix[this.toLowerCase()]=this});var ge=/[\t\r\n\f]/g;rt.fn.extend({addClass:function(e){var t,n,i,s,r,o,a,l=0;if(rt.isFunction(e))return this.each(function(t){rt(this).addClass(e.call(this,t,z(this)))});if("string"==typeof e&&e)for(t=e.match(wt)||[];n=this[l++];)if(s=z(n),i=1===n.nodeType&&(" "+s+" ").replace(ge," ")){for(o=0;r=t[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");s!==(a=rt.trim(i))&&n.setAttribute("class",a)}return this},removeClass:function(e){var t,n,i,s,r,o,a,l=0;if(rt.isFunction(e))return this.each(function(t){rt(this).removeClass(e.call(this,t,z(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(wt)||[];n=this[l++];)if(s=z(n),i=1===n.nodeType&&(" "+s+" ").replace(ge," ")){for(o=0;r=t[o++];)for(;-1<i.indexOf(" "+r+" ");)i=i.replace(" "+r+" "," ");s!==(a=rt.trim(i))&&n.setAttribute("class",a)}return this},toggleClass:function(s,e){var r=typeof s;return"boolean"==typeof e&&"string"===r?e?this.addClass(s):this.removeClass(s):rt.isFunction(s)?this.each(function(t){rt(this).toggleClass(s.call(this,t,z(this),e),e)}):this.each(function(){var t,e,n,i;if("string"===r)for(e=0,n=rt(this),i=s.match(wt)||[];t=i[e++];)n.hasClass(t)?n.removeClass(t):n.addClass(t);else s!==undefined&&"boolean"!==r||((t=z(this))&&At.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===s?"":At.get(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&-1<(" "+z(n)+" ").replace(ge," ").indexOf(e))return!0;return!1}});var ve=/\r/g;rt.fn.extend({val:function(n){var i,t,s,e=this[0];return arguments.length?(s=rt.isFunction(n),this.each(function(t){var e;1===this.nodeType&&(null==(e=s?n.call(this,t,rt(this).val()):n)?e="":"number"==typeof e?e+="":rt.isArray(e)&&(e=rt.map(e,function(t){return null==t?"":t+""})),(i=rt.valHooks[this.type]||rt.valHooks[this.nodeName.toLowerCase()])&&"set"in i&&i.set(this,e,"value")!==undefined||(this.value=e))})):e?(i=rt.valHooks[e.type]||rt.valHooks[e.nodeName.toLowerCase()])&&"get"in i&&(t=i.get(e,"value"))!==undefined?t:"string"==typeof(t=e.value)?t.replace(ve,""):null==t?"":t:void 0}}),rt.extend({valHooks:{option:{get:function(t){return rt.trim(t.value)}},select:{get:function(t){for(var e,n,i=t.options,s=t.selectedIndex,r="select-one"===t.type||s<0,o=r?null:[],a=r?s+1:i.length,l=s<0?a:r?s:0;l<a;l++)if(((n=i[l]).selected||l===s)&&(it.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!rt.nodeName(n.parentNode,"optgroup"))){if(e=rt(n).val(),r)return e;o.push(e)}return o},set:function(t,e){for(var n,i,s=t.options,r=rt.makeArray(e),o=s.length;o--;)((i=s[o]).selected=-1<rt.inArray(rt.valHooks.option.get(i),r))&&(n=!0);return n||(t.selectedIndex=-1),r}}}}),rt.each(["radio","checkbox"],function(){rt.valHooks[this]={set:function(t,e){if(rt.isArray(e))return t.checked=-1<rt.inArray(rt(t).val(),e)}},it.checkOn||(rt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var ye=/^(?:focusinfocus|focusoutblur)$/;rt.extend(rt.event,{trigger:function(t,e,n,i){var s,r,o,a,l,c,p,u=[n||V],h=nt.call(t,"type")?t.type:t,d=nt.call(t,"namespace")?t.namespace.split("."):[];if(r=o=n=n||V,3!==n.nodeType&&8!==n.nodeType&&!ye.test(h+rt.event.triggered)&&(-1<h.indexOf(".")&&(h=(d=h.split(".")).shift(),d.sort()),l=h.indexOf(":")<0&&"on"+h,(t=t[rt.expando]?t:new rt.Event(h,"object"==typeof t&&t)).isTrigger=i?2:3,t.namespace=d.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=n),e=null==e?[t]:rt.makeArray(e,[t]),p=rt.event.special[h]||{},i||!p.trigger||!1!==p.trigger.apply(n,e))){if(!i&&!p.noBubble&&!rt.isWindow(n)){for(a=p.delegateType||h,ye.test(a+h)||(r=r.parentNode);r;r=r.parentNode)u.push(r),o=r;o===(n.ownerDocument||V)&&u.push(o.defaultView||o.parentWindow||T)}for(s=0;(r=u[s++])&&!t.isPropagationStopped();)t.type=1<s?a:p.bindType||h,(c=(At.get(r,"events")||{})[t.type]&&At.get(r,"handle"))&&c.apply(r,e),(c=l&&r[l])&&c.apply&&Tt(r)&&(t.result=c.apply(r,e),!1===t.result&&t.preventDefault());return t.type=h,i||t.isDefaultPrevented()||p._default&&!1!==p._default.apply(u.pop(),e)||!Tt(n)||l&&rt.isFunction(n[h])&&!rt.isWindow(n)&&((o=n[l])&&(n[l]=null),n[rt.event.triggered=h](),rt.event.triggered=undefined,o&&(n[l]=o)),t.result}},simulate:function(t,e,n){var i=rt.extend(new rt.Event,n,{type:t,isSimulated:!0});rt.event.trigger(i,null,e),i.isDefaultPrevented()&&n.preventDefault()}}),rt.fn.extend({trigger:function(t,e){return this.each(function(){rt.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return rt.event.trigger(t,e,n,!0)}}),rt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,n){rt.fn[n]=function(t,e){return 0<arguments.length?this.on(n,null,t,e):this.trigger(n)}}),rt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),it.focusin="onfocusin"in T,it.focusin||rt.each({focus:"focusin",blur:"focusout"},function(n,i){var s=function(t){rt.event.simulate(i,t.target,rt.event.fix(t))};rt.event.special[i]={setup:function(){var t=this.ownerDocument||this,e=At.access(t,i);e||t.addEventListener(n,s,!0),At.access(t,i,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this,e=At.access(t,i)-1;e?At.access(t,i,e):(t.removeEventListener(n,s,!0),At.remove(t,i))}}});var be=T.location,_e=rt.now(),we=/\?/;rt.parseJSON=function(t){return JSON.parse(t+"")},rt.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new T.DOMParser).parseFromString(t,"text/xml")}catch(n){e=undefined}return e&&!e.getElementsByTagName("parsererror").length||rt.error("Invalid XML: "+t),e};var ke=/#.*$/,Te=/([?&])_=[^&]*/,Ae=/^(.*?):[ \t]*([^\r\n]*)$/gm,Se=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ce=/^(?:GET|HEAD)$/,xe=/^\/\//,je={},Pe={},Ie="*/".concat("*"),Ee=V.createElement("a");Ee.href=be.href,rt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:be.href,type:"GET",isLocal:Se.test(be.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ie,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":rt.parseJSON,"text xml":rt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?q(q(t,rt.ajaxSettings),e):q(rt.ajaxSettings,t)},ajaxPrefilter:B(je),ajaxTransport:B(Pe),ajax:function(t,e){function n(t,e,n,i){var s,r,o,a,l,c=e;2!==w&&(w=2,d&&T.clearTimeout(d),p=undefined,h=i||"",k.readyState=0<t?4:0,s=200<=t&&t<300||304===t,n&&(a=J(m,k,n)),a=H(m,a,k,s),s?(m.ifModified&&((l=k.getResponseHeader("Last-Modified"))&&(rt.lastModified[u]=l),(l=k.getResponseHeader("etag"))&&(rt.etag[u]=l)),204===t||"HEAD"===m.type?c="nocontent":304===t?c="notmodified":(c=a.state,r=a.data,s=!(o=a.error))):(o=c,!t&&c||(c="error",t<0&&(t=0))),k.status=t,k.statusText=(e||c)+"",s?y.resolveWith(g,[r,c,k]):y.rejectWith(g,[k,c,o]),k.statusCode(_),_=undefined,f&&v.trigger(s?"ajaxSuccess":"ajaxError",[k,m,s?r:o]),b.fireWith(g,[k,c]),f&&(v.trigger("ajaxComplete",[k,m]),--rt.active||rt.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=undefined),e=e||{};var p,u,h,i,d,s,f,r,m=rt.ajaxSetup({},e),g=m.context||m,v=m.context&&(g.nodeType||g.jquery)?rt(g):rt.event,y=rt.Deferred(),b=rt.Callbacks("once memory"),_=m.statusCode||{},o={},a={},w=0,l="canceled",k={readyState:0,getResponseHeader:function(t){var e;if(2===w){if(!i)for(i={};e=Ae.exec(h);)i[e[1].toLowerCase()]=e[2];e=i[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===w?h:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return w||(t=a[n]=a[n]||t,o[t]=e),this},overrideMimeType:function(t){return w||(m.mimeType=t),this},statusCode:function(t){var e;if(t)if(w<2)for(e in t)_[e]=[_[e],t[e]];else k.always(t[k.status]);return this},abort:function(t){var e=t||l;return p&&p.abort(e),n(0,e),this}};if(y.promise(k).complete=b.add,k.success=k.done,k.error=k.fail,m.url=((t||m.url||be.href)+"").replace(ke,"").replace(xe,be.protocol+"//"),m.type=e.method||e.type||m.method||m.type,m.dataTypes=rt.trim(m.dataType||"*").toLowerCase().match(wt)||[""],null==m.crossDomain){s=V.createElement("a");try{s.href=m.url,s.href=s.href,m.crossDomain=Ee.protocol+"//"+Ee.host!=s.protocol+"//"+s.host}catch(c){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=rt.param(m.data,m.traditional)),F(je,m,e,k),2===w)return k;for(r in(f=rt.event&&m.global)&&0==rt.active++&&rt.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Ce.test(m.type),u=m.url,m.hasContent||(m.data&&(u=m.url+=(we.test(u)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=Te.test(u)?u.replace(Te,"$1_="+_e++):u+(we.test(u)?"&":"?")+"_="+_e++)),m.ifModified&&(rt.lastModified[u]&&k.setRequestHeader("If-Modified-Since",rt.lastModified[u]),rt.etag[u]&&k.setRequestHeader("If-None-Match",rt.etag[u])),(m.data&&m.hasContent&&!1!==m.contentType||e.contentType)&&k.setRequestHeader("Content-Type",m.contentType),k.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Ie+"; q=0.01":""):m.accepts["*"]),m.headers)k.setRequestHeader(r,m.headers[r]);if(m.beforeSend&&(!1===m.beforeSend.call(g,k,m)||2===w))return k.abort();for(r in l="abort",{success:1,error:1,complete:1})k[r](m[r]);if(p=F(Pe,m,e,k)){if(k.readyState=1,f&&v.trigger("ajaxSend",[k,m]),2===w)return k;m.async&&0<m.timeout&&(d=T.setTimeout(function(){k.abort("timeout")},m.timeout));try{w=1,p.send(o,n)}catch(c){if(!(w<2))throw c;n(-1,c)}}else n(-1,"No Transport");return k},getJSON:function(t,e,n){return rt.get(t,e,n,"json")},getScript:function(t,e){return rt.get(t,undefined,e,"script")}}),rt.each(["get","post"],function(t,s){rt[s]=function(t,e,n,i){return rt.isFunction(e)&&(i=i||n,n=e,e=undefined),rt.ajax(rt.extend({url:t,type:s,dataType:i,data:e,success:n},rt.isPlainObject(t)&&t))}}),rt._evalUrl=function(t){return rt.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},rt.fn.extend({wrapAll:function(e){var t;return rt.isFunction(e)?this.each(function(t){rt(this).wrapAll(e.call(this,t))}):(this[0]&&(t=rt(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(n){return rt.isFunction(n)?this.each(function(t){rt(this).wrapInner(n.call(this,t))}):this.each(function(){var t=rt(this),e=t.contents();e.length?e.wrapAll(n):t.append(n)})},wrap:function(e){var n=rt.isFunction(e);return this.each(function(t){rt(this).wrapAll(n?e.call(this,t):e)})},unwrap:function(){return this.parent().each(function(){rt.nodeName(this,"body")||rt(this).replaceWith(this.childNodes)}).end()}}),rt.expr.filters.hidden=function(t){return!rt.expr.filters.visible(t)},rt.expr.filters.visible=function(t){return 0<t.offsetWidth||0<t.offsetHeight||0<t.getClientRects().length};var De=/%20/g,Oe=/\[\]$/,Ne=/\r?\n/g,Re=/^(?:submit|button|image|reset|file)$/i,Me=/^(?:input|select|textarea|keygen)/i;rt.param=function(t,e){var n,i=[],s=function(t,e){e=rt.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(e===undefined&&(e=rt.ajaxSettings&&rt.ajaxSettings.traditional),rt.isArray(t)||t.jquery&&!rt.isPlainObject(t))rt.each(t,function(){s(this.name,this.value)});else for(n in t)W(n,t[n],e,s);return i.join("&").replace(De,"+")},rt.fn.extend({serialize:function(){return rt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=rt.prop(this,"elements");return t?rt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!rt(this).is(":disabled")&&Me.test(this.nodeName)&&!Re.test(t)&&(this.checked||!Dt.test(t))}).map(function(t,e){var n=rt(this).val();return null==n?null:rt.isArray(n)?rt.map(n,function(t){return{name:e.name,value:t.replace(Ne,"\r\n")}}):{name:e.name,value:n.replace(Ne,"\r\n")}}).get()}}),rt.ajaxSettings.xhr=function(){try{return new T.XMLHttpRequest}catch(t){}};var $e={0:200,1223:204},Le=rt.ajaxSettings.xhr();it.cors=!!Le&&"withCredentials"in Le,it.ajax=Le=!!Le,rt.ajaxTransport(function(r){var o,a;if(it.cors||Le&&!r.crossDomain)return{send:function(t,e){var n,i=r.xhr();if(i.open(r.type,r.url,r.async,r.username,r.password),r.xhrFields)for(n in r.xhrFields)i[n]=r.xhrFields[n];for(n in r.mimeType&&i.overrideMimeType&&i.overrideMimeType(r.mimeType),r.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)i.setRequestHeader(n,t[n]);o=function(t){return function(){o&&(o=a=i.onload=i.onerror=i.onabort=i.onreadystatechange=null,"abort"===t?i.abort():"error"===t?"number"!=typeof i.status?e(0,"error"):e(i.status,i.statusText):e($e[i.status]||i.status,i.statusText,"text"!==(i.responseType||"text")||"string"!=typeof i.responseText?{binary:i.response}:{text:i.responseText},i.getAllResponseHeaders()))}},i.onload=o(),a=i.onerror=o("error"),i.onabort!==undefined?i.onabort=a:i.onreadystatechange=function(){4===i.readyState&&T.setTimeout(function(){o&&a()})},o=o("abort");try{i.send(r.hasContent&&r.data||null)}catch(s){if(o)throw s}},abort:function(){o&&o()}}}),rt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return rt.globalEval(t),t}}}),rt.ajaxPrefilter("script",function(t){t.cache===undefined&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),rt.ajaxTransport("script",function(n){var i,s;if(n.crossDomain)return{send:function(t,e){i=rt("<script>").prop({charset:n.scriptCharset,src:n.url}).on("load error",s=function(t){i.remove(),s=null,t&&e("error"===t.type?404:200,t.type)}),V.head.appendChild(i[0])},abort:function(){s&&s()}}});var Ue,ze=[],Be=/(=)\?(?=&|$)|\?\?/;rt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ze.pop()||rt.expando+"_"+_e++;return this[t]=!0,t}}),rt.ajaxPrefilter("json jsonp",function(t,e,n){var i,s,r,o=!1!==t.jsonp&&(Be.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Be.test(t.data)&&"data");if(o||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=rt.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,o?t[o]=t[o].replace(Be,"$1"+i):!1!==t.jsonp&&(t.url+=(we.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return r||rt.error(i+" was not called"),r[0]},t.dataTypes[0]="json",s=T[i],T[i]=function(){r=arguments},n.always(function(){s===undefined?rt(T).removeProp(i):T[i]=s,t[i]&&(t.jsonpCallback=e.jsonpCallback,ze.push(i)),r&&rt.isFunction(s)&&s(r[0]),r=s=undefined}),"script"}),it.createHTMLDocument=((Ue=V.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ue.childNodes.length),rt.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||(it.createHTMLDocument?V.implementation.createHTMLDocument(""):V);var i=ft.exec(t),s=!n&&[];return i?[e.createElement(i[1])]:(i=v([t],e,s),s&&s.length&&rt(s).remove(),rt.merge([],i.childNodes))};var Fe=rt.fn.load;rt.fn.load=function(t,e,n){if("string"!=typeof t&&Fe)return Fe.apply(this,arguments);var i,s,r,o=this,a=t.indexOf(" ");return-1<a&&(i=rt.trim(t.slice(a)),t=t.slice(0,a)),rt.isFunction(e)?(n=e,e=undefined):e&&"object"==typeof e&&(s="POST"),0<o.length&&rt.ajax({url:t,type:s||"GET",dataType:"html",data:e}).done(function(t){r=arguments,o.html(i?rt("<div>").append(rt.parseHTML(t)).find(i):t)}).always(n&&function(t,e){o.each(function(){n.apply(o,r||[t.responseText,e,t])})}),this},rt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){rt.fn[e]=function(t){return this.on(e,t)}}),rt.expr.filters.animated=function(e){return rt.grep(rt.timers,function(t){return e===t.elem}).length},rt.offset={setOffset:function(t,e,n){var i,s,r,o,a,l,c=rt.css(t,"position"),p=rt(t),u={};"static"===c&&(t.style.position="relative"),a=p.offset(),r=rt.css(t,"top"),l=rt.css(t,"left"),("absolute"===c||"fixed"===c)&&-1<(r+l).indexOf("auto")?(o=(i=p.position()).top,s=i.left):(o=parseFloat(r)||0,s=parseFloat(l)||0),rt.isFunction(e)&&(e=e.call(t,n,rt.extend({},a))),null!=e.top&&(u.top=e.top-a.top+o),null!=e.left&&(u.left=e.left-a.left+s),"using"in e?e.using.call(t,u):p.css(u)}},rt.fn.extend({offset:function(e){if(arguments.length)return e===undefined?this:this.each(function(t){rt.offset.setOffset(this,e,t)});var t,n,i=this[0],s={top:0,left:0},r=i&&i.ownerDocument;return r?(t=r.documentElement,rt.contains(t,i)?(s=i.getBoundingClientRect(),n=G(r),{top:s.top+n.pageYOffset-t.clientTop,left:s.left+n.pageXOffset-t.clientLeft}):s):void 0},position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===rt.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),rt.nodeName(t[0],"html")||(i=t.offset()),i.top+=rt.css(t[0],"borderTopWidth",!0),i.left+=rt.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-rt.css(n,"marginTop",!0),left:e.left-i.left-rt.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===rt.css(t,"position");)t=t.offsetParent;return t||Qt})}}),rt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,s){var r="pageYOffset"===s;rt.fn[e]=function(t){return kt(this,function(t,e,n){var i=G(t);if(n===undefined)return i?i[s]:t[e];i?i.scrollTo(r?i.pageXOffset:n,r?n:i.pageYOffset):t[e]=n},e,t,arguments.length)}}),rt.each(["top","left"],function(t,n){rt.cssHooks[n]=x(it.pixelPosition,function(t,e){if(e)return e=C(t,n),Yt.test(e)?rt(t).position()[n]+"px":e})}),rt.each({Height:"height",Width:"width"},function(r,o){rt.each({padding:"inner"+r,content:o,"":"outer"+r},function(i,t){rt.fn[t]=function(t,e){var n=arguments.length&&(i||"boolean"!=typeof t),s=i||(!0===t||!0===e?"margin":"border");return kt(this,function(t,e,n){var i;return rt.isWindow(t)?t.document.documentElement["client"+r]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+r],i["scroll"+r],t.body["offset"+r],i["offset"+r],i["client"+r])):n===undefined?rt.css(t,e,s):rt.style(t,e,n,s)},o,n?t:undefined,n,null)}})}),rt.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},size:function(){return this.length}}),rt.fn.andSelf=rt.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return rt});var qe=T.jQuery,Je=T.$;return rt.noConflict=function(t){return T.$===rt&&(T.$=Je),t&&T.jQuery===rt&&(T.jQuery=qe),rt},t||(T.jQuery=T.$=rt),rt}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(j){function i(t,e){var n,i,s,r=t.nodeName.toLowerCase();return"area"===r?(i=(n=t.parentNode).name,!(!t.href||!i||"map"!==n.nodeName.toLowerCase())&&(!!(s=j("img[usemap='#"+i+"']")[0])&&o(s))):(/^(input|select|textarea|button|object)$/.test(r)?!t.disabled:"a"===r&&t.href||e)&&o(t)}function o(t){return j.expr.filters.visible(t)&&!j(t).parents().addBack().filter(function(){return"hidden"===j.css(this,"visibility")}).length}var t,e,n,s;j.ui=j.ui||{},j.extend(j.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),j.fn.extend({scrollParent:function(t){var e=this.css("position"),n="absolute"===e,i=t?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter(function(){var t=j(this);return(!n||"static"!==t.css("position"))&&i.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&s.length?s:j(this[0].ownerDocument||document)},uniqueId:(t=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&j(this).removeAttr("id")})}}),j.extend(j.expr[":"],{data:j.expr.createPseudo?j.expr.createPseudo(function(e){return function(t){return!!j.data(t,e)}}):function(t,e,n){return!!j.data(t,n[3])},focusable:function(t){return i(t,!isNaN(j.attr(t,"tabindex")))},tabbable:function(t){var e=j.attr(t,"tabindex"),n=isNaN(e);return(n||0<=e)&&i(t,!n)}}),j("<a>").outerWidth(1).jquery||j.each(["Width","Height"],function(t,n){function i(t,e,n,i){return j.each(s,function(){e-=parseFloat(j.css(t,"padding"+this))||0,n&&(e-=parseFloat(j.css(t,"border"+this+"Width"))||0),i&&(e-=parseFloat(j.css(t,"margin"+this))||0)}),e}var s="Width"===n?["Left","Right"]:["Top","Bottom"],r=n.toLowerCase(),o={innerWidth:j.fn.innerWidth,innerHeight:j.fn.innerHeight,outerWidth:j.fn.outerWidth,outerHeight:j.fn.outerHeight};j.fn["inner"+n]=function(t){return t===undefined?o["inner"+n].call(this):this.each(function(){j(this).css(r,i(this,t)+"px")})},j.fn["outer"+n]=function(t,e){return"number"!=typeof t?o["outer"+n].call(this,t):this.each(function(){j(this).css(r,i(this,t,!0,e)+"px")})}}),j.fn.addBack||(j.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),j("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(j.fn.removeData=(e=j.fn.removeData,function(t){return arguments.length?e.call(this,j.camelCase(t)):e.call(this)})),j.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),j.fn.extend({focus:(s=j.fn.focus,function(e,n){return"number"==typeof e?this.each(function(){var t=this;setTimeout(function(){j(t).focus(),n&&n.call(t)},e)}):s.apply(this,arguments)}),disableSelection:(n="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(n+".ui-disableSelection",function(t){t.preventDefault()})}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(t!==undefined)return this.css("zIndex",t);if(this.length)for(var e,n,i=j(this[0]);i.length&&i[0]!==document;){if(("absolute"===(e=i.css("position"))||"relative"===e||"fixed"===e)&&(n=parseInt(i.css("zIndex"),10),!isNaN(n)&&0!==n))return n;i=i.parent()}return 0}}),j.ui.plugin={add:function(t,e,n){var i,s=j.ui[t].prototype;for(i in n)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([e,n[i]])},call:function(t,e,n,i){var s,r=t.plugins[e];if(r&&(i||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(s=0;s<r.length;s++)t.options[r[s][0]]&&r[s][1].apply(t.element,n)}};var r,a=0,l=Array.prototype.slice;j.cleanData=(r=j.cleanData,function(t){var e,n,i;for(i=0;null!=(n=t[i]);i++)try{(e=j._data(n,"events"))&&e.remove&&j(n).triggerHandler("remove")}catch(s){}r(t)}),j.widget=function(t,n,e){var i,s,r,o,a={},l=t.split(".")[0];return t=t.split(".")[1],i=l+"-"+t,e||(e=n,n=j.Widget),j.expr[":"][i.toLowerCase()]=function(t){return!!j.data(t,i)},j[l]=j[l]||{},s=j[l][t],r=j[l][t]=function(t,e){if(!this._createWidget)return new r(t,e);arguments.length&&this._createWidget(t,e)},j.extend(r,s,{version:e.version,_proto:j.extend({},e),_childConstructors:[]}),(o=new n).options=j.widget.extend({},o.options),j.each(e,function(e,i){var s,r;j.isFunction(i)?a[e]=(s=function(){return n.prototype[e].apply(this,arguments)},r=function(t){return n.prototype[e].apply(this,t)},function(){var t,e=this._super,n=this._superApply;return this._super=s,this._superApply=r,t=i.apply(this,arguments),this._super=e,this._superApply=n,t}):a[e]=i}),r.prototype=j.widget.extend(o,{widgetEventPrefix:s&&o.widgetEventPrefix||t},a,{constructor:r,namespace:l,widgetName:t,widgetFullName:i}),s?(j.each(s._childConstructors,function(t,e){var n=e.prototype;j.widget(n.namespace+"."+n.widgetName,r,e._proto)}),delete s._childConstructors):n._childConstructors.push(r),j.widget.bridge(t,r),r},j.widget.extend=function(t){for(var e,n,i=l.call(arguments,1),s=0,r=i.length;s<r;s++)for(e in i[s])n=i[s][e],i[s].hasOwnProperty(e)&&n!==undefined&&(j.isPlainObject(n)?t[e]=j.isPlainObject(t[e])?j.widget.extend({},t[e],n):j.widget.extend({},n):t[e]=n);return t},j.widget.bridge=function(r,e){var o=e.prototype.widgetFullName||r;j.fn[r]=function(n){var t="string"==typeof n,i=l.call(arguments,1),s=this;return t?this.each(function(){var t,e=j.data(this,o);return"instance"===n?(s=e,!1):e?j.isFunction(e[n])&&"_"!==n.charAt(0)?(t=e[n].apply(e,i))!==e&&t!==undefined?(s=t&&t.jquery?s.pushStack(t.get()):t,!1):void 0:j.error("no such method '"+n+"' for "+r+" widget instance"):j.error("cannot call methods on "+r+" prior to initialization; attempted to call method '"+n+"'")}):(i.length&&(n=j.widget.extend.apply(null,[n].concat(i))),this.each(function(){var t=j.data(this,o);t?(t.option(n||{}),t._init&&t._init()):j.data(this,o,new e(n,this))})),s}},j.Widget=function(){},j.Widget._childConstructors=[],j.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,e){e=j(e||this.defaultElement||this)[0],this.element=j(e),this.uuid=a++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=j(),this.hoverable=j(),this.focusable=j(),e!==this&&(j.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===e&&this.destroy()}}),this.document=j(e.style?e.ownerDocument:e.document||e),this.window=j(this.document[0].defaultView||this.document[0].parentWindow)),this.options=j.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:j.noop,_getCreateEventData:j.noop,_create:j.noop,_init:j.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(j.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:j.noop,widget:function(){return this.element},option:function(t,e){var n,i,s,r=t;if(0===arguments.length)return j.widget.extend({},this.options);if("string"==typeof t)if(r={},t=(n=t.split(".")).shift(),n.length){for(i=r[t]=j.widget.extend({},this.options[t]),s=0;s<n.length-1;s++)i[n[s]]=i[n[s]]||{},i=i[n[s]];if(t=n.pop(),1===arguments.length)return i[t]===undefined?null:i[t];i[t]=e}else{if(1===arguments.length)return this.options[t]===undefined?null:this.options[t];r[t]=e}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(o,a,t){var l,c=this;"boolean"!=typeof o&&(t=a,a=o,o=!1),t?(a=l=j(a),this.bindings=this.bindings.add(a)):(t=a,a=this.element,l=this.widget()),j.each(t,function(t,e){function n(){if(o||!0!==c.options.disabled&&!j(this).hasClass("ui-state-disabled"))return("string"==typeof e?c[e]:e).apply(c,arguments)}"string"!=typeof e&&(n.guid=e.guid=e.guid||n.guid||j.guid++);var i=t.match(/^([\w:-]*)\s*(.*)$/),s=i[1]+c.eventNamespace,r=i[2];r?l.delegate(r,s,n):a.bind(s,n)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e),this.bindings=j(this.bindings.not(t).get()),this.focusable=j(this.focusable.not(t).get()),this.hoverable=j(this.hoverable.not(t).get())},_delay:function(t,e){function n(){return("string"==typeof t?i[t]:t).apply(i,arguments)}var i=this;return setTimeout(n,e||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){j(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){j(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){j(t.currentTarget).addClass(
"ui-state-focus")},focusout:function(t){j(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,e,n){var i,s,r=this.options[t];if(n=n||{},(e=j.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],s=e.originalEvent)for(i in s)i in e||(e[i]=s[i]);return this.element.trigger(e,n),!(j.isFunction(r)&&!1===r.apply(this.element[0],[e].concat(n))||e.isDefaultPrevented())}},j.each({show:"fadeIn",hide:"fadeOut"},function(r,o){j.Widget.prototype["_"+r]=function(e,t,n){"string"==typeof t&&(t={effect:t});var i,s=t?!0===t||"number"==typeof t?o:t.effect||o:r;"number"==typeof(t=t||{})&&(t={duration:t}),i=!j.isEmptyObject(t),t.complete=n,t.delay&&e.delay(t.delay),i&&j.effects&&j.effects.effect[s]?e[r](t):s!==r&&e[s]?e[s](t.duration,t.easing,n):e.queue(function(t){j(this)[r](),n&&n.call(e[0]),t()})}});j.widget;var c=!1;j(document).mouseup(function(){c=!1});j.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(t){if(!0===j.data(t.target,e.widgetName+".preventClickEvent"))return j.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!c){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var e=this,n=1===t.which,i=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&j(t.target).closest(this.options.cancel).length;return!(n&&!i&&this._mouseCapture(t))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===j.data(t.target,this.widgetName+".preventClickEvent")&&j.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return e._mouseMove(t)},this._mouseUpDelegate=function(t){return e._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),c=!0))}},_mouseMove:function(t){if(this._mouseMoved){if(j.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&j.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),c=!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});!function(){function k(t,e,n){return[parseFloat(t[0])*(l.test(t[0])?e/100:1),parseFloat(t[1])*(l.test(t[1])?n/100:1)]}function T(t,e){return parseInt(j.css(t,e),10)||0}function e(t){var e=t[0];return 9===e.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:j.isWindow(e)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:e.preventDefault?{width:0,height:0,offset:{top:e.pageY,left:e.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}j.ui=j.ui||{};var s,A,S=Math.max,C=Math.abs,x=Math.round,i=/left|center|right/,r=/top|center|bottom/,o=/[\+\-]\d+(\.[\d]+)?%?/,a=/^\w+/,l=/%$/,n=j.fn.position;j.position={scrollbarWidth:function(){if(s!==undefined)return s;var t,e,n=j("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),i=n.children()[0];return j("body").append(n),t=i.offsetWidth,n.css("overflow","scroll"),t===(e=i.offsetWidth)&&(e=n[0].clientWidth),n.remove(),s=t-e},getScrollInfo:function(t){var e=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),n=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),i="scroll"===e||"auto"===e&&t.width<t.element[0].scrollWidth;return{width:"scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight?j.position.scrollbarWidth():0,height:i?j.position.scrollbarWidth():0}},getWithinInfo:function(t){var e=j(t||window),n=j.isWindow(e[0]),i=!!e[0]&&9===e[0].nodeType;return{element:e,isWindow:n,isDocument:i,offset:e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:n||i?e.width():e.outerWidth(),height:n||i?e.height():e.outerHeight()}}},j.fn.position=function(u){if(!u||!u.of)return n.apply(this,arguments);u=j.extend({},u);var h,d,f,m,g,t,v=j(u.of),y=j.position.getWithinInfo(u.within),b=j.position.getScrollInfo(y),_=(u.collision||"flip").split(" "),w={};return t=e(v),v[0].preventDefault&&(u.at="left top"),d=t.width,f=t.height,m=t.offset,g=j.extend({},m),j.each(["my","at"],function(){var t,e,n=(u[this]||"").split(" ");1===n.length&&(n=i.test(n[0])?n.concat(["center"]):r.test(n[0])?["center"].concat(n):["center","center"]),n[0]=i.test(n[0])?n[0]:"center",n[1]=r.test(n[1])?n[1]:"center",t=o.exec(n[0]),e=o.exec(n[1]),w[this]=[t?t[0]:0,e?e[0]:0],u[this]=[a.exec(n[0])[0],a.exec(n[1])[0]]}),1===_.length&&(_[1]=_[0]),"right"===u.at[0]?g.left+=d:"center"===u.at[0]&&(g.left+=d/2),"bottom"===u.at[1]?g.top+=f:"center"===u.at[1]&&(g.top+=f/2),h=k(w.at,d,f),g.left+=h[0],g.top+=h[1],this.each(function(){var n,t,o=j(this),a=o.outerWidth(),l=o.outerHeight(),e=T(this,"marginLeft"),i=T(this,"marginTop"),s=a+e+T(this,"marginRight")+b.width,r=l+i+T(this,"marginBottom")+b.height,c=j.extend({},g),p=k(w.my,o.outerWidth(),o.outerHeight());"right"===u.my[0]?c.left-=a:"center"===u.my[0]&&(c.left-=a/2),"bottom"===u.my[1]?c.top-=l:"center"===u.my[1]&&(c.top-=l/2),c.left+=p[0],c.top+=p[1],A||(c.left=x(c.left),c.top=x(c.top)),n={marginLeft:e,marginTop:i},j.each(["left","top"],function(t,e){j.ui.position[_[t]]&&j.ui.position[_[t]][e](c,{targetWidth:d,targetHeight:f,elemWidth:a,elemHeight:l,collisionPosition:n,collisionWidth:s,collisionHeight:r,offset:[h[0]+p[0],h[1]+p[1]],my:u.my,at:u.at,within:y,elem:o})}),u.using&&(t=function(t){var e=m.left-c.left,n=e+d-a,i=m.top-c.top,s=i+f-l,r={target:{element:v,left:m.left,top:m.top,width:d,height:f},element:{element:o,left:c.left,top:c.top,width:a,height:l},horizontal:n<0?"left":0<e?"right":"center",vertical:s<0?"top":0<i?"bottom":"middle"};d<a&&C(e+n)<d&&(r.horizontal="center"),f<l&&C(i+s)<f&&(r.vertical="middle"),S(C(e),C(n))>S(C(i),C(s))?r.important="horizontal":r.important="vertical",u.using.call(this,t,r)}),o.offset(j.extend(c,{using:t}))})},j.ui.position={fit:{left:function(t,e){var n,i=e.within,s=i.isWindow?i.scrollLeft:i.offset.left,r=i.width,o=t.left-e.collisionPosition.marginLeft,a=s-o,l=o+e.collisionWidth-r-s;e.collisionWidth>r?0<a&&l<=0?(n=t.left+a+e.collisionWidth-r-s,t.left+=a-n):t.left=0<l&&a<=0?s:l<a?s+r-e.collisionWidth:s:0<a?t.left+=a:0<l?t.left-=l:t.left=S(t.left-o,t.left)},top:function(t,e){var n,i=e.within,s=i.isWindow?i.scrollTop:i.offset.top,r=e.within.height,o=t.top-e.collisionPosition.marginTop,a=s-o,l=o+e.collisionHeight-r-s;e.collisionHeight>r?0<a&&l<=0?(n=t.top+a+e.collisionHeight-r-s,t.top+=a-n):t.top=0<l&&a<=0?s:l<a?s+r-e.collisionHeight:s:0<a?t.top+=a:0<l?t.top-=l:t.top=S(t.top-o,t.top)}},flip:{left:function(t,e){var n,i,s=e.within,r=s.offset.left+s.scrollLeft,o=s.width,a=s.isWindow?s.scrollLeft:s.offset.left,l=t.left-e.collisionPosition.marginLeft,c=l-a,p=l+e.collisionWidth-o-a,u="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,h="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,d=-2*e.offset[0];c<0?((n=t.left+u+h+d+e.collisionWidth-o-r)<0||n<C(c))&&(t.left+=u+h+d):0<p&&(0<(i=t.left-e.collisionPosition.marginLeft+u+h+d-a)||C(i)<p)&&(t.left+=u+h+d)},top:function(t,e){var n,i,s=e.within,r=s.offset.top+s.scrollTop,o=s.height,a=s.isWindow?s.scrollTop:s.offset.top,l=t.top-e.collisionPosition.marginTop,c=l-a,p=l+e.collisionHeight-o-a,u="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,h="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,d=-2*e.offset[1];c<0?((i=t.top+u+h+d+e.collisionHeight-o-r)<0||i<C(c))&&(t.top+=u+h+d):0<p&&(0<(n=t.top-e.collisionPosition.marginTop+u+h+d-a)||C(n)<p)&&(t.top+=u+h+d)}},flipfit:{left:function(){j.ui.position.flip.left.apply(this,arguments),j.ui.position.fit.left.apply(this,arguments)},top:function(){j.ui.position.flip.top.apply(this,arguments),j.ui.position.fit.top.apply(this,arguments)}}},function(){var t,e,n,i,s,r=document.getElementsByTagName("body")[0],o=document.createElement("div");for(s in t=document.createElement(r?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&j.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"}),n)t.style[s]=n[s];t.appendChild(o),(e=r||document.documentElement).insertBefore(t,e.firstChild),o.style.cssText="position: absolute; left: 10.7432222px;",i=j(o).offset().left,A=10<i&&i<11,t.innerHTML="",e.removeChild(t)}()}();j.ui.position;j.widget("ui.draggable",j.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(t){var e=this.options;return this._blurActiveElement(t),!(this.helper||e.disabled||0<j(t.target).closest(".ui-resizable-handle").length)&&(this.handle=this._getHandle(t),!!this.handle&&(this._blockFrames(!0===e.iframeFix?"iframe":e.iframeFix),!0))},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=j(this);return j("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var e=this.document[0];if(this.handleElement.is(t.target))try{e.activeElement&&"body"!==e.activeElement.nodeName.toLowerCase()&&j(e.activeElement).blur()}catch(n){}},_mouseStart:function(t){var e=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),j.ui.ddmanager&&(j.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===j(this).css("position")}).length,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),j.ui.ddmanager&&!e.dropBehaviour&&j.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),j.ui.ddmanager&&j.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(t,e){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!e){var n=this._uiHash();if(!1===this._trigger("drag",t,n))return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",j.ui.ddmanager&&j.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var e=this,n=!1;return j.ui.ddmanager&&!this.options.dropBehaviour&&(n=j.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||!0===this.options.revert||j.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?j(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==e._trigger("stop",t)&&e._clear()}):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),j.ui.ddmanager&&j.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),j.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!j(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var e=this.options,n=j.isFunction(e.helper),i=n?j(e.helper.apply(this.element[0],[t])):"clone"===e.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===e.appendTo?this.element[0].parentNode:e.appendTo),n&&i[0]===this.element[0]&&this._setPositionRelative(),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),j.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),e=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==e&&j.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,n,i=this.options,s=this.document[0];this.relativeContainer=null,i.containment?"window"!==i.containment?"document"!==i.containment?i.containment.constructor!==Array?("parent"===i.containment&&(i.containment=this.helper[0].parentNode),(n=(e=j(i.containment))[0])&&(t=/(scroll|auto)/.test(e.css("overflow")),this.containment=[(parseInt(e.css("borderLeftWidth"),10)||0)+(parseInt(e.css("paddingLeft"),10)||0),(parseInt(e.css("borderTopWidth"),10)||0)+(parseInt(e.css("paddingTop"),10)||0),(t?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e.css("borderRightWidth"),10)||0)-(parseInt(e.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e.css("borderBottomWidth"),10)||0)-(parseInt(e.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=e)):this.containment=i.containment:this.containment=[0,0,j(s).width()-this.helperProportions.width-this.margins.left,(j(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[j(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,j(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,j(window).scrollLeft()+j(window).width()-this.helperProportions.width-this.margins.left,j(window).scrollTop()+(j(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(t,e){e||(e=this.position);var n="absolute"===t?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*n,left:e.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*n}},_generatePosition:function(t,e){var n,i,s,r,o=this.options,a=this._isRootNode(this.scrollParent[0]),l=t.pageX,c=t.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(i=this.relativeContainer.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),o.grid&&(s=o.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,c=n?s-this.offset.click.top>=n[1]||s-this.offset.click.top>n[3]?s:s-this.offset.click.top>=n[1]?s-o.grid[1]:s+o.grid[1]:s,r=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,l=n?r-this.offset.click.left>=n[0]||r-this.offset.click.left>n[2]?r:r-this.offset.click.left>=n[0]?r-o.grid[0]:r+o.grid[0]:r),"y"===o.axis&&(l=this.originalPageX),"x"===o.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,e,n){return n=n||this._uiHash(),j.ui.plugin.call(this,t,[e,n,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),j.Widget.prototype._trigger.call(this,t,e,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),j.ui.plugin.add("draggable","connectToSortable",{start:function(e,t,n){var i=j.extend({},t,{item:n.element});n.sortables=[],j(n.options.connectToSortable).each(function(){var t=j(this).sortable("instance");t&&!t.options.disabled&&(n.sortables.push(t),t.refreshPositions(),t._trigger("activate",e,i))})},stop:function(e,t,n){var i=j.extend({},t,{item:n.element});n.cancelHelperRemoval=!1,j.each(n.sortables,function(){var t=this;t.isOver?(t.isOver=0,n.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,i))})},drag:function(n,i,s){j.each(s.sortables,function(){var t=!1,e=this;e.positionAbs=s.positionAbs,e.helperProportions=s.helperProportions,e.offset.click=s.offset.click,e._intersectsWith(e.containerCache)&&(t=!0,j.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==e&&this._intersectsWith(this.containerCache)&&j.contains(e.element[0],this.element[0])&&(t=!1),t})),t?(e.isOver||(e.isOver=1,s._parent=i.helper.parent(),e.currentItem=i.helper.appendTo(e.element).data("ui-sortable-item",!0),e.options._helper=e.options.helper,e.options.helper=function(){return i.helper[0]},n.target=e.currentItem[0],e._mouseCapture(n,!0),e._mouseStart(n,!0,!0),e.offset.click.top=s.offset.click.top,e.offset.click.left=s.offset.click.left,e.offset.parent.left-=s.offset.parent.left-e.offset.parent.left,e.offset.parent.top-=s.offset.parent.top-e.offset.parent.top,s._trigger("toSortable",n),s.dropped=e.element,j.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,e.fromOutside=s),e.currentItem&&(e._mouseDrag(n),i.position=e.position)):e.isOver&&(e.isOver=0,e.cancelHelperRemoval=!0,e.options._revert=e.options.revert,e.options.revert=!1,e._trigger("out",n,e._uiHash(e)),e._mouseStop(n,!0),e.options.revert=e.options._revert,e.options.helper=e.options._helper,e.placeholder&&e.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(n),i.position=s._generatePosition(n,!0),s._trigger("fromSortable",n),s.dropped=!1,j.each(s.sortables,function(){this.refreshPositions()}))})}}),j.ui.plugin.add("draggable","cursor",{start:function(t,e,n){var i=j("body"),s=n.options;i.css("cursor")&&(s._cursor=i.css("cursor")),i.css("cursor",s.cursor)},stop:function(t,e,n){var i=n.options;i._cursor&&j("body").css("cursor",i._cursor)}}),j.ui.plugin.add("draggable","opacity",{start:function(t,e,n){var i=j(e.helper),s=n.options;i.css("opacity")&&(s._opacity=i.css("opacity")),i.css("opacity",s.opacity)},stop:function(t,e,n){var i=n.options;i._opacity&&j(e.helper).css("opacity",i._opacity)}}),j.ui.plugin.add("draggable","scroll",{start:function(t,e,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(t,e,n){var i=n.options,s=!1,r=n.scrollParentNotHidden[0],o=n.document[0];r!==o&&"HTML"!==r.tagName?(i.axis&&"x"===i.axis||(n.overflowOffset.top+r.offsetHeight-t.pageY<i.scrollSensitivity?r.scrollTop=s=r.scrollTop+i.scrollSpeed:t.pageY-n.overflowOffset.top<i.scrollSensitivity&&(r.scrollTop=s=r.scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(n.overflowOffset.left+r.offsetWidth-t.pageX<i.scrollSensitivity?r.scrollLeft=s=r.scrollLeft+i.scrollSpeed:t.pageX-n.overflowOffset.left<i.scrollSensitivity&&(r.scrollLeft=s=r.scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-j(o).scrollTop()<i.scrollSensitivity?s=j(o).scrollTop(j(o).scrollTop()-i.scrollSpeed):j(window).height()-(t.pageY-j(o).scrollTop())<i.scrollSensitivity&&(s=j(o).scrollTop(j(o).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-j(o).scrollLeft()<i.scrollSensitivity?s=j(o).scrollLeft(j(o).scrollLeft()-i.scrollSpeed):j(window).width()-(t.pageX-j(o).scrollLeft())<i.scrollSensitivity&&(s=j(o).scrollLeft(j(o).scrollLeft()+i.scrollSpeed)))),!1!==s&&j.ui.ddmanager&&!i.dropBehaviour&&j.ui.ddmanager.prepareOffsets(n,t)}}),j.ui.plugin.add("draggable","snap",{start:function(t,e,n){var i=n.options;n.snapElements=[],j(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var t=j(this),e=t.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:e.top,left:e.left})})},drag:function(t,e,n){var i,s,r,o,a,l,c,p,u,h,d=n.options,f=d.snapTolerance,m=e.offset.left,g=m+n.helperProportions.width,v=e.offset.top,y=v+n.helperProportions.height;for(u=n.snapElements.length-1;0<=u;u--)l=(a=n.snapElements[u].left-n.margins.left)+n.snapElements[u].width,p=(c=n.snapElements[u].top-n.margins.top)+n.snapElements[u].height,g<a-f||l+f<m||y<c-f||p+f<v||!j.contains(n.snapElements[u].item.ownerDocument,n.snapElements[u].item)?(n.snapElements[u].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,t,j.extend(n._uiHash(),{snapItem:n.snapElements[u].item})),n.snapElements[u].snapping=!1):("inner"!==d.snapMode&&(i=Math.abs(c-y)<=f,s=Math.abs(p-v)<=f,r=Math.abs(a-g)<=f,o=Math.abs(l-m)<=f,i&&(e.position.top=n._convertPositionTo("relative",{top:c-n.helperProportions.height,left:0}).top),s&&(e.position.top=n._convertPositionTo("relative",{top:p,left:0}).top),r&&(e.position.left=n._convertPositionTo("relative",{top:0,left:a-n.helperProportions.width}).left),o&&(e.position.left=n._convertPositionTo("relative",{top:0,left:l}).left)),h=i||s||r||o,"outer"!==d.snapMode&&(i=Math.abs(c-v)<=f,s=Math.abs(p-y)<=f,r=Math.abs(a-m)<=f,o=Math.abs(l-g)<=f,i&&(e.position.top=n._convertPositionTo("relative",{top:c,left:0}).top),s&&(e.position.top=n._convertPositionTo("relative",{top:p-n.helperProportions.height,left:0}).top),r&&(e.position.left=n._convertPositionTo("relative",{top:0,left:a}).left),o&&(e.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left)),!n.snapElements[u].snapping&&(i||s||r||o||h)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,t,j.extend(n._uiHash(),{snapItem:n.snapElements[u].item})),n.snapElements[u].snapping=i||s||r||o||h)}}),j.ui.plugin.add("draggable","stack",{start:function(t,e,n){var i,s=n.options,r=j.makeArray(j(s.stack)).sort(function(t,e){return(parseInt(j(t).css("zIndex"),10)||0)-(parseInt(j(e).css("zIndex"),10)||0)});r.length&&(i=parseInt(j(r[0]).css("zIndex"),10)||0,j(r).each(function(t){j(this).css("zIndex",i+t)}),this.css("zIndex",i+r.length))}}),j.ui.plugin.add("draggable","zIndex",{start:function(t,e,n){var i=j(e.helper),s=n.options;i.css("zIndex")&&(s._zIndex=i.css("zIndex")),i.css("zIndex",s.zIndex)},stop:function(t,e,n){var i=n.options;i._zIndex&&j(e.helper).css("zIndex",i._zIndex)}});j.ui.draggable;j.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,n=t.accept;this.isover=!1,this.isout=!0,this.accept=j.isFunction(n)?n:function(t){return t.is(n)},this.proportions=function(t){if(!arguments.length)return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});e=t},this._addToManager(t.scope),t.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){j.ui.ddmanager.droppables[t]=j.ui.ddmanager.droppables[t]||[],j.ui.ddmanager.droppables[t].push(this)},_splice:function(t){for(var e=0;e<t.length;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var t=j.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,e){if("accept"===t)this.accept=j.isFunction(e)?e:function(t){return t.is(e)};else if("scope"===t){var n=j.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(e)}this._super(t,e)},_activate:function(t){var e=j.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),e&&this._trigger("activate",t,this.ui(e))},_deactivate:function(t){var e=j.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),e&&this._trigger("deactivate",t,this.ui(e))},_over:function(t){var e=j.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(e)))},_out:function(t){var e=j.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(e)))},_drop:function(e,t){var n=t||j.ui.ddmanager.current,i=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=j(this).droppable("instance");if(t.options.greedy&&!t.options.disabled&&t.options.scope===n.options.scope&&t.accept.call(t.element[0],n.currentItem||n.element)&&j.ui.intersect(n,j.extend(t,{offset:t.element.offset()}),t.options.tolerance,e))return!(i=!0)}),!i&&(!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element)))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),j.ui.intersect=function(){function h(t,e,n){return e<=t&&t<e+n}return function(t,e,n,i){if(!e.offset)return!1;var s=(t.positionAbs||t.position.absolute).left+t.margins.left,r=(t.positionAbs||t.position.absolute).top+t.margins.top,o=s+t.helperProportions.width,a=r+t.helperProportions.height,l=e.offset.left,c=e.offset.top,p=l+e.proportions().width,u=c+e.proportions().height;switch(n){case"fit":return l<=s&&o<=p&&c<=r&&a<=u;case"intersect":return l<s+t.helperProportions.width/2&&o-t.helperProportions.width/2<p&&c<r+t.helperProportions.height/2&&a-t.helperProportions.height/2<u;case"pointer":return h(i.pageY,c,e.proportions().height)&&h(i.pageX,l,e.proportions().width);case"touch":return(c<=r&&r<=u||c<=a&&a<=u||r<c&&u<a)&&(l<=s&&s<=p||l<=o&&o<=p||s<l&&p<o);default:return!1}}}(),j.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,e){var n,i,s=j.ui.ddmanager.droppables[t.options.scope]||[],r=e?e.type:null,o=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();t:for(n=0;n<s.length;n++)if(!(s[n].options.disabled||t&&!s[n].accept.call(s[n].element[0],t.currentItem||t.element))){for(i=0;i<o.length;i++)if(o[i]===s[n].element[0]){s[n].proportions().height=0;continue t}s[n].visible="none"!==s[n].element.css("display"),s[n].visible&&("mousedown"===r&&s[n]._activate.call(s[n],e),s[n].offset=s[n].element.offset(),s[n].proportions({width:s[n].element[0].offsetWidth,height:s[n].element[0].offsetHeight}))}},drop:function(t,e){var n=!1;return j.each((
j.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&j.ui.intersect(t,this,this.options.tolerance,e)&&(n=this._drop.call(this,e)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,e)))}),n},dragStart:function(t,e){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||j.ui.ddmanager.prepareOffsets(t,e)})},drag:function(r,o){r.options.refreshPositions&&j.ui.ddmanager.prepareOffsets(r,o),j.each(j.ui.ddmanager.droppables[r.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var t,e,n,i=j.ui.intersect(r,this,this.options.tolerance,o),s=!i&&this.isover?"isout":i&&!this.isover?"isover":null;s&&(this.options.greedy&&(e=this.options.scope,(n=this.element.parents(":data(ui-droppable)").filter(function(){return j(this).droppable("instance").options.scope===e})).length&&((t=j(n[0]).droppable("instance")).greedyChild="isover"===s)),t&&"isover"===s&&(t.isover=!1,t.isout=!0,t._out.call(t,o)),this[s]=!0,this["isout"===s?"isover":"isout"]=!1,this["isover"===s?"_over":"_out"].call(this,o),t&&"isout"===s&&(t.isout=!1,t.isover=!0,t._over.call(t,o)))}})},dragStop:function(t,e){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||j.ui.ddmanager.prepareOffsets(t,e)}};j.ui.droppable,j.widget("ui.sortable",j.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,n){return e<=t&&t<e+n},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),j.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var t=this.items.length-1;0<=t;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,e){var n=null,i=!1,s=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(t),j(t.target).parents().each(function(){if(j.data(this,s.widgetName+"-item")===s)return n=j(this),!1}),j.data(t.target,s.widgetName+"-item")===s&&(n=j(t.target)),!!n&&(!(this.options.handle&&!e&&(j(this.options.handle,n).find("*").addBack().each(function(){this===t.target&&(i=!0)}),!i))&&(this.currentItem=n,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(t,e,n){var i,s,r=this.options;if((this.currentContainer=this).refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},j.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&"auto"!==r.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",r.cursor),this.storedStylesheet=j("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(s)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(i=this.containers.length-1;0<=i;i--)this.containers[i]._trigger("activate",t,this._uiHash(this));return j.ui.ddmanager&&(j.ui.ddmanager.current=this),j.ui.ddmanager&&!r.dropBehaviour&&j.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var e,n,i,s,r=this.options,o=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?this.scrollParent[0].scrollTop=o=this.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-this.overflowOffset.top<r.scrollSensitivity&&(this.scrollParent[0].scrollTop=o=this.scrollParent[0].scrollTop-r.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?this.scrollParent[0].scrollLeft=o=this.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-this.overflowOffset.left<r.scrollSensitivity&&(this.scrollParent[0].scrollLeft=o=this.scrollParent[0].scrollLeft-r.scrollSpeed)):(t.pageY-this.document.scrollTop()<r.scrollSensitivity?o=this.document.scrollTop(this.document.scrollTop()-r.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<r.scrollSensitivity&&(o=this.document.scrollTop(this.document.scrollTop()+r.scrollSpeed)),t.pageX-this.document.scrollLeft()<r.scrollSensitivity?o=this.document.scrollLeft(this.document.scrollLeft()-r.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<r.scrollSensitivity&&(o=this.document.scrollLeft(this.document.scrollLeft()+r.scrollSpeed))),!1!==o&&j.ui.ddmanager&&!r.dropBehaviour&&j.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e=this.items.length-1;0<=e;e--)if(i=(n=this.items[e]).item[0],(s=this._intersectsWithPointer(n))&&n.instance===this.currentContainer&&!(i===this.currentItem[0]||this.placeholder[1===s?"next":"prev"]()[0]===i||j.contains(this.placeholder[0],i)||"semi-dynamic"===this.options.type&&j.contains(this.element[0],i))){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(t,n),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),j.ui.ddmanager&&j.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,e){if(t){if(j.ui.ddmanager&&!this.options.dropBehaviour&&j.ui.ddmanager.drop(this,t),this.options.revert){var n=this,i=this.placeholder.offset(),s=this.options.axis,r={};s&&"x"!==s||(r.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(r.top=i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,j(this.helper).animate(r,parseInt(this.options.revert,10)||500,function(){n._clear(t)})}else this._clear(t,e);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;0<=t;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),j.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?j(this.domPosition.prev).after(this.currentItem):j(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var t=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},j(t).each(function(){var t=(j(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);t&&n.push((e.key||t[1]+"[]")+"="+(e.key&&e.expression?t[1]:t[2]))}),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(t){var e=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},e.each(function(){n.push(j(t.item||this).attr(t.attribute||"id")||"")}),n},_intersectsWith:function(t){var e=this.positionAbs.left,n=e+this.helperProportions.width,i=this.positionAbs.top,s=i+this.helperProportions.height,r=t.left,o=r+t.width,a=t.top,l=a+t.height,c=this.offset.click.top,p=this.offset.click.left,u="x"===this.options.axis||a<i+c&&i+c<l,h="y"===this.options.axis||r<e+p&&e+p<o,d=u&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?d:r<e+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&a<i+this.helperProportions.height/2&&s-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),i=e&&n,s=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return!!i&&(this.floating?r&&"right"===r||"down"===s?2:1:s&&("down"===s?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),n=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?"right"===s&&n||"left"===s&&!n:i&&("down"===i&&e||"up"===i&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(0<t?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(0<t?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(t){function e(){o.push(this)}var n,i,s,r,o=[],a=[],l=this._connectWith();if(l&&t)for(n=l.length-1;0<=n;n--)for(i=(s=j(l[n],this.document[0])).length-1;0<=i;i--)(r=j.data(s[i],this.widgetFullName))&&r!==this&&!r.options.disabled&&a.push([j.isFunction(r.options.items)?r.options.items.call(r.element):j(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(a.push([j.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):j(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=a.length-1;0<=n;n--)a[n][0].each(e);return j(o)},_removeCurrentsFromItems:function(){var n=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=j.grep(this.items,function(t){for(var e=0;e<n.length;e++)if(n[e]===t.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var e,n,i,s,r,o,a,l,c=this.items,p=[[j.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):j(this.options.items,this.element),this]],u=this._connectWith();if(u&&this.ready)for(e=u.length-1;0<=e;e--)for(n=(i=j(u[e],this.document[0])).length-1;0<=n;n--)(s=j.data(i[n],this.widgetFullName))&&s!==this&&!s.options.disabled&&(p.push([j.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):j(s.options.items,s.element),s]),this.containers.push(s));for(e=p.length-1;0<=e;e--)for(r=p[e][1],n=0,l=(o=p[e][0]).length;n<l;n++)(a=j(o[n])).data(this.widgetName+"-item",r),c.push({item:a,instance:r,width:0,height:0,left:0,top:0})},refreshPositions:function(t){var e,n,i,s;for(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),e=this.items.length-1;0<=e;e--)(n=this.items[e]).instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(i=this.options.toleranceElement?j(this.options.toleranceElement,n.item):n.item,t||(n.width=i.outerWidth(),n.height=i.outerHeight()),s=i.offset(),n.left=s.left,n.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(e=this.containers.length-1;0<=e;e--)s=this.containers[e].element.offset(),this.containers[e].containerCache.left=s.left,this.containers[e].containerCache.top=s.top,this.containers[e].containerCache.width=this.containers[e].element.outerWidth(),this.containers[e].containerCache.height=this.containers[e].element.outerHeight();return this},_createPlaceholder:function(n){var i,s=(n=n||this).options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var t=n.currentItem[0].nodeName.toLowerCase(),e=j("<"+t+">",n.document[0]).addClass(i||n.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===t?n._createTrPlaceholder(n.currentItem.find("tr").eq(0),j("<tr>",n.document[0]).appendTo(e)):"tr"===t?n._createTrPlaceholder(n.currentItem,e):"img"===t&&e.attr("src",n.currentItem.attr("src")),i||e.css("visibility","hidden"),e},update:function(t,e){i&&!s.forcePlaceholderSize||(e.height()||e.height(n.currentItem.innerHeight()-parseInt(n.currentItem.css("paddingTop")||0,10)-parseInt(n.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(n.currentItem.innerWidth()-parseInt(n.currentItem.css("paddingLeft")||0,10)-parseInt(n.currentItem.css("paddingRight")||0,10)))}}),n.placeholder=j(s.placeholder.element.call(n.element,n.currentItem)),n.currentItem.after(n.placeholder),s.placeholder.update(n,n.placeholder)},_createTrPlaceholder:function(t,e){var n=this;t.children().each(function(){j("<td>&#160;</td>",n.document[0]).attr("colspan",j(this).attr("colspan")||1).appendTo(e)})},_contactContainers:function(t){var e,n,i,s,r,o,a,l,c,p,u=null,h=null;for(e=this.containers.length-1;0<=e;e--)if(!j.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(u&&j.contains(this.containers[e].element[0],u.element[0]))continue;u=this.containers[e],h=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",t,this._uiHash(this)),this.containers[e].containerCache.over=0);if(u)if(1===this.containers.length)this.containers[h].containerCache.over||(this.containers[h]._trigger("over",t,this._uiHash(this)),this.containers[h].containerCache.over=1);else{for(i=1e4,s=null,r=(c=u.floating||this._isFloating(this.currentItem))?"left":"top",o=c?"width":"height",p=c?"clientX":"clientY",n=this.items.length-1;0<=n;n--)j.contains(this.containers[h].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(a=this.items[n].item.offset()[r],l=!1,t[p]-a>this.items[n][o]/2&&(l=!0),Math.abs(t[p]-a)<i&&(i=Math.abs(t[p]-a),s=this.items[n],this.direction=l?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[h])return void(this.currentContainer.containerCache.over||(this.containers[h]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));s?this._rearrange(t,s,null,!0):this._rearrange(t,null,this.containers[h].element,!0),this._trigger("change",t,this._uiHash()),this.containers[h]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[h],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[h]._trigger("over",t,this._uiHash(this)),this.containers[h].containerCache.over=1}},_createHelper:function(t){var e=this.options,n=j.isFunction(e.helper)?j(e.helper.apply(this.element[0],[t,this.currentItem])):"clone"===e.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||j("parent"!==e.appendTo?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),n[0].style.width&&!e.forceHelperSize||n.width(this.currentItem.width()),n[0].style.height&&!e.forceHelperSize||n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),j.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&j.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&j.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,n,i=this.options;"parent"===i.containment&&(i.containment=this.helper[0].parentNode),"document"!==i.containment&&"window"!==i.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===i.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===i.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||(t=j(i.containment)[0],e=j(i.containment).offset(),n="hidden"!==j(t).css("overflow"),this.containment=[e.left+(parseInt(j(t).css("borderLeftWidth"),10)||0)+(parseInt(j(t).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(j(t).css("borderTopWidth"),10)||0)+(parseInt(j(t).css("paddingTop"),10)||0)-this.margins.top,e.left+(n?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(j(t).css("borderLeftWidth"),10)||0)-(parseInt(j(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(n?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(j(t).css("borderTopWidth"),10)||0)-(parseInt(j(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,e){e||(e=this.position);var n="absolute"===t?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&j.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:e.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:i.scrollTop())*n,left:e.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*n}},_generatePosition:function(t){var e,n,i=this.options,s=t.pageX,r=t.pageY,o="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&j.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(o[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(r=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(r=this.containment[3]+this.offset.click.top)),i.grid&&(e=this.originalPageY+Math.round((r-this.originalPageY)/i.grid[1])*i.grid[1],r=this.containment?e-this.offset.click.top>=this.containment[1]&&e-this.offset.click.top<=this.containment[3]?e:e-this.offset.click.top>=this.containment[1]?e-i.grid[1]:e+i.grid[1]:e,n=this.originalPageX+Math.round((s-this.originalPageX)/i.grid[0])*i.grid[0],s=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-i.grid[0]:n+i.grid[0]:n)),{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:o.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:o.scrollLeft())}},_rearrange:function(t,e,n,i){n?n[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var s=this.counter;this._delay(function(){s===this.counter&&this.refreshPositions(!i)})},_clear:function(t,e){function n(e,n,i){return function(t){i._trigger(e,t,n._uiHash(n))}}this.reverting=!1;var i,s=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&s.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||s.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(s.push(function(t){this._trigger("remove",t,this._uiHash())}),s.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),s.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;0<=i;i--)e||s.push(n("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(s.push(n("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(i=0;i<s.length;i++)s[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===j.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var e=t||this;return{helper:e.helper,placeholder:e.placeholder||j([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:t?t.element:null}}}),j.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=j(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||!1!==t.active&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():j()}},_createIcons:function(){var t=this.options.icons;t&&(j("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){"active"!==t?("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||!1!==this.options.active||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),"disabled"===t&&(this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e))):this._activate(e)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var e=j.ui.keyCode,n=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case e.RIGHT:case e.DOWN:s=this.headers[(i+1)%n];break;case e.LEFT:case e.UP:s=this.headers[(i-1+n)%n];break;case e.SPACE:case e.ENTER:this._eventHandler(t);break;case e.HOME:s=this.headers[0];break;case e.END:s=this.headers[n-1]}s&&(j(t.target).attr("tabIndex",-1),j(s).attr("tabIndex",0),s.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===j.ui.keyCode.UP&&t.ctrlKey&&j(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),!1===t.active&&!0===t.collapsible||!this.headers.length?(t.active=!1,this.active=j()):!1===t.active?this._activate(0):this.active.length&&!j.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=j()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))},_refresh:function(){var n,t=this.options,e=t.heightStyle,i=this.element.parent();this.active=this._findActive(t.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=j(this),e=t.uniqueId().attr("id"),n=t.next(),i=n.uniqueId().attr("id");t.attr("aria-controls",i),n.attr("aria-labelledby",e)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(t.event),"fill"===e?(n=i.height(),this.element.siblings(":visible").each(function(){var t=j(this),e=t.css("position");"absolute"!==e&&"fixed"!==e&&(n-=t.outerHeight(!0))}),this.headers.each(function(){n-=j(this).outerHeight(!0)}),this.headers.next().each(function(){j(this).height(Math.max(0,n-j(this).innerHeight()+j(this).height()))}).css("overflow","auto")):"auto"===e&&(n=0,this.headers.next().each(function(){n=Math.max(n,j(this).css("height","").height())}).height(n))},_activate:function(t){var e=this._findActive(t)[0];e!==this.active[0]&&(e=e||this.active[0],this._eventHandler({target:e,currentTarget:e,preventDefault:j.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):j()},_setupEvents:function(t){var n={keydown:"_keydown"};t&&j.each(t.split(" "),function(t,e){n[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var e=this.options,n=this.active,i=j(t.currentTarget),s=i[0]===n[0],r=s&&e.collapsible,o=r?j():i.next(),a=n.next(),l={oldHeader:n,oldPanel:a,newHeader:r?j():i,newPanel:o};t.preventDefault(),s&&!e.collapsible||!1===this._trigger("beforeActivate",t,l)||(e.active=!r&&this.headers.index(i),this.active=s?j():i,this._toggle(l),n.removeClass("ui-accordion-header-active ui-state-active"),e.icons&&n.children(".ui-accordion-header-icon").removeClass(e.icons.activeHeader).addClass(e.icons.header),s||(i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),e.icons&&i.children(".ui-accordion-header-icon").removeClass(e.icons.header).addClass(e.icons.activeHeader),i.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var e=t.newPanel,n=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=e,
this.prevHide=n,this.options.animate?this._animate(e,n,t):(n.hide(),e.show(),this._toggleComplete(t)),n.attr({"aria-hidden":"true"}),n.prev().attr({"aria-selected":"false","aria-expanded":"false"}),e.length&&n.length?n.prev().attr({tabIndex:-1,"aria-expanded":"false"}):e.length&&this.headers.filter(function(){return 0===parseInt(j(this).attr("tabIndex"),10)}).attr("tabIndex",-1),e.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(t,n,e){var i,s,r,o=this,a=0,l=t.css("box-sizing"),c=t.length&&(!n.length||t.index()<n.index()),p=this.options.animate||{},u=c&&p.down||p,h=function(){o._toggleComplete(e)};return"number"==typeof u&&(r=u),"string"==typeof u&&(s=u),s=s||u.easing||p.easing,r=r||u.duration||p.duration,n.length?t.length?(i=t.show().outerHeight(),n.animate(this.hideProps,{duration:r,easing:s,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(this.showProps,{duration:r,easing:s,complete:h,step:function(t,e){e.now=Math.round(t),"height"!==e.prop?"content-box"===l&&(a+=e.now):"content"!==o.options.heightStyle&&(e.now=Math.round(i-n.outerHeight()-a),a=0)}})):n.animate(this.hideProps,r,s,h):t.animate(this.showProps,r,s,h)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),j.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(t){var e=j(t.target);!this.mouseHandled&&e.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),e.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&j(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var e=j(t.currentTarget);e.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,e)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var n=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,n)},blur:function(t){this._delay(function(){j.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=j(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){var e,n,i,s,r=!0;switch(t.keyCode){case j.ui.keyCode.PAGE_UP:this.previousPage(t);break;case j.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case j.ui.keyCode.HOME:this._move("first","first",t);break;case j.ui.keyCode.END:this._move("last","last",t);break;case j.ui.keyCode.UP:this.previous(t);break;case j.ui.keyCode.DOWN:this.next(t);break;case j.ui.keyCode.LEFT:this.collapse(t);break;case j.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case j.ui.keyCode.ENTER:case j.ui.keyCode.SPACE:this._activate(t);break;case j.ui.keyCode.ESCAPE:this.collapse(t);break;default:r=!1,n=this.previousFilter||"",i=String.fromCharCode(t.keyCode),s=!1,clearTimeout(this.filterTimer),i===n?s=!0:i=n+i,e=this._filterMenuItems(i),(e=s&&-1!==e.index(this.active.next())?this.active.nextAll(".ui-menu-item"):e).length||(i=String.fromCharCode(t.keyCode),e=this._filterMenuItems(i)),e.length?(this.focus(t,e),this.previousFilter=i,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}r&&t.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(t):this.select(t))},refresh:function(){var t,e=this,i=this.options.icons.submenu,n=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),n.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=j(this),e=t.parent(),n=j("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);e.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",e.attr("id"))}),(t=n.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var t=j(this);e._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),t.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),t.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!j.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},focus:function(t,e){var n,i;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),i=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(n=e.children(".ui-menu")).length&&t&&/^mouse/.test(t.type)&&this._startOpening(n),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(t){var e,n,i,s,r,o;this._hasScroll()&&(e=parseFloat(j.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(j.css(this.activeMenu[0],"paddingTop"))||0,i=t.offset().top-this.activeMenu.offset().top-e-n,s=this.activeMenu.scrollTop(),r=this.activeMenu.height(),o=t.outerHeight(),i<0?this.activeMenu.scrollTop(s+i):r<i+o&&this.activeMenu.scrollTop(s+i-r+o))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(t){var e=j.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(e)},collapseAll:function(e,n){clearTimeout(this.timer),this.timer=this._delay(function(){var t=n?this.element:j(e&&e.target).closest(this.element.find(".ui-menu"));t.length||(t=this.element),this._close(t),this.blur(e),this.activeMenu=t},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!j(t.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,n){var i;this.active&&(i="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),i&&i.length&&this.active||(i=this.activeMenu.find(this.options.items)[e]()),this.focus(n,i)},nextPage:function(t){var e,n,i;this.active?this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(e=j(this)).offset().top-n-i<0}),this.focus(t,e)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())):this.next(t)},previousPage:function(t){var e,n,i;this.active?this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return 0<(e=j(this)).offset().top-n+i}),this.focus(t,e)):this.focus(t,this.activeMenu.find(this.options.items).first())):this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||j(t.target).closest(".ui-menu-item");var e={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,e)},_filterMenuItems:function(t){var e=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),n=new RegExp("^"+e,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return n.test(j.trim(j(this).text()))})}});j.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var n,i,s,t=this.element[0].nodeName.toLowerCase(),e="textarea"===t,r="input"===t;this.isMultiLine=!!e||!r&&this.element.prop("isContentEditable"),this.valueMethod=this.element[e||r?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(t){if(this.element.prop("readOnly"))i=s=n=!0;else{i=s=n=!1;var e=j.ui.keyCode;switch(t.keyCode){case e.PAGE_UP:n=!0,this._move("previousPage",t);break;case e.PAGE_DOWN:n=!0,this._move("nextPage",t);break;case e.UP:n=!0,this._keyEvent("previous",t);break;case e.DOWN:n=!0,this._keyEvent("next",t);break;case e.ENTER:this.menu.active&&(n=!0,t.preventDefault(),this.menu.select(t));break;case e.TAB:this.menu.active&&this.menu.select(t);break;case e.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(t),t.preventDefault());break;default:i=!0,this._searchTimeout(t)}}},keypress:function(t){if(n)return n=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||t.preventDefault());if(!i){var e=j.ui.keyCode;switch(t.keyCode){case e.PAGE_UP:this._move("previousPage",t);break;case e.PAGE_DOWN:this._move("nextPage",t);break;case e.UP:this._keyEvent("previous",t);break;case e.DOWN:this._keyEvent("next",t)}}},input:function(t){if(s)return s=!1,void t.preventDefault();this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),this._change(t))}}),this._initSource(),this.menu=j("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];j(t.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(t){t.target===e.element[0]||t.target===n||j.contains(n,t.target)||e.close()})})},menufocus:function(t,e){var n,i;if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){j(t.target).trigger(t.originalEvent)});i=e.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:i})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(i.value),(n=e.item.attr("aria-label")||i.value)&&j.trim(n).length&&(this.liveRegion.children().hide(),j("<div>").text(n).appendTo(this.liveRegion))},menuselect:function(t,e){var n=e.item.data("ui-autocomplete-item"),i=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i,this.selectedItem=n})),!1!==this._trigger("select",t,{item:n})&&this._value(n.value),this.term=this._value(),this.close(t),this.selectedItem=n}}),this.liveRegion=j("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?j(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var n,i,s=this;j.isArray(this.options.source)?(n=this.options.source,this.source=function(t,e){e(j.ui.autocomplete.filter(n,t.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,e){s.xhr&&s.xhr.abort(),s.xhr=j.ajax({url:i,data:t,dataType:"json",success:function(t){e(t)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(i){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),e=this.menu.element.is(":visible"),n=i.altKey||i.ctrlKey||i.metaKey||i.shiftKey;t&&(!t||e||n)||(this.selectedItem=null,this.search(null,i))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return j.proxy(function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:j.map(t,function(t){return"string"==typeof t?{label:t,value:t}:j.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var e=this.menu.element.empty();this._renderMenu(e,t),this.isNewMenu=!0,this.menu.refresh(),e.show(),this._resizeMenu(),e.position(j.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(n,t){var i=this;j.each(t,function(t,e){i._renderItemData(n,e)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(t,e){return j("<li>").text(e.label).appendTo(t)},_move:function(t,e){if(this.menu.element.is(":visible"))return this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[t](e);this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(t,e),e.preventDefault())}}),j.extend(j.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,e){var n=new RegExp(j.ui.autocomplete.escapeRegex(e),"i");return j.grep(t,function(t){return n.test(t.label||t.value||t)})}}),j.widget("ui.autocomplete",j.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(1<t?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),j("<div>").text(e).appendTo(this.liveRegion))}});j.ui.autocomplete}),function(){function t(a){function l(t,e,n,i,s,r){for(;0<=s&&s<r;s+=a){var o=i?i[s]:s;n=e(n,t[o],o,t)}return n}return function(t,e,n,i){e=b(e,i,4);var s=!C(t)&&y.keys(t),r=(s||t).length,o=0<a?0:r-1;return arguments.length<3&&(n=t[s?s[o]:o],o+=a),l(t,e,n,s,o,r)}}function e(r){return function(t,e,n){e=_(e,n);for(var i=S(t),s=0<r?0:i-1;0<=s&&s<i;s+=r)if(e(t[s],s,t))return s;return-1}}function n(r,o,a){return function(t,e,n){var i=0,s=S(t);if("number"==typeof n)0<r?i=0<=n?n:Math.max(n+s,i):s=0<=n?Math.min(n+1,s):n+s+1;else if(a&&n&&s)return t[n=a(t,e)]===e?n:-1;if(e!=e)return 0<=(n=o(p.call(t,i,s),y.isNaN))?n+i:-1;for(n=0<r?i:s-1;0<=n&&n<s;n+=r)if(t[n]===e)return n;return-1}}function i(t,e){var n=E.length,i=t.constructor,s=y.isFunction(i)&&i.prototype||a,r="constructor";for(y.has(t,r)&&!y.contains(e,r)&&e.push(r);n--;)(r=E[n])in t&&t[r]!==s[r]&&!y.contains(e,r)&&e.push(r)}var s=this,r=s._,o=Array.prototype,a=Object.prototype,l=Function.prototype,c=o.push,p=o.slice,u=a.toString,h=a.hasOwnProperty,d=Array.isArray,f=Object.keys,m=l.bind,g=Object.create,v=function(){},y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};"undefined"!=typeof exports?(void 0!==module&&module.exports&&(exports=module.exports=y),exports._=y):s._=y,y.VERSION="1.8.3";var b=function(s,r,t){if(void 0===r)return s;switch(null==t?3:t){case 1:return function(t){return s.call(r,t)};case 2:return function(t,e){return s.call(r,t,e)};case 3:return function(t,e,n){return s.call(r,t,e,n)};case 4:return function(t,e,n,i){return s.call(r,t,e,n,i)}}return function(){return s.apply(r,arguments)}},_=function(t,e,n){return null==t?y.identity:y.isFunction(t)?b(t,e,n):y.isObject(t)?y.matcher(t):y.property(t)};y.iteratee=function(t,e){return _(t,e,Infinity)};var w=function(l,c){return function(t){var e=arguments.length;if(e<2||null==t)return t;for(var n=1;n<e;n++)for(var i=arguments[n],s=l(i),r=s.length,o=0;o<r;o++){var a=s[o];c&&void 0!==t[a]||(t[a]=i[a])}return t}},k=function(t){if(!y.isObject(t))return{};if(g)return g(t);v.prototype=t;var e=new v;return v.prototype=null,e},T=function(e){return function(t){return null==t?void 0:t[e]}},A=Math.pow(2,53)-1,S=T("length"),C=function(t){var e=S(t);return"number"==typeof e&&0<=e&&e<=A};y.each=y.forEach=function(t,e,n){var i,s;if(e=b(e,n),C(t))for(i=0,s=t.length;i<s;i++)e(t[i],i,t);else{var r=y.keys(t);for(i=0,s=r.length;i<s;i++)e(t[r[i]],r[i],t)}return t},y.map=y.collect=function(t,e,n){e=_(e,n);for(var i=!C(t)&&y.keys(t),s=(i||t).length,r=Array(s),o=0;o<s;o++){var a=i?i[o]:o;r[o]=e(t[a],a,t)}return r},y.reduce=y.foldl=y.inject=t(1),y.reduceRight=y.foldr=t(-1),y.find=y.detect=function(t,e,n){var i;if(void 0!==(i=C(t)?y.findIndex(t,e,n):y.findKey(t,e,n))&&-1!==i)return t[i]},y.filter=y.select=function(t,i,e){var s=[];return i=_(i,e),y.each(t,function(t,e,n){i(t,e,n)&&s.push(t)}),s},y.reject=function(t,e,n){return y.filter(t,y.negate(_(e)),n)},y.every=y.all=function(t,e,n){e=_(e,n);for(var i=!C(t)&&y.keys(t),s=(i||t).length,r=0;r<s;r++){var o=i?i[r]:r;if(!e(t[o],o,t))return!1}return!0},y.some=y.any=function(t,e,n){e=_(e,n);for(var i=!C(t)&&y.keys(t),s=(i||t).length,r=0;r<s;r++){var o=i?i[r]:r;if(e(t[o],o,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,n,i){return C(t)||(t=y.values(t)),("number"!=typeof n||i)&&(n=0),0<=y.indexOf(t,e,n)},y.invoke=function(t,n){var i=p.call(arguments,2),s=y.isFunction(n);return y.map(t,function(t){var e=s?n:t[n];return null==e?e:e.apply(t,i)})},y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,i,e){var n,s,r=-Infinity,o=-Infinity;if(null==i&&null!=t)for(var a=0,l=(t=C(t)?t:y.values(t)).length;a<l;a++)n=t[a],r<n&&(r=n);else i=_(i,e),y.each(t,function(t,e,n){s=i(t,e,n),(o<s||s===-Infinity&&r===-Infinity)&&(r=t,o=s)});return r},y.min=function(t,i,e){var n,s,r=Infinity,o=Infinity;if(null==i&&null!=t)for(var a=0,l=(t=C(t)?t:y.values(t)).length;a<l;a++)(n=t[a])<r&&(r=n);else i=_(i,e),y.each(t,function(t,e,n){((s=i(t,e,n))<o||s===Infinity&&r===Infinity)&&(r=t,o=s)});return r},y.shuffle=function(t){for(var e,n=C(t)?t:y.values(t),i=n.length,s=Array(i),r=0;r<i;r++)(e=y.random(0,r))!==r&&(s[r]=s[e]),s[e]=n[r];return s},y.sample=function(t,e,n){return null==e||n?(C(t)||(t=y.values(t)),t[y.random(t.length-1)]):y.shuffle(t).slice(0,Math.max(0,e))},y.sortBy=function(t,i,e){return i=_(i,e),y.pluck(y.map(t,function(t,e,n){return{value:t,index:e,criteria:i(t,e,n)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(i<n||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")};var x=function(o){return function(i,s,t){var r={};return s=_(s,t),y.each(i,function(t,e){var n=s(t,e,i);o(r,t,n)}),r}};y.groupBy=x(function(t,e,n){y.has(t,n)?t[n].push(e):t[n]=[e]}),y.indexBy=x(function(t,e,n){t[n]=e}),y.countBy=x(function(t,e,n){y.has(t,n)?t[n]++:t[n]=1}),y.toArray=function(t){return t?y.isArray(t)?p.call(t):C(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:C(t)?t.length:y.keys(t).length},y.partition=function(t,i,e){i=_(i,e);var s=[],r=[];return y.each(t,function(t,e,n){(i(t,e,n)?s:r).push(t)}),[s,r]},y.first=y.head=y.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,n){return p.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},y.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,n){return p.call(t,null==e||n?1:e)},y.compact=function(t){return y.filter(t,y.identity)};var j=function(t,e,n,i){for(var s=[],r=0,o=i||0,a=S(t);o<a;o++){var l=t[o];if(C(l)&&(y.isArray(l)||y.isArguments(l))){e||(l=j(l,e,n));var c=0,p=l.length;for(s.length+=p;c<p;)s[r++]=l[c++]}else n||(s[r++]=l)}return s};y.flatten=function(t,e){return j(t,e,!1)},y.without=function(t){return y.difference(t,p.call(arguments,1))},y.uniq=y.unique=function(t,e,n,i){y.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=_(n,i));for(var s=[],r=[],o=0,a=S(t);o<a;o++){var l=t[o],c=n?n(l,o,t):l;e?(o&&r===c||s.push(l),r=c):n?y.contains(r,c)||(r.push(c),s.push(l)):y.contains(s,l)||s.push(l)}return s},y.union=function(){return y.uniq(j(arguments,!0,!0))},y.intersection=function(t){for(var e=[],n=arguments.length,i=0,s=S(t);i<s;i++){var r=t[i];if(!y.contains(e,r)){for(var o=1;o<n&&y.contains(arguments[o],r);o++);o===n&&e.push(r)}}return e},y.difference=function(t){var e=j(arguments,!0,!0,1);return y.filter(t,function(t){return!y.contains(e,t)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(t){for(var e=t&&y.max(t,S).length||0,n=Array(e),i=0;i<e;i++)n[i]=y.pluck(t,i);return n},y.object=function(t,e){for(var n={},i=0,s=S(t);i<s;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},y.findIndex=e(1),y.findLastIndex=e(-1),y.sortedIndex=function(t,e,n,i){for(var s=(n=_(n,i,1))(e),r=0,o=S(t);r<o;){var a=Math.floor((r+o)/2);n(t[a])<s?r=a+1:o=a}return r},y.indexOf=n(1,y.findIndex,y.sortedIndex),y.lastIndexOf=n(-1,y.findLastIndex),y.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),s=Array(i),r=0;r<i;r++,t+=n)s[r]=t;return s};var P=function(t,e,n,i,s){if(!(i instanceof e))return t.apply(n,s);var r=k(t.prototype),o=t.apply(r,s);return y.isObject(o)?o:r};y.bind=function(t,e){if(m&&t.bind===m)return m.apply(t,p.call(arguments,1));if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var n=p.call(arguments,2),i=function(){return P(t,i,e,this,n.concat(p.call(arguments)))};return i},y.partial=function(s){var r=p.call(arguments,1),o=function(){for(var t=0,e=r.length,n=Array(e),i=0;i<e;i++)n[i]=r[i]===y?arguments[t++]:r[i];for(;t<arguments.length;)n.push(arguments[t++]);return P(s,o,this,this,n)};return o},y.bindAll=function(t){var e,n,i=arguments.length;if(i<=1)throw new Error("bindAll must be passed function names");for(e=1;e<i;e++)t[n=arguments[e]]=y.bind(t[n],t);return t},y.memoize=function(i,s){var r=function(t){var e=r.cache,n=""+(s?s.apply(this,arguments):t);return y.has(e,n)||(e[n]=i.apply(this,arguments)),e[n]};return r.cache={},r},y.delay=function(t,e){var n=p.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},y.defer=y.partial(y.delay,y,1),y.throttle=function(n,i,s){var r,o,a,l=null,c=0;s||(s={});var p=function(){c=!1===s.leading?0:y.now(),l=null,a=n.apply(r,o),l||(r=o=null)};return function(){var t=y.now();c||!1!==s.leading||(c=t);var e=i-(t-c);return r=this,o=arguments,e<=0||i<e?(l&&(clearTimeout(l),l=null),c=t,a=n.apply(r,o),l||(r=o=null)):l||!1===s.trailing||(l=setTimeout(p,e)),a}},y.debounce=function(e,n,i){var s,r,o,a,l,c=function(){var t=y.now()-a;t<n&&0<=t?s=setTimeout(c,n-t):(s=null,i||(l=e.apply(o,r),s||(o=r=null)))};return function(){o=this,r=arguments,a=y.now();var t=i&&!s;return s||(s=setTimeout(c,n)),t&&(l=e.apply(o,r),o=r=null),l}},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var n=arguments,i=n.length-1;return function(){for(var t=i,e=n[i].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},y.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},y.before=function(t,e){var n;return function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},y.once=y.partial(y.before,2);var I=!{toString:null}.propertyIsEnumerable("toString"),E=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];y.keys=function(t){if(!y.isObject(t))return[];if(f)return f(t);var e=[];for(var n in t)y.has(t,n)&&e.push(n);return I&&i(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var n in t)e.push(n);return I&&i(t,e),e},y.values=function(t){for(var e=y.keys(t),n=e.length,i=Array(n),s=0;s<n;s++)i[s]=t[e[s]];return i},y.mapObject=function(t,e,n){e=_(e,n);for(var i,s=y.keys(t),r=s.length,o={},a=0;a<r;a++)o[i=s[a]]=e(t[i],i,t);return o},y.pairs=function(t){for(var e=y.keys(t),n=e.length,i=Array(n),s=0;s<n;s++)i[s]=[e[s],t[e[s]]];return i},y.invert=function(t){for(var e={},n=y.keys(t),i=0,s=n.length;i<s;i++)e[t[n[i]]]=n[i];return e},y.functions=y.methods=function(t){var e=[];for(var n in t)y.isFunction(t[n])&&e.push(n);return e.sort()},y.extend=w(y.allKeys),y.extendOwn=y.assign=w(y.keys),y.findKey=function(t,e,n){e=_(e,n);for(var i,s=y.keys(t),r=0,o=s.length;r<o;r++)if(e(t[i=s[r]],i,t))return i},y.pick=function(t,e,n){var i,s,r={},o=t;if(null==o)return r;y.isFunction(e)?(s=y.allKeys(o),i=b(e,n)):(s=j(arguments,!1,!1,1),i=function(t,e,n){return e in n},o=Object(o));for(var a=0,l=s.length;a<l;a++){var c=s[a],p=o[c];i(p,c,o)&&(r[c]=p)}return r},y.omit=function(t,e,n){if(y.isFunction(e))e=y.negate(e);else{var i=y.map(j(arguments,!1,!1,1),String);e=function(t,e){return!y.contains(i,e)}}return y.pick(t,e,n)},y.defaults=w(y.allKeys,!0),y.create=function(t,e){var n=k(t);return e&&y.extendOwn(n,e),n},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var n=y.keys(e),i=n.length;if(null==t)return!i;for(var s=Object(t),r=0;r<i;r++){var o=n[r];if(e[o]!==s[o]||!(o in s))return!1}return!0};var D=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var s=u.call(t);if(s!==u.call(e))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var r="[object Array]"===s;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var o=t.constructor,a=e.constructor;if(o!==a&&!(y.isFunction(o)&&o instanceof o&&y.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[];for(var l=(n=n||[]).length;l--;)if(n[l]===t)return i[l]===e;if(n.push(t),i.push(e),r){if((l=t.length)!==e.length)return!1;for(;l--;)if(!D(t[l],e[l],n,i))return!1}else{var c,p=y.keys(t);if(l=p.length,y.keys(e).length!==l)return!1;for(;l--;)if(c=p[l],!y.has(e,c)||!D(t[c],e[c],n,i))return!1}return n.pop(),i.pop(),!0};y.isEqual=function(t,e){return D(t,e)},y.isEmpty=function(t){return null==t||(C(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length)},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=d||function(t){return"[object Array]"===u.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){y["is"+e]=function(t){return u.call(t)==="[object "+e+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return y.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&t!==+t},y.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===u.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){return null!=t&&h.call(t,e)},y.noConflict=function(){return s._=r,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=T,y.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},y.matcher=y.matches=function(e){return e=y.extendOwn({},e),function(t){return y.isMatch(t,e)}},y.times=function(t,e,n){var i=Array(Math.max(0,t));e=b(e,n,1);for(var s=0;s<t;s++)i[s]=e(s);return i},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},N=y.invert(O),R=function(e){var n=function(t){return e[t]},t="(?:"+y.keys(e).join("|")+")",i=RegExp(t),s=RegExp(t,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(s,n):t}};y.escape=R(O),y.unescape=R(N),y.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),y.isFunction(i)?i.call(t):i};var M=0
;y.uniqueId=function(t){var e=++M+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var $=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\u2028|\u2029/g,z=function(t){return"\\"+L[t]};y.template=function(r,t,e){!t&&e&&(t=e),t=y.defaults({},t,y.templateSettings);var n=RegExp([(t.escape||$).source,(t.interpolate||$).source,(t.evaluate||$).source].join("|")+"|$","g"),o=0,a="__p+='";r.replace(n,function(t,e,n,i,s){return a+=r.slice(o,s).replace(U,z),o=s+t.length,e?a+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),t}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var i=new Function(t.variable||"obj","_",a)}catch(c){throw c.source=a,c}var s=function(t){return i.call(this,t,y)},l=t.variable||"obj";return s.source="function("+l+"){\n"+a+"}",s},y.chain=function(t){var e=y(t);return e._chain=!0,e};var B=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(n){y.each(y.functions(n),function(t){var e=y[t]=n[t];y.prototype[t]=function(){var t=[this._wrapped];return c.apply(t,arguments),B(this,e.apply(y,t))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=o[e];y.prototype[e]=function(){var t=this._wrapped;return n.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0],B(this,t)}}),y.each(["concat","join","slice"],function(t){var e=o[t];y.prototype[t]=function(){return B(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return y})}.call(this),function(e){function o(t){var e=t.length,n=u.type(t);return"function"!==n&&!u.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===n||0===e||"number"==typeof e&&0<e&&e-1 in t))}if(!e.jQuery){var u=function(t,e){return new u.fn.init(t,e)};u.isWindow=function(t){return null!=t&&t==t.window},u.type=function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?n[s.call(t)]||"object":typeof t},u.isArray=Array.isArray||function(t){return"array"===u.type(t)},u.isPlainObject=function(t){var e;if(!t||"object"!==u.type(t)||t.nodeType||u.isWindow(t))return!1;try{if(t.constructor&&!i.call(t,"constructor")&&!i.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}for(e in t);return void 0===e||i.call(t,e)},u.each=function(t,e,n){var i=0,s=t.length,r=o(t);if(n){if(r)for(;i<s&&!1!==e.apply(t[i],n);i++);else for(i in t)if(!1===e.apply(t[i],n))break}else if(r)for(;i<s&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},u.data=function(t,e,n){if(void 0===n){var i=(s=t[u.expando])&&r[s];if(void 0===e)return i;if(i&&e in i)return i[e]}else if(void 0!==e){var s=t[u.expando]||(t[u.expando]=++u.uuid);return r[s]=r[s]||{},r[s][e]=n}},u.removeData=function(t,e){var n=t[u.expando],i=n&&r[n];i&&u.each(e,function(t,e){delete i[e]})},u.extend=function(t){var e,n,i,s,r,o,a=t||{},l=1,c=arguments.length,p=!1;for("boolean"==typeof a&&(p=a,a=arguments[l]||{},l++),"object"!=typeof a&&"function"!==u.type(a)&&(a={}),l===c&&(a=this,l--);l<c;l++)if(null!=(r=arguments[l]))for(s in r)e=a[s],a!==(i=r[s])&&(p&&i&&(u.isPlainObject(i)||(n=u.isArray(i)))?(n?(n=!1,o=e&&u.isArray(e)?e:[]):o=e&&u.isPlainObject(e)?e:{},a[s]=u.extend(p,o,i)):void 0!==i&&(a[s]=i));return a},u.queue=function(t,e,n){function i(t,e){var n=e||[];return null!=t&&(o(Object(t))?function(t,e){for(var n=+e.length,i=0,s=t.length;i<n;)t[s++]=e[i++];if(n!=n)for(;void 0!==e[i];)t[s++]=e[i++];t.length=s}(n,"string"==typeof t?[t]:t):[].push.call(n,t)),n}if(t){e=(e||"fx")+"queue";var s=u.data(t,e);return n?(!s||u.isArray(n)?s=u.data(t,e,i(n)):s.push(n),s):s||[]}},u.dequeue=function(t,s){u.each(t.nodeType?[t]:t,function(t,e){s=s||"fx";var n=u.queue(e,s),i=n.shift();"inprogress"===i&&(i=n.shift()),i&&("fx"===s&&n.unshift("inprogress"),i.call(e,function(){u.dequeue(e,s)}))})},u.fn=u.prototype={init:function(t){if(t.nodeType)return this[0]=t,this;throw new Error("Not a DOM node.")},offset:function(){var t=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:t.top+(e.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(e.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function t(){for(var t=this.offsetParent||document;t&&"html"===!t.nodeType.toLowerCase&&"static"===t.style.position;)t=t.offsetParent;return t||document}var e=this[0],t=t.apply(e),n=this.offset(),i=/^(?:body|html)$/i.test(t.nodeName)?{top:0,left:0}:u(t).offset();return n.top-=parseFloat(e.style.marginTop)||0,n.left-=parseFloat(e.style.marginLeft)||0,t.style&&(i.top+=parseFloat(t.style.borderTopWidth)||0,i.left+=parseFloat(t.style.borderLeftWidth)||0),{top:n.top-i.top,left:n.left-i.left}}};var r={};u.expando="velocity"+(new Date).getTime(),u.uuid=0;for(var n={},i=n.hasOwnProperty,s=n.toString,t="Boolean Number String Function Array Date RegExp Object Error".split(" "),a=0;a<t.length;a++)n["[object "+t[a]+"]"]=t[a].toLowerCase();u.fn.init.prototype=u.fn,e.Velocity={Utilities:u}}}(window),function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t):t()}(function(){return function(t,M,$,L){function S(t){for(var e=-1,n=t?t.length:0,i=[];++e<n;){var s=t[e];s&&i.push(s)}return i}function g(t){return q.isWrapped(t)?t=[].slice.call(t):q.isNode(t)&&(t=[t]),t}function U(t){var e=F.data(t,"velocity");return null===e?L:e}function i(e){return function(t){return Math.round(t*e)*(1/e)}}function s(o,e,a,n){function i(t,e){return 1-3*e+3*t}function s(t,e){return 3*e-6*t}function r(t){return 3*t}function l(t,e,n){return((i(e,n)*t+s(e,n))*t+r(e))*t}function c(t,e,n){return 3*i(e,n)*t*t+2*s(e,n)*t+r(e)}function p(t,e){for(var n=0;n<f;++n){var i=c(e,o,a);if(0===i)return e;e-=(l(e,o,a)-t)/i}return e}function t(){for(var t=0;t<y;++t)k[t]=l(t*b,o,a)}function u(t,e,n){for(var i,s,r=0;0<(i=l(s=e+(n-e)/2,o,a)-t)?n=s:e=s,Math.abs(i)>g&&++r<v;);return s}function h(t){for(var e=0,n=1,i=y-1;n!=i&&k[n]<=t;++n)e+=b;var s=e+(t-k[--n])/(k[n+1]-k[n])*b,r=c(s,o,a);return m<=r?p(t,s):0==r?s:u(t,e,e+b)}function d(){T=!0,(o!=e||a!=n)&&t()}var f=4,m=.001,g=1e-7,v=10,y=11,b=1/(y-1),_="Float32Array"in M;if(4!==arguments.length)return!1;for(var w=0;w<4;++w)if("number"!=typeof arguments[w]||isNaN(arguments[w])||!isFinite(arguments[w]))return!1;o=Math.min(o,1),a=Math.min(a,1),o=Math.max(o,0),a=Math.max(a,0);var k=_?new Float32Array(y):new Array(y),T=!1,A=function(t){return T||d(),o===e&&a===n?t:0===t?0:1===t?1:l(h(t),e,n)};A.getControlPoints=function(){return[{x:o,y:e},{x:a,y:n}]};var S="generateBezier("+[o,e,a,n]+")";return A.toString=function(){return S},A}function z(t,e){var n=t;return q.isString(t)?H.Easings[t]||(n=!1):n=q.isArray(t)&&1===t.length?i.apply(null,t):q.isArray(t)&&2===t.length?a.apply(null,t.concat([e])):!(!q.isArray(t)||4!==t.length)&&s.apply(null,t),!1===n&&(n=H.Easings[H.defaults.easing]?H.defaults.easing:o),n}function B(t){if(t){var e=(new Date).getTime(),n=H.State.calls.length;1e4<n&&(H.State.calls=S(H.State.calls));for(var i=0;i<n;i++)if(H.State.calls[i]){var s=H.State.calls[i],r=s[0],o=s[2],a=s[3],l=!!a,c=null;a||(a=H.State.calls[i][3]=e-16);for(var p=Math.min((e-a)/o.duration,1),u=0,h=r.length;u<h;u++){var d=r[u],f=d.element;if(U(f)){var m=!1;if(o.display!==L&&null!==o.display&&"none"!==o.display){if("flex"===o.display){var g=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];F.each(g,function(t,e){W.setPropertyValue(f,"display",e)})}W.setPropertyValue(f,"display",o.display)}for(var v in o.visibility!==L&&"hidden"!==o.visibility&&W.setPropertyValue(f,"visibility",o.visibility),d)if("element"!==v){var y,b=d[v],_=q.isString(b.easing)?H.Easings[b.easing]:b.easing;if(1===p)y=b.endValue;else{var w=b.endValue-b.startValue;if(y=b.startValue+w*_(p,o,w),!l&&y===b.currentValue)continue}if(b.currentValue=y,"tween"===v)c=y;else{if(W.Hooks.registered[v]){var k=W.Hooks.getRoot(v),T=U(f).rootPropertyValueCache[k];T&&(b.rootPropertyValue=T)}var A=W.setPropertyValue(f,v,b.currentValue+(0===parseFloat(y)?"":b.unitType),b.rootPropertyValue,b.scrollData);W.Hooks.registered[v]&&(U(f).rootPropertyValueCache[k]=W.Normalizations.registered[k]?W.Normalizations.registered[k]("extract",null,A[1]):A[1]),"transform"===A[0]&&(m=!0)}}o.mobileHA&&U(f).transformCache.translate3d===L&&(U(f).transformCache.translate3d="(0px, 0px, 0px)",m=!0),m&&W.flushTransformCache(f)}}o.display!==L&&"none"!==o.display&&(H.State.calls[i][2].display=!1),o.visibility!==L&&"hidden"!==o.visibility&&(H.State.calls[i][2].visibility=!1),o.progress&&o.progress.call(s[1],s[1],p,Math.max(0,a+o.duration-e),a,c),1===p&&C(i)}}H.State.isTicking&&x(B)}function C(t,e){if(!H.State.calls[t])return!1;for(var n=H.State.calls[t][0],i=H.State.calls[t][1],s=H.State.calls[t][2],r=H.State.calls[t][4],o=!1,a=0,l=n.length;a<l;a++){var c=n[a].element;if(e||s.loop||("none"===s.display&&W.setPropertyValue(c,"display",s.display),"hidden"===s.visibility&&W.setPropertyValue(c,"visibility",s.visibility)),!0!==s.loop&&(F.queue(c)[1]===L||!/\.velocityQueueEntryFlag/i.test(F.queue(c)[1]))&&U(c)){U(c).isAnimating=!1;var p=!(U(c).rootPropertyValueCache={});F.each(W.Lists.transforms3D,function(t,e){var n=/^scale/.test(e)?1:0,i=U(c).transformCache[e];U(c).transformCache[e]!==L&&new RegExp("^\\("+n+"[^.]").test(i)&&(p=!0,delete U(c).transformCache[e])}),s.mobileHA&&(p=!0,delete U(c).transformCache.translate3d),p&&W.flushTransformCache(c),W.Values.removeClass(c,"velocity-animating")}if(!e&&s.complete&&!s.loop&&a===l-1)try{s.complete.call(i,i)}catch(d){setTimeout(function(){throw d},1)}r&&!0!==s.loop&&r(i),!0!==s.loop||e||(F.each(U(c).tweensContainer,function(t,e){/^rotate/.test(t)&&360===parseFloat(e.endValue)&&(e.endValue=0,e.startValue=360),/^backgroundPosition/.test(t)&&100===parseFloat(e.endValue)&&"%"===e.unitType&&(e.endValue=0,e.startValue=100)}),H(c,"reverse",{loop:!0,delay:s.delay})),!1!==s.queue&&F.dequeue(c,s.queue)}H.State.calls[t]=!1;for(var u=0,h=H.State.calls.length;u<h;u++)if(!1!==H.State.calls[u]){o=!0;break}!1===o&&(H.State.isTicking=!1,delete H.State.calls,H.State.calls=[])}var F,r,u=function(){if($.documentMode)return $.documentMode;for(var t=7;4<t;t--){var e=$.createElement("div");if(e.innerHTML="<!--[if IE "+t+"]><span></span><![endif]-->",e.getElementsByTagName("span").length)return e=null,t}return L}(),d=(r=0,M.webkitRequestAnimationFrame||M.mozRequestAnimationFrame||function(t){var e,n=(new Date).getTime();return e=Math.max(0,16-(n-r)),r=n+e,setTimeout(function(){t(n+e)},e)}),q={isString:function(t){return"string"==typeof t},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},isNode:function(t){return t&&t.nodeType},isNodeList:function(t){return"object"==typeof t&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(t))&&t.length!==L&&(0===t.length||"object"==typeof t[0]&&0<t[0].nodeType)},isWrapped:function(t){return t&&(t.jquery||M.Zepto&&M.Zepto.zepto.isZ(t))},isSVG:function(t){return M.SVGElement&&t instanceof M.SVGElement},isEmptyObject:function(t){for(var e in t)return!1;return!0}},e=!1;if(t.fn&&t.fn.jquery?(F=t,e=!0):F=M.Velocity.Utilities,u<=8&&!e)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(!(u<=7)){var J=400,o="swing",H={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:M.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:$.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:F,Redirects:{},Easings:{},Promise:M.Promise,defaults:{queue:"",duration:J,easing:o,begin:L,complete:L,progress:L,display:L,visibility:L,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(t){F.data(t,"velocity",{isSVG:q.isSVG(t),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:1},debug:!1};M.pageYOffset!==L?(H.State.scrollAnchor=M,H.State.scrollPropertyLeft="pageXOffset",H.State.scrollPropertyTop="pageYOffset"):(H.State.scrollAnchor=$.documentElement||$.body.parentNode||$.body,H.State.scrollPropertyLeft="scrollLeft",H.State.scrollPropertyTop="scrollTop");var a=function(){function l(t){return-t.tension*t.x-t.friction*t.v}function c(t,e,n){var i={x:t.x+n.dx*e,v:t.v+n.dv*e,tension:t.tension,friction:t.friction};return{dx:i.v,dv:l(i)}}function u(t,e){var n={dx:t.v,dv:l(t)},i=c(t,.5*e,n),s=c(t,.5*e,i),r=c(t,e,s),o=1/6*(n.dx+2*(i.dx+s.dx)+r.dx),a=1/6*(n.dv+2*(i.dv+s.dv)+r.dv);return t.x=t.x+o*e,t.v=t.v+a*e,t}return function h(t,e,n){var i,s,r,o={x:-1,v:0,tension:null,friction:null},a=[0],l=0,c=1e-4,p=.016;for(t=parseFloat(t)||500,e=parseFloat(e)||20,n=n||null,o.tension=t,o.friction=e,(i=null!==n)?s=(l=h(t,e))/n*p:s=p;r=u(r||o,s),a.push(1+r.x),l+=16,Math.abs(r.x)>c&&Math.abs(r.v)>c;);return i?function(t){return a[t*(a.length-1)|0]}:l}}();H.Easings={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},spring:function(t){return 1-Math.cos(4.5*t*Math.PI)*Math.exp(6*-t)}},F.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(t,e){H.Easings[e[0]]=s.apply(null,e[1])});var W=H.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var t=0;t<W.Lists.colors.length;t++){var e="color"===W.Lists.colors[t]?"0 0 0 1":"255 255 255 1";W.Hooks.templates[W.Lists.colors[t]]=["Red Green Blue Alpha",e]}var n,i,s;if(u)for(n in W.Hooks.templates){s=(i=W.Hooks.templates[n])[0].split(" ");var r=i[1].match(W.RegEx.valueSplit);"Color"===s[0]&&(s.push(s.shift()),r.push(r.shift()),W.Hooks.templates[n]=[s.join(" "),r.join(" ")])}for(n in W.Hooks.templates)for(var t in s=(i=W.Hooks.templates[n])[0].split(" ")){var o=n+s[t],a=t;W.Hooks.registered[o]=[n,a]}},getRoot:function(t){var e=W.Hooks.registered[t];return e?e[0]:t},cleanRootPropertyValue:function(t,e){return W.RegEx.valueUnwrap.test(e)&&(e=e.match(W.RegEx.valueUnwrap)[1]),W.Values.isCSSNullValue(e)&&(e=W.Hooks.templates[t][1]),e},extractValue:function(t,e){var n=W.Hooks.registered[t];if(n){var i=n[0],s=n[1];return(e=W.Hooks.cleanRootPropertyValue(i,e)).toString().match(W.RegEx.valueSplit)[s]}return e},injectValue:function(t,e,n){var i=W.Hooks.registered[t];if(i){var s,r=i[0],o=i[1];return(s=(n=W.Hooks.cleanRootPropertyValue(r,n)).toString().match(W.RegEx.valueSplit))[o]=e,s.join(" ")}return n}},Normalizations:{registered:{clip:function(t,e,n){switch(t){case"name":return"clip";case"extract":var i;return W.RegEx.wrappedValueAlreadyExtracted.test(n)?i=n:i=(i=n.toString().match(W.RegEx.valueUnwrap))?i[1].replace(/,(\s+)?/g," "):n,i;case"inject":return"rect("+n+")"}},blur:function(t,e,n){switch(t){case"name":return H.State.isFirefox?"filter":"-webkit-filter";case"extract":var i=parseFloat(n);if(!i&&0!==i){var s=n.toString().match(/blur\(([0-9]+[A-z]+)\)/i);i=s?s[1]:0}return i;case"inject":return parseFloat(n)?"blur("+n+")":"none"}},opacity:function(t,e,n){if(u<=8)switch(t){case"name":return"filter";case"extract":var i=n.toString().match(/alpha\(opacity=(.*)\)/i);return i?i[1]/100:1;case"inject":return(e.style.zoom=1)<=parseFloat(n)?"":"alpha(opacity="+parseInt(100*parseFloat(n),10)+")"}else switch(t){case"name":return"opacity";case"extract":case"inject":return n}}},register:function(){u<=9||H.State.isGingerbread||(W.Lists.transformsBase=W.Lists.transformsBase.concat(W.Lists.transforms3D));for(var t=0;t<W.Lists.transformsBase.length;t++)!function(){var s=W.Lists.transformsBase[t];W.Normalizations.registered[s]=function(t,e,n){switch(t){case"name":return"transform";case"extract":return U(e)===L||U(e).transformCache[s]===L?/^scale/i.test(s)?1:0:U(e).transformCache[s].replace(/[()]/g,"");case"inject":var i=!1;switch(s.substr(0,s.length-1)){case"translate":i=!/(%|px|em|rem|vw|vh|\d)$/i.test(n);break;case"scal":case"scale":H.State.isAndroid&&U(e).transformCache[s]===L&&n<1&&(n=1),i=!/(\d)$/i.test(n);break;case"skew":i=!/(deg|\d)$/i.test(n);break;case"rotate":i=!/(deg|\d)$/i.test(n)}return i||(U(e).transformCache[s]="("+n+")"),U(e).transformCache[s]}}}();for(t=0;t<W.Lists.colors.length;t++)!function(){var o=W.Lists.colors[t];W.Normalizations.registered[o]=function(t,e,n){switch(t){case"name":return o;case"extract":var i;if(W.RegEx.wrappedValueAlreadyExtracted.test(n))i=n;else{var s,r={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(n)?s=r[n]!==L?r[n]:r.black:W.RegEx.isHex.test(n)?s="rgb("+W.Values.hexToRgb(n).join(" ")+")":/^rgba?\(/i.test(n)||(s=r.black),i=(s||n).toString().match(W.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return u<=8||3!==i.split(" ").length||(i+=" 1"),i;case"inject":return u<=8?4===n.split(" ").length&&(n=n.split(/\s+/).slice(0,3).join(" ")):3===n.split(" ").length&&(n+=" 1"),(u<=8?"rgb":"rgba")+"("+n.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})},SVGAttribute:function(t){var e="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(u||H.State.isAndroid&&!H.State.isChrome)&&(e+="|transform"),new RegExp("^("+e+")$","i").test(t)},prefixCheck:function(t){if(H.State.prefixMatches[t])return[H.State.prefixMatches[t],!0];for(var e=["","Webkit","Moz","ms","O"],n=0,i=e.length;n<i;n++){var s;if(s=0===n?t:e[n]+t.replace(/^\w/,function(t){return t.toUpperCase()}),q.isString(H.State.prefixElement.style[s]))return[H.State.prefixMatches[t]=s,!0]}return[t,!1]}},Values:{hexToRgb:function(t){var e,n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return t=t.replace(n,function(t,e,n,i){return e+e+n+n+i+i}),(e=i.exec(t))?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[0,0,0]},isCSSNullValue:function(t){return 0==t||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(t)},getUnitType:function(t){return/^(rotate|skew)/i.test(t)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(t)?"":"px"},getDisplayType:function(t){var e=t&&t.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(e)?"inline":/^(li)$/i.test(e)?"list-item":/^(tr)$/i.test(e)?"table-row":/^(table)$/i.test(e)?"table":/^(tbody)$/i.test(e)?"table-row-group":"block"},addClass:function(t,e){t.classList?t.classList.add(e):t.className+=(t.className.length?" ":"")+e},removeClass:function(t,e){t.classList?t.classList.remove(e):t.className=t.className.toString().replace(new RegExp("(^|\\s)"+e.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(t,e,n,c){function p(t,e){function n(){r&&W.setPropertyValue(t,"display","none")}var i=0;if(u<=8)i=F.css(t,e);else{var s,r=!1;if(/^(width|height)$/.test(e)&&0===W.getPropertyValue(t,"display")&&(r=!0,W.setPropertyValue(t,"display",W.Values.getDisplayType(t))),!c){if("height"===e&&"border-box"!==W.getPropertyValue(t,"boxSizing").toString().toLowerCase()){var o=t.offsetHeight-(parseFloat(W.getPropertyValue(t,"borderTopWidth"))||0)-(parseFloat(W.getPropertyValue(t,"borderBottomWidth"))||0)-(parseFloat(W.getPropertyValue(t,"paddingTop"))||0)-(parseFloat(W.getPropertyValue(t,"paddingBottom"))||0);return n(),o}if("width"===e&&"border-box"!==W.getPropertyValue(t,"boxSizing").toString().toLowerCase()){var a=t.offsetWidth-(parseFloat(W.getPropertyValue(t,"borderLeftWidth"))||0)-(parseFloat(W.getPropertyValue(t,"borderRightWidth"))||0)-(parseFloat(W.getPropertyValue(t,"paddingLeft"))||0)-(parseFloat(W.getPropertyValue(t,"paddingRight"))||0);return n(),a}}s=U(t)===L?M.getComputedStyle(t,null):U(t).computedStyle?U(t).computedStyle:U(t).computedStyle=M.getComputedStyle(t,null),"borderColor"===e&&(e="borderTopColor"),(""===(i=9===u&&"filter"===e?s.getPropertyValue(e):s[e])||null===i)&&(i=t.style[e]),n()}if("auto"===i&&/^(top|right|bottom|left)$/i.test(e)){var l=p(t,"position");("fixed"===l||"absolute"===l&&/top|left/i.test(e))&&(i=F(t).position()[e]+"px")}return i}var i;if(W.Hooks.registered[e]){var s=e,r=W.Hooks.getRoot(s);n===L&&(n=W.getPropertyValue(t,W.Names.prefixCheck(r)[0])),W.Normalizations.registered[r]&&(n=W.Normalizations.registered[r]("extract",t,n)),i=W.Hooks.extractValue(s,n)}else if(W.Normalizations.registered[e]){var o,a;"transform"!==(o=W.Normalizations.registered[e]("name",t))&&(a=p(t,W.Names.prefixCheck(o)[0]),W.Values.isCSSNullValue(a)&&W.Hooks.templates[e]&&(a=W.Hooks.templates[e][1])),i=W.Normalizations.registered[e]("extract",t,a)}if(!/^[\d-]/.test(i))if(U(t)&&U(t).isSVG&&W.Names.SVGAttribute(e))if(/^(height|width)$/i.test(e))try{i=t.getBBox()[e]}catch(q){i=0}else i=t.getAttribute(e);else i=p(t,W.Names.prefixCheck(e)[0]);return W.Values.isCSSNullValue(i)&&(i=0),2<=H.debug&&console.log("Get "+e+": "+i),i},setPropertyValue:function(t,e,n,i,s){var r=e;if("scroll"===e)s.container?s.container["scroll"+s.direction]=n:"Left"===s.direction?M.scrollTo(n,s.alternateValue):M.scrollTo(s.alternateValue,n);else if(W.Normalizations.registered[e]&&"transform"===W.Normalizations.registered[e]("name",t))W.Normalizations.registered[e]("inject",t,n),r="transform",n=U(t).transformCache[e];else{if(W.Hooks.registered[e]){var o=e,a=W.Hooks.getRoot(e);i=i||W.getPropertyValue(t,a),n=W.Hooks.injectValue(o,n,i),e=a}if(W.Normalizations.registered[e]&&(n=W.Normalizations.registered[e]("inject",t,n),e=W.Normalizations.registered[e]("name",t)),r=W.Names.prefixCheck(e)[0],u<=8)try{t.style[r]=n}catch(B){H.debug&&console.log("Browser does not support ["+n+"] for ["+r+"]")}else U(t)&&U(t).isSVG&&W.Names.SVGAttribute(e)?t.setAttribute(e,n):t.style[r]=n;2<=H.debug&&console.log("Set "+e+" ("+r+"): "+n)}return[r,n]},flushTransformCache:function(e){function t(t){return parseFloat(W.getPropertyValue(e,t))}var n="";if((u||H.State.isAndroid&&!H.State.isChrome)&&U(e).isSVG){var i={translate:[t("translateX"),t("translateY")],skewX:[t("skewX")],skewY:[t("skewY")],scale:1!==t("scale")?[t("scale"),t("scale")]:[t("scaleX"),t("scaleY")],rotate:[t("rotateZ"),0,0]};F.each(U(e).transformCache,function(t){/^translate/i.test(t)?t="translate":/^scale/i.test(t)?t="scale":/^rotate/i.test(t)&&(t="rotate"),i[t]&&(n+=t+"("+i[t].join(" ")+") ",delete i[t])})}else{var s,r;F.each(U(e).transformCache,function(t){return s=U(e).transformCache[t],"transformPerspective"===t?(r=s,!0):(9===u&&"rotateZ"===t&&(t="rotate"),void(n+=t+s+" "))}),r&&(n="perspective"+r+" "+n)}W.setPropertyValue(e,"transform",n)}};W.Hooks.register(),W.Normalizations.register(),H.hook=function(t,i,s){var r=L;return t=g(t),F.each(t,function(t,e){if(U(e)===L&&H.init(e),s===L)r===L&&(r=H.CSS.getPropertyValue(e,i));else{var n=H.CSS.setPropertyValue(e,i,s);"transform"===n[0]&&H.CSS.flushTransformCache(e),r=n}}),r};var v=function(t){function e(){return i?O.promise||null:s}function n(){function n(){function u(t,e){var n=L,i=L,s=L;return q.isArray(t)?(n=t[0],!q.isArray(t[1])&&/^[\d-]/.test(t[1])||q.isFunction(t[1])||W.RegEx.isHex.test(t[1])?s=t[1]:(q.isString(t[1])&&!W.RegEx.isHex.test(t[1])||q.isArray(t[1]))&&(i=e?t[1]:z(t[1],S.duration),t[2]!==L&&(s=t[2]))):n=t,e||(i=i||S.easing),q.isFunction(n)&&(n=n.call(A,E,I)),q.isFunction(s)&&(s=s.call(A,E,I)),[n||0,i,s]}function t(t,e){var n,i;return i=(e||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(t){return n=t,""}),n||(n=W.Values.getUnitType(t)),[i,n]}function e(){var t={myParent:A.parentNode||$.body,position:W.getPropertyValue(A,"position"),fontSize:W.getPropertyValue(A,"fontSize")},e=t.position===N.lastPosition&&t.myParent===N.lastParent,n=t.fontSize===N.lastFontSize;N.lastParent=t.myParent,N.lastPosition=t.position,N.lastFontSize=t.fontSize;var i=100,s={};if(n&&e)s.emToPx=N.lastEmToPx,s.percentToPxWidth=N.lastPercentToPxWidth,s.percentToPxHeight=N.lastPercentToPxHeight;else{var r=U(A).isSVG?$.createElementNS("http://www.w3.org/2000/svg","rect"):$.createElement("div");H.init(r),t.myParent.appendChild(r),F.each(["overflow","overflowX","overflowY"],function(t,e){H.CSS.setPropertyValue(r,e,"hidden")}),H.CSS.setPropertyValue(r,"position",t.position),H.CSS.setPropertyValue(r,"fontSize",t.fontSize),H.CSS.setPropertyValue(r,"boxSizing","content-box"),F.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(t,e){H.CSS.setPropertyValue(r,e,i+"%")}),H.CSS.setPropertyValue(r,"paddingLeft",i+"em"),s.percentToPxWidth=N.lastPercentToPxWidth=(parseFloat(W.getPropertyValue(r,"width",null,!0))||1)/i,s.percentToPxHeight=N.lastPercentToPxHeight=(parseFloat(W.getPropertyValue(r,"height",null,!0))||1)/i,s.emToPx=N.lastEmToPx=(parseFloat(W.getPropertyValue(r,"paddingLeft"))||1)/i,t.myParent.removeChild(r)}return null===N.remToPx&&(N.remToPx=parseFloat(W.getPropertyValue($.body,"fontSize"))||16),null===N.vwToPx&&(N.vwToPx=parseFloat(M.innerWidth)/100,N.vhToPx=parseFloat(M.innerHeight)/100),s.remToPx=N.remToPx,s.vwToPx=N.vwToPx,s.vhToPx=N.vhToPx,1<=H.debug&&console.log("Unit ratios: "+JSON.stringify(s),A),s}if(S.begin&&0===E)try{S.begin.call(x,x)}catch(J){setTimeout(function(){throw J},1)}if("scroll"===D){var n,i,s,r=/^x$/i.test(S.axis)?"Left":"Top",o=parseFloat(S.offset)||0;S.container?q.isWrapped(S.container)||q.isNode(S.container)?(S.container=S.container[0]||S.container,s=(n=S.container["scroll"+r])+F(A).position()[r.toLowerCase()]+o):S.container=null:(n=H.State.scrollAnchor[H.State["scrollProperty"+r]],i=H.State.scrollAnchor[H.State["scrollProperty"+("Left"===r?"Top":"Left")]],s=F(A).offset()[r.toLowerCase()]+o),C={scroll:{rootPropertyValue:!1,startValue:n,currentValue:n,endValue:s,unitType:"",easing:S.easing,scrollData:{container:S.container,direction:r,alternateValue:i}},element:A},H.debug&&console.log("tweensContainer (scroll): ",C.scroll,A)}else if("reverse"===D){if(!U(A).tweensContainer)return void F.dequeue(A,S.queue);"none"===U(A).opts.display&&(U(A).opts.display="auto"),"hidden"===U(A).opts.visibility&&(U(A).opts.visibility="visible"),U(A).opts.loop=!1,U(A).opts.begin=null,U(A).opts.complete=null,P.easing||delete S.easing,P.duration||delete S.duration,S=F.extend({},U(A).opts,S);var a=F.extend(!0,{},U(A).tweensContainer);for(var l in a)if("element"!==l){var c=a[l].startValue;a[l].startValue=a[l].currentValue=a[l].endValue,a[l].endValue=c,q.isEmptyObject(P)||(a[l].easing=S.easing),H.debug&&console.log("reverse tweensContainer ("+l+"): "+JSON.stringify(a[l]),A)}C=a}else if("start"===D){for(var p in U(A).tweensContainer&&!0===U(A).isAnimating&&(a=U(A).tweensContainer),F.each(j,function(t,e){if(RegExp("^"+W.Lists.colors.join("$|^")+"$").test(t)){var n=u(e,!0),i=n[0],s=n[1],r=n[2];if(W.RegEx.isHex.test(i)){for(var o=["Red","Green","Blue"],a=W.Values.hexToRgb(i),l=r?W.Values.hexToRgb(r):L,c=0;c<o.length;c++){var p=[a[c]];s&&p.push(s),l!==L&&p.push(l[c]),j[t+o[c]]=p}delete j[t]}}}),j){var h=u(j[p]),d=h[0],f=h[1],m=h[2];p=W.Names.camelCase(p);var g=W.Hooks.getRoot(p),v=!1;if(U(A).isSVG||"tween"===g||!1!==W.Names.prefixCheck(g)[1]||W.Normalizations.registered[g]!==L){(S.display!==L&&null!==S.display&&"none"!==S.display||S.visibility!==L&&"hidden"!==S.visibility)&&/opacity|filter/.test(p)&&!m&&0!==d&&(m=0),S._cacheValues&&a&&a[p]?(m===L&&(m=a[p].endValue+a[p].unitType),v=U(A).rootPropertyValueCache[g]):W.Hooks.registered[p]?m===L?(v=W.getPropertyValue(A,g),m=W.getPropertyValue(A,p,v)):v=W.Hooks.templates[g][1]:m===L&&(m=W.getPropertyValue(A,p));var y,b,_,w=!1;if(m=(y=t(p,m))[0],_=y[1],d=(y=t(p,d))[0].replace(/^([+-\/*])=/,function(t,e){return w=e,""}),b=y[1],m=parseFloat(m)||0,d=parseFloat(d)||0,"%"===b&&(/^(fontSize|lineHeight)$/.test(p)?(d/=100,b="em"):/^scale/.test(p)?(d/=100,b=""):/(Red|Green|Blue)$/i.test(p)&&(d=d/100*255,b="")),/[\/*]/.test(w))b=_;else if(_!==b&&0!==m)if(0===d)b=_;else{T=T||e();var k=/margin|padding|left|right|width|text|word|letter/i.test(p)||/X$/.test(p)||"x"===p?"x":"y";switch(_){case"%":m*="x"===k?T.percentToPxWidth:T.percentToPxHeight;break;case"px":break;default:m*=T[_+"ToPx"]}switch(b){case"%":m*=1/("x"===k?T.percentToPxWidth:T.percentToPxHeight);break;case"px":break;default:m*=1/T[b+"ToPx"]}}switch(w){case"+":d=m+d;break;case"-":d=m-d;break;case"*":d*=m;break;case"/":d=m/d}C[p]={rootPropertyValue:v,startValue:m,currentValue:m,endValue:d,unitType:b,easing:f},H.debug&&console.log("tweensContainer ("+p+"): "+JSON.stringify(C[p]),A)}else H.debug&&console.log("Skipping ["+g+"] due to a lack of browser support.")}C.element=A}C.element&&(W.Values.addClass(A,"velocity-animating"),R.push(C),""===S.queue&&(U(A).tweensContainer=C,U(A).opts=S),U(A).isAnimating=!0,E===I-1?(H.State.calls.push([R,x,S,null,O.resolver]),!1===H.State.isTicking&&(H.State.isTicking=!0,B())):E++)}var T,A=this,S=F.extend({},H.defaults,P),C={};switch(U(A)===L&&H.init(A),parseFloat(S.delay)&&!1!==S.queue&&F.queue(A,S.queue,function(t){H.velocityQueueEntryFlag=!0,U(A).delayTimer={setTimeout:setTimeout(t,parseFloat(S.delay)),next:t}}),S.duration.toString().toLowerCase()){case"fast":S.duration=200;break;case"normal":S.duration=J;break;case"slow":S.duration=600;break;default:S.duration=parseFloat(S.duration)||1}!1!==H.mock&&(!0===H.mock?S.duration=S.delay=1:(S.duration*=parseFloat(H.mock)||1,S.delay*=parseFloat(H.mock)||1)),S.easing=z(S.easing,S.duration),S.begin&&!q.isFunction(S.begin)&&(S.begin=null),S.progress&&!q.isFunction(S.progress)&&(S.progress=null),S.complete&&!q.isFunction(S.complete)&&(S.complete=null),S.display!==L&&null!==S.display&&(S.display=S.display.toString().toLowerCase(),"auto"===S.display&&(S.display=H.CSS.Values.getDisplayType(A))),S.visibility!==L&&null!==S.visibility&&(S.visibility=S.visibility.toString().toLowerCase()),S.mobileHA=S.mobileHA&&H.State.isMobile&&!H.State.isGingerbread,!1===S.queue?S.delay?setTimeout(n,S.delay):n():F.queue(A,S.queue,function(t,e){return!0===e?(O.promise&&O.resolver(x),!0):(H.velocityQueueEntryFlag=!0,void n(t))}),""!==S.queue&&"fx"!==S.queue||"inprogress"===F.queue(A)[0]||F.dequeue(A)}var i,s,r,x,j,P,o=t&&(t.p||F.isPlainObject(t.properties)&&!t.properties.names||q.isString(t.properties));if(q.isWrapped(this)?(i=!1,r=0,s=x=this):(i=!0,r=1,x=o?t.elements||t.e:t),x=g(x)){o?(j=t.properties||t.p,P=t.options||t.o):(j=arguments[r],P=arguments[r+1]);var I=x.length,E=0;if(!/^(stop|finish)$/i.test(j)&&!F.isPlainObject(P)){P={};for(var a=r+1;a<arguments.length;a++)q.isArray(arguments[a])||!/^(fast|normal|slow)$/i.test(arguments[a])&&!/^\d/.test(arguments[a])?q.isString(arguments[a])||q.isArray(arguments[a]
)?P.easing=arguments[a]:q.isFunction(arguments[a])&&(P.complete=arguments[a]):P.duration=arguments[a]}var D,O={promise:null,resolver:null,rejecter:null};switch(i&&H.Promise&&(O.promise=new H.Promise(function(t,e){O.resolver=t,O.rejecter=e})),j){case"scroll":D="scroll";break;case"reverse":D="reverse";break;case"finish":case"stop":F.each(x,function(t,e){U(e)&&U(e).delayTimer&&(clearTimeout(U(e).delayTimer.setTimeout),U(e).delayTimer.next&&U(e).delayTimer.next(),delete U(e).delayTimer)});var l=[];return F.each(H.State.calls,function(s,r){r&&F.each(r[1],function(t,n){var i=P===L?"":P;return!0!==i&&r[2].queue!==i&&(P!==L||!1!==r[2].queue)||void F.each(x,function(t,e){e===n&&((!0===P||q.isString(P))&&(F.each(F.queue(e,q.isString(P)?P:""),function(t,e){q.isFunction(e)&&e(null,!0)}),F.queue(e,q.isString(P)?P:"",[])),"stop"===j?(U(e)&&U(e).tweensContainer&&!1!==i&&F.each(U(e).tweensContainer,function(t,e){e.endValue=e.currentValue}),l.push(s)):"finish"===j&&(r[2].duration=1))})})}),"stop"===j&&(F.each(l,function(t,e){C(e,!0)}),O.promise&&O.resolver(x)),e();default:if(!F.isPlainObject(j)||q.isEmptyObject(j)){if(q.isString(j)&&H.Redirects[j]){var c=(h=F.extend({},P)).duration,p=h.delay||0;return!0===h.backwards&&(x=F.extend(!0,[],x).reverse()),F.each(x,function(t,e){parseFloat(h.stagger)?h.delay=p+parseFloat(h.stagger)*t:q.isFunction(h.stagger)&&(h.delay=p+h.stagger.call(e,t,I)),h.drag&&(h.duration=parseFloat(c)||(/^(callout|transition)/.test(j)?1e3:J),h.duration=Math.max(h.duration*(h.backwards?1-t/I:(t+1)/I),.75*h.duration,200)),H.Redirects[j].call(e,e,h||{},t,I,x,O.promise?O:L)}),e()}var u="Velocity: First argument ("+j+") was not a property map, a known action, or a registered redirect. Aborting.";return O.promise?O.rejecter(new Error(u)):console.log(u),e()}D="start"}var h,d,N={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},R=[];if(F.each(x,function(t,e){q.isNode(e)&&n.call(e)}),(h=F.extend({},H.defaults,P)).loop=parseInt(h.loop),d=2*h.loop-1,h.loop)for(var f=0;f<d;f++){var m={delay:h.delay,progress:h.progress};f===d-1&&(m.display=h.display,m.visibility=h.visibility,m.complete=h.complete),v(x,"reverse",m)}return e()}};(H=F.extend(v,H)).animate=v;var x=M.requestAnimationFrame||d;return H.State.isMobile||$.hidden===L||$.addEventListener("visibilitychange",function(){$.hidden?(x=function(t){return setTimeout(function(){t(!0)},16)},B()):x=M.requestAnimationFrame||d}),t.Velocity=H,t!==M&&(t.fn.velocity=v,t.fn.velocity.defaults=H.defaults),F.each(["Down","Up"],function(t,u){H.Redirects["slide"+u]=function(n,t,e,i,s,r){var o=F.extend({},t),a=o.begin,l=o.complete,c={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},p={};o.display===L&&(o.display="Down"===u?"inline"===H.CSS.Values.getDisplayType(n)?"inline-block":"block":"none"),o.begin=function(){for(var t in a&&a.call(s,s),c){p[t]=n.style[t];var e=H.CSS.getPropertyValue(n,t);c[t]="Down"===u?[e,0]:[0,e]}p.overflow=n.style.overflow,n.style.overflow="hidden"},o.complete=function(){for(var t in p)n.style[t]=p[t];l&&l.call(s,s),r&&r.resolver(s)},H(n,c,o)}}),F.each(["In","Out"],function(t,c){H.Redirects["fade"+c]=function(t,e,n,i,s,r){var o=F.extend({},e),a={opacity:"In"===c?1:0},l=o.complete;o.complete=n!==i-1?o.begin=null:function(){l&&l.call(s,s),r&&r.resolver(s)},o.display===L&&(o.display="In"===c?"auto":"none"),H(this,a,o)}}),H}jQuery.fn.velocity=jQuery.fn.animate}(window.jQuery||window.Zepto||window,window,document)}),function(t){"function"==typeof require&&"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(["velocity"],t):t()}(function(){return function(t,e,n,b){function i(t,e){var i=[];return!(!t||!e)&&(w.each([t,e],function(t,e){var n=[];w.each(e,function(t,e){for(;e.toString().length<5;)e="0"+e;n.push(e)}),i.push(n.join(""))}),parseFloat(i[0])>parseFloat(i[1]))}if(t.Velocity&&t.Velocity.Utilities){var _=t.Velocity,w=_.Utilities;if(i({major:1,minor:1,patch:0},_.version)){var s="Velocity UI Pack: You need to update Velocity (jquery.velocity.js) to a newer version. Visit http://github.com/julianshapiro/velocity.";throw alert(s),new Error(s)}for(var r in _.RegisterEffect=_.RegisterUI=function(g,v){function y(t,e,i,s){var r,o=0;w.each(t.nodeType?[t]:t,function(t,n){s&&(i+=t*s),r=n.parentNode,w.each(["height","paddingTop","paddingBottom","marginTop","marginBottom"],function(t,e){o+=parseFloat(_.CSS.getPropertyValue(n,e))})}),_.animate(r,{height:("In"===e?"+":"-")+"="+o},{queue:!1,easing:"ease-in-out",duration:i*("In"===e?.6:1)})}return _.Redirects[g]=function(i,e,t,n,s,r){function o(){e.display!==b&&"none"!==e.display||!/Out$/.test(g)||w.each(s.nodeType?[s]:s,function(t,e){_.CSS.setPropertyValue(e,"display","none")}),e.complete&&e.complete.call(s,s),r&&r.resolver(s||i)}var a=t===n-1;"function"==typeof v.defaultDuration?v.defaultDuration=v.defaultDuration.call(s,s):v.defaultDuration=parseFloat(v.defaultDuration);for(var l=0;l<v.calls.length;l++){var c=v.calls[l],p=c[0],u=e.duration||v.defaultDuration||1e3,h=c[1],d=c[2]||{},f={};if(f.duration=u*(h||1),f.queue=e.queue||"",f.easing=d.easing||"ease",f.delay=parseFloat(d.delay)||0,f._cacheValues=d._cacheValues||!0,0===l){if(f.delay+=parseFloat(e.delay)||0,0===t&&(f.begin=function(){e.begin&&e.begin.call(s,s);var t=g.match(/(In|Out)$/);t&&"In"===t[0]&&p.opacity!==b&&w.each(s.nodeType?[s]:s,function(t,e){_.CSS.setPropertyValue(e,"opacity",0)}),e.animateParentHeight&&t&&y(s,t[0],u+f.delay,e.stagger)}),null!==e.display)if(e.display!==b&&"none"!==e.display)f.display=e.display;else if(/In$/.test(g)){var m=_.CSS.Values.getDisplayType(i);f.display="inline"===m?"inline-block":m}e.visibility&&"hidden"!==e.visibility&&(f.visibility=e.visibility)}l===v.calls.length-1&&(f.complete=function(){if(v.reset){for(var t in v.reset){var e=v.reset[t];_.CSS.Hooks.registered[t]!==b||"string"!=typeof e&&"number"!=typeof e||(v.reset[t]=[v.reset[t],v.reset[t]])}var n={duration:0,queue:!1};a&&(n.complete=o),_.animate(i,v.reset,n)}else a&&o()},"hidden"===e.visibility&&(f.visibility=e.visibility)),_.animate(i,p,f)}},_},_.RegisterEffect.packagedEffects={"callout.bounce":{defaultDuration:550,calls:[[{translateY:-30},.25],[{translateY:0},.125],[{translateY:-15},.125],[{translateY:0},.25]]},"callout.shake":{defaultDuration:800,calls:[[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:0},.125]]},"callout.flash":{defaultDuration:1100,calls:[[{opacity:[0,"easeInOutQuad",1]},.25],[{opacity:[1,"easeInOutQuad"]},.25],[{opacity:[0,"easeInOutQuad"]},.25],[{opacity:[1,"easeInOutQuad"]},.25]]},"callout.pulse":{defaultDuration:825,calls:[[{scaleX:1.1,scaleY:1.1},.5,{easing:"easeInExpo"}],[{scaleX:1,scaleY:1},.5]]},"callout.swing":{defaultDuration:950,calls:[[{rotateZ:15},.2],[{rotateZ:-10},.2],[{rotateZ:5},.2],[{rotateZ:-5},.2],[{rotateZ:0},.2]]},"callout.tada":{defaultDuration:1e3,calls:[[{scaleX:.9,scaleY:.9,rotateZ:-3},.1],[{scaleX:1.1,scaleY:1.1,rotateZ:3},.1],[{scaleX:1.1,scaleY:1.1,rotateZ:-3},.1],["reverse",.125],["reverse",.125],["reverse",.125],["reverse",.125],["reverse",.125],[{scaleX:1,scaleY:1,rotateZ:0},.2]]},"transition.fadeIn":{defaultDuration:500,calls:[[{opacity:[1,0]}]]},"transition.fadeOut":{defaultDuration:500,calls:[[{opacity:[0,1]}]]},"transition.flipXIn":{defaultDuration:700,calls:[[{opacity:[1,0],transformPerspective:[800,800],rotateY:[0,-55]}]],reset:{transformPerspective:0}},"transition.flipXOut":{defaultDuration:700,calls:[[{opacity:[0,1],transformPerspective:[800,800],rotateY:55}]],reset:{transformPerspective:0,rotateY:0}},"transition.flipYIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],rotateX:[0,-45]}]],reset:{transformPerspective:0}},"transition.flipYOut":{defaultDuration:800,calls:[[{opacity:[0,1],transformPerspective:[800,800],rotateX:25}]],reset:{transformPerspective:0,rotateX:0}},"transition.flipBounceXIn":{defaultDuration:900,calls:[[{opacity:[.725,0],transformPerspective:[400,400],rotateY:[-10,90]},.5],[{opacity:.8,rotateY:10},.25],[{opacity:1,rotateY:0},.25]],reset:{transformPerspective:0}},"transition.flipBounceXOut":{defaultDuration:800,calls:[[{opacity:[.9,1],transformPerspective:[400,400],rotateY:-10},.5],[{opacity:0,rotateY:90},.5]],reset:{transformPerspective:0,rotateY:0}},"transition.flipBounceYIn":{defaultDuration:850,calls:[[{opacity:[.725,0],transformPerspective:[400,400],rotateX:[-10,90]},.5],[{opacity:.8,rotateX:10},.25],[{opacity:1,rotateX:0},.25]],reset:{transformPerspective:0}},"transition.flipBounceYOut":{defaultDuration:800,calls:[[{opacity:[.9,1],transformPerspective:[400,400],rotateX:-15},.5],[{opacity:0,rotateX:90},.5]],reset:{transformPerspective:0,rotateX:0}},"transition.swoopIn":{defaultDuration:850,calls:[[{opacity:[1,0],transformOriginX:["100%","50%"],transformOriginY:["100%","100%"],scaleX:[1,0],scaleY:[1,0],translateX:[0,-700],translateZ:0}]],reset:{transformOriginX:"50%",transformOriginY:"50%"}},"transition.swoopOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformOriginX:["50%","100%"],transformOriginY:["100%","100%"],scaleX:0,scaleY:0,translateX:-700,translateZ:0}]],reset:{transformOriginX:"50%",transformOriginY:"50%",scaleX:1,scaleY:1,translateX:0}},"transition.whirlIn":{defaultDuration:850,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,0],scaleY:[1,0],rotateY:[0,160]},1,{easing:"easeInOutSine"}]]},"transition.whirlOut":{defaultDuration:750,calls:[[{opacity:[0,"easeInOutQuint",1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:0,scaleY:0,rotateY:160},1,{easing:"swing"}]],reset:{scaleX:1,scaleY:1,rotateY:0}},"transition.shrinkIn":{defaultDuration:750,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,1.5],scaleY:[1,1.5],translateZ:0}]]},"transition.shrinkOut":{defaultDuration:600,calls:[[{opacity:[0,1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:1.3,scaleY:1.3,translateZ:0}]],reset:{scaleX:1,scaleY:1}},"transition.expandIn":{defaultDuration:700,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,.625],scaleY:[1,.625],translateZ:0}]]},"transition.expandOut":{defaultDuration:700,calls:[[{opacity:[0,1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:.5,scaleY:.5,translateZ:0}]],reset:{scaleX:1,scaleY:1}},"transition.bounceIn":{defaultDuration:800,calls:[[{opacity:[1,0],scaleX:[1.05,.3],scaleY:[1.05,.3]},.4],[{scaleX:.9,scaleY:.9,translateZ:0},.2],[{scaleX:1,scaleY:1},.5]]},"transition.bounceOut":{defaultDuration:800,calls:[[{scaleX:.95,scaleY:.95},.35],[{scaleX:1.1,scaleY:1.1,translateZ:0},.35],[{opacity:[0,1],scaleX:.3,scaleY:.3},.3]],reset:{scaleX:1,scaleY:1}},"transition.bounceUpIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateY:[-30,1e3]},.6,{easing:"easeOutCirc"}],[{translateY:10},.2],[{translateY:0},.2]]},"transition.bounceUpOut":{defaultDuration:1e3,calls:[[{translateY:20},.2],[{opacity:[0,"easeInCirc",1],translateY:-1e3},.8]],reset:{translateY:0}},"transition.bounceDownIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateY:[30,-1e3]},.6,{easing:"easeOutCirc"}],[{translateY:-10},.2],[{translateY:0},.2]]},"transition.bounceDownOut":{defaultDuration:1e3,calls:[[{translateY:-20},.2],[{opacity:[0,"easeInCirc",1],translateY:1e3},.8]],reset:{translateY:0}},"transition.bounceLeftIn":{defaultDuration:750,calls:[[{opacity:[1,0],translateX:[30,-1250]},.6,{easing:"easeOutCirc"}],[{translateX:-10},.2],[{translateX:0},.2]]},"transition.bounceLeftOut":{defaultDuration:750,calls:[[{translateX:30},.2],[{opacity:[0,"easeInCirc",1],translateX:-1250},.8]],reset:{translateX:0}},"transition.bounceRightIn":{defaultDuration:750,calls:[[{opacity:[1,0],translateX:[-30,1250]},.6,{easing:"easeOutCirc"}],[{translateX:10},.2],[{translateX:0},.2]]},"transition.bounceRightOut":{defaultDuration:750,calls:[[{translateX:-30},.2],[{opacity:[0,"easeInCirc",1],translateX:1250},.8]],reset:{translateX:0}},"transition.slideUpIn":{defaultDuration:900,calls:[[{opacity:[1,0],translateY:[0,20],translateZ:0}]]},"transition.slideUpOut":{defaultDuration:900,calls:[[{opacity:[0,1],translateY:-20,translateZ:0}]],reset:{translateY:0}},"transition.slideDownIn":{defaultDuration:900,calls:[[{opacity:[1,0],translateY:[0,-20],translateZ:0}]]},"transition.slideDownOut":{defaultDuration:900,calls:[[{opacity:[0,1],translateY:20,translateZ:0}]],reset:{translateY:0}},"transition.slideLeftIn":{defaultDuration:1e3,calls:[[{opacity:[1,0],translateX:[0,-20],translateZ:0}]]},"transition.slideLeftOut":{defaultDuration:1050,calls:[[{opacity:[0,1],translateX:-20,translateZ:0}]],reset:{translateX:0}},"transition.slideRightIn":{defaultDuration:1e3,calls:[[{opacity:[1,0],translateX:[0,20],translateZ:0}]]},"transition.slideRightOut":{defaultDuration:1050,calls:[[{opacity:[0,1],translateX:20,translateZ:0}]],reset:{translateX:0}},"transition.slideUpBigIn":{defaultDuration:850,calls:[[{opacity:[1,0],translateY:[0,75],translateZ:0}]]},"transition.slideUpBigOut":{defaultDuration:800,calls:[[{opacity:[0,1],translateY:-75,translateZ:0}]],reset:{translateY:0}},"transition.slideDownBigIn":{defaultDuration:850,calls:[[{opacity:[1,0],translateY:[0,-75],translateZ:0}]]},"transition.slideDownBigOut":{defaultDuration:800,calls:[[{opacity:[0,1],translateY:75,translateZ:0}]],reset:{translateY:0}},"transition.slideLeftBigIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateX:[0,-75],translateZ:0}]]},"transition.slideLeftBigOut":{defaultDuration:750,calls:[[{opacity:[0,1],translateX:-75,translateZ:0}]],reset:{translateX:0}},"transition.slideRightBigIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateX:[0,75],translateZ:0}]]},"transition.slideRightBigOut":{defaultDuration:750,calls:[[{opacity:[0,1],translateX:75,translateZ:0}]],reset:{translateX:0}},"transition.perspectiveUpIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:["100%","100%"],rotateX:[0,-180]}]]},"transition.perspectiveUpOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:["100%","100%"],rotateX:-180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateX:0}},"transition.perspectiveDownIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[0,0],rotateX:[0,180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveDownOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[0,0],rotateX:180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateX:0}},"transition.perspectiveLeftIn":{defaultDuration:950,calls:[[{opacity:[1,0],transformPerspective:[2e3,2e3],transformOriginX:[0,0],transformOriginY:[0,0],rotateY:[0,-180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveLeftOut":{defaultDuration:950,calls:[[{opacity:[0,1],transformPerspective:[2e3,2e3],transformOriginX:[0,0],transformOriginY:[0,0],rotateY:-180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateY:0}},"transition.perspectiveRightIn":{defaultDuration:950,calls:[[{opacity:[1,0],transformPerspective:[2e3,2e3],transformOriginX:["100%","100%"],transformOriginY:[0,0],rotateY:[0,180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveRightOut":{defaultDuration:950,calls:[[{opacity:[0,1],transformPerspective:[2e3,2e3],transformOriginX:["100%","100%"],transformOriginY:[0,0],rotateY:180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateY:0}}},_.RegisterEffect.packagedEffects)_.RegisterEffect(r,_.RegisterEffect.packagedEffects[r]);_.RunSequence=function(t){var o=w.extend(!0,[],t);1<o.length&&(w.each(o.reverse(),function(t,n){var i=o[t+1];if(i){var e=n.options&&!1===n.options.sequenceQueue?"begin":"complete",s=i.options&&i.options[e],r={};r[e]=function(){var t=i.elements||i.e,e=t.nodeType?[t]:t;s&&s.call(e,e),_(n)},i.options=w.extend({},i.options,r)}}),o.reverse()),_(o[0])}}else e.console&&console.log("Velocity UI Pack: Velocity must be loaded first. Aborting.")}(window.jQuery||window.Zepto||window,window,document)}),function(){var w,t,n,e,i,s,r,o,a,l,c=[].slice,k=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},p=function(t,e){function n(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},u={}.hasOwnProperty,h=function(t,e){return function(){return t.apply(e,arguments)}};(n={bind:function(t,e){var n,i,s,r,o;for(i=t.split(" "),this.hasOwnProperty("_callbacks")||this._callbacks||(this._callbacks={}),s=0,r=i.length;s<r;s++)o=i[s],(n=this._callbacks)[o]||(n[o]=[]),this._callbacks[o].push(e);return this},one:function(t,e){var n;return this.bind(t,n=function(){return this.unbind(t,n),e.apply(this,arguments)})},trigger:function(){var t,e,n,i,s,r;if(e=(t=1<=arguments.length?c.call(arguments,0):[]).shift(),s=null!=(r=this._callbacks)?r[e]:void 0){for(n=0,i=s.length;n<i&&!1!==s[n].apply(this,t);n++);return!0}},listenTo:function(t,e,n){return t.bind(e,n),this.listeningTo||(this.listeningTo=[]),this.listeningTo.push({obj:t,ev:e,callback:n}),this},listenToOnce:function(r,o,a){var l,c;return c=this.listeningToOnce||(this.listeningToOnce=[]),r.bind(o,l=function(){var t,e,n,i,s;for(e=-1,t=n=0,i=c.length;n<i;t=++n)(s=c[t]).obj===r&&s.ev===o&&s.callback===l&&(e=t);return r.unbind(o,l),-1!==e&&c.splice(e,1),a.apply(this,arguments)}),c.push({obj:r,ev:o,callback:l}),this},stopListening:function(t,e,n){var i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,_;if(0===arguments.length){for(a=0,p=(y=[this.listeningTo,this.listeningToOnce]).length;a<p;a++)if(null!=(f=y[a])?f.length:void 0)for(l=0,u=f.length;l<u;l++)(m=f[l]).obj.unbind(m.ev,m.callback);this.listeningTo=void 0,this.listeningToOnce=void 0}else if(t)for(e=e?e.split(" "):[void 0],c=0,h=(b=[this.listeningTo,this.listeningToOnce]).length;c<h;c++)if(f=b[c])for(g=0,d=e.length;g<d;g++)for(s=e[g],o=v=_=f.length-1;_<=0?v<=0:0<=v;o=_<=0?++v:--v)(m=f[o])&&m.obj===t&&(n&&m.callback!==n||(s&&s!==m.ev?s&&(r=m.ev.split(" "),0<=k.call(r,s)&&(r=function(){var t,e,n;for(n=[],e=0,t=r.length;e<t;e++)(i=r[e])!==s&&n.push(i);return n}(),m.ev=w.trim(r.join(" ")),m.obj.unbind(s,m.callback))):(m.obj.unbind(m.ev,m.callback),-1!==o&&f.splice(o,1))));return this},unbind:function(t,e){var n,i,s,r,o,a,l,c,p;if(0===arguments.length)return this._callbacks={},this;if(!t)return this;for(s=0,o=(n=t.split(" ")).length;s<o;s++)if(c=n[s],l=null!=(p=this._callbacks)?p[c]:void 0)if(e){for(i=r=0,a=l.length;r<a;i=++r)if(l[i]===e){(l=l.slice()).splice(i,1),this._callbacks[c]=l;break}}else delete this._callbacks[c];return this}}).on=n.bind,n.off=n.unbind,e={trace:!0,logPrefix:"(App)",log:function(){var t;if(t=1<=arguments.length?c.call(arguments,0):[],this.trace)return this.logPrefix&&t.unshift(this.logPrefix),null!=console&&"function"==typeof console.log&&console.log.apply(console,t),this}},l=["included","extended"],s=function(){function t(){"function"==typeof this.init&&this.init.apply(this,arguments)}return t.include=function(t){var e,n,i;if(!t)throw new Error("include(obj) requires obj");for(e in t)i=t[e],k.call(l,e)<0&&(this.prototype[e]=i);return null!=(n=t.included)&&n.apply(this),this},t.extend=function(t){var e,n,i;if(!t)throw new Error("extend(obj) requires obj");for(e in t)i=t[e],k.call(l,e)<0&&(this[e]=i);return null!=(n=t.extended)&&n.apply(this),this},t.proxy=function(t){return e=this,function(){return t.apply(e,arguments)};var e},t.prototype.proxy=function(t){return e=this,function(){return t.apply(e,arguments)};var e},t}(),(i=function(){function e(t){e.__super__.constructor.apply(this,arguments),null!=this.constructor.uuid&&"function"==typeof this.constructor.uuid?(this.cid=this.constructor.uuid(),this.id||(this.id=this.cid)):this.cid=(null!=t?t.cid:void 0)||this.constructor.uid("c-"),t&&this.load(t)}return p(e,s),e.extend(n),e.include(n),e.records=[],e.irecords={},e.attributes=[],e.configure=function(t){var e,n;return n=t,e=2<=arguments.length?c.call(arguments,1):[],this.className=n,this.deleteAll(),e.length&&(this.attributes=e),this.attributes&&(this.attributes=a(this.attributes)),this.attributes||(this.attributes=[]),this.unbind(),this},e.toString=function(){return this.className+"("+this.attributes.join(", ")+")"},e.find=function(t,e){var n;return null==e&&(e=this.notFound),(null!=(n=this.irecords[t])?n.clone():void 0)||("function"==typeof e?e(t):void 0)},e.findAll=function(t,e){var n,i,s,r;for(r=[],i=0,s=t.length;i<s;i++)n=t[i],this.find(n,e)&&r.push(this.find(n));return r},e.notFound=function(){return null},e.exists=function(t){return Boolean(this.irecords[t])},e.addRecord=function(t,e){var n;return(n=this.irecords[t.id||t.cid])?n.refresh(t):(t.id||(t.id=t.cid),this.irecords[t.id]=this.irecords[t.cid]=t,void 0!==e?this.records.splice(e,0,t):this.records.push(t)),t},e.refresh=function(t,e){var n,i,s,r,o;for(null==e&&(e={}),e.clear&&this.deleteAll(),r=this.fromJSON(t),Array.isArray(r)||(r=[r]),n=0,i=r.length;n<i;n++)s=r[n],this.addRecord(s);return this.sort(),o=this.cloneArray(r),this.trigger("refresh",o,e),o},e.select=function(t){var e,n,i,s,r;for(r=[],e=0,n=(s=this.records).length;e<n;e++)t(i=s[e])&&r.push(i.clone());return r},e.findByAttribute=function(t,e){var n,i,s,r;for(n=0,i=(r=this.records).length;n<i;n++)if((s=r[n])[t]===e)return s.clone();return null},e.findAllByAttribute=function(e,n){return this.select(function(t){return t[e]===n})},e.each=function(t){var e,n,i,s,r;for(r=[],e=0,n=(s=this.records).length;e<n;e++)i=s[e],r.push(t(i.clone()));return r},e.all=function(){return this.cloneArray(this.records)},e.slice=function(t,e){return null==t&&(t=0),this.cloneArray(this.records.slice(t,e))},e.first=function(t){var e;return null==t&&(t=1),1<t?this.cloneArray(this.records.slice(0,t)):null!=(e=this.records[0])?e.clone():void 0},e.last=function(t){var e;return"number"==typeof t?this.cloneArray(this.records.slice(-t)):null!=(e=this.records[this.records.length-1])?e.clone():void 0},e.count=function(){return this.records.length},e.deleteAll=function(){return this.records=[],this.irecords={}},e.destroyAll=function(t){var e,n,i,s,r;for(r=[],e=0,n=(s=this.records).length;e<n;e++)i=s[e],r.push(i.destroy(t));return r},e.update=function(t,e,n){return this.find(t).updateAttributes(e,n)},e.create=function(t,e){return new this(t).save(e)},e.destroy=function(t,e){var n;return null!=(n=this.find(t))?n.destroy(e):void 0},e.change=function(t){return"function"==typeof t?this.bind("change",t):this.trigger.apply(this,["change"].concat(c.call(arguments)))},e.fetch=function(t){return"function"==typeof t?this.bind("fetch",t):this.trigger.apply(this,["fetch"].concat(c.call(arguments)))},e.toJSON=function(){return this.records},e.beforeFromJSON=function(t){return t},e.fromJSON=function(t){var e,n,i,s;if(t){if("string"==typeof t&&(t=JSON.parse(t)),t=this.beforeFromJSON(t),Array.isArray(t)){for(i=[],e=0,n=t.length;e<n;e++)(s=t[e])instanceof this?i.push(s):i.push(new this(s));return i}return t instanceof this?t:new this(t)}},e.fromForm=function(){var t;return(t=new this).fromForm.apply(t,arguments)},e.sort=function(){return this.comparator&&this.records.sort(this.comparator),this},e.cloneArray=function(t){var e,n,i,s;for(i=[],e=0,n=t.length;e<n;e++)s=t[e],i.push(s.clone());return i},e.idCounter=0,e.uid=function(t){var e;return null==t&&(t=""),e=t+this.idCounter++,this.exists(e)&&(e=this.uid(t)),e},e.prototype.isNew=function(){return!this.exists()},e.prototype.isValid=function(){return!this.validate()},e.prototype.validate=function(){},e.prototype.load=function(t){var e,n;for(e in t.id&&(this.id=t.id),t)if(n=t[e],"function"==typeof this[e]){if("function"==typeof n)continue;this[e](n)}else this[e]=n;return this},e.prototype.attributes=function(){var t,e,n,i,s;for(s={},t=0,n=(i=this.constructor.attributes).length;t<n;t++)(e=i[t])in this&&("function"==typeof this[e]?s[e]=this[e]():s[e]=this[e]);return this.id&&(s.id=this.id),s},e.prototype.eql=function(t){return t&&t.constructor===this.constructor&&(t.cid===this.cid||t.id&&t.id===this.id)},e.prototype.save=function(t){var e,n;return null==t&&(t={}),!1!==t.validate&&(e=this.validate())?(this.trigger("error",this,e),!1):(this.trigger("beforeSave",this,t),n=this.isNew()?this.create(t):this.update(t),this.stripCloneAttrs(),this.trigger("save",n,t),n)},e.prototype.stripCloneAttrs=function(){var t,e;if(!this.hasOwnProperty("cid")){for(t in e=this)u.call(e,t)&&(e[t],0<=k.call(this.constructor.attributes,t)&&delete this[t]);return this}},e.prototype.updateAttribute=function(t,e,n){var i;return(i={})[t]=e,this.updateAttributes(i,n)},e.prototype.updateAttributes=function(t,e){return this.load(t),this.save(e)},e.prototype.changeID=function(t){var e;if(t!==this.id)return(e=this.constructor.irecords)[t]=e[this.id],this.cid!==this.id&&delete e[this.id],this.id=t},e.prototype.remove=function(t){var e,n,i,s,r;for(null==t&&(t={}),e=n=0,i=(r=this.constructor.records.slice(0)).length;n<i;e=++n)if(s=r[e],this.eql(s)){r.splice(e,1);break}if(this.constructor.records=r,t.clear)return delete this.constructor.irecords[this.id],delete this.constructor.irecords[this.cid]},e.prototype.destroy=function(t){return null==t&&(t={}),null==t.clear&&(t.clear=!0),this.trigger("beforeDestroy",this,t),this.remove(t),this.destroyed=!0,this.trigger("destroy",this,t),this.trigger("change",this,"destroy",t),this.listeningTo&&this.stopListening(),this.unbind(),this},e.prototype.dup=function(t){var e,n;return null==t&&(t=!0),e=this.attributes(),t?delete e.id:e.cid=this.cid,n=new this.constructor(e),t||this._callbacks&&(n._callbacks=this._callbacks),n},e.prototype.clone=function(){return o(this)},e.prototype.reload=function(){var t;return this.isNew()?this:(t=this.constructor.find(this.id),this.load(t.attributes()),t)},e.prototype.refresh=function(t){var e,n;return(t=this.constructor.fromJSON(t)).id&&this.id!==t.id&&this.changeID(t.id),this.constructor.irecords[this.id]?(this.constructor.irecords[this.id].load(t),this.trigger("refresh",this),this):(n=this.constructor.className,e=JSON.stringify(t),void console.log("Can't refresh not existing %s instance with ID %s and attributes %s. Possible race condition?",n,this.id,e))},e.prototype.toJSON=function(){return this.attributes()},e.prototype.toString=function(){return"<"+this.constructor.className+" ("+JSON.stringify(this)+")>"},e.prototype.fromForm=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f;for(f={},n=0,o=(u=w(t).find("[type=checkbox]:not([value])")).length;n<o;n++)f[(e=u[n]).name]=w(e).prop("checked");for(i=0,a=(h=w(t).find('[type=checkbox][name$="[]"]')).length;i<a;i++)f[c=(e=h[i]).name.replace(/\[\]$/,"")]||(f[c]=[]),w(e).prop("checked")&&f[c].push(e.value);for(r=0,l=(d=w(t).serializeArray()).length;r<l;r++)f[p=(s=d[r]).name]||(f[p]=s.value);return this.load(f)},e.prototype.exists=function(){return this.constructor.exists(this.id)},e.prototype.update=function(t){var e,n;return this.trigger("beforeUpdate",this,t),(n=this.constructor.irecords)[this.id].load(this.attributes()),this.constructor.sort(),(e=n[this.id].clone()).trigger("update",e,t),e.trigger("change",e,"update",t),e},e.prototype.create=function(t){var e,n;return this.trigger("beforeCreate",this,t),this.id||(this.id=this.cid),n=this.dup(!1),this.constructor.addRecord(n,t.idx),this.constructor.sort(),(e=n.clone()).trigger("create",e,t),e.trigger("change",e,"create",t),e},e.prototype.bind=function(){var t;return t=this.constructor.irecords[this.id]||this,n.bind.apply(t,arguments)},e.prototype.one=function(){var t;return t=this.constructor.irecords[this.id]||this,n.one.apply(t,arguments)},e.prototype.unbind=function(){var t;return t=this.constructor.irecords[this.id]||this,n.unbind.apply(t,arguments)},e.prototype.trigger=function(){var t;return n.trigger.apply(this,arguments),(t=this.constructor).trigger.apply(t,arguments)},e}()).prototype.on=i.prototype.bind,i.prototype.off=i.prototype.unbind,t=function(){function o(t){var e,n,i,s,r;for(n in this.release=h(this.release,this),this.options=t,s=this.options)r=s[n],this[n]=r;for(this.el||(this.el=document.createElement(this.tag)),this.el=w(this.el),this.className&&this.el.addClass(this.className),this.attributes&&this.el.attr(this.attributes),this.events||(this.events=this.constructor.events),this.elements||(this.elements=this.constructor.elements),e=this;i=e.constructor.__super__;)i.events&&(this.events=w.extend({},i.events,this.events)),i.elements&&(this.elements=w.extend({},i.elements,this.elements)),e=i;this.events&&this.delegateEvents(this.events),this.elements&&this.refreshElements(),o.__super__.constructor.apply(this,arguments)}return p(o,s),o.include(n),o.include(e),o.prototype.eventSplitter=/^(\S+)\s*(.*)$/,o.prototype.tag="div",o.prototype.release=function(){return this.trigger("release",this),this.el.remove(),this.unbind(),this.stopListening()},o.prototype.$=function(t){return this.el.find(t)},o.prototype.delegateEvents=function(t){var e,n,i,s,r,o;for(n in r=[],t){if("function"==typeof(s=t[n]))s=function(e){return function(t){return function(){return t.apply(e,arguments),!0}}}(this)(s);else{if(!this[s])throw new Error(s+" doesn't exist");s=function(e){return function(t){return function(){return e[t].apply(e,arguments),!0}}}(this)(s)}e=(i=n.match(this.eventSplitter))[1],""===(o=i[2])?r.push(this.el.bind(e,s)):r.push(this.el.on(e,o,s))}return r},o.prototype.refreshElements=function(){var t,e,n,i;for(t in n=[],e=this.elements)i=e[t],n.push(this[i]=this.$(t));return n},o.prototype.delay=function(t,e){return setTimeout(this.proxy(t),e||0)},o.prototype.html=function(t){return this.el.html(t.el||t),this.refreshElements(),this.el},o.prototype.append=function(){var i,s,t;return s=1<=arguments.length?c.call(arguments,0):[],s=function(){var t,e,n;for(n=[],t=0,e=s.length;t<e;t++)i=s[t],n.push(i.el||i);return n}(),(t=this.el).append.apply(t,s),this.refreshElements(),this.el},o.prototype.appendTo=function(t){return this.el.appendTo(t.el||t),this.refreshElements(),this.el},o.prototype.prepend=function(){var i,s,t;return s=1<=arguments.length?c.call(arguments,0):[],s=function(){var t,e,n;for(n=[],t=0,e=s.length;t<e;t++)i=s[t],n.push(i.el||i);return n}(),(t=this.el).prepend.apply(t,s),this.refreshElements(),this.el},o.prototype.replace=function(t){var e,n,i;return"string"==typeof(t=t.el||t)&&(t=w.trim(t)),e=(i=[this.el,w((null!=(n=w.parseHTML(t))?n[0]:void 0)||t)])[0],this.el=i[1],e.replaceWith(this.el),this.delegateEvents(this.events),this.refreshElements(),this.el},o}(),w=("undefined"!=typeof window&&null!==window?window.jQuery:void 0)||("undefined"!=typeof window&&null!==window?window.Zepto:void 0)||function(t){return t},o=Object.create||function(t){var e;return(e=function(){}).prototype=t,new e},a=function(t){return Array.prototype.slice.call(t,0)},r=this.Spine={},null!=module&&(module.exports=r),r.version="1.6.1",r.$=w,r.Events=n,r.Log=e,r.Module=s,r.Controller=t,r.Model=i,s.extend.call(r,n),s.create=s.sub=t.create=t.sub=i.sub=function(t,e){var n;return n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e}(this),t&&n.include(t),e&&n.extend(e),"function"==typeof n.unbind&&n.unbind(),n},i.setup=function(t,e){var n;return null==e&&(e=[]),(n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e}(this)).configure.apply(n,[t].concat(c.call(e))),n},r.Class=s}.call(this),function(){var c,p,e,t,n,i,s,o,u,r,a,h=[].slice,l=function(t,e){return function(){return t.apply(e,arguments)}},d=function(t,e){function n(){this.constructor=t}for(var i in e)f.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f={}.hasOwnProperty;a=this.Spine||require("spine"),c=a.$,o=a.Model,u=c({}),p={getURL:function(t){return null!=t.className?this.generateURL(t):this.generateURL(t,encodeURIComponent(t.id))},getCollectionURL:function(t){return this.generateURL(t)},getScope:function(t){return("function"==typeof t.scope?t.scope():void 0)||t.scope},getCollection:function(t){return t.url!==t.generateURL?"function"==typeof t.url?t.url():t.url:null!=t.className?t.className.toLowerCase()+"s":void 0},generateURL:function(t){var e,n,i,s,r;return i=t,e=2<=arguments.length?h.call(arguments,1):[],n=p.getCollection(i)||p.getCollection(i.constructor),r=p.getScope(i
)||p.getScope(i.constructor),e.unshift(n),e.unshift(r),0!==(s=(s=(s=e.join("/")).replace(/(\/\/)/g,"/")).replace(/^\/|\/$/g,"")).indexOf("../")?o.host+"/"+s:s},enabled:!0,disable:function(t){if(!this.enabled)return t();this.enabled=!1;try{return t()}catch(e){throw e}finally{this.enabled=!0}},queue:function(t){return t?u.queue(t):u.queue()},clearQueue:function(){return this.queue([])},config:{loadMethod:"GET",updateMethod:"PUT",createMethod:"POST",destroyMethod:"DELETE"}},e=function(){function t(){}return t.prototype.defaults={dataType:"json",processData:!1,headers:{"X-Requested-With":"XMLHttpRequest"}},t.prototype.queue=p.queue,t.prototype.ajax=function(t,e){return c.ajax(this.ajaxSettings(t,e))},t.prototype.ajaxQueue=function(t,e,s){var r,o,a,n,i,l;return o=null,r=c.Deferred(),n=r.promise(),p.enabled&&(l=this.ajaxSettings(t,e),a=void 0!==l.parallel?l.parallel:"GET"===l.type,i=function(t){var e,n,i;if(null!=(null!=s?s.id:void 0)&&(null==l.url&&(l.url=p.getURL(s)),null!=(e=l.data)&&(e.id=s.id)),"string"!=typeof l.data&&!0!==l.processData&&(l.data=JSON.stringify(l.data)),i=function(){return r.resolve.apply(this,h.call(arguments).concat([l]))},n=function(){return r.reject.apply(this,h.call(arguments).concat([l]))},(o=c.ajax(l)).done(i),o.fail(n),o.then(t,t),a)return u.dequeue()},n.abort=function(t){var e;return o?o.abort(t):(-1<(e=c.inArray(i,this.queue()))&&this.queue().splice(e,1),r.rejectWith(l.context||l,[n,t,""]),n)},this.queue(i)),n},t.prototype.ajaxSettings=function(t,e){return c.extend({},this.defaults,e,t)},t}(),t=function(){function t(t){this.model=t,this.failResponse=l(this.failResponse,this),this.recordsResponse=l(this.recordsResponse,this)}return d(t,e),t.prototype.find=function(t,e,n){var i;return null==n&&(n={}),i=new this.model({id:t}),this.ajaxQueue(e,{type:n.method||p.config.loadMethod,url:n.url||p.getURL(i),parallel:n.parallel}).done(this.recordsResponse(n)).fail(this.failResponse(n))},t.prototype.all=function(t,e){return null==e&&(e={}),this.ajaxQueue(t,{type:e.method||p.config.loadMethod,url:e.url||p.getURL(this.model),parallel:e.parallel}).done(this.recordsResponse(e)).fail(this.failResponse(e))},t.prototype.fetch=function(t,e){var n,i,s;return null==t&&(t={}),null==e&&(e={}),(n=t.id)?(delete t.id,this.find(n,t,e).done((s=this,function(t){return s.model.refresh(t,e)}))):this.all(t,e).done((i=this,function(t){return i.model.refresh(t,e)}))},t.prototype.recordsResponse=function(r){return o=this,function(t,e,n,i){var s;return o.model.trigger("ajaxSuccess",null,e,n,i),null!=(s=r.done)?s.call(o.model,i):void 0};var o},t.prototype.failResponse=function(a){return l=this,function(t,e,n,i){var s,r,o;return l.model.trigger("ajaxError",null,t,e,n,i),l.record.trigger("ajaxError",l.record,t,e,n,i),r=t.responseText,_.isEmpty(r)||(s=JSON.parse(r)),null!=(o=a.fail)?o.call(l.record,i,s):void 0};var l},t}(),r=function(){function t(t){this.record=t,this.failResponse=l(this.failResponse,this),this.recordResponse=l(this.recordResponse,this),this.model=this.record.constructor}return d(t,e),t.prototype.reload=function(t,e){return null==e&&(e={}),this.ajaxQueue(t,{type:e.method||p.config.loadMethod,url:e.url,parallel:e.parallel},this.record).done(this.recordResponse(e)).fail(this.failResponse(e))},t.prototype.create=function(t,e){return null==e&&(e={}),this.ajaxQueue(t,{type:e.method||p.config.createMethod,contentType:"application/json",data:this.record.toJSON(),url:e.url||p.getCollectionURL(this.record),parallel:e.parallel}).done(this.recordResponse(e)).fail(this.failResponse(e))},t.prototype.update=function(t,e){return null==e&&(e={}),this.ajaxQueue(t,{type:e.method||p.config.updateMethod,contentType:"application/json",data:this.record.toJSON(),url:e.url,parallel:e.parallel},this.record).done(this.recordResponse(e)).fail(this.failResponse(e))},t.prototype.destroy=function(t,e){return null==e&&(e={}),this.ajaxQueue(t,{type:e.method||p.config.destroyMethod,url:e.url,parallel:e.parallel},this.record).done(this.recordResponse(e)).fail(this.failResponse(e))},t.prototype.recordResponse=function(r){return o=this,function(t,e,n,i){var s;return null!=t&&Object.getOwnPropertyNames(t).length&&!o.record.destroyed&&o.record.refresh(t,{ajax:!1}),o.record.trigger("ajaxSuccess",o.record,o.model.fromJSON(t),e,n,i),null!=(s=r.done)?s.call(o.record,i):void 0};var o},t.prototype.failResponse=function(a){return l=this,function(t,e,n,i){var s,r,o;switch(i.type){case"POST":l.createFailed();break;case"DELETE":l.destroyFailed()}return l.record.trigger("ajaxError",l.record,t,e,n,i),r=t.responseText,_.isEmpty(r)||(s=JSON.parse(r)),null!=(o=a.fail)&&o.call(l.record,i,s),l.record.trigger("destroy",l.record)};var l},t.prototype.createFailed=function(){return this.record.remove({clear:!0})},t.prototype.destroyFailed=function(){return this.record.destroyed=!1,this.record.constructor.refresh(this.record)},t}(),o.host="",s={ajax:function(){return new r(this)},generateURL:(i={include:function(){var t;return(t=1<=arguments.length?h.call(arguments,0):[]).unshift(encodeURIComponent(this.id)),p.generateURL.apply(p,[this].concat(h.call(t)))},extend:function(){var t;return t=1<=arguments.length?h.call(arguments,0):[],p.generateURL.apply(p,[this].concat(h.call(t)))}}).include,url:i.include},n={ajax:function(){return new t(this)},generateURL:i.extend,url:i.extend},o.Ajax={extended:function(){return this.fetch(this.ajaxFetch),this.change(this.ajaxChange),this.extend(n),this.include(s)},ajaxFetch:function(){var t;return(t=this.ajax()).fetch.apply(t,arguments)},ajaxChange:function(t,e,n){var i;if(null==n&&(n={}),!1!==n.ajax)return"function"==typeof(i=t.ajax())[e]?i[e](n.ajax,n):void 0}},o.Ajax.Methods={extended:function(){return this.extend(n),this.include(s)}},p.defaults=e.prototype.defaults,p.Base=e,p.Singleton=r,p.Collection=t,a.Ajax=p,null!=module&&(module.exports=p)}.call(this),function(){var t;(t=this.Spine||require("spine")).Model.Local={extended:function(){var t;t="spine"+(new Date).getTime();try{localStorage.setItem(t,t),localStorage.removeItem(t)}catch(e){return void e}return this.change(this.saveLocal),this.fetch(this.loadLocal)},saveLocal:function(){var t;return t=JSON.stringify(this),localStorage[this.className]=t},loadLocal:function(t){var e;return null==t&&(t={}),t.hasOwnProperty("clear")||(t.clear=!0),e=localStorage[this.className],this.refresh(e||[],t)}},null!=module&&(module.exports=t.Model.Local)}.call(this),function(){var s,r,l,i,o,a,c,p,u=function(t,e){function n(){this.constructor=t}for(var i in e)h.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},h={}.hasOwnProperty,d=[].slice;i=this.Spine||require("spine"),s=i.$,a=/^#*/,c=/:([\w\d]+)/g,p=/\*([\w\d]+)/g,o=/[-[\]{}()+?.,\\^$|#\s]/g,r=function(t){function e(t,e){var n;if(this.names=[],this.path=t,this.callback=e,"string"==typeof t){for(c.lastIndex=0;null!==(n=c.exec(t));)this.names.push(n[1]);for(p.lastIndex=0;null!==(n=p.exec(t));)this.names.push(n[1]);t=t.replace(o,"\\$&").replace(c,"([^/]*)").replace(p,"(.*?)"),this.route=new RegExp("^"+t+"$")}else this.route=t}return u(e,t),e.prototype.match=function(t,e){var n,i,s,r,o,a;if(null==e&&(e={}),!(r=this.route.exec(t)))return!1;if(a=(e.match=r).slice(1),this.names.length)for(n=i=0,s=a.length;i<s;n=++i)o=a[n],e[this.names[n]]=o;return l.trigger("before",this),!1!==this.callback.call(null,e)},e}(i.Module),(l=function(t){function e(){this.routes=[]}var n;return u(e,t),e.extend(i.Events),e.historySupport=null!=(null!=(n=window.history)?n.pushState:void 0),e.options={trigger:!0,history:!1,shim:!1,replace:!1,redirect:!1},e.routers=[],e.setup=function(t){if(null==t&&(t={}),this.options=s.extend({},this.options,t),this.options.history&&(this.history=this.historySupport&&this.options.history),!this.options.shim)return this.history?s(window).bind("popstate",this.change):s(window).bind("hashchange",this.change),this.change()},e.unbind=function(){var t;return t=i.Events.unbind.apply(this,arguments),0<arguments.length?t:this.options.shim?void 0:this.history?s(window).unbind("popstate",this.change):s(window).unbind("hashchange",this.change)},e.navigate=function(){var t,e,n,i;if(n={},"object"==typeof(e=(t=1<=arguments.length?d.call(arguments,0):[])[t.length-1])?n=t.pop():"boolean"==typeof e&&(n.trigger=t.pop()),n=s.extend({},this.options,n),i=t.join("/"),this.path!==i){if(this.path=i,n.trigger&&(this.trigger("navigate",this.path),!this.matchRoutes(this.path,n).length)){if("function"==typeof n.redirect)return n.redirect.apply(this,[this.path,n]);!0===n.redirect&&this.redirect(this.path)}return!!n.shim||(this.history&&n.replace?history.replaceState({},document.title,this.path):this.history?history.pushState({},document.title,this.path):window.location.hash=this.path)}},e.create=function(){var t;return t=new this,this.routers.push(t),t},e.add=function(t,e){return this.router.add(t,e)},e.prototype.add=function(t,e){var n,i,s;if("object"!=typeof t||t instanceof RegExp)return this.routes.push(new r(t,e));for(n in i=[],t)s=t[n],i.push(this.add(n,s));return i},e.prototype.destroy=function(){var s;return this.routes.length=0,this.constructor.routers=function(){var t,e,n,i;for(i=[],t=0,e=(n=this.constructor.routers).length;t<e;t++)(s=n[t])!==this&&i.push(s);return i}.call(this)},e.getPath=function(){var t;return this.history?"/"!==(t=window.location.pathname).substr(0,1)&&(t="/"+t):t=(t=window.location.hash).replace(a,""),t},e.getHost=function(){return window.location.protocol+"//"+window.location.host},e.change=function(){var t;if((t=e.getPath())!==e.path)return e.path=t,e.matchRoutes(e.path)},e.matchRoutes=function(t,e){var n,i,s,r,o;for(r=[],n=0,i=(o=this.routers.concat([this.router])).length;n<i;n++)(s=o[n].matchRoute(t,e))&&r.push(s);return r.length&&this.trigger("change",r,t),r},e.redirect=function(t){return window.location=t},e.prototype.matchRoute=function(t,e){var n,i,s,r;for(n=0,i=(s=this.routes).length;n<i;n++)if((r=s[n]).match(t,e))return r},e.prototype.trigger=function(){var t,e;return(t=1<=arguments.length?d.call(arguments,0):[]).splice(1,0,this),(e=this.constructor).trigger.apply(e,t)},e}(i.Module)).router=new l,i.Controller.include({route:function(t,e){return this.router instanceof i.Route?this.router.add(t,this.proxy(e)):i.Route.add(t,this.proxy(e))},routes:function(t){var e,n,i;for(e in n=[],t)i=t[e],n.push(this.route(e,i));return n},navigate:function(){return i.Route.navigate.apply(i.Route,arguments)}}),l.Path=r,i.Route=l,null!=module&&(module.exports=l)}.call(this),function(r){r.color={},r.color.make=function(t,e,n,i){var s={};return s.r=t||0,s.g=e||0,s.b=n||0,s.a=null!=i?i:1,s.add=function(t,e){for(var n=0;n<t.length;++n)s[t.charAt(n)]+=e;return s.normalize()},s.scale=function(t,e){for(var n=0;n<t.length;++n)s[t.charAt(n)]*=e;return s.normalize()},s.toString=function(){return 1<=s.a?"rgb("+[s.r,s.g,s.b].join(",")+")":"rgba("+[s.r,s.g,s.b,s.a].join(",")+")"},s.normalize=function(){function t(t,e,n){return e<t?t:n<e?n:e}return s.r=t(0,parseInt(s.r),255),s.g=t(0,parseInt(s.g),255),s.b=t(0,parseInt(s.b),255),s.a=t(0,s.a,1),s},s.clone=function(){return r.color.make(s.r,s.b,s.g,s.a)},s.normalize()},r.color.extract=function(t,e){var n;do{if(""!=(n=t.css(e).toLowerCase())&&"transparent"!=n)break;t=t.parent()}while(!r.nodeName(t.get(0),"body"));return"rgba(0, 0, 0, 0)"==n&&(n="transparent"),r.color.parse(n)},r.color.parse=function(t){var e,n=r.color.make;if(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t))return n(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10));if(e=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(t))return n(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),parseFloat(e[4]));if(e=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(t))return n(2.55*parseFloat(e[1]),2.55*parseFloat(e[2]),2.55*parseFloat(e[3]));if(e=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(t))return n(2.55*parseFloat(e[1]),2.55*parseFloat(e[2]),2.55*parseFloat(e[3]),parseFloat(e[4]));if(e=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(t))return n(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16));if(e=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(t))return n(parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16));var i=r.trim(t).toLowerCase();return"transparent"==i?n(255,255,255,0):n((e=s[i]||[0,0,0])[0],e[1],e[2])};var s={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(wt){function s(d,t,e,n){function k(t,e){e=[yt].concat(e);for(var n=0;n<t.length;++n)t[n].apply(this,e)}function s(){for(var t=0;t<n.length;++t){var e=n[t];e.init(yt),e.options&&wt.extend(!0,st,e.options)}}function r(t){var e;for(wt.extend(!0,st,t),null==st.xaxis.color&&(st.xaxis.color=st.grid.color),null==st.yaxis.color&&(st.yaxis.color=st.grid.color),null==st.xaxis.tickColor&&(st.xaxis.tickColor=st.grid.tickColor),null==st.yaxis.tickColor&&(st.yaxis.tickColor=st.grid.tickColor),null==st.grid.borderColor&&(st.grid.borderColor=st.grid.color),null==st.grid.tickColor&&(st.grid.tickColor=wt.color.parse(st.grid.color).scale("a",.22).toString()),e=0;e<Math.max(1,st.xaxes.length);++e)st.xaxes[e]=wt.extend(!0,{},st.xaxis,st.xaxes[e]);for(e=0;e<Math.max(1,st.yaxes.length);++e)st.yaxes[e]=wt.extend(!0,{},st.yaxis,st.yaxes[e]);for(st.xaxis.noTicks&&null==st.xaxis.ticks&&(st.xaxis.ticks=st.xaxis.noTicks),st.yaxis.noTicks&&null==st.yaxis.ticks&&(st.yaxis.ticks=st.yaxis.noTicks),st.x2axis&&(st.xaxes[1]=wt.extend(!0,{},st.xaxis,st.x2axis),st.xaxes[1].position="top"),st.y2axis&&(st.yaxes[1]=wt.extend(!0,{},st.yaxis,st.y2axis),st.yaxes[1].position="right"),st.grid.coloredAreas&&(st.grid.markings=st.grid.coloredAreas),st.grid.coloredAreasColor&&(st.grid.markingsColor=st.grid.coloredAreasColor),st.lines&&wt.extend(!0,st.series.lines,st.lines),st.points&&wt.extend(!0,st.series.points,st.points),st.bars&&wt.extend(!0,st.series.bars,st.bars),null!=st.shadowSize&&(st.series.shadowSize=st.shadowSize),e=0;e<st.xaxes.length;++e)m(pt,e+1).options=st.xaxes[e];for(e=0;e<st.yaxes.length;++e)m(ut,e+1).options=st.yaxes[e];for(var n in vt)st.hooks[n]&&st.hooks[n].length&&(vt[n]=vt[n].concat(st.hooks[n]));k(vt.processOptions,[st])}function o(t){it=a(t),c(),u()}function a(t){for(var e=[],n=0;n<t.length;++n){var i=wt.extend(!0,{},st.series);null!=t[n].data?(i.data=t[n].data,delete t[n].data,wt.extend(!0,i,t[n]),t[n].data=i.data):i.data=t[n],e.push(i)}return e}function f(t,e){var n=t[e+"axis"];return"object"==typeof n&&(n=n.n),"number"!=typeof n&&(n=1),n}function T(){return wt.grep(pt.concat(ut),function(t){return t})}function p(t){var e,n,i={};for(e=0;e<pt.length;++e)(n=pt[e])&&n.used&&(i["x"+n.n]=n.c2p(t.left));for(e=0;e<ut.length;++e)(n=ut[e])&&n.used&&(i["y"+n.n]=n.c2p(t.top));return i.x1!==undefined&&(i.x=i.x1),i.y1!==undefined&&(i.y=i.y1),i}function l(t){var e,n,i,s={};for(e=0;e<pt.length;++e)if((n=pt[e])&&n.used&&(null==t[i="x"+n.n]&&1==n.n&&(i="x"),null!=t[i])){s.left=n.p2c(t[i]);break}for(e=0;e<ut.length;++e)if((n=ut[e])&&n.used&&(null==t[i="y"+n.n]&&1==n.n&&(i="y"),null!=t[i])){s.top=n.p2c(t[i]);break}return s}function m(t,e){return t[e-1]||(t[e-1]={n:e,direction:t==pt?"x":"y",options:wt.extend(!0,{},t==pt?st.xaxis:st.yaxis)}),t[e-1]}function c(){var t,e=it.length,n=[],i=[];for(t=0;t<it.length;++t){var s=it[t].color;null!=s&&(--e,"number"==typeof s?i.push(s):n.push(wt.color.parse(it[t].color)))}for(t=0;t<i.length;++t)e=Math.max(e,i[t]+1);var r=[],o=0;for(t=0;r.length<e;){var a,l=o%2==1?-1:1;(a=st.colors.length==t?wt.color.make(100,100,100):wt.color.parse(st.colors[t])).scale("rgb",1+l*Math.ceil(o/2)*.2),r.push(a),++t>=st.colors.length&&(t=0,++o)}var c,p=0;for(t=0;t<it.length;++t){if(null==(c=it[t]).color?(c.color=r[p].toString(),++p):"number"==typeof c.color&&(c.color=r[c.color].toString()),null==c.lines.show){var u,h=!0;for(u in c)if(c[u]&&c[u].show){h=!1;break}h&&(c.lines.show=!0)}c.xaxis=m(pt,f(c,"x")),c.yaxis=m(ut,f(c,"y"))}}function u(){function t(t,e,n){e<t.datamin&&e!=-d&&(t.datamin=e),n>t.datamax&&n!=d&&(t.datamax=n)}var e,n,i,s,r,o,a,l,c,p,u=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,d=Number.MAX_VALUE;for(wt.each(T(),function(t,e){e.datamin=u,e.datamax=h,e.used=!1}),e=0;e<it.length;++e)(r=it[e]).datapoints={points:[]},k(vt.processRawData,[r,r.data,r.datapoints]);for(e=0;e<it.length;++e){var f=(r=it[e]).data,m=r.datapoints.format;if(m||((m=[]).push({x:!0,number:!0,required:!0}),m.push({y:!0,number:!0,required:!0}),(r.bars.show||r.lines.show&&r.lines.fill)&&(m.push({y:!0,number:!0,required:!1,defaultValue:0}),r.bars.horizontal&&(delete m[m.length-1].y,m[m.length-1].x=!0)),r.datapoints.format=m),null==r.datapoints.pointsize)for(r.datapoints.pointsize=m.length,a=r.datapoints.pointsize,o=r.datapoints.points,insertSteps=r.lines.show&&r.lines.steps,r.xaxis.used=r.yaxis.used=!0,n=i=0;n<f.length;++n,i+=a){var g=null==(p=f[n]);if(!g)for(s=0;s<a;++s)l=p[s],(c=m[s])&&(c.number&&null!=l&&(l=+l,isNaN(l)?l=null:l==Infinity?l=d:l==-Infinity&&(l=-d)),null==l&&(c.required&&(g=!0),null!=c.defaultValue&&(l=c.defaultValue))),o[i+s]=l;if(g)for(s=0;s<a;++s)null!=(l=o[i+s])&&((c=m[s]).x&&t(r.xaxis,l,l),c.y&&t(r.yaxis,l,l)),o[i+s]=null;else if(insertSteps&&0<i&&null!=o[i-a]&&o[i-a]!=o[i]&&o[i-a+1]!=o[i+1]){for(s=0;s<a;++s)o[i+a+s]=o[i+s];o[i+1]=o[i-a+1],i+=a}}}for(e=0;e<it.length;++e)r=it[e],k(vt.processDatapoints,[r,r.datapoints]);for(e=0;e<it.length;++e){o=(r=it[e]).datapoints.points,a=r.datapoints.pointsize;var v=u,y=u,b=h,_=h;for(n=0;n<o.length;n+=a)if(null!=o[n])for(s=0;s<a;++s)l=o[n+s],(c=m[s])&&l!=d&&l!=-d&&(c.x&&(l<v&&(v=l),b<l&&(b=l)),c.y&&(l<y&&(y=l),_<l&&(_=l)));if(r.bars.show){var w="left"==r.bars.align?0:-r.bars.barWidth/2;r.bars.horizontal?(y+=w,_+=w+r.bars.barWidth):(v+=w,b+=w+r.bars.barWidth)}t(r.xaxis,v,b),t(r.yaxis,y,_)}wt.each(T(),function(t,e){e.datamin==u&&(e.datamin=null),e.datamax==h&&(e.datamax=null)})}function h(t,e){var n=document.createElement("canvas");return n.className=e,n.width=dt,n.height=ft,t||wt(n).css({position:"absolute",left:0,top:0}),wt(n).appendTo(d),n.getContext||(n=window.G_vmlCanvasManager.initElement(n)),n.getContext("2d").save(),n}function g(){if(dt=d.width(),ft=d.height(),dt<=0||ft<=0)throw"Invalid dimensions for plot, width = "+dt+", height = "+ft}function v(t){t.width!=dt&&(t.width=dt),t.height!=ft&&(t.height=ft);var e=t.getContext("2d");e.restore(),e.save()}function y(){var t,e=d.children("canvas.base"),n=d.children("canvas.overlay");0==e.length||0==n?(d.html(""),d.css({padding:0}),"static"==d.css("position")&&d.css("position","relative"),g(),rt=h(!0,"base"),ot=h(!1,"overlay"),t=!1):(rt=e.get(0),ot=n.get(0),t=!0),lt=rt.getContext("2d"),ct=ot.getContext("2d"),at=wt([ot,rt]),t&&(d.data("plot").shutdown(),yt.resize(),ct.clearRect(0,0,dt,ft),at.unbind(),d.children().not([rt,ot]).remove()),d.data("plot",yt)}function b(){st.grid.hoverable&&(at.mousemove(H),at.mouseleave(W)),st.grid.clickable&&at.click(G),k(vt.bindEvents,[at])}function _(){_t&&clearTimeout(_t),at.unbind("mousemove",H),at.unbind("mouseleave",W),at.unbind("click",G),k(vt.shutdown,[at])}function w(t){function e(t){return t}var n,i,s=t.options.transform||e,r=t.options.inverseTransform;"x"==t.direction?(n=t.scale=mt/Math.abs(s(t.max)-s(t.min)),i=Math.min(s(t.max),s(t.min))):(n=-(n=t.scale=gt/Math.abs(s(t.max)-s(t.min))),i=Math.max(s(t.max),s(t.min))),t.p2c=s==e?function(t){return(t-i)*n}:function(t){return(s(t)-i)*n},t.c2p=r?function(t){return r(i+t/n)}:function(t){return i+t/n}}function A(n){function t(t,e){return wt('<div style="position:absolute;top:-10000px;'+e+'font-size:smaller"><div class="'+n.direction+"Axis "+n.direction+n.n+'Axis">'+t.join("")+"</div></div>").appendTo(d)}var e,i,s,r=n.options,o=n.ticks||[],a=[],l=r.labelWidth,c=r.labelHeight;if("x"==n.direction){if(null==l&&(l=Math.floor(dt/(0<o.length?o.length:1))),null==c){for(a=[],e=0;e<o.length;++e)(i=o[e].label)&&a.push('<div class="tickLabel" style="float:left;width:'+l+'px">'+i+"</div>");0<a.length&&(a.push('<div style="clear:left"></div>'),c=(s=t(a,"width:10000px;")).height(),s.remove())}}else if(null==l||null==c){for(e=0;e<o.length;++e)(i=o[e].label)&&a.push('<div class="tickLabel">'+i+"</div>");0<a.length&&(s=t(a,""),null==l&&(l=s.children().width()),null==c&&(c=s.find("div.tickLabel").height()),s.remove())}null==l&&(l=0),null==c&&(c=0),n.labelWidth=l,n.labelHeight=c}function S(t){var e=t.labelWidth,n=t.labelHeight,i=t.options.position,s=t.options.tickLength,r=st.grid.axisMargin,o=st.grid.labelMargin,a="x"==t.direction?pt:ut,l=wt.grep(a,function(t){return t&&t.options.position==i&&t.reserveSpace});wt.inArray(t,l)==l.length-1&&(r=0),null==s&&(s="full");var c=wt.grep(a,function(t){return t&&t.reserveSpace}),p=0==wt.inArray(t,c);p||"full"!=s||(s=5),isNaN(+s)||(o+=+s),"x"==t.direction?(n+=o,"bottom"==i?(ht.bottom+=n+r,t.box={top:ft-ht.bottom,height:n}):(t.box={top:ht.top+r,height:n},ht.top+=n+r)):(e+=o,"left"==i?(t.box={left:ht.left+r,width:e},ht.left+=e+r):(ht.right+=e+r,t.box={left:dt-ht.right,width:e})),t.position=i,t.tickLength=s,t.box.padding=o,t.innermost=p}function C(t){"x"==t.direction?(t.box.left=ht.left,t.box.width=mt):(t.box.top=ht.top,t.box.height=gt)}function x(){var t,e=T();if(wt.each(e,function(t,e){e.show=e.options.show,null==e.show&&(e.show=e.used),e.reserveSpace=e.show||e.options.reserveSpace,j(e)}),allocatedAxes=wt.grep(e,function(t){return t.reserveSpace}),ht.left=ht.right=ht.top=ht.bottom=0,st.grid.show){for(wt.each(allocatedAxes,function(t,e){P(e),I(e),E(e,e.ticks),A(e)}),t=allocatedAxes.length-1;0<=t;--t)S(allocatedAxes[t]);var n=st.grid.minBorderMargin;if(null==n)for(t=n=0;t<it.length;++t)n=Math.max(n,it[t].points.radius+it[t].points.lineWidth/2);for(var i in ht)ht[i]+=st.grid.borderWidth,ht[i]=Math.max(n,ht[i])}mt=dt-ht.left-ht.right,gt=ft-ht.bottom-ht.top,wt.each(e,function(t,e){w(e)}),st.grid.show&&(wt.each(allocatedAxes,function(t,e){C(e)}),M()),q()}function j(t){var e=t.options,n=+(null!=e.min?e.min:t.datamin),i=+(null!=e.max?e.max:t.datamax),s=i-n;if(0==s){var r=0==i?1:.01;null==e.min&&(n-=r),null!=e.max&&null==e.min||(i+=r)}else{var o=e.autoscaleMargin;null!=o&&(null==e.min&&(n-=s*o)<0&&null!=t.datamin&&0<=t.datamin&&(n=0),null==e.max&&0<(i+=s*o)&&null!=t.datamax&&t.datamax<=0&&(i=0))}t.min=n,t.max=i}function P(t){var e,o=t.options;e="number"==typeof o.ticks&&0<o.ticks?o.ticks:.3*Math.sqrt("x"==t.direction?dt:ft);var n,i,s,r,a,l,c=(t.max-t.min)/e;if("time"==o.mode){var u={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,year:525949.2*60*1e3},p=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]],h=0;null!=o.minTickSize&&(h="number"==typeof o.tickSize?o.tickSize:o.minTickSize[0]*u[o.minTickSize[1]]);for(var d=0;d<p.length-1&&!(c<(p[d][0]*u[p[d][1]]+p[d+1][0]*u[p[d+1][1]])/2&&p[d][0]*u[p[d][1]]>=h);++d);n=p[d][0],"year"==(s=p[d][1])&&(a=Math.pow(10,Math.floor(Math.log(c/u.year)/Math.LN10)),n=(l=c/u.year/a)<1.5?1:l<3?2:l<7.5?5:10,n*=a),t.tickSize=o.tickSize||[n,s],i=function(t){var e=[],n=t.tickSize[0],i=t.tickSize[1],s=new Date(t.min),r=n*u[i];"second"==i&&s.setUTCSeconds(kt(s.getUTCSeconds(),n)),"minute"==i&&s.setUTCMinutes(kt(s.getUTCMinutes(),n)),"hour"==i&&s.setUTCHours(kt(s.getUTCHours(),n)),"month"==i&&s.setUTCMonth(kt(s.getUTCMonth(),n)),"year"==i&&s.setUTCFullYear(kt(s.getUTCFullYear(),n)),s.setUTCMilliseconds(0),r>=u.minute&&s.setUTCSeconds(0),r>=u.hour&&s.setUTCMinutes(0),r>=u.day&&s.setUTCHours(0),r>=4*u.day&&s.setUTCDate(1),r>=u.year&&s.setUTCMonth(0);var o,a=0,l=Number.NaN;do{if(o=l,l=s.getTime(),e.push(l),"month"==i)if(n<1){s.setUTCDate(1);var c=s.getTime();s.setUTCMonth(s.getUTCMonth()+1);var p=s.getTime();s.setTime(l+a*u.hour+(p-c)*n),a=s.getUTCHours(),s.setUTCHours(0)}else s.setUTCMonth(s.getUTCMonth()+n);else"year"==i?s.setUTCFullYear(s.getUTCFullYear()+n):s.setTime(l+r)}while(l<t.max&&l!=o);return e},r=function(t,e){var n=new Date(t);if(null!=o.timeformat)return wt.plot.formatDate(n,o.timeformat,o.monthNames);var i=e.tickSize[0]*u[e.tickSize[1]],s=e.max-e.min,r=o.twelveHourClock?" %p":"";return i<u.minute?fmt="%h:%M:%S"+r:i<u.day?s<2*u.day?fmt="%h:%M"+r:fmt="%b %d %h:%M"+r:i<u.month?fmt="%b %d":i<u.year?s<u.year?fmt="%b":fmt="%b %y":fmt="%y",wt.plot.formatDate(n,fmt,o.monthNames)}}else{var f=o.tickDecimals,m=-Math.floor(Math.log(c)/Math.LN10);null!=f&&f<m&&(m=f),(l=c/(a=Math.pow(10,-m)))<1.5?n=1:l<3?(n=2,2.25<l&&(null==f||m+1<=f)&&(n=2.5,++m)):n=l<7.5?5:10,n*=a,null!=o.minTickSize&&n<o.minTickSize&&(n=o.minTickSize),t.tickDecimals=Math.max(0,null!=f?f:m),t.tickSize=o.tickSize||n,i=function(t){for(var e,n=[],i=kt(t.min,t.tickSize),s=0,r=Number.NaN;e=r,r=i+s*t.tickSize,n.push(r),++s,r<t.max&&r!=e;);return n},r=function(t,e){return t.toFixed(e.tickDecimals)}}if(null!=o.alignTicksWithAxis){var g=("x"==t.direction?pt:ut)[o.alignTicksWithAxis-1];if(g&&g.used&&g!=t){var v=i(t);if(0<v.length&&(null==o.min&&(t.min=Math.min(t.min,v[0])),null==o.max&&1<v.length&&(t.max=Math.max(t.max,v[v.length-1]))),i=function(t){var e,n,i=[];for(n=0;n<g.ticks.length;++n)e=(g.ticks[n].v-g.min)/(g.max-g.min),e=t.min+e*(t.max-t.min),i.push(e);return i},"time"!=t.mode&&null==o.tickDecimals){var y=Math.max(0,1-Math.floor(Math.log(c)/Math.LN10)),b=i(t);1<b.length&&/\..*0$/.test((b[1]-b[0]).toFixed(y))||(t.tickDecimals=y)}}}t.tickGenerator=i,wt.isFunction(o.tickFormatter)?t.tickFormatter=function(t,e){return""+o.tickFormatter(t,e)}:t.tickFormatter=r}function I(t){var e,n,i=t.options.ticks,s=[];for(null==i||"number"==typeof i&&0<i?s=t.tickGenerator(t):i&&(s=wt.isFunction(i)?i({min:t.min,max:t.max}):i),t.ticks=[],e=0;e<s.length;++e){var r=null,o=s[e];"object"==typeof o?(n=+o[0],1<o.length&&(r=o[1])):n=+o,null==r&&(r=t.tickFormatter(n,t)),isNaN(n)||t.ticks.push({v:n,label:r})}}function E(t,e){t.options.autoscaleMargin&&0<e.length&&(null==t.options.min&&(t.min=Math.min(t.min,e[0].v)),null==t.options.max&&1<e.length&&(t.max=Math.max(t.max,e[e.length-1].v)))}function D(){lt.clearRect(0,0,dt,ft);var t=st.grid;t.show&&t.backgroundColor&&N(),t.show&&!t.aboveData&&R();for(var e=0;e<it.length;++e)k(vt.drawSeries,[lt,it[e]]),$(it[e]);k(vt.draw,[lt]),t.show&&t.aboveData&&R()}function O(t,e){var n,s,r,o,a=T();for(i=0;i<a.length;++i)if((n=a[i]).direction==e&&(t[o=e+n.n+"axis"]||1!=n.n||(o=e+"axis"),t[o])){s=t[o].from,r=t[o].to;break}if(t[o]||(n="x"==e?pt[0]:ut[0],s=t[e+"1"],r=t[e+"2"]),null!=s&&null!=r&&r<s){var l=s;s=r,r=l}return{from:s,to:r,axis:n}}function N(){lt.save(),lt.translate(ht.left,ht.top),lt.fillStyle=nt(st.grid.backgroundColor,gt,0,"rgba(255, 255, 255, 0)"),lt.fillRect(0,0,mt,gt),lt.restore()}function R(){var t;lt.save(),lt.translate(ht.left,ht.top);var e=st.grid.markings;if(e){if(wt.isFunction(e))(r=yt.getAxes()).xmin=r.xaxis.min,r.xmax=r.xaxis.max,r.ymin=r.yaxis.min,r.ymax=r.yaxis.max,e=e(r);for(t=0;t<e.length;++t){var n=e[t],i=O(n,"x"),s=O(n,"y");null==i.from&&(i.from=i.axis.min),null==i.to&&(i.to=i.axis.max),null==s.from&&(s.from=s.axis.min),null==s.to&&(s.to=s.axis.max),i.to<i.axis.min||i.from>i.axis.max||s.to<s.axis.min||s.from>s.axis.max||(i.from=Math.max(i.from,i.axis.min),i.to=Math.min(i.to,i.axis.max),s.from=Math.max(s.from,s.axis.min),s.to=Math.min(s.to,s.axis.max),i.from==i.to&&s.from==s.to||(i.from=i.axis.p2c(i.from),i.to=i.axis.p2c(i.to),s.from=s.axis.p2c(s.from),s.to=s.axis.p2c(s.to),i.from==i.to||s.from==s.to?(lt.beginPath(),lt.strokeStyle=n.color||st.grid.markingsColor,lt.lineWidth=n.lineWidth||st.grid.markingsLineWidth,lt.moveTo(i.from,s.from),lt.lineTo(i.to,s.to),lt.stroke()):(lt.fillStyle=n.color||st.grid.markingsColor,lt.fillRect(i.from,s.to,i.to-i.from,s.from-s.to))))}}for(var r=T(),o=st.grid.borderWidth,a=0;a<r.length;++a){var l,c,p,u,h=r[a],d=h.box,f=h.tickLength;if(h.show&&0!=h.ticks.length){for(lt.strokeStyle=h.options.tickColor||wt.color.parse(h.options.color).scale("a",.22).toString(),lt.lineWidth=1,"x"==h.direction?(l=0,c="full"==f?"top"==h.position?0:gt:d.top-ht.top+("top"==h.position?d.height:0)):(c=0,l="full"==f?"left"==h.position?0:mt:d.left-ht.left+("left"==h.position?d.width:0)),h.innermost||(lt.beginPath(),p=u=0,"x"==h.direction?p=mt:u=gt,1==lt.lineWidth&&(l=Math.floor(l)+.5,c=Math.floor(c)+.5),lt.moveTo(l,c),lt.lineTo(l+p,c+u),lt.stroke()),lt.beginPath(),t=0;t<h.ticks.length;++t){var m=h.ticks[t].v;p=u=0,m<h.min||m>h.max||"full"==f&&0<o&&(m==h.min||m==h.max)||("x"==h.direction?(l=h.p2c(m),u="full"==f?-gt:f,"top"==h.position&&(u=-u)):(c=h.p2c(m),p="full"==f?-mt:f,"left"==h.position&&(p=-p)),1==lt.lineWidth&&("x"==h.direction?l=Math.floor(l)+.5:c=Math.floor(c)+.5),lt.moveTo(l,c),lt.lineTo(l+p,c+u))}lt.stroke()}}o&&(lt.lineWidth=o,lt.strokeStyle=st.grid.borderColor,lt.strokeRect(-o/2,-o/2,mt+o,gt+o)),lt.restore()}function M(){d.find(".tickLabels").remove();for(var t=['<div class="tickLabels" style="font-size:smaller">'],e=T(),n=0;n<e.length;++n){var i=e[n],s=i.box;if(i.show){t.push('<div class="'+i.direction+"Axis "+i.direction+i.n+'Axis" style="color:'+i.options.color+'">');for(var r=0;r<i.ticks.length;++r){var o=i.ticks[r];if(!(!o.label||o.v<i.min||o.v>i.max)){var a,l={};"x"==i.direction?(a="center",l.left=Math.round(ht.left+i.p2c(o.v)-i.labelWidth/2),"bottom"==i.position?l.top=s.top+s.padding:l.bottom=ft-(s.top+s.height-s.padding)):(l.top=Math.round(ht.top+i.p2c(o.v)-i.labelHeight/2),"left"==i.position?(l.right=dt-(s.left+s.width-s.padding),a="right"):(l.left=s.left+s.padding,a="left")),l.width=i.labelWidth;var c=["position:absolute","white-space:nowrap","text-align:"+a];for(var p in l)c.push(p+":"+l[p]+"px");t.push('<div class="tickLabel" style="'+c.join(";")+'">'+o.label+"</div>")}}t.push("</div>")}}t.push("</div>"),d.append(t.join(""))}function $(t){t.lines.show&&L(t),t.bars.show&&B(t),t.points.show&&U(t)}function L(t){function e(t,e,n,i,s){var r=t.points,o=t.pointsize,a=null,l=null;lt.beginPath();for(var c=o;c<r.length;c+=o){var p=r[c-o],u=r[c-o+1],h=r[c],d=r[c+1];if(null!=p&&null!=h){if(u<=d&&u<s.min){if(d<s.min)continue;p=(s.min-u)/(d-u)*(h-p)+p,u=s.min}else if(d<=u&&d<s.min){if(u<s.min)continue;h=(s.min-u)/(d-u)*(h-p)+p,d=s.min}if(d<=u&&u>s.max){if(d>s.max)continue;p=(s.max-u)/(d-u)*(h-p)+p,u=s.max}else if(u<=d&&d>s.max){if(u>s.max)continue;h=(s.max-u)/(d-u)*(h-p)+p,d=s.max}if(p<=h&&p<i.min){if(h<i.min)continue;u=(i.min-p)/(h-p)*(d-u)+u,p=i.min}else if(h<=p&&h<i.min){if(p<i.min)continue;d=(i.min-p)/(h-p)*(d-u)+u,h=i.min}if(h<=p&&p>i.max){if(h>i.max)continue;u=(i.max-p)/(h-p)*(d-u)+u,p=i.max}else if(p<=h&&h>i.max){if(p>i.max)continue;d=(i.max-p)/(h-p)*(d-u)+u,h=i.max}p==a&&u==l||lt.moveTo(i.p2c(p)+e,s.p2c(u)+n),a=h,l=d,lt.lineTo(i.p2c(h)+e,s.p2c(d)+n)}}lt.stroke()}function n(t,e,n){for(var i=t.points,s=t.pointsize,r=Math.min(Math.max(0,n.min),n.max),o=0,a=!1,l=1,c=0,p=0;!(0<s&&o>i.length+s);){var u=i[(o+=s)-s],h=i[o-s+l],d=i[o],f=i[o+l];if(a){if(0<s&&null!=u&&null==d){p=o,s=-s,l=2;continue}if(s<0&&o==c+s){lt.fill(),a=!1,l=1,o=c=p+(s=-s);continue}}if(null!=u&&null!=d){if(u<=d&&u<e.min){if(d<e.min)continue;h=(e.min-u)/(d-u)*(f-h)+h,u=e.min}else if(d<=u&&d<e.min){if(u<e.min)continue;f=(e.min-u)/(d-u)*(f-h)+h,d=e.min}if(d<=u&&u>e.max){if(d>e.max)continue;h=(e.max-u)/(d-u)*(f-h)+h,u=e.max}else if(u<=d&&d>e.max){if(u>e.max)continue;f=(e.max-u)/(d-u)*(f-h)+h,d=e.max}if(a||(lt.beginPath(),lt.moveTo(e.p2c(u),n.p2c(r)),a=!0),h>=n.max&&f>=n.max)lt.lineTo(e.p2c(u),n.p2c(n.max)),lt.lineTo(e.p2c(d),n.p2c(n.max));else if(h<=n.min&&f<=n.min)lt.lineTo(e.p2c(u),n.p2c(n.min)),lt.lineTo(e.p2c(d),n.p2c(n.min));else{var m=u,g=d;h<=f&&h<n.min&&f>=n.min?(u=(n.min-h)/(f-h)*(d-u)+u,h=n.min):f<=h&&f<n.min&&h>=n.min&&(d=(n.min-h)/(f-h)*(d-u)+u,f=n.min),f<=h&&h>n.max&&f<=n.max?(u=(n.max-h)/(f-h)*(d-u)+u,h=n.max):h<=f&&f>n.max&&h<=n.max&&(d=(n.max-h)/(f-h)*(d-u)+u,f=n.max),
u!=m&&lt.lineTo(e.p2c(m),n.p2c(h)),lt.lineTo(e.p2c(u),n.p2c(h)),lt.lineTo(e.p2c(d),n.p2c(f)),d!=g&&(lt.lineTo(e.p2c(d),n.p2c(f)),lt.lineTo(e.p2c(g),n.p2c(f)))}}}}lt.save(),lt.translate(ht.left,ht.top),lt.lineJoin="round";var i=t.lines.lineWidth,s=t.shadowSize;if(0<i&&0<s){lt.lineWidth=s,lt.strokeStyle="rgba(0,0,0,0.1)";var r=Math.PI/18;e(t.datapoints,Math.sin(r)*(i/2+s/2),Math.cos(r)*(i/2+s/2),t.xaxis,t.yaxis),lt.lineWidth=s/2,e(t.datapoints,Math.sin(r)*(i/2+s/4),Math.cos(r)*(i/2+s/4),t.xaxis,t.yaxis)}lt.lineWidth=i,lt.strokeStyle=t.color;var o=F(t.lines,t.color,0,gt);o&&(lt.fillStyle=o,n(t.datapoints,t.xaxis,t.yaxis)),0<i&&e(t.datapoints,0,0,t.xaxis,t.yaxis),lt.restore()}function U(t){function e(t,e,n,i,s,r,o,a){for(var l=t.points,c=t.pointsize,p=0;p<l.length;p+=c){var u=l[p],h=l[p+1];null==u||u<r.min||u>r.max||h<o.min||h>o.max||(lt.beginPath(),u=r.p2c(u),h=o.p2c(h)+i,"circle"==a?lt.arc(u,h,e,0,s?Math.PI:2*Math.PI,!1):a(lt,u,h,e,s),lt.closePath(),n&&(lt.fillStyle=n,lt.fill()),lt.stroke())}}lt.save(),lt.translate(ht.left,ht.top);var n=t.points.lineWidth,i=t.shadowSize,s=t.points.radius,r=t.points.symbol;if(0<n&&0<i){var o=i/2;lt.lineWidth=o,lt.strokeStyle="rgba(0,0,0,0.1)",e(t.datapoints,s,null,o+o/2,!0,t.xaxis,t.yaxis,r),lt.strokeStyle="rgba(0,0,0,0.2)",e(t.datapoints,s,null,o/2,!0,t.xaxis,t.yaxis,r)}lt.lineWidth=n,lt.strokeStyle=t.color,e(t.datapoints,s,F(t.points,t.color),0,!1,t.xaxis,t.yaxis,r),lt.restore()}function z(t,e,n,i,s,r,o,a,l,c,p,u){var h,d,f,m,g,v,y,b,_;p?(b=v=y=!0,g=!1,m=e+i,f=e+s,(d=t)<(h=n)&&(_=d,d=h,h=_,v=!(g=!0))):(g=v=y=!0,b=!1,h=t+i,d=t+s,(m=e)<(f=n)&&(_=m,m=f,f=_,y=!(b=!0))),d<a.min||h>a.max||m<l.min||f>l.max||(h<a.min&&(h=a.min,g=!1),d>a.max&&(d=a.max,v=!1),f<l.min&&(f=l.min,b=!1),m>l.max&&(m=l.max,y=!1),h=a.p2c(h),f=l.p2c(f),d=a.p2c(d),m=l.p2c(m),o&&(c.beginPath(),c.moveTo(h,f),c.lineTo(h,m),c.lineTo(d,m),c.lineTo(d,f),c.fillStyle=o(f,m),c.fill()),0<u&&(g||v||y||b)&&(c.beginPath(),c.moveTo(h,f+r),g?c.lineTo(h,m+r):c.moveTo(h,m+r),y?c.lineTo(d,m+r):c.moveTo(d,m+r),v?c.lineTo(d,f+r):c.moveTo(d,f+r),b?c.lineTo(h,f+r):c.moveTo(h,f+r),c.stroke()))}function B(p){function t(t,e,n,i,s,r,o){for(var a=t.points,l=t.pointsize,c=0;c<a.length;c+=l)null!=a[c]&&z(a[c],a[c+1],a[c+2],e,n,i,s,r,o,lt,p.bars.horizontal,p.bars.lineWidth)}lt.save(),lt.translate(ht.left,ht.top),lt.lineWidth=p.bars.lineWidth,lt.strokeStyle=p.color;var e="left"==p.bars.align?0:-p.bars.barWidth/2,n=p.bars.fill?function(t,e){return F(p.bars,p.color,t,e)}:null;t(p.datapoints,e,e+p.bars.barWidth,0,n,p.xaxis,p.yaxis),lt.restore()}function F(t,e,n,i){var s=t.fill;if(!s)return null;if(t.fillColor)return nt(t.fillColor,n,i,e);var r=wt.color.parse(e);return r.a="number"==typeof s?s:.4,r.normalize(),r.toString()}function q(){if(d.find(".legend").remove(),st.legend.show){for(var t,e,n=[],i=!1,s=st.legend.labelFormatter,r=0;r<it.length;++r)(e=(t=it[r]).label)&&(r%st.legend.noColumns==0&&(i&&n.push("</tr>"),n.push("<tr>"),i=!0),s&&(e=s(e,t)),n.push('<td class="legendColorBox"><div style="border:1px solid '+st.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+t.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+e+"</td>"));if(i&&n.push("</tr>"),0!=n.length){var o='<table style="font-size:smaller;color:'+st.grid.color+'">'+n.join("")+"</table>";if(null!=st.legend.container)wt(st.legend.container).html(o);else{var a="",l=st.legend.position,c=st.legend.margin;null==c[0]&&(c=[c,c]),"n"==l.charAt(0)?a+="top:"+(c[1]+ht.top)+"px;":"s"==l.charAt(0)&&(a+="bottom:"+(c[1]+ht.bottom)+"px;"),"e"==l.charAt(1)?a+="right:"+(c[0]+ht.right)+"px;":"w"==l.charAt(1)&&(a+="left:"+(c[0]+ht.left)+"px;");var p=wt('<div class="legend">'+o.replace('style="','style="position:absolute;'+a+";")+"</div>").appendTo(d);if(0!=st.legend.backgroundOpacity){var u=st.legend.backgroundColor;null==u&&((u=(u=st.grid.backgroundColor)&&"string"==typeof u?wt.color.parse(u):wt.color.extract(p,"background-color")).a=1,u=u.toString());var h=p.children();wt('<div style="position:absolute;width:'+h.width()+"px;height:"+h.height()+"px;"+a+"background-color:"+u+';"> </div>').prependTo(p).css("opacity",st.legend.backgroundOpacity)}}}}}function J(t,e,n){var i,s,r=st.grid.mouseActiveRadius,o=r*r+1,a=null;for(i=it.length-1;0<=i;--i)if(n(it[i])){var l=it[i],c=l.xaxis,p=l.yaxis,u=l.datapoints.points,h=l.datapoints.pointsize,d=c.c2p(t),f=p.c2p(e),m=r/c.scale,g=r/p.scale;if(c.options.inverseTransform&&(m=Number.MAX_VALUE),p.options.inverseTransform&&(g=Number.MAX_VALUE),l.lines.show||l.points.show)for(s=0;s<u.length;s+=h){var v=u[s],y=u[s+1];if(null!=v&&!(m<v-d||v-d<-m||g<y-f||y-f<-g)){var b=Math.abs(c.p2c(v)-t),_=Math.abs(p.p2c(y)-e),w=b*b+_*_;w<o&&(o=w,a=[i,s/h])}}if(l.bars.show&&!a){var k="left"==l.bars.align?0:-l.bars.barWidth/2,T=k+l.bars.barWidth;for(s=0;s<u.length;s+=h){v=u[s],y=u[s+1];var A=u[s+2];null!=v&&((it[i].bars.horizontal?d<=Math.max(A,v)&&d>=Math.min(A,v)&&y+k<=f&&f<=y+T:v+k<=d&&d<=v+T&&f>=Math.min(A,y)&&f<=Math.max(A,y))&&(a=[i,s/h]))}}}return a?(i=a[0],s=a[1],h=it[i].datapoints.pointsize,{datapoint:it[i].datapoints.points.slice(s*h,(s+1)*h),dataIndex:s,series:it[i],seriesIndex:i}):null}function H(t){st.grid.hoverable&&K("plothover",t,function(t){return 0!=t.hoverable})}function W(t){st.grid.hoverable&&K("plothover",t,function(){return!1})}function G(t){K("plotclick",t,function(t){return 0!=t.clickable})}function K(t,e,n){var i=at.offset(),s=e.pageX-i.left-ht.left,r=e.pageY-i.top-ht.top,o=p({left:s,top:r});o.pageX=e.pageX,o.pageY=e.pageY;var a=J(s,r,n);if(a&&(a.pageX=parseInt(a.series.xaxis.p2c(a.datapoint[0])+i.left+ht.left),a.pageY=parseInt(a.series.yaxis.p2c(a.datapoint[1])+i.top+ht.top)),st.grid.autoHighlight){for(var l=0;l<bt.length;++l){var c=bt[l];c.auto!=t||a&&c.series==a.series&&c.point[0]==a.datapoint[0]&&c.point[1]==a.datapoint[1]||Z(c.series,c.point)}a&&X(a.series,a.datapoint,t)}d.trigger(t,[o,a])}function V(){_t||(_t=setTimeout(Y,30))}function Y(){var t,e;for(_t=null,ct.save(),ct.clearRect(0,0,dt,ft),ct.translate(ht.left,ht.top),t=0;t<bt.length;++t)(e=bt[t]).series.bars.show?et(e.series,e.point):tt(e.series,e.point);ct.restore(),k(vt.drawOverlay,[ct])}function X(t,e,n){if("number"==typeof t&&(t=it[t]),"number"==typeof e){var i=t.datapoints.pointsize;e=t.datapoints.points.slice(i*e,i*(e+1))}var s=Q(t,e);-1==s?(bt.push({series:t,point:e,auto:n}),V()):n||(bt[s].auto=!1)}function Z(t,e){null==t&&null==e&&(bt=[],V()),"number"==typeof t&&(t=it[t]),"number"==typeof e&&(e=t.data[e]);var n=Q(t,e);-1!=n&&(bt.splice(n,1),V())}function Q(t,e){for(var n=0;n<bt.length;++n){var i=bt[n];if(i.series==t&&i.point[0]==e[0]&&i.point[1]==e[1])return n}return-1}function tt(t,e){var n=e[0],i=e[1],s=t.xaxis,r=t.yaxis;if(!(n<s.min||n>s.max||i<r.min||i>r.max)){var o=t.points.radius+t.points.lineWidth/2;ct.lineWidth=o,ct.strokeStyle=wt.color.parse(t.color).scale("a",.5).toString();var a=1.5*o;n=s.p2c(n),i=r.p2c(i);ct.beginPath(),"circle"==t.points.symbol?ct.arc(n,i,a,0,2*Math.PI,!1):t.points.symbol(ct,n,i,a,!1),ct.closePath(),ct.stroke()}}function et(t,e){ct.lineWidth=t.bars.lineWidth,ct.strokeStyle=wt.color.parse(t.color).scale("a",.5).toString();var n=wt.color.parse(t.color).scale("a",.5).toString(),i="left"==t.bars.align?0:-t.bars.barWidth/2;z(e[0],e[1],e[2]||0,i,i+t.bars.barWidth,0,function(){return n},t.xaxis,t.yaxis,ct,t.bars.horizontal,t.bars.lineWidth)}function nt(t,e,n,i){if("string"==typeof t)return t;for(var s=lt.createLinearGradient(0,n,0,e),r=0,o=t.colors.length;r<o;++r){var a=t.colors[r];if("string"!=typeof a){var l=wt.color.parse(i);null!=a.brightness&&(l=l.scale("rgb",a.brightness)),null!=a.opacity&&(l.a*=a.opacity),a=l.toString()}s.addColorStop(r/(o-1),a)}return s}var it=[],st={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85},xaxis:{show:null,position:"bottom",mode:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:!1},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1},shadowSize:3},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},hooks:{}},rt=null,ot=null,at=null,lt=null,ct=null,pt=[],ut=[],ht={left:0,right:0,top:0,bottom:0},dt=0,ft=0,mt=0,gt=0,vt={processOptions:[],processRawData:[],processDatapoints:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},yt=this;yt.setData=o,yt.setupGrid=x,yt.draw=D,yt.getPlaceholder=function(){return d},yt.getCanvas=function(){return rt},yt.getPlotOffset=function(){return ht},yt.width=function(){return mt},yt.height=function(){return gt},yt.offset=function(){var t=at.offset();return t.left+=ht.left,t.top+=ht.top,t},yt.getData=function(){return it},yt.getAxes=function(){var n={};return wt.each(pt.concat(ut),function(t,e){e&&(n[e.direction+(1!=e.n?e.n:"")+"axis"]=e)}),n},yt.getXAxes=function(){return pt},yt.getYAxes=function(){return ut},yt.c2p=p,yt.p2c=l,yt.getOptions=function(){return st},yt.highlight=X,yt.unhighlight=Z,yt.triggerRedrawOverlay=V,yt.pointOffset=function(t){return{left:parseInt(pt[f(t,"x")-1].p2c(+t.x)+ht.left),top:parseInt(ut[f(t,"y")-1].p2c(+t.y)+ht.top)}},yt.shutdown=_,yt.resize=function(){g(),v(rt),v(ot)},yt.hooks=vt,s(yt),r(e),y(),o(t),x(),D(),b();var bt=[],_t=null}function kt(t,e){return e*Math.floor(t/e)}wt.plot=function(t,e,n){return new s(wt(t),e,n,wt.plot.plugins)},wt.plot.version="0.7",wt.plot.plugins=[],wt.plot.formatDate=function(t,e,n){var i=function(t){return 1==(t=""+t).length?"0"+t:t},s=[],r=!1,o=!1,a=t.getUTCHours(),l=a<12;null==n&&(n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),-1!=e.search(/%p|%P/)&&(12<a?a-=12:0==a&&(a=12));for(var c=0;c<e.length;++c){var p=e.charAt(c);if(r){switch(p){case"h":p=""+a;break;case"H":p=i(a);break;case"M":p=i(t.getUTCMinutes());break;case"S":p=i(t.getUTCSeconds());break;case"d":p=""+t.getUTCDate();break;case"m":p=""+(t.getUTCMonth()+1);break;case"y":p=""+t.getUTCFullYear();break;case"b":p=""+n[t.getUTCMonth()];break;case"p":p=l?"am":"pm";break;case"P":p=l?"AM":"PM";break;case"0":o=!(p="")}p&&o&&(p=i(p),o=!1),s.push(p),o||(r=!1)}else"%"==p?r=!0:s.push(p)}return s.join("")}}(jQuery),function(g){function t(c){function n(t){d.active&&(l(t),c.getPlaceholder().trigger("plotselecting",[s()]))}function i(t){1==t.which&&(document.body.focus(),document.onselectstart!==undefined&&null==f.onselectstart&&(f.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==undefined&&null==f.ondrag&&(f.ondrag=document.ondrag,document.ondrag=function(){return!1}),a(d.first,t),d.active=!0,m=function(t){e(t)},g(document).one("mouseup",m))}function e(t){return m=null,document.onselectstart!==undefined&&(document.onselectstart=f.onselectstart),document.ondrag!==undefined&&(document.ondrag=f.ondrag),d.active=!1,l(t),h()?r():(c.getPlaceholder().trigger("plotunselected",[]),c.getPlaceholder().trigger("plotselecting",[null])),!1}function s(){if(!h())return null;var s={},r=d.first,o=d.second;return g.each(c.getAxes(),function(t,e){if(e.used){var n=e.c2p(r[e.direction]),i=e.c2p(o[e.direction]);s[t]={from:Math.min(n,i),to:Math.max(n,i)}}}),s}function r(){var t=s();c.getPlaceholder().trigger("plotselected",[t]),t.xaxis&&t.yaxis&&c.getPlaceholder().trigger("selected",[{x1:t.xaxis.from,y1:t.yaxis.from,x2:t.xaxis.to,y2:t.yaxis.to}])}function o(t,e,n){return e<t?t:n<e?n:e}function a(t,e){var n=c.getOptions(),i=c.getPlaceholder().offset(),s=c.getPlotOffset();t.x=o(0,e.pageX-i.left-s.left,c.width()),t.y=o(0,e.pageY-i.top-s.top,c.height()),"y"==n.selection.mode&&(t.x=t==d.first?0:c.width()),"x"==n.selection.mode&&(t.y=t==d.first?0:c.height())}function l(t){null!=t.pageX&&(a(d.second,t),h()?(d.show=!0,c.triggerRedrawOverlay()):p(!0))}function p(t){d.show&&(d.show=!1,c.triggerRedrawOverlay(),t||c.getPlaceholder().trigger("plotunselected",[]))}function u(t,e){var n,i,s,r,o=c.getAxes();for(var a in o)if((n=o[a]).direction==e&&(t[r=e+n.n+"axis"]||1!=n.n||(r=e+"axis"),t[r])){i=t[r].from,s=t[r].to;break}if(t[r]||(n="x"==e?c.getXAxes()[0]:c.getYAxes()[0],i=t[e+"1"],s=t[e+"2"]),null!=i&&null!=s&&s<i){var l=i;i=s,s=l}return{from:i,to:s,axis:n}}function t(t,e){var n,i=c.getOptions();"y"==i.selection.mode?(d.first.x=0,d.second.x=c.width()):(n=u(t,"x"),d.first.x=n.axis.p2c(n.from),d.second.x=n.axis.p2c(n.to)),"x"==i.selection.mode?(d.first.y=0,d.second.y=c.height()):(n=u(t,"y"),d.first.y=n.axis.p2c(n.from),d.second.y=n.axis.p2c(n.to)),d.show=!0,c.triggerRedrawOverlay(),!e&&h()&&r()}function h(){var t=5;return Math.abs(d.second.x-d.first.x)>=t&&Math.abs(d.second.y-d.first.y)>=t}var d={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},f={},m=null;c.clearSelection=p,c.setSelection=t,c.getSelection=s,c.hooks.bindEvents.push(function(t,e){null!=t.getOptions().selection.mode&&(e.mousemove(n),e.mousedown(i))}),c.hooks.drawOverlay.push(function(t,e){if(d.show&&h()){var n=t.getPlotOffset(),i=t.getOptions();e.save(),e.translate(n.left,n.top);var s=g.color.parse(i.selection.color);e.strokeStyle=s.scale("a",.8).toString(),e.lineWidth=1,e.lineJoin="round",e.fillStyle=s.scale("a",.4).toString();var r=Math.min(d.first.x,d.second.x),o=Math.min(d.first.y,d.second.y),a=Math.abs(d.second.x-d.first.x),l=Math.abs(d.second.y-d.first.y);e.fillRect(r,o,a,l),e.strokeRect(r,o,a,l),e.restore()}}),c.hooks.shutdown.push(function(t,e){e.unbind("mousemove",n),e.unbind("mousedown",i),m&&g(document).unbind("mouseup",m)})}g.plot.plugins.push({init:t,options:{selection:{mode:null,color:"#e8cfac"}},name:"selection",version:"1.1"})}(jQuery),function(a){"use strict";function r(i){i&&3===i.which||(a(e).remove(),a(c).each(function(){var t=a(this),e=l(t),n={relatedTarget:this};e.hasClass("open")&&(e.trigger(i=a.Event("hide.bs.dropdown",n)),i.isDefaultPrevented()||(t.attr("aria-expanded","false"),e.removeClass("open").trigger("hidden.bs.dropdown",n)))}))}function l(t){var e=t.attr("data-target");e||(e=(e=t.attr("href"))&&/#[A-Za-z]/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""));var n=e&&a(e);return n&&n.length?n:t.parent()}function t(n){return this.each(function(){var t=a(this),e=t.data("bs.dropdown");e||t.data("bs.dropdown",e=new i(this)),"string"==typeof n&&e[n].call(t)})}var e=".dropdown-backdrop",c='[data-toggle="dropdown"]',i=function(t){a(t).on("click.bs.dropdown",this.toggle)};i.VERSION="3.3.1",i.prototype.toggle=function(t){var e=a(this);if(!e.is(".disabled, :disabled")){var n=l(e),i=n.hasClass("open");if(r(),!i){"ontouchstart"in document.documentElement&&!n.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",r);var s={relatedTarget:this};if(n.trigger(t=a.Event("show.bs.dropdown",s)),t.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),n.toggleClass("open").trigger("shown.bs.dropdown",s)}return!1}},i.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var e=a(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var n=l(e),i=n.hasClass("open");if(!i&&27!=t.which||i&&27==t.which)return 27==t.which&&n.find(c).trigger("focus"),e.trigger("click");var s=" li:not(.divider):visible a",r=n.find('[role="menu"]'+s+', [role="listbox"]'+s);if(r.length){var o=r.index(t.target);38==t.which&&0<o&&o--,40==t.which&&o<r.length-1&&o++,~o||(o=0),r.eq(o).trigger("focus")}}}};var n=a.fn.dropdown;a.fn.dropdown=t,a.fn.dropdown.Constructor=i,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=n,this},a(document).on("click.bs.dropdown.data-api",r).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",c,i.prototype.toggle).on("keydown.bs.dropdown.data-api",c,i.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',i.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',i.prototype.keydown)}(jQuery),function(g){"use strict";function t(s){return this.each(function(){var t=g(this),e=t.data("bs.tooltip"),n="object"==typeof s&&s,i=n&&n.selector;(e||"destroy"!=s)&&(i?(e||t.data("bs.tooltip",e={}),e[i]||(e[i]=new v(this,n))):e||t.data("bs.tooltip",e=new v(this,n)),"string"==typeof s&&e[s]())})}var v=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};v.VERSION="3.3.1",v.TRANSITION_DURATION=150,v.DEFAULTS={animation:!0,placement:"top",selector:!1,backdrop:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,theme:"light",viewport:{selector:"body",padding:0}},v.prototype.init=function(t,e,n){this.enabled=!0,this.type=t,this.$element=g(e),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&g(this.options.viewport.selector||this.options.viewport);for(var i=this.options.trigger.split(" "),s=i.length;s--;){var r=i[s];if("click"==r)this.$element.on("click."+this.type,this.options.selector,g.proxy(this.toggle,this));else if("manual"!=r){var o="hover"==r?"mouseenter":"focusin",a="hover"==r?"mouseleave":"focusout";this.$element.on(o+"."+this.type,this.options.selector,g.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,g.proxy(this.leave,this))}}this.options.selector?this._options=g.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},v.prototype.getDefaults=function(){return v.DEFAULTS},v.prototype.getOptions=function(t){return(t=g.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},v.prototype.getDelegateOptions=function(){var n={},i=this.getDefaults();return this._options&&g.each(this._options,function(t,e){i[t]!=e&&(n[t]=e)}),n},v.prototype.enter=function(t){var e=t instanceof this.constructor?t:g(t.currentTarget).data("bs."+this.type);if(e&&e.$tip&&e.$tip.is(":visible"))e.hoverState="in";else{if(e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),g(t.currentTarget).data("bs."+this.type,e)),clearTimeout(e.timeout),e.hoverState="in",!e.options.delay||!e.options.delay.show)return e.show();e.timeout=setTimeout(function(){"in"==e.hoverState&&e.show()},e.options.delay.show)}},v.prototype.leave=function(t){var e=t instanceof this.constructor?t:g(t.currentTarget).data("bs."+this.type);if(e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),g(t.currentTarget).data("bs."+this.type,e)),clearTimeout(e.timeout),e.hoverState="out",!e.options.delay||!e.options.delay.hide)return e.hide();e.timeout=setTimeout(function(){"out"==e.hoverState&&e.hide()},e.options.delay.hide)},v.prototype.show=function(){var t=g.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var e=g.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!e)return;var n=this,i=this.tip(),s=this.getUID(this.type);this.setContent(),i.attr("id",s).attr("data-theme",this.options.theme),this.$element.attr("aria-describedby",s),this.options.backdrop&&this.$tip.on("click.bs.tooltip.stopPropagation",function(t){t.stopPropagation()}),this.options.animation&&i.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,o=/\s?auto?\s?/i,a=o.test(r);a&&(r=r.replace(o,"")||"top"),i.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);var l=this.getPosition(),c=i[0].offsetWidth,p=i[0].offsetHeight;if(a){var u=r,h=this.options.container?g(this.options.container):this.$element.parent(),d=this.getPosition(h);r="bottom"==r&&l.bottom+p>d.bottom?"top":"top"==r&&l.top-p<d.top?"bottom":"right"==r&&l.right+c>d.width?"left":"left"==r&&l.left-c<d.left?"right":r,i.removeClass(u).addClass(r)}var f=this.getCalculatedOffset(r,l,c,p);this.applyPlacement(f,r);var m=function(){var t=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,n.options.backdrop&&g(document).one("click.bs.tooltip",function(){n.hide()}),"out"==t&&n.leave(n)};g.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",m).emulateTransitionEnd(v.TRANSITION_DURATION):m()}},v.prototype.applyPlacement=function(t,e){var n=this.tip(),i=n[0].offsetWidth,s=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),o=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(o)&&(o=0),t.top=t.top+r,t.left=t.left+o,g.offset.setOffset(n[0],g.extend({using:function(t){n.css({top:Math.round(t.top),left:Math.round(t.left)})}},t),0),n.addClass("in");var a=n[0].offsetWidth,l=n[0].offsetHeight;"top"==e&&l!=s&&(t.top=t.top+s-l);var c=this.getViewportAdjustedDelta(e,t,a,l);c.left?t.left+=c.left:t.top+=c.top;var p=/top|bottom/.test(e),u=p?2*c.left-i+a:2*c.top-s+l,h=p?"offsetWidth":"offsetHeight";n.offset(t),this.replaceArrow(u,n[0][h],p)},v.prototype.replaceArrow=function(t,e,n){this.arrow().css(n?"left":"top",50*(1-t/e)+"%").css(n?"top":"left","")},v.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},v.prototype.hide=function(t){function e(){"in"!=n.hoverState&&i.detach(),n.$element.removeAttr("aria-describedby").trigger("hidden.bs."+n.type),t&&t()}var n=this,i=this.tip(),s=g.Event("hide.bs."+this.type);if(this.$element.trigger(s),!s.isDefaultPrevented())return i.removeClass("in"),g.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",e).emulateTransitionEnd(v.TRANSITION_DURATION):e(),this.hoverState=null,this},v.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},v.prototype.hasContent=function(){return this.getTitle()},v.prototype.getPosition=function(t){var e=(t=t||this.$element)[0],n="BODY"==e.tagName,i=e.getBoundingClientRect();null==i.width&&(i=g.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var s=n?{top:0,left:0}:t.offset(),r={scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},o=n?{width:g(window).width(),height:g(window).height()}:null;return g.extend({},i,r,o,s)},v.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},v.prototype.getViewportAdjustedDelta=function(t,e,n,i){var s={top:0,left:0};if(!this.$viewport)return s;var r=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-r-o.scroll,l=e.top+r-o.scroll+i;a<o.top?s.top=o.top-a:l>o.top+o.height&&(s.top=o.top+o.height-l)}else{var c=e.left-r,p=e.left+r+n;c<o.left?s.left=o.left-c:p>o.width&&(s.left=o.left+o.width-p)}return s},v.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},v.prototype.getUID=function(t){for(;t+=~~(1e6*Math.random()),document.getElementById(t););return t},v.prototype.tip=function(){return this.$tip=this.$tip||g(this.options.template)},v.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},v.prototype.enable=function(){this.enabled=!0},v.prototype.disable=function(){this.enabled=!1},v.prototype.toggleEnabled=function(){this.enabled=!this.enabled},v.prototype.toggle=function(t){var e=this;t&&((e=g(t.currentTarget).data("bs."+this.type))||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),g(t.currentTarget).data("bs."+this.type,e))),e.tip().hasClass("in")?e.leave(e):e.enter(e)},v.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.options.backdrop&&t.$tip.off("click.bs.tooltip.stopPropagation")})};var e=g.fn.tooltip;g.fn.tooltip=t,g.fn.tooltip.Constructor=v,g.fn.tooltip.noConflict=function(){return g.fn.tooltip=e,this}}(jQuery),function(r){"use strict";function t(s){return this.each(function(){var t=r(this),e=t.data("bs.popover"),n="object"==typeof s&&s,i=n&&n.selector;(e||"destroy"!=s)&&(i?(e||t.data("bs.popover",e={}),e[i]||(e[i]=new o(this,n))):e||t.data("bs.popover",e=new o(this,n)),"string"==typeof s&&e[s]())})}var o=function(t,e){this.init("popover",t,e)};if(!r.fn.tooltip)throw new Error("Popover requires tooltip.js");o.VERSION="3.3.1",o.DEFAULTS=r.extend({},r.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h2 class="popover-title"></h2><div class="popover-content"></div></div>'}),o.prototype=r.extend({},r.fn.tooltip.Constructor.prototype),(o.prototype.constructor=o).prototype.getDefaults=function(){return o.DEFAULTS},o.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},o.prototype.hasContent=function(){return this.getTitle()||this.getContent()},o.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},o.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},o.prototype.tip=function(){return this.$tip||(this.$tip=r(this.options.template)),this.$tip};var e=r.fn.popover;r.fn.popover=t,r.fn.popover.Constructor=o,r.fn.popover.noConflict=function(){return r.fn.popover=e,this}}(jQuery);var originalLeave=$.fn.popover.Constructor.prototype.leave;$.fn.popover.Constructor.prototype.leave=function(t){var e,n,i=t instanceof this.constructor?t:$(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);originalLeave.call(this,t),t.currentTarget&&(e=$("body .popover"),n=i.timeout,e.one("mouseenter",function(){clearTimeout(n),e.one("mouseleave",function(){$.fn.popover.Constructor.prototype.leave.call(i,i)})}))},$.fn.popover.Constructor.DEFAULTS.viewport.padding=10,$.fn.popover.Constructor.DEFAULTS.template='<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-body"><h2 class="popover-title"></h2><div class="popover-content"></div></div></div>';var originalShow=$.fn.popover.Constructor.prototype.show;$.fn.popover.Constructor.prototype.show=function(){if(originalShow.call(this),this.$tip){var t=$(this.options.viewport.selector).height()-2*this.options.viewport.padding;this.$tip.find(".popover-body").css("maxHeight",t)}},function(r){"use strict";function o(i,s){return this.each(function(){var t=r(this),e=t.data("bs.modal"),n=r.extend({},a.DEFAULTS,t.data(),"object"==typeof i&&i);e||t.data("bs.modal",e=new a(this,n)),"string"==typeof i?e[i](s):n.show&&e.show(s)})}var a=function(t,e){this.options=e,this.$body=r(e.container||document.body),this.$element=r(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,r.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};a.VERSION="3.3.1",a.TRANSITION_DURATION=300,a.BACKDROP_TRANSITION_DURATION=150,a.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},a.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},a.prototype.show=function(n){var i=this,t=r.Event("show.bs.modal",{relatedTarget:n});this.$element.trigger(t),this.isShown||t.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',r.proxy(this.hide,this)),this.backdrop(function(){var t=r.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),i.options.backdrop&&i.adjustBackdrop(),t&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var e=r.Event("shown.bs.modal",{relatedTarget:n});t?i.$element.find(".modal-dialog").one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(a.TRANSITION_DURATION):i.$element.trigger("focus").trigger(e)}))},a.prototype.hide=function(t){t&&t.preventDefault(),t=r.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),r(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),r.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",r.proxy(this.hideModal,this)).emulateTransitionEnd(a.TRANSITION_DURATION):this.hideModal())},a.prototype.enforceFocus=function(){r(document).off("focusin.bs.modal").on("focusin.bs.modal",r.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},a.prototype.escape=function(){this.isShown&&this.options.keyboard?r(window).on("keydown.dismiss.bs.modal",r.proxy(function(t){27==t.which&&this.hide(),27==t.which&&(t=r.Event("dismiss.bs.modal"),this.$element.trigger(t))},this)):this.isShown||r(window).off("keydown.dismiss.bs.modal")},a.prototype.resize=function(){this.isShown?r(window).on("resize.bs.modal",r.proxy(this.handleUpdate,this)):r(window).off("resize.bs.modal")},a.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},a.prototype.remove=function(){this.$element.remove()},a.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},a.prototype.backdrop=function(t){var e=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=r.support.transition&&n;if(this.$backdrop=r('<div class="modal-backdrop '+n+'" />').prependTo(this.$element).on("click.dismiss.bs.modal",r.proxy(function(t){t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;i?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(a.BACKDROP_TRANSITION_DURATION):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var s=function(){e.removeBackdrop(),t&&t()};r.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",s).emulateTransitionEnd(a.BACKDROP_TRANSITION_DURATION):s()}else t&&t()},a.prototype.handleUpdate=function(){this.adjustDialog(),this.options.backdrop&&this.adjustBackdrop()},a.prototype.adjustBackdrop=function(){this.$backdrop.css("height",0).css("height",this.$element[0].scrollHeight)},a.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight,e={left:this.$body.offset().left,top:this.$body.offset().top,width:this.$body.width(),paddingLeft:!this.bodyIsOverflowing&&t&&0<this.scrollbarWidth?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t&&0<this.scrollbarWidth?this.scrollbarWidth:""};if("rtl"==App.i18n.dir()){e.right="auto";var n=e.paddingLeft;e.paddingLeft=e.paddingRight,e.paddingRight=n}this.$element.css(e)},a.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},a.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight,this.scrollbarWidth=this.measureScrollbar()},a.prototype.setScrollbar=function(){
var t=parseInt(this.$body.css("padding-right")||0,10);this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},a.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},a.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var t=r.fn.modal;r.fn.modal=o,r.fn.modal.Constructor=a,r.fn.modal.noConflict=function(){return r.fn.modal=t,this},r(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var e=r(this),n=e.attr("href"),i=r(e.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("bs.modal")?"toggle":r.extend({remote:!/#/.test(n)&&n},i.data(),e.data());e.is("a")&&t.preventDefault(),i.one("show.bs.modal",function(t){t.isDefaultPrevented()||i.one("hidden.bs.modal",function(){e.is(":visible")&&e.trigger("focus")})}),o.call(i,s,this)})}(jQuery),function(a){"use strict";function e(n){return this.each(function(){var t=a(this),e=t.data("bs.tab");e||t.data("bs.tab",e=new o(this)),"string"==typeof n&&e[n]()})}var o=function(t){this.element=a(t)};o.VERSION="3.3.1",o.TRANSITION_DURATION=150,o.prototype.show=function(){var t=this.element,e=t.closest("ul:not(.dropdown-menu)"),n=t.data("target");if(n||(n=(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var i=e.find(".active:last a"),s=a.Event("hide.bs.tab",{relatedTarget:t[0]}),r=a.Event("show.bs.tab",{relatedTarget:i[0]});if(i.trigger(s),t.trigger(r),!r.isDefaultPrevented()&&!s.isDefaultPrevented()){var o=a(n);this.activate(t.closest("li"),e),this.activate(o,o.parent(),function(){i.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:i[0]})})}}},o.prototype.activate=function(t,e,n){function i(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),r?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),n&&n()}var s=e.find("> .active"),r=n&&a.support.transition&&(s.length&&s.hasClass("fade")||!!e.find("> .fade").length);s.length&&r?s.one("bsTransitionEnd",i).emulateTransitionEnd(o.TRANSITION_DURATION):i(),s.removeClass("in")};var t=a.fn.tab;a.fn.tab=e,a.fn.tab.Constructor=o,a.fn.tab.noConflict=function(){return a.fn.tab=t,this};var n=function(t){t.preventDefault(),e.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',n).on("click.bs.tab.data-api",'[data-toggle="pill"]',n)}(jQuery),function(i){"use strict";function t(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(t.style[n]!==undefined)return{end:e[n]};return!1}i.fn.emulateTransitionEnd=function(t){var e=!1,n=this;return i(this).one("bsTransitionEnd",function(){e=!0}),setTimeout(function(){e||i(n).trigger(i.support.transition.end)},t),this},i(function(){i.support.transition=t(),i.support.transition&&(i.event.special.bsTransitionEnd={bindType:i.support.transition.end,delegateType:i.support.transition.end,handle:function(t){if(i(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(r){"use strict";function n(i){return this.each(function(){var t=r(this),e=t.data("bs.button"),n="object"==typeof i&&i;e||t.data("bs.button",e=new s(this,n)),"toggle"==i?e.toggle():i&&e.setState(i)})}var s=function(t,e){this.$element=r(t),this.options=r.extend({},s.DEFAULTS,e),this.isLoading=!1};s.VERSION="3.3.1",s.DEFAULTS={loadingText:"loading..."},s.prototype.setState=function(t){var e="disabled",n=this.$element,i=n.is("input")?"val":"html",s=n.data();t+="Text",null==s.resetText&&n.data("resetText",n[i]()),setTimeout(r.proxy(function(){n[i](null==s[t]?this.options[t]:s[t]),"loadingText"==t?(this.isLoading=!0,n.addClass(e).attr(e,e)):this.isLoading&&(this.isLoading=!1,n.removeClass(e).removeAttr(e))},this),0)},s.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var n=this.$element.find("input");"radio"==n.prop("type")&&(n.prop("checked")&&this.$element.hasClass("active")?t=!1:e.find(".active").removeClass("active")),t&&n.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));t&&this.$element.toggleClass("active")};var t=r.fn.button;r.fn.button=n,r.fn.button.Constructor=s,r.fn.button.noConflict=function(){return r.fn.button=t,this},r(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var e=r(t.target);e.hasClass("btn")||(e=e.closest(".btn")),n.call(e,"toggle"),t.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){r(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),function(o){"use strict";function s(t){var e,n=t.attr("data-target")||(e=t.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,"");return o(n)}function a(i){return this.each(function(){var t=o(this),e=t.data("bs.collapse"),n=o.extend({},l.DEFAULTS,t.data(),"object"==typeof i&&i);!e&&n.toggle&&"show"==i&&(n.toggle=!1),e||t.data("bs.collapse",e=new l(this,n)),"string"==typeof i&&e[i]()})}var l=function(t,e){this.$element=o(t),this.options=o.extend({},l.DEFAULTS,e),this.$trigger=o(this.options.trigger).filter('[href="#'+t.id+'"], [data-target="#'+t.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};l.VERSION="3.3.1",l.TRANSITION_DURATION=350,l.DEFAULTS={toggle:!0,trigger:'[data-toggle="collapse"]'},l.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},l.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t,e=this.$parent&&this.$parent.find("> .panel").children(".in, .collapsing");if(!(e&&e.length&&(t=e.data("bs.collapse"))&&t.transitioning)){var n=o.Event("show.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){e&&e.length&&(a.call(e,"hide"),t||e.data("bs.collapse",null));var i=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[i](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[i](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!o.support.transition)return s.call(this);var r=o.camelCase(["scroll",i].join("-"));this.$element.one("bsTransitionEnd",o.proxy(s,this)).emulateTransitionEnd(l.TRANSITION_DURATION)[i](this.$element[0][r])}}}},l.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=o.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var e=this.dimension();this.$element[e](this.$element[e]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!o.support.transition)return n.call(this);this.$element[e](0).one("bsTransitionEnd",o.proxy(n,this)).emulateTransitionEnd(l.TRANSITION_DURATION)}}},l.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},l.prototype.getParent=function(){return o(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(o.proxy(function(t,e){var n=o(e);this.addAriaAndCollapsedClass(s(n),n)},this)).end()},l.prototype.addAriaAndCollapsedClass=function(t,e){var n=t.hasClass("in");t.attr("aria-expanded",n),e.toggleClass("collapsed",!n).attr("aria-expanded",n)};var t=o.fn.collapse;o.fn.collapse=a,o.fn.collapse.Constructor=l,o.fn.collapse.noConflict=function(){return o.fn.collapse=t,this},o(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var e=o(this);e.attr("data-target")||t.preventDefault();var n=s(e),i=n.data("bs.collapse")?"toggle":o.extend({},e.data(),{trigger:this});a.call(n,i)})}(jQuery),function(m,g,i,e){"use strict";var r=function(t,e){this.widget="",this.$element=m(t),this.defaultTime=e.defaultTime,this.disableFocus=e.disableFocus,this.disableMousewheel=e.disableMousewheel,this.isOpen=e.isOpen,this.minuteStep=e.minuteStep,this.modalBackdrop=e.modalBackdrop,this.orientation=e.orientation,this.secondStep=e.secondStep,this.snapToStep=e.snapToStep,this.showInputs=e.showInputs,this.showMeridian=e.showMeridian,this.showSeconds=e.showSeconds,this.maxHours=e.maxHours,this.template=e.template,this.appendWidgetTo=e.appendWidgetTo,this.showWidgetOnAddonClick=e.showWidgetOnAddonClick,this._init()};r.prototype={constructor:r,_init:function(){var t=this;this.$element.hasClass("time--12")?this.showMeridian=!0:this.showMeridian&&this.$element.addClass("time--12"),this.showWidgetOnAddonClick&&(this.$element.parent().hasClass("input-append")||this.$element.parent().hasClass("input-prepend"))?(this.$element.parent(".input-append, .input-prepend").find(".add-on").on({"click.timepicker":m.proxy(this.showWidget,this)}),this.$element.on({"focus.timepicker":m.proxy(this.highlightUnit,this),"click.timepicker":m.proxy(this.highlightUnit,this),"keydown.timepicker":m.proxy(this.elementKeydown,this),"keyup.timepicker":m.proxy(this.elementKeyup,this),"blur.timepicker":m.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":m.proxy(this.mousewheel,this)})):this.template?this.$element.on({"focus.timepicker":m.proxy(this.showWidget,this),"click.timepicker":m.proxy(this.showWidget,this),"blur.timepicker":m.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":m.proxy(this.mousewheel,this)}):this.$element.on({"focus.timepicker":m.proxy(this.highlightUnit,this),"click.timepicker":m.proxy(this.highlightUnit,this),"keydown.timepicker":m.proxy(this.elementKeydown,this),"keyup.timepicker":m.proxy(this.elementKeyup,this),"blur.timepicker":m.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":m.proxy(this.mousewheel,this)}),!1!==this.template?this.$widget=m(this.getTemplate()).on("click",m.proxy(this.widgetClick,this)):this.$widget=!1,this.showInputs&&!1!==this.$widget&&this.$widget.find("input").each(function(){m(this).on({"click.timepicker":function(){m(this).select()},"keydown.timepicker":m.proxy(t.widgetKeydown,t),"keyup.timepicker":m.proxy(t.widgetKeyup,t)})}),23<this.maxHours&&(this.showMeridian=!1),this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=null,this.updateFromElementVal()},clear:function(){this.hour="",this.minute="",this.second="",this.meridian="",this.$element.val("")},decrementHour:function(){if(this.showMeridian)if(1===this.hour)this.hour=12;else{if(12===this.hour)return this.hour--,this.toggleMeridian();if(0===this.hour)return this.hour=11,this.toggleMeridian();this.hour--}else this.hour<=0?this.hour=this.maxHours:this.hour--},decrementMinute:function(t){var e;(e=t?this.minute-t:this.minute-this.minuteStep)<0?(this.decrementHour(),this.minute=e+60):this.minute=e},decrementSecond:function(){var t=this.second-this.secondStep;t<0?(this.decrementMinute(!0),this.second=t+60):this.second=t},elementKeydown:function(t){switch(t.keyCode){case 9:case 27:this.updateFromElementVal();break;case 37:t.preventDefault(),this.highlightPrevUnit();break;case 38:switch(t.preventDefault(),this.highlightedUnit){case"hour":this.incrementHour(),this.highlightHour();break;case"minute":this.incrementMinute(),this.highlightMinute();break;case"second":this.incrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}this.update();break;case 39:t.preventDefault(),this.highlightNextUnit();break;case 40:switch(t.preventDefault(),this.highlightedUnit){case"hour":this.decrementHour(),this.highlightHour();break;case"minute":this.decrementMinute(),this.highlightMinute();break;case"second":this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}this.update();break;case 8:this.highlightedUnit=null;break;case 186:this.$element.val().length<=2&&(this.setTime(this.$element.val(),e,!0),this.$element.val(this.getTime()),this.highlightMinute(),t.preventDefault()),"hour"==this.highlightedUnit&&(setTimeout(m.proxy(this.highlightNextUnit,this),0),t.preventDefault());break;default:switch(this.getCursorPosition()){case 1:setTimeout(m.proxy(this.highlightMinute,this),0)}}},elementKeyup:function(t){-1==[8,9,27,37,38,39,40].indexOf(t.keyCode)&&this.updateFromElementVal(!0)},getCursorPosition:function(){var t=this.$element.get(0);if("selectionStart"in t)return t.selectionStart;if(i.selection){t.focus();var e=i.selection.createRange(),n=i.selection.createRange().text.length;return e.moveStart("character",-t.value.length),e.text.length-n}},getTemplate:function(){var t,e,n,i,s,r;switch(this.showInputs?(e='<input type="text" class="timepicker-hour" maxlength="2"/>',n='<input type="text" class="timepicker-minute" maxlength="2"/>',i='<input type="text" class="timepicker-second" maxlength="2"/>',s='<input type="text" class="timepicker-meridian" maxlength="2"/>'):(e='<span class="timepicker-hour"></span>',n='<span class="timepicker-minute"></span>',i='<span class="timepicker-second"></span>',s='<span class="timepicker-meridian"></span>'),r='<table><tr><td><a href="#" data-action="incrementHour"><svg class="icon icon-arrow-up"><use xlink:href="#icon-arrow-up" /></svg>"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><svg class="icon icon-arrow-up"><use xlink:href="#icon-arrow-up" /></svg>"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><svg class="icon icon-arrow-up"><use xlink:href="#icon-arrow-up" /></svg>"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><svg class="icon icon-arrow-up"><use xlink:href="#icon-arrow-up" /></svg>"></i></a></td>':"")+"</tr><tr><td>"+e+'</td> <td class="separator">:</td><td>'+n+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+i+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+s+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><svg class="icon icon-arrow-down"><use xlink:href="#icon-arrow-down" /></svg>"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><svg class="icon icon-arrow-down"><use xlink:href="#icon-arrow-down" /></svg>"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><svg class="icon icon-arrow-down"><use xlink:href="#icon-arrow-down" /></svg>"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><svg class="icon icon-arrow-down"><use xlink:href="#icon-arrow-down" /></svg>"></i></a></td>':"")+"</tr></table>",this.template){case"modal":t='<div class="timepicker-widget modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">\xd7</a><h3>Pick a Time</h3></div><div class="modal-content">'+r+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case"dropdown":t='<div class="timepicker-widget dropdown-menu">'+r+"</div>"}return t},getTime:function(){return""===this.hour?"":(1===this.hour.toString().length?"0"+this.hour:this.hour)+":"+(1===this.minute.toString().length?"0"+this.minute:this.minute)+(this.showSeconds?":"+(1===this.second.toString().length?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},hideWidget:function(){!1!==this.isOpen&&(this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),"modal"===this.template&&this.$widget.modal?this.$widget.modal("hide"):this.$widget.removeClass("open"),m(i).off("mousedown.timepicker, touchend.timepicker"),this.isOpen=!1,this.$widget.detach())},highlightUnit:function(){this.position=this.getCursorPosition(),0<=this.position&&this.position<=2?this.highlightHour():3<=this.position&&this.position<=5?this.highlightMinute():6<=this.position&&this.position<=8?this.showSeconds?this.highlightSecond():this.highlightMeridian():9<=this.position&&this.position<=11&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":this.showSeconds?this.highlightSecond():this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"second":this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.showMeridian?this.highlightMeridian():this.showSeconds?this.highlightSecond():this.highlightMinute();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},setSelectionRange:function(t,e){var n=this.$element.get(0);n.setSelectionRange&&setTimeout(function(){n.setSelectionRange(t,e)},0)},highlightHour:function(){var t=this.$element.val().replace(/[^0-9\:]/g,"").split(":"),e=(t[0]?t[0].toString():t.toString()).toString().length;this.highlightedUnit="hour",this.setSelectionRange(0,e)},highlightMinute:function(){var t=this.$element.val().replace(/[^0-9\:]/g,"").split(":"),e=(t[0]?t[0].toString():t.toString()).toString().length;this.highlightedUnit="minute",this.setSelectionRange(e+1,e+3)},highlightSecond:function(){this.highlightedUnit="second",this.setSelectionRange(6,8)},highlightMeridian:function(){this.highlightedUnit="meridian",this.showSeconds?this.setSelectionRange(9,11):this.setSelectionRange(6,8)},incrementHour:function(){if(this.showMeridian){if(11===this.hour)return this.hour++,this.toggleMeridian();12===this.hour&&(this.hour=0)}this.hour!==this.maxHours?this.hour++:this.hour=0},incrementMinute:function(t){var e;59<(e=t?this.minute+t:this.minute+this.minuteStep-this.minute%this.minuteStep)?(this.incrementHour(),this.minute=e-60):this.minute=e},incrementSecond:function(){var t=this.second+this.secondStep-this.second%this.secondStep;59<t?(this.incrementMinute(!0),this.second=t-60):this.second=t},mousewheel:function(t){if(!this.disableMousewheel){t.preventDefault(),t.stopPropagation();var e=t.originalEvent.wheelDelta||-t.originalEvent.detail,n=null;switch("mousewheel"===t.type?n=-1*t.originalEvent.wheelDelta:"DOMMouseScroll"===t.type&&(n=40*t.originalEvent.detail),n&&(t.preventDefault(),m(this).scrollTop(n+m(this).scrollTop())),this.highlightedUnit){case"minute":0<e?this.incrementMinute():this.decrementMinute(),this.highlightMinute();break;case"second":0<e?this.incrementSecond():this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian();break;default:0<e?this.incrementHour():this.decrementHour(),this.highlightHour()}return!1}},changeToNearestStep:function(t,e){return t%e==0?t:Math.round(t%e/e)?(t+(e-t%e))%60:t-t%e},place:function(){if(!this.isInline){var t=this.$widget.outerWidth(),e=this.$widget.outerHeight(),n=10,i=m(g).width(),s=m(g).height(),r=m(g).scrollTop(),o=parseInt(this.$element.parents().filter(function(){}).first().css("z-index"),10)+10,a=this.component?this.component.parent().offset():this.$element.offset(),l=this.component?this.component.outerHeight(!0):this.$element.outerHeight(!1),c=this.component?this.component.outerWidth(!0):this.$element.outerWidth(!1),p=a.left,u=a.top;this.$widget.removeClass("timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left"),"auto"!==this.orientation.x?(this.picker.addClass("datepicker-orient-"+this.orientation.x),"right"===this.orientation.x&&(p-=t-c)):(this.$widget.addClass("timepicker-orient-left"),a.left<0?p-=a.left-n:a.left+t>i&&(p=i-t-n));var h,d,f=this.orientation.y;"auto"===f&&(h=-r+a.top-e,d=r+s-(a.top+l+e),f=Math.max(h,d)===d?"top":"bottom"),this.$widget.addClass("timepicker-orient-"+f),"top"===f?u+=l:u-=e+parseInt(this.$widget.css("padding-top"),10),this.$widget.css({top:u,left:p,zIndex:o})}},remove:function(){m("document").off(".timepicker"),this.$widget&&this.$widget.remove(),delete this.$element.data().timepicker},setDefaultTime:function(t){if(this.$element.val())this.updateFromElementVal();else if("current"===t){var e=new Date,n=e.getHours(),i=e.getMinutes(),s=e.getSeconds(),r="AM";0!==s&&60===(s=Math.ceil(e.getSeconds()/this.secondStep)*this.secondStep)&&(i+=1,s=0),0!==i&&60===(i=Math.ceil(e.getMinutes()/this.minuteStep)*this.minuteStep)&&(n+=1,i=0),this.showMeridian&&(0===n?n=12:12<=n?(12<n&&(n-=12),r="PM"):r="AM"),this.hour=n,this.minute=i,this.second=s,this.meridian=r,this.update()}else!1===t?(this.hour=0,this.minute=0,this.second=0,this.meridian="AM"):this.setTime(t)},setTime:function(t,e,n){if(t){var i,s,r,o,a,l;if("object"==typeof t&&t.getMonth)r=t.getHours(),o=t.getMinutes(),a=t.getSeconds(),this.showMeridian&&(l="AM",12<r&&(l="PM",r%=12),12===r&&(l="PM"));else{if(2<(i=(/a/i.test(t)?1:0)+(/p/i.test(t)?2:0)))return void this.clear();r=(s=t.replace(/[^0-9\:]/g,"").split(":"))[0]?s[0].toString():s.toString();var c=this.maxHours.toString().length;if(this.explicitMode&&r.length>c&&r.length%2!=0)return void this.clear();o=s[1]?s[1].toString():"",a=s[2]?s[2].toString():"",4<r.length&&(a=r.slice(-2),r=r.slice(0,-2)),r.length>c&&(o=r.slice(-c),r=r.slice(0,-c)),2<o.length&&(a=o.slice(-2),o=o.slice(0,-2)),r=parseInt(r,10),o=parseInt(o,10),a=parseInt(a,10),isNaN(r)&&(r=0),isNaN(o)&&(o=0),isNaN(a)&&(a=0),59<a&&(a=59),59<o&&(o=59),r>this.maxHours&&(r=this.maxHours),this.showMeridian?(12<r&&(i=2,r-=12),i||(i=1),0===r&&(r=12),l=1===i?"AM":"PM"):r<12&&2===i?r+=12:r>this.maxHours?r=this.maxHours-1:(r<0||12===r&&1===i)&&(r=0)}this.hour=r,this.snapToStep?(this.minute=this.changeToNearestStep(o,this.minuteStep),this.second=this.changeToNearestStep(a,this.secondStep)):(this.minute=o,this.second=a),this.meridian=l,n||this.update(e)}else this.clear()},showWidget:function(){if(!this.isOpen&&!this.$element.is(":disabled")){this.$widget.appendTo(this.appendWidgetTo);var e=this;m(i).on("mousedown.timepicker, touchend.timepicker",function(t){e.$element.parent().find(t.target).length||e.$widget.is(t.target)||e.$widget.find(t.target).length||e.hideWidget()}),this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),this.place(),this.disableFocus&&this.$element.blur(),""===this.hour&&(this.defaultTime?this.setDefaultTime(this.defaultTime):this.setTime("0:0:0")),"modal"===this.template&&this.$widget.modal?this.$widget.modal("show").on("hidden",m.proxy(this.hideWidget,this)):!1===this.isOpen&&this.$widget.addClass("open"),this.isOpen=!0}},toggleMeridian:function(){this.meridian="AM"===this.meridian?"PM":"AM"},update:function(t){this.updateElement(),t||this.updateWidget();var e=this.hour;this.showMeridian&&("PM"==this.meridian&&e<12&&(e+=12),"AM"==this.meridian&&12==e&&(e=0)),this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hoursAndMinutes:this.pad(e)+":"+this.pad(this.minute),hours:e,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},pad:function(t){return 1===t.toString().length?"0"+t:t},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(t){this.setTime(this.$element.val(),e,t)},updateWidget:function(){if(!1!==this.$widget){var t=this.hour,e=1===this.minute.toString().length?"0"+this.minute:this.minute,n=1===this.second.toString().length?"0"+this.second:this.second;this.showInputs?(this.$widget.find("input.timepicker-hour").val(t),this.$widget.find("input.timepicker-minute").val(e),this.showSeconds&&this.$widget.find("input.timepicker-second").val(n),this.showMeridian&&this.$widget.find("input.timepicker-meridian").val(this.meridian)):(this.$widget.find("span.timepicker-hour").text(t),this.$widget.find("span.timepicker-minute").text(e),this.showSeconds&&this.$widget.find("span.timepicker-second").text(n),this.showMeridian&&this.$widget.find("span.timepicker-meridian").text(this.meridian))}},updateFromWidgetInputs:function(){if(!1!==this.$widget){var t=this.$widget.find("input.timepicker-hour").val()+":"+this.$widget.find("input.timepicker-minute").val()+(this.showSeconds?":"+this.$widget.find("input.timepicker-second").val():"")+(this.showMeridian?this.$widget.find("input.timepicker-meridian").val():"");this.setTime(t,!0)}},widgetClick:function(t){t.stopPropagation(),t.preventDefault();var e=m(t.target),n=e.closest("a").data("action");n&&this[n](),this.update(),e.is("input")&&e.get(0).setSelectionRange(0,2)},widgetKeydown:function(t){var e=m(t.target),n=e.attr("class").replace("timepicker-","");switch(t.keyCode){case 9:if(this.showMeridian&&"meridian"===n||this.showSeconds&&"second"===n||!this.showMeridian&&!this.showSeconds&&"minute"===n)return this.hideWidget();break;case 27:this.hideWidget();break;case 38:switch(t.preventDefault(),n){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian()}this.setTime(this.getTime()),e.get(0).setSelectionRange(0,2);break;case 40:switch(t.preventDefault(),n){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian()}this.setTime(this.getTime()),e.get(0).setSelectionRange(0,2)}},widgetKeyup:function(t){(65===t.keyCode||77===t.keyCode||80===t.keyCode||46===t.keyCode||8===t.keyCode||46<=t.keyCode&&t.keyCode<=57||96<=t.keyCode&&t.keyCode<=105)&&this.updateFromWidgetInputs()}},m.fn.timepicker=function(i){var s=Array.apply(null,arguments);return s.shift(),this.each(function(){var t=m(this),e=t.data("timepicker"),n="object"==typeof i&&i;e||t.data("timepicker",e=new r(this,m.extend({},m.fn.timepicker.defaults,n,m(this).data()))),"string"==typeof i&&e[i].apply(e,s)})},m.fn.timepicker.defaults={defaultTime:!1,disableFocus:!1,disableMousewheel:!0,isOpen:!1,minuteStep:15,modalBackdrop:!1,orientation:{x:"auto",y:"auto"},secondStep:15,showSeconds:!1,showInputs:!1,showMeridian:!1,template:!1,appendWidgetTo:"body",showWidgetOnAddonClick:!0,maxHours:23,snapToStep:!1},m.fn.timepicker.Constructor=r}(jQuery,window,document),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}(function(j,P){function I(){return new Date(Date.UTC.apply(Date,arguments))}function p(){var t=new Date;return I(t.getFullYear(),t.getMonth(),t.getDate())}function r(t,e){return t.getUTCFullYear()===e.getUTCFullYear()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCDate()===e.getUTCDate()}function t(t){return function(){return this[t].apply(this,arguments)}}function c(t){return t&&!isNaN(t.getTime())}function u(t,e){function n(t,e){return e.toLowerCase()}var i=j(t).data(),s={},r=new RegExp("^"+e.toLowerCase()+"([A-Z])");for(var o in e=new RegExp("^"+e.toLowerCase()),i)e.test(o)&&(s[o.replace(r,n)]=i[o]);return s}function h(t){var n={};if(E[t]||(t=t.split("-")[0],E[t])){var i=E[t];return j.each(o,function(t,e){e in i&&(n[e]=i[e])}),n}}var e,n=(e={get:function(t){return this.slice(t)[0]},contains:function(t){for(var e=t&&t.valueOf(),n=0,i=this.length;n<i;n++)if(this[n].valueOf()===e)return n;return-1},remove:function(t){this.splice(t,1)},replace:function(t){t&&(j.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t))},clear:function(){this.length=0},copy:function(){var t=new n;return t.replace(this),t}},function(){var t=[];return t.push.apply(t,arguments),j.extend(t,e),t}),y=function(t,e){this._process_options(e),this.dates=new n,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=j(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=!!this.element.hasClass("date")&&this.element.find(".add-on, .input-group-addon, .btn"),this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=j(this.o.template||D.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot .today, tfoot .clear").attr("colspan",function(t,e){return parseInt(e)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.setDaysOfWeekHighlighted(this.o.daysOfWeekHighlighted),this.setDatesDisabled(this.o.datesDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};y.prototype={constructor:y,_process_options:function(t){this._o=j.extend({},this._o,t);var e=this.o=j.extend({},this._o),n=e.language;switch(E[n]||(n=n.split("-")[0],E[n]||(n=f.language)),e.language=n,e.startView){case 2:case"decade":e.startView=2;break;case 1:case"year":e.startView=1;break;default:e.startView=0}switch(e.minViewMode){case 1:case"months":e.minViewMode=1;break;case 2:case"years":e.minViewMode=2;break;default:e.minViewMode=0}switch(e.maxViewMode){case 0:case"days":e.maxViewMode=0;break;case 1:case"months":e.maxViewMode=1;break;default:e.maxViewMode=2}e.startView=Math.min(e.startView,e.maxViewMode),e.startView=Math.max(e.startView,e.minViewMode),!0!==e.multidate&&(e.multidate=Number(e.multidate)||!1,!1!==e.multidate&&(e.multidate=Math.max(0,e.multidate))),e.multidateSeparator=String(e.multidateSeparator),e.weekStart%=7,e.weekEnd=(e.weekStart+6)%7;var i=D.parseFormat(e.format);if(e.startDate!==-Infinity&&(e.startDate?e.startDate instanceof Date?e.startDate=this._local_to_utc(this._zero_time(e.startDate)):e.startDate=D.parseDate(e.startDate,i,e.language):e.startDate=-Infinity),e.endDate!==Infinity&&(e.endDate?e.endDate instanceof Date?e.endDate=this._local_to_utc(this._zero_time(e.endDate)):e.endDate=D.parseDate(e.endDate,i,e.language):e.endDate=Infinity),e.daysOfWeekDisabled=e.daysOfWeekDisabled||[],j.isArray(e.daysOfWeekDisabled)||(e.daysOfWeekDisabled=e.daysOfWeekDisabled.split(/[,\s]*/)),e.daysOfWeekDisabled=j.map(e.daysOfWeekDisabled,function(t){return parseInt(t,10)}),e.daysOfWeekHighlighted=e.daysOfWeekHighlighted||[],j.isArray(e.daysOfWeekHighlighted)||(e.daysOfWeekHighlighted=e.daysOfWeekHighlighted.split(/[,\s]*/)),e.daysOfWeekHighlighted=j.map(e.daysOfWeekHighlighted,function(t){return parseInt(t,10)}),e.datesDisabled=e.datesDisabled||[],!j.isArray(e.datesDisabled)){var s=[];s.push(D.parseDate(e.datesDisabled,i,e.language)),e.datesDisabled=s}e.datesDisabled=j.map(e.datesDisabled,function(t){return D.parseDate(t,i,e.language)});var r=String(e.orientation).toLowerCase().split(/\s+/g),o=e.orientation.toLowerCase();if(r=j.grep(r,function(t){return/^auto|left|right|top|bottom$/.test(t)}),e.orientation={x:"auto",y:"auto"},o&&"auto"!==o)if(1===r.length)switch(r[0]){case"top":case"bottom":e.orientation.y=r[0];break;case"left":case"right":e.orientation.x=r[0]}else o=j.grep(r,function(t){return/^left|right$/.test(t)}),e.orientation.x=o[0]||"auto",o=j.grep(r,function(t){return/^top|bottom$/.test(t)}),e.orientation.y=o[0]||"auto";else;if(e.defaultViewDate){var a=e.defaultViewDate.year||(new Date).getFullYear(),l=e.defaultViewDate.month||0,c=e.defaultViewDate.day||1;e.defaultViewDate=I(a,l,c)}else e.defaultViewDate=p();e.showOnFocus=e.showOnFocus===P||e.showOnFocus,e.zIndexOffset=e.zIndexOffset!==P?e.zIndexOffset:10},_events:[],_secondaryEvents:[],_applyEvents:function(t){for(var e,n,i,s=0;s<t.length;s++)e=t[s][0],2===t[s].length?(n=P,i=t[s][1]):3===t[s].length&&(n=t[s][1],i=t[s][2]),e.on(i,n)},_unapplyEvents:function(t){for(var e,n,i,s=0;s<t.length;s++)e=t[s][0],2===t[s].length?(i=P,n=t[s][1]):3===t[s].length&&(i=t[s][1],n=t[s][2]),e.off(n,i)},_buildEvents:function(){var t={
keyup:j.proxy(function(t){-1===j.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:j.proxy(this.keydown,this),paste:j.proxy(this.paste,this)};!0===this.o.showOnFocus&&(t.focus=j.proxy(this.show,this)),this.isInput?this._events=[[this.element,t]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),t],[this.component,{click:j.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:j.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:j.proxy(function(t){this._focused_from=t.target},this)}],[this.element,{blur:j.proxy(function(t){this._focused_from=t.target},this)}]),this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":j.proxy(function(t){this.update(t.date)},this)}]),this._secondaryEvents=[[this.picker,{click:j.proxy(this.click,this)}],[j(window),{resize:j.proxy(this.place,this)}],[j(document),{mousedown:j.proxy(function(t){this.element.is(t.target)||this.element.find(t.target).length||this.picker.is(t.target)||this.picker.find(t.target).length||this.picker.hasClass("datepicker-inline")||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,e){var n=e||this.dates.get(-1),i=this._utc_to_local(n);this.element.trigger({type:t,date:i,dates:j.map(this.dates,this._utc_to_local),format:j.proxy(function(t,e){0===arguments.length?(t=this.dates.length-1,e=this.o.format):"string"==typeof t&&(e=t,t=this.dates.length-1),e=e||this.o.format;var n=this.dates.get(t);return D.formatDate(n,e,this.o.language)},this)})},show:function(){if(!this.element.attr("readonly")||!1!==this.o.enableOnReadonly)return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&j(this.element).blur(),this},hide:function(){return this.isInline||this.picker.is(":visible")&&(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide.bs.datepicker")),this},remove:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function(t){var e;if(t.originalEvent.clipboardData&&t.originalEvent.clipboardData.types&&-1!==j.inArray("text/plain",t.originalEvent.clipboardData.types))e=t.originalEvent.clipboardData.getData("text/plain");else{if(!window.clipboardData)return;e=window.clipboardData.getData("Text")}this.setDate(e),this.update(),t.preventDefault()},_utc_to_local:function(t){return t&&new Date(t.getTime()+6e4*t.getTimezoneOffset())},_local_to_utc:function(t){return t&&new Date(t.getTime()-6e4*t.getTimezoneOffset())},_zero_time:function(t){return t&&new Date(t.getFullYear(),t.getMonth(),t.getDate())},_zero_utc_time:function(t){return t&&new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()))},getDates:function(){return j.map(this.dates,this._utc_to_local)},getUTCDates:function(){return j.map(this.dates,function(t){return new Date(t)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var t=this.dates.get(-1);return void 0!==t?new Date(t):null},clearDates:function(){var t;this.isInput?t=this.element:this.component&&(t=this.element.find("input")),t&&t.val(""),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function(t){var e=j.isArray(t)?t:arguments;return this.update.apply(this,e),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(t){var e=j.isArray(t)?t:arguments;return this.update.apply(this,j.map(e,this._utc_to_local)),this._trigger("changeDate"),this.setValue(),this},setDate:t("setDates"),setUTCDate:t("setUTCDates"),setValue:function(){var t=this.getFormattedDate();return this.isInput?this.element.val(t):this.component&&this.element.find("input").val(t),this},getFormattedDate:function(e){e===P&&(e=this.o.format);var n=this.o.language;return j.map(this.dates,function(t){return D.formatDate(t,e,n)}).join(this.o.multidateSeparator)},setStartDate:function(t){return this._process_options({startDate:t}),this.update(),this.updateNavArrows(),this},setEndDate:function(t){return this._process_options({endDate:t}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(t){return this._process_options({daysOfWeekDisabled:t}),this.update(),this.updateNavArrows(),this},setDaysOfWeekHighlighted:function(t){return this._process_options({daysOfWeekHighlighted:t}),this.update(),this},setDatesDisabled:function(t){this._process_options({datesDisabled:t}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return this;var t=this.picker.outerWidth(),e=this.picker.outerHeight(),n=10,i=j(this.o.container),s=j(window).width(),r=i.scrollParent().scrollTop(),o=i.offset().top+i.height(),a=i.scrollParent().prop("scrollHeight"),l=i.offset(),c=[];this.element.parents().each(function(){var t=j(this).css("z-index");"auto"!==t&&0!==t&&c.push(parseInt(t))});var p=Math.max.apply(Math,c)+this.o.zIndexOffset,u=this.component?this.component.parent().offset():this.element.offset(),h=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),d=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),f=u.left-l.left,m=u.top-l.top,g=i.width()-d-f;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(f-=t-d),this.o.rtl&&(g-=t-d)):u.left<0?(this.picker.addClass("datepicker-orient-left"),f-=u.left-n):s<f+t?(this.picker.addClass("datepicker-orient-right"),f=u.left+d-t,g=0):this.picker.addClass("datepicker-orient-left");var v=this.o.orientation.y;if("auto"===v&&(v=e<a-o-r?"bottom":"top"),this.picker.addClass("datepicker-orient-"+v),"top"===v?m-=e+parseInt(this.picker.css("padding-top")):m+=h,this.o.rtl?this.picker.css({top:m,right:g,zIndex:p}):this.picker.css({top:m,left:f,zIndex:p}),!this.o.disableScroll){var y=this.picker.scrollParent(),b=(o=u.top+h+this.picker.outerHeight(),y.scrollTop()+y.height());b<o&&y.scrollTop(y.scrollTop()+(o-b)+10)}return this},_allow_update:!0,rerender:function(){return this.fill(),this.element.change(),this},update:function(){if(!this._allow_update)return this;var t=this.dates.copy(),n=[],e=!1;return arguments.length?(j.each(arguments,j.proxy(function(t,e){e instanceof Date&&(e=this._local_to_utc(e)),n.push(e)},this)),e=!0):(n=(n=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val())&&this.o.multidate?n.split(this.o.multidateSeparator):[n],delete this.element.data().date),n=j.map(n,j.proxy(function(t){return D.parseDate(t,this.o.format,this.o.language)},this)),n=j.grep(n,j.proxy(function(t){return t<this.o.startDate||t>this.o.endDate||!t},this),!0),this.dates.replace(n),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=this.o.defaultViewDate,e?this.setValue():n.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill(),this.element.change(),this},fillDow:function(){var t=this.o.weekStart,e="<tr>";for(this.o.calendarWeeks&&(this.picker.find(".datepicker-days .datepicker-switch").attr("colspan",function(t,e){return parseInt(e)+1}),e+='<th class="cw">&#160;</th>');t<this.o.weekStart+7;)e+='<th class="dow">'+E[this.o.language].daysMin[t++%7]+"</th>";e+="</tr>",this.picker.find(".datepicker-days thead").append(e)},fillMonths:function(){for(var t="",e=0;e<12;)t+='<span class="month">'+E[this.o.language].monthsShort[e++]+"</span>";this.picker.find(".datepicker-months td").html(t)},setRange:function(t){t&&t.length?this.range=j.map(t,function(t){return t.valueOf()}):delete this.range,this.fill()},getClassNames:function(e){var t=[],n=this.viewDate.getUTCFullYear(),i=this.viewDate.getUTCMonth(),s=new Date;return e.getUTCFullYear()<n||e.getUTCFullYear()===n&&e.getUTCMonth()<i?t.push("old"):(e.getUTCFullYear()>n||e.getUTCFullYear()===n&&e.getUTCMonth()>i)&&t.push("new"),this.focusDate&&e.valueOf()===this.focusDate.valueOf()&&t.push("focused"),this.o.todayHighlight&&e.getUTCFullYear()===s.getFullYear()&&e.getUTCMonth()===s.getMonth()&&e.getUTCDate()===s.getDate()&&t.push("today"),-1!==this.dates.contains(e)&&t.push("active"),(e.valueOf()<this.o.startDate||e.valueOf()>this.o.endDate||-1!==j.inArray(e.getUTCDay(),this.o.daysOfWeekDisabled))&&t.push("disabled"),-1!==j.inArray(e.getUTCDay(),this.o.daysOfWeekHighlighted)&&t.push("highlighted"),0<this.o.datesDisabled.length&&0<j.grep(this.o.datesDisabled,function(t){return r(e,t)}).length&&t.push("disabled","disabled-date"),this.range&&(e>this.range[0]&&e<this.range[this.range.length-1]&&t.push("range"),-1!==j.inArray(e.valueOf(),this.range)&&t.push("selected"),e.valueOf()===this.range[0]&&t.push("range-start"),e.valueOf()===this.range[this.range.length-1]&&t.push("range-end")),t},fill:function(){var t,e=new Date(this.viewDate),i=e.getUTCFullYear(),n=e.getUTCMonth(),s=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,r=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,o=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,a=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,l=E[this.o.language].today||E.en.today||"",c=E[this.o.language].clear||E.en.clear||"",p=E[this.o.language].titleFormat||E.en.titleFormat;if(!isNaN(i)&&!isNaN(n)){this.picker.find(".datepicker-days thead .datepicker-switch").text(D.formatDate(new I(i,n),p,this.o.language)),this.picker.find("tfoot .today").text(l).toggleClass("hidden",0==this.o.todayBtn),this.picker.find("tfoot .clear").text(c).toggle(!1!==this.o.clearBtn),this.picker.find("thead .datepicker-title").text(this.o.title).toggle(""!==this.o.title),this.updateNavArrows(),this.fillMonths();var u=I(i,n-1,28),h=D.getDaysInMonth(u.getUTCFullYear(),u.getUTCMonth());u.setUTCDate(h),u.setUTCDate(h-(u.getUTCDay()-this.o.weekStart+7)%7);var d=new Date(u);u.getUTCFullYear()<100&&d.setUTCFullYear(u.getUTCFullYear()),d.setUTCDate(d.getUTCDate()+42),d=d.valueOf();for(var f,m=[];u.valueOf()<d;){if(u.getUTCDay()===this.o.weekStart&&(m.push("<tr>"),this.o.calendarWeeks)){var g=new Date(+u+(this.o.weekStart-u.getUTCDay()-7)%7*864e5),v=new Date(Number(g)+(11-g.getUTCDay())%7*864e5),y=new Date(Number(y=I(v.getUTCFullYear(),0,1))+(11-y.getUTCDay())%7*864e5),b=(v-y)/864e5/7+1;m.push('<td class="cw">'+b+"</td>")}if((f=this.getClassNames(u)).push("day"),this.o.beforeShowDay!==j.noop){var _=this.o.beforeShowDay(this._utc_to_local(u));_===P?_={}:"boolean"==typeof _?_={enabled:_}:"string"==typeof _&&(_={classes:_}),!1===_.enabled&&f.push("disabled"),_.classes&&(f=f.concat(_.classes.split(/\s+/))),_.tooltip&&(t=_.tooltip)}f=j.unique(f),m.push('<td class="'+f.join(" ")+'"'+(t?' title="'+t+'"':"")+">"+u.getUTCDate()+"</td>"),t=null,u.getUTCDay()===this.o.weekEnd&&m.push("</tr>"),u.setUTCDate(u.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(m.join(""));var w=this.picker.find(".datepicker-months").find(".datepicker-switch").text(this.o.maxViewMode<2?"Months":i).end().find("span").removeClass("active");if(j.each(this.dates,function(t,e){e.getUTCFullYear()===i&&w.eq(e.getUTCMonth()).addClass("active")}),(i<s||o<i)&&w.addClass("disabled"),i===s&&w.slice(0,r).addClass("disabled"),i===o&&w.slice(a+1).addClass("disabled"),this.o.beforeShowMonth!==j.noop){var k=this;j.each(w,function(t,e){if(!j(e).hasClass("disabled")){var n=new Date(i,t,1);!1===k.o.beforeShowMonth(n)&&j(e).addClass("disabled")}})}m="",i=10*parseInt(i/10,10);var T=this.picker.find(".datepicker-years").find(".datepicker-switch").text(i+"-"+(i+9)).end().find("td");i-=1;for(var A,S=j.map(this.dates,function(t){return t.getUTCFullYear()}),C=-1;C<11;C++){if(A=["year"],t=null,-1===C?A.push("old"):10===C&&A.push("new"),-1!==j.inArray(i,S)&&A.push("active"),(i<s||o<i)&&A.push("disabled"),this.o.beforeShowYear!==j.noop){var x=this.o.beforeShowYear(new Date(i,0,1));x===P?x={}:"boolean"==typeof x?x={enabled:x}:"string"==typeof x&&(x={classes:x}),!1===x.enabled&&A.push("disabled"),x.classes&&(A=A.concat(x.classes.split(/\s+/))),x.tooltip&&(t=x.tooltip)}m+='<span class="'+A.join(" ")+'"'+(t?' title="'+t+'"':"")+">"+i+"</span>",i+=1}T.html(m)}},updateNavArrows:function(){if(this._allow_update){var t=new Date(this.viewDate),e=t.getUTCFullYear(),n=t.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-Infinity&&e<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&e>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-Infinity&&e<=this.o.startDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&e>=this.o.endDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(t){t.preventDefault(),t.stopPropagation();var e,n,i,s=j(t.target).closest("span, td, th");if(1===s.length)switch(s[0].nodeName.toLowerCase()){case"th":switch(s[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var r=D.modes[this.viewMode].navStep*("prev"===s[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,r),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,r),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var o=new Date;o=I(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0),this.showMode(-2);var a="linked"===this.o.todayBtn?null:"view";this._setDate(o,a);break;case"clear":this.clearDates()}break;case"span":s.hasClass("disabled")||(this.viewDate.setUTCDate(1),s.hasClass("month")?(i=1,n=s.parent().find("span").index(s),e=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(n),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode?(this._setDate(I(e,n,i)),this.showMode()):this.showMode(-1)):(i=1,n=0,e=parseInt(s.text(),10)||0,this.viewDate.setUTCFullYear(e),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(I(e,n,i)),this.showMode(-1)),this.fill());break;case"td":s.hasClass("day")&&!s.hasClass("disabled")&&(i=parseInt(s.text(),10)||1,e=this.viewDate.getUTCFullYear(),n=this.viewDate.getUTCMonth(),s.hasClass("old")?0===n?(n=11,e-=1):n-=1:s.hasClass("new")&&(11===n?(n=0,e+=1):n+=1),this._setDate(I(e,n,i)))}this.picker.is(":visible")&&this._focused_from&&j(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(t){var e=this.dates.contains(t);if(t||this.dates.clear(),-1!==e?(!0===this.o.multidate||1<this.o.multidate||this.o.toggleActive)&&this.dates.remove(e):(!1===this.o.multidate&&this.dates.clear(),this.dates.push(t)),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(t,e){var n;e&&"date"!==e||this._toggle_multidate(t&&new Date(t)),e&&"view"!==e||(this.viewDate=t&&new Date(t)),this.fill(),this.setValue(),e&&"view"===e||this._trigger("changeDate"),this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&n.change(),!this.o.autoclose||e&&"date"!==e||this.hide()},moveMonth:function(t,e){if(!c(t))return this.o.defaultViewDate;if(!e)return t;var n,i,s=new Date(t.valueOf()),r=s.getUTCDate(),o=s.getUTCMonth(),a=Math.abs(e);if(e=0<e?1:-1,1===a)i=-1===e?function(){return s.getUTCMonth()===o}:function(){return s.getUTCMonth()!==n},n=o+e,s.setUTCMonth(n),(n<0||11<n)&&(n=(n+12)%12);else{for(var l=0;l<a;l++)s=this.moveMonth(s,e);n=s.getUTCMonth(),s.setUTCDate(r),i=function(){return n!==s.getUTCMonth()}}for(;i();)s.setUTCDate(--r),s.setUTCMonth(n);return s},moveYear:function(t,e){return this.moveMonth(t,12*e)},dateWithinRange:function(t){return t>=this.o.startDate&&t<=this.o.endDate},keydown:function(t){if(this.picker.is(":visible")){var e,n,i,s,r=!1,o=this.focusDate||this.viewDate;switch(t.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),t.preventDefault(),t.stopPropagation();break;case 37:case 39:if(!this.o.keyboardNavigation)break;e=37===t.keyCode?-1:1,t.ctrlKey?(n=this.moveYear(this.dates.get(-1)||p(),e),i=this.moveYear(o,e),this._trigger("changeYear",this.viewDate)):t.shiftKey?(n=this.moveMonth(this.dates.get(-1)||p(),e),i=this.moveMonth(o,e),this._trigger("changeMonth",this.viewDate)):((n=new Date(this.dates.get(-1)||p())).setUTCDate(n.getUTCDate()+e),(i=new Date(o)).setUTCDate(o.getUTCDate()+e)),this.dateWithinRange(i)&&(this.focusDate=this.viewDate=i,this.setValue(),this.fill(),t.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;e=38===t.keyCode?-1:1,t.ctrlKey?(n=this.moveYear(this.dates.get(-1)||p(),e),i=this.moveYear(o,e),this._trigger("changeYear",this.viewDate)):t.shiftKey?(n=this.moveMonth(this.dates.get(-1)||p(),e),i=this.moveMonth(o,e),this._trigger("changeMonth",this.viewDate)):((n=new Date(this.dates.get(-1)||p())).setUTCDate(n.getUTCDate()+7*e),(i=new Date(o)).setUTCDate(o.getUTCDate()+7*e)),this.dateWithinRange(i)&&(this.focusDate=this.viewDate=i,this.setValue(),this.fill(),t.preventDefault());break;case 32:break;case 13:if(!this.o.forceParse)break;o=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(o),r=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(t.preventDefault(),"function"==typeof t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(r)this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.isInput?s=this.element:this.component&&(s=this.element.find("input")),s&&s.change()}else 40!==t.keyCode&&27!==t.keyCode||(this.show(),t.stopPropagation())},showMode:function(t){t&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,this.viewMode+t))),this.picker.children("div").hide().filter(".datepicker-"+D.modes[this.viewMode].clsName).show(),this.updateNavArrows()}};var d=function(t,e){this.element=j(t),this.inputs=j.map(e.inputs,function(t){return t.jquery?t[0]:t}),delete e.inputs,s.call(j(this.inputs),e).on("changeDate",j.proxy(this.dateUpdated,this)),this.pickers=j.map(this.inputs,function(t){return j(t).data("datepicker")}),this.updateDates()};d.prototype={updateDates:function(){this.dates=j.map(this.pickers,function(t){return t.getUTCDate()}),this.updateRanges()},updateRanges:function(){var n=j.map(this.dates,function(t){return t.valueOf()});j.each(this.pickers,function(t,e){e.setRange(n)})},dateUpdated:function(t){if(!this.updating){this.updating=!0;var e=j(t.target).data("datepicker");if(void 0!==e){var n=e.getUTCDate(),i=j.inArray(t.target,this.inputs),s=i-1,r=i+1,o=this.inputs.length;if(-1!==i){if(j.each(this.pickers,function(t,e){e.getUTCDate()||e.setUTCDate(n)}),n<this.dates[s])for(;0<=s&&n<this.dates[s];)this.pickers[s--].setUTCDate(n);else if(n>this.dates[r])for(;r<o&&n>this.dates[r];)this.pickers[r++].setUTCDate(n);this.updateDates(),delete this.updating}}}},remove:function(){j.map(this.pickers,function(t){t.remove()}),delete this.element.data().datepicker}};var i=j.fn.datepicker,s=function(a){var l,c=Array.apply(null,arguments);if(c.shift(),this.each(function(){var t=j(this),e=t.data("datepicker"),n="object"==typeof a&&a;if(!e){var i=u(this,"date"),s=h(j.extend({},f,i,n).language),r=j.extend({},f,s,i,n);if(t.hasClass("input-daterange")||r.inputs){var o={inputs:r.inputs||t.find("input").toArray()};t.data("datepicker",e=new d(this,j.extend(r,o)))}else t.data("datepicker",e=new y(this,r))}"string"==typeof a&&"function"==typeof e[a]&&(l=e[a].apply(e,c))}),l===P||l instanceof y||l instanceof d)return this;if(1<this.length)throw new Error("Using only allowed for the collection of a single element ("+a+" function)");return l};j.fn.datepicker=s;var f=j.fn.datepicker.defaults={autoclose:!1,beforeShowDay:j.noop,beforeShowMonth:j.noop,beforeShowYear:j.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:2,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,container:"body",immediateUpdates:!1,title:""},o=j.fn.datepicker.locale_opts=["format","rtl","weekStart"];j.fn.datepicker.Constructor=y;var E=j.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},D={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(t){return t%4==0&&t%100!=0||t%400==0},getDaysInMonth:function(t,e){return[31,D.isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(t){if("function"==typeof t.toValue&&"function"==typeof t.toDisplay)return t;var e=t.replace(this.validParts,"\0").split("\0"),n=t.match(this.validParts);if(!e||!e.length||!n||0===n.length)throw new Error("Invalid date format.");return{separators:e,parts:n}},parseDate:function(t,e,n){function i(){var t=this.slice(0,l[o].length),e=l[o].slice(0,t.length);return t.toLowerCase()===e.toLowerCase()}if(!t)return P;if(t instanceof Date)return t;if("string"==typeof e&&(e=D.parseFormat(e)),e.toValue)return e.toValue(t,e,n);var s,r,o,a=/([\-+]\d+)([dmwy])/,l=t.match(/([\-+]\d+)([dmwy])/g);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(t)){for(t=new Date,o=0;o<l.length;o++)switch(s=a.exec(l[o]),r=parseInt(s[1]),s[2]){case"d":t.setUTCDate(t.getUTCDate()+r);break;case"m":t=y.prototype.moveMonth.call(y.prototype,t,r);break;case"w":t.setUTCDate(t.getUTCDate()+7*r);break;case"y":t=y.prototype.moveYear.call(y.prototype,t,r)}return I(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0)}l=t&&t.match(this.nonpunctuation)||[],t=new Date;var c,p,u={},h=["yyyy","yy","M","MM","m","mm","d","dd"],d={yyyy:function(t,e){return t.setUTCFullYear(e)},yy:function(t,e){return t.setUTCFullYear(2e3+e)},m:function(t,e){if(isNaN(t))return t;for(e-=1;e<0;)e+=12;for(e%=12,t.setUTCMonth(e);t.getUTCMonth()!==e;)t.setUTCDate(t.getUTCDate()-1);return t},d:function(t,e){return t.setUTCDate(e)}};d.M=d.MM=d.mm=d.m,d.dd=d.d,t=I(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0);var f=e.parts.slice();if(l.length!==f.length&&(f=j(f).filter(function(t,e){return-1!==j.inArray(e,h)}).toArray()),l.length===f.length){var m,g,v;for(o=0,m=f.length;o<m;o++){if(c=parseInt(l[o],10),s=f[o],isNaN(c))switch(s){case"MM":p=j(E[n].months).filter(i),c=j.inArray(p[0],E[n].months)+1;break;case"M":p=j(E[n].monthsShort).filter(i),c=j.inArray(p[0],E[n].monthsShort)+1}u[s]=c}for(o=0;o<h.length;o++)(v=h[o])in u&&!isNaN(u[v])&&(g=new Date(t),d[v](g,u[v]),isNaN(g)||(t=g))}return t},formatDate:function(t,e,n){if(!t)return"";if("string"==typeof e&&(e=D.parseFormat(e)),e.toDisplay)return e.toDisplay(t,e,n);var i={d:t.getUTCDate(),D:E[n].daysShort[t.getUTCDay()],DD:E[n].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:E[n].monthsShort[t.getUTCMonth()],MM:E[n].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};i.dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m,t=[];for(var s=j.extend([],e.separators),r=0,o=e.parts.length;r<=o;r++)s.length&&t.push(s.shift()),t.push(i[e.parts[r]]);return t.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">&#171;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&#187;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};D.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+D.headTemplate+"<tbody></tbody>"+D.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+D.headTemplate+D.contTemplate+D.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+D.headTemplate+D.contTemplate+D.footTemplate+"</table></div></div>",j.fn.datepicker.DPGlobal=D,j.fn.datepicker.noConflict=function(){return j.fn.datepicker=i,this},j.fn.datepicker.version="1.4.1-dev",j(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var e=j(this);e.data("datepicker")||(t.preventDefault(),s.call(e,"show"))}),j(function(){s.call(j('[data-provide="datepicker-inline"]'))})}),function(t,e){"function"==typeof define&&define.amd?define(t):void 0!==module&&"object"==typeof exports?module.exports=t():e.rangy=t()}(function(){function l(t,e){var n=typeof t[e];return n==_||!(n!=b||!t[e])||"unknown"==n}function e(t,e){return!(typeof t[e]!=b||!t[e])}function t(t,e){return typeof t[e]!=w}function i(i){return function(t,e){for(var n=e.length;n--;)if(!i(t,e[n]))return!1;return!0}}function c(t){return t&&C(t,S)&&j(t,A)}function p(t){return e(t,"body")?t.body:t.getElementsByTagName("body")[0]}function u(t){typeof console!=w&&l(console,"log")&&console.log(t)}function n(t,e){E&&e?alert(t):u(t)}function h(t){O.initialized=!0,O.supported=!1,n("Rangy is not supported in this environment. Reason: "+t,O.config.alertOnFail)}function s(t){n("Rangy warning: "+t,O.config.alertOnWarn)}function d(t){return t.message||t.description||String(t)}function r(){if(E&&!O.initialized){var t,e=!1,n=!1;l(document,"createRange")&&(t=document.createRange(),C(t,T)&&j(t,k)&&(e=!0));var i,s=p(document);if(!s||"body"!=s.nodeName.toLowerCase())return void h("No body element found");if(s&&l(s,"createTextRange")&&(c(t=s.createTextRange())&&(n=!0)),!e&&!n)return void h("Neither Range nor TextRange are available");for(var r in O.initialized=!0,O.features={implementsDomRange:e,implementsTextRange:n},I)(i=I[r])instanceof f&&i.init(i,O);for(var o=0,a=N.length;o<a;++o)try{N[o](O)}catch(g){u("Rangy init listener threw an exception. Continuing. Detail: "+d(g))}}}function o(t){t=t||window,r();for(var e=0,n=R.length;e<n;++e)R[e](t)}function f(t,e,n){this.name=t,this.dependencies=e,this.initialized=!1,this.supported=!1,this.initializer=n}function a(n,t,i){var s=new f(n,t,function(t){if(!t.initialized){t.initialized=!0;try{i(O,t),t.supported=!0}catch(s){var e="Module '"+n+"' failed to load: "+d(s);u(e),s.stack&&u(s.stack)}}});return I[n]=s}function m(){}function g(){}var v,y,b="object",_="function",w="undefined",k=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],T=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],A=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],S=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],C=i(l),x=i(e),j=i(t),P=[].forEach?function(t,e){t.forEach(e)}:function(t,e){for(var n=0,i=t.length;n<i;++n)e(t[n],n)},I={},E=typeof window!=w&&typeof document!=w,D={isHostMethod:l,isHostObject:e,isHostProperty:t,areHostMethods:C,areHostObjects:x,areHostProperties:j,isTextRange:c,getBody:p,forEach:P},O={version:"1.3.0-beta.1",initialized:!1,isBrowser:E,supported:!0,util:D,features:{},modules:I,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==w||rangyAutoInitialize}};O.fail=h,O.warn=s,!{}.hasOwnProperty?h("hasOwnProperty not supported"):(D.extend=v=function(t,e,n){var i,s;for(var r in e)e.hasOwnProperty(r)&&(i=t[r],s=e[r],n&&null!==i&&"object"==typeof i&&null!==s&&"object"==typeof s&&v(i,s,!0),t[r]=s);return e.hasOwnProperty("toString")&&(t.toString=e.toString),t},D.createOptions=function(t,e){var n={};return v(n,e),t&&v(n,t),n}),E||h("Rangy can only run in a browser"),function(){var t;if(E){var e=document.createElement("div");e.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(e.childNodes,0)[0].nodeType&&(t=function(t){return n.call(t,0)})}catch(i){}}t||(t=function(t){for(var e=[],n=0,i=t.length;n<i;++n)e[n]=t[n];return e}),D.toArray=t}(),E&&(l(document,"addEventListener")?y=function(t,e,n){t.addEventListener(e,n,!1)}:l(document,"attachEvent")?y=function(t,e,n){t.attachEvent("on"+e,n)}:h("Document does not have required addEventListener or attachEvent method"),D.addListener=y);var N=[];O.init=r,O.addInitListener=function(t){O.initialized?t(O):N.push(t)};var R=[];O.addShimListener=function(t){R.push(t)},E&&(O.shim=O.createMissingNativeApi=o),f.prototype={init:function(){for(var t,e,n=this.dependencies||[],i=0,s=n.length;i<s;++i){if(e=n[i],!((t=I[e])&&t instanceof f))throw new Error("required module '"+e+"' not found");if(t.init(),!t.supported)throw new Error("required module '"+e+"' not supported")}this.initializer(this)},fail:function(t){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+t)},warn:function(t){O.warn("Module "+this.name+": "+t)},deprecationNotice:function(t,e){O.warn("DEPRECATED: "+t+" in module "+this.name+"is deprecated. Please use "+e+" instead")},createError:function(t){return new Error("Error in Rangy "+this.name+" module: "+t)}},O.createModule=function(t,e,n){var i,s;2==arguments.length?(i=e,s=[]):(i=n,s=e);var r=a(t,s,i);O.initialized&&O.supported&&r.init()},O.createCoreModule=function(t,e,n){a(t,e,n)},O.RangePrototype=m,O.rangePrototype=new m,O.selectionPrototype=new g,O.createCoreModule("DomUtil",[],function(n,c){function e(t){var e;return typeof t.namespaceURI==P||null===(e=t.namespaceURI)||"http://www.w3.org/1999/xhtml"==e}function t(t){var e=t.parentNode;return 1==e.nodeType?e:null}function p(t){for(var e=0;t=t.previousSibling;)++e;return e}function i(t){switch(t.nodeType){case 7:case 10:return 0;case 3:case 8:return t.length;default:return t.childNodes.length}}function u(t,e){var n,i=[];for(n=t;n;n=n.parentNode)i.push(n);for(n=e;n;n=n.parentNode)if(N(i,n))return n;return null}function s(t,e,n){for(var i=n?e:e.parentNode;i;){if(i===t)return!0;i=i.parentNode}return!1}function r(t,e){return s(t,e,!0)}function h(t,e,n){for(var i,s=n?t:t.parentNode;s;){if((i=s.parentNode)===e)return s;s=i}return null}function o(t){var e=t.nodeType;return 3==e||4==e||8==e}function a(t){if(!t)return!1;var e=t.nodeType;return 3==e||8==e}function l(t,e){var n=e.nextSibling,i=e.parentNode;return n?i.insertBefore(t,n):i.appendChild(t),t}function d(t,e,n){var i=t.cloneNode(!1);if(i.deleteData(0,e),t.deleteData(e,t.length-e),l(i,t),n)for(var s,r=0;s=n[r++];)s.node==t&&s.offset>e?(s.node=i,s.offset-=e):s.node==t.parentNode&&s.offset>p(t)&&++s.offset;return i}function f(t){if(9==t.nodeType)return t;if(typeof t.ownerDocument!=P)return t.ownerDocument;if(typeof t.document!=P
)return t.document;if(t.parentNode)return f(t.parentNode);throw c.createError("getDocument: no document found for node")}function m(t){var e=f(t);if(typeof e.defaultView!=P)return e.defaultView;if(typeof e.parentWindow!=P)return e.parentWindow;throw c.createError("Cannot get a window object for node")}function g(t){if(typeof t.contentDocument!=P)return t.contentDocument;if(typeof t.contentWindow!=P)return t.contentWindow.document;throw c.createError("getIframeDocument: No Document object found for iframe element")}function v(t){if(typeof t.contentWindow!=P)return t.contentWindow;if(typeof t.contentDocument!=P)return t.contentDocument.defaultView;throw c.createError("getIframeWindow: No Window object found for iframe element")}function y(t){return t&&I.isHostMethod(t,"setTimeout")&&I.isHostObject(t,"document")}function b(t,e,n){var i;if(t?I.isHostProperty(t,"nodeType")?i=1==t.nodeType&&"iframe"==t.tagName.toLowerCase()?g(t):f(t):y(t)&&(i=t.document):i=document,!i)throw e.createError(n+"(): Parameter must be a Window object or DOM node");return i}function _(t){for(var e;e=t.parentNode;)t=e;return t}function w(t,e,n,i){var s,r,o,a,l;if(t==n)return e===i?0:e<i?-1:1;if(s=h(n,t,!0))return e<=p(s)?-1:1;if(s=h(t,n,!0))return p(s)<i?-1:1;if(!(r=u(t,n)))throw new Error("comparePoints error: nodes have no common ancestor");if((o=t===r?r:h(t,r,!0))===(a=n===r?r:h(n,r,!0)))throw c.createError("comparePoints got to case 4 and childA and childB are the same!");for(l=r.firstChild;l;){if(l===o)return-1;if(l===a)return 1;l=l.nextSibling}}function k(t){try{return t.parentNode,!1}catch(e){return!0}}function T(t){if(!t)return"[No node]";if(R&&k(t))return"[Broken node]";if(o(t))return'"'+t.data+'"';if(1!=t.nodeType)return t.nodeName;var e=t.id?' id="'+t.id+'"':"";return"<"+t.nodeName+e+">[index:"+p(t)+",length:"+t.childNodes.length+"]["+(t.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}function A(t){for(var e,n=f(t).createDocumentFragment();e=t.firstChild;)n.appendChild(e);return n}function S(t){this.root=t,this._next=t}function C(t){return new S(t)}function x(t,e){this.node=t,this.offset=e}function j(t){this.code=this[t],this.codeName=t,this.message="DOMException: "+this.codeName}var P="undefined",I=n.util;I.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||c.fail("document missing a Node creation method"),I.isHostMethod(document,"getElementsByTagName")||c.fail("document missing getElementsByTagName method");var E=document.createElement("div");I.areHostMethods(E,["insertBefore","appendChild","cloneNode"])||c.fail("Incomplete Element implementation"),I.isHostProperty(E,"innerHTML")||c.fail("Element is missing innerHTML property");var D=document.createTextNode("test");I.areHostMethods(D,["splitText","deleteData","insertData","appendData","cloneNode"])||c.fail("Incomplete Text Node implementation");var O,N=function(t,e){for(var n=t.length;n--;)if(t[n]===e)return!0;return!1},R=!1;!function(){var t=document.createElement("b");t.innerHTML="1";var e=t.firstChild;t.innerHTML="<br />",R=k(e),n.features.crashyTextNodes=R}(),typeof window.getComputedStyle!=P?O=function(t,e){return m(t).getComputedStyle(t,null)[e]}:typeof document.documentElement.currentStyle!=P?O=function(t,e){return t.currentStyle[e]}:c.fail("No means of obtaining computed style properties found"),S.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var t,e,n=this._current=this._next;if(this._current)if(t=n.firstChild)this._next=t;else{for(e=null;n!==this.root&&!(e=n.nextSibling);)n=n.parentNode;this._next=e}return this._current},detach:function(){this._current=this._next=this.root=null}},x.prototype={equals:function(t){return!!t&&this.node===t.node&&this.offset==t.offset},inspect:function(){return"[DomPosition("+T(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},j.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},j.prototype.toString=function(){return this.message},n.dom={arrayContains:N,isHtmlNamespace:e,parentElement:t,getNodeIndex:p,getNodeLength:i,getCommonAncestor:u,isAncestorOf:s,isOrIsAncestorOf:r,getClosestAncestorIn:h,isCharacterDataNode:o,isTextOrCommentNode:a,insertAfter:l,splitDataNode:d,getDocument:f,getWindow:m,getIframeWindow:v,getIframeDocument:g,getBody:I.getBody,isWindow:y,getContentDocument:b,getRootContainer:_,comparePoints:w,isBrokenNode:k,inspectNode:T,getComputedStyleProperty:O,fragmentFromNodeChildren:A,createIterator:C,DomPosition:x},n.DOMException=j}),O.createCoreModule("DomRange",["DomUtil"],function(o){function i(t,e){return 3!=t.nodeType&&(z(t,e.startContainer)||z(t,e.endContainer))}function a(t){return t.document||B(t.startContainer)}function l(t){return new M(t.parentNode,U(t))}function p(t){return new M(t.parentNode,U(t)+1)}function n(t,e,n){var i=11==t.nodeType?t.firstChild:t;return L(e)?n==e.length?N.insertAfter(t,e):e.parentNode.insertBefore(t,0==n?e:q(e,n)):n>=e.childNodes.length?e.appendChild(t):e.insertBefore(t,e.childNodes[n]),i}function e(t,e,n){if(A(t),A(e),a(e)!=a(t))throw new $("WRONG_DOCUMENT_ERR");var i=F(t.startContainer,t.startOffset,e.endContainer,e.endOffset),s=F(t.endContainer,t.endOffset,e.startContainer,e.startOffset);return n?i<=0&&0<=s:i<0&&0<s}function r(t){for(var e,n,i,s=a(t.range).createDocumentFragment();n=t.next();){if(e=t.isPartiallySelectedSubtree(),n=n.cloneNode(!e),e&&(i=t.getSubtreeIterator(),n.appendChild(r(i)),i.detach()),10==n.nodeType)throw new $("HIERARCHY_REQUEST_ERR");s.appendChild(n)}return s}function c(t,e,n){var i,s,r,o;for(n=n||{stop:!1};r=t.next();)if(t.isPartiallySelectedSubtree()){if(!1===e(r))return void(n.stop=!0);if(c(o=t.getSubtreeIterator(),e,n),o.detach(),n.stop)return}else for(i=N.createIterator(r);s=i.next();)if(!1===e(s))return void(n.stop=!0)}function u(t){for(var e;t.next();)t.isPartiallySelectedSubtree()?(u(e=t.getSubtreeIterator()),e.detach()):t.remove()}function h(t){for(var e,n,i=a(t.range).createDocumentFragment();e=t.next();){if(t.isPartiallySelectedSubtree()?(e=e.cloneNode(!1),n=t.getSubtreeIterator(),e.appendChild(h(n)),n.detach()):t.remove(),10==e.nodeType)throw new $("HIERARCHY_REQUEST_ERR");i.appendChild(e)}return i}function s(i,t,s){var r,o=!(!t||!t.length),a=!!s;o&&(r=new RegExp("^("+t.join("|")+")$"));var l=[];return c(new d(i,!1),function(t){if(!(o&&!r.test(t.nodeType)||a&&!s(t))){var e=i.startContainer;if(t!=e||!L(e)||i.startOffset!=e.length){var n=i.endContainer;t==n&&L(n)&&0==i.endOffset||l.push(t)}}}),l}function t(t){return"["+("undefined"==typeof t.getName?"Range":t.getName())+"("+N.inspectNode(t.startContainer)+":"+t.startOffset+", "+N.inspectNode(t.endContainer)+":"+t.endOffset+")]"}function d(t,e){if(this.range=t,this.clonePartiallySelectedTextNodes=e,!t.collapsed){this.sc=t.startContainer,this.so=t.startOffset,this.ec=t.endContainer,this.eo=t.endOffset;var n=t.commonAncestorContainer;this.sc===this.ec&&L(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||L(this.sc)?J(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||L(this.ec)?J(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function f(s){return function(t,e){for(var n,i=e?t:t.parentNode;i;){if(n=i.nodeType,W(s,n))return i;i=i.parentNode}return null}}function m(t,e){if(nt(t,e))throw new $("INVALID_NODE_TYPE_ERR")}function g(t,e){if(!W(e,t.nodeType))throw new $("INVALID_NODE_TYPE_ERR")}function v(t,e){if(e<0||e>(L(t)?t.length:t.childNodes.length))throw new $("INDEX_SIZE_ERR")}function y(t,e){if(tt(t,!0)!==tt(e,!0))throw new $("WRONG_DOCUMENT_ERR")}function b(t){if(et(t,!0))throw new $("NO_MODIFICATION_ALLOWED_ERR")}function _(t,e){if(!t)throw new $(e)}function w(t){return K&&N.isBrokenNode(t)||!W(Y,t.nodeType)&&!tt(t,!0)}function k(t,e){return e<=(L(t)?t.length:t.childNodes.length)}function T(t){return!!t.startContainer&&!!t.endContainer&&!w(t.startContainer)&&!w(t.endContainer)&&k(t.startContainer,t.startOffset)&&k(t.endContainer,t.endOffset)}function A(t){if(!T(t))throw new Error("Range error: Range is no longer valid after DOM mutation ("+t.inspect()+")")}function S(t,e){A(t);var n=t.startContainer,i=t.startOffset,s=t.endContainer,r=t.endOffset,o=n===s;L(s)&&0<r&&r<s.length&&q(s,r,e),L(n)&&0<i&&i<n.length&&(n=q(n,i,e),o?(r-=i,s=n):s==n.parentNode&&r>=U(n)&&r++,i=0),t.setStartAndEnd(n,i,s,r)}function C(t){A(t);var e=t.commonAncestorContainer.parentNode.cloneNode(!1);return e.appendChild(t.cloneContents()),e.innerHTML}function x(t){t.START_TO_START=at,t.START_TO_END=lt,t.END_TO_END=ct,t.END_TO_START=pt,t.NODE_BEFORE=ut,t.NODE_AFTER=ht,t.NODE_BEFORE_AND_AFTER=dt,t.NODE_INSIDE=ft}function j(t){x(t),x(t.prototype)}function P(o,a){return function(){A(this);var t,e=this.startContainer,n=this.startOffset,i=this.commonAncestorContainer,s=new d(this,!0);e!==i&&(e=(t=p(J(e,i,!0))).node,n=t.offset),c(s,b),s.reset();var r=o(s);return s.detach(),a(this,e,n,e,n),r}}function I(t,c){function e(n,i){return function(t){g(t,V),g(G(t),Y);var e=(n?l:p)(t);(i?s:r)(this,e.node,e.offset)}}function s(t,e,n){var i=t.endContainer,s=t.endOffset;(e!==t.startContainer||n!==t.startOffset)&&((G(e)!=G(i)||1==F(e,n,i,s))&&(i=e,s=n),c(t,e,n,i,s))}function r(t,e,n){var i=t.startContainer,s=t.startOffset;(e!==t.endContainer||n!==t.endOffset)&&((G(e)!=G(i)||-1==F(e,n,i,s))&&(i=e,s=n),c(t,i,s,e,n))}var n=function(){};n.prototype=o.rangePrototype,t.prototype=new n,R.extend(t.prototype,{setStart:function(t,e){m(t,!0),v(t,e),s(this,t,e)},setEnd:function(t,e){m(t,!0),v(t,e),r(this,t,e)},setStartAndEnd:function(){var t=arguments,e=t[0],n=t[1],i=e,s=n;switch(t.length){case 3:s=t[2];break;case 4:i=t[2],s=t[3]}c(this,e,n,i,s)},setBoundary:function(t,e,n){this["set"+(n?"Start":"End")](t,e)},setStartBefore:e(!0,!0),setStartAfter:e(!1,!0),setEndBefore:e(!0,!1),setEndAfter:e(!1,!1),collapse:function(t){A(this),t?c(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):c(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(t){m(t,!0),c(this,t,0,t,H(t))},selectNode:function(t){m(t,!1),g(t,V);var e=l(t),n=p(t);c(this,e.node,e.offset,n.node,n.offset)},extractContents:P(h,c),deleteContents:P(u,c),canSurroundContents:function(){A(this),b(this.startContainer),b(this.endContainer);var t=new d(this,!0),e=t._first&&i(t._first,this)||t._last&&i(t._last,this);return t.detach(),!e},splitBoundaries:function(){S(this)},splitBoundariesPreservingPositions:function(t){S(this,t)},normalizeBoundaries:function(){A(this);var s=this.startContainer,r=this.startOffset,o=this.endContainer,a=this.endOffset,t=function(t){var e=t.nextSibling;e&&e.nodeType==t.nodeType&&(a=(o=t).length,t.appendData(e.data),e.parentNode.removeChild(e))},e=function(t){var e=t.previousSibling;if(e&&e.nodeType==t.nodeType){var n=(s=t).length;if(r=e.length,t.insertData(0,e.data),e.parentNode.removeChild(e),s==o)a+=r,o=s;else if(o==t.parentNode){var i=U(t);a==i?(o=t,a=n):i<a&&a--}}},n=!0;if(L(o))o.length==a&&t(o);else{if(0<a){var i=o.childNodes[a-1];i&&L(i)&&t(i)}n=!this.collapsed}if(n){if(L(s))0==r&&e(s);else if(r<s.childNodes.length){var l=s.childNodes[r];l&&L(l)&&e(l)}}else s=o,r=a;c(this,s,r,o,a)},collapseToPoint:function(t,e){m(t,!0),v(t,e),this.setStartAndEnd(t,e)}}),j(t)}function E(t){t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset,t.commonAncestorContainer=t.collapsed?t.startContainer:N.getCommonAncestor(t.startContainer,t.endContainer)}function D(t,e,n,i,s){t.startContainer=e,t.startOffset=n,t.endContainer=i,t.endOffset=s,t.document=N.getDocument(e),E(t)}function O(t){this.startContainer=t,this.startOffset=0,this.endContainer=t,this.endOffset=0,this.document=t,E(this)}var N=o.dom,R=o.util,M=N.DomPosition,$=o.DOMException,L=N.isCharacterDataNode,U=N.getNodeIndex,z=N.isOrIsAncestorOf,B=N.getDocument,F=N.comparePoints,q=N.splitDataNode,J=N.getClosestAncestorIn,H=N.getNodeLength,W=N.arrayContains,G=N.getRootContainer,K=o.features.crashyTextNodes;d.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var t=this._current=this._next;return t&&(this._next=t!==this._last?t.nextSibling:null,L(t)&&this.clonePartiallySelectedTextNodes&&(t===this.ec&&(t=t.cloneNode(!0)).deleteData(this.eo,t.length-this.eo),this._current===this.sc&&(t=t.cloneNode(!0)).deleteData(0,this.so))),t},remove:function(){var t,e,n=this._current;!L(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(t=n===this.sc?this.so:0)!=(e=n===this.ec?this.eo:n.length)&&n.deleteData(t,e-t)},isPartiallySelectedSubtree:function(){return i(this._current,this.range)},getSubtreeIterator:function(){var t;if(this.isSingleCharacterDataNode)(t=this.range.cloneRange()).collapse(!1);else{t=new O(a(this.range));var e=this._current,n=e,i=0,s=e,r=H(e);z(e,this.sc)&&(n=this.sc,i=this.so),z(e,this.ec)&&(s=this.ec,r=this.eo),D(t,n,i,s,r)}return new d(t,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var V=[1,3,4,5,7,8,10],Y=[2,9,11],X=[5,6,10,12],Z=[1,3,4,5,7,8,10,11],Q=[1,3,4,5,7,8],tt=f([9,11]),et=f(X),nt=f([6,10,12]),it=document.createElement("style"),st=!1;try{it.innerHTML="<b>x</b>",st=3==it.firstChild.nodeType}catch(mt){}var rt=(o.features.htmlParsingConforms=st)?function(t){var e=this.startContainer,n=B(e);if(!e)throw new $("INVALID_STATE_ERR");var i=null;return 1==e.nodeType?i=e:L(e)&&(i=N.parentElement(e)),(i=null===i||"HTML"==i.nodeName&&N.isHtmlNamespace(B(i).documentElement)&&N.isHtmlNamespace(i)?n.createElement("body"):i.cloneNode(!1)).innerHTML=t,N.fragmentFromNodeChildren(i)}:function(t){var e=a(this).createElement("body");return e.innerHTML=t,N.fragmentFromNodeChildren(e)},ot=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],at=0,lt=1,ct=2,pt=3,ut=0,ht=1,dt=2,ft=3;R.extend(o.rangePrototype,{compareBoundaryPoints:function(t,e){A(this),y(this.startContainer,e.startContainer);var n,i,s,r,o=t==pt||t==at?"start":"end",a=t==lt||t==at?"start":"end";return n=this[o+"Container"],i=this[o+"Offset"],s=e[a+"Container"],r=e[a+"Offset"],F(n,i,s,r)},insertNode:function(t){if(A(this),g(t,Z),b(this.startContainer),z(t,this.startContainer))throw new $("HIERARCHY_REQUEST_ERR");var e=n(t,this.startContainer,this.startOffset);this.setStartBefore(e)},cloneContents:function(){var t,e;if(A(this),this.collapsed)return a(this).createDocumentFragment();if(this.startContainer===this.endContainer&&L(this.startContainer))return(t=this.startContainer.cloneNode(!0)).data=t.data.slice(this.startOffset,this.endOffset),(e=a(this).createDocumentFragment()).appendChild(t),e;var n=new d(this,!0);return t=r(n),n.detach(),t},canSurroundContents:function(){A(this),b(this.startContainer),b(this.endContainer);var t=new d(this,!0),e=t._first&&i(t._first,this)||t._last&&i(t._last,this);return t.detach(),!e},surroundContents:function(t){if(g(t,Q),!this.canSurroundContents())throw new $("INVALID_STATE_ERR");var e=this.extractContents();if(t.hasChildNodes())for(;t.lastChild;)t.removeChild(t.lastChild);n(t,this.startContainer,this.startOffset),t.appendChild(e),this.selectNode(t)},cloneRange:function(){A(this);for(var t,e=new O(a(this)),n=ot.length;n--;)e[t=ot[n]]=this[t];return e},toString:function(){A(this);var t=this.startContainer;if(t===this.endContainer&&L(t))return 3==t.nodeType||4==t.nodeType?t.data.slice(this.startOffset,this.endOffset):"";var e=[],n=new d(this,!0);return c(n,function(t){(3==t.nodeType||4==t.nodeType)&&e.push(t.data)}),n.detach(),e.join("")},compareNode:function(t){A(this);var e=t.parentNode,n=U(t);if(!e)throw new $("NOT_FOUND_ERR");var i=this.comparePoint(e,n),s=this.comparePoint(e,n+1);return i<0?0<s?dt:ut:0<s?ht:ft},comparePoint:function(t,e){return A(this),_(t,"HIERARCHY_REQUEST_ERR"),y(t,this.startContainer),F(t,e,this.startContainer,this.startOffset)<0?-1:0<F(t,e,this.endContainer,this.endOffset)?1:0},createContextualFragment:rt,toHtml:function(){return C(this)},intersectsNode:function(t,e){if(A(this),_(t,"NOT_FOUND_ERR"),B(t)!==a(this))return!1;var n=t.parentNode,i=U(t);_(n,"NOT_FOUND_ERR");var s=F(n,i,this.endContainer,this.endOffset),r=F(n,i+1,this.startContainer,this.startOffset);return e?s<=0&&0<=r:s<0&&0<r},isPointInRange:function(t,e){return A(this),_(t,"HIERARCHY_REQUEST_ERR"),y(t,this.startContainer),0<=F(t,e,this.startContainer,this.startOffset)&&F(t,e,this.endContainer,this.endOffset)<=0},intersectsRange:function(t){return e(this,t,!1)},intersectsOrTouchesRange:function(t){return e(this,t,!0)},intersection:function(t){if(this.intersectsRange(t)){var e=F(this.startContainer,this.startOffset,t.startContainer,t.startOffset),n=F(this.endContainer,this.endOffset,t.endContainer,t.endOffset),i=this.cloneRange();return-1==e&&i.setStart(t.startContainer,t.startOffset),1==n&&i.setEnd(t.endContainer,t.endOffset),i}return null},union:function(t){if(this.intersectsOrTouchesRange(t)){var e=this.cloneRange();return-1==F(t.startContainer,t.startOffset,this.startContainer,this.startOffset)&&e.setStart(t.startContainer,t.startOffset),1==F(t.endContainer,t.endOffset,this.endContainer,this.endOffset)&&e.setEnd(t.endContainer,t.endOffset),e}throw new $("Ranges do not intersect")},containsNode:function(t,e){return e?this.intersectsNode(t,!1):this.compareNode(t)==ft},containsNodeContents:function(t){return 0<=this.comparePoint(t,0)&&this.comparePoint(t,H(t))<=0},containsRange:function(t){var e=this.intersection(t);return null!==e&&t.equals(e)},containsNodeText:function(t){var e=this.cloneRange();e.selectNode(t);var n=e.getNodes([3]);if(0<n.length){e.setStart(n[0],0);var i=n.pop();return e.setEnd(i,i.length),this.containsRange(e)}return this.containsNodeContents(t)},getNodes:function(t,e){return A(this),s(this,t,e)},getDocument:function(){return a(this)},collapseBefore:function(t){this.setEndBefore(t),this.collapse(!1)},collapseAfter:function(t){this.setStartAfter(t),this.collapse(!0)},getBookmark:function(t){var e=a(this),n=o.createRange(e);t=t||N.getBody(e),n.selectNodeContents(t);var i=this.intersection(n),s=0,r=0;return i&&(n.setEnd(i.startContainer,i.startOffset),r=(s=n.toString().length)+i.toString().length),{start:s,end:r,containerNode:t}},moveToBookmark:function(t){var e=t.containerNode,n=0;this.setStart(e,0),this.collapse(!0);for(var i,s,r,o,a=[e],l=!1,c=!1;!c&&(i=a.pop());)if(3==i.nodeType)s=n+i.length,!l&&t.start>=n&&t.start<=s&&(this.setStart(i,t.start-n),l=!0),l&&t.end>=n&&t.end<=s&&(this.setEnd(i,t.end-n),c=!0),n=s;else for(r=(o=i.childNodes).length;r--;)a.push(o[r])},getName:function(){return"DomRange"},equals:function(t){return O.rangesEqual(this,t)},isValid:function(){return T(this)},inspect:function(){return t(this)},detach:function(){}}),I(O,D),R.extend(O,{rangeProperties:ot,RangeIterator:d,copyComparisonConstants:j,createPrototypeRange:I,inspect:t,toHtml:C,getRangeDocument:a,rangesEqual:function(t,e){return t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset}}),o.DomRange=O}),O.createCoreModule("WrappedRange",["DomRange"],function(u,h){var d,t,k=u.dom,f=u.util,T=k.DomPosition,m=u.DomRange,g=k.getBody,v=k.getContentDocument,A=k.isCharacterDataNode;if(u.features.implementsDomRange&&function(){function i(t){for(var e,n=s.length;n--;)t[e=s[n]]=t.nativeRange[e];t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset}function t(t,e,n,i,s){var r=t.startContainer!==e||t.startOffset!=n,o=t.endContainer!==i||t.endOffset!=s,a=!t.equals(t.nativeRange);(r||o||a)&&(t.setEnd(i,s),t.setStart(e,n))}var e,n,s=m.rangeProperties;d=function(t){if(!t)throw h.createError("WrappedRange: Range must be specified");this.nativeRange=t,i(this)},m.createPrototypeRange(d,t),(e=d.prototype).selectNode=function(t){this.nativeRange.selectNode(t),i(this)},e.cloneContents=function(){return this.nativeRange.cloneContents()},e.surroundContents=function(t){this.nativeRange.surroundContents(t),i(this)},e.collapse=function(t){this.nativeRange.collapse(t),i(this)},e.cloneRange=function(){return new d(this.nativeRange.cloneRange())},e.refresh=function(){i(this)},e.toString=function(){return this.nativeRange.toString()};var r=document.createTextNode("test");g(document).appendChild(r);var o=document.createRange();o.setStart(r,0),o.setEnd(r,0);try{o.setStart(r,1),e.setStart=function(t,e){this.nativeRange.setStart(t,e),i(this)},e.setEnd=function(t,e){this.nativeRange.setEnd(t,e),i(this)},n=function(e){return function(t){this.nativeRange[e](t),i(this)}}}catch(y){e.setStart=function(t,e){try{this.nativeRange.setStart(t,e)}catch(d){this.nativeRange.setEnd(t,e),this.nativeRange.setStart(t,e)}i(this)},e.setEnd=function(t,e){try{this.nativeRange.setEnd(t,e)}catch(d){this.nativeRange.setStart(t,e),this.nativeRange.setEnd(t,e)}i(this)},n=function(e,n){return function(t){try{this.nativeRange[e](t)}catch(k){this.nativeRange[n](t),this.nativeRange[e](t)}i(this)}}}e.setStartBefore=n("setStartBefore","setEndBefore"),e.setStartAfter=n("setStartAfter","setEndAfter"),e.setEndBefore=n("setEndBefore","setStartBefore"),e.setEndAfter=n("setEndAfter","setStartAfter"),e.selectNodeContents=function(t){this.setStartAndEnd(t,0,k.getNodeLength(t))},o.selectNodeContents(r),o.setEnd(r,3);var a=document.createRange();a.selectNodeContents(r),a.setEnd(r,4),a.setStart(r,2),e.compareBoundaryPoints=-1==o.compareBoundaryPoints(o.START_TO_END,a)&&1==o.compareBoundaryPoints(o.END_TO_START,a)?function(t,e){return t==(e=e.nativeRange||e).START_TO_END?t=e.END_TO_START:t==e.END_TO_START&&(t=e.START_TO_END),this.nativeRange.compareBoundaryPoints(t,e)}:function(t,e){return this.nativeRange.compareBoundaryPoints(t,e.nativeRange||e)};var l=document.createElement("div");l.innerHTML="123";var c=l.firstChild,p=g(document);p.appendChild(l),o.setStart(c,1),o.setEnd(c,2),o.deleteContents(),"13"==c.data&&(e.deleteContents=function(){this.nativeRange.deleteContents(),i(this)},e.extractContents=function(){var t=this.nativeRange.extractContents();return i(this),t}),p.removeChild(l),p=null,f.isHostMethod(o,"createContextualFragment")&&(e.createContextualFragment=function(t){return this.nativeRange.createContextualFragment(t)}),g(document).removeChild(r),e.getName=function(){return"WrappedRange"},u.WrappedRange=d,u.createNativeRange=function(t){return(t=v(t,h,"createNativeRange")).createRange()}}(),u.features.implementsTextRange){var s=function(t){var e=t.parentElement(),n=t.duplicate();n.collapse(!0);var i=n.parentElement();(n=t.duplicate()).collapse(!1);var s=n.parentElement(),r=i==s?i:k.getCommonAncestor(i,s);return r==e?r:k.getCommonAncestor(e,r)},r=function(t){return 0==t.compareEndPoints("StartToEnd",t)},o=function(t,e,n,i,s){var r=t.duplicate();r.collapse(n);var o=r.parentElement();if(k.isOrIsAncestorOf(e,o)||(o=e),!o.canHaveHTML){var a=new T(o.parentNode,k.getNodeIndex(o));return{boundaryPosition:a,nodeInfo:{nodeIndex:a.offset,containerElement:a.node}}}var l=k.getDocument(o).createElement("span");l.parentNode&&l.parentNode.removeChild(l);for(var c,p,u,h,d,f=n?"StartToStart":"StartToEnd",m=s&&s.containerElement==o?s.nodeIndex:0,g=o.childNodes.length,v=g,y=v;y==g?o.appendChild(l):o.insertBefore(l,o.childNodes[y]),r.moveToElementText(l),0!=(c=r.compareEndPoints(f,t))&&m!=v;){if(-1==c){if(v==m+1)break;m=y}else v=v==m+1?m:y;y=Math.floor((m+v)/2),o.removeChild(l)}if(d=l.nextSibling,-1==c&&d&&A(d)){var b;if(r.setEndPoint(n?"EndToStart":"EndToEnd",t),/[\r\n]/.test(d.data)){var _=r.duplicate(),w=_.text.replace(/\r\n/g,"\r").length;for(b=_.moveStart("character",w);-1==(c=_.compareEndPoints("StartToEnd",_));)b++,_.moveStart("character",1)}else b=r.text.length;h=new T(d,b)}else p=(i||!n)&&l.previousSibling,h=(u=(i||n)&&l.nextSibling)&&A(u)?new T(u,0):p&&A(p)?new T(p,p.data.length):new T(o,k.getNodeIndex(l));return l.parentNode.removeChild(l),{boundaryPosition:h,nodeInfo:{nodeIndex:y,containerElement:o}}},a=function(t,e){var n,i,s,r,o=t.offset,a=k.getDocument(t.node),l=g(a).createTextRange(),c=A(t.node);return c?i=(n=t.node).parentNode:(n=o<(r=t.node.childNodes).length?r[o]:null,i=t.node),(s=a.createElement("span")).innerHTML="&#feff;",n?i.insertBefore(s,n):i.appendChild(s),l.moveToElementText(s),l.collapse(!e),i.removeChild(s),c&&l[e?"moveStart":"moveEnd"]("character",o),l};(t=function(t){this.textRange=t,this.refresh()}).prototype=new m(document),t.prototype.refresh=function(){var t,e,n,i=s(this.textRange);r(this.textRange)?e=t=o(this.textRange,i,!0,!0).boundaryPosition:(t=(n=o(this.textRange,i,!0,!1)).boundaryPosition,e=o(this.textRange,i,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(t.node,t.offset),this.setEnd(e.node,e.offset)},t.prototype.getName=function(){return"WrappedTextRange"},m.copyComparisonConstants(t);var y=function(t){if(t.collapsed)return a(new T(t.startContainer,t.startOffset),!0);var e=a(new T(t.startContainer,t.startOffset),!0),n=a(new T(t.endContainer,t.endOffset),!1),i=g(m.getRangeDocument(t)).createTextRange();return i.setEndPoint("StartToStart",e),i.setEndPoint("EndToEnd",n),i};if(t.rangeToTextRange=y,t.prototype.toTextRange=function(){return y(this)},u.WrappedTextRange=t,!u.features.implementsDomRange||u.config.preferTextRange){var e=Function("return this;")();"undefined"==typeof e.Range&&(e.Range=t),u.createNativeRange=function(t){return t=v(t,h,"createNativeRange"),g(t).createTextRange()},u.WrappedRange=t}}u.createRange=function(t){return t=v(t,h,"createRange"),new u.WrappedRange(u.createNativeRange(t))},u.createRangyRange=function(t){return t=v(t,h,"createRangyRange"),new m(t)},u.createIframeRange=function(t){return h.deprecationNotice("createIframeRange()","createRange(iframeEl)"),u.createRange(t)},u.createIframeRangyRange=function(t){return h.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),u.createRangyRange(t)},u.addShimListener(function(t){var e=t.document;"undefined"==typeof e.createRange&&(e.createRange=function(){return u.createRange(e)}),e=t=null})}),O.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(h,l){function r(t){return"string"==typeof t?/^backward(s)?$/i.test(t):!!t}function s(t,e){if(t){if(j.isWindow(t))return t;if(t instanceof b)return t.win;var n=j.getContentDocument(t,l,e);return j.getWindow(n)}return window}function t(t){return s(t,"getWinSelection").getSelection()}function o(t){return s(t,"getDocSelection").document.selection}function d(t){var e=!1;return t.anchorNode&&(e=1==j.comparePoints(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)),e}function a(t,e,n){var i=n?"end":"start",s=n?"start":"end";t.anchorNode=e[i+"Container"],t.anchorOffset=e[i+"Offset"],t.focusNode=e[s+"Container"],t.focusOffset=e[s+"Offset"]}function c(t){var e=t.nativeSelection;t.anchorNode=e.anchorNode,t.anchorOffset=e.anchorOffset,t.focusNode=e.focusNode,t.focusOffset=e.focusOffset}function p(t){t.anchorNode=t.focusNode=null,t.anchorOffset=t.focusOffset=0,t.rangeCount=0,t.isCollapsed=!0,t._ranges.length=0}function u(t){var e;return t instanceof E?((e=h.createNativeRange(t.getDocument())).setEnd(t.endContainer,t.endOffset),e.setStart(t.startContainer,t.startOffset)):t instanceof D?e=t.nativeRange:R.implementsDomRange&&t instanceof j.getWindow(t.startContainer).Range&&(e=t),e}function n(t){if(!t.length||1!=t[0].nodeType)return!1;for(var e=1,n=t.length;e<n;++e)if(!j.isAncestorOf(t[0],t[e]))return!1;return!0}function f(t){var e=t.getNodes();if(!n(e))throw l.createError("getSingleElementFromRange: range "+t.inspect()+" did not consist of a single element");return e[0]}function m(t){return!!t&&"undefined"!=typeof t.text}function g(t,e){var n=new D(e);t._ranges=[n],a(t,n,!1),t.rangeCount=1,t.isCollapsed=n.collapsed}function v(t){if(t._ranges.length=0,"None"==t.docSelection.type)p(t);else{var e=t.docSelection.createRange();if(m(e))g(t,e);else{t.rangeCount=e.length;for(var n,i=$(e.item(0)),s=0;s<t.rangeCount;++s)(n=h.createRange(i)).selectNode(e.item(s)),t._ranges.push(n);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,a(t,t._ranges[t.rangeCount-1],!1)}}}function y(t,e){for(var n=t.docSelection.createRange(),i=f(e),s=$(n.item(0)),r=L(s).createControlRange(),o=0,a=n.length;o<a;++o)r.add(n.item(o));try{r.add(i)}catch(p){throw l.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}r.select(),v(t)}function b(t,e,n){this.nativeSelection=t,this.docSelection=e,this._ranges=[],this.win=n,this.refresh()}function _(t){t.win=t.anchorNode=t.focusNode=t._ranges=null,t.rangeCount=t.anchorOffset=t.focusOffset=0,t.detached=!0}function w(t,e){for(var n,i,s=et.length;s--;)if(i=(n=et[s]).selection,"deleteAll"==e)_(i);else if(n.win==t)return"delete"==e?(et.splice(s,1),!0):i;return"deleteAll"==e&&(et.length=0),null}function i(t,e){for(var n,i=$(e[0].startContainer),s=L(i).createControlRange(),r=0,o=e.length;r<o;++r){n=f(e[r]);try{s.add(n)}catch(c){throw l.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}s.select(),v(t)}function k(t,e){if(t.win.document!=$(e))throw new O("WRONG_DOCUMENT_ERR")}function e(i){return function(t,e){var n;this.rangeCount?(n=this.getRangeAt(0))["set"+(i?"Start":"End")](t,e):(n=h.createRange(this.win.document)).setStartAndEnd(t,e),this.setSingleRange(n,this.isBackward())}}function T(t){var e=[],n=new N(t.anchorNode,t.anchorOffset),i=new N(t.focusNode,t.focusOffset),s="function"==typeof t.getName?t.getName():"Selection";if("undefined"!=typeof t.rangeCount)for(var r=0,o=t.rangeCount;r<o;++r)e[r]=E.inspect(t.getRangeAt(r));return"["+s+"(Ranges: "+e.join(", ")+")(anchor: "+n.inspect()+", focus: "+i.inspect()+"]"}h.config.checkSelectionRanges=!0;var A,S,C="boolean",x="number",j=h.dom,P=h.util,I=P.isHostMethod,E=h.DomRange,D=h.WrappedRange,O=h.DOMException,N=j.DomPosition,R=h.features,M="Control",$=j.getDocument,L=j.getBody,U=E.rangesEqual,z=I(window,"getSelection"),B=P.isHostObject(document,"selection");R.implementsWinGetSelection=z;var F=(R.implementsDocSelection=B)&&(!z||h.config.preferTextRange);F?(A=o,h.isSelectionValid=function(t){var e=s(t,"isSelectionValid").document,n=e.selection;return"None"!=n.type||$(n.createRange().parentElement())==e}):z?(A=t,h.isSelectionValid=function(){return!0}):l.fail("Neither document.selection or window.getSelection() detected.");var q=(h.getNativeSelection=A)(),J=h.createNativeRange(document),H=L(document),W=P.areHostProperties(q,["anchorNode","focusNode","anchorOffset","focusOffset"]);R.selectionHasAnchorAndFocus=W;var G=I(q,"extend");R.selectionHasExtend=G;var K=typeof q.rangeCount==x;R.selectionHasRangeCount=K;var V=!1,Y=!0,X=G?function(t,e){var n=E.getRangeDocument(e),i=h.createRange(n);i.collapseToPoint(e.endContainer,e.endOffset),t.addRange(u(i)),t.extend(e.startContainer,e.startOffset)}:null;P.areHostMethods(q,["addRange","getRangeAt","removeAllRanges"])&&typeof q.rangeCount==x&&R.implementsDomRange&&function(){var t=window.getSelection();if(t){for(var e=t.rangeCount,n=1<e,i=[],s=d(t),r=0;r<e;++r)i[r]=t.getRangeAt(r);var o=L(document),a=o.appendChild(document.createElement("div"));a.contentEditable="false";var l=a.appendChild(document.createTextNode("\xa0\xa0\xa0")),c=document.createRange();if(c.setStart(l,1),c.collapse(!0),t.addRange(c),Y=1==t.rangeCount,t.removeAllRanges(),!n){var p=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(p&&36<=parseInt(p[1]))V=!1;else{var u=c.cloneRange();c.setStart(l,0),u.setEnd(l,3),u.setStart(l,2),t.addRange(c),t.addRange(u),V=2==t.rangeCount}}for(o.removeChild(a),t.removeAllRanges(),r=0;r<e;++r)0==r&&s?X?X(t,i[r]):(h.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(i[r])):t.addRange(i[r])}}(),R.selectionSupportsMultipleRanges=V,R.collapsedNonEditableSelectionsSupported=Y;var Z,Q,tt=!1;H&&I(H,"createControlRange")&&(Z=H.createControlRange(),P.areHostProperties(Z,["item","add"])&&(tt=!0)),R.implementsControlRange=tt,S=W?function(t){return t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset}:function(t){return!!t.rangeCount&&t.getRangeAt(t.rangeCount-1).collapsed},I(q,"getRangeAt")?Q=function(t,e){try{return t.getRangeAt(e)}catch(r){return null}}:W&&(Q=function(t){var e=$(t.anchorNode),n=h.createRange(e);return n.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),n.collapsed!==this.isCollapsed&&n.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),n}),b.prototype=h.selectionPrototype;var et=[
],nt=function(t){if(t&&t instanceof b)return t.refresh(),t;var e=w(t=s(t,"getNativeSelection")),n=A(t),i=B?o(t):null;return e?(e.nativeSelection=n,e.docSelection=i,e.refresh()):(e=new b(n,i,t),et.push({win:t,selection:e})),e};h.getSelection=nt,h.getIframeSelection=function(t){return l.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),h.getSelection(j.getIframeWindow(t))};var it,st=b.prototype;if(!F&&W&&P.areHostMethods(q,["removeAllRanges","addRange"])){st.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),p(this)};var rt=function(t,e){X(t.nativeSelection,e),t.refresh()};st.addRange=K?function(t,e){if(tt&&B&&this.docSelection.type==M)y(this,t);else if(r(e)&&G)rt(this,t);else{var n;V?n=this.rangeCount:(this.removeAllRanges(),n=0);var i=u(t).cloneRange();try{this.nativeSelection.addRange(i)}catch(d){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==n+1){if(h.config.checkSelectionRanges){var s=Q(this.nativeSelection,this.rangeCount-1);s&&!U(s,t)&&(t=new D(s))}this._ranges[this.rangeCount-1]=t,a(this,t,ot(this.nativeSelection)),this.isCollapsed=S(this)}else this.refresh()}}:function(t,e){r(e)&&G?rt(this,t):(this.nativeSelection.addRange(u(t)),this.refresh())},st.setRanges=function(t){if(tt&&B&&1<t.length)i(this,t);else{this.removeAllRanges();for(var e=0,n=t.length;e<n;++e)this.addRange(t[e])}}}else{if(!(I(q,"empty")&&I(J,"select")&&tt&&F))return l.fail("No means of selecting a Range or TextRange was found"),!1;st.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var t;if(this.anchorNode)t=$(this.anchorNode);else if(this.docSelection.type==M){var e=this.docSelection.createRange();e.length&&(t=$(e.item(0)))}if(t)L(t).createTextRange().select(),this.docSelection.empty()}}catch(s){}p(this)},st.addRange=function(t){this.docSelection.type==M?y(this,t):(h.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,a(this,t,!1))},st.setRanges=function(t){this.removeAllRanges();var e=t.length;1<e?i(this,t):e&&this.addRange(t[0])}}if(st.getRangeAt=function(t){if(t<0||t>=this.rangeCount)throw new O("INDEX_SIZE_ERR");return this._ranges[t].cloneRange()},F)it=function(t){var e;h.isSelectionValid(t.win)?e=t.docSelection.createRange():(e=L(t.win.document).createTextRange()).collapse(!0),t.docSelection.type==M?v(t):m(e)?g(t,e):p(t)};else if(I(q,"getRangeAt")&&typeof q.rangeCount==x)it=function(t){if(tt&&B&&t.docSelection.type==M)v(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var e=0,n=t.rangeCount;e<n;++e)t._ranges[e]=new h.WrappedRange(t.nativeSelection.getRangeAt(e));a(t,t._ranges[t.rangeCount-1],ot(t.nativeSelection)),t.isCollapsed=S(t)}else p(t)};else{if(!W||typeof q.isCollapsed!=C||typeof J.collapsed!=C||!R.implementsDomRange)return l.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;it=function(t){var e,n=t.nativeSelection;n.anchorNode?(e=Q(n,0),t._ranges=[e],t.rangeCount=1,c(t),t.isCollapsed=S(t)):p(t)}}st.refresh=function(t){var e=t?this._ranges.slice(0):null,n=this.anchorNode,i=this.anchorOffset;if(it(this),t){var s=e.length;if(s!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=i)return!0;for(;s--;)if(!U(e[s],this._ranges[s]))return!0;return!1}};var ot,at=function(t,e){var n=t.getAllRanges();t.removeAllRanges();for(var i=0,s=n.length;i<s;++i)U(e,n[i])||t.addRange(n[i]);t.rangeCount||p(t)};st.removeRange=tt&&B?function(t){if(this.docSelection.type==M){for(var e=this.docSelection.createRange(),n=f(t),i=$(e.item(0)),s=L(i).createControlRange(),r=!1,o=0,a=e.length;o<a;++o)e.item(o)!==n||r?s.add(e.item(o)):r=!0;s.select(),v(this)}else at(this,t)}:function(t){at(this,t)},!F&&W&&R.implementsDomRange?(ot=d,st.isBackward=function(){return ot(this)}):ot=st.isBackward=function(){return!1},st.isBackwards=st.isBackward,st.toString=function(){for(var t=[],e=0,n=this.rangeCount;e<n;++e)t[e]=""+this._ranges[e];return t.join("")},st.collapse=function(t,e){k(this,t);var n=h.createRange(t);n.collapseToPoint(t,e),this.setSingleRange(n),this.isCollapsed=!0},st.collapseToStart=function(){if(!this.rangeCount)throw new O("INVALID_STATE_ERR");var t=this._ranges[0];this.collapse(t.startContainer,t.startOffset)},st.collapseToEnd=function(){if(!this.rangeCount)throw new O("INVALID_STATE_ERR");var t=this._ranges[this.rangeCount-1];this.collapse(t.endContainer,t.endOffset)},st.selectAllChildren=function(t){k(this,t);var e=h.createRange(t);e.selectNodeContents(t),this.setSingleRange(e)},st.deleteFromDocument=function(){if(tt&&B&&this.docSelection.type==M){for(var t,e=this.docSelection.createRange();e.length;)t=e.item(0),e.remove(t),t.parentNode.removeChild(t);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var i=0,s=n.length;i<s;++i)n[i].deleteContents();this.addRange(n[s-1])}}},st.eachRange=function(t,e){for(var n=0,i=this._ranges.length;n<i;++n)if(t(this.getRangeAt(n)))return e},st.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},st.setSingleRange=function(t,e){this.removeAllRanges(),this.addRange(t,e)},st.callMethodOnEachRange=function(e,n){var i=[];return this.eachRange(function(t){i.push(t[e].apply(t,n))}),i},st.setStart=e(!0),st.setEnd=e(!1),h.rangePrototype.select=function(t){nt(this.getDocument()).setSingleRange(this,t)},st.changeEachRange=function(e){var n=[],t=this.isBackward();this.eachRange(function(t){e(t),n.push(t)}),this.removeAllRanges(),t&&1==n.length?this.addRange(n[0],"backward"):this.setRanges(n)},st.containsNode=function(e,n){return this.eachRange(function(t){return t.containsNode(e,n)},!0)||!1},st.getBookmark=function(t){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[t])}},st.moveToBookmark=function(t){for(var e,n,i=[],s=0;e=t.rangeBookmarks[s++];)(n=h.createRange(this.win)).moveToBookmark(e),i.push(n);t.backward?this.setSingleRange(i[0],"backward"):this.setRanges(i)},st.toHtml=function(){var e=[];return this.eachRange(function(t){e.push(E.toHtml(t))}),e.join("")},R.implementsTextRange&&(st.getNativeTextRange=function(){var t;if(t=this.docSelection){var e=t.createRange();if(m(e))return e;throw l.createError("getNativeTextRange: selection is a control selection")}if(0<this.rangeCount)return h.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw l.createError("getNativeTextRange: selection contains no range")}),st.getName=function(){return"WrappedSelection"},st.inspect=function(){return T(this)},st.detach=function(){w(this.win,"delete"),_(this)},b.detachAll=function(){w(null,"deleteAll")},b.inspect=T,b.isDirectionBackward=r,h.Selection=b,h.selectionPrototype=st,h.addShimListener(function(t){"undefined"==typeof t.getSelection&&(t.getSelection=function(){return nt(t)}),t=null})});var M=!1,$=function(){M||(M=!0,!O.initialized&&O.config.autoInitialize&&r())};return E&&("complete"==document.readyState?$():(l(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",$,!1),y(window,"load",$))),O},this),function(t,e){"function"==typeof define&&define.amd?define(["./rangy-core"],t):void 0!==module&&"object"==typeof exports?module.exports=t(require("rangy")):t(e.rangy)}(function(t){return t.createModule("ClassApplier",["WrappedSelection"],function(s,u){function h(t,e){for(var n in t)if(t.hasOwnProperty(n)&&!1===e(n,t[n]))return!1;return!0}function d(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function f(t){return t&&t.split(/\s+/).sort().join(" ")}function n(t){return f(t.className)}function r(t,e){return n(t)==n(e)}function o(t,e){for(var n=e.split(/\s+/),i=0,s=n.length;i<s;++i)if(!D(t,d(n[i])))return!1;return!0}function a(t,e,n,i,s){var r=t.node,o=t.offset,a=r,l=o;r==i&&s<o&&++l,r!=e||o!=n&&o!=n+1||(a=i,l+=s-n),r==e&&n+1<o&&--l,t.node=a,t.offset=l}function l(t,e,n){t.node==e&&t.offset>n&&--t.offset}function m(t,e,n,i){-1==n&&(n=e.childNodes.length);var s=t.parentNode,r=R.getNodeIndex(t);U(i,function(t){a(t,s,r,e,n)}),e.childNodes.length==n?e.appendChild(t):e.insertBefore(t,e.childNodes[n])}function c(t,e){var n=t.parentNode,i=R.getNodeIndex(t);U(e,function(t){l(t,n,i)}),t.parentNode.removeChild(t)}function p(t,e,n,i,s){for(var r,o=[];r=t.firstChild;)m(r,e,n++,s),o.push(r);return i&&c(t,s),o}function g(t,e){return p(t,t.parentNode,R.getNodeIndex(t),!0,e)}function v(t,e){var n=t.cloneRange();n.selectNodeContents(e);var i=n.intersection(t);return""!=(i?i.toString():"")}function y(t){for(var e,n=t.getNodes([3]),i=0;(e=n[i])&&!v(t,e);)++i;for(var s=n.length-1;(e=n[s])&&!v(t,e);)--s;return n.slice(i,s+1)}function b(t,e){if(t.attributes.length!=e.attributes.length)return!1;for(var n,i,s,r=0,o=t.attributes.length;r<o;++r)if("class"!=(s=(n=t.attributes[r]).name)){if(null===n!=(null===(i=e.attributes.getNamedItem(s))))return!1;if(n.specified!=i.specified)return!1;if(n.specified&&n.nodeValue!==i.nodeValue)return!1}return!0}function e(t,e){for(var n,i=0,s=t.attributes.length;i<s;++i)if(n=t.attributes[i].name,(!e||!$(e,n))&&t.attributes[i].specified&&"class"!=n)return!0;return!1}function _(t){var e;return t&&1==t.nodeType&&((e=t.parentNode)&&9==e.nodeType&&"on"==e.designMode||F(t)&&!F(t.parentNode))}function w(t){return(F(t)||1!=t.nodeType&&F(t.parentNode))&&!_(t)}function k(t){return t&&1==t.nodeType&&!q.test(B(t,"display"))}function T(t){if(0==t.data.length)return!0;if(J.test(t.data))return!1;switch(B(t.parentNode,"whiteSpace")){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(t.data))return!1}return k(t.previousSibling)||k(t.nextSibling)}function A(t){var e,n,i=[];for(e=0;n=t[e++];)i.push(new M(n.startContainer,n.startOffset),new M(n.endContainer,n.endOffset));return i}function S(t,e){for(var n,i,s,r=0,o=t.length;r<o;++r)n=t[r],i=e[2*r],s=e[2*r+1],n.setStartAndEnd(i.node,i.offset,s.node,s.offset)}function C(t,e){return R.isCharacterDataNode(t)?0==e?!!t.previousSibling:e!=t.length||!!t.nextSibling:0<e&&e<t.childNodes.length}function x(t,e,n,i){var s,r,o=0==n;if(R.isAncestorOf(e,t))return t;if(R.isCharacterDataNode(e)){var a=R.getNodeIndex(e);if(0==n)n=a;else{if(n!=e.length)throw u.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+n+" in "+e.data);n=a+1}e=e.parentNode}if(C(e,n)){s=e.cloneNode(!1),r=e.parentNode,s.id&&s.removeAttribute("id");for(var l,c=0;l=e.childNodes[n];)m(l,s,c++,i);return m(s,r,R.getNodeIndex(e)+1,i),e==t?s:x(t,r,R.getNodeIndex(s),i)}if(t==e)return t;s=e.parentNode;var p=R.getNodeIndex(e);return o||p++,x(t,s,p,i)}function j(t,e){return t.namespaceURI==e.namespaceURI&&t.tagName.toLowerCase()==e.tagName.toLowerCase()&&r(t,e)&&b(t,e)&&"inline"==B(t,"display")&&"inline"==B(e,"display")}function t(r){var o=r?"nextSibling":"previousSibling";return function(t,e){var n=t.parentNode,i=t[o];if(i){if(i&&3==i.nodeType)return i}else if(e&&((i=n[o])&&1==i.nodeType&&j(n,i))){var s=i[r?"firstChild":"lastChild"];if(s&&3==s.nodeType)return s}return null}}function P(t){this.isElementMerge=1==t.nodeType,this.textNodes=[];var e=this.isElementMerge?t.lastChild:t;e&&(this.textNodes[0]=e)}function I(t,e,n){var i,s,r,o,a=this;a.cssClass=a.className=t;var l=null,c={};if("object"==typeof e&&null!==e){for("undefined"!=typeof e.elementTagName&&(e.elementTagName=e.elementTagName.toLowerCase()),n=e.tagNames,l=e.elementProperties,c=e.elementAttributes,s=0;o=G[s++];)e.hasOwnProperty(o)&&(a[o]=e[o]);i=e.normalize}else i=e;a.normalize=void 0===i||i,a.attrExceptions=[];var p=document.createElement(a.elementTagName);a.elementProperties=a.copyPropertiesToElement(l,p,!0),h(c,function(t){a.attrExceptions.push(t)}),a.elementAttributes=c,a.elementSortedClassName=a.elementProperties.hasOwnProperty("className")?f(a.elementProperties.className+" "+t):t,a.applyToAnyTagName=!1;var u=typeof n;if("string"==u)"*"==n?a.applyToAnyTagName=!0:a.tagNames=d(n.toLowerCase()).split(/\s*,\s*/);else if("object"==u&&"number"==typeof n.length)for(a.tagNames=[],s=0,r=n.length;s<r;++s)"*"==n[s]?a.applyToAnyTagName=!0:a.tagNames.push(n[s].toLowerCase());else a.tagNames=[a.elementTagName]}function E(t,e,n){return new I(t,e,n)}var D,O,N,R=s.dom,M=R.DomPosition,$=R.arrayContains,L=R.isHtmlNamespace,U=s.util.forEach,z="span";s.util.isHostObject(document.createElement("div"),"classList")?(D=function(t,e){return t.classList.contains(e)},O=function(t,e){return t.classList.add(e)},N=function(t,e){return t.classList.remove(e)}):(D=function(t,e){return t.className&&new RegExp("(?:^|\\s)"+e+"(?:\\s|$)").test(t.className)},O=function(t,e){t.className?D(t,e)||(t.className+=" "+e):t.className=e},N=function(){function n(t,e,n){return e&&n?" ":""}return function(t,e){t.className&&(t.className=t.className.replace(new RegExp("(^|\\s)"+e+"(\\s|$)"),n))}}());var B=R.getComputedStyleProperty,F="boolean"==typeof document.createElement("div").isContentEditable?function(t){return t&&1==t.nodeType&&t.isContentEditable}:function(t){return!(!t||1!=t.nodeType||"false"==t.contentEditable)&&("true"==t.contentEditable||F(t.parentNode))},q=/^inline(-block|-table)?$/i,J=/[^\r\n\t\f \u200B]/,H=t(!1),W=t(!0);P.prototype={doMerge:function(t){var e=this.textNodes,i=e[0];if(1<e.length){var s,r=R.getNodeIndex(i),o=[],a=0;U(e,function(e,n){s=e.parentNode,0<n&&(s.removeChild(e),s.hasChildNodes()||s.parentNode.removeChild(s),t&&U(t,function(t){t.node==e&&(t.node=i,t.offset+=a),t.node==s&&t.offset>r&&(--t.offset,t.offset==r+1&&len-1>n&&(t.node=i,t.offset=a))})),o[n]=e.data,a+=e.data.length}),i.data=o.join("")}return i.data},getLength:function(){for(var t=this.textNodes.length,e=0;t--;)e+=this.textNodes[t].length;return e},toString:function(){var n=[];return U(this.textNodes,function(t,e){n[e]="'"+t.data+"'"}),"[Merge("+n.join(",")+")]"}};var G=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],K={};I.prototype={elementTagName:z,elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(t,e,n){var i,s,r,o,a,l,c={};for(var p in t)if(t.hasOwnProperty(p))if(o=t[p],a=e[p],"className"==p)O(e,o),O(e,this.className),e[p]=f(e[p]),n&&(c[p]=o);else if("style"==p){for(i in s=a,n&&(c[p]=r={}),t[p])t[p].hasOwnProperty(i)&&(s[i]=o[i],n&&(r[i]=s[i]));this.attrExceptions.push(p)}else e[p]=o,n&&(c[p]=e[p],l=K.hasOwnProperty(p)?K[p]:p,this.attrExceptions.push(l));return n?c:""},copyAttributesToElement:function(t,e){for(var n in t)t.hasOwnProperty(n)&&!/^class(?:Name)?$/i.test(n)&&e.setAttribute(n,t[n])},appliesToElement:function(t){return $(this.tagNames,t.tagName.toLowerCase())},getEmptyElements:function(t){var e=this;return t.getNodes([1],function(t){return e.appliesToElement(t)&&!t.hasChildNodes()})},hasClass:function(t){return 1==t.nodeType&&(this.applyToAnyTagName||this.appliesToElement(t))&&D(t,this.className)},getSelfOrAncestorWithClass:function(t){for(;t;){if(this.hasClass(t))return t;t=t.parentNode}return null},isModifiable:function(t){return!this.applyToEditableOnly||w(t)},isIgnorableWhiteSpaceNode:function(t){return this.ignoreWhiteSpace&&t&&3==t.nodeType&&T(t)},postApply:function(t,e,n,s){var r,o,a=t[0],l=t[t.length-1],c=[],p=a,u=l,h=0,d=l.length;U(t,function(t){(o=H(t,!s))?(r||(r=new P(o),c.push(r)),r.textNodes.push(t),t===a&&(p=r.textNodes[0],h=p.length),t===l&&(u=r.textNodes[0],d=r.getLength())):r=null});var f=W(l,!s);if(f&&(r||(r=new P(l),c.push(r)),r.textNodes.push(f)),c.length){for(i=0,len=c.length;len>i;++i)c[i].doMerge(n);e.setStartAndEnd(p,h,u,d)}},createContainer:function(t){var e=t.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,e,!1),this.copyAttributesToElement(this.elementAttributes,e),O(e,this.className),this.onElementCreate&&this.onElementCreate(e,this),e},elementHasProperties:function(n,t){var i=this;return h(t,function(t,e){if("className"==t)return o(n,e);if("object"==typeof e){if(!i.elementHasProperties(n[t],e))return!1}else if(n[t]!==e)return!1})},elementHasAttributes:function(n,t){return h(t,function(t,e){return n.getAttribute(t)===e&&void 0})},applyToTextNode:function(t){var e=t.parentNode;if(1==e.childNodes.length&&this.useExistingElements&&L(e)&&this.appliesToElement(e)&&this.elementHasProperties(e,this.elementProperties)&&this.elementHasAttributes(e,this.elementAttributes))O(e,this.className);else{var n=this.createContainer(R.getDocument(t));t.parentNode.insertBefore(n,t),n.appendChild(t)}},isRemovable:function(t){return L(t)&&t.tagName.toLowerCase()==this.elementTagName&&n(t)==this.elementSortedClassName&&this.elementHasProperties(t,this.elementProperties)&&!e(t,this.attrExceptions)&&this.elementHasAttributes(t,this.elementAttributes)&&this.isModifiable(t)},isEmptyContainer:function(t){var e=t.childNodes.length;return 1==t.nodeType&&this.isRemovable(t)&&(0==e||1==e&&this.isEmptyContainer(t.firstChild))},removeEmptyContainers:function(t){var e=this,n=t.getNodes([1],function(t){return e.isEmptyContainer(t)}),i=[t],s=A(i);U(n,function(t){c(t,s)}),S(i,s)},undoToTextNode:function(t,e,n,i){if(!e.containsNode(n)){var s=e.cloneRange();s.selectNode(n),s.isPointInRange(e.endContainer,e.endOffset)&&(x(n,e.endContainer,e.endOffset,i),e.setEndAfter(n)),s.isPointInRange(e.startContainer,e.startOffset)&&(n=x(n,e.startContainer,e.startOffset,i))}this.isRemovable(n)?g(n,i):N(n,this.className)},splitAncestorWithClass:function(t,e,n){var i=this.getSelfOrAncestorWithClass(t);i&&x(i,t,e,n)},undoToAncestor:function(t,e){this.isRemovable(t)?g(t,e):N(t,this.className)},applyToRange:function(t,e){var n=this,i=A((e=e||[])||[]);t.splitBoundariesPreservingPositions(i),n.removeEmptyElements&&n.removeEmptyContainers(t);var s=y(t);if(s.length){U(s,function(t){n.isIgnorableWhiteSpaceNode(t)||n.getSelfOrAncestorWithClass(t)||!n.isModifiable(t)||n.applyToTextNode(t,i)});var r=s[s.length-1];t.setStartAndEnd(s[0],0,r,r.length),n.normalize&&n.postApply(s,t,i,!1),S(e,i)}var o=n.getEmptyElements(t);U(o,function(t){O(t,n.className)})},applyToRanges:function(t){for(var e=t.length;e--;)this.applyToRange(t[e],t);return t},applyToSelection:function(t){var e=s.getSelection(t);e.setRanges(this.applyToRanges(e.getAllRanges()))},undoToRange:function(t,e){var n=this,i=A(e=e||[]);t.splitBoundariesPreservingPositions(i),n.removeEmptyElements&&n.removeEmptyContainers(t,i);var s,r,o=y(t),a=o[o.length-1];if(o.length){n.splitAncestorWithClass(t.endContainer,t.endOffset,i),n.splitAncestorWithClass(t.startContainer,t.startOffset,i);for(var l=0,c=o.length;l<c;++l)s=o[l],(r=n.getSelfOrAncestorWithClass(s))&&n.isModifiable(s)&&n.undoToAncestor(r,i);t.setStartAndEnd(o[0],0,a,a.length),n.normalize&&n.postApply(o,t,i,!0),S(e,i)}var p=n.getEmptyElements(t);U(p,function(t){N(t,n.className)})},undoToRanges:function(t){for(var e=t.length;e--;)this.undoToRange(t[e],t);return t},undoToSelection:function(t){var e=s.getSelection(t),n=s.getSelection(t).getAllRanges();this.undoToRanges(n),e.setRanges(n)},isAppliedToRange:function(t){if(t.collapsed||""==t.toString())return!!this.getSelfOrAncestorWithClass(t.commonAncestorContainer);var e=t.getNodes([3]);if(e.length)for(var n,i=0;n=e[i++];)if(!this.isIgnorableWhiteSpaceNode(n)&&v(t,n)&&this.isModifiable(n)&&!this.getSelfOrAncestorWithClass(n))return!1;return!0},isAppliedToRanges:function(t){var e=t.length;if(0==e)return!1;for(;e--;)if(!this.isAppliedToRange(t[e]))return!1;return!0},isAppliedToSelection:function(t){var e=s.getSelection(t);return this.isAppliedToRanges(e.getAllRanges())},toggleRange:function(t){this.isAppliedToRange(t)?this.undoToRange(t):this.applyToRange(t)},toggleSelection:function(t){this.isAppliedToSelection(t)?this.undoToSelection(t):this.applyToSelection(t)},getElementsWithClassIntersectingRange:function(t){var n=[],i=this;return t.getNodes([3],function(t){var e=i.getSelfOrAncestorWithClass(t);e&&!$(n,e)&&n.push(e)}),n},detach:function(){}},I.util={hasClass:D,addClass:O,removeClass:N,hasSameClasses:r,hasAllClasses:o,replaceWithOwnChildren:g,elementsHaveSameNonClassAttributes:b,elementHasNonClassAttributes:e,splitNodeAt:x,isEditableElement:F,isEditingHost:_,isEditable:w},s.CssClassApplier=s.ClassApplier=I,s.createCssClassApplier=s.createClassApplier=E}),t},this),function(t,e){"function"==typeof define&&define.amd?define(["./rangy-core"],t):void 0!==module&&"object"==typeof exports?module.exports=t(require("rangy")):t(e.rangy)}(function(t){return t.createModule("TextRange",["WrappedSelection"],function(h,c){function t(a,t){function e(t,e,n){for(var i=a.slice(t,e),s={isWord:n,chars:i,toString:function(){return i.join("")}},r=0,o=i.length;r<o;++r)i[r].token=s;l.push(s)}for(var n,i,s,r=a.join(""),l=[],o=0;n=t.wordRegex.exec(r);){if(s=(i=n.index)+n[0].length,o<i&&e(o,i,!1),t.includeTrailingSpace)for(;Y.test(a[s]);)++s;e(i,s,!0),o=s}return o<a.length&&e(o,a.length,!1),l}function d(t){var e=t||"",n="string"==typeof e?e.split(""):e;return n.sort(function(t,e){return t.charCodeAt(0)-e.charCodeAt(0)}),n.join("").replace(/(.)\1+/g,"$1")}function i(t){var e,n;return t?(e=t.language||X,J(n={},at[e]||at[X]),J(n,t),n):at[X]}function f(t,e){var n=H(t,e);return e.hasOwnProperty("wordOptions")&&(n.wordOptions=i(n.wordOptions)),e.hasOwnProperty("characterOptions")&&(n.characterOptions=H(n.characterOptions,rt)),n}function s(t,e){var n=ht(t,"display",e),i=t.tagName.toLowerCase();return"block"==n&&nt&&dt.hasOwnProperty(i)?dt[i]:n}function n(t){for(var e=l(t),n=0,i=e.length;n<i;++n)if(1==e[n].nodeType&&"none"==s(e[n]))return!0;return!1}function r(t){var e;return 3==t.nodeType&&(e=t.parentNode)&&"hidden"==ht(e,"visibility")}function e(t){return t&&(1==t.nodeType&&!/^(inline(-block|-table)?|none)$/.test(s(t))||9==t.nodeType||11==t.nodeType)}function o(t){return F.isCharacterDataNode(t)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(t.nodeName)}function a(t){for(var e=[];t.parentNode;)e.unshift(t.parentNode),t=t.parentNode;return e}function l(t){return a(t).concat([t])}function p(t){for(;t&&!t.nextSibling;)t=t.parentNode;return t?t.nextSibling:null}function u(t,e){return!e&&t.hasChildNodes()?t.firstChild:p(t)}function m(t){var e=t.previousSibling;if(e){for(t=e;t.hasChildNodes();)t=t.lastChild;return t}var n=t.parentNode;return n&&1==n.nodeType?n:null}function g(t){if(!t||3!=t.nodeType)return!1;var e=t.data;if(""===e)return!0;var n=t.parentNode;if(!n||1!=n.nodeType)return!1;var i=ht(t.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(e)&&/^(normal|nowrap)$/.test(i)||/^[\t\r ]+$/.test(e)&&"pre-line"==i}function v(t){return""===t.data||!!g(t)&&(!t.parentNode||!!n(t))}function y(t){var e=t.nodeType;return 7==e||8==e||n(t)||/^(script|style)$/i.test(t.nodeName)||r(t)||v(t)}function b(t,e){var n=t.nodeType;return 7==n||8==n||1==n&&"none"==s(t,e)}function _(){this.store={}}function w(i,s,r){return function(t){var e=this.cache;if(e.hasOwnProperty(i))return 0,e[i];0;var n=s.call(this,r?this[r]:this,t);return e[i]=n}}function k(t,e){this.node=t,this.session=e,this.cache=new _,this.positions=new _}function T(t,e){this.offset=e,this.nodeWrapper=t,this.node=t.node,this.session=t.session,this.cache=new _}function A(){return"[Position("+F.inspectNode(this.node)+":"+this.offset+")]"}function S(){return x(),St=new Ct}function C(){return St||S()}function x(){St&&St.detach(),St=null}function j(t,e,n,i){function s(){var t=null;return e?(t=o,a||(o=o.previousVisible(),a=!o||n&&o.equals(n))):a||(t=o=o.nextVisible(),a=!o||n&&o.equals(n)),a&&(o=null),t}n&&(e?y(n.node)&&(n=t.previousVisible()):y(n.node)&&(n=n.nextVisible()));var r,o=t,a=!1,l=!1;return{next:function(){if(l)return l=!1,r;for(var t;t=s();)if(t.getCharacter(i))return r=t;return null},rewind:function(){if(!r)throw c.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");l=!0},dispose:function(){t=n=null}}}function P(t,e,n){function i(t){for(var e,n,i=[],s=t?a:l,r=!1,o=!1;e=s.next();){if(n=e.character,V.test(n))o&&(r=!(o=!1));else{if(r){s.rewind();break}o=!0}i.push(e)}return i}var a=j(t,!1,null,e),l=j(t,!0,null,e),s=n.tokenizer,r=i(!0),o=i(!1).reverse(),c=s(o.concat(r),n),p=r.length?c.slice(xt(c,r[0].token)):[],u=o.length?c.slice(0,xt(c,o.pop().token)+1):[];return{nextEndToken:function(){for(var t,e;1==p.length&&!(t=p[0]).isWord&&0<(e=i(!0)).length;)p=s(t.chars.concat(e),n);return p.shift()},previousStartToken:function(){for(var t,e;1==u.length&&!(t=u[0]).isWord&&0<(e=i(!1)).length;)u=s(e.reverse().concat(t.chars),n);return u.pop()},dispose:function(){a.dispose(),l.dispose(),p=u=null}}}function I(t,e,n,i,s){var r,o,a,l,c=0,p=t,u=Math.abs(n);if(0!==n){var h=n<0;switch(e){case z:for(o=j(t,h,null,i);(r=o.next())&&c<u;)++c,p=r;a=r,o.dispose();break;case B:for(var d=P(t,i,s),f=h?d.previousStartToken:d.nextEndToken;(l=f())&&c<u;)l.isWord&&(++c,p=h?l.chars[0]:l.chars[l.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+e+"' not implemented")}h?(p=p.previousVisible(),c=-c):p&&p.isLeadingSpace&&(e==B&&(a=(o=j(t,!1,null,i)).next(),o.dispose()),a&&(p=a.previousVisible()))}return{position:p,unitsMoved:c}}function E(t,e,n,i){var s=t.getRangeBoundaryPosition(e,!0),r=t.getRangeBoundaryPosition(e,!1);return j(i?r:s,!!i,i?s:r,n)}function D(t,e,n){for(var i,s=[],r=E(t,e,n);i=r.next();)s.push(i);return r.dispose(),s}function O(t,e,n){var i=h.createRange(t.node);return i.setStartAndEnd(t.node,t.offset,e.node,e.offset),!i.expand("word",{wordOptions:n})}function N(t,e,n,i,s){function r(t,e){var n=m[t].previousVisible(),i=m[e-1];return{startPos:n,endPos:i,valid:!s.wholeWordsOnly||O(n,i,s.wordOptions)}}for(var o,a,l,c,p,u,h=Z(s.direction),d=j(t,h,t.session.getRangeBoundaryPosition(i,h),s.characterOptions),f="",m=[],g=null;o=d.next();)if(a=o.character,n||s.caseSensitive||(a=a.toLowerCase()),h?(m.unshift(o),f=a+f):(m.push(o),f+=a),n){if(p=e.exec(f))if(c=(l=p.index)+p[0].length,u){if(!h&&c<f.length||h&&0<l){g=r(l,c);break}}else u=!0}else if(-1!=(l=f.indexOf(e))){g=r(l,l+e.length);break}return u&&(g=r(l,c)),d.dispose(),g}function R(i){return function(){var t=!!St,e=[C()].concat(q.toArray(arguments)),n=i.apply(this,e);return t||x(),n}}function M(a,l){return R(function(t,e,n,i){typeof n==U&&(n=e,e=z),i=f(i,ct);var s=a;l&&(s=0<=n,this.collapse(!s));var r=I(t.getRangeBoundaryPosition(this,s),e,n,i.characterOptions,i.wordOptions),o=r.position;return this[s?"setStart":"setEnd"](o.node,o.offset),r.unitsMoved})}function $(o){return R(function(t,e){for(var n,i=E(t,this,e=H(e,rt),!o),s=0;(n=i.next())&&V.test(n.character);)++s;i.dispose();var r=0<s;return r&&this[o?"moveStart":"moveEnd"]("character",o?s:-s,{characterOptions:e}),r})}function L(i){return R(function(t,e){var n=!1;return this.changeEachRange(function(t){n=t[i](e)||n}),n})}var U="undefined",z="character",B="word",F=h.dom,q=h.util,J=q.extend,H=q.createOptions,W=F.getBody,G=/^[ \t\f\r\n]+$/,K=/^[ \t\f\r]+$/,V=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,Y=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,X="en",Z=h.Selection.isDirectionBackward,Q=!1,tt=!1,et=!0;!function(){var t=document.createElement("div");t.contentEditable="true",t.innerHTML="<p>1 </p><p></p>";var e=W(document),n=t.firstChild,i=h.getSelection();e.appendChild(t),i.collapse(n.lastChild,2),i.setStart(n.firstChild,0),1==(""+i).length,t.innerHTML="1 <br>",i.collapse(t,2),i.setStart(t.firstChild,0),Q=1==(""+i).length,t.innerHTML="1 <p>1</p>",i.collapse(t,2),i.setStart(t.firstChild,0),tt=1==(""+i).length,e.removeChild(t),i.removeAllRanges()}();var nt,it,st,rt={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includeSpaceBeforeBlock:!0,includePreLineTrailingSpace:!0,ignoreCharacters:""},ot={includeBlockContentTrailingSpace:!et,includeSpaceBeforeBr:!Q,includeSpaceBeforeBlock:!tt,includePreLineTrailingSpace:!0},at={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:t}},lt={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},ct={wordOptions:null,characterOptions:null},pt={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},ut={wordOptions:null,characterOptions:null,direction:"forward"},ht=F.getComputedStyleProperty;it=document.createElement("table"),(st=W(document)).appendChild(it),nt="block"==ht(it,"display"),st.removeChild(it),h.features.tableCssDisplayBlock=nt;var dt={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};_.prototype={get:function(t){return this.store.hasOwnProperty(t)?this.store[t]:null},set:function(t,e){return this.store[t]=e}};var ft={getPosition:function(t){var e=this.positions;return e.get(t)||e.set(t,new T(this,t))},toString:function(){return"[NodeWrapper("+F.inspectNode(this.node)+")]"}};k.prototype=ft;var mt="EMPTY",gt="NON_SPACE",vt="UNCOLLAPSIBLE_SPACE",yt="COLLAPSIBLE_SPACE",bt="TRAILING_SPACE_BEFORE_BLOCK",_t="TRAILING_SPACE_IN_BLOCK",wt="TRAILING_SPACE_BEFORE_BR",kt="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK",Tt="TRAILING_LINE_BREAK_AFTER_BR";J(ft,{isCharacterDataNode:w("isCharacterDataNode",F.isCharacterDataNode,"node"),getNodeIndex:w("nodeIndex",F.getNodeIndex,"node"),getLength:w("nodeLength",F.getNodeLength,"node"),containsPositions:w("containsPositions",o,"node"),isWhitespace:w("isWhitespace",g,"node"),isCollapsedWhitespace:w("isCollapsedWhitespace",v,"node"),getComputedDisplay:w("computedDisplay",s,"node"),isCollapsed:w("collapsed",y,"node"),isIgnored:w("ignored",b,"node"),next:w("nextPos",u,"node"),previous:w("previous",m,"node"),getTextNodeInfo:w("textNodeInfo",function(t){var e=null,n=!1,i=ht(t.parentNode,"whiteSpace"),s="pre-line"==i;return s?(e=K,n=!0):("normal"==i||"nowrap"==i)&&(e=G,n=!0),{node:t,text:t.data,spaceRegex:e,collapseSpaces:n,preLine:s}},"node"),hasInnerText:w("hasInnerText",function(t,e){for(var n=this.session,i=n.getPosition(t.parentNode,this.getNodeIndex()+1),s=n.getPosition(t,0),r=e?i:s,o=e?s:i;r!==o;){if(r.prepopulateChar(),r.isDefinitelyNonEmpty())return!0;r=e?r.previousVisible():r.nextVisible()}return!1},"node"),isRenderedBlock:w("isRenderedBlock",function(t){for(var e=t.getElementsByTagName("br"),n=0,i=e.length;n<i;++n)if(!y(e[n]))return!0;return this.hasInnerText()},"node"),getTrailingSpace:w("trailingSpace",function(t){if("br"==t.tagName.toLowerCase())return"";switch(this.getComputedDisplay()){case"inline":for(var e=t.lastChild;e;){if(!b(e))return 1==e.nodeType?this.session.getNodeWrapper(e).getTrailingSpace():"";e=e.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"\t";default:return this.isRenderedBlock(!0)?"\n":""}return""},"node"),getLeadingSpace:w("leadingSpace",function(){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.isRenderedBlock(!1)?"\n":""}return""},"node")});var At={character:"",characterType:mt,isBr:!1,prepopulateChar:function(){var t=this;if(!t.prepopulatedChar){var e=t.node,n=t.offset,i="",s=mt,r=!1;if(0<n)if(3==e.nodeType){var o=e.data,a=o.charAt(n-1),l=t.nodeWrapper.getTextNodeInfo(),c=l.spaceRegex;l.collapseSpaces?c.test(a)?1<n&&c.test(o.charAt(n-2))||(l.preLine&&"\n"===o.charAt(n)?(i=" ",s=kt):(i=" ",s=yt)):(i=a,s=gt,r=!0):(i=a,s=vt,r=!0)}else{var p=e.childNodes[n-1];if(p&&1==p.nodeType&&!y(p)&&("br"==p.tagName.toLowerCase()?(i="\n",t.isBr=!0,s=yt,r=!1):t.checkForTrailingSpace=!0),!i){var u=e.childNodes[n];u&&1==u.nodeType&&!y(u)&&(t.checkForLeadingSpace=!0)}}t.prepopulatedChar=!0,t.character=i,t.characterType=s,t.isCharInvariant=r}},isDefinitelyNonEmpty:function(){var t=this.characterType;return t==gt||t==vt},resolveLeadingAndTrailingSpaces:function(){if(this.prepopulatedChar||this.prepopulateChar(),this.checkForTrailingSpace){var t=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();t&&(this.isTrailingSpace=!0,this.character=t,this.characterType=yt),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var e=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();e&&(this.isLeadingSpace=!0,this.character=e,this.characterType=yt),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(t){for(var e=this;e=e.previousVisible();)if(""!==e.getCharacter(t))return e;return null},getCharacter:function(t){function e(){return u||(l=h.getPrecedingUncollapsedPosition(t),u=!0),l}this.resolveLeadingAndTrailingSpaces();var n=this.character,i=d(t.ignoreCharacters),s=""!==n&&-1<i.indexOf(n);if(this.isCharInvariant
)return s?"":n;var r=["character",t.includeSpaceBeforeBr,t.includeBlockContentTrailingSpace,t.includePreLineTrailingSpace,i].join("_"),o=this.cache.get(r);if(null!==o)return o;var a,l,c="",p=this.characterType==yt,u=!1,h=this;return p?(" "!=n||e()&&!l.isTrailingSpace&&"\n"!=l.character)&&("\n"==n&&this.isLeadingSpace?e()&&"\n"!=l.character&&(c="\n"):(a=this.nextUncollapsed())&&(a.isBr?this.type=wt:a.isTrailingSpace&&"\n"==a.character?this.type=_t:a.isLeadingSpace&&"\n"==a.character&&(this.type=bt),"\n"==a.character?(this.type!=wt||t.includeSpaceBeforeBr)&&(this.type!=bt||t.includeSpaceBeforeBlock)&&(this.type==_t&&a.isTrailingSpace&&!t.includeBlockContentTrailingSpace||(this.type!=kt||a.type!=gt||t.includePreLineTrailingSpace)&&("\n"==n?a.isTrailingSpace?this.isTrailingSpace||this.isBr&&(a.type=Tt,e()&&l.isLeadingSpace&&"\n"==l.character&&(a.character="")):c="\n":" "==n&&(c=" "))):c=n)):"\n"==n&&(!(a=this.nextUncollapsed())||a.isTrailingSpace),-1<i.indexOf(c)&&(c=""),this.cache.set(r,c),c},equals:function(t){return!!t&&this.node===t.node&&this.offset===t.offset},inspect:A,toString:function(){return this.character}};T.prototype=At,J(At,{next:w("nextPos",function(t){var e,n,i,s=t.nodeWrapper,r=t.node,o=t.offset,a=s.session;return r?(o==s.getLength()?n=(e=r.parentNode)?s.getNodeIndex()+1:0:s.isCharacterDataNode()?(e=r,n=o+1):(i=r.childNodes[o],a.getNodeWrapper(i).containsPositions()?(e=i,n=0):(e=r,n=o+1)),e?a.getPosition(e,n):null):null}),previous:w("previous",function(t){var e,n,i,s=t.nodeWrapper,r=t.node,o=t.offset,a=s.session;return 0==o?n=(e=r.parentNode)?s.getNodeIndex():0:s.isCharacterDataNode()?(e=r,n=o-1):(i=r.childNodes[o-1],a.getNodeWrapper(i).containsPositions()?(e=i,n=F.getNodeLength(i)):(e=r,n=o-1)),e?a.getPosition(e,n):null}),nextVisible:w("nextVisible",function(t){var e=t.next();if(!e)return null;var n=e.nodeWrapper,i=e.node,s=e;return n.isCollapsed()&&(s=n.session.getPosition(i.parentNode,n.getNodeIndex()+1)),s}),nextUncollapsed:w("nextUncollapsed",function(t){for(var e=t;e=e.nextVisible();)if(e.resolveLeadingAndTrailingSpaces(),""!==e.character)return e;return null}),previousVisible:w("previousVisible",function(t){var e=t.previous();if(!e)return null;var n=e.nodeWrapper,i=e.node,s=e;return n.isCollapsed()&&(s=n.session.getPosition(i.parentNode,n.getNodeIndex())),s})});var St=null,Ct=function(){function t(s){var r=new _;return{get:function(t){var e=r.get(t[s]);if(e)for(var n,i=0;n=e[i++];)if(n.node===t)return n;return null},set:function(t){var e=t.node[s];(r.get(e)||r.set(e,[])).push(t)}}}function e(){this.initCaches()}var n=q.isHostProperty(document.documentElement,"uniqueID");return e.prototype={initCaches:function(){var e;this.elementCache=n?(e=new _,{get:function(t){return e.get(t.uniqueID)},set:function(t){e.set(t.node.uniqueID,t)}}):t("tagName"),this.textNodeCache=t("data"),this.otherNodeCache=t("nodeName")},getNodeWrapper:function(t){var e;switch(t.nodeType){case 1:e=this.elementCache;break;case 3:e=this.textNodeCache;break;default:e=this.otherNodeCache}var n=e.get(t);return n||(n=new k(t,this),e.set(n)),n},getPosition:function(t,e){return this.getNodeWrapper(t).getPosition(e)},getRangeBoundaryPosition:function(t,e){var n=e?"start":"end";return this.getPosition(t[n+"Container"],t[n+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},e}();J(F,{nextNode:u,previousNode:m});var xt=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var n=0,i=t.length;n<i;++n)if(t[n]===e)return n;return-1};J(h.rangePrototype,{moveStart:M(!0,!1),moveEnd:M(!1,!1),move:M(!0,!0),trimStart:$(!0),trimEnd:$(!1),trim:R(function(t,e){var n=this.trimStart(e),i=this.trimEnd(e);return n||i}),expand:R(function(t,e,n){var i=!1,s=(n=f(n,pt)).characterOptions;if(e||(e=z),e!=B)return this.moveEnd(z,1,n);var r,o,a=n.wordOptions,l=t.getRangeBoundaryPosition(this,!0),c=t.getRangeBoundaryPosition(this,!1),p=P(l,s,a).nextEndToken(),u=p.chars[0].previousVisible();this.collapsed?r=p:r=P(c,s,a).previousStartToken();return o=r.chars[r.chars.length-1],u.equals(l)||(this.setStart(u.node,u.offset),i=!0),o&&!o.equals(c)&&(this.setEnd(o.node,o.offset),i=!0),n.trim&&(n.trimStart&&(i=this.trimStart(s)||i),n.trimEnd&&(i=this.trimEnd(s)||i)),i}),text:R(function(t,e){return this.collapsed?"":D(t,this,H(e,rt)).join("")}),selectCharacters:R(function(t,e,n,i,s){var r={characterOptions:s};e||(e=W(this.getDocument())),this.selectNodeContents(e),this.collapse(!0),this.moveStart("character",n,r),this.collapse(!0),this.moveEnd("character",i-n,r)}),toCharacterRange:R(function(t,e,n){e||(e=W(this.getDocument()));var i,s=e.parentNode,r=F.getNodeIndex(e),o=-1==F.comparePoints(this.startContainer,this.endContainer,s,r),a=this.cloneRange();return o?(a.setStartAndEnd(this.startContainer,this.startOffset,s,r),i=-a.text(n).length):(a.setStartAndEnd(s,r,this.startContainer,this.startOffset),i=a.text(n).length),{start:i,end:i+this.text(n).length}}),findText:R(function(t,e,n){(n=f(n,lt)).wholeWordsOnly&&(n.wordOptions.includeTrailingSpace=!1);var i=Z(n.direction),s=n.withinRange;s||(s=h.createRange()).selectNodeContents(this.getDocument());var r=e,o=!1;"string"==typeof r?n.caseSensitive||(r=r.toLowerCase()):o=!0;var a=t.getRangeBoundaryPosition(this,!i),l=s.comparePoint(a.node,a.offset);-1===l?a=t.getRangeBoundaryPosition(s,!0):1===l&&(a=t.getRangeBoundaryPosition(s,!1));for(var c,p=a,u=!1;;)if(c=N(p,r,o,s,n)){if(c.valid)return this.setStartAndEnd(c.startPos.node,c.startPos.offset,c.endPos.node,c.endPos.offset),!0;p=i?c.startPos:c.endPos}else{if(!n.wrap||u)return!1;s=s.cloneRange(),p=t.getRangeBoundaryPosition(s,!i),s.setBoundary(a.node,a.offset,i),u=!0}}),pasteHtml:function(t){if(this.deleteContents(),t){var e=this.createContextualFragment(t),n=e.lastChild;this.insertNode(e),this.collapseAfter(n)}}}),J(h.selectionPrototype,{expand:R(function(t,e,n){this.changeEachRange(function(t){t.expand(e,n)})}),move:R(function(t,e,n,i){var s=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var r=this.getRangeAt(0);i||(i={}),i.characterOptions=H(i.characterOptions,ot),s=r.move(e,n,i),this.setSingleRange(r)}return s}),trimStart:L("trimStart"),trimEnd:L("trimEnd"),trim:L("trim"),selectCharacters:R(function(t,e,n,i,s,r){var o=h.createRange(e);o.selectCharacters(e,n,i,r),this.setSingleRange(o,s)}),saveCharacterRanges:R(function(t,e,n){for(var i=this.getAllRanges(),s=[],r=1==i.length&&this.isBackward(),o=0,a=i.length;o<a;++o)s[o]={characterRange:i[o].toCharacterRange(e,n),backward:r,characterOptions:n};return s}),restoreCharacterRanges:R(function(t,e,n){this.removeAllRanges();for(var i,s,r,o=0,a=n.length;o<a;++o)r=(s=n[o]).characterRange,(i=h.createRange(e)).selectCharacters(e,r.start,r.end,s.characterOptions),this.addRange(i,s.backward)}),text:R(function(t,e){for(var n=[],i=0,s=this.rangeCount;i<s;++i)n[i]=this.getRangeAt(i).text(e);return n.join("")})}),h.innerText=function(t,e){var n=h.createRange(t);return n.selectNodeContents(t),n.text(e)},h.createWordIterator=function(t,e,n){var i=C();n=f(n,ut);var s=P(i.getPosition(t,e),n.characterOptions,n.wordOptions),r=Z(n.direction);return{next:function(){return r?s.previousStartToken():s.nextEndToken()},dispose:function(){s.dispose(),this.next=function(){}}}},h.noMutation=function(t){t(C()),x()},h.noMutation.createEntryPointFunction=R,h.textRange={isBlockNode:e,isCollapsedWhitespaceNode:v,createPosition:R(function(t,e,n){return t.getPosition(e,n)})}}),t},this),function(t,e){"function"==typeof define&&define.amd?define(["./rangy-core"],t):void 0!==module&&"object"==typeof exports?module.exports=t(require("rangy")):t(e.rangy)}(function(t){return t.createModule("Highlighter",["ClassApplier"],function(T){function e(t,e){return t.characterRange.start-e.characterRange.start}function n(t,e){this.type=t,this.converterCreator=e}function t(t,e){a[t]=new n(t,e)}function m(t){var e=a[t];if(e instanceof n)return e.create();throw new Error("Highlighter type '"+t+"' is not valid")}function A(t,e){this.start=t,this.end=e}function S(t,e,n,i,s,r){s?(this.id=s,o=Math.max(o,s+1)):this.id=o++,this.characterRange=e,this.doc=t,this.classApplier=n,this.converter=i,this.containerElementId=r||null,this.applied=!1}function i(t,e){e=e||"textContent",this.doc=t||document,this.classAppliers={},this.highlights=[],this.converter=m(e)}var s=T.dom,r=s.arrayContains,g=s.getBody,C=T.util.createOptions,x=T.util.forEach,o=1,a={};n.prototype.create=function(){var t=this.converterCreator();return t.type=this.type,t},T.registerHighlighterType=t,A.prototype={intersects:function(t){return this.start<t.end&&this.end>t.start},isContiguousWith:function(t){return this.start==t.end||this.end==t.start},union:function(t){return new A(Math.min(this.start,t.start),Math.max(this.end,t.end))},intersection:function(t){return new A(Math.max(this.start,t.start),Math.min(this.end,t.end))},getComplements:function(t){var e=[];if(this.start>=t.start){if(this.end<=t.end)return[];e.push(new A(t.end,this.end))}else e.push(new A(this.start,Math.min(this.end,t.start))),this.end>t.end&&e.push(new A(t.end,this.end));return e},toString:function(){return"[CharacterRange("+this.start+", "+this.end+")]"}},A.fromCharacterRange=function(t){return new A(t.start,t.end)};var l,c={rangeToCharacterRange:function(t,e){var n=t.getBookmark(e);return new A(n.start,n.end)},characterRangeToRange:function(t,e,n){var i=T.createRange(t);return i.moveToBookmark({start:e.start,end:e.end,containerNode:n}),i},serializeSelection:function(t,e){for(var n=t.getAllRanges(),i=[],s=1==n.length&&t.isBackward(),r=0,o=n.length;r<o;++r)i[r]={characterRange:this.rangeToCharacterRange(n[r],e),backward:s};return i},restoreSelection:function(t,e,n){t.removeAllRanges();for(var i,s,r=t.win.document,o=0,a=e.length;o<a;++o)(s=e[o]).characterRange,i=this.characterRangeToRange(r,s.characterRange,n),t.addRange(i,s.backward)}};t("textContent",function(){return c}),t("TextRange",function(){if(!l){var t=T.modules.TextRange;if(!t)throw new Error("TextRange module is missing.");if(!t.supported)throw new Error("TextRange module is present but not supported.");l={rangeToCharacterRange:function(t,e){return A.fromCharacterRange(t.toCharacterRange(e))},characterRangeToRange:function(t,e,n){var i=T.createRange(t);return i.selectCharacters(n,e.start,e.end),i},serializeSelection:function(t,e){return t.saveCharacterRanges(e)},restoreSelection:function(t,e,n){t.restoreCharacterRanges(n,e)}}}return l}),S.prototype={getContainerElement:function(){return this.containerElementId?this.doc.getElementById(this.containerElementId):g(this.doc)},getRange:function(){return this.converter.characterRangeToRange(this.doc,this.characterRange,this.getContainerElement())},fromRange:function(t){this.characterRange=this.converter.rangeToCharacterRange(t,this.getContainerElement())},getText:function(){return this.getRange().toString()},containsElement:function(t){return this.getRange().containsNodeContents(t.firstChild)},unapply:function(){this.classApplier.undoToRange(this.getRange()),this.applied=!1},apply:function(){this.classApplier.applyToRange(this.getRange()),this.applied=!0},getHighlightElements:function(){return this.classApplier.getElementsWithClassIntersectingRange(this.getRange())},toString:function(){return"[Highlight(ID: "+this.id+", class: "+this.classApplier.className+", character range: "+this.characterRange.start+" - "+this.characterRange.end+")]"}},i.prototype={addClassApplier:function(t){this.classAppliers[t.className]=t},getHighlightForElement:function(t){for(var e=this.highlights,n=0,i=e.length;n<i;++n)if(e[n].containsElement(t))return e[n];return null},removeHighlights:function(t){for(var e,n=0,i=this.highlights.length;n<i;++n)e=this.highlights[n],r(t,e)&&(e.unapply(),this.highlights.splice(n--,1))},removeAllHighlights:function(){this.removeHighlights(this.highlights)},getIntersectingHighlights:function(t){var n=[],i=this.highlights;return x(t,function(e){x(i,function(t){e.intersectsRange(t.getRange())&&!r(n,t)&&n.push(t)})}),n},highlightCharacterRanges:function(t,e,n){var i,s,r,o,a,l,c,p,u,h,d,f,m=this.highlights,g=this.converter,v=this.doc,y=[],b=t?this.classAppliers[t]:null,_=(n=C(n,{containerElementId:null,exclusive:!0})).containerElementId,w=n.exclusive;for(_&&((o=this.doc.getElementById(_))&&((a=T.createRange(this.doc)).selectNodeContents(o),l=new A(0,a.toString().length))),i=0,s=e.length;i<s;++i)if(c=e[i],d=[],l&&(c=c.intersection(l)),c.start!=c.end){for(r=0;r<m.length;++r)u=!1,_==m[r].containerElementId&&(p=m[r].characterRange,f=!(h=b==m[r].classApplier)&&w,(p.intersects(c)||p.isContiguousWith(c))&&(h||f)&&(f&&x(p.getComplements(c),function(t){d.push(new S(v,t,m[r].classApplier,g,null,_))}),u=!0,h&&(c=p.union(c)))),u?(y.push(m[r]),m[r]=new S(v,p.union(c),b,g,null,_)):d.push(m[r]);b&&d.push(new S(v,c,b,g,null,_)),this.highlights=m=d}x(y,function(t){t.unapply()});var k=[];return x(m,function(t){t.applied||(t.apply(),k.push(t))}),k},highlightRanges:function(t,e,n){var i,s=[],r=this.converter,o=(n=C(n,{containerElement:null,exclusive:!0})).containerElement,a=o?o.id:null;return o&&(i=T.createRange(o)).selectNodeContents(o),x(e,function(t){var e=o?i.intersection(t):t;s.push(r.rangeToCharacterRange(e,o||g(t.getDocument())))}),this.highlightCharacterRanges(t,s,{containerElementId:a,exclusive:n.exclusive})},highlightSelection:function(t,e){var n=this.converter,i=!!t&&this.classAppliers[t],s=(e=C(e,{containerElementId:null,selection:T.getSelection(),exclusive:!0})).containerElementId,r=e.exclusive,o=e.selection,a=o.win.document,l=s?a.getElementById(s):g(a);if(!i&&!1!==t)throw new Error("No class applier found for class '"+t+"'");var c=n.serializeSelection(o,l),p=[];x(c,function(t){p.push(A.fromCharacterRange(t.characterRange))});var u=this.highlightCharacterRanges(t,p,{containerElementId:s,exclusive:r});return n.restoreSelection(o,c,l),u},unhighlightSelection:function(t){t=t||T.getSelection();var e=this.getIntersectingHighlights(t.getAllRanges());return this.removeHighlights(e),t.removeAllRanges(),e},getHighlightsInSelection:function(t){return t=t||T.getSelection(),this.getIntersectingHighlights(t.getAllRanges())},selectionOverlapsHighlight:function(t){return 0<this.getHighlightsInSelection(t).length},serialize:function(i){var t=this.highlights;t.sort(e);var s=["type:"+this.converter.type];return i=C(i,{serializeHighlightText:!1}),x(t,function(t){var e=t.characterRange,n=[e.start,e.end,t.id,t.classApplier.className,t.containerElementId];i.serializeHighlightText&&n.push(t.getText()),s.push(n.join("$"))}),s.join("|")},deserialize:function(t){var e,n,i,s=t.split("|"),r=[],o=s[0],a=!1;if(!o||!(e=/^type:(\w+)$/.exec(o)))throw new Error("Serialized highlights are invalid.");(n=e[1])!=this.converter.type&&(i=m(n),a=!0),s.shift();for(var l,c,p,u,h,d,f=s.length;0<f--;){if(p=new A(+(d=s[f].split("$"))[0],+d[1]),h=(u=d[4]||null)?this.doc.getElementById(u):g(this.doc),a&&(p=this.converter.rangeToCharacterRange(i.characterRangeToRange(this.doc,p,h),h)),!(l=this.classAppliers[d[3]]))throw new Error("No class applier found for class '"+d[3]+"'");(c=new S(this.doc,p,l,this.converter,parseInt(d[2]),u)).apply(),r.push(c)}this.highlights=r}},T.Highlighter=i,T.createHighlighter=function(t,e){return new i(t,e)}}),t},this),window.linkify=function(){var t="[a-z\\d.-]+://",e="(?:"+"(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+"+"(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)"+"|"+"(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])"+")",n="(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?",g="mailto:",v=new RegExp("(?:"+("\\b"+t+"[^<>\\s]+")+"|"+("\\b"+e+"(?:[;/][^#?<>\\s]*)?"+n+"(?!\\w)")+"|"+("(?:"+g+")?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@"+e+n+"(?!\\w)")+")","ig"),y=new RegExp("^"+t,"i"),b={"'":"`",">":"<",")":"(","]":"[","}":"{","\xbb":"\xab","\u203a":"\u2039"},_={callback:function(t,e){return e?'<a href="'+e+'" title="'+e+'" target="_blank">'+t+"</a>":t},punct_regexp:/(?:[!?.,:;'"]|(?:&|&amp;)(?:lt|gt|quot|apos|raquo|laquo|rsaquo|lsaquo);)$/};return function(t,e){e=e||{},t=t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;");var n,i,s,r,o,a,l,c,p,u,h,d,f="",m=[];for(i in _)e[i]===undefined&&(e[i]=_[i]);for(;n=v.exec(t);)if(s=n[0],l=(a=v.lastIndex)-s.length,!/[\/:]/.test(t.charAt(l-1))){for(;d=(c=s).substr(-1),(h=b[d])&&(p=s.match(new RegExp("\\"+h+"(?!$)","g")),u=s.match(new RegExp("\\"+d,"g")),(p?p.length:0)<(u?u.length:0)&&(s=s.substr(0,s.length-1),a--)),e.punct_regexp&&(s=s.replace(e.punct_regexp,function(t){return a-=t.length,""})),s.length&&s!==c;);r=s,y.test(r)||(r=(-1!==r.indexOf("@")?r.indexOf(g)?g:"":r.indexOf("irc.")?r.indexOf("ftp.")?"http://":"ftp://":"irc://")+r),o!=l&&(m.push([t.slice(o,l)]),o=a),r&&r.substr&&"mailto:"!=r.substr(0,7)?m.push([s,r]):m.push([s,undefined])}for(m.push([t.substr(o)]),i=0;i<m.length;i++)f+=e.callback.apply(window,m[i]);return f||t}}(),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=global.window&&global.window.$?e(global.window.$):function(t){if(!t.$&&!t.fn)throw new Error("Tokenfield requires a window object with jQuery or a jQuery instance");return e(t.$||t)}:e(jQuery,window)}(function(b,_){"use strict";var a=function(t,e){var n=this;this.$element=b(t),this.textDirection=this.$element.css("direction"),this.options=b.extend(!0,{},b.fn.tokenfield.defaults,{tokens:this.$element.val()},this.$element.data(),e),this._delimiters="string"==typeof this.options.delimiter?[this.options.delimiter]:this.options.delimiter,this._triggerKeys=b.map(this._delimiters,function(t){return t.charCodeAt(0)}),this._firstDelimiter=this._delimiters[0];var i=b.inArray(" ",this._delimiters),s=b.inArray("-",this._delimiters);0<=i&&(this._delimiters[i]="\\s"),0<=s&&(delete this._delimiters[s],this._delimiters.unshift("-"));var r=["\\","$","[","{","^",".","|","?","*","+","(",")"];b.each(this._delimiters,function(t,e){0<=b.inArray(e,r)&&(n._delimiters[t]="\\"+e)});var o,a=_&&"function"==typeof _.getMatchedCSSRules?_.getMatchedCSSRules(t):null,l=t.style.width,c=this.$element.width();a&&b.each(a,function(t,e){e.style.width&&(o=e.style.width)});var p="rtl"===b("body").css("direction")?"right":"left",u={position:this.$element.css("position")};u[p]=this.$element.css(p),this.$element.data("original-styles",u).data("original-tabindex",this.$element.prop("tabindex")).css("position","absolute").css(p,"-10000px").prop("tabindex",-1),this.$wrapper=b('<div class="tokenfield form-control" />'),this.$element.hasClass("input-lg")&&this.$wrapper.addClass("input-lg"),this.$element.hasClass("input-sm")&&this.$wrapper.addClass("input-sm"),"rtl"===this.textDirection&&this.$wrapper.addClass("rtl");var h=this.$element.prop("id")||(new Date).getTime()+""+Math.floor(100*(1+Math.random()));this.$input=b('<input type="'+this.options.inputType+'" class="token-input" autocomplete="off" />').appendTo(this.$wrapper).prop("placeholder",this.$element.prop("placeholder")).prop("id",h+"-tokenfield").prop("tabindex",this.$element.data("original-tabindex"));var d=b('label[for="'+this.$element.prop("id")+'"]');if(d.length&&d.prop("for",this.$input.prop("id")),this.$copyHelper=b('<input type="text" />').css("position","absolute").css(p,"-10000px").prop("tabindex",-1).prependTo(this.$wrapper),l?this.$wrapper.css("width",l):o?this.$wrapper.css("width",o):this.$element.parents(".form-inline").length&&this.$wrapper.width(c),(this.$element.prop("disabled")||this.$element.parents("fieldset[disabled]").length)&&this.disable(),this.$element.prop("readonly")&&this.readonly(),this.$mirror=b('<span style="position:absolute; top:-999px; left:0; white-space:pre;"/>'),this.$input.css("min-width",this.options.minWidth+"px"),b.each(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],function(t,e){n.$mirror[0].style[e]=n.$input.css(e)}),this.$mirror.appendTo("body"),this.$wrapper.insertBefore(this.$element),this.$element.prependTo(this.$wrapper),this.update(),this.setTokens(this.options.tokens,!1,!this.$element.val()&&this.options.tokens),this.listen(),!b.isEmptyObject(this.options.autocomplete)){var f="rtl"===this.textDirection?"right":"left",m=b.extend({minLength:this.options.showAutocompleteOnFocus?0:null,position:{my:f+" top",at:f+" bottom",of:this.$wrapper}},this.options.autocomplete);this.$input.autocomplete(m)}if(!b.isEmptyObject(this.options.typeahead)){var g=this.options.typeahead,v={minLength:this.options.showAutocompleteOnFocus?0:null},y=b.isArray(g)?g:[g,g];y[0]=b.extend({},v,y[0]),this.$input.typeahead.apply(this.$input,y),this.typeahead=!0}};a.prototype={constructor:a,createToken:function(t,e){var n=this;if(void 0===e&&(e=!0),(t="string"==typeof t?{value:t,label:t}:b.extend({},t)).value=b.trim(t.value.toString()),t.label=t.label&&t.label.length?b.trim(t.label):t.value,t.value.length&&t.label.length&&!(t.label.length<=this.options.minLength)&&!(this.options.limit&&this.getTokens().length>=this.options.limit)){var i=b.Event("tokenfield:createtoken",{attrs:t});if(this.$element.trigger(i),i.attrs&&!i.isDefaultPrevented()){var s=b('<div class="token" />').append('<span class="token-label" />').append('<a href="#" class="close" tabindex="-1">&times;</a>').data("attrs",t);this.$input.hasClass("tt-input")?this.$input.parent().before(s):this.$input.before(s),this.$input.css("width",this.options.minWidth+"px");var r=s.find(".token-label"),o=s.find(".close");this.options.html?r.html(t.label):r.text(t.label),s.on("mousedown",function(){if(n._disabled||n._readonly)return!1;n.preventDeactivation=!0}).on("click",function(t){return!n._disabled&&!n._readonly&&(n.preventDeactivation=!1,t.ctrlKey||t.metaKey?(t.preventDefault(),n.toggle(s)):void n.activate(s,t.shiftKey,t.shiftKey))}).on("dblclick",function(){if(n._disabled||n._readonly||!n.options.allowEditing)return!1;n.edit(s)}),o.on("click",b.proxy(this.remove,this)),this.$element.trigger(b.Event("tokenfield:createdtoken",{attrs:t,relatedTarget:s.get(0)})),e&&this.$element.val(this.getTokensList()).trigger(b.Event("change",{initiator:"tokenfield"}));n=this;return setTimeout(function(){n.update()},0),this.$element.get(0)}}},setTokens:function(t,e,n){if(e||this.$wrapper.find(".token").remove(),t){void 0===n&&(n=!0),"string"==typeof t&&(t=this._delimiters.length?t.split(new RegExp("["+this._delimiters.join("")+"]")):[t]);var i=this;return b.each(t,function(t,e){i.createToken(e,n)}),this.$element.get(0)}},getTokenData:function(t){var e=t.map(function(){return b(this).data("attrs")}).get();return 1==e.length&&(e=e[0]),e},getTokens:function(t){var e=this,n=[],i=t?".active":"";return this.$wrapper.find(".token"+i).each(function(){n.push(e.getTokenData(b(this)))}),n},getTokensList:function(t,e,n){var i=(t=t||this._firstDelimiter)+((e=null!=e?e:this.options.beautify)&&" "!==t?" ":"");return b.map(this.getTokens(n),function(t){return t.value}).join(i)},getInput:function(){return this.$input.val()},setInput:function(t){this.$input.hasClass("tt-input")?this.$input.typeahead("val",t):this.$input.val(t)},listen:function(){var n=this;this.$element.on("change",b.proxy(this.change,this)),this.$wrapper.on("mousedown",b.proxy(this.focusInput,this)),this.$input.on("focus",b.proxy(this.focus,this)).on("blur",b.proxy(this.blur,this)).on("paste",b.proxy(this.paste,this)).on("keydown",b.proxy(this.keydown,this)).on("keypress",b.proxy(this.keypress,this)).on("keyup",b.proxy(this.keyup,this)),this.$copyHelper.on("focus",b.proxy(this.focus,this)).on("blur",b.proxy(this.blur,this)).on("keydown",b.proxy(this.keydown,this)).on("keyup",b.proxy(this.keyup,this)),this.$input.on("keypress",b.proxy(this.update,this)).on("keyup",b.proxy(this.update,this)),this.$input.on("autocompletecreate",function(){var t=b(this).data("ui-autocomplete").menu.element,e=n.$wrapper.outerWidth()-parseInt(t.css("border-left-width"),10)-parseInt(t.css("border-right-width"),10);t.css("min-width",e+"px")}).on("autocompleteselect",function(t,e){return n.createToken(e.item)&&(n.$input.val(""),n.$input.data("edit")&&n.unedit(!0)),!1}).on("typeahead:selected typeahead:autocompleted",function(t,e){n.createToken(e)&&(n.$input.typeahead("val",""),n.$input.data("edit")&&n.unedit(!0))}),b(_).on("resize",b.proxy(this.update,this))},keydown:function(s){function t(t){if(r.$input.is(document.activeElement)){if(0<r.$input.val().length)return;t+="All";var e=r.$input.hasClass("tt-input")?r.$input.parent()[t](".token:first"):r.$input[t](".token:first");if(!e.length)return;r.preventInputFocus=!0,r.preventDeactivation=!0,r.activate(e),s.preventDefault()}else r[t](s.shiftKey),s.preventDefault()}function e(t){if(s.shiftKey){if(r.$input.is(document.activeElement)){if(0<r.$input.val().length)return;var e=r.$input.hasClass("tt-input")?r.$input.parent()[t+"All"](".token:first"):r.$input[t+"All"](".token:first");if(!e.length)return;r.activate(e)}var n="prev"===t?"next":"prev",i="prev"===t?"first":"last";r.$firstActiveToken[n+"All"](".token").each(function(){r.deactivate(b(this))}),r.activate(r.$wrapper.find(".token:"+i),!0,!0),s.preventDefault()}}if(this.focused){var r=this;switch(s.keyCode){case 8:if(!this.$input.is(document.activeElement))break;this.lastInputValue=this.$input.val();break;case 37:t("rtl"===this.textDirection?"next":"prev");break;case 38:e("prev");break;case 39:t("rtl"===this.textDirection?"prev":"next");break;case 40:e("next");break;case 65:if(0<this.$input.val().length||!s.ctrlKey&&!s.metaKey)break;this.activateAll(),s.preventDefault();break;case 9:case 13:if(this.$input.data("ui-autocomplete")&&this.$input.data("ui-autocomplete").menu.element.find("li:has(a.ui-state-focus), li.ui-state-focus").length)break;if(this.$input.hasClass("tt-input")&&this.$wrapper.find(".tt-cursor").length)break;if(this.$input.hasClass("tt-input")&&this.$wrapper.find(".tt-hint").val()&&this.$wrapper.find(".tt-hint").val().length)break;if(this.$input.is(document.activeElement)&&this.$input.val().length||this.$input.data("edit"))return this.createTokensFromInput(s,this.$input.data("edit"));if(13===s.keyCode){if(!this.$copyHelper.is(document.activeElement)||1!==this.$wrapper.find(".token.active").length)break;if(!r.options.allowEditing)break;this.edit(this.$wrapper.find(".token.active"))}}this.lastKeyDown=s.keyCode}},keypress:function(t){if(-1!==b.inArray(t.which,this._triggerKeys)&&this.$input.is(document.activeElement))return this.$input.val()&&this.createTokensFromInput(t),!1},keyup:function(t){if(this.preventInputFocus=!1,this.focused){switch(t.keyCode){case 8:if(this.$input.is(document.activeElement)){if(this.$input.val().length||this.lastInputValue.length&&8===this.lastKeyDown)break;this.preventDeactivation=!0;var e=this.$input.hasClass("tt-input")?this.$input.parent().prevAll(".token:first"):this.$input.prevAll(".token:first");if(!e.length)break;this.activate(e)}else this.remove(t);break;case 46:this.remove(t,"next")}this.lastKeyUp=t.keyCode}},focus:function(){this.focused=!0,this.$wrapper.addClass("focus"),this.$input.is(document.activeElement)&&(this.$wrapper.find(".active").removeClass("active"),this.$firstActiveToken=null,this.options.showAutocompleteOnFocus&&this.search())},blur:function(t){this.focused=!1,this.$wrapper.removeClass("focus"),this.preventDeactivation||this.$element.is(document.activeElement)||(this.$wrapper.find(".active").removeClass("active"),this.$firstActiveToken=null),!this.preventCreateTokens&&(this.$input.data("edit")&&!this.$input.is(document.activeElement)||this.options.createTokensOnBlur)&&this.createTokensFromInput(t),this.preventDeactivation=!1,this.preventCreateTokens=!1},paste:function(t){var e=this;e.options.allowPasting&&setTimeout(function(){e.createTokensFromInput(t)},1)},change:function(t){"tokenfield"!==t.initiator&&this.setTokens(this.$element.val())},createTokensFromInput:function(t,e){if(!(this.$input.val().length<this.options.minLength)){var n=this.getTokensList();return this.setTokens(this.$input.val(),!0),n==this.getTokensList()&&this.$input.val().length?!1:(this.setInput(""),this.$input.data("edit")&&this.unedit(e),!1)}},next:function(t){if(t){var e=this.$wrapper.find(".active:first");if(!(!e||!this.$firstActiveToken)&&e.index()<this.$firstActiveToken.index())return this.deactivate(e)}var n=this.$wrapper.find(".active:last").nextAll(".token:first");n.length?this.activate(n,t):this.$input.focus()},prev:function(t){if(t){var e=this.$wrapper.find(".active:last");if(!(!e||!this.$firstActiveToken)&&e.index()>this.$firstActiveToken.index())return this.deactivate(e)}var n=this.$wrapper.find(".active:first").prevAll(".token:first");n.length||(n=this.$wrapper.find(".token:first")),n.length||t?this.activate(n,t):this.$input.focus()},activate:function(t,e,n,i){if(t){if(void 0===i)i=!0;if(n)e=!0;if(this.$copyHelper.focus(),e||(this.$wrapper.find(".active").removeClass("active"),i?this.$firstActiveToken=t:delete this.$firstActiveToken),n&&this.$firstActiveToken){var s=this.$firstActiveToken.index()-2,r=t.index()-2,o=this;this.$wrapper.find(".token").slice(Math.min(s,r)+1,Math.max(s,r)).each(function(){o.activate(b(this),!0)})}t.addClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select()}},activateAll:function(){var e=this;this.$wrapper.find(".token").each(function(t){e.activate(b(this),0!==t,!1,!1)})},deactivate:function(t){t&&(t.removeClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select())},toggle:function(t){t&&(t.toggleClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select())},edit:function(t){if(t){var e=t.data("attrs"),n={attrs:e,relatedTarget:t.get(0)},i=b.Event("tokenfield:edittoken",n);if(this.$element.trigger(i),!i.isDefaultPrevented()){t.find(".token-label").text(e.value);var s=t.outerWidth(),r=this.$input.hasClass("tt-input")?this.$input.parent():this.$input;t.replaceWith(r),this.preventCreateTokens=!0,this.$input.val(e.value).select().data("edit",!0).width(s),this.update(),this.$element.trigger(b.Event("tokenfield:editedtoken",n))}}},unedit:function(t){if((this.$input.hasClass("tt-input")?this.$input.parent():this.$input).appendTo(this.$wrapper),this.$input.data("edit",!1),this.$mirror.text(""),this.update(),t){var e=this;setTimeout(function(){e.$input.focus()},1)}},remove:function(t,e){if(!(this.$input.is(document.activeElement)||this._disabled||this._readonly)){var n="click"===t.type?b(t.target).closest(".token"):this.$wrapper.find(".token.active");if("click"!==t.type){if(!e)e="prev";if(this[e](),"prev"===e)var i=0===n.first().prevAll(".token:first").length}var s={attrs:this.getTokenData(n),relatedTarget:n.get(0)},r=b.Event("tokenfield:removetoken",s);if(this.$element.trigger(r),!r.isDefaultPrevented()){var o=b.Event("tokenfield:removedtoken",s),a=b.Event("change",{initiator:"tokenfield"});n.remove(),this.$element.val(this.getTokensList()).trigger(o).trigger(a),this.$wrapper.find(".token").length&&"click"!==t.type&&!i||this.$input.focus(),this.$input.css("width",this.options.minWidth+"px"),this.update(),t.preventDefault(),t.stopPropagation()}}},update:function(){var t=this.$input.val(),e=parseInt(this.$input.css("padding-left"),10)+parseInt(this.$input.css("padding-right"),10);if(this.$input.data("edit")){if(t||(t=this.$input.prop("placeholder")),t===this.$mirror.text())return;this.$mirror.text(t);var n=this.$mirror.width()+10;if(n>this.$wrapper.width())return this.$input.width(this.$wrapper.width());this.$input.width(n)}else{this.$input.width(this.options.minWidth);var i="rtl"===this.textDirection?this.$input.offset().left+this.$input.outerWidth()-this.$wrapper.offset().left-parseInt(this.$wrapper.css("padding-left"),10)-e-1:this.$wrapper.offset().left+this.$wrapper.width()+parseInt(this.$wrapper.css("padding-left"),10)-this.$input.offset().left-e;isNaN(i)?this.$input.width("100%"
):this.$input.width(i)}},focusInput:function(t){if(!(b(t.target).closest(".token").length||b(t.target).closest(".token-input").length||b(t.target).closest(".tt-dropdown-menu").length)){var e=this;setTimeout(function(){e.$input.focus()},0)}},search:function(){this.$input.data("ui-autocomplete")&&this.$input.autocomplete("search")},disable:function(){this.setProperty("disabled",!0)},enable:function(){this.setProperty("disabled",!1)},readonly:function(){this.setProperty("readonly",!0)},writeable:function(){this.setProperty("readonly",!1)},setProperty:function(t,e){this["_"+t]=e,this.$input.prop(t,e),this.$element.prop(t,e),this.$wrapper[e?"addClass":"removeClass"](t)},destroy:function(){this.$element.val(this.getTokensList()),this.$element.css(this.$element.data("original-styles")),this.$element.prop("tabindex",this.$element.data("original-tabindex"));var t=b('label[for="'+this.$input.prop("id")+'"]');return t.length&&t.prop("for",this.$element.prop("id")),this.$element.insertBefore(this.$wrapper),this.$element.removeData("original-styles").removeData("original-tabindex").removeData("bs.tokenfield"),this.$wrapper.remove(),this.$mirror.remove(),this.$element}};var t=b.fn.tokenfield;return b.fn.tokenfield=function(i,s){var r,o=[];Array.prototype.push.apply(o,arguments);var t=this.each(function(){var t=b(this),e=t.data("bs.tokenfield"),n="object"==typeof i&&i;"string"==typeof i&&e&&e[i]?(o.shift(),r=e[i].apply(e,o)):e||"string"==typeof i||s||(t.data("bs.tokenfield",e=new a(this,n)),t.trigger("tokenfield:initialize"))});return void 0!==r?r:t},b.fn.tokenfield.defaults={minWidth:60,minLength:0,html:!0,allowEditing:!0,allowPasting:!0,limit:0,autocomplete:{},typeahead:{},showAutocompleteOnFocus:!1,createTokensOnBlur:!1,delimiter:",",beautify:!0,inputType:"text"},b.fn.tokenfield.Constructor=a,b.fn.tokenfield.noConflict=function(){return b.fn.tokenfield=t,this},a}),window.clipboard=function(){var s,r,o,t={};return t.copy=function(){function s(){r=!1,o=null}var r=!1,o=null;return document.addEventListener("copy",function(t){if(r){for(var e in o)t.clipboardData.setData(e,o[e]);t.preventDefault()}}),function(i){return new Promise(function(t,e){r=!0,o="string"==typeof i?{"text/plain":i}:i instanceof Node?{"text/html":(new XMLSerializer).serializeToString(i)}:i;try{if(!document.execCommand("copy"))throw new Error("Unable to copy. Perhaps it's not available in your browser?");s(),t()}catch(n){s(),e(n)}})}}(),t.paste=(o=!1,document.addEventListener("paste",function(t){if(o){o=!1,t.preventDefault();var e=s;s=null,e(t.clipboardData.getData(r))}}),function(i){return new Promise(function(t,e){o=!0,s=t,r=i||"text/plain";try{document.execCommand("paste")||(o=!1,e(new Error("Unable to paste. Pasting only works in Internet Explorer at the moment.")))}catch(n){o=!1,e(new Error(n))}})}),"undefined"==typeof ClipboardEvent&&"undefined"!=typeof window.clipboardData&&"undefined"!=typeof window.clipboardData.setData&&(!function(t){function n(t,e){return function(){t.apply(e,arguments)}}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],c(t,n(s,this),n(i,this))}function o(n){var i=this;return null===this._state?void this._deferreds.push(n):void e(function(){var t=i._state?n.onFulfilled:n.onRejected;if(null!==t){var e;try{e=t(i._value)}catch(s){return void n.reject(s)}n.resolve(e)}else(i._state?n.resolve:n.reject)(i._value)})}function s(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void c(n(e,t),n(s,this),n(i,this))}this._state=!0,this._value=t,a.call(this)}catch(o){i.call(this,o)}}function i(t){this._state=!1,this._value=t,a.call(this)}function a(){for(var t=0,e=this._deferreds.length;t<e;t++)o.call(this,this._deferreds[t]);this._deferreds=null}function l(t,e,n,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=i}function c(t,e,n){var i=!1;try{t(function(t){i||(i=!0,e(t))},function(t){i||(i=!0,n(t))})}catch(s){if(i)return;i=!0,n(s)}}var e=r.immediateFn||"function"==typeof setImmediate&&setImmediate||function(t){setTimeout(t,1)},p=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};r.prototype["catch"]=function(t){return this.then(null,t)},r.prototype.then=function(n,i){var s=this;return new r(function(t,e){o.call(s,new l(n,i,t,e))})},r.all=function(t){var a=Array.prototype.slice.call(1===arguments.length&&p(t)?t:arguments);return new r(function(i,s){function r(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void n.call(t,function(t){r(e,t)},s)}a[e]=t,0==--o&&i(a)}catch(c){s(c)}}if(0===a.length)return i([]);for(var o=a.length,t=0;t<a.length;t++)r(t,a[t])})},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r(function(t){t(e)})},r.reject=function(n){return new r(function(t,e){e(n)})},r.race=function(s){return new r(function(t,e){for(var n=0,i=s.length;n<i;n++)s[n].then(t,e)})},void 0!==module&&module.exports?module.exports=r:t.Promise||(t.Promise=r)}(this),t.copy=function(i){return new Promise(function(t,e){if("string"!=typeof i&&!("text/plain"in i))throw new Error("You must provide a text/plain type.");var n="string"==typeof i?i:i["text/plain"];window.clipboardData.setData("Text",n)?t():e(new Error("Copying was rejected."))})},t.paste=function(){return new Promise(function(t,e){var n=window.clipboardData.getData("Text");n?t(n):e(new Error("Pasting was rejected."))})}),t}(),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}(function(b){"use strict";function _(t){return"number"==typeof t&&!isNaN(t)}function o(t){return void 0===t}function a(t,e){var n=[];return _(e)&&n.push(e),n.slice.apply(t,n)}function i(t,e){var n=a(arguments,2);return function(){return t.apply(e,n.concat(a(arguments)))}}function l(t){var e=t.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return e&&(e[1]!==n.protocol||e[2]!==n.hostname||e[3]!==n.port)}function c(t){var e="timestamp="+(new Date).getTime();return t+(-1===t.indexOf("?")?"?":"&")+e}function t(t,e){var n;if(t.naturalWidth)return e(t.naturalWidth,t.naturalHeight);(n=document.createElement("img")).onload=function(){e(this.width,this.height)},n.src=t.src}function u(t){var e=[],n=t.rotate,i=t.scaleX,s=t.scaleY;return _(n)&&e.push("rotate("+n+"deg)"),_(i)&&_(s)&&e.push("scale("+i+","+s+")"),e.length?e.join(" "):"none"}function w(t,e){var n,i,s=st(t.degree)%180,r=(90<s?180-s:s)*Math.PI/180,o=rt(r),a=ot(r),l=t.width,c=t.height,p=t.aspectRatio;return e?i=(n=l/(a+o/p))/p:(n=l*a+c*o,i=l*o+c*a),{width:n,height:i}}function g(t,e){var n,i,s,r=b("<canvas>")[0],o=r.getContext("2d"),a=0,l=0,c=e.naturalWidth,p=e.naturalHeight,u=e.rotate,h=e.scaleX,d=e.scaleY,f=_(h)&&_(d)&&(1!==h||1!==d),m=_(u)&&0!==u,g=m||f,v=c,y=p;return f&&(n=c/2,i=p/2),m&&(v=(s=w({width:c,height:p,degree:u})).width,y=s.height,n=s.width/2,i=s.height/2),r.width=v,r.height=y,g&&(a=-c/2,l=-p/2,o.save(),o.translate(n,i)),m&&o.rotate(u*Math.PI/180),f&&o.scale(h,d),o.drawImage(t,a,l,c,p),g&&o.restore(),r}function p(t,e){this.$element=b(t),this.options=b.extend({},p.DEFAULTS,b.isPlainObject(e)&&e),this.ready=!1,this.built=!1,this.complete=!1,this.rotated=!1,this.cropped=!1,this.disabled=!1,this.replaced=!1,this.isImg=!1,this.originalUrl="",this.canvas=null,this.cropBox=null,this.init()}var s=b(window),r=b(document),n=window.location,h="cropper",d="preview."+h,f="cropper-modal",m="cropper-hide",C="cropper-hidden",v="cropper-invisible",y="cropper-move",k="cropper-crop",e="cropper-disabled",T="cropper-bg",A="mousedown touchstart pointerdown MSPointerDown",S="mousemove touchmove pointermove MSPointerMove",x="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",j="wheel mousewheel DOMMouseScroll",P="dblclick",I="load."+h,E="error."+h,D="resize."+h,O="build."+h,N="built."+h,R="cropstart."+h,M="cropmove."+h,$="cropend."+h,L="crop."+h,U="zoom."+h,z=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,B="e",F="w",q="s",J="n",H="se",W="sw",G="ne",K="nw",V="all",Y="crop",X="move",Z="zoom",Q="none",tt=b.isFunction(b("<canvas>")[0].getContext),et=Math.sqrt,nt=Math.min,it=Math.max,st=Math.abs,rt=Math.sin,ot=Math.cos,at=parseFloat,lt={};b.extend(lt,{init:function(){var t,e=this.$element;if(e.is("img")){if(this.isImg=!0,this.originalUrl=t=e.attr("src"),!t)return;t=e.prop("src")}else e.is("canvas")&&tt&&(t=e[0].toDataURL());this.load(t)},trigger:function(t,e){var n=b.Event(t,e);return this.$element.trigger(n),n.isDefaultPrevented()},load:function(t){var e,n,i=this.options,s=this.$element,r="";t&&(this.url=t,s.one(O,i.build),this.trigger(O)||(i.checkImageOrigin&&l(t)&&(r=' crossOrigin="anonymous"',s.prop("crossOrigin")||(e=c(t))),this.$clone=n=b("<img"+r+' src="'+(e||t)+'">'),this.isImg?s[0].complete?this.start():s.one(I,b.proxy(this.start,this)):n.one(I,b.proxy(this.start,this)).one(E,b.proxy(this.stop,this)).addClass(m).insertAfter(s)))},start:function(){t(this.isImg?this.$element[0]:this.$clone[0],b.proxy(function(t,e){this.image={naturalWidth:t,naturalHeight:e,aspectRatio:t/e},this.ready=!0,this.build()},this))},stop:function(){this.$clone.remove(),this.$clone=null}}),b.extend(lt,{build:function(){var t,e,n,i=this.options,s=this.$element,r=this.$clone;this.ready&&(this.built&&this.unbuild(),this.$container=s.parent(),this.$cropper=t=b(p.TEMPLATE),this.$canvas=t.find(".cropper-canvas").append(r),this.$dragBox=t.find(".cropper-drag-box"),this.$cropBox=e=t.find(".cropper-crop-box"),this.$viewBox=t.find(".cropper-view-box"),this.$face=n=e.find(".cropper-face"),s.addClass(C).after(t),this.isImg||r.removeClass(m),this.initPreview(),this.bind(),i.aspectRatio=at(i.aspectRatio)||NaN,i.autoCrop?(this.cropped=!0,i.modal&&this.$dragBox.addClass(f)):e.addClass(C),i.guides||e.find(".cropper-dashed").addClass(C),i.center||e.find(".cropper-center").addClass(C),i.cropBoxMovable&&n.addClass(y).data("action",V),i.highlight||n.addClass(v),i.background&&t.addClass(T),i.cropBoxResizable||e.find(".cropper-line, .cropper-point").addClass(C),this.setDragMode(i.dragCrop?Y:i.movable?X:Q),this.render(),this.built=!0,this.setData(i.data),s.one(N,i.built),setTimeout(b.proxy(function(){this.trigger(N),this.complete=!0},this),0))},unbuild:function(){this.built&&(this.built=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)}}),b.extend(lt,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.options,e=this.$element,n=this.$container,i=this.$cropper;i.addClass(C),e.removeClass(C),i.css(this.container={width:it(n.width(),at(t.minContainerWidth)||200),height:it(n.height(),at(t.minContainerHeight)||100)}),e.addClass(C),i.removeClass(C)},initCanvas:function(){var t=this.container,e=t.width,n=t.height,i=this.image,s=i.aspectRatio,r={aspectRatio:s,width:e,height:n};e<n*s?r.height=e/s:r.width=n*s,r.oldLeft=r.left=(e-r.width)/2,r.oldTop=r.top=(n-r.height)/2,this.canvas=r,this.limitCanvas(!0,!0),this.initialImage=b.extend({},i),this.initialCanvas=b.extend({},r)},limitCanvas:function(t,e){var n,i,s=this.options,r=s.strict,o=this.container,a=o.width,l=o.height,c=this.canvas,p=c.aspectRatio,u=this.cropBox,h=this.cropped&&u,d=this.initialCanvas||c,f=d.width,m=d.height;t&&(n=at(s.minCanvasWidth)||0,i=at(s.minCanvasHeight)||0,n?(r&&(n=it(h?u.width:f,n)),i=n/p):i?(r&&(i=it(h?u.height:m,i)),n=i*p):r&&(h?(n=u.width)<(i=u.height)*p?n=i*p:i=n/p:(n=f,i=m)),b.extend(c,{minWidth:n,minHeight:i,maxWidth:Infinity,maxHeight:Infinity})),e&&(r?h?(c.minLeft=nt(u.left,u.left+u.width-c.width),c.minTop=nt(u.top,u.top+u.height-c.height),c.maxLeft=u.left,c.maxTop=u.top):(c.minLeft=nt(0,a-c.width),c.minTop=nt(0,l-c.height),c.maxLeft=it(0,a-c.width),c.maxTop=it(0,l-c.height)):(c.minLeft=-c.width,c.minTop=-c.height,c.maxLeft=a,c.maxTop=l))},renderCanvas:function(t){var e,n,i=this.options,s=this.canvas,r=this.image;this.rotated&&(this.rotated=!1,(e=(n=w({width:r.width,height:r.height,degree:r.rotate})).width/n.height)!==s.aspectRatio&&(s.left-=(n.width-s.width)/2,s.top-=(n.height-s.height)/2,s.width=n.width,s.height=n.height,s.aspectRatio=e,this.limitCanvas(!0,!1))),(s.width>s.maxWidth||s.width<s.minWidth)&&(s.left=s.oldLeft),(s.height>s.maxHeight||s.height<s.minHeight)&&(s.top=s.oldTop),s.width=nt(it(s.width,s.minWidth),s.maxWidth),s.height=nt(it(s.height,s.minHeight),s.maxHeight),this.limitCanvas(!1,!0),s.oldLeft=s.left=nt(it(s.left,s.minLeft),s.maxLeft),s.oldTop=s.top=nt(it(s.top,s.minTop),s.maxTop),this.$canvas.css({width:s.width,height:s.height,left:s.left,top:s.top}),this.renderImage(),this.cropped&&i.strict&&this.limitCropBox(!0,!0),t&&this.output()},renderImage:function(t){var e,n=this.canvas,i=this.image;i.rotate&&(e=w({width:n.width,height:n.height,degree:i.rotate,aspectRatio:i.aspectRatio},!0)),b.extend(i,e?{width:e.width,height:e.height,left:(n.width-e.width)/2,top:(n.height-e.height)/2}:{width:n.width,height:n.height,left:0,top:0}),this.$clone.css({width:i.width,height:i.height,marginLeft:i.left,marginTop:i.top,transform:u(i)}),t&&this.output()},initCropBox:function(){var t=this.options,e=this.canvas,n=t.aspectRatio,i=at(t.autoCropArea)||.8,s={width:e.width,height:e.height};n&&(e.height*n>e.width?s.height=s.width/n:s.width=s.height*n),this.cropBox=s,this.limitCropBox(!0,!0),s.width=nt(it(s.width,s.minWidth),s.maxWidth),s.height=nt(it(s.height,s.minHeight),s.maxHeight),s.width=it(s.minWidth,s.width*i),s.height=it(s.minHeight,s.height*i),s.oldLeft=s.left=e.left+(e.width-s.width)/2,s.oldTop=s.top=e.top+(e.height-s.height)/2,this.initialCropBox=b.extend({},s)},limitCropBox:function(t,e){var n,i,s=this.options,r=s.strict,o=this.container,a=o.width,l=o.height,c=this.canvas,p=this.cropBox,u=s.aspectRatio;t&&(n=at(s.minCropBoxWidth)||0,i=at(s.minCropBoxHeight)||0,p.minWidth=nt(a,n),p.minHeight=nt(l,i),p.maxWidth=nt(a,r?c.width:a),p.maxHeight=nt(l,r?c.height:l),u&&(p.maxHeight*u>p.maxWidth?(p.minHeight=p.minWidth/u,p.maxHeight=p.maxWidth/u):(p.minWidth=p.minHeight*u,p.maxWidth=p.maxHeight*u)),p.minWidth=nt(p.maxWidth,p.minWidth),p.minHeight=nt(p.maxHeight,p.minHeight)),e&&(r?(p.minLeft=it(0,c.left),p.minTop=it(0,c.top),p.maxLeft=nt(a,c.left+c.width)-p.width,p.maxTop=nt(l,c.top+c.height)-p.height):(p.minLeft=0,p.minTop=0,p.maxLeft=a-p.width,p.maxTop=l-p.height))},renderCropBox:function(){var t=this.options,e=this.container,n=e.width,i=e.height,s=this.cropBox;(s.width>s.maxWidth||s.width<s.minWidth)&&(s.left=s.oldLeft),(s.height>s.maxHeight||s.height<s.minHeight)&&(s.top=s.oldTop),s.width=nt(it(s.width,s.minWidth),s.maxWidth),s.height=nt(it(s.height,s.minHeight),s.maxHeight),this.limitCropBox(!1,!0),s.oldLeft=s.left=nt(it(s.left,s.minLeft),s.maxLeft),s.oldTop=s.top=nt(it(s.top,s.minTop),s.maxTop),t.movable&&t.cropBoxMovable&&this.$face.data("action",s.width===n&&s.height===i?X:V),this.$cropBox.css({width:s.width,height:s.height,left:s.left,top:s.top}),this.cropped&&t.strict&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),this.complete?this.trigger(L,this.getData()):this.built||this.$element.one(N,b.proxy(function(){this.trigger(L,this.getData())},this))}}),b.extend(lt,{initPreview:function(){var e=this.url;this.$preview=b(this.options.preview),this.$viewBox.html('<img src="'+e+'">'),this.$preview.each(function(){var t=b(this);t.data(d,{width:t.width(),height:t.height(),original:t.html()}),t.html('<img src="'+e+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important">')})},resetPreview:function(){this.$preview.each(function(){var t=b(this);t.html(t.data(d).original).removeData(d)})},preview:function(){var r=this.image,t=this.canvas,o=this.cropBox,a=r.width,l=r.height,c=o.left-t.left-r.left,p=o.top-t.top-r.top;this.cropped&&!this.disabled&&(this.$viewBox.find("img").css({width:a,height:l,marginLeft:-c,marginTop:-p,transform:u(r)}),this.$preview.each(function(){var t=b(this),e=t.data(d),n=e.width/o.width,i=e.width,s=o.height*n;s>e.height&&(n=e.height/o.height,i=o.width*n,s=e.height),t.width(i).height(s).find("img").css({width:a*n,height:l*n,marginLeft:-c*n,marginTop:-p*n,transform:u(r)})}))}}),b.extend(lt,{bind:function(){var t=this.options,e=this.$element,n=this.$cropper;b.isFunction(t.cropstart)&&e.on(R,t.cropstart),b.isFunction(t.cropmove)&&e.on(M,t.cropmove),b.isFunction(t.cropend)&&e.on($,t.cropend),b.isFunction(t.crop)&&e.on(L,t.crop),b.isFunction(t.zoom)&&e.on(U,t.zoom),n.on(A,b.proxy(this.cropStart,this)),t.zoomable&&t.mouseWheelZoom&&n.on(j,b.proxy(this.wheel,this)),t.doubleClickToggle&&n.on(P,b.proxy(this.dblclick,this)),r.on(S,this._cropMove=i(this.cropMove,this)).on(x,this._cropEnd=i(this.cropEnd,this)),t.responsive&&s.on(D,this._resize=i(this.resize,this))},unbind:function(){var t=this.options,e=this.$element,n=this.$cropper;b.isFunction(t.cropstart)&&e.off(R,t.cropstart),b.isFunction(t.cropmove)&&e.off(M,t.cropmove),b.isFunction(t.cropend)&&e.off($,t.cropend),b.isFunction(t.crop)&&e.off(L,t.crop),b.isFunction(t.zoom)&&e.off(U,t.zoom),n.off(A,this.cropStart),t.zoomable&&t.mouseWheelZoom&&n.off(j,this.wheel),t.doubleClickToggle&&n.off(P,this.dblclick),r.off(S,this._cropMove).off(x,this._cropEnd),t.responsive&&s.off(D,this._resize)}}),b.extend(lt,{resize:function(){var n,i,s,t=this.$container,e=this.container;!this.disabled&&e&&(1===(s=t.width()/e.width)&&t.height()===e.height||(n=this.getCanvasData(),i=this.getCropBoxData(),this.render(),this.setCanvasData(b.each(n,function(t,e){n[t]=e*s})),this.setCropBoxData(b.each(i,function(t,e){i[t]=e*s}))))},dblclick:function(){this.disabled||(this.$dragBox.hasClass(k)?this.setDragMode(X):this.setDragMode(Y))},wheel:function(t){var e=t.originalEvent,n=e,i=at(this.options.wheelZoomRatio)||.1,s=1;this.disabled||(t.preventDefault(),n.deltaY?s=0<n.deltaY?1:-1:n.wheelDelta?s=-n.wheelDelta/120:n.detail&&(s=0<n.detail?1:-1),this.zoom(-s*i,e))},cropStart:function(t){var e,n,i=this.options,s=t.originalEvent,r=s&&s.touches,o=t;if(!this.disabled){if(r){if(1<(e=r.length)){if(!i.zoomable||!i.touchDragZoom||2!==e)return;o=r[1],this.startX2=o.pageX,this.startY2=o.pageY,n=Z}o=r[0]}if(n=n||b(o.target).data("action"),z.test(n)){if(this.trigger(R,{originalEvent:s,action:n}))return;t.preventDefault(),this.action=n,this.cropping=!1,this.startX=o.pageX||s&&s.pageX,this.startY=o.pageY||s&&s.pageY,n===Y&&(this.cropping=!0,this.$dragBox.addClass(f))}}},cropMove:function(t){var e,n=this.options,i=t.originalEvent,s=i&&i.touches,r=t,o=this.action;if(!this.disabled){if(s){if(1<(e=s.length)){if(!n.zoomable||!n.touchDragZoom||2!==e)return;r=s[1],this.endX2=r.pageX,this.endY2=r.pageY}r=s[0]}if(o){if(this.trigger(M,{originalEvent:i,action:o}))return;t.preventDefault(),this.endX=r.pageX||i&&i.pageX,this.endY=r.pageY||i&&i.pageY,this.change(r.shiftKey,o===Z?i:null)}}},cropEnd:function(t){var e=t.originalEvent,n=this.action;this.disabled||n&&(t.preventDefault(),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(f,this.cropped&&this.options.modal)),this.action="",this.trigger($,{originalEvent:e,action:n}))}}),b.extend(lt,{change:function(t,e){var n,i,s,r,o,a,l,c=this.options,p=c.aspectRatio,u=this.action,h=this.container,d=this.canvas,f=this.cropBox,m=f.width,g=f.height,v=f.left,y=f.top,b=v+m,_=y+g,w=0,k=0,T=h.width,A=h.height,S=!0;switch(!p&&t&&(p=m&&g?m/g:1),c.strict&&(w=f.minLeft,k=f.minTop,T=w+nt(h.width,d.width),A=k+nt(h.height,d.height)),i={x:this.endX-this.startX,y:this.endY-this.startY},p&&(i.X=i.y*p,i.Y=i.x/p),u){case V:v+=i.x,y+=i.y;break;case B:if(0<=i.x&&(T<=b||p&&(y<=k||A<=_))){S=!1;break}m+=i.x,p&&(g=m/p,y-=i.Y/2),m<0&&(u=F,m=0);break;case J:if(i.y<=0&&(y<=k||p&&(v<=w||T<=b))){S=!1;break}g-=i.y,y+=i.y,p&&(m=g*p,v+=i.X/2),g<0&&(u=q,g=0);break;case F:if(i.x<=0&&(v<=w||p&&(y<=k||A<=_))){S=!1;break}m-=i.x,v+=i.x,p&&(g=m/p,y+=i.Y/2),m<0&&(u=B,m=0);break;case q:if(0<=i.y&&(A<=_||p&&(v<=w||T<=b))){S=!1;break}g+=i.y,p&&(m=g*p,v-=i.X/2),g<0&&(u=J,g=0);break;case G:if(p){if(i.y<=0&&(y<=k||T<=b)){S=!1;break}g-=i.y,y+=i.y,m=g*p}else 0<=i.x?b<T?m+=i.x:i.y<=0&&y<=k&&(S=!1):m+=i.x,i.y<=0?k<y&&(g-=i.y,y+=i.y):(g-=i.y,y+=i.y);m<0&&g<0?(u=W,m=g=0):m<0?(u=K,m=0):g<0&&(u=H,g=0);break;case K:if(p){if(i.y<=0&&(y<=k||v<=w)){S=!1;break}g-=i.y,y+=i.y,m=g*p,v+=i.X}else i.x<=0?w<v?(m-=i.x,v+=i.x):i.y<=0&&y<=k&&(S=!1):(m-=i.x,v+=i.x),i.y<=0?k<y&&(g-=i.y,y+=i.y):(g-=i.y,y+=i.y);m<0&&g<0?(u=H,m=g=0):m<0?(u=G,m=0):g<0&&(u=W,g=0);break;case W:if(p){if(i.x<=0&&(v<=w||A<=_)){S=!1;break}m-=i.x,v+=i.x,g=m/p}else i.x<=0?w<v?(m-=i.x,v+=i.x):0<=i.y&&A<=_&&(S=!1):(m-=i.x,v+=i.x),0<=i.y?_<A&&(g+=i.y):g+=i.y;m<0&&g<0?(u=G,m=g=0):m<0?(u=H,m=0):g<0&&(u=K,g=0);break;case H:if(p){if(0<=i.x&&(T<=b||A<=_)){S=!1;break}g=(m+=i.x)/p}else 0<=i.x?b<T?m+=i.x:0<=i.y&&A<=_&&(S=!1):m+=i.x,0<=i.y?_<A&&(g+=i.y):g+=i.y;m<0&&g<0?(u=K,m=g=0):m<0?(u=W,m=0):g<0&&(u=G,g=0);break;case X:this.move(i.x,i.y),S=!1;break;case Z:this.zoom((s=st(this.startX-this.startX2),r=st(this.startY-this.startY2),o=st(this.endX-this.endX2),a=st(this.endY-this.endY2),l=et(s*s+r*r),(et(o*o+a*a)-l)/l),e),this.startX2=this.endX2,this.startY2=this.endY2,S=!1;break;case Y:i.x&&i.y&&(n=this.$cropper.offset(),v=this.startX-n.left,y=this.startY-n.top,m=f.minWidth,g=f.minHeight,0<i.x?0<i.y?u=H:(u=G,y-=g):0<i.y?(u=W,v-=m):(u=K,v-=m,y-=g),this.cropped||(this.cropped=!0,this.$cropBox.removeClass(C)))}S&&(f.width=m,f.height=g,f.left=v,f.top=y,this.action=u,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY}}),b.extend(lt,{crop:function(){this.built&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(f),this.$cropBox.removeClass(C)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.built&&!this.disabled&&(this.image=b.extend({},this.initialImage),this.canvas=b.extend({},this.initialCanvas),this.cropBox=b.extend({},this.initialCropBox),this.renderCanvas(),this.cropped&&this.renderCropBox())},clear:function(){this.cropped&&!this.disabled&&(b.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),this.$dragBox.removeClass(f),this.$cropBox.addClass(C))},replace:function(t){!this.disabled&&t&&(this.isImg&&(this.replaced=!0,this.$element.attr("src",t)),this.options.data=null,this.load(t))},enable:function(){this.built&&(this.disabled=!1,this.$cropper.removeClass(e))},disable:function(){this.built&&(this.disabled=!0,this.$cropper.addClass(e))},destroy:function(){var t=this.$element;this.ready?(this.isImg&&this.replaced&&t.attr("src",this.originalUrl),this.unbuild(),t.removeClass(C)):this.isImg?t.off(I,this.start):this.$clone&&this.$clone.remove(),t.removeData(h)},move:function(t,e){var n=this.canvas;o(e)&&(e=t),t=at(t),e=at(e),this.built&&!this.disabled&&this.options.movable&&(n.left+=_(t)?t:0,n.top+=_(e)?e:0,this.renderCanvas(!0))},zoom:function(t,e){var n,i,s=this.canvas;if((t=at(t))&&this.built&&!this.disabled&&this.options.zoomable){if(this.trigger(U,{originalEvent:e,ratio:t}))return;t=t<0?1/(1-t):1+t,n=s.width*t,i=s.height*t,s.left-=(n-s.width)/2,s.top-=(i-s.height)/2,s.width=n,s.height=i,this.renderCanvas(!0),this.setDragMode(X)}},rotate:function(t){var e=this.image,n=e.rotate||0;t=at(t)||0,this.built&&!this.disabled&&this.options.rotatable&&(e.rotate=(n+t)%360,this.rotated=!0,this.renderCanvas(!0))},scale:function(t,e){var n=this.image;o(e)&&(e=t),t=at(t),e=at(e),this.built&&!this.disabled&&this.options.scalable&&(n.scaleX=_(t)?t:1,n.scaleY=_(e)?e:1,this.renderImage(!0))},getData:function(n){var i,s,t=this.options,e=this.image,r=this.canvas,o=this.cropBox;return this.built&&this.cropped?(s={x:o.left-r.left,y:o.top-r.top,width:o.width,height:o.height},i=e.width/e.naturalWidth,b.each(s,function(t,e){e/=i,s[t]=n?Math.round(e):e})):s={x:0,y:0,width:0,height:0},t.rotatable&&(s.rotate=e.rotate||0),t.scalable&&(s.scaleX=e.scaleX||1,s.scaleY=e.scaleY||1),s},setData:function(t){var e,n=this.image,i=this.canvas,s={};b.isFunction(t)&&(t=t.call(this.$element)),this.built&&!this.disabled&&b.isPlainObject(t)&&(_(t.rotate)&&t.rotate!==n.rotate&&this.options.rotatable&&(n.rotate=t.rotate,this.rotated=!0,this.renderCanvas(!0)),e=n.width/n.naturalWidth,_(t.x)&&(s.left=t.x*e+i.left),_(t.y)&&(s.top=t.y*e+i.top),_(t.width)&&(s.width=t.width*e),_(t.height)&&(s.height=t.height*e),this.setCropBoxData(s))},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var t,e=this.canvas;return this.built&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCanvasData:function(t){var e=this.canvas,n=e.aspectRatio;b.isFunction(t)&&(t=t.call(this.$element)),this.built&&!this.disabled&&b.isPlainObject(t)&&(_(t.left)&&(e.left=t.left),_(t.top)&&(e.top=t.top),_(t.width)?(e.width=t.width,e.height=t.width/n):_(t.height)&&(e.height=t.height,e.width=t.height*n),this.renderCanvas(!0))},getCropBoxData:function(){var t,e=this.cropBox;return this.built&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(t){var e,n,i=this.cropBox,s=this.options.aspectRatio;b.isFunction(t)&&(t=t.call(this.$element)),this.built&&this.cropped&&!this.disabled&&b.isPlainObject(t)&&(_(t.left)&&(i.left=t.left),_(t.top)&&(i.top=t.top),_(t.width)&&t.width!==i.width&&(e=!0,i.width=t.width),_(t.height)&&t.height!==i.height&&(n=!0,i.height=t.height),s&&(e?i.height=i.width/s:n&&(i.width=i.height*s)),this.renderCropBox())},getCroppedCanvas:function(t){var h,d,e,n,i,s,f,r,o,a,m;if(this.built&&this.cropped&&tt)return b.isPlainObject(t)||(t={}),m=this.getData(),h=m.width,d=m.height,r=h/d,b.isPlainObject(t)&&(i=t.width,s=t.height,i?(s=i/r,f=i/h):s&&(i=s*r,f=s/d)),e=i||h,n=s||d,(o=b("<canvas>")[0]).width=e,o.height=n,a=o.getContext("2d"),t.fillColor&&(a.fillStyle=t.fillColor,a.fillRect(0,0,e,n)),a.drawImage.apply(a,function(){var t,e,n,i,s,r,o=g(this.$clone[0],this.image),a=o.width,l=o.height,c=[o],p=m.x,u=m.y;return p<=-h||a<p?p=t=n=s=0:p<=0?(n=-p,t=s=nt(a,h+(p=0))):p<=a&&(n=0,t=s=nt(h,a-p)),t<=0||u<=-d||l<u?u=e=i=r=0:u<=0?(i=-u,e=r=nt(l,d+(u=0))):u<=l&&(i=0,e=r=nt(d,l-u)),c.push(p,u,t,e),f&&(n*=f,i*=f,s*=f,r*=f),0<s&&0<r&&c.push(n,i,s,r),c}.call(this)),o},setAspectRatio:function(t){var e=this.options;this.disabled||o(t)||(e.aspectRatio=at(t)||NaN,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},setDragMode:function(t){var e,n,i=this.options;this.ready&&!this.disabled&&(e=i.dragCrop&&t===Y,n=i.movable&&t===X,t=e||n?t:Q,this.$dragBox.data("action",t).toggleClass(k,e).toggleClass(y,n),i.cropBoxMovable||this.$face.data("action",t).toggleClass(k,e).toggleClass(y,n))}}),b.extend(p.prototype,lt),p.DEFAULTS={aspectRatio:NaN,data:null,preview:"",strict:!0,responsive:!0,checkImageOrigin:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,dragCrop:!0,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,mouseWheelZoom:!0,wheelZoomRatio:.1,touchDragZoom:!0,cropBoxMovable:!0,cropBoxResizable:!0,doubleClickToggle:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},p.setDefaults=function(t){b.extend(p.DEFAULTS,t)},p.TEMPLATE='<div class="cropper-container"><div class="cropper-canvas"></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>',p.other=b.fn.cropper,b.fn.cropper=function(i){var s,r=a(arguments,1);return this.each(function(){var t,e=b(this),n=e.data(h);if(!n){if(/destroy/.test(i))return;e.data(h,n=new p(this,i))}"string"==typeof i&&b.isFunction(t=n[i])&&(s=t.apply(n,r))}),o(s)?this:s},b.fn.cropper.Constructor=p,b.fn.cropper.setDefaults=p.setDefaults,b.fn.cropper.noConflict=function(){return b.fn.cropper=p.other,this}}),function(s){function r(t,e){var n;return s.Notification?n=new s.Notification(t,{icon:y(e.icon)?e.icon:e.icon.x32,body:e.body||f,tag:e.tag||f}):s.webkitNotifications?(n=s.webkitNotifications.createNotification(e.icon,t,e.body)).show():navigator.mozNotification?(n=navigator.mozNotification.createNotification(t,e.body,e.icon)).show():s.external&&s.external.msIsSiteMode()&&(s.external.msSiteModeClearIconOverlay(),s.external.msSiteModeSetIconOverlay(y(e.icon)?e.icon:e.icon.x16,t),s.external.msSiteModeActivate(),n={ieVerification:g+1}),n}function o(t){return{close:function(){t&&(t.close?t.close():s.external&&s.external.msIsSiteMode()&&t.ieVerification===g&&s.external.msSiteModeClearIconOverlay())}}}function t(t){if(m){var e=v(t)?t:w;s.webkitNotifications&&s.webkitNotifications.checkPermission?s.webkitNotifications.requestPermission(e):s.Notification&&s.Notification.requestPermission&&s.Notification.requestPermission(e)}}function a(){var t;if(m)return s.Notification&&s.Notification.permissionLevel?t=s.Notification.permissionLevel():s.webkitNotifications&&s.webkitNotifications.checkPermission?t=u[s.webkitNotifications.checkPermission()]:navigator.mozNotification?t=c:s.Notification&&s.Notification.permission?t=s.Notification.permission:s.external&&s.external.msIsSiteMode()!==undefined&&(t=s.external.msIsSiteMode()?c:i),t}function e(t){return t&&b(t)&&_(k,t),k}function l(){return!k.pageVisibility||(document.hidden||document.msHidden||document.mozHidden||document.webkitHidden)}function n(t,e){var n,i;return m&&l()&&y(t)&&e&&(y(e.icon)||b(e.icon))&&a()===c&&(n=r(t,e)),i=o(n),k.autoClose&&n&&!n.ieVerification&&n.addEventListener&&n.addEventListener("show",function(){var t=i;s.setTimeout(function(){t.close()},k.autoClose)}),i}var i="default",c="granted",p="denied",u=[c,i,p],h={pageVisibility:!0,autoClose:5e3},d={},f="",m=function(){var t=!1;try{t=!!(s.Notification||s.webkitNotifications||navigator.mozNotification||s.external&&s.external.msIsSiteMode()!==undefined)}catch(e){}return t}(),g=Math.floor(10*Math.random()+1),v=function(t){return t&&t.constructor===Function},y=function(t){return t&&t.constructor===String},b=function(t){return t&&t.constructor===Object},_=function(t,e){var n,i;for(n in e)i=e[n],n in t&&(t[n]===i||n in d&&d[n]===i)||(t[n]=i);return t},w=function(){},k=h;s.notify={PERMISSION_DEFAULT:i,PERMISSION_GRANTED:c,PERMISSION_DENIED:p,isSupported:m,config:e,createNotification:n,permissionLevel:a,requestPermission:t},v(Object.freeze)&&Object.freeze(s.notify)}(window),function(t){"use strict";function e(o){function n(){return Et<Dt}function i(){return It[Et]}function l(){return Et}function c(t){Et=t}function s(){Et+=1}function t(){Et=0,Dt=It.length}function p(t,e){return{name:t,tokens:e||"",semantic:e||"",children:[]}}function r(t,e){var n;return null===e?null:((n=p(t)).tokens=e.tokens,n.semantic=e.semantic,n.children.push(e),n)}function u(t,e){return null!==e&&(t.tokens+=e.tokens,t.semantic+=e.semantic),t.children.push(e),t}function a(t){var e;return n()&&t(e=i())?(s(),p("token",e)):null}function h(e){return function t(){return r("literal",a(function(t){return t===e}))}}function d(){var s=arguments;return function r(){var t,e,n,i;for(i=l(),e=p("and"),t=0;t<s.length;t+=1){if(null===(n=s[t]()))return c(i),null;u(e,n)}return e}}function f(){var i=arguments;return function s(){var t,e,n;for(n=l(),t=0;t<i.length;t+=1){if(null!==(e=i[t]()))return e;c(n)}return null}}function e(n){
return function i(){var t,e;return e=l(),null!==(t=n())?t:(c(e),p("opt"))}}function m(e){return function n(){var t=e();return null!==t&&(t.semantic=""),t}}function g(e){return function n(){var t=e();return null!==t&&0<t.semantic.length&&(t.semantic=" "),t}}function v(r,o){return function a(){var t,e,n,i,s;for(i=l(),t=p("star"),n=0,s=o===undefined?0:o;null!==(e=r());)n+=1,u(t,e);return s<=n?t:(c(i),null)}}function y(t){return t.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")}function b(t){return 128<=t.charCodeAt(0)}function _(){return r("cr",h("\r")())}function w(){return r("crlf",d(_,A)())}function k(){return r("dquote",h('"')())}function T(){return r("htab",h("\t")())}function A(){return r("lf",h("\n")())}function S(){return r("sp",h(" ")())}function C(){return r("vchar",a(function i(t){var e=t.charCodeAt(0),n=33<=e&&e<=126;return o.rfc6532&&(n=n||b(t)),n}))}function x(){return r("wsp",f(S,T)())}function j(){var t=r("quoted-pair",f(d(h("\\"),f(C,x)),ct)());return null===t?null:(t.semantic=t.semantic[1],t)}function P(){return r("fws",f(ut,d(e(d(v(x),m(w))),v(x,1)))())}function I(){return r("ctext",f(function t(){return a(function i(t){var e=t.charCodeAt(0),n=33<=e&&e<=39||42<=e&&e<=91||93<=e&&e<=126;return o.rfc6532&&(n=n||b(t)),n})},at)())}function E(){return r("ccontent",f(I,j,D)())}function D(){return r("comment",d(h("("),v(d(e(P),E)),e(P),h(")"))())}function O(){return r("cfws",f(d(v(d(e(P),D),1),e(P)),P)())}function N(){return r("atext",a(function n(t){var e="a"<=t&&t<="z"||"A"<=t&&t<="Z"||"0"<=t&&t<="9"||0<=["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(t);return o.rfc6532&&(e=e||b(t)),e}))}function R(){return r("atom",d(g(e(O)),v(N,1),g(e(O)))())}function M(){var t,e;return null===(t=r("dot-atom-text",v(N,1)()))||null!==(e=v(d(h("."),v(N,1)))())&&u(t,e),t}function $(){return r("dot-atom",d(m(e(O)),M,m(e(O)))())}function L(){return r("qtext",f(function t(){return a(function i(t){var e=t.charCodeAt(0),n=33===e||35<=e&&e<=91||93<=e&&e<=126;return o.rfc6532&&(n=n||b(t)),n})},lt)())}function U(){return r("qcontent",f(L,j)())}function z(){return r("quoted-string",d(m(e(O)),m(k),v(d(e(g(P)),U)),e(m(P)),m(k),m(e(O)))())}function B(){return r("word",f(R,z)())}function F(){return r("phrase",f(pt,v(B,1))())}function q(){return r("address",f(J,G)())}function J(){return r("mailbox",f(H,nt)())}function H(){return r("name-addr",d(e(K),W)())}function W(){return r("angle-addr",f(d(m(e(O)),h("<"),nt,h(">"),m(e(O))),ht)())}function G(){return r("group",d(K,h(":"),e(X),h(";"),m(e(O)))())}function K(){return r("display-name",function e(){var t=F();return null!==t&&(t.semantic=y(t.semantic)),t}())}function V(){return r("mailbox-list",f(d(J,v(d(h(","),J))),mt)())}function Y(){return r("address-list",f(d(q,v(d(h(","),q))),gt)())}function X(){return r("group-list",f(V,m(O),vt)())}function Z(){return r("local-part",f(yt,$,z)())}function Q(){return r("dtext",f(function t(){return a(function i(t){var e=t.charCodeAt(0),n=33<=e&&e<=90||94<=e&&e<=126;return o.rfc6532&&(n=n||b(t)),n})},_t)())}function tt(){return r("domain-literal",d(m(e(O)),h("["),v(d(e(P),Q)),e(P),h("]"),m(e(O)))())}function et(){return r("domain",function e(){var t=f(bt,$,tt)();return o.rejectTLD&&t&&t.semantic&&t.semantic.indexOf(".")<0?null:(t&&(t.semantic=t.semantic.replace(/\s+/g,"")),t)}())}function nt(){return r("addr-spec",d(Z,h("@"),et)())}function it(){return r("from",f(V,Y)())}function st(){return r("sender",f(J,q)())}function rt(){return r("reply-to",Y())}function ot(){return o.strict?null:r("obs-NO-WS-CTL",a(function(t){var e=t.charCodeAt(0);return 1<=e&&e<=8||11===e||12===e||14<=e&&e<=31||127===e}))}function at(){return o.strict?null:r("obs-ctext",ot())}function lt(){return o.strict?null:r("obs-qtext",ot())}function ct(){return o.strict?null:r("obs-qp",d(h("\\"),f(h("\0"),ot,A,_))())}function pt(){return o.strict?null:r("obs-phrase",d(B,v(f(B,h("."),g(O))))())}function ut(){return o.strict?null:r("obs-FWS",v(d(m(e(w)),x),1)())}function ht(){return o.strict?null:r("obs-angle-addr",d(m(e(O)),h("<"),dt,nt,h(">"),m(e(O)))())}function dt(){return o.strict?null:r("obs-route",d(ft,h(":"))())}function ft(){return o.strict?null:r("obs-domain-list",d(v(f(m(O),h(","))),h("@"),et,v(d(h(","),m(e(O)),e(d(h("@"),et)))))())}function mt(){return o.strict?null:r("obs-mbox-list",d(v(d(m(e(O)),h(","))),J,v(d(h(","),e(d(J,m(O))))))())}function gt(){return o.strict?null:r("obs-addr-list",d(v(d(m(e(O)),h(","))),q,v(d(h(","),e(d(q,m(O))))))())}function vt(){return o.strict?null:r("obs-group-list",d(v(d(m(e(O)),h(",")),1),m(e(O)))())}function yt(){return o.strict?null:r("obs-local-part",d(B,v(d(h("."),B)))())}function bt(){return o.strict?null:r("obs-domain",d(R,v(d(h("."),R)))())}function _t(){return o.strict?null:r("obs-dtext",f(ot,j)())}function wt(t,e){var n,i,s;if(null===e||e===undefined)return null;for(i=[e];0<i.length;){if((s=i.pop()).name===t)return s;for(n=s.children.length-1;0<=n;n-=1)i.push(s.children[n])}return null}function kt(t,e){var n,i,s,r;if(null===e||e===undefined)return null;for(i=[e],r=[];0<i.length;)for((s=i.pop()).name===t&&r.push(s),n=s.children.length-1;0<=n;n-=1)i.push(s.children[n]);return r}function Tt(t,e){var n,i,s,r,o;if(null===e||e===undefined)return null;for(i=[e],r=[],o={},n=0;n<t.length;n+=1)o[t[n]]=!0;for(;0<i.length;)if((s=i.pop()).name in o)r.push(s);else for(n=s.children.length-1;0<=n;n-=1)i.push(s.children[n]);return r}function At(t){var e,n,i,s,r;if(null===t)return null;for(e=[],n=Tt(["group","mailbox"],t),i=0;i<n.length;i+=1)"group"===(s=n[i]).name?e.push(St(s)):"mailbox"===s.name&&e.push(Ct(s));return r={ast:t,addresses:e},o.simple&&(r=jt(r)),o.oneResult?Pt(r):o.simple?r&&r.addresses:r}function St(t){var e,n=wt("display-name",t),i=[],s=Tt(["mailbox"],t);for(e=0;e<s.length;e+=1)i.push(Ct(s[e]));return{node:t,parts:{name:n},type:t.name,name:xt(n),addresses:i}}function Ct(t){var e=wt("display-name",t),n=wt("addr-spec",t),i=kt("cfws",t),s=wt("local-part",n),r=wt("domain",n);return{node:t,parts:{name:e,address:n,local:s,domain:r,comments:i},type:t.name,name:xt(e),address:xt(n),local:xt(s),domain:xt(r),groupName:xt(t.groupName)}}function xt(t){return null!==t&&t!==undefined?t.semantic:null}function jt(t){var e;if(t&&t.addresses)for(e=0;e<t.addresses.length;e+=1)delete t.addresses[e].node;return t}function Pt(t){return t?!o.partial&&1<t.addresses.length?null:t.addresses&&t.addresses[0]:null}var It,Et,Dt,Ot,Nt;if(null===(o=Rt(o,{})))return null;if(It=o.input,Nt={address:q,"address-list":Y,"angle-addr":W,from:it,group:G,mailbox:J,"mailbox-list":V,"reply-to":rt,sender:st}[o.startAt]||Y,!o.strict){if(t(),o.strict=!0,Ot=Nt(It),o.partial||!n())return At(Ot);o.strict=!1}return t(),Ot=Nt(It),!o.partial&&n()?null:At(Ot)}function n(t){return e(Rt(t,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))}function i(t){return e(Rt(t,{rfc6532:!0,simple:!0,startAt:"address-list"}))}function s(t){return e(Rt(t,{rfc6532:!0,simple:!0,startAt:"from"}))}function r(t){return e(Rt(t,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))}function o(t){return e(Rt(t,{rfc6532:!0,simple:!0,startAt:"reply-to"}))}function Rt(t,e){function n(t){return"[object String]"===Object.prototype.toString.call(t)}function i(t){return t===Object(t)}function s(t){return null===t||t===undefined}var r,o;if(n(t))t={input:t};else if(!i(t))return null;if(!n(t.input))return null;if(!e)return null;for(o in r={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1})s(t[o])&&(t[o]=s(e[o])?r[o]:e[o]);return t}e.parseOneAddress=n,e.parseAddressList=i,e.parseFrom=s,e.parseSender=r,e.parseReplyTo=o,t.emailAddresses=e}(this),function(){function s(t){return!!t.exifdata}function r(t,e){e=e||t.match(/^data\:([^\;]+)\;base64,/im)[1]||"",t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(t),i=n.length,s=new ArrayBuffer(i),r=new Uint8Array(s),o=0;o<i;o++)r[o]=n.charCodeAt(o);return s}function o(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.onload=function(){200!=this.status&&0!==this.status||e(this.response)},n.send()}function i(i,s){function e(t){var e=a(t),n=l(t);i.exifdata=e||{},i.iptcdata=n||{},s&&s.call(i)}if(i.src)if(/^data\:/i.test(i.src))e(r(i.src));else if(/^blob\:/i.test(i.src)){(n=new FileReader).onload=function(t){e(t.target.result)},o(i.src,function(t){n.readAsArrayBuffer(t)})}else{var t=new XMLHttpRequest;t.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";e(t.response),t=null},t.open("GET",i.src,!0),t.responseType="arraybuffer",t.send(null)}else if(window.FileReader&&(i instanceof window.Blob||i instanceof window.File)){var n;(n=new FileReader).onload=function(t){d&&console.log("Got file of length "+t.target.result.byteLength),e(t.target.result)},n.readAsArrayBuffer(i)}}function a(t){var e=new DataView(t);if(d&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return d&&console.log("Not a valid JPEG"),!1;for(var n,i=2,s=t.byteLength;i<s;){if(255!=e.getUint8(i))return d&&console.log("Not a valid marker at offset "+i+", found: "+e.getUint8(i)),!1;if(n=e.getUint8(i+1),d&&console.log(n),225==n)return d&&console.log("Found 0xFFE1 marker"),h(e,i+4,e.getUint16(i+2)-2);i+=2+e.getUint16(i+2)}}function l(t){var e=new DataView(t);if(d&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return d&&console.log("Not a valid JPEG"),!1;for(var n=2,i=t.byteLength,s=function(t,e){return 56===t.getUint8(e)&&66===t.getUint8(e+1)&&73===t.getUint8(e+2)&&77===t.getUint8(e+3)&&4===t.getUint8(e+4)&&4===t.getUint8(e+5)};n<i;){if(s(e,n)){var r=e.getUint8(n+7);return r%2!=0&&(r+=1),0===r&&(r=4),c(t,n+8+r,e.getUint16(n+6+r))}n++}}function c(t,e,n){for(var i,s,r,o,a=new DataView(t),l={},c=e;c<e+n;)28===a.getUint8(c)&&2===a.getUint8(c+1)&&(o=a.getUint8(c+2))in b&&((r=a.getInt16(c+3))+5,s=b[o],i=f(a,c+5,r),l.hasOwnProperty(s)?l[s]instanceof Array?l[s].push(i):l[s]=[l[s],i]:l[s]=i),c++;return l}function p(t,e,n,i,s){var r,o,a,l=t.getUint16(n,!s),c={};for(a=0;a<l;a++)r=n+12*a+2,!(o=i[t.getUint16(r,!s)])&&d&&console.log("Unknown tag: "+t.getUint16(r,!s)),c[o]=u(t,r,e,n,s);return c}function u(t,e,n,i,s){var r,o,a,l,c,p,u=t.getUint16(e+2,!s),h=t.getUint32(e+4,!s),d=t.getUint32(e+8,!s)+n;switch(u){case 1:case 7:if(1==h)return t.getUint8(e+8,!s);for(r=4<h?d:e+8,o=[],l=0;l<h;l++)o[l]=t.getUint8(r+l);return o;case 2:return f(t,r=4<h?d:e+8,h-1);case 3:if(1==h)return t.getUint16(e+8,!s);for(r=2<h?d:e+8,o=[],l=0;l<h;l++)o[l]=t.getUint16(r+2*l,!s);return o;case 4:if(1==h)return t.getUint32(e+8,!s);for(o=[],l=0;l<h;l++)o[l]=t.getUint32(d+4*l,!s);return o;case 5:if(1==h)return c=t.getUint32(d,!s),p=t.getUint32(d+4,!s),(a=new Number(c/p)).numerator=c,a.denominator=p,a;for(o=[],l=0;l<h;l++)c=t.getUint32(d+8*l,!s),p=t.getUint32(d+4+8*l,!s),o[l]=new Number(c/p),o[l].numerator=c,o[l].denominator=p;return o;case 9:if(1==h)return t.getInt32(e+8,!s);for(o=[],l=0;l<h;l++)o[l]=t.getInt32(d+4*l,!s);return o;case 10:if(1==h)return t.getInt32(d,!s)/t.getInt32(d+4,!s);for(o=[],l=0;l<h;l++)o[l]=t.getInt32(d+8*l,!s)/t.getInt32(d+4+8*l,!s);return o}}function f(t,e,i){var s="";for(n=e;n<e+i;n++)s+=String.fromCharCode(t.getUint8(n));return s}function h(t,e){if("Exif"!=f(t,e,4))return d&&console.log("Not valid EXIF data! "+f(t,e,4)),!1;var n,i,s,r,o,a=e+6;if(18761==t.getUint16(a))n=!1;else{if(19789!=t.getUint16(a))return d&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;n=!0}if(42!=t.getUint16(a+2,!n))return d&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var l=t.getUint32(a+4,!n);if(l<8)return d&&console.log("Not valid TIFF data! (First offset less than 8)",t.getUint32(a+4,!n)),!1;if((i=p(t,a,a+l,g,n)).ExifIFDPointer)for(s in r=p(t,a,a+i.ExifIFDPointer,m,n)){switch(s){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":r[s]=y[s][r[s]];break;case"ExifVersion":case"FlashpixVersion":r[s]=String.fromCharCode(r[s][0],r[s][1],r[s][2],r[s][3]);break;case"ComponentsConfiguration":r[s]=y.Components[r[s][0]]+y.Components[r[s][1]]+y.Components[r[s][2]]+y.Components[r[s][3]]}i[s]=r[s]}if(i.GPSInfoIFDPointer)for(s in o=p(t,a,a+i.GPSInfoIFDPointer,v,n)){switch(s){case"GPSVersionID":o[s]=o[s][0]+"."+o[s][1]+"."+o[s][2]+"."+o[s][3]}i[s]=o[s]}return i}var d=!1,t=this,e=function(t){return t instanceof e?t:this instanceof e?void(this.EXIFwrapped=t):new e(t)};"undefined"!=typeof exports?(void 0!==module&&module.exports&&(exports=module.exports=e),exports.EXIF=e):t.EXIF=e;var m=e.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},g=e.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},v=e.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},y=e.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},b={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};e.getData=function(t,e){return!((t instanceof Image||t instanceof HTMLImageElement)&&!t.complete)&&(s(t)?e&&e.call(t):i(t,e),!0)},e.getTag=function(t,e){if(s(t))return t.exifdata[e]},e.getAllTags=function(t){if(!s(t))return{};var e,n=t.exifdata,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=n[e]);return i},e.pretty=function(t){if(!s(t))return"";var e,n=t.exifdata,i="";for(e in n)n.hasOwnProperty(e)&&("object"==typeof n[e]?n[e]instanceof Number?i+=e+" : "+n[e]+" ["+n[e].numerator+"/"+n[e].denominator+"]\r\n":i+=e+" : ["+n[e].length+" values]\r\n":i+=e+" : "+n[e]+"\r\n");return i},e.readFromBinaryFile=function(t){return a(t)},"function"==typeof define&&define.amd&&define("exif-js",[],function(){return e})}.call(this),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(s){function i(t){window.console&&console.warn&&console.warn(t)}var r=function(t,e){r._registry.push(this),this.$textarea=t,this.$textCopy=s("<span />"),this.$clone=s("<pre class='expanding-clone'><br /></pre>").prepend(this.$textCopy),this._resetStyles(),this._setCloneStyles(),this._setTextareaStyles(),t.wrap(s("<div class='expanding-wrapper' style='position:relative' />")).after(this.$clone),this.attach(),this.update(),e.update&&t.bind("update.expanding",e.update)};r._registry=[],r.getExpandingInstance=function(t){var e=s.map(r._registry,function(t){return t.$textarea[0]}),n=s.inArray(t,e);return-1<n?r._registry[n]:null};var t=function(){var t=-1;if("Microsoft Internet Explorer"===navigator.appName){var e=navigator.userAgent;null!==new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t}(),n="oninput"in document.createElement("input")&&9!==t;r.prototype={attach:function(){var t="input.expanding change.expanding",e=this;n||(t+=" keyup.expanding"),this.$textarea.bind(t,function(){e.update()})},update:function(){this.$textCopy.text(this.$textarea.val().replace(/\r\n/g,"\n")),this.$textarea.triggerHandler("update.expanding")},destroy:function(){this.$clone.remove(),this.$textarea.unwrap().attr("style",this._oldTextareaStyles||""),delete this._oldTextareaStyles;var t=s.inArray(this,r._registry);-1<t&&r._registry.splice(t,1),this.$textarea.unbind("input.expanding change.expanding keyup.expanding update.expanding")},_resetStyles:function(){this._oldTextareaStyles=this.$textarea.attr("style"),this.$textarea.add(this.$clone).css({margin:0,webkitBoxSizing:"border-box",mozBoxSizing:"border-box",boxSizing:"border-box",width:"100%"})},_setCloneStyles:function(){var t={display:"block",border:"0 solid",visibility:"hidden",minHeight:this.$textarea.outerHeight()};"off"===this.$textarea.attr("wrap")?t.overflowX="scroll":t.whiteSpace="pre-wrap",this.$clone.css(t),this._copyTextareaStylesToClone()},_copyTextareaStylesToClone:function(){var i=this,t=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","wordWrap","word-break","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","paddingLeft","paddingRight","paddingTop","paddingBottom","maxHeight"];s.each(t,function(t,e){var n=i.$textarea.css(e);i.$clone.css(e)!==n&&(i.$clone.css(e,n),"maxHeight"===e&&"none"!==n&&i.$clone.css("overflow","hidden"))})},_setTextareaStyles:function(){this.$textarea.css({position:"absolute",top:0,left:0,height:"100%",resize:"none",overflow:"auto"})}},s.expanding=s.extend({autoInitialize:!0,initialSelector:"textarea.expanding",opts:{update:function(){}}},s.expanding||{}),s.fn.expanding=function(t){if("destroy"===t)return this.each(function(){var t=r.getExpandingInstance(this);t&&t.destroy()}),this;if("active"===t)return!!this.filter(function(){return!!r.getExpandingInstance(this)}).length;var n=s.extend({},s.expanding.opts,t);return this.filter("textarea").each(function(){var t=0<this.offsetWidth||0<this.offsetHeight,e=r.getExpandingInstance(this);t&&!e?new r(s(this),n):(t||i("ExpandingTextareas: attempt to initialize an invisible textarea. Call expanding() again once it has been inserted into the page and/or is visible."),e&&i("ExpandingTextareas: attempt to initialize a textarea that has already been initialized. Subsequent calls are ignored."))}),this},s(function(){s.expanding.autoInitialize&&s(s.expanding.initialSelector).expanding()})}),function(t){var e="object"==typeof window&&window||"object"==typeof self&&self;"undefined"!=typeof exports?t(exports):e&&(e.hljs=t({}),"function"==typeof define&&define.amd&&define([],function(){return e.hljs}))}(function(s){function S(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function u(t){return t.nodeName.toLowerCase()}function C(t,e){var n=t&&t.exec(e);return n&&0===n.index}function a(t){return b.test(t)}function l(t){var e,n,i,s,r=t.className+" ";if(r+=t.parentNode?t.parentNode.className:"",n=_.exec(r))return I(n[1])?n[1]:"no-highlight";for(e=0,i=(r=r.split(/\s+/)).length;e<i;e++)if(a(s=r[e])||I(s))return s}function n(t){var e,n={},i=Array.prototype.slice.call(arguments,1);for(e in t)n[e]=t[e];return i.forEach(function(t){for(e in t)n[e]=t[e]}),n}function c(t){var i=[];return function s(t,e){for(var n=t.firstChild;n;n=n.nextSibling)3===n.nodeType?e+=n.nodeValue.length:1===n.nodeType&&(i.push({event:"start",offset:e,node:n}),e=s(n,e),u(n).match(/br|hr|img|input/)||i.push({event:"stop",offset:e,node:n}));return e}(t,0),i}function p(t,e,n){function i(){return t.length&&e.length?t[0].offset!==e[0].offset?t[0].offset<e[0].offset?t:e:"start"===e[0].event?t:e:t.length?t:e}function s(t){function e(t){return" "+t.nodeName+'="'+S(t.value).replace('"',"&quot;")+'"'}l+="<"+u(t)+g.map.call(t.attributes,e).join("")+">"}function r(t){l+="</"+u(t)+">"}function o(t){("start"===t.event?s:r)(t.node)}for(var a=0,l="",c=[];t.length||e.length;){var p=i();if(l+=S(n.substring(a,p[0].offset)),a=p[0].offset,p===t){for(c.reverse().forEach(r);o(p.splice(0,1)[0]),(p=i())===t&&p.length&&p[0].offset===a;);c.reverse().forEach(s)}else"start"===p[0].event?c.push(p[0].node):c.pop(),o(p.splice(0,1)[0])}return l+S(n.substr(a))}function h(e){return e.v&&!e.cached_variants&&(e.cached_variants=e.v.map(function(t){return n(e,{v:null},t)})),e.cached_variants||e.eW&&[n(e)]||[e]}function x(r){function o(t){return t&&t.source||t}function a(t,e){return new RegExp(o(t),"m"+(r.cI?"i":"")+(e?"g":""))}function l(e,t){if(!e.compiled){if(e.compiled=!0,e.k=e.k||e.bK,e.k){var i={},n=function(n,t){r.cI&&(t=t.toLowerCase()),t.split(" ").forEach(function(t){var e=t.split("|");i[e[0]]=[n,e[1]?Number(e[1]):1]})};"string"==typeof e.k?n("keyword",e.k):v(e.k).forEach(function(t){n(t,e.k[t])}),e.k=i}e.lR=a(e.l||/\w+/,!0),t&&(e.bK&&(e.b="\\b("+e.bK.split(" ").join("|")+")\\b"),e.b||(e.b=/\B|\b/),e.bR=a(e.b),e.e||e.eW||(e.e=/\B|\b/),e.e&&(e.eR=a(e.e)),e.tE=o(e.e)||"",e.eW&&t.tE&&(e.tE+=(e.e?"|":"")+t.tE)),e.i&&(e.iR=a(e.i)),null==e.r&&(e.r=1),e.c||(e.c=[]),e.c=Array.prototype.concat.apply([],e.c.map(function(t){return h("self"===t?e:t)})),e.c.forEach(function(t){l(t,e)}),e.starts&&l(e.starts,t);var s=e.c.map(function(t){return t.bK?"\\.?("+t.b+")\\.?":t.b}).concat([e.tE,e.i]).map(o).filter(Boolean);e.t=s.length?a(s.join("|"),!0):{exec:function(){return null}}}}l(r)}function j(t,e,n,i){function r(t,e){var n,i;for(n=0,i=e.c.length;n<i;n++)if(C(e.c[n].bR,t))return e.c[n]}function o(t,e){if(C(t.eR,e)){for(;t.endsParent&&t.parent;)t=t.parent;return t}return t.eW?o(t.parent,e):void 0}function a(t,e){return!n&&C(e.iR,t)}function s(t,e){var n=f.cI?e[0].toLowerCase():e[0];return t.k.hasOwnProperty(n)&&t.k[n]}function l(t,e,n,i){var s='<span class="'+(i?"":O.classPrefix);return(s+=t+'">')+e+(n?"":D)}function c(){var t,e,n,i;if(!g.k)return S(b);for(i="",e=0,g.lR.lastIndex=0,n=g.lR.exec(b);n;)i+=S(b.substring(e,n.index)),(t=s(g,n))?(_+=t[1],i+=l(t[0],S(n[0]))):i+=S(n[0]),e=g.lR.lastIndex,n=g.lR.exec(b);return i+S(b.substr(e))}function p(){var t="string"==typeof g.sL;if(t&&!E[g.sL])return S(b);var e=t?j(g.sL,b,!0,v[g.sL]):P(b,g.sL.length?g.sL:void 0);return 0<g.r&&(_+=e.r),t&&(v[g.sL]=e.top),l(e.language,e.value,!1,!0)}function u(){y+=null!=g.sL?p():c(),b=""}function h(t){y+=t.cN?l(t.cN,"",!0):"",g=Object.create(t,{parent:{value:g}})}function d(t,e){if(b+=t,null==e)return u(),0;var n=r(e,g);if(n)return n.skip?b+=e:(n.eB&&(b+=e),u(),n.rB||n.eB||(b=e)),h(n,e),n.rB?0:e.length;var i=o(g,e);if(i){var s=g;for(s.skip?b+=e:(s.rE||s.eE||(b+=e),u(),s.eE&&(b=e));g.cN&&(y+=D),g.skip||(_+=g.r),(g=g.parent)!==i.parent;);return i.starts&&h(i.starts,""),s.rE?0:e.length}if(a(e,g))throw new Error('Illegal lexeme "'+e+'" for mode "'+(g.cN||"<unnamed>")+'"');return b+=e,e.length||1}var f=I(t);if(!f)throw new Error('Unknown language: "'+t+'"');x(f);var m,g=i||f,v={},y="";for(m=g;m!==f;m=m.parent)m.cN&&(y=l(m.cN,"",!0)+y);var b="",_=0;try{for(var w,k,T=0;g.t.lastIndex=T,w=g.t.exec(e);)k=d(e.substring(T,w.index),w[0]),T=w.index+k;for(d(e.substr(T)),m=g;m.parent;m=m.parent)m.cN&&(y+=D);return{r:_,value:y,language:t,top:g}}catch(A){if(A.message&&-1!==A.message.indexOf("Illegal"))return{r:0,value:S(e)};throw A}}function P(n,t){t=t||O.languages||v(E);var i={r:0,value:S(n)},s=i;return t.filter(I).forEach(function(t){var e=j(t,n,!1);e.language=t,e.r>s.r&&(s=e),e.r>i.r&&(s=i,i=e)}),s.language&&(i.second_best=s),i}function d(t){return O.tabReplace||O.useBR?t.replace(w,function(t,e){return O.useBR&&"\n"===t?"<br>":O.tabReplace?e.replace(/\t/g,O.tabReplace):""}):t}function f(t,e,n){var i=e?y[e]:n,s=[t.trim()];return t.match(/\bhljs\b/)||s.push("hljs"),-1===t.indexOf(i)&&s.push(i),s.join(" ").trim()}function e(t){var e,n,i,s,r,o=l(t);a(o)||(O.useBR?(e=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=t.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n"):e=t,r=e.textContent,i=o?j(o,r,!0):P(r),(n=c(e)).length&&((s=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=i.value,i.value=p(n,c(s),r)),i.value=d(i.value),t.innerHTML=i.value,t.className=f(t.className,o,i.language),t.result={language:i.language,re:i.r},i.second_best&&(t.second_best={language:i.second_best.language,re:i.second_best.r}))}function t(t){O=n(O,t)}function i(){if(!i.called){i.called=!0;var t=document.querySelectorAll("pre code");g.forEach.call(t,e)}}function r(){addEventListener("DOMContentLoaded",i,!1),addEventListener("load",i,!1)}function o(e,t){var n=E[e]=t(s);n.aliases&&n.aliases.forEach(function(t){y[t]=e})}function m(){return v(E)}function I(t){return t=(t||"").toLowerCase(),E[t]||E[y[t]]}var g=[],v=Object.keys,E={},y={},b=/^(no-?highlight|plain|text)$/i,_=/\blang(?:uage)?-([\w-]+)\b/i,w=/((^(<[^>]+>|\t|)+|(?:\n)))/gm,D="</span>",O={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0};return s.highlight=j,s.highlightAuto=P,s.fixMarkup=d,s.highlightBlock=e,s.configure=t,s.initHighlighting=i,s.initHighlightingOnLoad=r,s.registerLanguage=o,s.listLanguages=m,s.getLanguage=I,s.inherit=n,s.IR="[a-zA-Z]\\w*",s.UIR="[a-zA-Z_]\\w*",s.NR="\\b\\d+(\\.\\d+)?",s.CNR="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",s.BNR="\\b(0b[01]+)",s.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",s.BE={b:"\\\\[\\s\\S]",r:0},s.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[s.BE]},s.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[s.BE]},s.PWM={b:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},s.C=function(t,e,n){var i=s.inherit({cN:"comment",b:t,e:e,c:[]},n||{});return i.c.push(s.PWM),i.c.push({cN:"doctag",b:"(?:TODO|FIXME|NOTE|BUG|XXX):",r:0}),i},s.CLCM=s.C("//","$"),s.CBCM=s.C("/\\*","\\*/"),s.HCM=s.C("#","$"),s.NM={cN:"number",b:s.NR,r:0},s.CNM={cN:"number",b:s.CNR,r:0},s.BNM={cN:"number",b:s.BNR,r:0},s.CSSNM={cN:"number",b:s.NR+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",r:0},s.RM={cN:"regexp",b:/\//,e:/\/[gimuy]*/,i:/\n/,c:[s.BE,{b:/\[/,e:/\]/,r:0,c:[s.BE]}]},s.TM={cN:"title",b:s.IR,r:0},s.UTM={cN:"title",b:s.UIR,r:0},s.METHOD_GUARD={b:"\\.\\s*"+s.UIR,r:0},s}),hljs.registerLanguage("ruby",function(t){var e="[a-zA-Z_]\\w*[!?=]?|[-+~]\\@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?",n={keyword:"and then defined module in return redo if BEGIN retry end for self when next until do begin unless END rescue else break undef not super class case require yield alias while ensure elsif or include attr_reader attr_writer attr_accessor",literal:"true false nil"},i={cN:"doctag",b:"@[A-Za-z]+"},s={b:"#<",e:">"},r=[t.C("#","$",{c:[i]}),t.C("^\\=begin","^\\=end",{c:[i],r:10}),t.C("^__END__","\\n$")],o={cN:"subst",b:"#\\{",e:"}",k:n},a={cN:"string",c:[t.BE,o],v:[{b:/'/,e:/'/},{b:/"/,e:/"/},{b:/`/,e:/`/},{b:"%[qQwWx]?\\(",e:"\\)"},{b:"%[qQwWx]?\\[",e:"\\]"},{b:"%[qQwWx]?{",e:"}"},{b:"%[qQwWx]?<",e:">"},{b:"%[qQwWx]?/",e:"/"},{b:"%[qQwWx]?%",e:"%"},{b:"%[qQwWx]?-",e:"-"},{b:"%[qQwWx]?\\|",e:"\\|"},{b:/\B\?(\\\d{1,3}|\\x[A-Fa-f0-9]{1,2}|\\u[A-Fa-f0-9]{4}|\\?\S)\b/},{b:/<<(-?)\w+$/,e:/^\s*\w+$/}]},l={cN:"params",b:"\\(",e:"\\)",endsParent:!0,k:n},c=[a,s,{cN:"class",bK:"class module",e:"$|;",i:/=/,c:[t.inherit(t.TM,{b:"[A-Za-z_]\\w*(::\\w+)*(\\?|\\!)?"}),{b:"<\\s*",c:[{b:"("+t.IR+"::)?"+t.IR}]}].concat(r)},{cN:"function",bK:"def",e:"$|;",c:[t.inherit(t.TM,{b:e}),l].concat(r)},{b:t.IR+"::"},{cN:"symbol",b:t.UIR+"(\\!|\\?)?:",r:0},{cN:"symbol",b:":(?!\\s)",c:[a,{b:e}],r:0},{cN:"number",b:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",r:0},{b:"(\\$\\W)|((\\$|\\@\\@?)(\\w+))"},{cN:"params",b:/\|/,e:/\|/,k:n},{b:"("+t.RSR+"|unless)\\s*",k:"unless",c:[s,{cN:"regexp",c:[t.BE,o],i:/\n/,v:[{b:"/",e:"/[a-z]*"},{b:"%r{",e:"}[a-z]*"},{b:"%r\\(",e:"\\)[a-z]*"},{b:"%r!",e:"![a-z]*"},{b:"%r\\[",e:"\\][a-z]*"}]}].concat(r),r:0}].concat(r);o.c=c;var p=[{b:/^\s*=>/,starts:{e:"$",c:l.c=c}},{cN:"meta",b:"^("+"[>?]>"+"|"+"[\\w#]+\\(\\w+\\):\\d+:\\d+>"+"|"+"(\\w+-)?\\d+\\.\\d+\\.\\d(p\\d+)?[^>]+>"+")",starts:{e:"$",c:c}}];return{aliases:["rb","gemspec","podspec","thor","irb"],k:n,i:/\/\*/,c:r.concat(p).concat(c)}}),hljs.registerLanguage("bash",function(t){var e={cN:"variable",v:[{b:/\$[\w\d#@][\w\d_]*/},{b:/\$\{(.*?)}/}]},n={cN:"string",b:/"/,e:/"/,c:[t.BE,e,{cN:"variable",b:/\$\(/,e:/\)/,c:[t.BE]}]},i={cN:"string",b:/'/,e:/'/};return{aliases:["sh","zsh"],l:/\b-?[a-z\._]+\b/,k:{
keyword:"if then else elif fi for while in do done case esac function",literal:"true false",built_in:"break cd continue eval exec exit export getopts hash pwd readonly return shift test times trap umask unset alias bind builtin caller command declare echo enable help let local logout mapfile printf read readarray source type typeset ulimit unalias set shopt autoload bg bindkey bye cap chdir clone comparguments compcall compctl compdescribe compfiles compgroups compquote comptags comptry compvalues dirs disable disown echotc echoti emulate fc fg float functions getcap getln history integer jobs kill limit log noglob popd print pushd pushln rehash sched setcap setopt stat suspend ttyctl unfunction unhash unlimit unsetopt vared wait whence where which zcompile zformat zftp zle zmodload zparseopts zprof zpty zregexparse zsocket zstyle ztcp",_:"-ne -eq -lt -gt -f -d -e -s -l -a"},c:[{cN:"meta",b:/^#![^\n]+sh\s*$/,r:10},{cN:"function",b:/\w[\w\d_]*\s*\(\s*\)\s*\{/,rB:!0,c:[t.inherit(t.TM,{b:/\w[\w\d_]*/})],r:0},t.HCM,n,i,e]}}),hljs.registerLanguage("javascript",function(t){var e="[A-Za-z$_][0-9A-Za-z$_]*",n={keyword:"in of if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const export super debugger as async await static import from as",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document Symbol Set Map WeakSet WeakMap Proxy Reflect Promise"},i={cN:"number",v:[{b:"\\b(0[bB][01]+)"},{b:"\\b(0[oO][0-7]+)"},{b:t.CNR}],r:0},s={cN:"subst",b:"\\$\\{",e:"\\}",k:n,c:[]},r={cN:"string",b:"`",e:"`",c:[t.BE,s]};s.c=[t.ASM,t.QSM,r,i,t.RM];var o=s.c.concat([t.CBCM,t.CLCM]);return{aliases:["js","jsx"],k:n,c:[{cN:"meta",r:10,b:/^\s*['"]use (strict|asm)['"]/},{cN:"meta",b:/^#!/,e:/$/},t.ASM,t.QSM,r,t.CLCM,t.CBCM,i,{b:/[{,]\s*/,r:0,c:[{b:e+"\\s*:",rB:!0,r:0,c:[{cN:"attr",b:e,r:0}]}]},{b:"("+t.RSR+"|\\b(case|return|throw)\\b)\\s*",k:"return throw case",c:[t.CLCM,t.CBCM,t.RM,{cN:"function",b:"(\\(.*?\\)|"+e+")\\s*=>",rB:!0,e:"\\s*=>",c:[{cN:"params",v:[{b:e},{b:/\(\s*\)/},{b:/\(/,e:/\)/,eB:!0,eE:!0,k:n,c:o}]}]},{b:/</,e:/(\/\w+|\w+\/)>/,sL:"xml",c:[{b:/<\w+\s*\/>/,skip:!0},{b:/<\w+/,e:/(\/\w+|\w+\/)>/,skip:!0,c:[{b:/<\w+\s*\/>/,skip:!0},"self"]}]}],r:0},{cN:"function",bK:"function",e:/\{/,eE:!0,c:[t.inherit(t.TM,{b:e}),{cN:"params",b:/\(/,e:/\)/,eB:!0,eE:!0,c:o}],i:/\[|%/},{b:/\$[(.]/},t.METHOD_GUARD,{cN:"class",bK:"class",e:/[{;=]/,eE:!0,i:/[:"\[\]]/,c:[{bK:"extends"},t.UTM]},{bK:"constructor",e:/\{/,eE:!0}],i:/#(?!!)/}}),hljs.registerLanguage("css",function(t){var e="[a-zA-Z-][a-zA-Z0-9_-]*",n={b:/[A-Z\_\.\-]+\s*:/,rB:!0,e:";",eW:!0,c:[{cN:"attribute",b:/\S/,e:":",eE:!0,starts:{eW:!0,eE:!0,c:[{b:/[\w-]+\(/,rB:!0,c:[{cN:"built_in",b:/[\w-]+/},{b:/\(/,e:/\)/,c:[t.ASM,t.QSM]}]},t.CSSNM,t.QSM,t.ASM,t.CBCM,{cN:"number",b:"#[0-9A-Fa-f]+"},{cN:"meta",b:"!important"}]}}]};return{cI:!0,i:/[=\/|'\$]/,c:[t.CBCM,{cN:"selector-id",b:/#[A-Za-z0-9_-]+/},{cN:"selector-class",b:/\.[A-Za-z0-9_-]+/},{cN:"selector-attr",b:/\[/,e:/\]/,i:"$"},{cN:"selector-pseudo",b:/:(:)?[a-zA-Z0-9\_\-\+\(\)"'.]+/},{b:"@(font-face|page)",l:"[a-z-]+",k:"font-face page"},{b:"@",e:"[{;]",i:/:/,c:[{cN:"keyword",b:/\w+/},{b:/\s/,eW:!0,eE:!0,r:0,c:[t.ASM,t.QSM,t.CSSNM]}]},{cN:"selector-tag",b:e,r:0},{b:"{",e:"}",i:/\S/,c:[t.CBCM,n]}]}}),hljs.registerLanguage("xml",function(t){var e={eW:!0,i:/</,r:0,c:[{cN:"attr",b:"[A-Za-z0-9\\._:-]+",r:0},{b:/=\s*/,r:0,c:[{cN:"string",endsParent:!0,v:[{b:/"/,e:/"/},{b:/'/,e:/'/},{b:/[^\s"'=<>`]+/}]}]}]};return{aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist"],cI:!0,c:[{cN:"meta",b:"<!DOCTYPE",e:">",r:10,c:[{b:"\\[",e:"\\]"}]},t.C("<!--","-->",{r:10}),{b:"<\\!\\[CDATA\\[",e:"\\]\\]>",r:10},{b:/<\?(php)?/,e:/\?>/,sL:"php",c:[{b:"/\\*",e:"\\*/",skip:!0}]},{cN:"tag",b:"<style(?=\\s|>|$)",e:">",k:{name:"style"},c:[e],starts:{e:"</style>",rE:!0,sL:["css","xml"]}},{cN:"tag",b:"<script(?=\\s|>|$)",e:">",k:{name:"script"},c:[e],starts:{e:"</script>",rE:!0,sL:["actionscript","javascript","handlebars","xml"]}},{cN:"meta",v:[{b:/<\?xml/,e:/\?>/,r:10},{b:/<\?\w+/,e:/\?>/}]},{cN:"tag",b:"</?",e:"/?>",c:[{cN:"name",b:/[^\/><\s]+/,r:0},e]}]}});var module={},noop=function(){},console=window.console||{log:noop},supportsFileApi;FileUpload.prototype={on:function(t){this.eventHandlers=t}},UploadManager.prototype={initialize:function(){var e=this,n=e.dropContainer,t=e.inputField,i=e.cancelContainer,s=0,r=function(t){t.preventDefault(),t.stopPropagation(),s++,showDropZone(n)};stopEvent=function(t){t.preventDefault(),t.stopPropagation()},leaveEvent=function(t){t.preventDefault(),t.stopPropagation(),0==--s&&hideDropZone(n)},showDropZone=function(t){$(t).trigger("html5Upload.dropZone.show"),$(t).find(".article-content, .richtext").hasClass("is-dropTarget")||$(t).find(".article-content, .richtext").addClass("is-dropTarget")},hideDropZone=function(t){$(t).trigger("html5Upload.dropZone.hide"),$(t).find(".article-content, .richtext").hasClass("is-dropTarget")&&$(t).find(".article-content, .richtext").removeClass("is-dropTarget")},n&&(e.on(n,"dragleave",leaveEvent),e.on(n,"dragover",stopEvent),e.on(n,"dragenter",r),e.on(n,"drop",function(t){s=0,stopEvent(t),hideDropZone(n),e.processFiles(t.dataTransfer.files)})),t&&e.on(t,"change",function(){e.processFiles(this.files)}),i&&i.on("click",function(){e.uploadCancel()})},processFiles:function(t){console.log("Processing files: "+t.length);var e,n,i,s=this,r=t.length;for(i=0;i<r;i+=1){if(0===(e=t[i]).size){alert("Files with files size zero cannot be uploaded or multiple file uploads are not supported by your browser");break}n=new FileUpload(e),s.uploadFile(n)}},uploadCancel:function(){var t=this;_.each(t._xhrs,function(t){t.abort()}),t._xhrs=[]},uploadFile:function(t){var e=this;if(e.onFileAdded(t),e.activeUploads===e.maxSimultaneousUploads)return console.log("Queue upload: "+t.fileName),void e.uploadsQueue.push(t);e.ajaxUpload(t)},ajaxUpload:function(e){var t,n,i,s,r=this,o=e.file,a=r.data,l=r.key||"file";if(console.log("Beging upload: "+e.fileName),r.activeUploads+=1,t=new window.XMLHttpRequest,r._xhrs.push(t),n=new window.FormData,i=o.name,t.open("POST",r.uploadUrl),App.Ajax&&App.Ajax.token&&t.setRequestHeader("X-CSRF-Token",App.Ajax.token()),t.upload.onloadstart=function(){console.log("Upload started: "+i),e.events.onStart()},t.upload.onprogress=function(t){t.lengthComputable&&e.events.onProgress(t.total,t.loaded)},t.onload=function(t){console.log("Upload completed: "+i),r.activeUploads-=1,e.events.onCompleted(t.target.responseText),r.uploadsQueue.length&&r.ajaxUpload(r.uploadsQueue.shift())},t.abort=function(){console.log("Upload abort"),r.activeUploads-=1,e.events.onAborted(),r.uploadsQueue=[]},t.onerror=function(){console.log("Upload failed: ",e.fileName)},a)for(s in a)a.hasOwnProperty(s)&&(console.log("Adding data: "+s+" = "+a[s]),n.append(s,a[s]));n.append(l,o),t.send(n)},on:function(t,e,n){t&&(t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n)}},module.fileApiSupported=function(){if("boolean"!=typeof supportsFileApi){var t=document.createElement("input");t.setAttribute("type","file"),supportsFileApi=!!t.files}return supportsFileApi},module.initialize=function(t){return new UploadManager(t)},window.html5Upload=module,function(t,e,n){void 0!==module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):e[t]=n()}("jquery-scrollto",this,function(){var v,y;return v=window.jQuery||require("jquery"),v.propHooks.scrollTop=v.propHooks.scrollLeft={get:function(t,e){var n=null;return"HTML"!==t.tagName&&"BODY"!==t.tagName||("scrollLeft"===e?n=window.scrollX:"scrollTop"===e&&(n=window.scrollY)),null==n&&(n=t[e]),n}},v.Tween.propHooks.scrollTop=v.Tween.propHooks.scrollLeft={get:function(t){return v.propHooks.scrollTop.get(t.elem,t.prop)},set:function(t){"HTML"===t.elem.tagName||"BODY"===t.elem.tagName?(t.options.bodyScrollLeft=t.options.bodyScrollLeft||window.scrollX,t.options.bodyScrollTop=t.options.bodyScrollTop||window.scrollY,"scrollLeft"===t.prop?t.options.bodyScrollLeft=Math.round(t.now):"scrollTop"===t.prop&&(t.options.bodyScrollTop=Math.round(t.now)),window.scrollTo(t.options.bodyScrollLeft,t.options.bodyScrollTop)):t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},y={config:{duration:400,easing:"swing",callback:undefined,durationMode:"each",offsetTop:0,offsetLeft:0},configure:function(t){return v.extend(y.config,t||{}),this},scroll:function(t,e){var n,i,s,r,o,a,l,c,p,u,h,d,f,m,g;return i=(n=t.pop()).$container,s=n.$target,i.prop("tagName"),r=v("<span/>").css({position:"absolute",top:"0px",left:"0px"}),o=i.css("position"),i.css({position:"relative"}),r.appendTo(i),u=r.offset().top,h=s.offset().top-u-parseInt(e.offsetTop,10),d=r.offset().left,f=s.offset().left-d-parseInt(e.offsetLeft,10),a=i.prop("scrollTop"),l=i.prop("scrollLeft"),r.remove(),i.css({position:o}),m={},g=function(){return 0===t.length?"function"==typeof e.callback&&e.callback():y.scroll(t,e),!0},e.onlyIfOutside&&(c=a+i.height(),p=l+i.width(),a<h&&h<c&&(h=a),l<f&&f<p&&(f=l)),h!==a&&(m.scrollTop=h),f!==l&&(m.scrollLeft=f),i.prop("scrollHeight")===i.width()&&delete m.scrollTop,i.prop("scrollWidth")===i.width()&&delete m.scrollLeft,null!=m.scrollTop||null!=m.scrollLeft?i.animate(m,{duration:e.duration,easing:e.easing,complete:g}):g(),!0},fn:function(t){var e,n,i,s;e=[];var r=v(this);if(0===r.length)return this;for(n=v.extend({},y.config,t),s=(i=r.parent()).get(0);1===i.length&&s!==document.body&&s!==document;){var o,a;o="visible"!==i.css("overflow-y")&&s.scrollHeight!==s.clientHeight,a="visible"!==i.css("overflow-x")&&s.scrollWidth!==s.clientWidth,(o||a)&&(e.push({$container:i,$target:r}),r=i),s=(i=i.parent()).get(0)}return e.push({$container:v("html"),$target:r}),"all"===n.durationMode&&(n.duration/=e.length),y.scroll(e,n),this}},v.ScrollTo=v.ScrollTo||y,v.fn.ScrollTo=v.fn.ScrollTo||y.fn,y}),function(l){function e(t,e){this.element=t,this.$element=l(t),this.options=l.extend({},i,e),this._defaults=i,this._name=n,!this.options.placeholder&&this.$element.data("placeholder")&&(this.options.placeholder=this.$element.data("placeholder")),this.preventInput=!1,this.browserMagicKey=App.Browser.magicKey(),this.browserHotkeys=App.Browser.hotkeys(),this.init()}var n="ce",i={debug:!1,mode:"richtext",multiline:!0,imageWidth:"absolute",allowKey:{8:!0,9:!0,16:!0,17:!0,18:!0,20:!0,37:!0,38:!0,39:!0,40:!0,91:!0,92:!0,224:!0},extraAllowKey:{65:!0,67:!0,86:!0,88:!0,90:!0},richTextFormatKey:{66:!0,73:!0,85:!0,83:!0}};e.prototype.init=function(){this.bindEvents(),this.$element.enableObjectResizingShim()},e.prototype.bindEvents=function(){this.$element.on("keydown",this.onKeydown.bind(this)),this.$element.on("paste",this.onPaste.bind(this)),this.$element.on("dragover",this.onDragover.bind(this)),this.$element.on("drop",this.onDrop.bind(this))},e.prototype.toggleBlock=function(t){sel=window.getSelection(),node=l(sel.anchorNode),node.is(t)||node.parent().is(t)||node.parent().parent().is(t)?document.execCommand("formatBlock",!1,"div"):document.execCommand("formatBlock",!1,t)},e.prototype.onKeydown=function(t){if(this.log("keydown",t.keyCode),this.preventInput)this.log("preventInput",this.preventInput);else{if(13===t.keyCode){if(!this.options.multiline)return void t.preventDefault();if(sel=window.getSelection(),sel&&(node=l(sel.anchorNode),node&&node.parent()&&node.parent().is("blockquote")))return t.preventDefault(),document.execCommand("Insertparagraph"),void document.execCommand("Outdent");if(!t.shiftKey&&t.altKey&&!t.ctrlKey&&!t.metaKey)return t.preventDefault(),void this.paste("<br><br>")}var e=!1;if("cmd"==this.browserMagicKey?t.altKey||t.ctrlKey||!t.metaKey||(e=!0):t.altKey||!t.ctrlKey||t.metaKey||(e=!0),e&&this.options.richTextFormatKey[t.keyCode]){if(t.preventDefault(),66==t.keyCode)return document.execCommand("bold"),!0;if(73==t.keyCode)return document.execCommand("italic"),!0;if(85==t.keyCode)return document.execCommand("underline"),!0;if(83==t.keyCode)return document.execCommand("strikeThrough"),!0}var n=!1;if("ctrl+shift"==this.browserHotkeys?!t.altKey&&t.ctrlKey&&!t.metaKey&&t.shiftKey&&(n=!0):t.altKey&&t.ctrlKey&&!t.metaKey&&(n=!0),n&&(this.options.richTextFormatKey[t.keyCode]||49==t.keyCode||50==t.keyCode||51==t.keyCode||66==t.keyCode||70==t.keyCode||90==t.keyCode||70==t.keyCode||73==t.keyCode||75==t.keyCode||76==t.keyCode||85==t.keyCode||86==t.keyCode||88==t.keyCode||90==t.keyCode||89==t.keyCode)){if(t.preventDefault(),"textonly"===this.options.mode)return;if(49==t.keyCode&&this.toggleBlock("h1"),50==t.keyCode&&this.toggleBlock("h2"),51==t.keyCode&&this.toggleBlock("h3"),66==t.keyCode&&document.execCommand("bold"),70==t.keyCode&&document.execCommand("removeFormat"),73==t.keyCode&&document.execCommand("italic"),75==t.keyCode&&document.execCommand("insertOrderedList"),76==t.keyCode&&document.execCommand("insertUnorderedList"),85==t.keyCode&&document.execCommand("underline"),86==t.keyCode&&document.execCommand("strikeThrough"),88==t.keyCode&&document.execCommand("unlink"),89==t.keyCode){var i=App.Utils.htmlRemoveRichtext(this.$element.html());this.$element.html(i)}return 90==t.keyCode&&document.execCommand("insertHorizontalRule"),this.log("content editable richtext key",t.keyCode),!0}this.allowKey(t)||this.maxLengthOk(1)||t.preventDefault()}},e.prototype.getHtmlFromClipboard=function(t){try{return t.getData("text/html")}catch(e){return void console.log("Sorry, can't get html of clipboard because browser is not supporting it.")}},e.prototype.getTextFromClipboard=function(t){var e;try{return(e=t.getData("text/plain"))&&0!==e.length||(e=t.getData("text")),e}catch(n){return void console.log("Sorry, can't get text of clipboard because browser is not supporting it.")}},e.prototype.getClipboardData=function(t){var e;if(t.clipboardData)e=t.clipboardData;else if(window.clipboardData)e=window.clipboardData;else{if(!t.originalEvent.clipboardData)throw"No clipboardData support";e=t.originalEvent.clipboardData}return e},e.prototype.getClipboardDataImage=function(t){if(t.items&&t.items[0])return l.grep(t.items,function(t){return"file"==t.kind&&("image/png"==t.type||"image/jpeg"==t.type)})[0]},e.prototype.onPaste=function(t){var e,n,i,s,r;if(t.preventDefault(),this.log("paste"),e=this.getClipboardData(t),s=this.getHtmlFromClipboard(e),App.Utils.clipboardHtmlIsWithText(s)||!(n=this.getClipboardDataImage(e)))return s&&(r=App.Utils.clipboardHtmlInsertPreperation(s,this.options))?(this.log("insert html from clipboard",r),this.paste(r),App.Utils.htmlImage2DataUrlAsyncInline(this.$element),!0):!!(i=this.getTextFromClipboard(e))&&(r=App.Utils.text2html(i),this.maxLengthOk(r.length)?(r=App.Utils.removeEmptyLines(r),this.log("insert text from clipboard",r),this.paste(r),!0):void 0);this.log("paste image",n);var o=n.getAsFile(),a=new FileReader;return a.onload=l.proxy(function(t){var n=t.target.result,i=document.createElement("img");i.src=n,(maxWidth=1e3)<this.$element.width()&&(maxWidth=this.$element.width()),scaleFactor=2,insert=l.proxy(function(t,e){this.log("image inserted"),n=t,i="absolute"==this.options.imageWidth?'<img tabindex="0" style="width: '+e+'px; max-width: 100%;" src="'+n+'">':'<img tabindex="0" style="width: 100%; max-width: '+e+'px;" src="'+n+'">',this.paste(i)},this),App.ImageService.resize(i.src,maxWidth,"auto",scaleFactor,"image/jpeg","auto",insert)},this),a.readAsDataURL(o),!0},e.prototype.onDragover=function(t){t.stopPropagation(),t.preventDefault(),this.log("dragover")},e.prototype.onDrop=function(t){var e;if(t.stopPropagation(),t.preventDefault(),this.log("drop"),window.dataTransfer)e=window.dataTransfer;else{if(!t.originalEvent.dataTransfer)throw"No clipboardData support";e=t.originalEvent.dataTransfer}x=t.clientX,y=t.clientY;var n=e.files[0];if(n.type.match("image.*")){var i=new FileReader;i.onload=function(t){var i=t.target.result,s=document.createElement("img");s.src=i,maxWidth=this.$element.width()||500,scaleFactor=2,insert=function(t,e){if(this.log("image inserted"),i=t,s="absolute"==this.options.imageWidth?'<img tabindex="0" style="width: '+e+'px; max-width: 100%;" src="'+i+'">':'<img tabindex="0" style="width: 100%; max-width: '+e+'px;" src="'+i+'">',document.caretPositionFromPoint){var n=document.caretPositionFromPoint(x,y);range=document.createRange(),range.setStart(n.offsetNode,n.offset),range.collapse(),range.insertNode(s)}else document.caretRangeFromPoint?(range=document.caretRangeFromPoint(x,y),range.insertNode(s)):console.log("could not find carat")},App.ImageService.resize(s.src,maxWidth,"auto",scaleFactor,"image/jpeg","auto",insert)},i.readAsDataURL(n)}},e.prototype.allowKey=function(t){return!!this.options.allowKey[t.keyCode]||!(!t.ctrlKey&&!t.metaKey||!this.options.extraAllowKey[t.keyCode])},e.prototype.maxLengthOk=function(t){if(!this.options.maxlength)return!0;var e=this.$element.text().length;if(t&&(e+=t),this.log("maxLengthOk",e,this.options.maxlength),e>this.options.maxlength){this.log("maxLengthOk, text too long");var n=this.$element.parent().parent();return n.hasClass("controls")?(n.addClass("has-error"),setTimeout(l.proxy(function(){n.removeClass("has-error")},this),1e3)):(this.$element.addClass("invalid"),setTimeout(l.proxy(function(){this.$element.removeClass("invalid")},this),1e3)),!1}return!0},e.prototype.value=function(){return"textonly"===this.options.mode?this.options.multiline?(text_plain=this.$element.text().trim(),text_plain&&""!=text_plain?this.$element.html():text_plain):this.$element.text().trim():(text_plain=this.$element.text().trim(),text_plain&&""!=text_plain||this.$element.find("img").get(0)?this.$element.html().trim():text_plain)},e.prototype.log=function(){App&&App.Log&&App.Log.debug("contenteditable",arguments),this.options.debug&&console.log(this._name,arguments)},e.prototype.paste=function(t){var e=!!window.MSInputMethodContext&&!!document.documentMode;if(document.selection&&document.selection.createRange)(n=document.selection.createRange()).pasteHTML&&n.pasteHTML(t);else if(e&&document.getSelection){var n=document.getSelection().getRangeAt(0),i=document.createElement("div");n.surroundContents(i),i.innerHTML=t}else document.execCommand("insertHTML",!1,t)},l.fn[n]=function(t){return this.each(function(){l.data(this,"plugin_"+n)||l.data(this,"plugin_"+n,new e(this,t))})},l.fn.ceg=function(){var t=l.data(this[0],"plugin_"+n);if(t)return t.value()}}(jQuery),function(s){function e(t,e){this.element=t,this.$element=s(t),this.options=s.extend({},r,e),this._defaults=r,this._name=i,document.execCommand("enableObjectResizing",!1,!1),this.bindEvents()}function n(t){this.$element=t,this.isResizing=!1,this.$element.data("objectResizingEditor",this),this.$element.addClass("objectResizingEditorActive"),this.$element.wrap('<div class="enableObjectResizingShim" contenteditable="false"></div>');for(var e=0;e<4;e++)this.$element.before('<div class="enableObjectResizingShim-handle"></div>');s(document).one("click.objectResizingEditor",this.destroy.bind(this)),s(document).one("keydown.objectResizingEditor",this.onKeydown.bind(this)),this.$element.on("click.objectResizingEditor",this.stopPropagation.bind(this)),this.$element.parent().find(".enableObjectResizingShim-handle").on("mousedown",this.startResize.bind(this))}var i="enableObjectResizingShim",r={debug:!1};e.prototype.bindEvents=function(){this.$element.on("click","img",this.createEditor.bind(this)),this.$element.on("click",this.destroyEditors.bind(this))},e.prototype.createEditor=function(t){t.stopPropagation(),this.destroyEditors();var e=s(t.currentTarget);e.hasClass("objectResizingEditorActive")||new n(e)},e.prototype.destroyEditors=function(){this.$element.find("img.objectResizingEditorActive").each(function(t,e){$img=s(e),editor=$img.data("objectResizingEditor"),editor?editor.destroy():($img.removeClass("objectResizingEditorActive"),$img.siblings().remove(),$img.unwrap())})},n.prototype.onKeydown=function(t){switch(this.destroy(),t.keyCode){case 8:this.$element.remove();break;default:t.stopPropagation()}},n.prototype.stopPropagation=function(t){t.stopPropagation()},n.prototype.destroy=function(){this.isResizing||(this.$element.off("click.objectResizingEditor"),s(document).off("click.objectResizingEditor"),s(document).off("keydown.objectResizingEditor"),this.$element.removeClass("objectResizingEditorActive"),this.$element.siblings().remove(),this.$element.unwrap())},n.prototype.startResize=function(t){var e=s(t.currentTarget),n=this.$element.closest('[contenteditable="true"]').width()||"";this.resizeCorner=e.index(),this.resizeDir=0==this.resizeCorner||3==this.resizeCorner?-1:1,this.startX=t.pageX,this.startWidth=this.$element.width(),this.$clone=this.$element.clone().css({width:"",height:"","max-width":n}).addClass("enableObjectResizingShim-clone enableObjectResizingShim-clone--"+this.resizeCorner),this.$element.after(this.$clone),this.isResizing=!0,s(document).on("mousemove.enableObjectResizing",this.resize.bind(this)),s(document).on("mouseup.enableObjectResizing",this.resizeEnd.bind(this))},n.prototype.resize=function(t){t.preventDefault(),t.stopPropagation();var e=t.pageX-this.startX;this.$clone.css("width",this.startWidth+this.resizeDir*e)},n.prototype.resizeEnd=function(){var t=this.$element.closest('[contenteditable="true"]').width(),e=this.$clone.width(),n=this.$clone.height(),i=this.$clone.get(0).naturalWidth;this.$clone.get(0).naturalHeight;t&&t<e+10&&(e=n="",i&&(e=i/2)),s(document).off("mousemove.enableObjectResizing"),s(document).off("mouseup.enableObjectResizing"),this.$element.css({width:e,height:n,"max-width":"100%"}),this.$clone.remove(),setTimeout(function(){this.isResizing=!1}.bind(this))},s.fn[i]=function(t){return this.each(function(){s.data(this,"plugin_"+i)||s.data(this,"plugin_"+i,new e(this,t))})}}(jQuery,window);var qq=qq||{},qq=function(r){"use strict";return{hide:function(){return r.style.display="none",this},attach:function(t,e){return r.addEventListener?r.addEventListener(t,e,!1):r.attachEvent&&r.attachEvent("on"+t,e),function(){qq(r).detach(t,e)}},detach:function(t,e){return r.removeEventListener?r.removeEventListener(t,e,!1):r.attachEvent&&r.detachEvent("on"+t,e),this},contains:function(t){return r==t||(r.contains?r.contains(t):!!(8&t.compareDocumentPosition(r)))},insertBefore:function(t){return t.parentNode.insertBefore(r,t),this},remove:function(){return r.parentNode.removeChild(r),this},css:function(t){return null!=t.opacity&&"string"!=typeof r.style.opacity&&"undefined"!=typeof r.filters&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(r.style,t),this},hasClass:function(t){return new RegExp("(^| )"+t+"( |$)").test(r.className)},addClass:function(t){return qq(r).hasClass(t)||(r.className+=" "+t),this},removeClass:function(t){var e=new RegExp("(^| )"+t+"( |$)");return r.className=r.className.replace(e," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(t){if(r.querySelectorAll)return r.querySelectorAll("."+t);for(var e=[],n=r.getElementsByTagName("*"),i=n.length,s=0;s<i;s++)qq(n[s]).hasClass(t)&&e.push(n[s]);return e},children:function(){for(var t=[],e=r.firstChild;e;)1==e.nodeType&&t.push(e),e=e.nextSibling;return t},setText:function(t){return r.innerText=t,r.textContent=t,this},clearText:function(){return qq(r).setText("")}}};qq.log=function(t,e){App&&App.Log&&App.Log.debug(this._name,arguments),window.console&&(e&&"info"!==e?window.console[e]?window.console[e](t):window.console.log("<"+e+"> "+t):window.console.log(t))},qq.isObject=function(t){"use strict";return null!==t&&t&&"object"==typeof t&&t.constructor===Object},qq.extend=function(t,e,n){"use strict";var i;for(i in e)e.hasOwnProperty(i)&&(n&&qq.isObject(e[i])?(t[i]===undefined&&(t[i]={}),qq.extend(t[i],e[i],!0)):t[i]=e[i])},qq.indexOf=function(t,e,n){if(t.indexOf)return t.indexOf(e,n);n=n||0;var i=t.length;for(n<0&&(n+=i);n<i;n++)if(n in t&&t[n]===e)return n;return-1},qq.getUniqueId=function(){var t=0;return function(){return t++}}(),qq.ie=function(){return-1!=navigator.userAgent.indexOf("MSIE")},qq.ie10=function(){return-1!=navigator.userAgent.indexOf("MSIE 10")},qq.safari=function(){return navigator.vendor!=undefined&&-1!=navigator.vendor.indexOf("Apple")},qq.chrome=function(){return navigator.vendor!=undefined&&-1!=navigator.vendor.indexOf("Google")},qq.firefox=function(){return-1!=navigator.userAgent.indexOf("Mozilla")&&navigator.vendor!=undefined&&""==navigator.vendor},qq.windows=function(){return"Win32"==navigator.platform},qq.preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},qq.toElement=function(){var n=document.createElement("div");return function(t){n.innerHTML=t;var e=n.firstChild;return n.removeChild(e),e}}(),qq.obj2url=function(t,i,e){var s=[],n="&",r=function(t,e){var n=i?/\[\]$/.test(i)?i:i+"["+e+"]":e;"undefined"!=n&&"undefined"!=e&&s.push("object"==typeof t?qq.obj2url(t,n,!0):"[object Function]"===Object.prototype.toString.call(t)?encodeURIComponent(n)+"="+encodeURIComponent(t()):encodeURIComponent(n)+"="+encodeURIComponent(t))};if(!e&&i)n=/\?/.test(i)?/\?$/.test(i)?"":"&":"?",s.push(i),s.push(qq.obj2url(t));else if("[object Array]"===Object.prototype.toString.call(t)&&void 0!==t)for(var o=0,a=t.length;o<a;++o)r(t[o],o);else if(null!=t&&"object"==typeof t)for(var o in t)r(t[o],o);else s.push(encodeURIComponent(i)+"="+encodeURIComponent(t));return i?s.join(n):s.join(n).replace(/^&/,"").replace(/%20/g,"+")},qq.DisposeSupport={_disposers:[],dispose:function(){for(var t;t=this._disposers.shift();)t()},addDisposer:function(t){this._disposers.push(t)},_attach:function(t){this.addDisposer(qq(t).attach.apply(this,Array.prototype.slice.call(arguments,1)))}},qq.UploadButton=function(t){this._options={element:null,multiple:!1,acceptFiles:null,name:"file",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},qq.extend(this._options,t),qq.extend(this,qq.DisposeSupport),this._element=this._options.element,qq(this._element).css({position:"relative",overflow:"hidden",direction:"ltr"}),this._input=this._createInput()},qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq(this._input).remove(),qq(this._element).removeClass(this._options.focusClass),this._input=this._createInput()},_createInput:function(){var t=document.createElement("input");this._options.multiple&&t.setAttribute("multiple","multiple"),this._options.acceptFiles&&t.setAttribute("accept",this._options.acceptFiles),t.setAttribute("type","file"),t.setAttribute("name",this._options.name),qq(t).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),this._element.appendChild(t);var e=this;return this._attach(t,"change",function(){e._options.onChange(t)}),this._attach(t,"mouseover",function(){qq(e._element).addClass(e._options.hoverClass)}),this._attach(t,"mouseout",function(){qq(e._element).removeClass(e._options.hoverClass)}),this._attach(t,"focus",function(){qq(e._element).addClass(e._options.focusClass)}),this._attach(t,"blur",function(){qq(e._element).removeClass(e._options.focusClass)}),window.attachEvent&&t.setAttribute("tabIndex","-1"),t}},qq.FineUploaderBasic=function(t){this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{endpoint:"/server/upload",params:{},customHeaders:{},forceMultipart:!1,inputName:"qqfile"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,stopOnFirstInvalidFile:!0},callbacks:{onSubmit:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onProgress:function(){},onError:function(){},onAutoRetry:function(){},onManualRetry:function(){},onValidate:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"}},qq.extend(this._options,t,!0),this._wrapCallbacks(),qq.extend(this,qq.DisposeSupport),this._filesInProgress=0,this._storedFileIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._handler=this._createUploadHandler(),this._options.button&&(this._button=this._createUploadButton(this._options.button)),this._preventLeaveInProgress()},qq.FineUploaderBasic.prototype={log:function(t,e){!this._options.debug||e&&"info"!==e?e&&"info"!==e&&qq.log("[FineUploader] "+t,e):qq.log("[FineUploader] "+t)},setParams:function(t){this._options.request.params=t},getInProgress:function(){return this._filesInProgress},uploadStoredFiles:function(){"use strict";for(;this._storedFileIds.length;)this._filesInProgress++,this._handler.upload(this._storedFileIds.shift(),this._options.request.params)},clearStoredFiles:function(){this._storedFileIds=[]},retry:function(t){return!!this._onBeforeManualRetry(t)&&(this._handler.retry(t),!0)},cancel:function(t){this._handler.cancel(t)},reset:function(){this.log("Resetting uploader..."),this._handler.reset(),this._filesInProgress=0,this._storedFileIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._button.reset()},_createUploadButton:function(t){var e=this,n=new qq.UploadButton({element:t,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),acceptFiles:this._options.validation.acceptFiles,onChange:function(t){e._onInputChange(t)}});return this.addDisposer(function(){n.dispose()}),n},_createUploadHandler:function(){var t,s=this;return t=qq.UploadHandlerXhr.isSupported()?"UploadHandlerXhr":"UploadHandlerForm",new qq[t]({debug:this._options.debug,endpoint:this._options.request.endpoint,forceMultipart:this._options.request.forceMultipart,maxConnections:this._options.maxConnections,customHeaders:this._options.request.customHeaders,inputName:this._options.request.inputName,demoMode:this._options.demoMode,log:this.log,onProgress:function(t,e,n,i){s._onProgress(t,e,n,i),s._options.callbacks.onProgress(t,e,n,i)},onComplete:function(t,e,n,i){s._onComplete(t,e,n,i),s._options.callbacks.onComplete(t,e,n)},onCancel:function(t,e){s._onCancel(t,e),s._options.callbacks.onCancel(t,e)},onUpload:function(t,e,n){s._onUpload(t,e,n),s._options.callbacks.onUpload(t,e,n)},onAutoRetry:function(t,e,n,i){return s._preventRetries[t]=n[s._options.retry.preventRetryResponseProperty],!!s._shouldAutoRetry(t,e,n)&&(s._maybeParseAndSendUploadError(t,e,n,i),s._options.callbacks.onAutoRetry(t,e,s._autoRetries[t]+1),s._onBeforeAutoRetry(t,e),s._retryTimeouts[t]=setTimeout(function(){s._onAutoRetry(t,e,n)},1e3*s._options.retry.autoAttemptDelay),!0)}})},_preventLeaveInProgress:function(){var e=this;this._attach(window,"beforeunload",function(t){if(e._filesInProgress)return(t=t||window.event).returnValue=e._options.messages.onLeave,e._options.messages.onLeave})},_onSubmit:function(){this._options.autoUpload&&this._filesInProgress++},_onProgress:function(){},_onComplete:function(t,e,n,i){this._filesInProgress--,this._maybeParseAndSendUploadError(t,e,n,i)},_onCancel:function(t){clearTimeout(this._retryTimeouts[t]);var e=qq.indexOf(this._storedFileIds,t);this._options.autoUpload||e<0?this._filesInProgress--:this._options.autoUpload||this._storedFileIds.splice(e,1)},_onUpload:function(){},_onInputChange:function(t){this._handler instanceof qq.UploadHandlerXhr?this._uploadFileList(t.files):this._validateFile(t)&&this._uploadFile(t),this._button.reset()},_onBeforeAutoRetry:function(t,e){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+e+"...")},_onAutoRetry:function(t,e){this.log("Retrying "+e+"..."),this._autoRetries[t]++,this._handler.retry(t)},_shouldAutoRetry:function(t){return!(this._preventRetries[t]||!this._options.retry.enableAuto)&&(this._autoRetries[t]===undefined&&(this._autoRetries[t]=0),this._autoRetries[t]<this._options.retry.maxAutoAttempts)},_onBeforeManualRetry:function(t){if(this._preventRetries[t])return this.log("Retries are forbidden for id "+t,"warn"),!1;if(this._handler.isValid(t)){
var e=this._handler.getName(t);return!1!==this._options.callbacks.onManualRetry(t,e)&&(this.log("Retrying upload for '"+e+"' (id: "+t+")..."),this._filesInProgress++,!0)}return this.log("'"+t+"' is not a valid file ID","error"),!1},_maybeParseAndSendUploadError:function(t,e,n,i){if(!n.success)if(i&&200!==i.status&&!n.error)this._options.callbacks.onError(t,e,"XHR returned response code "+i.status);else{var s=n.error?n.error:"Upload failure reason unknown";this._options.callbacks.onError(t,e,s)}},_uploadFileList:function(t){var e,n,i;if(1<(e=this._getValidationDescriptors(t)).length&&(i=!1===this._options.callbacks.onValidate(e)),!i)if(0<t.length){for(n=0;n<t.length;n++)if(this._validateFile(t[n]))this._uploadFile(t[n]);else if(this._options.validation.stopOnFirstInvalidFile)return}else this._error("noFilesError","")},_uploadFile:function(t){var e=this._handler.add(t),n=this._handler.getName(e);!1!==this._options.callbacks.onSubmit(e,n)&&(this._onSubmit(e,n),this._options.autoUpload?this._handler.upload(e,this._options.request.params):this._storeFileForLater(e))},_storeFileForLater:function(t){this._storedFileIds.push(t)},_validateFile:function(t){var e,n,i;return n=(e=this._getValidationDescriptor(t)).name,i=e.size,!1!==this._options.callbacks.onValidate([e])&&(this._isAllowedExtension(n)?0===i?(this._error("emptyError",n),!1):i&&this._options.validation.sizeLimit&&i>this._options.validation.sizeLimit?(this._error("sizeError",n),!1):!(i&&i<this._options.validation.minSizeLimit)||(this._error("minSizeError",n),!1):(this._error("typeError",n),!1))},_error:function(t,e){function n(t,e){i=i.replace(t,e)}var i=this._options.messages[t],s=this._options.validation.allowedExtensions.join(", ");return n("{file}",this._formatFileName(e)),n("{extensions}",s),n("{sizeLimit}",this._formatSize(this._options.validation.sizeLimit)),n("{minSizeLimit}",this._formatSize(this._options.validation.minSizeLimit)),this._options.callbacks.onError(null,e,i),i},_formatFileName:function(t){return 33<t.length&&(t=t.slice(0,19)+"..."+t.slice(-13)),t},_isAllowedExtension:function(t){var e=-1!==t.indexOf(".")?t.replace(/.*[.]/,"").toLowerCase():"",n=this._options.validation.allowedExtensions;if(!n.length)return!0;for(var i=0;i<n.length;i++)if(n[i].toLowerCase()==e)return!0;return!1},_formatSize:function(t){for(var e=-1;e++,99<(t/=1024););return Math.max(t,.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][e]},_wrapCallbacks:function(){var s,e;for(var n in e=function(t,e,n){try{return e.apply(s,n)}catch(i){s.log("Caught exception in '"+t+"' callback - "+i,"error")}},(s=this)._options.callbacks)!function(){var t=s._options.callbacks[n];s._options.callbacks[n]=function(){return e(n,t,arguments)}}()},_parseFileName:function(t){return t.value?t.value.replace(/.*(\/|\\)/,""):null!==t.fileName&&t.fileName!==undefined?t.fileName:t.name},_parseFileSize:function(t){var e;return t.value||(e=null!==t.fileSize&&t.fileSize!==undefined?t.fileSize:t.size),e},_getValidationDescriptor:function(t){var e,n,i;return i={},e=this._parseFileName(t),n=this._parseFileSize(t),i.name=e,n&&(i.size=n),i},_getValidationDescriptors:function(t){var e,n;for(n=[],e=0;e<t.length;e++)n.push(t[e]);return n}},qq.FineUploader=function(t){qq.FineUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,dragAndDrop:{extraDropzones:[],hideDropzones:!0,disableDefaultDropzone:!1},text:{uploadButton:"Upload a file",cancelButton:"Cancel",retryButton:"Retry",failUpload:"Upload failed",dragZone:"Drop files here to upload",formatProgress:"{percent}% of {total_size}",waitingForResponse:"Processing..."},template:'<div class="qq-uploader">'+(this._options.dragAndDrop&&this._options.dragAndDrop.disableDefaultDropzone?"":'<div class="qq-upload-drop-area"><span>{dragZoneText}</span></div>')+(this._options.button?"":'<div class="qq-upload-button"><div>{uploadButtonText}</div></div>')+(this._options.listElement?"":'<ul class="qq-upload-list"></ul>')+"</div>",fileTemplate:'<li><div class="qq-progress-bar"></div><span class="qq-upload-spinner"></span><span class="qq-upload-finished"></span><span class="qq-upload-file"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><a class="qq-upload-retry" href="#">{retryButtonText}</a><span class="qq-upload-status-text">{statusText}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",size:"qq-upload-size",cancel:"qq-upload-cancel",retry:"qq-upload-retry",statusText:"qq-upload-status-text",success:"qq-upload-success",fail:"qq-upload-fail",successIcon:null,failIcon:null},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file"},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}...",showButton:!1},showMessage:function(t){alert(t)}},!0),qq.extend(this._options,t,!0),this._wrapCallbacks(),this._options.template=this._options.template.replace(/\{dragZoneText\}/g,this._options.text.dragZone),this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.text.uploadButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.text.cancelButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{retryButtonText\}/g,this._options.text.retryButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{statusText\}/g,""),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._setupDragDrop()},qq.extend(qq.FineUploader.prototype,qq.FineUploaderBasic.prototype),qq.extend(qq.FineUploader.prototype,{clearStoredFiles:function(){qq.FineUploaderBasic.prototype.clearStoredFiles.apply(this,arguments),this._listElement.innerHTML=""},addExtraDropzone:function(t){this._setupExtraDropzone(t)},removeExtraDropzone:function(t){var e=this._options.dragAndDrop.extraDropzones;for(var n in e)if(e[n]===t)return this._options.dragAndDrop.extraDropzones.splice(n,1)},getItemByFileId:function(t){for(var e=this._listElement.firstChild;e;){if(e.qqFileId==t)return e;e=e.nextSibling}},reset:function(){qq.FineUploaderBasic.prototype.reset.apply(this,arguments),this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._options.button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._setupDragDrop()},_leaving_document_out:function(t){return(qq.chrome()||qq.safari()&&qq.windows())&&0==t.clientX&&0==t.clientY||qq.firefox()&&!t.relatedTarget},_storeFileForLater:function(t){qq.FineUploaderBasic.prototype._storeFileForLater.apply(this,arguments);var e=this.getItemByFileId(t);qq(this._find(e,"spinner")).hide()},_find:function(t,e){var n=qq(t).getByClass(this._options.classes[e])[0];if(!n)throw new Error("element not found "+e);return n},_setupExtraDropzone:function(t){this._options.dragAndDrop.extraDropzones.push(t),this._setupDropzone(t)},_setupDropzone:function(e){var n=this,t=new qq.UploadDropZone({element:e,onEnter:function(t){qq(e).addClass(n._classes.dropActive),t.stopPropagation()},onLeave:function(){},onLeaveNotDescendants:function(){qq(e).removeClass(n._classes.dropActive)},onDrop:function(t){n._options.dragAndDrop.hideDropzones&&qq(e).hide(),qq(e).removeClass(n._classes.dropActive),1<t.dataTransfer.files.length&&!n._options.multiple?n._error("tooManyFilesError",""):n._uploadFileList(t.dataTransfer.files)}});this.addDisposer(function(){t.dispose()}),this._options.dragAndDrop.hideDropzones&&qq(e).hide()},_setupDragDrop:function(){var e,t;(e=this)._options.dragAndDrop.disableDefaultDropzone||(t=this._find(this._element,"drop"),this._options.dragAndDrop.extraDropzones.push(t));var n,i=this._options.dragAndDrop.extraDropzones;for(n=0;n<i.length;n++)this._setupDropzone(i[n]);this._options.dragAndDrop.disableDefaultDropzone||qq.ie()&&!qq.ie10()||this._attach(document,"dragenter",function(){if(!qq(t).hasClass(e._classes.dropDisabled))for(t.style.display="block",n=0;n<i.length;n++)i[n].style.display="block"}),this._attach(document,"dragleave",function(t){if(e._options.dragAndDrop.hideDropzones&&qq.FineUploader.prototype._leaving_document_out(t))for(n=0;n<i.length;n++)qq(i[n]).hide()}),qq(document).attach("drop",function(t){if(e._options.dragAndDrop.hideDropzones)for(n=0;n<i.length;n++)qq(i[n]).hide();t.preventDefault()})},_onSubmit:function(t,e){qq.FineUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(t,e)},_onProgress:function(t,e,n,i){var s,r,o,a,l,c;qq.FineUploaderBasic.prototype._onProgress.apply(this,arguments),s=this.getItemByFileId(t),r=this._find(s,"progressBar"),a=Math.round(n/i*100),n===i?(l=this._find(s,"cancel"),qq(l).hide(),qq(r).hide(),qq(this._find(s,"statusText")).setText(this._options.text.waitingForResponse),o=this._formatSize(i)):(o=this._formatProgress(n,i),qq(r).css({display:"block"})),qq(r).css({width:a+"%"}),c=this._find(s,"size"),qq(c).css({display:"inline"}),qq(c).setText(o)},_onComplete:function(t,e,n,i){qq.FineUploaderBasic.prototype._onComplete.apply(this,arguments);var s=this.getItemByFileId(t);qq(this._find(s,"statusText")).clearText(),qq(s).removeClass(this._classes.retrying),qq(this._find(s,"progressBar")).hide(),this._options.disableCancelForFormUploads&&!qq.UploadHandlerXhr.isSupported()||qq(this._find(s,"cancel")).hide(),qq(this._find(s,"spinner")).hide(),n.success?(qq(s).addClass(this._classes.success),this._classes.successIcon&&(this._find(s,"finished").style.display="inline-block",qq(s).addClass(this._classes.successIcon))):(qq(s).addClass(this._classes.fail),this._classes.failIcon&&(this._find(s,"finished").style.display="inline-block",qq(s).addClass(this._classes.failIcon)),this._options.retry.showButton&&!this._preventRetries[t]&&qq(s).addClass(this._classes.retryable),this._controlFailureTextDisplay(s,n))},_onUpload:function(t,e,n){qq.FineUploaderBasic.prototype._onUpload.apply(this,arguments);var i=this.getItemByFileId(t);this._showSpinner(i)},_onBeforeAutoRetry:function(t){var e,n,i,s,r,o;qq.FineUploaderBasic.prototype._onBeforeAutoRetry.apply(this,arguments),e=this.getItemByFileId(t),n=this._find(e,"progressBar"),this._showCancelLink(e),n.style.width=0,qq(n).hide(),this._options.retry.showAutoRetryNote&&(i=this._find(e,"statusText"),s=this._autoRetries[t]+1,r=this._options.retry.maxAutoAttempts,o=(o=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,s)).replace(/\{maxAuto\}/g,r),qq(i).setText(o),1===s&&qq(e).addClass(this._classes.retrying))},_onBeforeManualRetry:function(t){if(qq.FineUploaderBasic.prototype._onBeforeManualRetry.apply(this,arguments)){var e=this.getItemByFileId(t);return this._find(e,"progressBar").style.width=0,qq(e).removeClass(this._classes.fail),this._showSpinner(e),this._showCancelLink(e),!0}return!1},_addToList:function(t,e){var n=qq.toElement(this._options.fileTemplate);if(this._options.disableCancelForFormUploads&&!qq.UploadHandlerXhr.isSupported()){var i=this._find(n,"cancel");qq(i).remove()}n.qqFileId=t;var s=this._find(n,"file");qq(s).setText(this._formatFileName(e)),qq(this._find(n,"size")).hide(),this._options.multiple||this._clearList(),this._listElement.appendChild(n)},_clearList:function(){this._listElement.innerHTML="",this.clearStoredFiles()},_bindCancelAndRetryEvents:function(){var i=this,t=this._listElement;this._attach(t,"click",function(t){var e=(t=t||window.event).target||t.srcElement;if(qq(e).hasClass(i._classes.cancel)||qq(e).hasClass(i._classes.retry)){qq.preventDefault(t);for(var n=e.parentNode;n.qqFileId==undefined;)n=e=e.parentNode;qq(e).hasClass(i._classes.cancel)?(i.cancel(n.qqFileId),qq(n).remove()):(qq(n).removeClass(i._classes.retryable),i.retry(n.qqFileId))}})},_formatProgress:function(t,e){function n(t,e){i=i.replace(t,e)}var i=this._options.text.formatProgress;return n("{percent}",Math.round(t/e*100)),n("{total_size}",this._formatSize(e)),i},_controlFailureTextDisplay:function(t,e){var n,i,s,r,o;n=this._options.failedUploadTextDisplay.mode,i=this._options.failedUploadTextDisplay.maxChars,s=this._options.failedUploadTextDisplay.responseProperty,"custom"===n?((r=e[s])?r.length>i&&(o=r.substring(0,i)+"..."):(r=this._options.text.failUpload,this.log("'"+s+"' is not a valid property on the server response.","warn")),qq(this._find(t,"statusText")).setText(o||r),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(t,r)):"default"===n?qq(this._find(t,"statusText")).setText(this._options.text.failUpload):"none"!==n&&this.log("failedUploadTextDisplay.mode value of '"+n+"' is not valid","warn")},_showTooltip:function(t,e){t.title=e},_showSpinner:function(t){this._find(t,"spinner").style.display="inline-block"},_showCancelLink:function(t){this._options.disableCancelForFormUploads&&!qq.UploadHandlerXhr.isSupported()||(this._find(t,"cancel").style.display="inline")},_error:function(t,e){var n=qq.FineUploaderBasic.prototype._error.apply(this,arguments);this._options.showMessage(n)}}),qq.UploadDropZone=function(t){this._options={element:null,onEnter:function(){},onLeave:function(){},onLeaveNotDescendants:function(){},onDrop:function(){}},qq.extend(this._options,t),qq.extend(this,qq.DisposeSupport),this._element=this._options.element,this._disableDropOutside(),this._attachEvents()},qq.UploadDropZone.prototype={_dragover_should_be_canceled:function(){return qq.safari()||qq.firefox()&&qq.windows()},_disableDropOutside:function(){qq.UploadDropZone.dropOutsideDisabled||(this._dragover_should_be_canceled?qq(document).attach("dragover",function(t){t.preventDefault()}):qq(document).attach("dragover",function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="none",t.preventDefault())}),qq.UploadDropZone.dropOutsideDisabled=!0)},_attachEvents:function(){var n=this;n._attach(n._element,"dragover",function(t){if(n._isValidFileDrag(t)){var e=qq.ie()?null:t.dataTransfer.effectAllowed;t.dataTransfer.dropEffect="move"==e||"linkMove"==e?"move":"copy",t.stopPropagation(),t.preventDefault()}}),n._attach(n._element,"dragenter",function(t){n._isValidFileDrag(t)&&n._options.onEnter(t)}),n._attach(n._element,"dragleave",function(t){if(n._isValidFileDrag(t)){n._options.onLeave(t);var e=document.elementFromPoint(t.clientX,t.clientY);qq(this).contains(e)||n._options.onLeaveNotDescendants(t)}}),n._attach(n._element,"drop",function(t){n._isValidFileDrag(t)&&(t.preventDefault(),n._options.onDrop(t))})},_isValidFileDrag:function(t){if(qq.ie()&&!qq.ie10())return!1;var e=t.dataTransfer,n=qq.safari(),i=!!qq.ie10()||"none"!=e.effectAllowed;return e&&i&&(e.files||!n&&e.types.contains&&e.types.contains("Files"))}},qq.UploadHandlerAbstract=function(t){this._options={debug:!1,endpoint:"/upload.php",maxConnections:999,log:function(){},onProgress:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onAutoRetry:function(){}},qq.extend(this._options,t),this._queue=[],this._params=[],this.log=this._options.log},qq.UploadHandlerAbstract.prototype={add:function(){},upload:function(t,e){var n=this._queue.push(t),i={};qq.extend(i,e),this._params[t]=i,n<=this._options.maxConnections&&this._upload(t,this._params[t])},retry:function(t){0<=qq.indexOf(this._queue,t)?this._upload(t,this._params[t]):this.upload(t,this._params[t])},cancel:function(t){this.log("Cancelling "+t),this._cancel(t),this._dequeue(t)},cancelAll:function(){for(var t=0;t<this._queue.length;t++)this._cancel(this._queue[t]);this._queue=[]},getName:function(){},getSize:function(){},getQueue:function(){return this._queue},reset:function(){this.log("Resetting upload handler"),this._queue=[],this._params=[]},_upload:function(){},_cancel:function(){},_dequeue:function(t){var e=qq.indexOf(this._queue,t);this._queue.splice(e,1);var n=this._options.maxConnections;if(this._queue.length>=n&&e<n){var i=this._queue[n-1];this._upload(i,this._params[i])}},isValid:function(){}},qq.UploadHandlerForm=function(t){qq.UploadHandlerAbstract.apply(this,arguments),this._inputs={},this._detach_load_events={}},qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerForm.prototype,{add:function(t){t.setAttribute("name",this._options.inputName);var e="qq-upload-handler-iframe"+qq.getUniqueId();return(this._inputs[e]=t).parentNode&&qq(t).remove(),e},getName:function(t){return this._inputs[t].value.replace(/.*(\/|\\)/,"")},isValid:function(t){return this._inputs[t]!==undefined},reset:function(){qq.UploadHandlerAbstract.prototype.reset.apply(this,arguments),this._inputs={},this._detach_load_events={}},_cancel:function(t){this._options.onCancel(t,this.getName(t)),delete this._inputs[t],delete this._detach_load_events[t];var e=document.getElementById(t);e&&(e.setAttribute("src","javascript:false;"),qq(e).remove())},_upload:function(e,t){this._options.onUpload(e,this.getName(e),!1);var n=this._inputs[e];if(!n)throw new Error("file with passed id was not added, or already uploaded or cancelled");var i=this.getName(e);t[this._options.inputName]=i;var s=this._createIframe(e),r=this._createForm(s,t);r.appendChild(n);var o=this;return this._attachLoadEvent(s,function(){o.log("iframe loaded");var t=o._getIframeContentJSON(s);setTimeout(function(){o._detach_load_events[e](),delete o._detach_load_events[e],qq(s).remove()},1),!t.success&&o._options.onAutoRetry(e,i,t)||(o._options.onComplete(e,i,t),o._dequeue(e))}),this.log("Sending upload request for "+e),r.submit(),qq(r).remove(),e},_attachLoadEvent:function(e,n){var i=this;this._detach_load_events[e.id]=qq(e).attach("load",function(){if(i.log("Received response for "+e.id),e.parentNode){try{if(e.contentDocument&&e.contentDocument.body&&"false"==e.contentDocument.body.innerHTML)return}catch(t){i.log("Error when attempting to access iframe during handling of upload response ("+t+")","error")}n()}})},_getIframeContentJSON:function(iframe){try{var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response,innerHTML=doc.body.innerHTML;this.log("converting iframe's innerHTML to JSON"),this.log("innerHTML = "+innerHTML),innerHTML&&innerHTML.match(/^<pre/i)&&(innerHTML=doc.body.firstChild.firstChild.nodeValue),response=eval("("+innerHTML+")")}catch(error){this.log("Error when attempting to parse form upload response ("+error+")","error"),response={success:!1}}return response},_createIframe:function(t){var e=qq.toElement('<iframe src="javascript:false;" name="'+t+'" />');return e.setAttribute("id",t),e.style.display="none",document.body.appendChild(e),e},_createForm:function(t,e){var n=this._options.demoMode?"GET":"POST",i=qq.toElement('<form method="'+n+'" enctype="multipart/form-data"></form>'),s=qq.obj2url(e,this._options.endpoint);return i.setAttribute("action",s),i.setAttribute("target",t.name),i.style.display="none",document.body.appendChild(i),i}}),qq.UploadHandlerXhr=function(t){qq.UploadHandlerAbstract.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},qq.UploadHandlerXhr.isSupported=function(){var t=document.createElement("input");return t.type="file","multiple"in t&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&"undefined"!=typeof(new XMLHttpRequest).upload},qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerXhr.prototype,{add:function(t){if(!(t instanceof File))throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)");return this._files.push(t)-1},getName:function(t){var e=this._files[t];return null!==e.fileName&&e.fileName!==undefined?e.fileName:e.name},getSize:function(t){var e=this._files[t];return null!=e.fileSize?e.fileSize:e.size},getLoaded:function(t){return this._loaded[t]||0},isValid:function(t){return this._files[t]!==undefined},reset:function(){qq.UploadHandlerAbstract.prototype.reset.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},_upload:function(e,t){this._options.onUpload(e,this.getName(e),!0);var n=this._files[e],i=this.getName(e);this.getSize(e);this._loaded[e]=0;var s=this._xhrs[e]=new XMLHttpRequest,r=this;s.upload.onprogress=function(t){t.lengthComputable&&(r._loaded[e]=t.loaded,r._options.onProgress(e,i,t.loaded,t.total))},s.onreadystatechange=function(){4==s.readyState&&r._onComplete(e,s)},(t=t||{})[this._options.inputName]=i;var o=qq.obj2url(t,this._options.endpoint),a=this._options.demoMode?"GET":"POST";if(s.open(a,o,!0),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("X-File-Name",encodeURIComponent(i)),s.setRequestHeader("Cache-Control","no-cache"),this._options.forceMultipart){var l=new FormData;l.append(this._options.inputName,n),n=l}else s.setRequestHeader("Content-Type","application/octet-stream"),s.setRequestHeader("X-Mime-Type",n.type);for(key in this._options.customHeaders)s.setRequestHeader(key,this._options.customHeaders[key]);this.log("Sending upload request for "+e),s.send(n)},_onComplete:function(id,xhr){"use strict";if(this._files[id]){var name=this.getName(id),size=this.getSize(id),response;this._options.onProgress(id,name,size,size),this.log("xhr - server response received for "+id),this.log("responseText = "+xhr.responseText);try{response="function"==typeof JSON.parse?JSON.parse(xhr.responseText):eval("("+xhr.responseText+")")}catch(error){this.log("Error when attempting to parse xhr response text ("+error+")","error"),response={}}(200===xhr.status&&response.success||!this._options.onAutoRetry(id,name,response,xhr))&&(this._options.onComplete(id,name,response,xhr),this._xhrs[id]=null,this._dequeue(id))}},_cancel:function(t){this._options.onCancel(t,this.getName(t)),this._files[t]=null,this._xhrs[t]&&(this._xhrs[t].abort(),this._xhrs[t]=null)}}),function(s){"use strict";var n,r,e,i,o,a,l,c,p,u;a=["uploaderType"],e=function(t){if(t){var e=c(t);l(e),"basic"===o("uploaderType")?n(new qq.FineUploaderBasic(e)):n(new qq.FineUploader(e))}return r},i=function(t,e){var n=r.data("fineuploader");if(!e)return n===undefined?null:n[t];n===undefined&&(n={}),n[t]=e,r.data("fineuploader",n)},n=function(t){return i("uploader",t)},o=function(t,e){return i(t,e)},l=function(t){var i=t.callbacks={};s.each((new qq.FineUploaderBasic)._options.callbacks,function(t){var e,n;e=(e=/^on(\w+)/.exec(t)[1]).substring(0,1).toLowerCase()+e.substring(1),n=r,i[t]=function(){var t=Array.prototype.slice.call(arguments);return n.triggerHandler(e,t)}})},c=function(t,e){var n,i;if(n=e===undefined?"basic"!==t.uploaderType?{element:r[0]}:{}:e,s.each(t,function(t,e){0<=s.inArray(t,a)?o(t,e):e instanceof s?n[t]=e[0]:s.isPlainObject(e)?(n[t]={},c(e,n[t])):s.isArray(e)?(i=[],s.each(e,function(t,e){e instanceof s?s.merge(i,e):i.push(e)}),n[t]=i):n[t]=e}),e===undefined)return n},p=function(t){return"string"===s.type(t)&&!t.match(/^_/)&&n()[t]!==undefined},u=function(t){return n()[t].apply(n(),Array.prototype.slice.call(arguments,1))},s.fn.fineUploader=function(t){return r=this,n()&&p(t)?u.apply(this,arguments):"object"!=typeof t&&t?(s.error("Method "+t+" does not exist on jQuery.fineUploader"),this):e.apply(this,arguments)}}(jQuery),function(c){function t(t){if("string"==typeof t.data&&(t.data={keys:t.data}),t.data&&t.data.keys&&"string"==typeof t.data.keys){var a=t.handler,l=t.data.keys.toLowerCase().split(" ");t.handler=function(n){if(this===n.target||!(c.hotkeys.options.filterInputAcceptingElements&&c.hotkeys.textInputTypes.test(n.target.nodeName)||c.hotkeys.options.filterContentEditable&&c(n.target).attr("contenteditable")||c.hotkeys.options.filterTextInputs&&-1<c.inArray(n.target.type,c.hotkeys.textAcceptingInputTypes))){var i="keypress"!==n.type&&c.hotkeys.specialKeys[n.which],t=String.fromCharCode(n.which).toLowerCase(),s="",e={};c.each(["alt","ctrl","shift"],function(t,e){n[e+"Key"]&&i!==e&&(s+=e+"+")}),n.metaKey&&!n.ctrlKey&&"meta"!==i&&(s+="meta+"),n.metaKey&&"meta"!==i&&-1<s.indexOf("alt+ctrl+shift+")&&(s=s.replace("alt+ctrl+shift+","hyper+")),i?e[s+i]=!0:(e[s+t]=!0,e[s+c.hotkeys.shiftNums[t]]=!0,"shift+"===s&&(e[c.hotkeys.shiftNums[t]]=!0));for(var r=0,o=l.length;r<o;r++)if(e[l[r]])return a.apply(this,arguments)}}}}c.hotkeys={version:"0.2.0",specialKeys:{8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},textAcceptingInputTypes:["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color","tel"],textInputTypes:/textarea|input|select/i,options:{filterInputAcceptingElements:!1,filterTextInputs:!1,filterContentEditable:!1}},c.each(["keydown","keyup","keypress"],function(){c.event.special[this]={add:t}})}(jQuery||this.jQuery||window.jQuery),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(t.jQuery)}(this,function(s){"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e});var n={init:function(t){return this.options=s.extend({},s.noty.defaults,t),this.options.layout=this.options.custom?s.noty.layouts.inline:s.noty.layouts[this.options.layout],s.noty.themes[this.options.theme]?this.options.theme=s.noty.themes[this.options.theme]:t.themeClassName=this.options.theme,delete t.layout,delete t.theme,this.options=s.extend({},this.options,this.options.layout.options),this.options.id="noty_"+(new Date).getTime()*Math.floor(1e6*Math.random()),this.options=s.extend({},this.options,t),this._build(),this},_build:function(){var t=s('<div class="noty_bar noty_type_'+this.options.type+'"></div>').attr("id",this.options.id);if(t.append(this.options.template).find(".noty_text").html(this.options.text),this.$bar=null!==this.options.layout.parent.object?s(this.options.layout.parent.object).css(this.options.layout.parent.css).append(t):t,this.options.themeClassName&&this.$bar.addClass(this.options.themeClassName).addClass("noty_container_type_"+this.options.type),this.options.buttons){this.options.closeWith=[],this.options.timeout=!1;var e=s("<div/>").addClass("noty_buttons");null!==this.options.layout.parent.object?this.$bar.find(".noty_bar").append(e):this.$bar.append(e);var i=this;s.each(this.options.buttons,function(t,e){var n=s("<button/>").addClass(e.addClass?e.addClass:"gray").html(e.text).attr("id",e.id?e.id:"button-"+t).attr("title",e.title).appendTo(i.$bar.find(".noty_buttons")).on("click",function(t){s.isFunction(e.onClick)&&e.onClick.call(n,i,t)})})}this.$message=this.$bar.find(".noty_message"),this.$closeButton=this.$bar.find(".noty_close"),this.$buttons=this.$bar.find(".noty_buttons"),s.noty.store[this.options.id]=this},show:function(){var e=this;return e.options.custom?e.options.custom.find(e.options.layout.container.selector).append(e.$bar):s(e.options.layout.container.selector).append(e.$bar),e.options.theme&&e.options.theme.style&&e.options.theme.style.apply(e),"function"===s.type(e.options.layout.css)?this.options.layout.css.apply(e.$bar):e.$bar.css(this.options.layout.css||{}),e.$bar.addClass(e.options.layout.addClass),e.options.layout.container.style.apply(s(e.options.layout.container.selector),[e.options.within]),e.showing=!0,e.options.theme&&e.options.theme.style&&e.options.theme.callback.onShow.apply(this),-1<s.inArray("click",e.options.closeWith)&&e.$bar.css("cursor","pointer").one("click",function(t){e.stopPropagation(t),e.options.callback.onCloseClick&&e.options.callback.onCloseClick.apply(e),e.close()}),-1<s.inArray("hover",e.options.closeWith)&&e.$bar.one("mouseenter",function(){e.close()}),-1<s.inArray("button",e.options.closeWith)&&e.$closeButton.one("click",function(t){e.stopPropagation(t),e.close()}),-1==s.inArray("button",e.options.closeWith)&&e.$closeButton.remove(),e.options.callback.onShow&&e.options.callback.onShow.apply(e),"string"==typeof e.options.animation.open?(e.$bar.css("height",e.$bar.innerHeight()),e.$bar.on("click",function(){e.wasClicked=!0}),e.$bar.show().addClass(e.options.animation.open).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.options.callback.afterShow&&e.options.callback.afterShow.apply(e),e.showing=!1,e.shown=!0,e.hasOwnProperty("wasClicked")&&(e.$bar.off("click",function(){e.wasClicked=!0}),e.close())})):e.$bar.animate(e.options.animation.open,e.options.animation.speed,e.options.animation.easing,function(){e.options.callback.afterShow&&e.options.callback.afterShow.apply(e),e.showing=!1,e.shown=!0}),e.options.timeout&&e.$bar.delay(e.options.timeout).promise().done(function(){e.close()}),this},close:function(){if(!(this.closed||this.$bar&&this.$bar.hasClass("i-am-closing-now"))){var n=this;if(this.showing)n.$bar.queue(function(){n.close.apply(n)});else{if(!this.shown&&!this.showing){var i=[];return s.each(s.noty.queue,function(t,e){e.options.id!=n.options.id&&i.push(e)}),void(s.noty.queue=i)}n.$bar.addClass("i-am-closing-now"),n.options.callback.onClose&&n.options.callback.onClose.apply(n),"string"==typeof n.options.animation.close?n.$bar.addClass(n.options.animation.close).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){n.options.callback.afterClose&&n.options.callback.afterClose.apply(n),n.closeCleanUp()}):n.$bar.clearQueue().stop().animate(n.options.animation.close,n.options.animation.speed,n.options.animation.easing,function(){n.options.callback.afterClose&&n.options.callback.afterClose.apply(n)}).promise().done(function(){n.closeCleanUp()})}}},closeCleanUp:function(){var t=this;t.options.modal&&(s.notyRenderer.setModalCount(-1),0==s.notyRenderer.getModalCount()&&s(".noty_modal").fadeOut(t.options.animation.fadeSpeed,function(){s(this).remove()})),s.notyRenderer.setLayoutCountFor(t,-1),0==s.notyRenderer.getLayoutCountFor(t)&&s(t.options.layout.container.selector).remove(),"undefined"!=typeof t.$bar&&null!==t.$bar&&("string"==typeof t.options.animation.close?(t.$bar.css("transition","all 100ms ease").css("border",0).css("margin",0).height(0),t.$bar.one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){t.$bar.remove(),t.$bar=null,t.closed=!0,t.options.theme.callback&&t.options.theme.callback.onClose&&t.options.theme.callback.onClose.apply(t)})):(t.$bar.remove(),t.$bar=null,t.closed=!0)),delete s.noty.store[t.options.id],t.options.theme.callback&&t.options.theme.callback.onClose&&t.options.theme.callback.onClose.apply(t),t.options.dismissQueue||(s.noty.ontap=!0,s.notyRenderer.render()),0<t.options.maxVisible&&t.options.dismissQueue&&s.notyRenderer.render()},setText:function(t){return this.closed||(this.options.text=t,this.$bar.find(".noty_text").html(t)),this},setType:function(t){return this.closed||(this.options.type=t,this.options.theme.style.apply(this),this.options.theme.callback.onShow.apply(this)),this},setTimeout:function(t){if(!this.closed){var e=this;this.options.timeout=t,e.$bar.delay(e.options.timeout).promise().done(function(){e.close()})}return this},stopPropagation:function(t){"undefined"!=typeof(t=t||window.event).stopPropagation?t.stopPropagation():t.cancelBubble=!0},closed:!1,showing:!1,shown:!1};s.notyRenderer={},s.notyRenderer.init=function(t){var e=Object.create(n).init(t);return e.options.killer&&s.noty.closeAll(),e.options.force?s.noty.queue.unshift(e):s.noty.queue.push(e),s.notyRenderer.render(),"object"==s.noty.returns?e:e.options.id},s.notyRenderer.render=function(){var t=s.noty.queue[0];"object"===s.type(t)?t.options.dismissQueue?0<t.options.maxVisible?s(t.options.layout.container.selector+" > li").length<t.options.maxVisible&&s.notyRenderer.show(s.noty.queue.shift()):s.notyRenderer.show(s.noty.queue.shift()):s.noty.ontap&&(s.notyRenderer.show(s.noty.queue.shift()),s.noty.ontap=!1):s.noty.ontap=!0},
s.notyRenderer.show=function(t){t.options.modal&&(s.notyRenderer.createModalFor(t),s.notyRenderer.setModalCount(1)),t.options.custom?0==t.options.custom.find(t.options.layout.container.selector).length?t.options.custom.append(s(t.options.layout.container.object).addClass("i-am-new")):t.options.custom.find(t.options.layout.container.selector).removeClass("i-am-new"):0==s(t.options.layout.container.selector).length?s("body").append(s(t.options.layout.container.object).addClass("i-am-new")):s(t.options.layout.container.selector).removeClass("i-am-new"),s.notyRenderer.setLayoutCountFor(t,1),t.show()},s.notyRenderer.createModalFor=function(t){if(0==s(".noty_modal").length){var e=s("<div/>").addClass("noty_modal").addClass(t.options.theme).data("noty_modal_count",0);t.options.theme.modal&&t.options.theme.modal.css&&e.css(t.options.theme.modal.css),e.prependTo(s("body")).fadeIn(t.options.animation.fadeSpeed),-1<s.inArray("backdrop",t.options.closeWith)&&e.on("click",function(){s.noty.closeAll()})}},s.notyRenderer.getLayoutCountFor=function(t){return s(t.options.layout.container.selector).data("noty_layout_count")||0},s.notyRenderer.setLayoutCountFor=function(t,e){return s(t.options.layout.container.selector).data("noty_layout_count",s.notyRenderer.getLayoutCountFor(t)+e)},s.notyRenderer.getModalCount=function(){return s(".noty_modal").data("noty_modal_count")||0},s.notyRenderer.setModalCount=function(t){return s(".noty_modal").data("noty_modal_count",s.notyRenderer.getModalCount()+t)},s.fn.noty=function(t){return t.custom=s(this),s.notyRenderer.init(t)},s.noty={},s.noty.queue=[],s.noty.ontap=!0,s.noty.layouts={},s.noty.themes={},s.noty.returns="object",s.noty.store={},s.noty.get=function(t){return!!s.noty.store.hasOwnProperty(t)&&s.noty.store[t]},s.noty.close=function(t){return!!s.noty.get(t)&&s.noty.get(t).close()},s.noty.setText=function(t,e){return!!s.noty.get(t)&&s.noty.get(t).setText(e)},s.noty.setType=function(t,e){return!!s.noty.get(t)&&s.noty.get(t).setType(e)},s.noty.clearQueue=function(){s.noty.queue=[]},s.noty.closeAll=function(){s.noty.clearQueue(),s.each(s.noty.store,function(t,e){e.close()})};var t=window.alert;return s.noty.consumeAlert=function(e){window.alert=function(t){e?e.text=t:e={text:t},s.notyRenderer.init(e)}},s.noty.stopConsumeAlert=function(){window.alert=t},s.noty.defaults={layout:"top",theme:"defaultTheme",type:"alert",text:"",dismissQueue:!0,template:'<div class="noty_message"><span class="noty_text"></span><div class="noty_close"></div></div>',animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:500,fadeSpeed:"fast"},timeout:!1,force:!1,modal:!1,maxVisible:5,killer:!1,closeWith:["click"],callback:{onShow:function(){},afterShow:function(){},onClose:function(){},afterClose:function(){},onCloseClick:function(){}},buttons:!1},s(window).on("resize",function(){s.each(s.noty.layouts,function(t,e){e.container.style.apply(s(e.container.selector))})}),window.noty=function e(t){return s.notyRenderer.init(t)},s.noty.layouts.bottom={name:"bottom",options:{},container:{object:'<ul id="noty_bottom_layout_container" />',selector:"ul#noty_bottom_layout_container",style:function(){s(this).css({bottom:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""},s.noty.layouts.bottomCenter={name:"bottomCenter",options:{},container:{object:'<ul id="noty_bottomCenter_layout_container" />',selector:"ul#noty_bottomCenter_layout_container",style:function(){s(this).css({bottom:20,left:0,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),s(this).css({left:(s(window).width()-s(this).outerWidth(!1))/2+"px"})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},s.noty.layouts.bottomLeft={name:"bottomLeft",options:{},container:{object:'<ul id="noty_bottomLeft_layout_container" />',selector:"ul#noty_bottomLeft_layout_container",style:function(){s(this).css({bottom:20,left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&s(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},s.noty.layouts.bottomRight={name:"bottomRight",options:{},container:{object:'<ul id="noty_bottomRight_layout_container" />',selector:"ul#noty_bottomRight_layout_container",style:function(){s(this).css({bottom:20,right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&s(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},s.noty.layouts.center={name:"center",options:{},container:{object:'<ul id="noty_center_layout_container" />',selector:"ul#noty_center_layout_container",style:function(){s(this).css({position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var t=s(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");s("body").append(t),t.find(".i-am-closing-now").remove(),t.find("li").css("display","block");var e=t.height();t.remove(),s(this).hasClass("i-am-new")?s(this).css({left:(s(window).width()-s(this).outerWidth(!1))/2+"px",top:(s(window).height()-e)/2+"px"}):s(this).animate({left:(s(window).width()-s(this).outerWidth(!1))/2+"px",top:(s(window).height()-e)/2+"px"},500)}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},s.noty.layouts.centerLeft={name:"centerLeft",options:{},container:{object:'<ul id="noty_centerLeft_layout_container" />',selector:"ul#noty_centerLeft_layout_container",style:function(){s(this).css({left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var t=s(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");s("body").append(t),t.find(".i-am-closing-now").remove(),t.find("li").css("display","block");var e=t.height();t.remove(),s(this).hasClass("i-am-new")?s(this).css({top:(s(window).height()-e)/2+"px"}):s(this).animate({top:(s(window).height()-e)/2+"px"},500),window.innerWidth<600&&s(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},s.noty.layouts.centerRight={name:"centerRight",options:{},container:{object:'<ul id="noty_centerRight_layout_container" />',selector:"ul#noty_centerRight_layout_container",style:function(){s(this).css({right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var t=s(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");s("body").append(t),t.find(".i-am-closing-now").remove(),t.find("li").css("display","block");var e=t.height();t.remove(),s(this).hasClass("i-am-new")?s(this).css({top:(s(window).height()-e)/2+"px"}):s(this).animate({top:(s(window).height()-e)/2+"px"},500),window.innerWidth<600&&s(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},s.noty.layouts.inline={name:"inline",options:{},container:{object:'<ul class="noty_inline_layout_container" />',selector:"ul.noty_inline_layout_container",style:function(){s(this).css({width:"100%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""},s.noty.layouts.top={name:"top",options:{},container:{object:'<ul id="noty_top_layout_container" />',selector:"ul#noty_top_layout_container",style:function(){s(this).css({top:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""},s.noty.layouts.topCenter={name:"topCenter",options:{},container:{object:'<ul id="noty_topCenter_layout_container" />',selector:"ul#noty_topCenter_layout_container",style:function(){s(this).css({top:20,left:0,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),s(this).css({left:(s(window).width()-s(this).outerWidth(!1))/2+"px"})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},s.noty.layouts.topLeft={name:"topLeft",options:{},container:{object:'<ul id="noty_topLeft_layout_container" />',selector:"ul#noty_topLeft_layout_container",style:function(){s(this).css({top:20,left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&s(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},s.noty.layouts.topRight={name:"topRight",options:{},container:{object:'<ul id="noty_topRight_layout_container" />',selector:"ul#noty_topRight_layout_container",style:function(){s(this).css({top:20,right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&s(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},window.noty}),function(o,s,i){function e(t,e){this.element=t,this.$element=o(t),this.options=o.extend({},a,e),this._defaults=a,this._name=r,this._fixedWidth=!0,this.collection=[],this.active=!1,this.buffer="",o.data(t,"plugin_ce")&&(this.ce=o.data(t,"plugin_ce")),this.init()}function t(){}function n(){}var r="textmodule",a={debug:!1};e.prototype.init=function(){this.renderBase(),this.bindEvents()},e.prototype.bindEvents=function(){this.$element.on("keydown",this.onKeydown.bind(this)),this.$element.on("keypress",this.onKeypress.bind(this)),this.$element.on("focus",this.onFocus.bind(this))},e.prototype.onFocus=function(){this.close()},e.prototype.onKeydown=function(t){if(this.isActive()){if(27===t.keyCode)return t.preventDefault(),t.stopPropagation(),void this.close();if(13===t.keyCode){t.preventDefault(),t.stopPropagation();var e=this.$widget.find(".dropdown-menu li.is-active")[0];return e||(e=this.$widget.find(".dropdown-menu li:hover")[0]),e||(e=this.$widget.find(".dropdown-menu li:first-child")[0]),void this.take(e)}if(37===t.keyCode||39===t.keyCode)return t.preventDefault(),void t.stopPropagation();if(38===t.keyCode||40===t.keyCode){t.preventDefault(),t.stopPropagation();var n=this.$widget.find(".dropdown-menu li.is-active");n.removeClass("is-active"),38==t.keyCode&&n.prev().size()?n=n.prev():40==t.keyCode&&n.next().size()&&(n=n.next()),n.addClass("is-active");var i=this.$widget.find(".dropdown-menu");if(!n.get(0))return;if(n.position().top<0)i.scrollTop(i.scrollTop()+n.position().top);else if(n.position().top+n.height()>i.height()){var s=n.position().top+n.height()-i.height();i.scrollTop(i.scrollTop()+s)}}}if(27===t.keyCode&&this.close(),8===t.keyCode&&this.buffer){var r=this.findTrigger(this.buffer);if(r&&r.trigger===this.buffer)return this.close(!0),void t.preventDefault();var o=this.buffer.length;this.buffer=this.buffer.substr(0,o-1),this.log("BS backspace",this.buffer),this.result(r)}},e.prototype.onKeypress=function(t){if(this.log("BUFF",this.buffer,t.keyCode,String.fromCharCode(t.which)),16!==t.keyCode)if(13!==t.keyCode){if(37!==t.keyCode&&38!==t.keyCode&&39!==t.keyCode&&40!==t.keyCode){var e=String.fromCharCode(t.which);this.hasAvailableTriggers(this.buffer)&&(this.hasAvailableTriggers(this.buffer+e)?this.buffer=this.buffer+e:this.findTrigger(this.buffer)||(this.buffer="")),!this.buffer&&this.hasAvailableTriggers(e)&&(this.buffer=this.buffer+e);var n=this.findTrigger(this.buffer);n&&(this.log("BUFF HINT",this.buffer,this.buffer.length,t.which,String.fromCharCode(t.which)),this.isActive()||this.open(),this.result(n))}}else this.buffer=""},e.prototype.hasAvailableTriggers=function(n){return _.find(this.helpers,function(t){var e=t.trigger;return e.substr(0,n.length)==n.substr(0,e.length)})!=i},e.prototype.findTrigger=function(e){return _.find(this.helpers,function(t){return t.trigger==e.substr(0,t.trigger.length)})},e.prototype.renderBase=function(){this.$element.after('<div class="shortcut dropdown"><ul class="dropdown-menu" style="max-height: 200px;"></ul></div>'),this.$widget=this.$element.next(),this.$widget.on("mousedown","li",o.proxy(this.onEntryClick,this)),this.$widget.on("mouseenter","li",o.proxy(this.onMouseEnter,this))},e.prototype.movePosition=function(){if(this._position){var t=this.$element.outerHeight()+2,e=this.$widget.find("ul").height(),n="rtl"==document.dir,i=-(e+t)+this._position.top,s=this._position.left-6,r=this.$element.innerWidth(),o=this.$widget.find(".dropdown-menu").width();n&&(s=r-s),r<s+o&&(s=r-o);var a={top:i};a[n?"right":"left"]=s,this.$widget.css(a)}},e.prototype.updatePosition=function(){if(this.$widget.find(".dropdown-menu").scrollTop(300),this.$element.is(":visible")){var t='<span id="js-cursor-position"></span>';this.getFirstRange().cloneRange().pasteHtml(t),this._position=o("#js-cursor-position").position(),o("#js-cursor-position").remove(),this._position&&this.movePosition()}},e.prototype.open=function(){this.active=!0,this.updatePosition(),this.renderBase(),this.$widget.addClass("open"),o(s).on("click.textmodule",o.proxy(this.close,this))},e.prototype.close=function(t){this.$widget.removeClass("open"),t&&this.active&&this.cutInput(!0),this.buffer="",this.active=!1,this.$widget.remove(),o(s).off("click.textmodule")},e.prototype.isActive=function(){return this.active},e.prototype.paste=function(t){var e=!!s.MSInputMethodContext&&!!document.documentMode;if(document.selection&&document.selection.createRange)(n=document.selection.createRange()).pasteHTML&&n.pasteHTML(t);else if(e&&document.getSelection){var n=document.getSelection().getRangeAt(0),i=document.createElement("div");n.surroundContents(i),i.innerHTML=t}else document.execCommand("insertHTML",!1,t)},e.prototype.cut=function(t){var e=this.getFirstRange();if(e){var n=e.cloneRange();if(start=e.startOffset-t.length,start<0&&(start=0),start){n.setStart(e.startContainer,start-1),n.setEnd(e.startContainer,start);var i=n.toString();" "===i&&(start-=1)}n.setStart(e.startContainer,start),n.setEnd(e.startContainer,e.startOffset),n.deleteContents(),start&&" "===i&&this.paste("&nbsp;")}},e.prototype.onMouseEnter=function(t){this.$widget.find(".is-active").removeClass("is-active"),o(t.currentTarget).addClass("is-active")},e.prototype.onEntryClick=function(t){t.preventDefault(),this.take(t.currentTarget)},e.prototype.take=function(t){if(t){var e=this.findTrigger(this.buffer);if(e){var n=this,i=this.$element.closest("form").find("[name=form_id]").val();e.renderValue(this,t,function(t,e){n.cutInput(),n.paste(t),n.close(!0),App.Event.trigger("ui::ticket::addArticleAttachent",{attachments:e,form_id:i})})}}else this.close(!0)},e.prototype.getFirstRange=function(){var t=rangy.getSelection();return t.rangeCount?t.getRangeAt(0):null},e.prototype.cutInput=function(){this.buffer&&this.$element.text()&&(this.cut(this.buffer),this.buffer="")},e.prototype.result=function(t){if(t){var e=this.buffer.substr(t.trigger.length,this.buffer.length);t.renderResults(this,e)}},e.prototype.emptyResultsContainer=function(){this.$widget.find("ul").empty()},e.prototype.appendResults=function(t){this.$widget.find("ul").append(t).scrollTop(9999),this.afterResultRendering()},e.prototype.afterResultRendering=function(){if(this._fixedWidth){var t=this.$widget.find("ul"),e=parseInt(t.css("min-width")),n=t.width();(!e||e<n)&&t.css("min-width",n+"px")}this.movePosition()},e.prototype.log=function(){App&&App.Log&&App.Log.debug(this._name,arguments),this.options.debug&&console.log(this._name,arguments)},o.fn[r]=function(t){return this.each(function(){o.data(this,"plugin_"+r)||o.data(this,"plugin_"+r,new e(this,t))})},t.renderValue=function(t,e,n){var i=o(e).data("id"),s=_.find(t.collection,function(t){return t.id==i});s&&n(s.content,[])},t.renderResults=function(t,e){var n=new RegExp(e,"i"),i=t.collection.filter(function(t){return t.name&&t.name.match(n)||t.keywords&&t.keywords.match(n)});i.reverse(),t.emptyResultsContainer();var s=i.map(function(t,e,n){var i=o("<li>").attr("data-id",t.id).text(t.name).addClass("u-clickable u-textTruncate");return e==n.length-1&&i.addClass("is-active"),t.keywords&&i.append(o("<kbd>").text(t.keywords)),i});t.appendResults(s)},t.trigger="::",n.renderValue=function(t,i,s){t.emptyResultsContainer();var e=o("<li>").text(App.i18n.translateInline("Please wait..."));t.appendResults(e);var r=t.$element.closest("form").find("[name=form_id]").val();App.Ajax.request({id:"textmoduleKbAnswer",type:"GET",url:o(i).data("url"),success:function(t){App.Collection.loadAssets(t.assets);var e=App.KnowledgeBaseAnswerTranslation.find(o(i).data("id")),n=e.content().bodyWithPublicURLs();App.Ajax.request({id:"textmoduleKbAnswerAttachments",type:"POST",data:JSON.stringify({form_id:r}),url:e.parent().generateURL("/attachments/clone_to_form"),success:function(t){e.parent().attachments+=t.attachments,App.Utils.htmlImage2DataUrlAsync(n,function(t){s(t,e.parent().attachments)})},error:function(){s("")}})},error:function(){s("")}})},n.renderResults=function(n,t){if(n.emptyResultsContainer(),t){e=o("<li>").text(App.i18n.translateInline("Loading..."));n.appendResults(e),App.Delay.set(function(){App.Ajax.request({id:"textmoduleKbAnswer",type:"POST",url:App.Config.get("api_path")+"/knowledge_bases/search",data:JSON.stringify({query:t,flavor:"agent",index:"KnowledgeBase::Answer::Translation",url_type:"agent",highlight_enabled:!1}),processData:!0,success:function(t){n.emptyResultsContainer();var e=t.result.map(function(e){if(result=_.find(t.details,function(t){return t.type==e.type&&t.id==e.id}))return{name:result.title,value:e.id,url:result.url}}).filter(function(t){return t!=i}).map(function(t,e,n){var i=o("<li>").attr("data-id",t.value).attr("data-url",t.url).text(t.name).addClass("u-clickable u-textTruncate");return e==n.length-1&&i.addClass("is-active"),i});0==e.length&&e.push(o("<li>").text(App.i18n.translateInline("No results found"))),n.appendResults(e)}})},200,"textmoduleKbAnswerDelay","textmodule")}else{var e=o("<li>").text(App.i18n.translateInline("Start typing to search in Knowledge Base..."));n.appendResults(e)}},n.trigger="??",e.prototype.helpers=[t,n]}(jQuery,window),function(t){var j=t(window);t.fn.visible=function(t,e,n){if(!(this.length<1)){var i=1<this.length?this.eq(0):this,s=i.get(0),r=j.width(),o=j.height(),a=(n=n||"both",!0!==e||s.offsetWidth*s.offsetHeight);if("function"==typeof s.getBoundingClientRect){var l=s.getBoundingClientRect(),c=0<=l.top&&l.top<o,p=0<l.bottom&&l.bottom<=o,u=0<=l.left&&l.left<r,h=0<l.right&&l.right<=r,d=t?c||p:c&&p,f=t?u||h:u&&h;if("both"===n)return a&&d&&f;if("vertical"===n)return a&&d;if("horizontal"===n)return a&&f}else{var m=j.scrollTop(),g=m+o,v=j.scrollLeft(),y=v+r,b=i.offset(),_=b.top,w=_+i.height(),k=b.left,T=k+i.width(),A=!0===t?w:_,S=!0===t?_:w,C=!0===t?T:k,x=!0===t?k:T;if("both"===n)return!!a&&S<=g&&m<=A&&x<=y&&v<=C;if("vertical"===n)return!!a&&S<=g&&m<=A;if("horizontal"===n)return!!a&&x<=y&&v<=C}}}}(jQuery),function(){function c(t){this.tokens=[],this.tokens.links={},this.options=t||d.defaults,this.rules=f.normal,this.options.gfm&&(this.options.tables?this.rules=f.tables:this.rules=f.gfm)}function i(t,e){if(this.options=e||d.defaults,this.links=t,this.rules=s.normal,this.renderer=this.options.renderer||new n,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=s.breaks:this.rules=s.gfm:this.options.pedantic&&(this.rules=s.pedantic)}function n(t){this.options=t||{}}function p(t){this.tokens=[],this.token=null,this.options=t||d.defaults,this.options.renderer=this.options.renderer||new n,this.renderer=this.options.renderer,this.renderer.options=this.options}function u(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function o(t){return t.replace(/&([#\w]+);/g,function(t,e){return"colon"===(e=e.toLowerCase())?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""})}function t(n,i){return n=n.source,i=i||"",function s(t,e){return t?(e=(e=e.source||e).replace(/(^|[^\[])\^/g,"$1"),n=n.replace(t,e),s):new RegExp(n,i)}}function e(){}function h(t){for(var e,n,i=1;i<arguments.length;i++)for(n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function d(t,n,i){if(i||"function"==typeof n){i||(i=n,n=null);var s,r,o=(n=h({},d.defaults,n||{})).highlight,e=0;try{s=c.lex(t,n)}catch(l){return i(l)}r=s.length;var a=function(t){if(t)return n.highlight=o,i(t);var e;try{e=p.parse(s,n)}catch(l){t=l}return n.highlight=o,t?i(t):i(null,e)};if(!o||o.length<3)return a();if(delete n.highlight,!r)return a();for(;e<s.length;e++)!function(n){"code"!==n.type?--r||a():o(n.text,n.lang,function(t,e){return t?a(t):null==e||e===n.text?--r||a():(n.text=e,n.escaped=!0,void(--r||a()))})}(s[e])}else try{return n&&(n=h({},d.defaults,n)),p.parse(c.lex(t,n),n)}catch(l){if(l.message+="\nPlease report this to https://github.com/chjj/marked.",(n||d.defaults).silent)return"<p>An error occured:</p><pre>"+u(l.message+"",!0)+"</pre>";throw l}}var f={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:e,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:e,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:e,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/,bullet:/(?:[*+-]|\d+\.)/,item:/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/};f.item=t(f.item,"gm")(/bull/g,f.bullet)(),f.list=t(f.list)(/bull/g,f.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+f.def.source+")")(),f.blockquote=t(f.blockquote)("def",f.def)(),f._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",f.html=t(f.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,f._tag)(),f.paragraph=t(f.paragraph)("hr",f.hr)("heading",f.heading)("lheading",f.lheading)("blockquote",f.blockquote)("tag","<"+f._tag)("def",f.def)(),f.normal=h({},f),f.gfm=h({},f.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),f.gfm.paragraph=t(f.paragraph)("(?!","(?!"+f.gfm.fences.source.replace("\\1","\\2")+"|"+f.list.source.replace("\\1","\\3")+"|")(),f.tables=h({},f.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),c.rules=f,c.lex=function(t,e){return new c(e).lex(t)},c.prototype.lex=function(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(t,!0)},c.prototype.token=function(t,e,n){var i,s,r,o,a,l,c,p,u;for(t=t.replace(/^ +$/gm,"");t;)if((r=this.rules.newline.exec(t))&&(t=t.substring(r[0].length),1<r[0].length&&this.tokens.push({type:"space"})),r=this.rules.code.exec(t))t=t.substring(r[0].length),r=r[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?r:r.replace(/\n+$/,"")});else if(r=this.rules.fences.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"code",lang:r[2],text:r[3]||""});else if(r=this.rules.heading.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"heading",depth:r[1].length,text:r[2]});else if(e&&(r=this.rules.nptable.exec(t))){for(t=t.substring(r[0].length),l={type:"table",header:r[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:r[3].replace(/\n$/,"").split("\n")},p=0;p<l.align.length;p++)/^ *-+: *$/.test(l.align[p])?l.align[p]="right":/^ *:-+: *$/.test(l.align[p])?l.align[p]="center":/^ *:-+ *$/.test(l.align[p])?l.align[p]="left":l.align[p]=null;for(p=0;p<l.cells.length;p++)l.cells[p]=l.cells[p].split(/ *\| */);this.tokens.push(l)}else if(r=this.rules.lheading.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"heading",depth:"="===r[2]?1:2,text:r[1]});else if(r=this.rules.hr.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"hr"});else if(r=this.rules.blockquote.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"blockquote_start"}),r=r[0].replace(/^ *> ?/gm,""),this.token(r,e,!0),this.tokens.push({type:"blockquote_end"});else if(r=this.rules.list.exec(t)){for(t=t.substring(r[0].length),o=r[2],this.tokens.push({type:"list_start",ordered:1<o.length}),i=!1,u=(r=r[0].match(this.rules.item)).length,p=0;p<u;p++)c=(l=r[p]).length,~(l=l.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(c-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+c+"}","gm"),"")),this.options.smartLists&&p!==u-1&&(o===(a=f.bullet.exec(r[p+1])[0])||1<o.length&&1<a.length||(t=r.slice(p+1).join("\n")+t,p=u-1)),s=i||/\n\n(?!\s*$)/.test(l),p!==u-1&&(i="\n"===l.charAt(l.length-1),s||(s=i)),this.tokens.push({type:s?"loose_item_start":"list_item_start"}),this.token(l,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(r=this.rules.html.exec(t))t=t.substring(r[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===r[1]||"script"===r[1]||"style"===r[1]),text:r[0]});else if(!n&&e&&(r=this.rules.def.exec(t)))t=t.substring(r[0].length),this.tokens.links[r[1].toLowerCase()]={href:r[2],title:r[3]};else if(e&&(r=this.rules.table.exec(t))){for(t=t.substring(r[0].length),l={type:"table",header:r[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:r[3].replace(/(?: *\| *)?\n$/,"").split("\n")},p=0;p<l.align.length;p++)/^ *-+: *$/.test(l.align[p])?l.align[p]="right":/^ *:-+: *$/.test(l.align[p])?l.align[p]="center":/^ *:-+ *$/.test(l.align[p])?l.align[p]="left":l.align[p]=null;for(p=0;p<l.cells.length;p++)l.cells[p]=l.cells[p].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(e&&(r=this.rules.paragraph.exec(t)))t=t.substring(r[0].length),this.tokens.push({type:"paragraph",text:"\n"===r[1].charAt(r[1].length-1)?r[1].slice(0,-1):r[1]});else if(r=this.rules.text.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"text",text:r[0]});else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0));return this.tokens};var s={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:e,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:e,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/,_inside:/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,_href:/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/};s.link=t(s.link)("inside",s._inside)("href",s._href)(),s.reflink=t(s.reflink)("inside",s._inside)(),s.normal=h({},s),s.pedantic=h({},s.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),s.gfm=h({},s.normal,{escape:t(s.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:t(s.text)("]|","~]|")("|","|https?://|")()}),s.breaks=h({},s.gfm,{br:t(s.br)("{2,}","*")(),text:t(s.gfm.text)("{2,}","*")()}),i.rules=s,i.output=function(t,e,n){return new i(e,n).output(t)},i.prototype.output=function(t){for(var e,n,i,s,r="";t;)if(s=this.rules.escape.exec(t))t=t.substring(s[0].length),r+=s[1];else if(s=this.rules.autolink.exec(t))t=t.substring(s[0].length),"@"===s[2]?(n=":"===s[1].charAt(6)?this.mangle(s[1].substring(7)):this.mangle(s[1]),i=this.mangle("mailto:")+n):i=n=u(s[1]),r+=this.renderer.link(i,null,n);else if(this.inLink||!(s=this.rules.url.exec(t))){if(s=this.rules.tag.exec(t))!this.inLink&&/^<a /i.test(s[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(s[0])&&(this.inLink=!1),t=t.substring(s[0].length),r+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(s[0]):u(s[0]):s[0];else if(s=this.rules.link.exec(t))t=t.substring(s[0].length),this.inLink=!0,r+=this.outputLink(s,{href:s[2],title:s[3]}),this.inLink=!1;else if((s=this.rules.reflink.exec(t))||(s=this.rules.nolink.exec(t))){if(t=t.substring(s[0].length),e=(s[2]||s[1]).replace(/\s+/g," "),!(e=this.links[e.toLowerCase()])||!e.href){r+=s[0].charAt(0),t=s[0].substring(1)+t;continue}this.inLink=!0,r+=this.outputLink(s,e),this.inLink=!1}else if(s=this.rules.strong.exec(t))t=t.substring(s[0].length),r+=this.renderer.strong(this.output(s[2]||s[1]));else if(s=this.rules.em.exec(t))t=t.substring(s[0].length),r+=this.renderer.em(this.output(s[2]||s[1]));else if(s=this.rules.code.exec(t))t=t.substring(s[0].length),r+=this.renderer.codespan(u(s[2],!0));else if(s=this.rules.br.exec(t))t=t.substring(s[0].length),r+=this.renderer.br();else if(s=this.rules.del.exec(t))t=t.substring(s[0].length),r+=this.renderer.del(this.output(s[1]));else if(s=this.rules.text.exec(t))t=t.substring(s[0].length),r+=this.renderer.text(u(this.smartypants(s[0])));else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0))}else t=t.substring(s[0].length),i=n=u(s[1]),r+=this.renderer.link(i,null,n);return r},i.prototype.outputLink=function(t,e){var n=u(e.href),i=e.title?u(e.title):null;return"!"!==t[0].charAt(0)?this.renderer.link(n,i,this.output(t[1])):this.renderer.image(n,i,u(t[1]))},i.prototype.smartypants=function(t){return this.options.smartypants?t.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026"):t},i.prototype.mangle=function(t){if(!this.options.mangle)return t;for(var e,n="",i=t.length,s=0;s<i;s++)e=t.charCodeAt(s),.5<Math.random()&&(e="x"+e.toString(16)),n+="&#"+e+";";return n},n.prototype.code=function(t,e,n){if(this.options.highlight){var i=this.options.highlight(t,e);null!=i&&i!==t&&(n=!0,t=i)}return e?'<pre><code class="'+this.options.langPrefix+u(e,!0)+'">'+(n?t:u(t,!0))+"\n</code></pre>\n":"<pre><code>"+(n?t:u(t,!0))+"\n</code></pre>"},n.prototype.blockquote=function(t){return"<blockquote>\n"+t+"</blockquote>\n"},n.prototype.html=function(t){return t},n.prototype.heading=function(t,e,n){return"<h"+e+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+t+"</h"+e+">\n"},n.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},n.prototype.list=function(t,e){var n=e?"ol":"ul";return"<"+n+">\n"+t+"</"+n+">\n"},n.prototype.listitem=function(t){return"<li>"+t+"</li>\n"},n.prototype.paragraph=function(t){return"<p>"+t+"</p>\n"},n.prototype.table=function(t,e){return"<table>\n<thead>\n"+t+"</thead>\n<tbody>\n"+e+"</tbody>\n</table>\n"},n.prototype.tablerow=function(t){return"<tr>\n"+t+"</tr>\n"},n.prototype.tablecell=function(t,e){var n=e.header?"th":"td";return(e.align?"<"+n+' style="text-align:'+e.align+'">':"<"+n+">")+t+"</"+n+">\n"},n.prototype.strong=function(t){return"<strong>"+t+"</strong>"},n.prototype.em=function(t){return"<em>"+t+"</em>"},n.prototype.codespan=function(t){return"<code>"+t+"</code>"},n.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},n.prototype.del=function(t){return"<del>"+t+"</del>"},n.prototype.link=function(t,e,n){if(this.options.sanitize){try{var i=decodeURIComponent(o(t)).replace(/[^\w:]/g,"").toLowerCase()}catch(r){return""}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:"))return""}var s='<a href="'+t+'"';return e&&(s+=' title="'+e+'"'),s+=">"+n+"</a>"},n.prototype.image=function(t,e,n){var i='<img src="'+t+'" alt="'+n+'"';return e&&(i+=' title="'+e+'"'),i+=this.options.xhtml?"/>":">"},n.prototype.text=function(t){return t},p.parse=function(t,e,n){return new p(e,n).parse(t)},p.prototype.parse=function(t){this.inline=new i(t.links,this.options,this.renderer),this.tokens=t.reverse();for(var e="";this.next();)e+=this.tok();return e},p.prototype.next=function(){
return this.token=this.tokens.pop()},p.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},p.prototype.parseText=function(){for(var t=this.token.text;"text"===this.peek().type;)t+="\n"+this.next().text;return this.inline.output(t)},p.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var t,e,n,i,s="",r="";for(n="",t=0;t<this.token.header.length;t++)({header:!0,align:this.token.align[t]}),n+=this.renderer.tablecell(this.inline.output(this.token.header[t]),{header:!0,align:this.token.align[t]});for(s+=this.renderer.tablerow(n),t=0;t<this.token.cells.length;t++){for(e=this.token.cells[t],n="",i=0;i<e.length;i++)n+=this.renderer.tablecell(this.inline.output(e[i]),{header:!1,align:this.token.align[i]});r+=this.renderer.tablerow(n)}return this.renderer.table(s,r);case"blockquote_start":for(r="";"blockquote_end"!==this.next().type;)r+=this.tok();return this.renderer.blockquote(r);case"list_start":r="";for(var o=this.token.ordered;"list_end"!==this.next().type;)r+=this.tok();return this.renderer.list(r,o);case"list_item_start":for(r="";"list_item_end"!==this.next().type;)r+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(r);case"loose_item_start":for(r="";"list_item_end"!==this.next().type;)r+=this.tok();return this.renderer.listitem(r);case"html":var a=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(a);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},e.exec=e,d.options=d.setOptions=function(t){return h(d.defaults,t),d},d.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new n,xhtml:!1},d.Parser=p,d.parser=p.parse,d.Renderer=n,d.Lexer=c,d.lexer=c.lex,d.InlineLexer=i,d.inlineLexer=i.output,d.parse=d,void 0!==module&&"object"==typeof exports?module.exports=d:"function"==typeof define&&define.amd?define(function(){return d}):this.marked=d}.call(function(){return this||("undefined"!=typeof window?window:global)}()),window.Modernizr=function(t,e,r){function n(t){g.cssText=t}function o(t,e){return typeof t===e}function s(t,e){return!!~(""+t).indexOf(e)}function a(t,e){for(var n in t){var i=t[n];if(!s(i,"-")&&g[i]!==r)return"pfx"!=e||i}return!1}function l(t,e,n){for(var i in t){var s=e[t[i]];if(s!==r)return!1===n?t[i]:o(s,"function")?s.bind(n||e):s}return!1}function i(t,e,n){var i=t.charAt(0).toUpperCase()+t.slice(1),s=(t+" "+y.join(i+" ")+i).split(" ");return o(e,"string")||o(e,"undefined")?a(s,e):l(s=(t+" "+b.join(i+" ")+i).split(" "),e,n)}var c,p,u="2.8.3",h={},d=e.documentElement,f="modernizr",m=e.createElement(f),g=m.style,v=({}.toString,"Webkit Moz O ms"),y=v.split(" "),b=v.toLowerCase().split(" "),_={},w=[],k=w.slice,T={}.hasOwnProperty;for(var A in p=o(T,"undefined")||o(T.call,"undefined")?function(t,e){return e in t&&o(t.constructor.prototype[e],"undefined")}:function(t,e){return T.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(i){var s=this;if("function"!=typeof s)throw new TypeError;var r=k.call(arguments,1),o=function(){if(this instanceof o){var t=function(){};t.prototype=s.prototype;var e=new t,n=s.apply(e,r.concat(k.call(arguments)));return Object(n)===n?n:e}return s.apply(i,r.concat(k.call(arguments)))};return o}),_)p(_,A)&&(c=A.toLowerCase(),h[c]=_[A](),w.push((h[c]?"":"no-")+c));return h.addTest=function(t,e){if("object"==typeof t)for(var n in t)p(t,n)&&h.addTest(n,t[n]);else{if(t=t.toLowerCase(),h[t]!==r)return h;e="function"==typeof e?e():e,"undefined"!=typeof enableClasses&&enableClasses&&(d.className+=" "+(e?"":"no-")+t),h[t]=e}return h},n(""),m=null,h._version=u,h._domPrefixes=b,h._cssomPrefixes=y,h.testProp=function(t){return a([t])},h.testAllProps=i,h.prefixed=function(t,e,n){return e?i(t,e,n):i(t,"pfx")},h}(0,this.document),function(a,l){function t(t,e,n){var i=[],s=h(u((e=1==e?{entropy:!0}:e||{}).entropy?[t,f(a)]:null==t?d():t,3),i),r=new c(i),o=function(){for(var t=r.g(g),e=y,n=0;t<b;)t=(t+n)*m,e*=m,n=r.g(1);for(;_<=t;)t/=2,e/=2,n>>>=1;return(t+n)/e};return o.int32=function(){return 0|r.g(4)},o.quick=function(){return r.g(4)/4294967296},o["double"]=o,h(f(r.S),a),(e.pass||n||function(t,e,n,i){return i&&(i.S&&p(i,r),t.state=function(){return p(r,{})}),n?(l[v]=t,e):t})(o,s,"global"in e?e.global:this==l,e.state)}function c(t){var e,n=t.length,o=this,i=0,s=o.i=o.j=0,r=o.S=[];for(n||(t=[n++]);i<m;)r[i]=i++;for(i=0;i<m;i++)r[i]=r[s=w&s+t[i%n]+(e=r[i])],r[s]=e;(o.g=function(t){for(var e,n=0,i=o.i,s=o.j,r=o.S;t--;)e=r[i=w&i+1],n=n*m+r[w&(r[i]=r[s=w&s+e])+(r[s]=e)];return o.i=i,o.j=s,n})(m)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function u(t,e){var n,i=[],s=typeof t;if(e&&"object"==s)for(n in t)try{i.push(u(t[n],e-1))}catch(r){}return i.length?i:"string"==s?t:t+"\0"}function h(t,e){for(var n,i=t+"",s=0;s<i.length;)e[w&s]=w&(n^=19*e[w&s])+i.charCodeAt(s++);return f(e)}function d(){try{if(s)return f(s.randomBytes(m));var t=new Uint8Array(m);return(r.crypto||r.msCrypto).getRandomValues(t),f(t)}catch(i){var e=r.navigator,n=e&&e.plugins;return[+new Date,r,n,r.screen,f(a)]}}function f(t){return String.fromCharCode.apply(0,t)}var s,r=this,m=256,g=6,e=52,v="random",y=l.pow(m,g),b=l.pow(2,e),_=2*b,w=m-1;if(l["seed"+v]=t,h(l.random(),a),"object"==typeof module&&module.exports){module.exports=t;try{s=require("crypto")}catch(n){}}else"function"==typeof define&&define.amd&&define(function(){return t})}([],Math),function(c){function p(t,e){if(e=e||{},(t=t||"")instanceof p)return t;if(!(this instanceof p))return new p(t,e);var n=i(t);this._originalInput=t,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=B(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=B(this._r)),this._g<1&&(this._g=B(this._g)),this._b<1&&(this._b=B(this._b)),this._ok=n.ok,this._tc_id=z++}function i(t){var e={r:0,g:0,b:0},n=1,i=null,s=null,r=null,o=!1,a=!1;return"string"==typeof t&&(t=M(t)),"object"==typeof t&&(R(t.r)&&R(t.g)&&R(t.b)?(e=l(t.r,t.g,t.b),o=!0,a="%"===String(t.r).substr(-1)?"prgb":"rgb"):R(t.h)&&R(t.s)&&R(t.v)?(i=D(t.s),s=D(t.v),e=h(t.h,i,s),o=!0,a="hsv"):R(t.h)&&R(t.s)&&R(t.l)&&(i=D(t.s),r=D(t.l),e=u(t.h,i,r),o=!0,a="hsl"),t.hasOwnProperty("a")&&(n=t.a)),n=S(n),{ok:o,format:t.format||a,r:F(255,q(e.r,0)),g:F(255,q(e.g,0)),b:F(255,q(e.b,0)),a:n}}function l(t,e,n){return{r:255*C(t,255),g:255*C(e,255),b:255*C(n,255)}}function s(t,e,n){t=C(t,255),e=C(e,255),n=C(n,255);var i,s,r=q(t,e,n),o=F(t,e,n),a=(r+o)/2;if(r==o)i=s=0;else{var l=r-o;switch(s=.5<a?l/(2-r-o):l/(r+o),r){case t:i=(e-n)/l+(e<n?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4}i/=6}return{h:i,s:s,l:a}}function u(t,e,n){function i(t,e,n){return n<0&&(n+=1),1<n&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}var s,r,o;if(t=C(t,360),e=C(e,100),n=C(n,100),0===e)s=r=o=n;else{var a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;s=i(l,a,t+1/3),r=i(l,a,t),o=i(l,a,t-1/3)}return{r:255*s,g:255*r,b:255*o}}function r(t,e,n){t=C(t,255),e=C(e,255),n=C(n,255);var i,s,r=q(t,e,n),o=F(t,e,n),a=r,l=r-o;if(s=0===r?0:l/r,r==o)i=0;else{switch(r){case t:i=(e-n)/l+(e<n?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4}i/=6}return{h:i,s:s,v:a}}function h(t,e,n){t=6*C(t,360),e=C(e,100),n=C(n,100);var i=c.floor(t),s=t-i,r=n*(1-e),o=n*(1-s*e),a=n*(1-(1-s)*e),l=i%6;return{r:255*[n,o,r,r,a,n][l],g:255*[a,n,n,o,r,r][l],b:255*[r,r,a,n,n,o][l]}}function e(t,e,n,i){var s=[E(B(t).toString(16)),E(B(e).toString(16)),E(B(n).toString(16))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function n(t,e,n,i,s){var r=[E(B(t).toString(16)),E(B(e).toString(16)),E(B(n).toString(16)),E(O(i))];return s&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)&&r[3].charAt(0)==r[3].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)+r[3].charAt(0):r.join("")}function o(t,e,n,i){return[E(O(i)),E(B(t).toString(16)),E(B(e).toString(16)),E(B(n).toString(16))].join("")}function t(t,e){e=0===e?0:e||10;var n=p(t).toHsl();return n.s-=e/100,n.s=x(n.s),p(n)}function a(t,e){e=0===e?0:e||10;var n=p(t).toHsl();return n.s+=e/100,n.s=x(n.s),p(n)}function d(t){return p(t).desaturate(100)}function f(t,e){e=0===e?0:e||10;var n=p(t).toHsl();return n.l+=e/100,n.l=x(n.l),p(n)}function m(t,e){e=0===e?0:e||10;var n=p(t).toRgb();return n.r=q(0,F(255,n.r-B(-e/100*255))),n.g=q(0,F(255,n.g-B(-e/100*255))),n.b=q(0,F(255,n.b-B(-e/100*255))),p(n)}function g(t,e){e=0===e?0:e||10;var n=p(t).toHsl();return n.l-=e/100,n.l=x(n.l),p(n)}function v(t,e){var n=p(t).toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,p(n)}function y(t){var e=p(t).toHsl();return e.h=(e.h+180)%360,p(e)}function b(t){var e=p(t).toHsl(),n=e.h;return[p(t),p({h:(n+120)%360,s:e.s,l:e.l}),p({h:(n+240)%360,s:e.s,l:e.l})]}function _(t){var e=p(t).toHsl(),n=e.h;return[p(t),p({h:(n+90)%360,s:e.s,l:e.l}),p({h:(n+180)%360,s:e.s,l:e.l}),p({h:(n+270)%360,s:e.s,l:e.l})]}function w(t){var e=p(t).toHsl(),n=e.h;return[p(t),p({h:(n+72)%360,s:e.s,l:e.l}),p({h:(n+216)%360,s:e.s,l:e.l})]}function k(t,e,n){e=e||6,n=n||30;var i=p(t).toHsl(),s=360/n,r=[p(t)];for(i.h=(i.h-(s*e>>1)+720)%360;--e;)i.h=(i.h+s)%360,r.push(p(i));return r}function T(t,e){e=e||6;for(var n=p(t).toHsv(),i=n.h,s=n.s,r=n.v,o=[],a=1/e;e--;)o.push(p({h:i,s:s,v:r})),r=(r+a)%1;return o}function A(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}function S(t){return t=parseFloat(t),(isNaN(t)||t<0||1<t)&&(t=1),t}function C(t,e){P(t)&&(t="100%");var n=I(t);return t=F(e,q(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),c.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function x(t){return F(1,q(0,t))}function j(t){return parseInt(t,16)}function P(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)}function I(t){return"string"==typeof t&&-1!=t.indexOf("%")}function E(t){return 1==t.length?"0"+t:""+t}function D(t){return t<=1&&(t=100*t+"%"),t}function O(t){return c.round(255*parseFloat(t)).toString(16)}function N(t){return j(t)/255}function R(t){return!!Y.CSS_UNIT.exec(t)}function M(t){t=t.replace(L,"").replace(U,"").toLowerCase();var e,n=!1;if(K[t])t=K[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};return(e=Y.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=Y.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=Y.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=Y.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=Y.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=Y.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=Y.hex8.exec(t))?{r:j(e[1]),g:j(e[2]),b:j(e[3]),a:N(e[4]),format:n?"name":"hex8"}:(e=Y.hex6.exec(t))?{r:j(e[1]),g:j(e[2]),b:j(e[3]),format:n?"name":"hex"}:(e=Y.hex4.exec(t))?{r:j(e[1]+""+e[1]),g:j(e[2]+""+e[2]),b:j(e[3]+""+e[3]),a:N(e[4]+""+e[4]),format:n?"name":"hex8"}:!!(e=Y.hex3.exec(t))&&{r:j(e[1]+""+e[1]),g:j(e[2]+""+e[2]),b:j(e[3]+""+e[3]),format:n?"name":"hex"}}function $(t){var e,n;return"AA"!==(e=((t=t||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==e&&(e="AA"),"small"!==(n=(t.size||"small").toLowerCase())&&"large"!==n&&(n="small"),{level:e,size:n}}var L=/^\s+/,U=/\s+$/,z=0,B=c.round,F=c.min,q=c.max,J=c.random;p.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,n,i=this.toRgb();return t=i.r/255,e=i.g/255,n=i.b/255,.2126*(t<=.03928?t/12.92:c.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:c.pow((e+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:c.pow((n+.055)/1.055,2.4))},setAlpha:function(t){return this._a=S(t),this._roundA=B(100*this._a)/100,this},toHsv:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=r(this._r,this._g,this._b),e=B(360*t.h),n=B(100*t.s),i=B(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+i+"%)":"hsva("+e+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var t=s(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=s(this._r,this._g,this._b),e=B(360*t.h),n=B(100*t.s),i=B(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+i+"%)":"hsla("+e+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(t){return e(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return n(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:B(this._r),g:B(this._g),b:B(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+B(this._r)+", "+B(this._g)+", "+B(this._b)+")":"rgba("+B(this._r)+", "+B(this._g)+", "+B(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:B(100*C(this._r,255))+"%",g:B(100*C(this._g,255))+"%",b:B(100*C(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+B(100*C(this._r,255))+"%, "+B(100*C(this._g,255))+"%, "+B(100*C(this._b,255))+"%)":"rgba("+B(100*C(this._r,255))+"%, "+B(100*C(this._g,255))+"%, "+B(100*C(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(V[e(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+o(this._r,this._g,this._b,this._a),n=e,i=this._gradientType?"GradientType = 1, ":"";if(t){var s=p(t);n="#"+o(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+e+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,i=this._a<1&&0<=this._a;return e||!i||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return p(this.toString())},_applyModification:function(t,e){var n=t.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(f,arguments)},brighten:function(){return this._applyModification(m,arguments)},darken:function(){return this._applyModification(g,arguments)},desaturate:function(){return this._applyModification(t,arguments)},saturate:function(){return this._applyModification(a,arguments)},greyscale:function(){return this._applyModification(d,arguments)},spin:function(){return this._applyModification(v,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(k,arguments)},complement:function(){return this._applyCombination(y,arguments)},monochromatic:function(){return this._applyCombination(T,arguments)},splitcomplement:function(){return this._applyCombination(w,arguments)},triad:function(){return this._applyCombination(b,arguments)},tetrad:function(){return this._applyCombination(_,arguments)}},p.fromRatio=function(t,e){if("object"==typeof t){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]="a"===i?t[i]:D(t[i]));t=n}return p(t,e)},p.equals=function(t,e){return!(!t||!e)&&p(t).toRgbString()==p(e).toRgbString()},p.random=function(){return p.fromRatio({r:J(),g:J(),b:J()})},p.mix=function(t,e,n){n=0===n?0:n||50;var i=p(t).toRgb(),s=p(e).toRgb(),r=n/100;return p({r:(s.r-i.r)*r+i.r,g:(s.g-i.g)*r+i.g,b:(s.b-i.b)*r+i.b,a:(s.a-i.a)*r+i.a})},p.readability=function(t,e){var n=p(t),i=p(e);return(c.max(n.getLuminance(),i.getLuminance())+.05)/(c.min(n.getLuminance(),i.getLuminance())+.05)},p.isReadable=function(t,e,n){var i,s,r=p.readability(t,e);switch(s=!1,(i=$(n)).level+i.size){case"AAsmall":case"AAAlarge":s=4.5<=r;break;case"AAlarge":s=3<=r;break;case"AAAsmall":s=7<=r}return s},p.mostReadable=function(t,e,n){var i,s,r,o,a=null,l=0;s=(n=n||{}).includeFallbackColors,r=n.level,o=n.size;for(var c=0;c<e.length;c++)l<(i=p.readability(t,e[c]))&&(l=i,a=p(e[c]));return p.isReadable(t,a,{level:r,size:o})||!s?a:(n.includeFallbackColors=!1,p.mostReadable(t,["#fff","#000"],n))};var H,W,G,K=p.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},V=p.hexNames=A(K),Y=(W="[\\s|\\(]+("+(H="(?:"+"[-\\+]?\\d*\\.\\d+%?"+")|(?:"+"[-\\+]?\\d+%?"+")")+")[,|\\s]+("+H+")[,|\\s]+("+H+")\\s*\\)?",G="[\\s|\\(]+("+H+")[,|\\s]+("+H+")[,|\\s]+("+H+")[,|\\s]+("+H+")\\s*\\)?",{CSS_UNIT:new RegExp(H),rgb:new RegExp("rgb"+W),rgba:new RegExp("rgba"+G),hsl:new RegExp("hsl"+W),hsla:new RegExp("hsla"+G),hsv:new RegExp("hsv"+W),hsva:new RegExp("hsva"+G),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});window.tinycolor=p}(Math),function(s,u){"use strict";var t="0.7.8",r="",o="?",h="function",d="undefined",f="object",e="string",n="major",i="model",a="name",l="type",c="vendor",p="version",m="architecture",g="console",v="mobile",y="tablet",b="smarttv",_="wearable",w="embedded",k={extend:function(t,e){for(var n in e)-1!=="browser cpu device engine os".indexOf(n)&&e[n].length%2==0&&(t[n]=e[n].concat(t[n]));return t},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return typeof t===e?t.split(".")[0]:u}},T={rgx:function(){for(var t,e,n,i,s,r,o,a=0,l=arguments;a<l.length&&!r;){var c=l[a],p=l[a+1];if(typeof t===d)for(i in t={},p)typeof(s=p[i])===f?t[s[0]]=u:t[s]=u;for(e=n=0;e<c.length&&!r;)if(r=c[e++].exec(this.getUA()))for(i=0;i<p.length;i++)o=r[++n],typeof(s=p[i])===f&&0<s.length?2==s.length?typeof s[1]==h?t[s[0]]=s[1].call(this,o):t[s[0]]=s[1]:3==s.length?typeof s[1]!==h||s[1].exec&&s[1].test?t[s[0]]=o?o.replace(s[1],s[2]):u:t[s[0]]=o?s[1].call(this,o,s[2]):u:4==s.length&&(t[s[0]]=o?s[3].call(this,o.replace(s[1],s[2])):u):t[s]=o||u;a+=2}return t},str:function(t,e){for(var n in e)if(typeof e[n]===f&&0<e[n].length){for(var i=0;i<e[n].length;i++)if(k.has(e[n][i],t))return n===o?u:n}else if(k.has(e[n],t))return n===o?u:n;return t}},A={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},S={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[a,p],[/\s(opr)\/([\w\.]+)/i],[[a,"Opera"],p],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[a,p],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[a,"IE"],p],[/(edge)\/((\d+)?[\w\.]+)/i],[a,p],[/(yabrowser)\/([\w\.]+)/i],[[a,"Yandex"],p],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],p],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[a,p],[/(dolfin)\/([\w\.]+)/i],[[a,"Dolphin"],p],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[a,"Chrome"],p],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[p,[a,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[p,[a,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[p,[a,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[p,[a,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[p,a],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[a,[p,T.str,A.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[a,p],[/(navigator|netscape)\/([\w\.-]+)/i],[[a,"Netscape"],p],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[a,p]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,k.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[m,/ower/,"",k.lowerize]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[m,k.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[i,c,[l,y]],[/applecoremedia\/[\w\.]+ \((ipad)/],[i,[c,"Apple"],[l,y]],[/(apple\s{0,1}tv)/i],[[i,"Apple TV"],[c,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[c,i,[l,y]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[i,[c,"Amazon"],[l,y]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[i,T.str,A.device.amazon.model],[c,"Amazon"],[l,v]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[i,c,[l,v]],[/\((ip[honed|\s\w*]+);/i],[i,[c,"Apple"],[l,v]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[c,i,[l,v]],[/\(bb10;\s(\w+)/i],[i,[c,"BlackBerry"],[l,v]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7)/i],[i,[c,"Asus"],[l,y]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[c,"Sony"],[i,"Xperia Tablet"],[l,y]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[c,"Sony"],[i,"Xperia Phone"],[l,v]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[c,i,[l,g]],[/android.+;\s(shield)\sbuild/i],[i,[c,"Nvidia"],[l,g]],[/(playstation\s[3portablevi]+)/i],[i,[c,"Sony"],[l,g]],[/(sprint\s(\w+))/i],[[c,T.str,A.device.sprint.vendor],[i,T.str,A.device.sprint.model],[l,v]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[c,i,[l,y]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[c,[i,/_/g," "],[l,v]],[/(nexus\s9)/i],[i,[c,"HTC"],[l,y]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[i,[c,"Microsoft"],[l,g]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[c,"Microsoft"],[l,v]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i],[i,[c,"Motorola"],[l,v]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[c,"Motorola"],[l,y]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[c,"Samsung"],i,[l,y]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-n900))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[c,"Samsung"],i,[l,v]],[/(samsung);smarttv/i],[c,i,[l,b]],[/\(dtv[\);].+(aquos)/i],[i,[c,"Sharp"],[l,b]],[/sie-(\w+)*/i],[i,[c,"Siemens"],[l,v]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[c,"Nokia"],i,[l,v]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[i,[c,"Acer"],[l,y]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[c,"LG"],i,[l,y]],[/(lg) netcast\.tv/i],[c,i,[l,b]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[i,[c,"LG"],[l,v]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[i,[c,"Lenovo"],[l,y]],[/linux;.+((jolla));/i],[c,i,[l,v]],[/((pebble))app\/[\d\.]+\s/i],[c,i,[l,_]],[/android.+;\s(glass)\s\d/i],[i,[c,"Google"],[l,_]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus)?[\s_]*(?:\d\w)?)\s+build/i],[[i,/_/g," "],[c,"Xiaomi"],[l,v]],[/(mobile|tablet);.+rv\:.+gecko\//i],[[l,k.lowerize],c,i]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[p,[a,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[a,p],[/rv\:([\w\.]+).*(gecko)/i],[p,a]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[a,p],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[a,[p,T.str,A.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[a,"Windows"],[p,T.str,A.os.windows.version]],[/\((bb)(10);/i],[[a,"BlackBerry"],p],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[a,p],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[a,"Symbian"],p],[/\((series40);/i],[a],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[a,"Firefox OS"],p],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[a,p],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[a,"Chromium OS"],p],[/(sunos)\s?([\w\.]+\d)*/i],[[a,"Solaris"],p],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[a,p],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[a,"iOS"],[p,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[a,"Mac OS"],[p,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[a,p]]},C=function(t,e){if(!(this instanceof C))return new C(t,e).getResult();var n=t||(s&&s.navigator&&s.navigator.userAgent?s.navigator.userAgent:r),i=e?k.extend(S,e):S;return this.getBrowser=function(){var t=T.rgx.apply(this,i.browser);return t.major=k.major(t.version),t},this.getCPU=function(){return T.rgx.apply(this,i.cpu)},this.getDevice=function(){return T.rgx.apply(this,i.device)},this.getEngine=function(){return T.rgx.apply(this,i.engine)},this.getOS=function(){return T.rgx.apply(this,i.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(t){return n=t,this},this.setUA(n),this};C.VERSION=t,C.BROWSER={NAME:a,MAJOR:n,VERSION:p},C.CPU={ARCHITECTURE:m},C.DEVICE={MODEL:i,VENDOR:c,TYPE:l,CONSOLE:g,MOBILE:v,SMARTTV:b,TABLET:y,WEARABLE:_,EMBEDDED:w},C.ENGINE={NAME:a,VERSION:p},C.OS={NAME:a,VERSION:p},typeof exports!==d?(typeof module!==d&&module.exports&&(exports=module.exports=C),exports.UAParser=C):typeof define===h&&define.amd?define(function(){return C}):s.UAParser=C;var x=s.jQuery||s.Zepto;if(typeof x!==d){var j=new C;x.ua=j.getResult(),x.ua.get=function(){return j.getUA()},x.ua.set=function(t){j.setUA(t);var e=j.getResult();for(var n in e)x.ua[n]=e[n]}}}("object"==typeof window?window:this),window.word_filter=function(t){var e=t.html();e=(e=(e=(e=(e=e.replace(/<!--[\s\S]+?-->/gi,"")).replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,"")).replace(/<(\/?)s>/gi,"<$1strike>")).replace(/&nbsp;/gi," ")).replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(t,e){return 0<e.length?e.replace(/./," ").slice(Math.floor(e.length/2)).split("").join("\xa0"):""}),t.html(e),$("p",t).each(function(){var t=$(this).attr("style"),e=/mso-list:\w+ \w+([0-9]+)/.exec(t);e&&$(this).data("_listLevel",parseInt(e[1],10))});var o=0,a=null;return $("p",t).each(function(){var t=$(this).data("_listLevel");if(t!=undefined){var e=$(this).text(),n="<ul></ul>";if(/^\s*\w+\./.test(e)){var i=/([0-9])\./.exec(e);if(i){var s=parseInt(i[1],10);n=1<s?'<ol start="'+s+'"></ol>':"<ol></ol>"}else n="<ol></ol>"}if(o<t&&(0==o?($(this).before(n),a=$(this).prev()):a=$(n).appendTo(a)),t<o)for(var r=0;r<o-t;r++)a=a.parent();$("span:first",this).remove(),a.append("<li>"+$(this).html()+"</li>"),$(this).remove(),o=t}else o=0}),$("span",t).replaceWith(function(){return $(this).contents()}),$("span:empty",t).remove(),$("[class^='Mso']",t).removeAttr("class"),$("p:empty",t).remove(),t},function(){var t,e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;(t=function(t){function v(){return v.__super__.constructor.apply(this,arguments)}return e(v,t),v.viewPrint=function(t,e,n,i){var s,r,o,a,l,c;return n||(n={},t.constructor.attributesGet&&(n=t.constructor.attributesGet())),s=n[e],l=t[e],c=void 0,s||(s=n[r=e+"_id"])&&t[e=r]&&(c=l,l=t[e]),l||(a=e.split("::"))[0]&&a[1]&&t[a[0]]&&(l=t[a[0]][a[1]]),s?(c||"_id"===e.substr(e.length-3,e.length)&&t[o=e.substr(0,e.length-3)]&&(c=t[o]),this.viewPrintItem(l,s,c,i,t)):this.viewPrintItem(l)},v.viewPrintItem=function(t,e,n,i,s){var r,o,a,l,c,p,u,h,d,f,m,g;if(null==e&&(e={}),void 0===t)return"-";if(""===t)return"-";if(null===t)return t;for(f="",u=[t],_.isArray(t)&&(u=t),l=0,h=u.length;l<h;l++)m=t=u[l],(e.relation||n)&&(
t=n||v[e.relation].find(t)),p=!1,t&&"object"==typeof t&&(p=!0,m=t.displayNameLong?t.displayNameLong():t.displayName?t.displayName():t.name),e.callback&&(m=e.callback(m,e)),c=!1,"textarea"===e.tag?(c=!0,m=v.Utils.text2html(m)):"richtext"===e.tag&&(c=!0),_.isEmpty(e.options)||e.options[m]&&(m=e.options[m]),"boolean"===e.tag&&(!0===m?m="yes":!1===m&&(m="no")),(e.translate||p&&t.translate&&t.translate())&&(c=!0,m=v.i18n.translateContent(m)),"date"===e.tag&&(c=!0,m=v.i18n.translateDate(m)),(d=this._placeholderReplacement(s,e,m))&&!1===c&&(m=d,c=!0),"input"!==e.tag||d?"datetime"===e.tag&&(c=!0,g=v.i18n.translateTimestamp(m),o=!1,(r=e["class"]||"").match("escalation")&&(o=!0),a="",i||(a=v.PrettyDate.humanTime(m,o)),m='<time class="humanTimeFromNow '+r+'" datetime="'+m+'" title="'+g+'">'+a+"</time>"):(m="tel"===e.type?'<a href="'+v.Utils.phoneify(m)+'">'+v.Utils.htmlEscape(m)+"</a>":"url"!==e.type||d?v.Utils.htmlEscape(m):v.Utils.linkify(m),c=!0),c||"string"!=typeof m||(m=v.Utils.htmlEscape(m)),_.isEmpty(f)||(f+=", "),f+=m;return f},v._placeholderReplacement=function(t,e,n){var i;if(t&&e&&!_.isEmpty(e.linktemplate)&&t.constructor&&t.constructor.className&&!_.isEmpty(t[e.name]))return(i={attribute:e,session:v.Session.get(),config:v.Config.all()})[t.constructor.className.toLowerCase()]=t,'<a href="'+v.Utils.replaceTags(e.linktemplate,i,!0)+'" target="blank">'+v.Utils.htmlEscape(n)+"</a>"},v.view=function(e){return function(t){return null==t&&(t={}),JST["app/views/"+e](_.extend(t,v.ViewHelpers))}},v}(Spine.Controller)).UiElement=function(){function t(){}return t}(),window.App=t}.call(this),function(){var s;App.Config=function(){function t(){}var i;return i=void 0,t.init=function(){return null!=i?i:i=new s},t.get=function(t,e){return void 0===i&&null==i&&(i=new s),i.get(t,e)},t.set=function(t,e,n){return void 0===i&&null==i&&(i=new s),i.set(t,e,n)},t.all=function(){return void 0===i&&null==i&&(i=new s),i.all()},t}(),s=function(){function t(){this.config={}}return t.prototype.get=function(t,e){if(e){if(!e in this.config)return;if(void 0===this.config[e])return;return this.config[e][t]}return this.config[t]},t.prototype.set=function(t,e,n){return n?(this.config[n]||(this.config[n]={}),this.config[n][t]=e):this.config[t]=e},t.prototype.all=function(){return this.config},t}()}.call(this),function(){var s;App.LocalStorage=function(){function t(){}var i;return i=void 0,t.set=function(t,e,n){return void 0===i&&null==i&&(i=new s),i.set(t,e,n)},t.get=function(t,e){return void 0===i&&null==i&&(i=new s),i.get(t,e)},t["delete"]=function(t,e){return void 0===i&&null==i&&(i=new s),i["delete"](t,e)},t.clear=function(){return void 0===i&&null==i&&(i=new s),i.clear()},t.keys=function(t,e){return void 0===i&&null==i&&(i=new s),i.keys(t,e)},t.usage=function(){return void 0===i&&null==i&&(i=new s),i.usage()},t}(),s=function(){function t(){}return t.prototype.set=function(t,e,n){var i;try{return n&&(t="personal::"+n+"::"+t),localStorage.setItem(t,JSON.stringify(e))}catch(s){return i=s,App.Log.error("App.LocalStorage","Local storage error!",i)}},t.prototype.get=function(t,e){var n;if(e&&(t="personal::"+e+"::"+t),n=localStorage.getItem(t))return JSON.parse(n)},t.prototype["delete"]=function(t,e){return e&&(t="personal::"+e+"::"+t),localStorage.removeItem(t)},t.prototype.clear=function(){return localStorage.clear()},t.prototype.keys=function(t,e){var n,i,s;return n=Object.keys(window.localStorage),null===e&&null===t?n:(s="",e&&(s="personal::"+e+"::"),t&&(s+=t),i=new RegExp("^"+s),n.filter(function(t){return t.match(i)}))},t.prototype.usage=function(){var t,e,n;for(t in e="",window.localStorage)n=localStorage.getItem(t),_.isString(n)&&(e+=n);return byteLength(e)},t}()}.call(this),function(){var s,r,o=[].slice,n=function(t,e){return function(){return t.apply(e,arguments)}};r=void 0,App.LogInclude=function(){function t(){}return t.log=function(t){var e,n,i;return n=t,e=2<=arguments.length?o.call(arguments,1):[],void 0===r&&null==r&&(r=new s),i=this.constructor.name,r.log(i,n,e)},t}(),App.Log=function(){function t(){}return t.debug=function(t){var e,n;return n=t,e=2<=arguments.length?o.call(arguments,1):[],void 0===r&&null==r&&(r=new s),r.log(n,"debug",e)},t.notice=function(t){var e,n;return n=t,e=2<=arguments.length?o.call(arguments,1):[],void 0===r&&null==r&&(r=new s),r.log(n,"notice",e)},t.error=function(t){var e,n;return n=t,e=2<=arguments.length?o.call(arguments,1):[],void 0===r&&null==r&&(r=new s),r.log(n,"error",e)},t.config=function(t,e){return void 0===r&&null==r&&(r=new s),r.config(t,e)},t.timeTrack=function(t){return void 0===r&&null==r&&(r=new s),r.timeTrack(t)},t}(),s=function(){function t(){var t,e;this.timeTrack=n(this.timeTrack,this),this.yieldColor=n(this.yieldColor,this),this.moduleColorsMap={},this.currentConfig={},this.currentConfigReady={},window.localStorage&&(e=window.localStorage.getItem("log_config"))&&(this.currentConfig=JSON.parse(e),this.configReady()),this.colorSupport=!1,(t=App.Browser.detection()).browser&&("Chrome"===t.browser.name?this.colorSupport=!0:"Firefox"===t.browser.anem?31<=t.browser.major&&(this.colorSupport=!0):"Safari"===t.browser.name&&(this.colorSupport=!0))}return t.prototype.configReady=function(){var t,e,n,i;for(n in e=[],t=this.currentConfig)i=t[n],"module"===n||"content"===n?e.push(this.currentConfigReady[n]=new RegExp(i,"i")):e.push(this.currentConfigReady[n]=i);return e},t.prototype.config=function(t,e){return null==t&&(t=void 0),null==e&&(e=void 0),void 0===e?t?this.currentConfig[t]:this.currentConfig:(this.currentConfig[t]=e,this.configReady(),window.localStorage?window.localStorage.setItem("log_config",JSON.stringify(this.currentConfig)):void 0)},t.prototype.log=function(t,e,n){if("debug"===e){if(!this.currentConfigReady.module&&!this.currentConfigReady.content)return;if(this.currentConfigReady.module&&!t.match(this.currentConfigReady.module))return;if(this.currentConfigReady.content&&!n.toString().match(this.currentConfigReady.content))return}return this._log(t,e,n)},t.prototype._log=function(t,e,n){var i,s,r;return r=32,(s="App."+t+"("+e+")").length<r&&(s+=Array(r-s.length).join(" ")),s+="|",this.colorSupport?(s="%c"+s,this.moduleColorsMap[t]||(this.moduleColorsMap[t]=this.yieldColor()),i=[s,"color: hsl("+this.moduleColorsMap[t]+",99%,40%); font-weight: bold"].concat(n)):i=[s].concat(n),"error"===e?console.error.apply(console,i):"debug"===e?console.debug.apply(console,i):console.log.apply(console,i)},t.prototype.yieldColor=function(){var t;return this.hue||(this.hue=0),this.hue+=1,t=.618033988749895,this.hue+=t,this.hue=this.hue%1,360*this.hue},t.prototype.timeTrack=function(t){var e,n;return e=(new Date).getTime(),this.lastTime?(n=e-this.lastTime,this.lastTime=e,console.log("timeTrack start",t,n)):(this.lastTime=e,console.log("timeTrack start",t))},t}()}.call(this),function(){var i;App.QueueManager=function(){function t(){}var n;return n=void 0,t.init=function(){return null!=n?n:n=new i},t.add=function(t,e){return void 0===n&&null==n&&(n=new i),n.add(t,e)},t.pull=function(t){return void 0===n&&null==n&&(n=new i),n.pull(t)},t.all=function(t){return void 0===n&&null==n&&(n=new i),n.all(t)},t.run=function(t,e){return void 0===n&&null==n&&(n=new i),n.run(t,e)},t}(),i=function(){function t(){this.queues={},this.queueRunning={}}return t.prototype.add=function(t,e){return this.queues[t]||(this.queues[t]=[]),this.queues[t].push(e),!0},t.prototype.pull=function(t){if(this.queues[t])return this.queues[t].shift()},t.prototype.all=function(t){return this.queues[t]},t.prototype.run=function(t){var e;if(this.queues[t]&&!this.queueRunning[t]&&(e=this.queues[t],!_.isEmpty(e))){for(this.queueRunning[t]=!0;;)if(e.shift()(),!e[0]){this.queueRunning[t]=!1;break}return!0}},t}()}.call(this),function(){var n,i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Session=function(){function t(){}var e;return e=void 0,t.init=function(){return null==e&&(e=new n),e.clear()},t.get=function(t){return void 0===e&&null==e&&(e=new n),e.get(t)},t.set=function(t){return void 0===e&&null==e&&(e=new n),e.set(t)},t}(),n=function(t){function e(){this.clear()}return i(e,t),e.include(App.LogInclude),e.prototype.clear=function(){return this.user=void 0},e.prototype.get=function(t){var e;return t?null!=(e=this.user)?e[t]:void 0:this.user},e.prototype.set=function(t){return this.user=App.User.findNative(t)},e}(Spine.Module)}.call(this),function(){var i;App.SessionStorage=function(){function t(){}var n;return n=void 0,t.set=function(t,e){return void 0===n&&null==n&&(n=new i),n.set(t,e)},t.get=function(t){return void 0===n&&null==n&&(n=new i),n.get(t)},t["delete"]=function(t){return void 0===n&&null==n&&(n=new i),n["delete"](t)},t.clear=function(){return void 0===n&&null==n&&(n=new i),n.clear()},t.list=function(){return void 0===n&&null==n&&(n=new i),n.list()},t.usage=function(){return void 0===n&&null==n&&(n=new i),n.usage()},t}(),i=function(){function t(){var t;App.Event.bind("clearStore",(t=this,function(){return t.clear()}))}return t.prototype.set=function(t,e){var n;try{return sessionStorage.setItem(t,JSON.stringify(e))}catch(i){return n=i,this.clear(),App.Log.error("App.SessionStorage","Session storage error!",n),sessionStorage.setItem(t,JSON.stringify(e))}},t.prototype.get=function(t){var e;if(e=sessionStorage.getItem(t))return JSON.parse(e)},t.prototype["delete"]=function(t){return sessionStorage.removeItem(t)},t.prototype.clear=function(){return sessionStorage.clear()},t.prototype.list=function(){return window.sessionStorage},t.prototype.usage=function(){var t,e,n;for(t in e="",window.sessionStorage)n=sessionStorage.getItem(t),_.isString(n)&&(e+=n);return byteLength(e)},t}()}.call(this),function(){var s,i=function(t,e){return function(){return t.apply(e,arguments)}};App.Track=function(){function t(){}var i;return i=void 0,t.init=function(){return null!=i?i:i=new s},t.log=function(t,e,n){return void 0===i&&null==i&&(i=new s),i.log(t,e,n)},t.send=function(){return void 0===i&&null==i&&(i=new s),i.send()},t.force=function(t){return void 0===i&&null==i&&(i=new s),i.force(t)},t._all=function(){return void 0===i&&null==i&&(i=new s),i._all()},t}(),s=function(){function t(){var t,e,o,r,n;this.send=i(this.send,this),this.log=i(this.log,this),this.trackId="track-"+(new Date).getTime()+"-"+Math.floor(99999*Math.random()),App.Browser&&(this.browser=App.Browser.detection()),this.data=[],this.url="https://log.zammad.com/api/v1/ui",this.logClick=!0,this.logAjax=!1,this.forceSending=!1,this.log("start","notice",{}),e=this,t=function(){return App.Interval.set(e.send,6e4)},App.Delay.set(t,3e4),this.logClick&&$(document).bind("click",(o=this,function(t){var e,n,i,s,r;return r=window.screen.width,n=window.screen.height,(e=$(t.target)).attr("href")||(s=$(t.target).parents("a"))[0]&&(e=s),i={level:"notice",href:e.attr("href"),title:e.attr("title"),text:e.text(),clickX:t.pageX,clickY:t.pageY,screenX:r,screenY:n},o.log("click","notice",i)})),this.logAjax&&$(document).bind("ajaxComplete",(r=this,function(t,e,n){var i,s;if(n.url&&"/ui"!==n.url.substr(n.url.length-3,3))return i="notice",s="",400<=e.status&&(i="error",s=e.responseText),n.data&&(3e3<n.data.length&&(n.data=n.data.substr(0,3e3)),"string"==typeof n.data&&(n.data=n.data.replace(/"password":".+?"/gi,'"password":"xxx"'))),r.log("ajax.send",i,{type:n.type,dataType:n.dataType,async:n.async,url:n.url,data:n.data,status:e.status,responseText:s})})),$(window).bind("beforeunload",(n=this,function(){n.log("good bye","notice",{}),n.send(!1)}))}return t.prototype.log=function(t,e,n){var i;if(this.shouldSend())return i={time:Math.round((new Date).getTime()/1e3),facility:t,level:e,location:window.location.pathname+window.location.hash,message:n},this.data.push(i)},t.prototype.send=function(t){var e,n,i,s,r,o;if(null==t&&(t=!0),this.shouldSend()&&!_.isEmpty(this.data)){for(r=_.clone(this.data),this.data=[],o=[],n=0,s=r.length;n<s;n++){i=r[n];try{JSON.stringify(i),o.push(i)}catch(l){e=l,console.log("error",e)}}return App.Ajax.request({type:"POST",url:this.url,async:t,data:JSON.stringify({meta:{track_id:this.trackId,host:window.location.host,protocol:window.location.protocol},browser:this.browser,log:o}),crossDomain:!0,headers:{"X-Requested-With":"XMLHttpRequest"},error:(a=this,function(){var t,e,n;for(n=[],t=0,e=o.length;t<e;t++)i=o[t],n.push(a.data.push(i));return n})});var a}},t.prototype.force=function(t){return null==t&&(t=!0),this.forceSending=t},t.prototype.shouldSend=function(){return!!this.forceSending||!App.Config.get("developer_mode")&&!!App.Config.get("ui_send_client_stats")},t.prototype._all=function(){return this.data},t}(),function(){function t(e){var n=i[e];i[e]=function(){if(App.Track.log("console."+e,e,arguments),"error"==e&&App.Track.log("traceback",e,window.getStackTrace().join("\n")),n.apply)n.apply(i,arguments);else{var t=Array.prototype.slice.apply(arguments).join(" ");n(t)}}}window.getStackTrace=function(){var t;try{throw new Error("")}catch(e){t=e.stack||""}return(t=t.split("\n").map(function(t){return t.trim()})).splice("Error"==t[0]?2:1)},window.onerrorOld=window.onerror,window.onerror=function(t,e,n,i,s){var r="";return s!==undefined&&s.stack&&(r="\n"+s.stack),App.Track.log("console.error","error",t+" - in "+e+", line "+n+r),window.onerrorOld&&window.onerrorOld(t,e,n,i,s),!1};var i=window.console;if(i)for(var e=["debug","log","warn","error"],n=0;n<e.length;n++)t(e[n])}.call(this)}.call(this),function(){var t;t={contentSidebarActions:function(){var t,e;return e=[],("function"==typeof(t=this.constructor).canBePublished?t.canBePublished():void 0)&&e.push({iconName:"eye",name:"Visibility",action:"visibility",cssClass:"btn--success",disabled:this.isNew()}),this instanceof App.KnowledgeBase||e.push({iconName:"trash",name:"Delete",action:"delete",cssClass:"btn--danger",disabled:this.isNew()}),e}},App.KnowledgeBaseActions={extended:function(){return this.include(t)}}}.call(this),function(){var t;t={canBePublished:function(){return!0},can_be_published_state:function(){var t;switch(t=(new Date).getTime(),!1){case!(this.date(this.archived_at)<t):return"archived";case!(this.date(this.published_at)<t):return"published";case!(this.date(this.internal_at)<t):return"internal";default:return"draft"}},can_be_published_by:function(t){var e;if(null==t&&(t=this.can_be_published_state()),"draft"!==t)return e=this[t+"_by_id"],App.User.find(e)},can_be_published_at:function(t){return null==t&&(t=this.can_be_published_state()),"draft"===t?this.created_at:this[t+"_at"]},can_be_published_state_css:function(){return"state-"+this.can_be_published_state()},can_be_published_quick_actions:function(){switch(this.can_be_published_state()){case"published":return["archive"];case"internal":return["publish","archive"];case"draft":return["publish","internal"];default:return[]}},next_call_to_action:function(){switch(this.can_be_published_state()){case"archived":return["unarchive"];case"published":return["archive"];case"internal":return["publish","archive"];default:return["publish","internal"]}},can_be_published_publish_in_future:function(){return this.date(this.published_at)>(new Date).getTime()},can_be_published_archive_in_future:function(){return this.date(this.archived_at)>(new Date).getTime()},can_be_published_internal_in_future:function(){return this.date(this.internal_at)>(new Date).getTime()},is_internally_published:function(t){var e;return!!("internal"===(e=this.can_be_published_state())||"published"===e)&&!!this.translation(t.id)},is_published:function(t){return"published"===this.can_be_published_state()&&!!this.translation(t.id)},date:function(t){if(t)return new Date(t).getTime()}},App.KnowledgeBaseCanBePublished={canBePublished:function(){return!0},extended:function(){return this.include(t)}}}.call(this),function(){var t;t={translations:function(){var e,t,n;return t=this.constructor.translatableClass(),e=this.constructor.translatableForeignKey(),t.all().filter((n=this,function(t){return t[e]===n.id}))},translation:function(e){return null==e?null:this.translations().filter(function(t){return t.kb_locale_id===e})[0]},primaryTranslation:function(){var t;return t=this.knowledge_base().primaryKbLocale(),this.translation(t.id)},attributesIncludingTranslation:function(t){var e,n;return(e=this.attributes()).translation=null!=(n=this.translation(t))?n.attributes():void 0,e},attributesForRendering:function(t,e){var n;return null==e&&(e={}),n={id:this.id,url:this.uiUrl(t,e.action),title:this.guaranteedTitle(t.id),missingTranslation:void 0===this.translation(t.id)},this instanceof App.KnowledgeBase&&(n.icon="knowledge-base",n.title=""),this instanceof App.KnowledgeBaseCategory&&(n.iconFont=!0,n.icon=this.category_icon,n.count=this.countDeepAnswers(),e.isEditor?n.editorOnly=!this.visibleInternally(t):n.editorOnly=!1,n.state=this.visibilityState(t)),this instanceof App.KnowledgeBaseAnswer&&(n.icon="knowledge-base-answer",n.state=this.can_be_published_state(),e.isEditor?n.editorOnly=!this.is_internally_published(t):n.editorOnly=!1),n.icons={},n.missingTranslation&&(n.icons.danger=!0),n},writeMethod:function(){return this.id?"PATCH":"POST"},prepareNestedParams:function(t,e){var n,i;return this.baseParams&&(t=_.extendOwn(this.baseParams(),t)),i=t.translation,delete t.translation,(n=this.translation(e))?i.id=n.id:i.kb_locale_id=e,this.constructor.translatableClass().processAttributes&&(i=this.constructor.translatableClass().processAttributes(i)),t.translations_attributes=[i],t},objectActionName:function(){return(this.isNew()?"New":"Edit")+" "+this.objectName()},removeTranslations:function(t){var e,n,i,s,r;for(null==t&&(t={}),s=[],e=0,n=(i=this.translations()).length;e<n;e++)r=i[e],s.push(r.remove(t));return s},removeIncludingTranslations:function(t){return null==t&&(t={}),this.removeTranslations(t),this.remove(t)},guaranteedTranslation:function(t){return this.translation(t)||this.primaryTranslation()||this.translations()[0]},guaranteedTitle:function(t,e){var n;return null==e&&(e="-"),(null!=(n=this.guaranteedTranslation(t))?n.title:void 0)||e},translationBindlableObject:function(t){return this.translation(t)||this.constructor.translatableClass()}},App.KnowledgeBaseTranslatable={extended:function(){return this.include(t)}}}.call(this),function(){var t;t={parent:function(){throw"Please implement parent method, fetching parent object"},uiUrl:function(){var t;return t=App.KnowledgeBaseLocale.localeFor(this),this.parent().uiUrl(t)},fullyLoaded:function(){return!(this instanceof App.KnowledgeBaseAnswerTranslation)||null!==this.content()},defaultSearchResultAttributes:function(){return App.KnowledgeBaseLocale.localeFor(this),{display:this.title,id:this.id,url:this.uiUrl()}},searchResultAttributes:function(){return this.defaultSearchResultAttributes()}},App.KnowledgeBaseTranslationable={extended:function(){return this.include(t)}}}.call(this),function(){var t,e=[].slice;t={initializePopovers:function(){var e;return this.el.on("remove",this.removePopovers),e=_.extend({},this.constructor.popoversDefaults,{parentController:this}),this.initializedPopovers=this.selectedPopovers().map(function(t){return new(App.Config.get(App.PopoverProvider.providersConfigKey)[t])(e)})},selectedPopovers:function(){var t;return this.constructor.allPopovers?(t=App.Config.get(App.PopoverProvider.providersConfigKey),Object.keys(t)):this.constructor.registeredPopovers||[]},buildPopovers:function(t){var e,n,i,s,r;for(r=[],e=0,n=(s=this.initializedPopovers).length;e<n;e++)i=s[e],r.push(i.build(t));return r},renderPopovers:function(t){return null==t&&(t={}),this.initializedPopovers||this.initializePopovers(),this.buildPopovers(t)},removePopovers:function(){var t,e,n;if(this.initializedPopovers){for(t=0,e=(n=this.initializedPopovers).length;t<e;t++)n[t].clear();return this.initializedPopovers=void 0}},delayedRemoveAnyPopover:function(){return this.delay(this.constructor.anyPopoversDestroy,100,"removePopovers")}},App.PopoverProvidable={registerPopovers:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.allPopovers=void 0,this.registeredPopovers=t},registerAllPopovers:function(){return this.allPopovers=!0},anyPopoversDestroy:function(){return $(".popover:not(.popover--notifications)").remove()},extended:function(){return this.include(t)}}}.call(this),function(){App.RenderScreen={renderScreenSuccess:function(t){return this.taskKey&&App.TaskManager.touch(this.taskKey),(t.el||this).html(App.view("generic/error/success")(t))},renderScreenError:function(t){return this.taskKey&&App.TaskManager.touch(this.taskKey),(t.el||this).html(App.view("generic/error/generic")(t))},renderScreenNotFound:function(t){return this.taskKey&&App.TaskManager.touch(this.taskKey),(t.el||this).html(App.view("generic/error/not_found")(t))},renderScreenUnauthorized:function(t){return this.taskKey&&App.TaskManager.touch(this.taskKey),(t.el||this).html(App.view("generic/error/unauthorized")(t))},renderScreenPlaceholder:function(t){if(this.taskKey&&App.TaskManager.touch(this.taskKey),(t.el||this).html(App.view("generic/error/placeholder")(t)),t.action&&t.actionCallback)return(t.el||this.el).find(".js-action").click(t.actionCallback)}}}.call(this),function(){var e;App.SecurityOptions={securityOptionsShow:function(){return this.$(".js-securityOptions").removeClass("hide")},securityOptionsHide:function(){return this.$(".js-securityOptions").addClass("hide")},securityOptionsShown:function(){return!this.$(".js-securityOptions").hasClass("hide")},securityEnabled:function(){return App.Config.get("smime_integration")},paramsSecurity:(e=this,function(){var t;return e.$(".js-securityOptions").hasClass("hide")?{}:((t={}).encryption||(t.encryption={}),t.sign||(t.sign={}),t.type="S/MIME",e.$(".js-securityEncrypt").hasClass("btn--active")&&(t.encryption.success=!0),e.$(".js-securitySign").hasClass("btn--active")&&(t.sign.success=!0),t)}),updateSecurityOptionsRemote:function(t,a,e){var n,l;return n=function(){return l.ajax({id:"smime-check-"+t,type:"POST",url:l.apiPath+"/integration/smime",data:JSON.stringify({ticket:a,article:e}),processData:!0,success:function(t){var e,n,i,s,r,o;for(o in i={encryption:!0,sign:!0},r=App.Config.get("smime_config"),e={default_sign:"sign",default_encryption:"encryption"})s=e[o],(null!=r&&null!=(n=r.group_id)?n[o]:void 0)&&a.group_id&&!1===r.group_id[o][a.group_id.toString()]&&(i[s]=!1);return l.$(".js-securityEncryptComment").attr("title",t.encryption.comment),!0===t.encryption.success?(l.$(".js-securityEncrypt").attr("disabled",!1),i.encryption?l.$(".js-securityEncrypt").addClass("btn--active"):l.$(".js-securityEncrypt").removeClass("btn--active")):(l.$(".js-securityEncrypt").attr("disabled",!0),l.$(".js-securityEncrypt").removeClass("btn--active")),l.$(".js-securitySignComment").attr("title",t.sign.comment),!0===t.sign.success?(l.$(".js-securitySign").attr("disabled",!1),i.sign?l.$(".js-securitySign").addClass("btn--active"):l.$(".js-securitySign").removeClass("btn--active")):(l.$(".js-securitySign").attr("disabled",!0),l.$(".js-securitySign").removeClass("btn--active"))},error:function(t){var e;return e=t.responseJSON||{},console.log(e)}})},(l=this).delay(n,200,"security-check")}}}.call(this),function(){App.TicketNavigable={taskOpenTicket:function(t,e){return t instanceof App.Ticket&&(t=t.id),this.taskLoadTicket(t),this.navigate(null!=e?e:"ticket/zoom/"+t)},taskLoadTicket:function(t){return App.TaskManager.execute({key:"Ticket-"+t,controller:"TicketZoom",params:{ticket_id:t,overview_id:this.overview_id},show:!0})},getNextTicketInOverview:function(){if(this.ticket&&this.overview_id)return App.Overview.find(this.overview_id).nextTicket(this.ticket)},openTicketInOverview:function(t){return t?(this.taskCloseTicket(),void this.taskLoadTicket(t.id)):this.taskCloseTicket(!0)},taskOpenNextTicketInOverview:function(){var t;if(null!=this.overview_id&&null!=this.ticket)return(t=this.getNextTicketInOverview())?(this.taskCloseTicket(),void this.taskLoadTicket(t.id)):this.taskCloseTicket(!0);this.taskCloseTicket(!0)},taskCloseTicket:function(t){var e;if(null==t&&(t=!1),App.TaskManager.remove(this.taskKey),t){if(!(e=App.TaskManager.nextTaskUrl()))return this.navigate("#");this.navigate(e)}}}}.call(this),function(){var s=[].slice;App.ViewHelpers={P:function(t,e,n,i){return null==i&&(i=!1),App.viewPrint(t,e,n,i)},date:function(t){var e,n,i;return t?(i=new Date(t),e=App.Utils.formatTime(i.getDate(),2),n=App.Utils.formatTime(i.getMonth()+1,2),i.getFullYear()+"-"+n+"-"+e):""},datetime:function(t){var e,n,i,s,r,o;return t?(r=new Date(t),i=App.Utils.formatTime(r.getDate(),2),s=App.Utils.formatTime(r.getMonth()+1,2),o=r.getFullYear(),n=App.Utils.formatTime(r.getSeconds(),2),e=App.Utils.formatTime(r.getMinutes(),2),o+"-"+s+"-"+i+" "+App.Utils.formatTime(r.getHours(),2)+":"+e+":"+n):""},decimal:function(t,e){return null==e&&(e=2),App.Utils.decimal(t,e)},time_duration:function(t){var e,n,i;return t?isNaN(parseInt(t))?"":(e=~~parseInt(t/3600),(n=~~parseInt(t%3600/60))<10&&(n="0"+n),(i=parseInt(t%60))<10&&(i="0"+i),0<e?e+":"+n+":"+i:n+":"+i):""},M:function(t,e,n){var i,s,r,o;if(null==e&&(e=1),null==n&&(n=2),!t)return"";for(o="",n=t.length-n-1,s=i=0,r=t.length-1;0<=r?i<=r:r<=i;s=0<=r?++i:--i)o+=e<=s&&s<=n?"*":t[s];return o},T:function(t){var e,n,i;return n=t,e=2<=arguments.length?s.call(arguments,1):[],(i=App.i18n).translateContent.apply(i,[n].concat(s.call(e)))},Ti:function(t){var e,n,i;return n=t,e=2<=arguments.length?s.call(arguments,1):[],(i=App.i18n).translateInline.apply(i,[n].concat(s.call(e)))},Tdate:function(t){var e,n,i;return n=t,e=2<=arguments.length?s.call(arguments,1):[],(i=App.i18n).translateDate.apply(i,[n].concat(s.call(e)))},Ttimestamp:function(t){var e,n,i;return n=t,e=2<=arguments.length?s.call(arguments,1):[],(i=App.i18n).translateTimestamp.apply(i,[n].concat(s.call(e)))},L:function(t){return t&&"string"==typeof t?App.Utils.linkify(t):t},C:function(t){return App.Config.get(t)},S:function(t){return App.Session.get(t)},V:function(t,e){return App.view(t)(e)},AddressLine:function(t){var e,n,i,s,r;if(!t)return"";if(!(i=emailAddresses.parseAddressList(t)))return App.Utils.htmlEscape(t);for(r="",e=0,s=i.length;e<s;e++)r&&(r+=", "),(n=i[e]).name&&(n.name=n.name.replace(",","").replace(";","").replace('"',"").replace("'",""),n.name.match(/\@|,|;|\^|\+|#|\xa7|\$|%|&|\/|\(|\)|=|\?|\*/)&&(n.name='"'+n.name+'"'),r=""+r+App.Utils.htmlEscape(n.name)+" "),n.address&&(r=r+' <span class="text-muted">&lt;'+App.Utils.htmlEscape(n.address)+"&gt</span>");return r},humanFileSize:function(t){return App.Utils.humanFileSize(t)},humanTime:function(t,e,n){return null==e&&(e=!1),null==n&&(n=""),e&&(n+=" escalation"),'<time class="humanTimeFromNow '+n+'" datetime="'+t+'" title="'+App.i18n.translateTimestamp(t)+'">'+App.PrettyDate.humanTime(t,e)+"</time>"},Icon:function(t,e){return null==e&&(e=""),App.Utils.icon(t,e)},fontIcon:function(t,e,n){return null==n&&(n=""),App.Utils.fontIcon(t,e,n)},RichText:function(t){return t?t.match(/@T\('/)?(t=t.replace(/@T\('(.+?)'\)/g,function(t,e){return App.i18n.translateContent(e)}),marked(t)):App.i18n.translateContent(t):t},ContentTypeIcon:function(t){return{"image/jpeg":"file-image","image/jpg":"file-image","image/png":"file-image","image/svg":"file-image","image/gif":"file-image","application/pdf":"file-pdf","application/msword":"file-word","application/vnd.ms-word":"file-word","application/vnd.oasis.opendocument.text":"file-word","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"file-word","application/vnd.openxmlformats-officedocument.wordprocessingml.template":"file-word","application/vnd.ms-excel":"file-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"file-excel","application/vnd.oasis.opendocument.spreadsheet":"file-excel","application/vnd.ms-powerpoint":"file-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation":"file-powerpoint","application/vnd.oasis.opendocument.presentation":"file-powerpoint","text/plain":"file-text","text/html":"file-code","application/json":"file-code","message/rfc822":"file-email","application/json":"file-code","text/plain":"file-text","text/rtf":"file-text","application/gzip":"file-archive","application/zip":"file-archive"}[t=App.Utils.contentTypeCleanup(t)]},canDownload:function(t){return"application/pdf"!==(t=App.Utils.contentTypeCleanup(t))&&"text/html"!==t},canPreview:function(t){return!_.isEmpty(t)&&!!t.match(/image\/(png|jpg|jpeg|gif)/i)},unique_avatar:function(t,e,n){var i,s,r,o,a,l;return null==n&&(n=40),o=300*n/(i=40),s=226*n/i,a=(r=new Math.seedrandom(t))()*(o-n),l=r()*(s-n),App.view("avatar_unique")({x:a,y:l,initials:e})},iconWithModifier:function(t,e){return e.className||(e.className=""),e.addStateClass&&(e.className+=" state-"+t.state),App.view("knowledge_base/_icon_with_modifier")({item:t,className:e.className,iconset:e.iconset})},replacePlaceholder:function(t,e,n){return null==n&&(n=!1),App.Utils.replaceTags(t,e,n)},dir:function(t,e){return"ltr"===App.i18n.dir()?t:e}}}.call(this),function(){App.Config.set("api_path","api/v1"),App.Config.set("image_path","/assets/images")}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Model=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return n(e,t),e.apiPath=App.Config.get("api_path"),e.prototype.uiUrl=function(){return"#"},e.prototype.translate=function(){return App[this.constructor.className].configure_translate},e.prototype.objectDisplayName=function(){return this.constructor.className},e.prototype.displayName=function(){var t;return this.name?this.name:this.realname?this.realname+" <"+this.email+">":(_.isEmpty(this.firstname)||(t=this.firstname),_.isEmpty(this.lastname)||(_.isEmpty(t)?t="":t+=" ",t+=this.lastname),_.isEmpty(t)?this.email?this.email:this.title?this.title:this.subject?this.subject:this.phone?this.phone:this.login?this.login:"???":t)},e.prototype.displayNameLong=function(){var t;return this.name?this.name:(_.isEmpty(this.firstname)||(t=this.firstname),_.isEmpty(this.lastname)||(_.isEmpty(t)?t="":t+=" ",t+=this.lastname),_.isEmpty(t)||(_.isEmpty(this.organization)?_.isEmpty(this.department)||(t=t+" ("+this.department+")"):t="object"==typeof this.organization?t+" ("+this.organization.name+")":t+" ("+this.organization+")"),_.isEmpty(t)?this.email?this.email:this.title?this.title:this.subject?this.subject:this.phone?this.phone:this.login?this.login:"???":t)},e.prototype.icon=function(){return""},e.prototype.iconTitle=function(){return""},e.prototype.iconActivity=function(){return""},e.validate=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g;for(n in null==t&&(t={}),App[t.model]&&App[t.model].attributesGet?i=App[t.model].attributesGet(t.screen):t.model.configure_attributes&&(i=App.Model.attributesGet(t.screen,t.model.configure_attributes)),i)if((e=i[n]).required_if)for(a in f=e.required_if){for(g=f[a],u=t.params[a],_.isArray(u)||(u=[u]),h=!1,r=0,l=g.length;r<l;r++)if(m=g[r],u)for(o=0,c=u.length;o<c;o++)p=u[o],m&&p&&m.toString()===p.toString()&&(h=!0);e["null"]=!0!==h}for(n in s={},i)if(!(e=i[n]).readonly){if("null"in e&&!e["null"])if((d=e.name.split("::"))[0]&&!d[1])n in t.params&&""!==t.params[n]&&void 0!==t.params[n]&&null!==t.params[n]||(s[n]="is required");else{if(!d[0]||!d[1]||d[2])throw"can't parse '"+e.name+"'";t.params[d[0]]&&d[1]in t.params[d[0]]&&""!==t.params[d[0]][d[1]]&&void 0!==t.params[d[0]][d[1]]&&null!==t.params[d[0]][d[1]]||(s[n]="is required")}"password"===e.type&&t.params[n]&&n+"_confirm"in t.params&&t.params[n]!==t.params[n+"_confirm"]&&(s[n]="didn't match",s[n+"_confirm"]=""),"email"===e.type&&t.params[n]&&(t.params[n].match(/\S+@\S+\.\S+/)||(s[n]="invalid"),t.params[n].match(/ /)&&(s[n]="invalid")),"datetime"===e.tag&&"invalid"===t.params[n]&&(s[n]="invalid"),"date"===e.tag&&"invalid"===t.params[n]&&(s[n]="invalid")}if(!_.isEmpty(s))return App.Log.error("Model","validation failed",s),s},e.attributesSet=function(t){var e,n,i,s,r,o,a,l,c,p,u;for(n=[],r=0,l=(i=App[this.className].configure_attributes).length;r<l;r++){for(u=i[r],s=!1,o=0,c=t.length;o<c;o++)if((e=t[o]).name===u.name){s=!0;break}s||n.push(u)}for(a=0,p=t.length;a<p;a++)e=t[a],App[this.className].attributes.push(e.name),n.push(e);return App[this.className].configure_attributes=n},e.attributesGet=function(t,e,n){var i,s,r,o,a,l,c,p,u;if(null==t&&(t=void 0),null==e&&(e=!1),null==n&&(n=!1),!(e=clone(e||App[this.className].configure_attributes,!0)))return{};if(s={},t)for(r=0,l=e.length;r<l;r++)if((i=e[r])&&i.screen&&i.screen[t]&&!_.isEmpty(i.screen[t])&&(!0===i.screen[t].shown||void 0===i.screen[t].shown)){
for(o in p=i.screen[t])u=p[o],i[o]=u;s[i.name]=i}if((!t||_.isEmpty(s))&&!n)for(a=0,c=e.length;a<c;a++)s[(i=e[a]).name]=i;return s},e.prototype.validate=function(t){return null==t&&(t={}),App.Model.validate({model:this.constructor.className,params:this,screen:t.screen})},e.prototype.isOnline=function(){return!!this.id&&("number"==typeof this.id||"c"!==this.id[0])},e.fullLocal=function(t){return this._fillUp(App[this.className].find(t))},e.full=function(i,n,t,e){var s,r,o,a,l,c;return null==n&&(n=!1),null==t&&(t=!1),null==e&&(e=!1),a=this.url+"/"+i+"?full=true",o=void 0,e&&(o=App[this.className].subscribeItem(i,n)),!t&&App[this.className].exists(i)?(s=App[this.className].find(i),s=this._fillUp(s),n&&n(s,"full")):(this.FULL_CALLBACK||(this.FULL_CALLBACK={}),this.FULL_CALLBACK[i]||(this.FULL_CALLBACK[i]={}),n&&(r=this.className+"-"+Math.floor(99999*Math.random()),this.FULL_CALLBACK[i][r]=n),this.FULL_FETCH||(this.FULL_FETCH={}),this.FULL_FETCH[i]||(this.FULL_FETCH[i]=!0,App.Log.debug("Model","fetch "+this.className+".find("+i+") from server",a),App.Ajax.request({type:"GET",url:a,processData:!0,success:(c=this,function(t){var e;if(c.FULL_FETCH[i]=!1,App.Log.debug("Model","got "+c.className+".find("+i+") from server",t),t.assets?App.Collection.loadAssets(t.assets,{targetModel:c.className}):App[c.className].refresh(t),c.FULL_CALLBACK[t.id]){for(r in e=c.FULL_CALLBACK[t.id])(n=e[r])(c._fillUp(App[c.className].find(t.id))),delete c.FULL_CALLBACK[t.id][r];if(_.isEmpty(c.FULL_CALLBACK[t.id]))return delete c.FULL_CALLBACK[t.id]}}),error:(l=this,function(t,e,n){return l.FULL_FETCH[i]=!1,App.Log.error("Model",e,n,a)})}))),o},e.subscribe=function(r,t){var e,n,i,s,o,a,l,c;return null==t&&(t={}),this.SUBSCRIPTION_COLLECTION||(this.SUBSCRIPTION_COLLECTION={},this.bind("refresh",(l=this,function(t){var e,n,i;for(e in _.isArray(t)||(t=[t]),App.Log.debug("Model","local collection refresh "+l.className,t),i=[],n=l.SUBSCRIPTION_COLLECTION)r=n[e],i.push(r(t,"refresh"));return i})),this.bind("change",(a=this,function(t,e){var n,i,s;if("destroy"!==e){for(n in _.isArray(t)||(t=[t]),App.Log.debug("Model","local collection change "+a.className,t),s=[],i=a.SUBSCRIPTION_COLLECTION)r=i[n],s.push(r(t,"change"));return s}})),this.bind("destroy",(o=this,function(t){var e,n,i;for(e in _.isArray(t)||(t=[t]),App.Log.debug("Model","local collection destroy "+o.className,t),i=[],n=o.SUBSCRIPTION_COLLECTION)r=n[e],i.push(r(t,"destroy"));return i})),n=this.className+":create "+this.className+":update "+this.className+":touch "+this.className+":destroy",App.Event.bind(n,(s=this,function(){if(!_.isEmpty(s.SUBSCRIPTION_COLLECTION))return App.Log.debug("Model","server notify collection change "+s.className),r=function(){return s.fetchFull(function(){},{clear:!0})},App.Delay.set(r,200,"fullcollection-"+s.className,"model-"+s.className)}),"Collection::Subscribe::"+this.className)),i=this.className+"-"+Math.floor(99999*Math.random()),this.SUBSCRIPTION_COLLECTION[i]=r,!0===t.initFetch&&((e=!0)!==t.clear&&!1!==t.clear||(e=t.clear),this.initFetchActives||0!==this.count()?r(this.all()):(this.initFetchActive=!0,this.one("refresh",(c=this,function(t){return c.initFetchActive=!1,r(t)})),this.fetchFull(function(){},{clear:e}))),i},e.prototype.subscribe=function(t){return App[this.constructor.className].subscribeItem(this.id,t)},e.subscribeItem=function(t,o){var e,n,i,s,a,l,c;return this._subscribeItemBindDone||(this._subscribeItemBindDone=!0,this.bind("change",(c=this,function(t){var e,n,i,s,r;for(_.isArray(t)||(t=[t]),App.Log.debug("Model","local change "+c.className,t),r=[],e=0,s=t.length;e<s;e++)n=t[e],r.push(function(){var t,e;for(i in e=[],t=App[this.className].SUBSCRIPTION_ITEM[n.id])o=t[i],e.push(o(App[this.className]._fillUp(n),"change"));return e}.call(c));return r})),this.bind("destroy",(l=this,function(t){var e,n,i,s,r;for(_.isArray(t)||(t=[t]),App.Log.debug("Model","local destroy "+l.className,t),r=[],e=0,s=t.length;e<s;e++)n=t[e],r.push(function(){var t,e;for(i in e=[],t=App[this.className].SUBSCRIPTION_ITEM[n.id])o=t[i],e.push(o(App[this.className]._fillUp(n),"destroy"));return e}.call(l));return r})),this.changeTable={},this.bind("refresh",(a=this,function(t){var e,n,i,s,r;for(_.isArray(t)||(t=[t]),App.Log.debug("Model","local refresh "+a.className,t),r=[],e=0,s=t.length;e<s;e++)n=t[e],r.push(function(){var t,e;for(i in e=[],t=App[this.className].SUBSCRIPTION_ITEM[n.id])o=t[i],!this.changeTable[i]||this.changeTable[i]<n.updated_at?(this.changeTable[i]=n.updated_at,e.push(o(App[this.className]._fillUp(n),"refresh"))):e.push(void 0);return e}.call(a));return r})),e=this.className+":create "+this.className+":update "+this.className+":touch",App.Event.bind(e,(s=this,function(e){if(s.SUBSCRIPTION_ITEM&&s.SUBSCRIPTION_ITEM[e.id])return App.Log.debug("Model","server change on "+s.className+".find("+e.id+") "+e.updated_at),o=function(){var t;if(t=void 0,App[s.className].exists(e.id)&&(t=App[s.className].find(e.id)),!t||new Date(e.updated_at)>new Date(t.updated_at))return App.Log.debug("Model","request "+s.className+".find("+e.id+") from server"),s.full(e.id,!1,!0)},App.Delay.set(o,600,"full-"+e.id,"model-"+s.className)}),"Item::Subscribe::"+this.className),e=this.className+":destroy",App.Event.bind(e,(i=this,function(t){var e;if(i.SUBSCRIPTION_ITEM&&i.SUBSCRIPTION_ITEM[t.id]&&App[i.className].exists(t.id))return e=App[i.className].find(t.id),App.Log.debug("Model","server delete on "+i.className+".find("+t.id+") "+t.updated_at),o=function(){return e.trigger("destroy",e)},App.Delay.set(o,500,"delete-"+t.id,"model-"+i.className)}),"Item::SubscribeDelete::"+this.className)),this.SUBSCRIPTION_ITEM||(this.SUBSCRIPTION_ITEM={}),this.SUBSCRIPTION_ITEM[t]||(this.SUBSCRIPTION_ITEM[t]={}),n=this.className+"-"+Math.floor(99999*Math.random()),this.SUBSCRIPTION_ITEM[t][n]=o,n},e.unsubscribe=function(t){var e,n,i;if(this.SUBSCRIPTION_ITEM)for(e in i=this.SUBSCRIPTION_ITEM)(n=i[e])[t]&&delete n[t];if(this.SUBSCRIPTION_COLLECTION&&this.SUBSCRIPTION_COLLECTION[t])return delete this.SUBSCRIPTION_COLLECTION[t]},e.fetchFull=function(t,e){var n,i,s,r,o,a,l;if(null==e&&(e={}),s=this.url+"/?full=true",App.Log.debug("Model","fetchFull collection "+this.className,s),i=this.className+"::fetchFull",!1!==e.force||0===App[this.className].count()){if(t&&(o=this,n=function(){return t(App[o.className].all())},App.QueueManager.add(i,n)),!(this.fetchFullActive&&this.fetchFullActive>(new Date).getTime()-500))return this.fetchFullActive=(new Date).getTime(),App.Ajax.request({type:"GET",url:s,processData:!0,success:(l=this,function(t){return l.fetchFullActive=!1,App.Log.debug("Model","got fetchFull collection "+l.className,t),e.clear&&App[l.className].deleteAll(),t.assets?(App.Collection.loadAssets(t.assets,{targetModel:l.className}),t.record_ids&&_.isEmpty(t.record_ids)&&App[l.className].trigger("refresh",[])):App[l.className].refresh(t),App.QueueManager.run(i)}),error:(a=this,function(t,e,n){return a.fetchFullActive=!1,App.Log.error("Model",e,n,s)})})}else t&&(r=this,n=function(){return t(App[r.className].all(),"full")},App.QueueManager.add(i,n),App.QueueManager.run(i))},e._bindsEmpty=function(){var t,e,n;if(this.SUBSCRIPTION_ITEM)for(t in n=this.SUBSCRIPTION_ITEM)if(e=n[t],!_.isEmpty(e))return!1;return!(this.SUBSCRIPTION_COLLECTION&&!_.isEmpty(this.SUBSCRIPTION_COLLECTION))},e._fillUp=function(t,e){var n,i,s,r,o,a;if(null==e&&(e=[]),!App[this.className].configure_attributes)return t;for(i=0,r=(o=App[this.className].configure_attributes).length;i<r;i++)(n=o[i]).relation&&(_.contains(e,this.className)||App[n.relation]&&(a=n.name.substr(0,n.name.length-3),"_id"===n.name.substr(n.name.length-3,n.name.length)&&t[n.name]&&(App[n.relation].exists(t[n.name])?(s=App[n.relation].findNative(t[n.name]),s=App[n.relation]._fillUp(s,e.concat(this.className)),t[a]=s):n.do_not_log||console.log("ERROR, cant find "+n.name+" App."+n.relation+".find("+t[n.name]+") for '"+t.constructor.className+"' "+t.displayName()))));return t},e.search=function(t){var e,n,i,s,r,o,a,l;if(e=this.all(),n=[],!t){for(i=0,a=e.length;i<a;i++)s=e[i],r=this.findNative(s.id),n.push(this._fillUp(r));return n}for(o=0,l=e.length;o<l;o++)s=e[o],r=this.findNative(s.id),n.push(this._fillUp(r));return t.filter&&(n=this._filter(n,t.filter)),t.filterExtended&&(n=this._filterExtended(n,t.filterExtended)),null!==t.sortBy&&(n=this._sortBy(n,t.sortBy)),t.order&&(n=this._order(n,t.order)),n},e._sortBy=function(t,e){return _.sortBy(t,function(t){if(e||(e="displayName"),"displayName"===e){if(t.displayName)return t.displayName().toLowerCase();e="name"}return void 0===t[e]?"":null===t[e]?"":t[e].toLowerCase?t[e].toLowerCase():t[e]})},e._order=function(t,e){return"DESC"===e?t.reverse():t},e._filter=function(t,e){var n,i;for(n in e)i=e[n],t=_.filter(t,function(t){if(t[n]===i)return t});return t},e._filterExtended=function(t,l){return t=_.filter(t,function(t){var e,n,i,s,r,o,a;for(n=0,s=l.length;n<s;n++){for(i in r=void 0,e=l[n])a=e[i],!1!==r&&(o=new RegExp(a,"i"),r=!(void 0===t[i]||null===t[i]||!t[i].match(o)));if(!0===r)return t}})},e.prototype.activityMessage=function(t){return"Need own activityMessage() in model to generate text ("+this.objectDisplayName()+"/"+t.type+")."},e.lastUpdatedAt=function(){var t,e,n,i,s;for(t=0,n=(i=this.all()).length;t<n;t++)(e=i[t]).updated_at&&(s?e.updated_at>s&&(s=e.updated_at):s=e.updated_at);return s},e.updatedAt=function(t){if(this.irecords[t])return this.irecords[t].updated_at},e.findNative=function(t){return this.irecords[t]||("function"==typeof notFound?notFound(t):void 0)},e.tagGet=function(t,e,n){return App.Ajax.request({id:e,type:"GET",url:this.apiPath+"/tags",data:{object:this.serverClassName||this.className,o_id:t},processData:!0,success:function(t){return n(t)}})},e.tagAdd=function(t,e){return App.Ajax.request({type:"GET",url:this.apiPath+"/tags/add",data:{object:this.serverClassName||this.className,o_id:t,item:e},processData:!0})},e.tagRemove=function(t,e){return App.Ajax.request({type:"GET",url:this.apiPath+"/tags/remove",data:{object:this.serverClassName||this.className,o_id:t,item:e},processData:!0})},e.clearInMemory=function(){return App.Delay.clearLevel("model-"+this.className),this.resetCallbacks(),this.resetAttributes(),this.deleteAll()},e.updateAttributes=function(t){var e,n,i,s,r,o,a,l,c,p;for(_.isEmpty(this.org_configure_attributes)&&(this.org_configure_attributes=$.extend(!0,[],this.configure_attributes)),p=[],s=0,a=t.length;s<a;s++){for(e=t[s],this.attributes.push(e.name),i=!1,r=o=0,l=(c=this.configure_attributes).length;o<l;r=++o)if((n=c[r]).name===e.name){this.configure_attributes[r]=_.extend(n,e),i=!0;break}i?p.push(void 0):p.push(this.configure_attributes.push(e))}return p},e.resetAttributes=function(){if(!_.isEmpty(this.org_configure_attributes))return this.configure_attributes=$.extend(!0,[],this.org_configure_attributes)},e.resetCallbacks=function(){if(this.SUBSCRIPTION_ITEM&&(this.SUBSCRIPTION_ITEM={}),this.SUBSCRIPTION_COLLECTION)return this.SUBSCRIPTION_COLLECTION={}},e}(Spine.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ActivityStream=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("ActivityStream","name"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/activity_steams",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Application=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Application","name","redirect_uri"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/applications",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"redirect_uri",display:"Callback URL",tag:"textarea",limit:250,"null":!1,note:"Use one line per URI"},{name:"clients",display:"Clients",tag:"input",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e.configure_overview=["name","redirect_uri","clients"],e.configure_delete=!0,e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Calendar=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Calendar","name","timezone","default","business_hours","ical_url","public_holidays","note"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/calendars",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"timezone",display:"Time zone",tag:"timezone","null":!1},{name:"business_hours",display:"Business Hours",tag:"business_hours","null":!0},{name:"ical_url",display:"Holidays iCalendar Feed",tag:"ical_feed",placeholder:"http://example.com/public_holidays.ical","null":!0},{name:"public_holidays",display:"Holidays",tag:"holiday_selector","null":!0},{name:"note",display:"Note",tag:"textarea",limit:250,"null":!0},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e.prototype.displayName=function(){return this.name+" - "+this.timezone},e.description='A **calendar** is needed for calculation of escalation based on business hours and sending out escalation notifications..\n\nDefine a **"standard"** calendar which is valid system-wide. Only in the defined business hours the escalation notifications will be sent to your agents.\n\nDo you have customers with different business hours, you can create multiple calendars. Tickets are linked to calendars using **SLAs**.',e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Channel=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Channel","adapter","area","options","group_id","active"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/channels",e.prototype.displayName=function(){var t;return t="",this.options&&(this.options.inbound&&(t+=this.options.inbound.options.user+"@"+this.options.inbound.options.host+" ("+this.options.inbound.adapter+")"),this.options.outbound&&this.options.outbound&&(""!==t&&(t+=" / "),this.options.outbound.options?t+=this.options.outbound.options.host+" ("+this.options.outbound.adapter+")":t+=" ("+this.options.outbound.adapter+")")),""===t&&(t="???"),t},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Chat=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Chat","name","active","public","max_queue","block_ip","whitelisted_websites","block_country","note"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/chats",e.countries={AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, The Democratic Republic Of The",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",TP:"East Timor",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GN:"Guinea",GW:"Guinea-bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island And Mcdonald Islands",VA:"Holy See (vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic Of",IQ:"Iraq",IE:"Ireland",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JO:"Jordan",KZ:"Kazakstan",KE:"Kenya",KI:"Kiribati",KP:"Korea, Democratic People's Republic Of",KR:"Korea, Republic Of",KV:"Kosovo",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macau",MK:"Macedonia, The Former Yugoslav Republic Of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States Of",MD:"Moldova, Republic Of",MC:"Monaco",MN:"Mongolia",MS:"Montserrat",ME:"Montenegro",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And The Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And The South Sandwich Islands",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province Of China",TJ:"Tajikistan",TZ:"Tanzania, United Republic Of",TH:"Thailand",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.s.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"note",display:"Note",tag:"textarea",limit:250,"null":!0},{name:"max_queue",display:"Max. clients in waitlist",tag:"input","default":2},{name:"block_ip",display:"Blocked IPs (separated by ;)",tag:"input","default":"","null":!0},{name:"whitelisted_websites",display:"Allow websites (separated by ;)",tag:"input","default":"","null":!0},{name:"block_country",display:"Blocked countries",tag:"column_select",multiple:!0,"null":!0,"default":"",options:e.countries,seperator:";"},{name:"active",display:"Active",tag:"active","default":!0},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ChatSession=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("ChatSession","name","note"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/chat_sessions",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"state",display:"State",readonly:1},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e.configure_overview=["name","state","created_at"],e.prototype.uiUrl=function(){return"#customer_chat/session/"+this.id},e.prototype.searchResultAttributes=function(){var t;return t="",_.isEmpty(this.name)||(t=this.displayName()),{display:"#"+this.id+" "+t,id:this.id,"class":"chat_session chat_session-popover",url:this.uiUrl(),icon:"chat"}},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.EmailAddress=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("EmailAddress","realname","email","channel_id","note","active","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/email_addresses",e.filterChannel=function(t,e,n){var i;return"collection"!==e?t:(i=void 0,n&&n.channel_id&&App.Channel.exists(n.channel_id)&&(i=App.Channel.find(n.channel_id)),_.filter(t,function(t){if(t)if(i){if(t.area===i.area)return t}else if("Google::Account"===t.area||"Email::Account"===t.area)return t}))},e.configure_attributes=[{name:"realname",display:"Display name",tag:"input",type:"text",limit:250,"null":!1},{name:"email",display:"Email",tag:"input",type:"email",limit:250,"null":!1},{name:"channel_id",display:"Channel",tag:"select",multiple:!1,"null":!0,relation:"Channel",nulloption:!0,filter:e.filterChannel,do_not_log:!0},{name:"note",display:"Note",tag:"textarea",note:"Notes are visible to agents only, never to customers.",limit:250,"null":!0},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1},{name:"active",display:"Active",tag:"active",readonly:1}],e.configure_overview=["realname","email"],e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ExternalCredential=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("ExternalCredential","name","credentials"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/external_credentials",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Group=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Group","name","assignment_timeout","follow_up_possible","follow_up_assignment","email_address_id","signature_id","note","active","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/groups",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"assignment_timeout",display:"Assignment Timeout",tag:"input",note:"Assignment timeout in minutes if assigned agent is not working on it. Ticket will be shown as unassigend.",type:"text",limit:100,"null":!0},{name:"follow_up_possible",display:"Follow-up possible",tag:"select","default":"yes",options:{yes:"yes",new_ticket:"do not reopen Ticket but create new Ticket"},"null":!1,note:"Follow-up for closed ticket possible or not.",translate:!0},{name:"follow_up_assignment",display:"Assign Follow-Ups",tag:"select","default":"yes",options:{"true":"yes","false":"no"},"null":!1,note:"Assign follow-up to latest agent again.",translate:!0},{name:"email_address_id",display:"Email",tag:"select",multiple:!1,"null":!0,relation:"EmailAddress",nulloption:!0,do_not_log:!0},{name:"signature_id",display:"Signature",tag:"select",multiple:!1,"null":!0,relation:"Signature",nulloption:!0,do_not_log:!0},{name:"note",display:"Note",tag:"textarea",note:"Notes are visible to agents only, never to customers.",limit:250,"null":!0},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1},{name:"active",display:"Active",tag:"active","default":!0}],e.configure_clone=!0,e.configure_overview=["name"],e.prototype.uiUrl=function(){return"#group/zoom/"+this.id},e.prototype.activityMessage=function(t){return"create"===t.type?App.i18n.translateContent("%s created Group |%s|",t.created_by.displayName(),t.title):"update"===t.type?App.i18n.translateContent("%s updated Group |%s|",t.created_by.displayName(),t.title):"Unknow action for ("+this.objectDisplayName()+"/"+t.type+"), extend activityMessage() of model."},e.prototype.avatar=function(t,e){return null==t&&(t=40),null==e&&(e=[]),t=parseInt(t,10),e.push("size-"+t),e.push("avatar--group-color-"+this.id%3),App.view("avatar_group")({cssClass:e.join(" ")})},e.accesses=function(){return{read:"Read",create:"Create",change:"Change",overview:"Overview",full:"Full"}},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Job=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Job","name","timeplan","condition","perform","disable_notification","note","active"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/jobs",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"timeplan",display:"When should the job run?",tag:"timer","null":!0},{name:"condition",display:"Conditions for effected objects",tag:"ticket_selector","null":!0,executionTime:!0},{name:"perform",display:"Execute changes on objects",tag:"ticket_perform_action","null":!0,notification:!0,ticket_delete:!0},{name:"disable_notification",display:"Disable Notifications",tag:"boolean","default":!0},{name:"note",display:"Note",tag:"textarea",note:"Notes are visible to agents only, never to customers.",limit:250,"null":!0},{name:"active",display:"Active",tag:"active","default":!0},{name:"matching",display:"Will process",readonly:1},{name:"processed",display:"Has processed",readonly:1},{name:"last_run_at",display:"Last run",tag:"datetime",readonly:1},{name:"next_run_at",display:"Scheduled for",tag:"datetime",readonly:1},{name:"running",display:"Running",tag:"boolean",readonly:1},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e.configure_delete=!0,e.configure_clone=!0,e.configure_overview=["name","last_run_at","processed","next_run_at","matching"],e}(App.Model)}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBase=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.configure("KnowledgeBase","iconset","color_highlight","color_header","translation_ids","locale_ids","homepage_layout","category_layout","custom_address"),n.extend(Spine.Model.Ajax),n.extend(App.KnowledgeBaseActions),n.url=n.apiPath+"/knowledge_bases",n.manageUrl=n.apiPath+"/knowledge_bases/manage",n.prototype.manageUrl=function(t){return null==t&&(t=null),App.Utils.joinUrlComponents(this.constructor.manageUrl,this.id,t)},n.prototype.publicBaseUrl=function(t){var e;return null==t&&(t=void 0),e=null!=this.custom_address&&"/"!==this.custom_address[0]?["http://"+this.custom_address]:null!=this.custom_address?[App.Utils.baseUrl(),this.custom_address.substr(1,this.custom_address.length-1)]:[App.Utils.baseUrl(),"help"],t&&e.push(t.systemLocale().locale),App.Utils.joinUrlComponents(e)},n.prototype.uiUrl=function(t,e){return null==e&&(e=void 0),App.Utils.joinUrlComponents(this.uiUrlComponent(),t.urlSuffix(),e)},n.prototype.uiUrlComponent=function(){return"#knowledge_base/"+this.id},n.prototype.categories=function(){return App.KnowledgeBaseCategory.all().filter((e=this,function(t){return t.knowledge_base_id===e.id}));var e},n.prototype.rootCategories=function(){return this.categories().filter(function(t){return null===t.parent_id}).sort(function(t,e){return t.position-e.position})},n.prototype.kb_locales=function(){return App.KnowledgeBaseLocale.findAll(this.kb_locale_ids)},n.prototype.primaryKbLocale=function(){return this.kb_locales().filter(function(t){return t.primary})[0]},n.prototype.knowledge_base=function(){return this},n.prototype.isEmpty=function(){return 0===this.rootCategories().length},n.translatableClass=function(){return App.KnowledgeBaseTranslation},n.translatableForeignKey=function(){return"knowledge_base_id"},n.extend(App.KnowledgeBaseTranslatable),n.prototype.remove=function(e){return null==e&&(e={}),this.rootCategories().forEach(function(t){return t.remove(e)}),this.removeTranslations(e),n.__super__.remove.apply(this,arguments)},n.prototype.objectName=function(){return"Knowledge Base"},n.prototype.categoriesForDropdown=function(n){var t,i;return null==n&&(n={}),t=[],n.includeRoot&&t.push({value:null,name:">> Homepage <<"}),i=n.includeRoot?1:0,this.rootCategories().reduce(function(t,e){return t.concat(e.categoriesForDropdown({nested:i,kb_locale:n.kb_locale}))},t)},n.prototype.visibleInternally=function(){return this.active},n.prototype.visiblePublicly=function(){return this.active},n.prototype.attributes=function(){var t;return(t=n.__super__.attributes.call(this)).kb_locales=this.kb_locales().map(function(t){return t.attributes()}),t},n.configure_attributes=[{name:"translation::title",model:"translation",display:"Title",tag:"input","null":!1,screen:{agent_edit:{shown:!0}}},{name:"translation::footer_note",model:"translation",display:"Footer Note",tag:"input","null":!1,screen:{agent_edit:{shown:!0}}},{name:"color_highlight",display:"Icon & Link Color",tag:"color",style:"block","null":!1,screen:{admin_style_color_highlight:{display:!1,horizontal:!0,shown:!0}}},{name:"color_header",display:"Header Color",tag:"color",style:"block","null":!1,screen:{admin_style_color_header:{display:!1,horizontal:!0,shown:!0}}},{name:"iconset",display:"Icon Set",tag:"iconset_picker",style:"block",help:"Every category in your knowledge base should be given a unique icon for maximum visual clarity. Each set below provides a wide range of icons to choose from, but beware-you can't mix and match different icons from different sets. Choose carefully!","null":!1,screen:{admin_style_iconset:{shown:!0}}},{name:"kb_locales",display:"Languages",tag:"multi_locales",style:"block","null":!1,help:"You can provide different versions of your knowledge base for different locales. Add a language below, then select it in the Knowledge Base Editor to add your translations.",screen:{admin_languages:{shown:!0},admin_create:{shown:!0}}},{name:"custom_address",display:"Custom URL",tag:"input",style:"block","null":!0,help:'The default URL for your knowledge base is e.g. example.com or example.com/help. To serve it from a custom URL instead, enter the destination below (e.g., "/support", "example.com", or "example.com/support"). Then, follow the directions under "Web Server Configuration" to complete the process.',screen:{admin_custom_address:{shown:!0}}}],n}(App.Model)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}
for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseAnswer=function(t){function e(){return this.visibleInternally=n(this.visibleInternally,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.configure("KnowledgeBaseAnswer","category_id","translation_ids","archived_at","internal_at","published_at","attachments"),e.extend(Spine.Model.Ajax),e.extend(App.KnowledgeBaseActions),e.extend(App.KnowledgeBaseCanBePublished),e.serverClassName="KnowledgeBase::Answer",e.prototype.url=function(){return this.knowledge_base().generateURL("answers")},e.prototype.uiUrl=function(t,e){return null==e&&(e=null),App.Utils.joinUrlComponents(this.knowledge_base().uiUrl(t),this.uiUrlComponent(),e)},e.prototype.uiUrlComponent=function(){return"answer/"+this.id},e.prototype.knowledge_base=function(){return App.KnowledgeBase.find(this.category().knowledge_base_id)},e.prototype.category=function(){return App.KnowledgeBaseCategory.find(this.category_id)},e.configure_attributes=[{name:"translation::title",model:"translation",display:"Title",tag:"input",grid_width:"1/2"}],e.prototype.configure_attributes=function(t){return null==t&&(t=void 0),[{name:"translation::title",model:"translation",display:"Title",tag:"input",grid_width:"1/2","null":!1,screen:{agent_create:{shown:!0}}},{name:"category_id",model:"answer",display:"Category",tag:"select","null":!1,options:this.knowledge_base().categoriesForDropdown({kb_locale:t}),grid_width:"1/2",screen:{agent_create:{tag:"input",type:"hidden",display:!1}}},{name:"translation::content::body",model:"translation",buttons:["link","link_answer","insert_image","embed_video"],display:"Content",tag:"richtext","null":!0}]},e.prototype.publicBaseUrl=function(t){return this.isNew()?null:App.Utils.joinUrlComponents([this.category().publicBaseUrl(t),this.id])},e.translatableClass=function(){return App.KnowledgeBaseAnswerTranslation},e.translatableForeignKey=function(){return"answer_id"},e.extend(App.KnowledgeBaseTranslatable),e.prototype.remove=function(t){return null==t&&(t={}),this.removeTranslations(t),e.__super__.remove.apply(this,arguments)},e.prototype.baseParams=function(){return{category_id:this.category_id}},e.prototype.category=function(){return App.KnowledgeBaseCategory.find(this.category_id)},e.prototype.objectName=function(){return"Answer"},e.prototype.visibleInternally=function(t){return this.is_internally_published(t)},e}(App.Model)}.call(this),function(){var i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseAnswerTranslation=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return i(n,t),n.configure("KnowledgeBaseAnswerTranslation","title","preview","content","note","source","outdated","promoted","answer_id","locale_id","state_id"),n.extend(Spine.Model.Ajax),n.extend(App.KnowledgeBaseTranslationable),n.configure_attributes=[{name:"title",display:"Name",tag:"input",type:"text",limit:300,"null":!1,info:!0},{name:"created_at",display:"Created at",tag:"datetime",readonly:1,info:!1},{name:"updated_at",display:"Updated at",tag:"datetime",readonly:1,info:!1}],n.prototype.url=function(){return this.parent().generateURL("translations")},n.prototype.uiUrl=function(t){return null==t&&(t=null),this.parent().uiUrl(App.KnowledgeBaseLocale.localeFor(this),t)},n.prototype.publicBaseUrl=function(){return this.parent().publicBaseUrl(App.KnowledgeBaseLocale.localeFor(this))},n.prototype.content=function(){return App.KnowledgeBaseAnswerTranslationContent.find(this.content_id)},n.prototype.displayName=function(){return this.title},n.prototype.parent=function(){return App.KnowledgeBaseAnswer.find(this.answer_id)},n.prototype.remove=function(t){var e;return null==t&&(t={}),null!=(e=this.content())&&e.remove(t),n.__super__.remove.apply(this,arguments)},n.prototype.attributes=function(){var t,e;return(t=n.__super__.attributes.apply(this,arguments)).content=null!=(e=this.content())?e.attributes():void 0,t},n.prototype.loadFull=function(n){var t;return t=this.parent().generateURL()+"?full=1&include_contents="+this.content_id,App.Ajax.request({url:t,success:function(t){return App.Collection.loadAssets(t.assets),n(!0)},error:function(t){var e;return n(!1),App.Event.trigger("notify",{type:"error",msg:(null!=(e=t.responseJSON)?e.error:void 0)||"Unable to load"})}})},n.processAttributes=function(t){var e;return(e=t.content)&&_.isObject(e)&&(delete t.content,t.content_attributes=e),t},n.prototype.searchResultAttributes=function(){return _.extend({},this.defaultSearchResultAttributes(),{"class":"kb-answer-popover",icon:"knowledge-base"})},n.configure_overview=["title","updated_at"],n.display_name="Knowledge Base Answer",n.prototype.linked_tickets=function(){return this.linked_references.filter(function(t){return"Ticket"===t.link_object}).map(function(t){return App.Ticket.find(t.link_object_value)})},n}(App.Model),App.KnowledgeBaseAnswerTranslationContent=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.configure("KnowledgeBaseAnswerTranslationContent","body"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/knowledge_base/translation/content",e.configure_attributes=[{name:"body",display:"Body",tag:"input"}],e.prototype.attributes=function(){var t;return(t=e.__super__.attributes.apply(this,arguments)).body={text:this.body,attachments:this.attachments},t},e.prototype.bodyTruncated=function(){var t;return(t=this.body.replace(/<([^>]+)>/g,"")).length<100?t:t.substring(0,100)+"..."},e.prototype.bodyWithPublicURLs=function(){var t,e,n,i,s,r;for(t=0,e=(r=(s=$("<div>"+this.body+"</div>")).find("a").andSelf("a").toArray()).length;t<e;t++)switch(n=r[t],$(n).attr("data-target-type")){case"knowledge-base-answer":(i=App.KnowledgeBaseAnswerTranslation.find($(n).attr("data-target-id")))?$(n).attr("href",i.publicBaseUrl()):$(n).attr("href","#")}return s[0].innerHTML},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseAnswerTranslationState=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("KnowledgeBaseAnswerTranslationState","name"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/knowledge_base/answer/translation/states",e}(App.Model)}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseCategory=function(t){function n(){return this.visiblePublicly=e(this.visiblePublicly,this),this.visibleInternally=e(this.visibleInternally,this),this.findDeepAnswer=e(this.findDeepAnswer,this),n.__super__.constructor.apply(this,arguments)}return i(n,t),n.configure("KnowledgeBaseCategory","category_icon","parent_id","child_ids","translation_ids"),n.extend(Spine.Model.Ajax),n.extend(App.KnowledgeBaseActions),n.prototype.url=function(){return this.knowledge_base().generateURL("categories")},n.prototype.uiUrl=function(t,e){return null==e&&(e=null),App.Utils.joinUrlComponents(this.knowledge_base().uiUrl(t),this.uiUrlComponent(),e)},n.prototype.uiUrlComponent=function(){return"category/"+this.id},n.prototype.knowledge_base=function(){return App.KnowledgeBase.find(this.knowledge_base_id)},n.prototype.isEmpty=function(){return 0===this.children().length&&0===this.answers().length},n.prototype.remove=function(e){return null==e&&(e={}),this.removeTranslations(e),this.children().forEach(function(t){return t.remove(e)}),this.answers().forEach(function(t){return t.remove(e)}),n.__super__.remove.apply(this,arguments)},n.prototype.categoriesForDropdown=function(n){var t,e;return e=Array.apply(null,{length:n.nested}).map(function(){return"- "}).join(""),t=[{value:this.id,name:e+this.guaranteedTitle(n.kb_locale.id)}],this.children().reduce(function(t,e){return t.concat(e.categoriesForDropdown({nested:n.nested+1,kb_locale:n.kb_locale}))},t)},n.prototype.configure_attributes=function(t){return null==t&&(t=void 0),[{name:"category_icon",model:"category",display:"Icon",tag:"icon_picker",iconset:this.knowledge_base().iconset,grid_width:"1/5","null":!1,"default":this.constructor.defaultIconFor(this.knowledge_base()),screen:{agent_create:{shown:!0}}},{name:"translation::title",model:"translation",display:"Title",tag:"input",grid_width:"4/5","null":!1,screen:{agent_create:{shown:!0}}},{name:"parent_id",model:"category",display:"Parent",tag:"select","null":!0,options:this.knowledge_base().categoriesForDropdown({includeRoot:!0,kb_locale:t}),grid_width:"1/2",screen:{agent_create:{tag:"input",type:"hidden",display:!1}}}]},n.prototype.publicBaseUrl=function(t){return this.isNew()?null:App.Utils.joinUrlComponents([this.knowledge_base().publicBaseUrl(t),this.id])},n.translatableClass=function(){return App.KnowledgeBaseCategoryTranslation},n.translatableForeignKey=function(){return"category_id"},n.extend(App.KnowledgeBaseTranslatable),n.prototype.baseParams=function(){return{parent_id:this.parent_id}},n.prototype.children=function(){return void 0===this.id?[]:App.KnowledgeBaseCategory.findAllByAttribute("parent_id",this.id).sort(function(t,e){return t.position-e.position})},n.prototype.deepChildrenIds=function(){var t,e;return(e=(t=this.children()).map(function(t){return t.deepChildrenIds()})).push(t.map(function(t){return t.id})),_.flatten(e)},n.prototype.parent=function(){return App.KnowledgeBaseCategory.find(this.parent_id)},n.prototype.answers=function(){return App.KnowledgeBaseAnswer.findAllByAttribute("category_id",this.id).sort(function(t,e){return t.position-e.position})},n.prototype.countDeepAnswers=function(){var e;return(e=this.deepChildrenIds()).push(this.id),App.KnowledgeBaseAnswer.records.filter(function(t){return _.contains(e,t.category_id)}).length},n.prototype.findDeepAnswer=function(e){var t,n,i;return null!=(t=_.find(App.KnowledgeBaseAnswer.records,(n=this,function(t){return t.category_id===n.id&&e(t)})))?t:_.find(App.KnowledgeBaseCategory.records,(i=this,function(t){return t.parent_id===i.id&&t.findDeepAnswer(e)}))},n.prototype.visibilityState=function(t){return this.visiblePublicly(t)?"published":this.visibleInternally(t)?"internal":"draft"},n.prototype.visibleInternally=function(e){return null!=this.findDeepAnswer(function(t){return t.is_internally_published(e)})},n.prototype.visiblePublicly=function(e){return null!=this.findDeepAnswer(function(t){return t.is_published(e)})},n.prototype.objectName=function(){return"Category"},n.defaultIconFor=function(t){switch(null!=t?t.iconset:void 0){case"FontAwesome":return"f115";case"anticon":return"e662";case"material":return"e94d";case"ionicons":return"f139";case"Simple-Line-Icons":return"e039"}},n}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseCategoryTranslation=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("KnowledgeBaseCategoryTranslation","title","locale_id","category_id"),e.extend(Spine.Model.Ajax),e.extend(App.KnowledgeBaseTranslationable),e.url=e.apiPath+"/knowledge_base/category/translations",e.prototype.parent=function(){return App.KnowledgeBaseCategory.find(this.category_id)},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseLayout=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("KnowledgeBaseLayout","name"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/knowledge_base/layouts",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseLocale=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("KnowledgeBaseLocale","knowledge_base_id","system_locale_id","primary"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/knowledge_base/locales",e.prototype.systemLocale=function(){return App.Locale.find(this.system_locale_id)},e.prototype.urlSuffix=function(){return"locale/"+this.systemLocale().locale},e.localeFor=function(t){if(void 0===t.kb_locale_id)throw"This object doesn't have locale";return App.KnowledgeBaseLocale.find(t.kb_locale_id)},e.prototype.applyOntoPath=function(t){return t.replace(/\/locale\/[\w-]{2,5}/,"/"+this.urlSuffix())},e.prototype.attributesForRendering=function(t,e){return null==e&&(e={}),{url:this.applyOntoPath(t),title:this.systemLocale().name}},e.detect=function(e){var n;return n=App.Locale.findByAttribute("locale",App.i18n.get()),App.KnowledgeBaseLocale.all().filter(function(t){return t.knowledge_base_id===e.id&&t.system_locale_id===n.id}).pop()||e.primaryKbLocale()},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseMenuItem=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("KnowledgeBaseMenuItem","kb_locale_id","position","title","url"),e.using_kb_locale=function(t){var e;return(e=this.findAllByAttribute("kb_locale_id",t.id)).sort(function(t,e){return t.position<e.position?-1:1}),e},e.using_kb_locale_location=function(e,n){var t;return(t=this.all().filter(function(t){return t.kb_locale_id===e.id&&t.location===n})).sort(function(t,e){return t.position<e.position?-1:1}),t},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseTranslation=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("KnowledgeBaseTranslation","title","footer_note"),e.extend(Spine.Model.Ajax),e.extend(App.KnowledgeBaseTranslationable),e.url=e.apiPath+"/knowledge_base/translations",e.configure_attributes=[{name:"title",display:"Title",tag:"input"}],e.prototype.parent=function(){return App.KnowledgeBase.find(this.knowledge_base_id)},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Locale=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Locale","name","alias","locale"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/locales",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Macro=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Macro","name","perform","ux_flow_next_up","note","group_ids","active"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/macros",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"perform",display:"Actions",tag:"ticket_perform_action","null":!0},{name:"ux_flow_next_up",display:"Once completed...",tag:"select","default":"none",options:{none:"Stay on tab",next_task:"Close tab",next_from_overview:"Advance to next ticket from overview"}},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1},{name:"note",display:"Note",tag:"textarea",limit:250,"null":!0},{name:"group_ids",display:"Groups",tag:"column_select",relation:"Group","null":!0},{name:"active",display:"Active",tag:"active","default":!0}],e.configure_delete=!0,e.configure_clone=!0,e.configure_overview=["name","note","group_ids"],e.getList=function(){return App.Macro.search({filter:{active:!0},sortBy:"name",order:"ASC"})},e.description="Macros make it easy to automate common, multi-step tasks within Zammad.\n\nYou can use macros in Zammad to automate recurring sequences, saving time (and nerves). This allows a combined sequence of actions on the ticket to be executed with just one click.",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ObjectManagerAttribute=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("ObjectManagerAttribute","name","object","display","active","editable","data_type","data_option","screens","position"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/object_manager_attributes",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"display",display:"Display",tag:"input",type:"text",limit:100,"null":!1},{name:"object",display:"Object",tag:"input",readonly:1},{name:"position",display:"Position",tag:"input",readonly:1},{name:"active",display:"Active",tag:"active","default":!0},{name:"data_type",display:"Format",tag:"object_manager_attribute","null":!1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.OnlineNotification=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("OnlineNotification","name","seen"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/online_notifications",e.play=function(t){var e;if(t)(e=new Audio("assets/sounds/"+t)).play();else if(App.Session.get("preferences")&&App.OnlineNotification.soundEnabled()&&(!(e=App.Config.get("latest_online_notification_sond"))||e.ended))return t=App.OnlineNotification.soundFile(),e=new Audio("assets/sounds/"+t),App.Config.set("latest_online_notification_sond",e),e.play()},e.soundEnabled=function(){var t;return!!(t=App.Session.get("preferences"))&&(t.notification_sound||(t.notification_sound={}),void 0===t.notification_sound.enabled&&(t.notification_sound.enabled=!0),"false"!==t.notification_sound.enabled.toString())},e.soundFile=function(){var t,e;return t="Xylo.mp3",(e=App.Session.get("preferences"))&&e.notification_sound&&e.notification_sound.file?e.notification_sound.file:t},e.seen=function(t,e){var n,i,s,r,o;for(o=[],n=0,i=(r=App.OnlineNotification.all()).length;n<i;n++)(s=r[n]).object===t&&s.o_id.toString()===e.toString()&&!0!==s.seen?(s.seen=!0,o.push(s.save())):o.push(void 0);return o},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Organization=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Organization","name","shared","note","member_ids","active","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/organizations",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1,info:!0},{name:"shared",display:"Shared organization",tag:"boolean",note:"Customers in the organization can view each other items.",type:"boolean","default":!0,"null":!1,info:!1},{name:"created_by_id",display:"Created by",relation:"User",readonly:1,info:!1},{name:"created_at",display:"Created at",tag:"datetime",readonly:1,info:!1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1,info:!1},{name:"updated_at",display:"Updated at",tag:"datetime",readonly:1,info:!1}],e.configure_clone=!0,e.configure_overview=["name","shared"],e.description='Using **Organisations** you can **group** customers. This has among others two important benefits:\n\n1. As an **Agent** you do not only have an overview of the open tickets for one person but an **overview over their whole organisation**.\n2. As a **Customer** you can also check the **Tickets which your colleagues created** and modify their tickets (if your organization is set to "shared", which can be defined per organization).',e.prototype.uiUrl=function(){return"#organization/profile/"+this.id},e.prototype.icon=function(){return"organization"},e._fillUp=function(t){var e,n,i,s,r;if(t.member_ids)for(t.members=[],e=0,n=(i=t.member_ids).length;e<n;e++)r=i[e],App.User.exists(r)&&(s=App.User.findNative(r),t.members.push(s));return t},e.prototype.searchResultAttributes=function(){return{display:""+this.displayName(),id:this.id,"class":"organization organization-popover",url:this.uiUrl(),icon:"organization"}},e.prototype.activityMessage=function(t){return"create"===t.type?App.i18n.translateContent("%s created Organization |%s|",t.created_by.displayName(),t.title):"update"===t.type?App.i18n.translateContent("%s updated Organization |%s|",t.created_by.displayName(),t.title):"Unknow action for ("+this.objectDisplayName()+"/"+t.type+"), extend activityMessage() of model."},e}(App.Model)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Overview=function(t){function e(){return this.prevTicket=n(this.prevTicket,this),this.nextTicket=n(this.nextTicket,this),this.indexOf=n(this.indexOf,this),this.tickets=n(this.tickets,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.configure("Overview","name","prio","condition","order","group_by","group_direction","view","user_ids","organization_shared","out_of_office","role_ids","active"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/overviews",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"link",display:"Link",readonly:1},{name:"role_ids",display:"Available for the following roles",tag:"column_select",multiple:!0,"null":!1,relation:"Role",translate:!0},{name:"user_ids",display:"Restrict to only the following users",tag:"column_select",multiple:!0,"null":!0,relation:"User",sortBy:"firstname"},{name:"organization_shared",display:"Only available for Users with shared Organization",tag:"select",options:{"true":"yes","false":"no"},"default":!1,"null":!0},{name:"out_of_office",display:"Only available for Users which are replacements for other users.",tag:"select",options:{"true":"yes","false":"no"},"default":!1,"null":!0},{name:"condition",display:"Conditions for shown Tickets",tag:"ticket_selector","null":!1,out_of_office:!0},{name:"prio",display:"Prio",readonly:1},{name:"view::s",display:"Attributes",tag:"checkboxTicketAttributes","default":["number","title","state","created_at"],"null":!1,translate:!0},{name:"order::by",display:"Order",tag:"selectTicketAttributes","default":"created_at","null":!1,translate:!0},{name:"order::direction",display:"Order by Direction",tag:"select","default":"down","null":!1,translate:!0,options:{ASC:"up",DESC:"down"}},{name:"group_by",display:"Group by",tag:"select","default":"","null":!0,nulloption:!0,translate:!0,options:{customer:"Customer",state:"State",priority:"Priority",group:"Group",owner:"Owner"}},{name:"group_direction",display:"Group by Direction",tag:"select","default":"down","null":!1,translate:!0,options:{ASC:"up",DESC:"down"}},{name:"active",display:"Active",tag:"active","default":!0},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e.configure_delete=!0,e.configure_clone=!0,e.configure_overview=["name","link","role_ids"],e.description="You can create **overviews** for your agents and your customers. These could for instance serve as a sort of work list for items for which your agents would work.\n\nYou can also create overviews and limit them to specific agents or to groups of agents.",e.prototype.uiUrl=function(){return"#ticket/view/"+this.link},e.prototype.tickets=function(){return App.OverviewListCollection.get(this.link).tickets},e.prototype.indexOf=function(e){return isNaN(e)||(e=App.Ticket.find(e)),_.findIndex(this.tickets(),function(t){return t.id===e.id})},e.prototype.nextTicket=function(t){var e;return 0<=(e=this.indexOf(t))?this.tickets()[e+1]:void 0},e.prototype.prevTicket=function(t){return this.tickets()[this.indexOf(t)-1]},e.groupByAttributes=function(){var t,e,n,i;for(n in e={},i=App.Ticket.attributesGet())t=i[n],n.match(/(_at|_no)$/)||"datetime"===t.tag||"number"===n||"tags"===n||(e[n=n.replace(/_(id|ids)$/,"")]=t.display);return e},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Permission=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Permission","name","note","active"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/permissions",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.PostmasterFilter=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("PostmasterFilter","name","channel","match","perform","note","active","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/postmaster_filters",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:250,"null":!1},{name:"channel",display:"Channel",type:"input",readonly:1},{name:"match",display:"Match all of the following",tag:"postmaster_match",note:'You can use regular expression by using "regex:your_reg_exp".'},{name:"perform",display:"Perform action of the following",tag:"postmaster_set"},{name:"note",display:"Note",tag:"textarea",limit:250,"null":!0},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1},{name:"active",display:"Active",tag:"active","default":!0},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e.configure_delete=!0,e.configure_overview=["name"],e.configure_clone=!0,e.on("create",function(t){return t.channel="email"}),e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.RecentView=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("RecentView","name"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/recent_view",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ReportProfile=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("ReportProfile","name","condition","active"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/report_profiles",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"condition",display:"Filter",tag:"ticket_selector","null":!0},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1},{name:"active",display:"Active",tag:"active","default":!0}],e.configure_delete=!0,e.configure_clone=!0,e.configure_overview=["name"],e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Role=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Role","name","permission_ids","group_ids","default_at_signup","note","active","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/roles",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"permission_ids",display:"Permissions",tag:"permission",item_class:"checkbox"},{name:"default_at_signup",display:"Default at Signup",tag:"boolean","default":!1,translate:!0},{name:"note",display:"Note",tag:"textarea",note:"Notes are visible to agents only, never to customers.",limit:250,"null":!0},{name:"active",display:"Active",tag:"active","default":!0},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e.configure_clone=!0,e.configure_overview=["name","default_at_signup"],e.prototype.activityMessage=function(t){return"create"===t.type?App.i18n.translateContent("%s created Role |%s|",t.created_by.displayName(),t.title):"update"===t.type?App.i18n.translateContent("%s updated Role |%s|",t.created_by.displayName(),t.title):"Unknow action for ("+this.objectDisplayName()+"/"+t.type+"), extend activityMessage() of model."},e._fillUp=function(t){var e,n,i,s,r;if(t.permission_ids)for(t.permissions=[],e=0,n=(r=t.permission_ids).length;e<n;e++)s=r[e],App.Permission.exists(s)&&(i=App.Permission.findNative(s),t.permissions.push(i));return t},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Setting=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Setting","name","state_current"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/settings",e.get=function(t){var e;if(!(e=App.Setting.findByAttribute("name",t)))throw"No such setting '"+t+"' found!";return e.state_current.value},e.set=function(t,e,n){var i;if(null==n&&(n={}),!(i=App.Setting.findByAttribute("name",t)))throw"No such setting '"+t+"' found!";return i.state_current.value=e,n.done||(n.done=function(){if(n.notify&&App.Event.trigger("notify",{type:"success",msg:App.i18n.translateContent("Update successful!"),timeout:2e3}),App.Setting.preferencesPost(this),n.doneLocal)return n.doneLocal(this)}),n.fail||(n.fail=function(t,e){if(App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to update object!"),timeout:2e3}),n.failLocal)return n.failLocal(this)}),i.frontend&&App.Config.set(t,e),i.save(n)},e.preferencesPost=function(t){var e,n,i,s,r,o,a;if(t.preferences&&(t.preferences.render&&((e=t.preferences).trigger||(e.trigger=[]),t.preferences.trigger.push("ui:rerender")),!_.isEmpty(t.preferences.trigger))){for(s=t.preferences.trigger,_.isArray(t.preferences.trigger)||(s=[t.preferences.trigger]),a=[],r=n=0,o=s.length;r<o;r++)i=s[r],n+=1,a.push(function(t,e){var n;return n=function(){return App.Event.trigger(t)},App.Delay.set(n,300*e)}(i,n));return a}},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Signature=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Signature","name","body","note","active","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/signatures",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"body",display:"Text",tag:"richtext",
limit:500,"null":!0,plugins:[{controller:"WidgetPlaceholder",params:{objects:[{prefix:"ticket",object:"Ticket",display:"Ticket"},{prefix:"user",object:"User",display:"Current User"}]}}]},{name:"note",display:"Note",tag:"textarea",note:"Notes are visible to agents only, never to customers.",limit:250,"null":!0},{name:"active",display:"Active",tag:"active","default":!0},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e.configure_overview=["name"],e.configure_clone=!0,e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Sla=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Sla","name","first_response_time","update_time","solution_time","condition","calendar_id"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/slas",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"condition",display:"Ticket Selector",tag:"ticket_selector","null":!1,note:"Create rules that single out the tickets for the Service Level Agreement."},{name:"calendar_id",display:"Calendar",tag:"select",relation:"Calendar","null":!1},{name:"sla_times",display:"SLA Times",tag:"sla_times","null":!0},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1},{name:"first_response_time","null":!1,skipRendering:!0,required_if:{first_response_time_enabled:["on"]}},{name:"update_time","null":!1,skipRendering:!0,required_if:{update_time_enabled:["on"]}},{name:"solution_time","null":!1,skipRendering:!0,required_if:{solution_time_enabled:["on"]}}],e.configure_delete=!0,e.configure_overview=["name"],e.description="** Service Level Agreements **, abbreviated ** SLAs **, help you to meet certain customers' time-related responses. Thus, for example, you can say customers should always get a response from you after 8 hours at the latest. In the event of an imminent violation or a breach, Zammad will alert you to such events.\n\nIt can be ** response time ** (time between the creation of a ticket and the first reaction of an agent), ** update time ** (time between a customer's request and an agent's reaction) and ** solution time ** (time between creation and closing a ticket ) To be defined.\n\nAny violations are displayed in a separate view in the overviews. You can also configure ** e-mail notifications **.",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.StatsStore=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("StatsStore","name","state"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/stats_store",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Taskbar=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Taskbar","key","client_id","callback","state","params","prio","notify","active","attachments","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/taskbar",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Template=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Template","name","options","group_ids","user_id","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/templates",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TextModule=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("TextModule","name","keywords","content","active","group_ids","user_id","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/text_modules",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"keywords",display:"Keywords",tag:"input",type:"text",limit:100,"null":!0},{name:"content",display:"Content",tag:"richtext",limit:2e3,"null":!1,plugins:[{controller:"WidgetPlaceholder",params:{objects:[{prefix:"ticket",object:"Ticket",display:"Ticket"},{prefix:"user",object:"User",display:"Current User"}]}}],note:'To select placeholders from a list, just enter "::".'},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1},{name:"group_ids",display:"Groups",tag:"column_select",relation:"Group","null":!0},{name:"active",display:"Active",tag:"active","default":!0}],e.configure_delete=!0,e.configure_clone=!0,e.configure_overview=["name","keywords","content","group_ids"],e.description='Create Text Modules to **spend less time writing responses**. Text Modules can include smart variables like the users name or email address.\n\nExamples of snippets are:\n\n* Hello Mrs. #{ticket.customer.lastname},\n* Hello Mr. #{ticket.customer.lastname},\n* Hello #{ticket.customer.firstname},\n* My Name is #{user.firstname},\n\nOf course you can also use multi line snippets.\n\nAvailable objects are:\n* ticket (e. g. ticket.state, ticket.group)\n* ticket.customer (e. g. ticket.customer.firstname, ticket.customer.lastname)\n* ticket.owner (e. g. ticket.owner.firstname, ticket.owner.lastname)\n* ticket.organization (e. g. ticket.organization.name)\n* user (e. g. user.firstname, user.email)\n\nTo select placeholders from a list, just enter "::".\n',e}(App.Model)}.call(this),function(){var extend=function(t,e){function n(){this.constructor=t}for(var i in e)hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;App.Ticket=function(superClass){function Ticket(){return Ticket.__super__.constructor.apply(this,arguments)}return extend(Ticket,superClass),Ticket.configure("Ticket","number","title","group_id","owner_id","customer_id","state_id","priority_id","article","tags","links","updated_at","preferences"),Ticket.extend(Spine.Model.Ajax),Ticket.url=Ticket.apiPath+"/tickets",Ticket.configure_attributes=[{name:"number",display:"#",tag:"input",type:"text",limit:100,"null":!0,readonly:1,width:"68px"},{name:"title",display:"Title",tag:"input",type:"text",limit:100,"null":!1},{name:"customer_id",display:"Customer",tag:"input",type:"text",limit:100,"null":!1,autocapitalize:!1,relation:"User"},{name:"organization_id",display:"Organization",tag:"select",relation:"Organization",readonly:1},{name:"group_id",display:"Group",tag:"select",multiple:!1,limit:100,"null":!1,relation:"Group",width:"10%",edit:!0},{name:"owner_id",display:"Owner",tag:"select",multiple:!1,limit:100,"null":!0,relation:"User",width:"12%",edit:!0},{name:"state_id",display:"State",tag:"select",multiple:!1,"null":!1,relation:"TicketState","default":"new",width:"12%",edit:!0,customer:!0},{name:"pending_time",display:"Pending till",tag:"datetime","null":!0,width:"130px"},{name:"priority_id",display:"Priority",tag:"select",multiple:!1,"null":!1,relation:"TicketPriority","default":"2 normal",width:"54px",edit:!0,customer:!0},{name:"article_count",display:"Article#",readonly:1,width:"12%"},{name:"time_unit",display:"Accounted Time",readonly:1,width:"12%"},{name:"escalation_at",display:"Escalation at",tag:"datetime","null":!0,readonly:1,width:"110px","class":"escalation"},{name:"last_contact_at",display:"Last contact",tag:"datetime","null":!0,readonly:1,width:"110px"},{name:"last_contact_agent_at",display:"Last contact (agent)",tag:"datetime","null":!0,readonly:1,width:"110px"},{name:"last_contact_customer_at",display:"Last contact (customer)",tag:"datetime","null":!0,readonly:1,width:"110px"},{name:"first_response_at",display:"First response",tag:"datetime","null":!0,readonly:1,width:"110px"},{name:"close_at",display:"Closing time",tag:"datetime","null":!0,readonly:1,width:"110px"},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created at",tag:"datetime",width:"110px",align:"right",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated at",tag:"datetime",width:"110px",align:"right",readonly:1}],Ticket.prototype.uiUrl=function(){return"#ticket/zoom/"+this.id},Ticket.prototype.priorityIcon=function(){var t;return(t=App.TicketPriority.findNative(this.priority_id))&&t.ui_icon&&t.ui_color?App.Utils.icon(t.ui_icon,"u-"+t.ui_color+"-color"):""},Ticket.prototype.priorityClass=function(){var t;return(t=App.TicketPriority.findNative(this.priority_id))&&t.ui_color?"item--"+t.ui_color:""},Ticket.prototype.rowClass=function(){return this.priorityClass()},Ticket.prototype.getState=function(){var t,e,n;return n=App.TicketState.findNative(this.state_id),t="closed","new"===(e=App.TicketStateType.findNative(n.state_type_id)).name||"open"===e.name?(t="open",this.escalation_at&&new Date(Date.parse(this.escalation_at))<new Date&&(t="escalating")):"pending reminder"===e.name?(t="pending",this.pending_time&&new Date(Date.parse(this.pending_time))<new Date&&(t="open")):"pending action"===e.name&&(t="pending"),t},Ticket.prototype.icon=function(){return"task-state"},Ticket.prototype.iconClass=function(){return this.getState()},Ticket.prototype.iconTitle=function(){var t;return t=App.TicketState.findNative(this.state_id),"pending reminder"===App.TicketStateType.findNative(t.state_type_id).name&&this.pending_time&&new Date(Date.parse(this.pending_time))<new Date?App.i18n.translateInline(t.displayName())+" - "+App.i18n.translateInline("reached"):this.escalation_at&&new Date(Date.parse(this.escalation_at))<new Date?App.i18n.translateInline(t.displayName())+" - "+App.i18n.translateInline("escalated"):App.i18n.translateInline(t.displayName())},Ticket.prototype.iconTextClass=function(){return"task-state-"+this.getState()+"-color"},Ticket.prototype.iconActivity=function(t){if(t)return this.owner_id===t.id?"important":""},Ticket.prototype.searchResultAttributes=function(){return{display:"#"+this.number+" - "+this.title,id:this.id,"class":"task-state-"+this.getState()+" ticket-popover",url:this.uiUrl(),icon:"task-state",iconClass:this.getState()}},Ticket.prototype.activityMessage=function(t){if(t)return"create"===t.type?App.i18n.translateContent("%s created Ticket |%s|",t.created_by.displayName(),t.title):"update"===t.type?App.i18n.translateContent("%s updated Ticket |%s|",t.created_by.displayName(),t.title):"reminder_reached"===t.type?App.i18n.translateContent("Pending reminder reached for Ticket |%s|",t.title):"escalation"===t.type?App.i18n.translateContent("Ticket |%s| is escalated!",t.title):"escalation_warning"===t.type?App.i18n.translateContent("Ticket |%s| will escalate soon!",t.title):"Unknow action for ("+this.objectDisplayName()+"/"+t.type+"), extend activityMessage() of model."},Ticket.macro=function(i){var e,n,t,s,r,o,a,l,c,p,u;for(r in a=[],o=i.macro)s=o[r],"ticket"===(t=r.split("."))[0]?"tags"===t[1]?(p=s.value.split(","),a.push(function(){var t,e,n;for(n=[],t=0,e=p.length;t<e;t++)c=p[t],"remove"===s.operator?i.callback&&i.callback.tagRemove?n.push(i.callback.tagRemove(c)):n.push(this.tagRemove(i.ticket.id,c)):i.callback&&i.callback.tagAdd?n.push(i.callback.tagAdd(c)):n.push(this.tagAdd(i.ticket.id,c));return n}.call(this))):"owner_id"===t[1]&&"current_user.id"===s.pre_condition?a.push(i.ticket[t[1]]=App.Session.get("id")):a.push(i.ticket[t[1]]=s.value):"article"===t[0]?(t[1]&&(u=App.TicketArticleType.findByAttribute("name",t[1]))&&(i.article.type_id=u.id),s.sender_id||(l=App.TicketArticleSender.findByAttribute("name","Agent"))&&(s.sender_id=l.id),s.from||(s.from=App.Session.get("login")),a.push(function(){var t;for(n in t=[],s)e=s[n],t.push(i.article[n]=e);return t}())):a.push(void 0);return a},Ticket.selector=function(t,e){var n,i,s,r,o,a;if(_.isEmpty(e))return!0;for(r in e)if(i=e[r],o=(a=r.split("."))[0],n=a[1],"article.subject"!==r||t.article.subject||(o="ticket",n="title"),"article.created_by_id"!==r||t.article.created_by_id||(t.article.created_by_id=App.Session.get("id")),s="ticket"===o?t:t[o]||{},!this._selectorMatch(s,o,n,i))return!1;return!0},Ticket._selectorConditionDate=function(condition,operator){var conditionValue;if("+"===operator||"-"===operator)return conditionValue=new Date,"minute"===condition.range?conditionValue.setTime(eval(conditionValue.getTime()+operator+6e4)):"hour"===condition.range?conditionValue.setTime(eval(conditionValue.getTime()+operator+36e5)):"day"===condition.range?conditionValue.setTime(eval(conditionValue.getTime()+operator+864e5)):"month"===condition.range?conditionValue.setTime(eval(conditionValue.getTime()+operator+108e6)):"year"===condition.range&&conditionValue.setTime(eval(conditionValue.getTime()+operator+1314e6)),conditionValue},Ticket._selectorMatch=function(t,e,n,i){var s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T;for(y in void 0===(o=i.value)&&(o=""),void 0===(w=t[n])&&(w=""),i.pre_condition&&(r=(k=i.pre_condition.split("."))[0],s=k[1],"current_user"===r?o=App.Session.get(s):"not_set"===i.pre_condition&&(o="")),a=new RegExp(App.Utils.escapeRegExp(o.toString()),"i"),_.isArray(w)||(w=[w]),_.isArray(o)||(o=[o]),T=!1,w)for(g in b=w[y],o)if(v=o[g],"contains"===i.operator)w.toString().match(a)&&(T=!0);else if("contains not"===i.operator)w.toString().match(a)||(T=!0);else if("contains all"===i.operator)for(T=!0,l=0,h=o.length;l<h;l++)v=o[l],_.contains(w,v)||(T=!1);else if("contains one"===i.operator)for(T=!1,c=0,d=o.length;c<d;c++)v=o[c],_.contains(w,v)&&(T=!0);else if("contains all not"===i.operator)for(T=!0,p=0,f=w.length;p<f;p++)b=w[p],_.contains(o,b)&&(T=!1);else if("contains one not"===i.operator)for(T=!1,u=0,m=w.length;u<m;u++)b=w[u],_.contains(o,b)||(T=!0);else if("is"===i.operator)w.toString().trim().toLowerCase()===v.toString().trim().toLowerCase()&&(T=!0);else if("is not"===i.operator)w.toString().trim().toLowerCase()!==v.toString().trim().toLowerCase()&&(T=!0);else if("after (absolute)"===i.operator)new Date(w.toString())>new Date(v.toString())&&(T=!0);else if("before (absolute)"===i.operator)new Date(w.toString())<new Date(v.toString())&&(T=!0);else if("before (relative)"===i.operator)v=this._selectorConditionDate(i,"-"),new Date(w.toString())<new Date(v.toString())&&(T=!0);else if("within last (relative)"===i.operator)v=this._selectorConditionDate(i,"-"),new Date(w.toString())<new Date&&new Date(w.toString())>new Date(v.toString())&&(T=!0);else if("after (relative)"===i.operator)v=this._selectorConditionDate(i,"+"),new Date(w.toString())>new Date(v.toString())&&(T=!0);else{if("within next (relative)"!==i.operator)throw"Unknown operator: "+i.operator;v=this._selectorConditionDate(i,"+"),new Date(w.toString())>new Date&&new Date(w.toString())<new Date(v.toString())&&(T=!0)}return T},Ticket.prototype.editable=function(t){var e,n,i,s;if(null==t&&(t="change"),null==(s=App.User.current()))return!1;if(s.id===this.customer_id)return!0;if(s.organization_id&&this.organization_id&&s.organization_id===this.organization_id)return!0;if(!this.group_id)return!1;for(n=0,i=(e=s.allGroupIds(t)).length;n<i;n++)if(e[n].toString()===this.group_id.toString())return!0;return!1},Ticket}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketArticle=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("TicketArticle","from","to","cc","subject","body","content_type","ticket_id","type_id","sender_id","internal","in_reply_to","form_id","subtype","time_unit","preferences","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/ticket_articles",e.configure_attributes=[{name:"ticket_id",display:"TicketID","null":!1,readonly:1,searchable:!1},{name:"from",display:"From",tag:"input",type:"text",limit:100,"null":!1},{name:"to",display:"To",tag:"input",type:"text",limit:100,"null":!0},{name:"cc",display:"Cc",tag:"input",type:"text",limit:100,"null":!0},{name:"subject",display:"Subject",tag:"input",type:"text",limit:100,"null":!0},{name:"body",display:"Text",tag:"textarea",rows:5,limit:100,"null":!1,searchable:!0},{name:"type_id",display:"Type",tag:"select",multiple:!1,"null":!1,relation:"TicketArticleType","default":""},{name:"sender_id",display:"Sender",tag:"select",multiple:!1,"null":!1,relation:"TicketArticleSender","default":""},{name:"internal",display:"Visibility",tag:"radio","default":!1,"null":!0,options:{"true":"internal","false":"public"}},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1,searchable:!1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1,searchable:!1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1,searchable:!1}],e.prototype.uiUrl=function(){return"#ticket/zoom/"+this.ticket_id+"/"+this.id},e.prototype.objectDisplayName=function(){return"Article"},e.prototype.displayName=function(){var t;return this.subject?this.subject:(App.Ticket.exists(this.ticket_id)&&(t=App.Ticket.findNative(this.ticket_id)),t?t.title:"???")},e.prototype.iconActivity=function(t){if(t)return App.Ticket.findNative(this.ticket_id).owner_id===t.id?"important":""},e.prototype.activityMessage=function(t){if(t)return"create"===t.type?App.i18n.translateContent("%s created Article for |%s|",t.created_by.displayName(),t.title):"update"===t.type?App.i18n.translateContent("%s updated Article for |%s|",t.created_by.displayName(),t.title):"Unknow action for ("+this.objectDisplayName()+"/"+t.type+"), extend activityMessage() of model."},e.contentAttachments=function(t){var e,n,i,s,r;if(!t)return[];if(!t.attachments)return[];for(n=[],i=0,s=(r=t.attachments).length;i<s;i++)(e=r[i])&&(!e.preferences||e.preferences&&!0!==e.preferences["original-format"])&&n.push(e);return n},e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketArticleSender=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("TicketArticleSender","name","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/ticket_article_senders",e.configure_translate=!0,e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketArticleType=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("TicketArticleType","name","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/ticket_article_types",e.configure_translate=!0,e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketPriority=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("TicketPriority","name","note","active","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/ticket_priorities",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1,translate:!0},{name:"active",display:"Active",tag:"active","default":!0},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1}],e.configure_translate=!0,e.configure_overview=["name"],e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketState=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("TicketState","name","note","active"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/ticket_states",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1,translate:!0},{name:"active",display:"Active",tag:"active","default":!0},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1}],e.configure_translate=!0,e.configure_overview=["name"],e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketStateType=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("TicketStateType","name","note","active","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/ticket_state_types",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Translation=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Translation","source","target","target_initial","locale"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/translations",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Trigger=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Trigger","name","condition","perform","active"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/triggers",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"condition",display:"Conditions for effected objects",tag:"ticket_selector","null":!1,preview:!1,action:!0,hasChanged:!0,executionTime:!0},{name:"perform",display:"Execute changes on objects",tag:"ticket_perform_action","null":!0,notification:!0,trigger:!0},{name:"active",display:"Active",tag:"active","default":!0},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],e.configure_delete=!0,e.configure_clone=!0,e.configure_overview=["name"],e.description="Every time a customer creates a new ticket, they automatically receive a confirmation email to assure them that their issue has been submitted successfully. This behavior is built into Zammad, but it\u2019s also highly customizable, and you can set up other automated actions just like it.\n\nMaybe you want to set a higher priority on any ticket with the word \u201curgent\u201d in the title. Maybe you want to avoid sending auto-reply emails to customers from certain organizations. Maybe you want mark a ticket as \u201cpending\u201d whenever someone adds an internal note to a ticket.\n\nWhatever it is, you can do it with triggers: actions that watch tickets for certain changes, and then fire off whenever those changes occur.",e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Twitter=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("Twitter","name","channels"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/twitter",e.configure_attributes=[{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1}],e.configure_delete=!0,e.configure_overview=["name"],e}(App.Model)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.User=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.configure("User","login","firstname","lastname","email","web","password","phone","fax","mobile","street","zip","city","country","organization_id","department","note","role_ids","group_ids","active","invite","signup","updated_at"),e.extend(Spine.Model.Ajax),e.url=e.apiPath+"/users",e.configure_attributes=[{name:"login",display:"Login",tag:"input",type:"text",limit:100,"null":!1,autocapitalize:!1,signup:!1,quick:!1},{name:"firstname",display:"Firstname",tag:"input",type:"text",limit:100,"null":!1,signup:!0,info:!0,invite_agent:!0,invite_customer:!0},{name:"lastname",display:"Lastname",tag:"input",type:"text",limit:100,"null":!1,signup:!0,info:!0,invite_agent:!0,invite_customer:!0},{name:"email",display:"Email",tag:"input",type:"email",limit:100,"null":!1,signup:!0,info:!0,invite_agent:!0,invite_customer:!0},{name:"organization_id",display:"Organization",tag:"select",multiple:!1,nulloption:!0,"null":!0,relation:"Organization",signup:!1,info:!0,invite_customer:!0},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created at",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated at",tag:"datetime",readonly:1}],e.configure_overview=["login","firstname","lastname","organization"],e.prototype.uiUrl=function(){return"#user/profile/"+this.id},e.prototype.icon=function(){return"user"},e.prototype.initials=function(){return this.firstname&&this.lastname&&this.firstname[0]&&this.lastname[0]?this.firstname[0]+this.lastname[0]:this.firstname&&this.firstname[0]&&!this.lastname?this.firstname[1]?this.firstname[0]+this.firstname[1]:this.firstname[0]:!this.firstname&&this.lastname&&this.lastname[0]?this.lastname[1]?this.lastname[0]+this.lastname[1]:this.lastname[0]:this.email?this.email[0]+this.email[1]:"??"},e.prototype.avatar=function(t,e,n,i,s,r){var o,a,l,c,p,u,h,d;return null==t&&(t=40),null==e&&(e=""),null==n&&(n=""),null==i&&(i=!1),null==r&&(r=void 0),o=40,n&&(n+=" "),n+="size-"+(t=parseInt(t,10)),!1===this.active&&(n+=" avatar--inactive"),this.isOutOfOffice()&&(n+=" avatar--vacation"),e&&(e=" data-placement='"+e+"'"),s?(p=!1,a=' data-avatar-id="'+s.id+'"'):("personal"===r?p=!1:n+=" user-popover",a=' data-id="'+this.id+'"'),p=this.vip,"personal"===r?p=!1:n+=" user-popover",1===this.id?App.view("avatar_system")():!this.image||"none"===this.image||i?(u=300*t/o,l=226*t/o,h=(c=new Math.seedrandom(this.id))()*(u-t),d=c()*(l-t),App.view("avatar_unique")({data:a,cssClass:n,placement:e,vip:p,x:h,y:d,initials:this.initials()})):App.view("avatar")({data:a,cssClass:n,placement:e,vip:p,url:this.imageUrl(),initials:this.initials()})},e.prototype.isOutOfOffice=function(){var t,e,n;return!0===this.out_of_office&&(!!(n=this.out_of_office_start_at)&&(!!(t=this.out_of_office_end_at)&&(n=new Date(Date.parse(n)),t=new Date(Date.parse(t)),(e=new Date((new Date).toDateString())).setDate(e.getDate()+1),n<=e&&e<=t)))},e.prototype.imageUrl=function(){if(this.image)return this.constructor.apiPath+"/users/image/"+this.image},e._fillUp=function(t){var e,n,i,s,r,o,a,l,c,p,u;if(t.accounts)for(e in t.accounts)"twitter"===e&&(t.accounts[e].link="https://twitter.com/"+t.accounts[e].username),"facebook"===e&&(t.accounts[e].link="https://www.facebook.com/profile.php?id="+t.accounts[e].uid);if(t.organization_id&&(t.organization=App.Organization.findNative(t.organization_id)),t.role_ids)for(t.roles=[],s=0,o=(l=t.role_ids).length;s<o;s++)u=l[s],App.Role.exists(u)&&(p=App.Role.findNative(u),t.roles.push(p));if(t.group_ids)for(t.groups=[],r=0,a=(c=t.group_ids).length;r<a;r++)i=c[r],App.Group.exists(i)&&(n=App.Group.findNative(i),t.groups.push(n));return t},e.prototype.searchResultAttributes=function(){return{display:""+this.displayName(),id:this.id,"class":"user user-popover",url:this.uiUrl(),icon:"user"}},e.prototype.activityMessage=function(t){var e;return"create"===t.type?App.i18n.translateContent("%s created User |%s|",t.created_by.displayName(),t.title):"update"===t.type?App.i18n.translateContent("%s updated User |%s|",t.created_by.displayName(),t.title):"session started"===t.type?App.i18n.translateContent("%s started a new session",t.created_by.displayName()):"switch to"===t.type?(e=t.title,t.objectNative&&(e=t.objectNative.displayName()),App.i18n.translateContent("%s switched to |%s|!",t.created_by.displayName(),e)):"ended switch to"===t.type?(e=t.title,t.objectNative&&(e=t.objectNative.displayName()),App.i18n.translateContent("%s ended switch to |%s|!",t.created_by.displayName(),e)):"Unknow action for ("+this.objectDisplayName()+"/"+t.type+"), extend activityMessage() of model."},e.prototype.permission=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T,A,S,C,x,j,P;if(r=t,_.isArray(t)||(r=[t]),_.contains(r,"*"))return!0;for(n=0,a=r.length;n<a;n++)if(t=r[n],(b=App.Permission.findByAttribute("name",t))&&!1===b.active)return!1;for(T={},i=0,l=(A=this.role_ids).length;i<l;i++)if(P=A[i],!0===(j=App.Role.findNative(P)).active)for(s=0,c=(S=j.permission_ids).length;s<c;s++){if(w=S[s],!(b=App.Permission.findNative(w)))throw"No such permission for id "+w;!0===b.active&&(T[b.name]=!0)}for(o=0,p=r.length;o<p;o++){for(e=!1,m=0,u=(x=r[o].split("+")).length;m<u;m++){if(f=!1,v="","*"===(y=(C=x[m]).split("."))[y.length-1])for(k in T)!0===T[k]&&(d=C.length-1,k.substr(0,d)===C.substr(0,d)&&(f=!0));if(!f)for(g=0,h=y.length;g<h;g++)""!==v&&(v+="."),T[v+=y[g]]&&(f=!0);if(!f){e=!1;break}e=!0}if(e)return e}return!1},e.prototype.allGroupIds=function(t){var e,n,i,s,r,o,a,l,c,p;if(null==t&&(t="full"),e=[],c=App.Session.get("group_ids"))for(s in c)r=c[s],(_.include(r,t)||_.include(r,"full"))&&e.push(s);if(p=App.Session.get("role_ids"))for(n=0,i=p.length;n<i;n++)if(l=p[n],App.Role.exists(l)&&(a=App.Role.findNative(l)).group_ids)for(s in o=a.group_ids)r=o[s],(_.include(r,t)||_.include(r,"full"))&&e.push(s);return _.uniq(e)},e.outOfOfficeTextPlaceholder=function(){var t,e;return e=new Date,t=App.i18n.translateContent("Christmas holiday"),e.getMonth()<3?t=App.i18n.translateContent("Easter holiday"):e.getMonth()<9&&(t=App.i18n.translateContent("Summer holiday")),t},e.prototype.outOfOfficeText=function(){return _.isEmpty(this.preferences.out_of_office_text)?App.User.outOfOfficeTextPlaceholder():this.preferences.out_of_office_text},e.prototype.isAccessibleBy=function(t,e){return!!t.permission("admin")||this["is"+(e.charAt(0).toUpperCase()+e.slice(1))+"ableBy"](t)},e.prototype.isReadableBy=function(t){return!!this.ownAccount(t)||(!!t.permission("admin.*")||(!!t.permission("ticket.agent")||!!t.permission("ticket.customer")&&("function"==typeof this.sameOrganization?this.sameOrganization(t):void 0)))},e.prototype.isChangeableBy=function(t){return!!t.permission("admin.user")||!!t.permission("ticket.agent")&&this.permission("ticket.customer")},e.prototype.isDeleteableBy=function(t){return t.permission("admin.user")},e.prototype.ownAccount=function(t){return this.id===t.id},e.prototype.sameOrganization=function(t){return null!==this.organization_id&&(null!==t.organization_id&&this.organization_id===t.organization_id)},e.current=App.Session.get,e}(App.Model)}.call(this),function(){var i=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Controller=function(t){function s(t){var n;this.locationExecute=i(this.locationExecute,this),this.locationExecuteOrNavigate=i(this.locationExecuteOrNavigate,this),this.locationVerify=i(this.locationVerify,this),this.stopLoading=i(this.stopLoading,this),this.startLoading=i(this.startLoading,this),this.recentView=i(this.recentView,this),this.frontendTimeUpdateItem=i(this.frontendTimeUpdateItem,this
),this.frontendTimeUpdateElement=i(this.frontendTimeUpdateElement,this),this.frontendTimeUpdate=i(this.frontendTimeUpdate,this),this.closeTab=i(this.closeTab,this),this.updateNavMenu=i(this.updateNavMenu,this),this.abortAjaxCalls=i(this.abortAjaxCalls,this),this.releaseController=i(this.releaseController,this),this.interval=i(this.interval,this),this.clearInterval=i(this.clearInterval,this),this.delay=i(this.delay,this),this.clearDelay=i(this.clearDelay,this),this.unbind=i(this.unbind,this),this.one=i(this.one,this),this.bind=i(this.bind,this),t&&t.el&&t.el.unbind&&t.el.unbind(),s.__super__.constructor.apply(this,arguments),this.controllerId="controller-"+(new Date).getTime()+"-"+Math.floor(999999*Math.random()),this.el.on("remove",this.releaseController),this.el.on("remove",this.release),this.Config=App.Config,this.Session=App.Session,this.apiPath=this.Config.get("api_path"),this.ajaxCalls=[],this.ajax=(n=this,function(t){var e;return e=App.Ajax.request(t),n.ajaxCalls.push(e)})}return n(s,t),s.include(App.LogInclude),s.include(App.RenderScreen),s.prototype.navigate=function(t,e){var n,i;return null==e&&(e=!1),this.log("debug","navigate to '"+t+"', hide from history '"+e+"'"),e&&window.history&&(i=(n=App.Config.get("History"))[n.length-2])&&window.history.replaceState(null,null,i),s.__super__.navigate.call(this,t)},s.prototype.preventDefault=function(t){return t.preventDefault()},s.prototype.bind=function(t,e){return App.Event.bind(t,e,this.controllerId)},s.prototype.one=function(t,e){return App.Event.bind(t,e,this.controllerId,!0)},s.prototype.unbind=function(t,e){return App.Event.unbind(t,e,this.controllerId)},s.prototype.clearDelay=function(t){return App.Delay.clear(t,this.controllerId)},s.prototype.delay=function(t,e,n,i){return null==i&&(i=!1),App.Delay.set(t,e,n,this.controllerId,i)},s.prototype.clearInterval=function(t){return App.Interval.clear(t,this.controllerId)},s.prototype.interval=function(t,e,n,i){return null==i&&(i=!1),App.Interval.set(t,e,n,this.controllerId,i)},s.prototype.releaseController=function(){return App.Event.unbindLevel(this.controllerId),App.Delay.clearLevel(this.controllerId),App.Interval.clearLevel(this.controllerId),this.abortAjaxCalls()},s.prototype.abortAjaxCalls=function(){var t,e,n,i,s;if(this.ajaxCalls){for(n=this.ajaxCalls,this.ajaxCalls=[],s=[],e=0,i=n.length;e<i;e++)t=n[e],s.push(App.Ajax.abort(t));return s}},s.prototype.release=function(){return this.off(),this.stopListening()},s.prototype.title=function(t,e){var n,i;return null==e&&(e=!1),i=t,e&&(i=App.i18n.translatePlain(t)),n=this.Config.get("product_name")+" - "+i,document.title=n,App.Event.trigger("window-title-set",n)},s.prototype.copyToClipboard=function(t){return window.clipboardData?window.clipboardData.setData("Text",t):window.prompt("Copy to clipboard: Ctrl+C, Enter",t)},s.prototype.disconnectClient=function(){return App.Delay.reset(),App.Interval.reset(),App.WebSocket.close({force:!0})},s.prototype.notify=function(t){return App.Event.trigger("notify",t)},s.prototype.notifyDesktop=function(t){return App.Event.trigger("notifyDesktop",t)},s.prototype.navupdate=function(t,e){if(null==e&&(e=!1),e||"#clues"!==window.location.hash)return App.Event.trigger("navupdate",t)},s.prototype.navShow=function(){if(!$("#navigation").is(":visible"))return $("#navigation").removeClass("hide")},s.prototype.navHide=function(){if($("#navigation").is(":visible"))return $("#navigation").addClass("hide")},s.prototype.updateNavMenu=function(){var t;return t=function(){return App.Event.trigger("menu:render")},this.delay(t,150)},s.prototype.closeTab=function(t,e){if(null==t&&(t=this.taskKey),null!=t)return App.TaskManager.remove(t),null==e&&(e=App.TaskManager.nextTaskUrl()||"#"),this.navigate(e)},s.prototype.scrollTo=function(t,e,n){var i;return null==t&&(t=0),null==e&&(e=0),null==n&&(n=0),i=function(){return window.scrollTo(t,e)},this.delay(i,n)},s.prototype.scrollToIfNeeded=function(t,e){if(null==e&&(e=!0),t&&t.get(0)&&(!0!==e||!t.visible(!0)))return t.get(0).scrollIntoView(e)},s.prototype.shake=function(t){var e,o;return o=function(t,e,n){var i,s;if(s=e.shift(),t.css("left",s+"px"),0<e.length)return setTimeout(function(){return o(t,e,n)},n);try{return t.css("position","static")}catch(r){return i=r,console.log("error",i)}},e=(e=[15,30,15,0,-15,-30,-15,0]).concat(e.concat(e)),t.css("position","relative"),o(t,e,20)},s.prototype.formParam=function(t){return App.ControllerForm.params(t)},s.prototype.formDisable=function(t,e){return App.ControllerForm.disable(t,e)},s.prototype.formEnable=function(t,e){return App.ControllerForm.enable(t,e)},s.prototype.formValidate=function(t){return App.ControllerForm.validate(t)},s.prototype.queryParam=function(){var t,e,n,i,s;if(this.query){for(i={},t=0,e=(n=this.query.split(";")).length;t<e;t++)(s=n[t].match("(.+?)=(.*)"))&&s[1]&&(i[s[1]]=s[2]);return i}},s.prototype.humanFileSize=function(t){return App.Utils.humanFileSize(t)},s.prototype.humanTime=function(t,e,n){return null==n&&(n=!0),App.PrettyDate.humanTime(t,e,n)},s.prototype.userInfo=function(t){var e;return(e=t.el||$('[data-id="customer_info"]')).unbind(),new App.WidgetUser({el:e,user_id:t.user_id,callback:t.callback})},s.prototype.permissionCheckRedirect=function(t,e){var n;if(null==e&&(e=!1),this.permissionCheck(t))return!0;throw(n=window.location.hash)&&"#login"!==n&&"#logout"!==n&&"#keyboard_shortcuts"!==n&&App.Config.set("requested_url",n),e&&App.TaskManager.remove(this.taskKey),this.navigate("#login"),"No permission for "+t},s.prototype.permissionCheck=function(t){var e;return null!=(e=App.User.current())?e.permission(t):void 0},s.prototype.authenticateCheckRedirect=function(){var t;if(this.authenticateCheck())return!0;throw(t=window.location.hash)&&"#login"!==t&&"#logout"!==t&&"#keyboard_shortcuts"!==t&&this.Config.set("requested_url",t),this.navigate("#login"),"No exsisting session"},s.prototype.authenticateCheck=function(){return!!this.Session.get()},s.prototype.frontendTimeUpdate=function(){var t,e;return e=this,t=function(){return e.frontendTimeUpdateElement($("#app"))},App.Interval.set(t,61e3,"frontendTimeUpdate","ui")},s.prototype.frontendTimeUpdateElement=function(t){var e;return e=this,t.find(".humanTimeFromNow").each(function(){var t;return t=$(this),e.frontendTimeUpdateItem(t,t.text())})},s.prototype.frontendTimeUpdateItem=function(t,e){var n,i;if(i=t.attr("datetime"),(n=this.humanTime(i,t.hasClass("escalation")))!==e)return t.attr("title",App.i18n.translateTimestamp(i)),t.html(n)},s.prototype.recentView=function(t,e){var n;return n={object:t,o_id:e},App.Ajax.request({id:"recent_view_"+t+"_"+e,type:"POST",url:this.Config.get("api_path")+"/recent_view",data:JSON.stringify(n),processData:!0})},s.prototype.prepareForObjectList=function(t){var e,n,i;for(e=0,i=t.length;e<i;e++)n=t[e],n=this.prepareForObjectListItem(n);return t},s.prototype.prepareForObjectListItem=function(t){var e;return t.link="",t.title="???",t.object=t.object.replace("::",""),App[t.object]&&App[t.object].exists(t.o_id)&&(e=App[t.object].findNative(t.o_id),t.objectNative=e,t.link=e.uiUrl(),t.title=e.displayName(),t.object_name=e.objectDisplayName(),t.cssIcon=e.iconActivity(this.Session.get())),t.created_by=App.User.findNative(t.created_by_id),t},s.prototype.stopPropagation=function(t){return t.stopPropagation()},s.prototype.preventDefaultAndStopPropagation=function(t){return t.preventDefault(),t.stopPropagation()},s.prototype.startLoading=function(t){var e,n;if(!this.initLoadingDone||t)return this.initLoadingDone=!0,this.stopLoading(),e=function(){return t?t.html(App.view("generic/page_loading")()):n.html(App.view("generic/page_loading")())},(n=this).initLoadingDoneDelay=this.delay(e,1800)},s.prototype.stopLoading=function(){if(this.initLoadingDoneDelay)return this.clearDelay(this.initLoadingDoneDelay)},s.prototype.locationVerify=function(t){var e;if(e=$(t.currentTarget).attr("href"),this.log("debug","new location '"+e+"'"),e)return this.locationExecuteOrNavigate(e)},s.prototype.locationExecuteOrNavigate=function(t){var e;return e=Spine.Route.getPath(),this.log("debug","current location '"+e+"'"),t.replace(/#/,"")!==e?(this.log("debug","navigate to location '"+t+"'"),void this.navigate(t)):this.locationExecute(t)},s.prototype.locationExecute=function(t){return t=t.replace(/#/,""),this.log("debug","execute controller again for '"+t+"' because of same hash"),Spine.Route.matchRoutes(t)},s.prototype.logoUrl=function(){return this.Config.get("image_path")+"/"+this.Config.get("product_logo")},s.prototype.selectAll=function(t){return t.currentTarget.focus(),t.currentTarget.select()},s.prototype.windowReload=function(t,e){if(t&&t.preventDefault(),$("#app").hide().attr("style","display: none!important"),e)return window.location=e,!0;if(window.location.reload)return window.location.reload(),!0;if(window.location.href)return window.location.href=window.location.href,!0;throw"Cant reload page!"},s}(Spine.Controller),App.ControllerPermanent=function(t){function e(){this.requiredPermission&&this.permissionCheckRedirect(this.requiredPermission,!0),e.__super__.constructor.apply(this,arguments),this.navShow()}return n(e,t),e}(App.Controller),App.ControllerSubContent=function(t){function e(){this.hide=i(this.hide,this),this.show=i(this.show,this),this.requiredPermission&&this.permissionCheckRedirect(this.requiredPermission),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.show=function(){if(this.genericController&&this.genericController.show&&this.genericController.show(),this.header)return this.title(this.header,!0)},e.prototype.hide=function(){if(this.genericController&&this.genericController.hide)return this.genericController.hide()},e}(App.Controller),App.ControllerContent=function(t){function e(){this.requiredPermission&&this.permissionCheckRedirect(this.requiredPermission),e.__super__.constructor.apply(this,arguments),App.TaskManager.hideAll(),$("#content").removeClass("hide").removeClass("active"),this.navShow()}return n(e,t),e}(App.Controller),App.ControllerModal=function(t){function e(){var t;(this.stopLoading=i(this.stopLoading,this),this.startLoading=i(this.startLoading,this),this.submit=i(this.submit,this),this.cancel=i(this.cancel,this),this.localOnCancel=i(this.localOnCancel,this),this.localOnClosed=i(this.localOnClosed,this),this.localOnClose=i(this.localOnClose,this),this.onShown=i(this.onShown,this),this.localOnShown=i(this.localOnShown,this),this.localOnShow=i(this.localOnShow,this),this.formParams=i(this.formParams,this),this.close=i(this.close,this),this.render=i(this.render,this),this.element=i(this.element,this),this.update=i(this.update,this),this.showDelayed=i(this.showDelayed,this),e.__super__.constructor.apply(this,arguments),this.showTryCount=0,!this.authenticateRequired||this.authenticateCheckRedirect())&&(this.bind("ui:rerender",(t=this,function(){return t.update(),"modal"})),this.shown&&this.render())}return n(e,t),e.prototype.authenticateRequired=!1,e.prototype.backdrop=!0,e.prototype.keyboard=!0,e.prototype.large=!1,e.prototype.small=!1,e.prototype.veryLarge=!1,e.prototype.head="?",e.prototype.autoFocusOnFirstInput=!0,e.prototype.container=null,e.prototype.buttonClass="btn--success",e.prototype.centerButtons=[],e.prototype.leftButtons=[],e.prototype.buttonClose=!0,e.prototype.buttonCancel=!1,e.prototype.buttonCancelClass="btn--text btn--subtle",e.prototype.buttonSubmit=!0,e.prototype.includeForm=!0,e.prototype.headPrefix="",e.prototype.shown=!0,e.prototype.closeOnAnyClick=!1,e.prototype.initalFormParams={},e.prototype.initalFormParamsIgnore=!1,e.prototype.showTrySupport=!1,e.prototype.showTryMax=10,e.prototype.showTrydelay=1e3,e.prototype.events={"submit form":"submit","click .js-submit:not(.is-disabled)":"submit","click .js-cancel":"cancel","click .js-close":"cancel"},e.prototype.className="modal fade",e.prototype.showDelayed=function(){var t,e;return t=function(){return e.showTryCount+=1,e.render()},(e=this).delay(t,this.showTrydelay)},e.prototype.modalAlreadyExists=function(){return 0<$(".modal").length},e.prototype.content=function(){return"You need to implement a one @content()!"},e.prototype.update=function(){var t,e;return t=this.message?App.i18n.translateContent(this.message):this.contentInline?this.contentInline:this.content(),(e=$(App.view("modal")({head:this.head,headPrefix:this.headPrefix,message:this.message,detail:this.detail,buttonClose:this.buttonClose,buttonCancel:this.buttonCancel,buttonCancelClass:this.buttonCancelClass,buttonSubmit:this.buttonSubmit,buttonClass:this.buttonClass,centerButtons:this.centerButtons,leftButtons:this.leftButtons,includeForm:this.includeForm}))).find(".modal-body").html(t),this.initRenderingDone?this.$(".modal-dialog").replaceWith(e):(this.initRenderingDone=!0,this.html(e)),this.post()},e.prototype.post=function(){},e.prototype.element=function(){return this.el},e.prototype.render=function(){var t;{if(!(!0===this.showTrySupport&&this.modalAlreadyExists()&&this.showTryCount<=this.showTryMax))return!(this.initalFormParamsIgnore=!1)===this.buttonSubmit&&(this.buttonSubmit="Submit"),!0===this.buttonCancel&&(this.buttonCancel="Cancel & Go Back"),this.update(),this.container&&this.el.addClass("modal--local"),this.veryLarge&&this.el.addClass("modal--veryLarge"),this.large&&this.el.addClass("modal--large"),this.small&&this.el.addClass("modal--small"),this.el.on({"show.bs.modal":this.localOnShow,"shown.bs.modal":this.localOnShown,"hide.bs.modal":this.localOnClose,"hidden.bs.modal":this.localOnClosed,"dismiss.bs.modal":this.localOnCancel}).modal({keyboard:this.keyboard,show:!0,backdrop:this.backdrop,container:this.container}),this.closeOnAnyClick?this.el.on("click",(t=this,function(){return t.close()})):void 0;this.showDelayed()}},e.prototype.close=function(t){return t&&t.preventDefault(),this.initalFormParamsIgnore=!0,this.el.modal("hide")},e.prototype.formParams=function(){return this.container?this.formParam(this.container.find(".modal form")):this.formParam(this.$(".modal form"))},e.prototype.showAlert=function(t,e){var n;return null==e&&(e="danger"),n=$("<div>").addClass("alert alert--"+e).text(t),this.$(".modal-alerts-container").html(n)},e.prototype.clearAlerts=function(){return this.$(".modal-alerts-container").empty()},e.prototype.localOnShow=function(t){return this.onShow(t)},e.prototype.onShow=function(){},e.prototype.localOnShown=function(t){return this.onShown(t)},e.prototype.onShown=function(){var t;return this.autoFocusOnFirstInput&&((t=this.$(".form-group").first()).get(0)||(t=this.el),t.find('input:not([disabled]):not([type="hidden"]):not(".btn"), select:not([disabled]), textarea:not([disabled])').first().focus()),this.initalFormParams=this.formParams()},e.prototype.localOnClose=function(t){var e;if(e=difference(this.initalFormParams,this.formParams()),!1!==this.initalFormParamsIgnore||_.isEmpty(e)||confirm(App.i18n.translateContent("The form content has been changed. Do you want to close it and lose your changes?")))return this.onClose(t);t.preventDefault()},e.prototype.onClose=function(){},e.prototype.localOnClosed=function(t){return this.onClosed(t),this.el.modal("remove")},e.prototype.onClosed=function(){},e.prototype.localOnCancel=function(t){return this.onCancel(t)},e.prototype.onCancel=function(){},e.prototype.cancel=function(t){return this.close(t),this.onCancel(t)},e.prototype.onSubmit=function(){},e.prototype.submit=function(t){return t.stopPropagation(),t.preventDefault(),this.clearAlerts(),this.onSubmit(t)},e.prototype.startLoading=function(){return this.$(".modal-body").addClass("hide"),this.$(".modal-loader").removeClass("hide")},e.prototype.stopLoading=function(){return this.$(".modal-body").removeClass("hide"),this.$(".modal-loader").addClass("hide")},e}(App.Controller),App.SessionMessage=function(t){function e(){return this.onSubmit=i(this.onSubmit,this),this.onClose=i(this.onClose,this),this.onCancel=i(this.onCancel,this),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.showTrySupport=!0,e.prototype.onCancel=function(t){if(this.forceReload)return this.windowReload(t)},e.prototype.onClose=function(t){if(this.forceReload)return this.windowReload(t)},e.prototype.onSubmit=function(t){return this.forceReload?this.windowReload(t):this.close()},e}(App.ControllerModal),App.UpdateHeader=function(t){function e(){this.render=i(this.render,this),this.release=i(this.release,this),e.__super__.constructor.apply(this,arguments),this.subscribeId=this.genericObject.subscribe(this.render)}return n(e,t),e.prototype.release=function(){return App[this.genericObject.constructor.className].unsubscribe(this.subscribeId)},e.prototype.render=function(t){return this.el.find(".page-header h1").html(t.displayName())},e}(App.Controller),App.UpdateTastbar=function(t){function e(){this.update=i(this.update,this),this.release=i(this.release,this),e.__super__.constructor.apply(this,arguments),this.subscribeId=this.genericObject.subscribe(this.update)}return n(e,t),e.prototype.release=function(){return App[this.genericObject.constructor.className].unsubscribe(this.subscribeId)},e.prototype.update=function(){return App.TaskManager.touch(this.taskKey)},e}(App.Controller),App.ControllerWidgetPermanent=function(t){function e(t){t.el&&(t.el.append('<div id="'+t.key+'"></div>'),t.el="#"+t.key),e.__super__.constructor.call(this,t)}return n(e,t),e}(App.Controller),App.ControllerWidgetOnDemand=function(t){function e(t){this.html=i(this.html,this),this.element=i(this.element,this),t.el=$("#"+t.key),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.element=function(){return $("#"+this.key)},e.prototype.html=function(t){return $("#"+this.key).get(0)||$("#app").before('<div id="'+this.key+'" class="'+this.className+'"></div>'),$("#"+this.key).html(t)},e}(App.Controller)}.call(this),function(){var r=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ControllerForm=function(t){function s(t){var e,n,i;for(e in this.formGen=r(this.formGen,this),this.html=r(this.html,this),this.hideAlert=r(this.hideAlert,this),this.showAlert=r(this.showAlert,this),this.dispatchHandlers=r(this.dispatchHandlers,this),s.__super__.constructor.apply(this,arguments),t)i=t[e],this[e]=i;if(this.handlers||(this.handlers=[]),this.handlersConfig)for(e in n=this.handlersConfig)(i=n[e])&&i.run&&this.handlers.push(i.run);this.handlers.push(this.showHideToggle),this.handlers.push(this.requiredMandantoryToggle),this.model||(this.model={}),this.attributes||(this.attributes=[]),this.idPrefix=Math.floor(999999*Math.random()).toString(),this.model.className&&(this.idPrefix=this.model.className+"_"+this.idPrefix),this.form||(this.form=this.formGen()),this.form.prepend('<div class="alert alert--danger js-danger js-alert hide" role="alert"></div>'),this.form.prepend('<div class="alert alert--success js-success hide" role="alert"></div>'),this.handlers.length&&$(this.dispatchHandlers),this.el&&this.el.prepend(this.form),this.elReplace&&this.elReplace.html(this.form),this.form.on("input",this.hideAlert),this.finishForm=!0,this.form}return e(s,t),s.prototype.fullFormSubmitLabel="Submit",s.prototype.fullFormSubmitAdditionalClasses="",s.prototype.fullFormButtonsContainerClass="",s.prototype.fullFormAdditionalButtons=[],s.prototype.dispatchHandlers=function(){var s,r,t,e,o,n,i;for(o=App.ControllerForm.params(this.form),i=[],t=0,e=(n=this.attributes).length;t<e;t++)s=n[t],i.push(function(){var t,e,n,i;for(i=[],t=0,e=(n=this.handlers).length;t<e;t++)r=n[t],i.push(r(o,s,this.attributes,this.idPrefix,this.form,this));return i}.call(this));return i},s.prototype.showAlert=function(t){return this.form.find(".alert--danger").first().removeClass("hide").html(App.i18n.translateInline(t))},s.prototype.hideAlert=function(){return this.form.find(".alert--danger").addClass("hide").html()},s.prototype.html=function(){return this.form.html()},s.prototype.formGen=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g;if(App.Log.debug("ControllerForm","formGen",this.model.configure_attributes),l=this.noFieldset||this.grid?this.el:$("<fieldset></fieldset>"),_.isEmpty(this.model))return l;for(n in this.attributes=[],i=this.model.attributesGet?this.model.attributesGet(this.screen):App.Model.attributesGet(this.screen,this.model.configure_attributes))(t=i[n]).readonly||t.skipRendering||(this.filter&&!t.filter&&this.filter[n]&&(t.filter=this.filter[n]),this.attributes.push(t));for(p=e=0,h=(f=this.attributes).length;p<h;p++)t=f[p],e+=1,!0===this.isDisabled&&(t.disabled=!0),this.formGenItem(t,this.idPrefix,l,e).appendTo(l),"password"===t.type&&(this.params&&t.name in this.params&&(t.value=this.params[t.name]),t.single||(t.display=t.display+" (confirm)",t.name=t.name+"_confirm",this.formGenItem(t,this.idPrefix,l,e).appendTo(l)));if(this.fullForm){for(this.formClass||(this.formClass=""),l=$("<form class='form "+this.formClass+"' autocomplete='off'>").prepend(l),o=$("<div class='form-buttons "+this.fullFormButtonsContainerClass+"'>"),u=0,d=(m=this.fullFormAdditionalButtons).length;u<d;u++)r=m[u],s=$("<button class='btn "+r.className+"'>").text(r.text),r.disabled&&s.prop("disabled",!0),o.append(s);$("<button type=submit class='btn "+this.fullFormSubmitAdditionalClasses+"' value=\""+this.fullFormSubmitLabel+'"></button>').text(App.i18n.translateContent(this.fullFormSubmitLabel)).appendTo(o),o.appendTo(l)}if(this.events)for(a in c=function(t,e){var n;return n=t.split(" "),l.find(n[1]).bind(n[0],function(t){return e(t)})},g=this.events)c(a,g[a]);return l.find(".js-helpMessage").tooltip(),l},s.prototype.formGenItem=function(t,a,l,e){var n,c,i,s,r,o,p,u,h,d,f,m,g,v,y,b,w;if((c=clone(t,!0)).id=a+"_"+c.name,c.label_class=this.model.labelClass,this.autofocus&&1===e&&(c.autofocus="autofocus"),!0===c.required&&(c["null"]=!1),c["null"]?c.required="":c.required="required",void 0===c.autocapitalize||c.autocapitalize?c.autocapitalize="":c.autocapitalize='autocapitalize="off"',void 0===c.autocomplete?"hidden"===c.type?c.autocomplete="":c.autocomplete='autocomplete="off"':c.autocomplete='autocomplete="'+c.autocomplete+'"',void 0===c.value&&"default"in c&&(c.value=c["default"]),this.params&&(1<(m=c.name.split("::")).length&&void 0!==(r=m.reduce(function(t,e){return null!=t?t[e]:void 0},this.params))&&(c.value=r),c.name in this.params&&(c.value=this.params[c.name])),"newValue"in c&&(c.value=c.newValue),App.Log.debug("ControllerForm","formGenItem-before",c),!App.UiElement[c.tag])throw"Invalid UiElement."+c.tag;if(u=App.UiElement[c.tag].render(c,this.params,this),c.only_shown_if_selectable&&(s=Object.keys(c.options).length,!c["null"]&&c.nulloption&&2===s||!c.nulloption&&1===s)){for(c.transparent=!0,(i=clone(c)).type="hidden",i.value="",p=0,d=(v=c.options).length;p<d;p++)(u=v[p]).value&&""!==u.value&&(i.value=u.value);u=$(App.view("generic/input")({attribute:i}))}if(this.handlers&&u.bind("change",(w=this,function(t){var e,n,i,s,r,o;for(s=App.ControllerForm.params($(t.target)),o=[],n=0,i=(r=w.handlers).length;n<i;n++)e=r[n],o.push(e(s,c,w.attributes,a,l,w));return o})),this.dependency)for(h=0,f=(y=this.dependency).length;h<f;h++)(n=y[h]).bind&&n.bind.name===c.name&&(b=this,function(e){u.bind("change",function(){var t;if((t=$(this).val())||(t=$(this).find("select, input").val()),e.bind.relation&&(t=App[e.bind.relation].find(t).name),_.contains(e.bind.value,t))return"hide"===e.change.action?b.hide(e.change.name):b.show(e.change.name)})}(n));return!c.display||c.transparent?u:(g={},this.model.className&&this.params&&!_.isEmpty(c.linktemplate)&&!_.isEmpty(this.params[c.name])&&((g={attribute:c,session:App.Session.get(),config:App.Config.all()})[this.model.className.toLowerCase()]=this.params),(o=$(App.view("generic/attribute")({attribute:c,item:"",bookmarkable:this.bookmarkable,placeholderObjects:g}))).find(".controls").prepend(u),c.hide&&this.hide(c.name,o),o)},s.prototype.show=function(t,e){var n,i,s;for(null==e&&(e=this.form),_.isArray(t)||(t=[t]),n=0,s=t.length;n<s;n++)i=t[n],e.find('[name="'+i+'"]').closest(".form-group").removeClass("hide"),e.find('[name="'+i+'"]').removeClass("is-hidden"),e.find('[data-name="'+i+'"]').closest(".form-group").removeClass("hide"),e.find('[data-name="'+i+'"]').removeClass("is-hidden");if(e)return e.find(".has-error").removeClass("has-error"),e.find(".help-inline").html("")},s.prototype.hide=function(t,e){var n,i,s,r;for(null==e&&(e=this.form),_.isArray(t)||(t=[t]),r=[],n=0,s=t.length;n<s;n++)i=t[n],e.find('[name="'+i+'"]').closest(".form-group").addClass("hide"),e.find('[name="'+i+'"]').addClass("is-hidden"),e.find('[data-name="'+i+'"]').closest(".form-group").addClass("hide"),r.push(e.find('[data-name="'+i+'"]').addClass("is-hidden"));return r},s.prototype.mandantory=function(t,e){var n,i,s,r;for(null==e&&(e=this.form),_.isArray(t)||(t=[t]),r=[],n=0,s=t.length;n<s;n++)i=t[n],e.find('[name="'+i+'"]').attr("required",!0),r.push(e.find('[name="'+i+'"]').parents(".form-group").find("label span").html("*"));return r},s.prototype.optional=function(t,e){var n,i,s,r;for(null==e&&(e=this.form),_.isArray(t)||(t=[t]),r=[],n=0,s=t.length;n<s;n++)i=t[n],e.find('[name="'+i+'"]').attr("required",!1),r.push(e.find('[name="'+i+'"]').parents(".form-group").find("label span").html(""));return r},s.prototype.showHideToggle=function(t,e,n,i,s,r){var o,a,l,c,p,u,h,d,f,m,g;for(g=[],l=0,u=n.length;l<u;l++)if((o=n[l]).shown_if){for(f in a=!1,d=o.shown_if)if(m=d[f],t[f])if(_.isArray(m))for(p=0,h=m.length;p<h;p++)c=m[p],t[f].toString()===c.toString()&&(a=!0);else t[f].toString()===m.toString()&&(a=!0);a?g.push(r.show(o.name,s)):g.push(r.hide(o.name,s))}else g.push(void 0);return g},s.prototype.requiredMandantoryToggle=function(t,e,n,i,s,r){var o,a,l,c,p,u,h,d,f,m,g;for(g=[],l=0,u=n.length;l<u;l++)if((o=n[l]).required_if){for(f in a=!1,d=o.required_if)if(m=d[f],t[f])if(_.isArray(m))for(p=0,h=m.length;p<h;p++)c=m[p],t[f].toString()===c.toString()&&(a=!0);else t[f].toString()===m.toString()&&(a=!0);a?g.push(r.mandantory(o.name,s)):g.push(r.optional(o.name,s))}else g.push(void 0);return g},s.prototype.validate=function(t){return App.Model.validate({model:this.model,params:t,screen:this.screen})},s.params=function(t,e){var n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T,A,S,C;for(null==e&&(e=!1),y={},f=this.findForm(t),e&&f.find(".richtext.form-control").trigger("click"),a=0,h=(k=f.find("[contenteditable]")).length;a<h;a++)s=k[a],(m=$(s).data("name"))&&(y[m]=$(s).ceg());for(p=0,d=(n=f.serializeArrayWithType()).length;p<d;p++)c=n[p],f.find('[name="'+c.name+'"]').hasClass("is-hidden")||f.find('div[data-name="'+c.name+'"]').hasClass("is-hidden")?delete y[c.name]:(C=c.value,c.value&&(C=c.value.trim()),"boolean"===c.type&&(""===C?C=void 0:void 0===C?C=!1:"true"===C?C=!0:"false"===C&&(C=!1)),"integer"===c.type&&(C=""===C?void 0:parseInt(C)),void 0!==y[c.name]?"string"==typeof y[c.name]||"boolean"==typeof y[c.name]||"number"==typeof y[c.name]?y[c.name]=[y[c.name],C]:y[c.name].push(C):y[c.name]=C);for(u in S={},f.find("input[type=checkbox]").each(function(){var t,e;return e=$(this).data("field-type"),t=$(this).prop("checked"),!(m=$(this).attr("name"))||t||m in y||(S[m]=m in S?[]:"boolean"!==e&&void 0),!0}),f.find("input[type=radio]").each(function(){var t,e;return e=$(this).data("field-type"),t=$(this).prop("checked"),!(m=$(this).attr("name"))||t||m in y||(S[m]="boolean"!==e&&void 0),!0}),S)C=S[u],u in y||(y[u]=C);for(u in y)if("{date}"===u.substr(0,6)){if(g=u.substr(6,u.length),f.find('[data-name="'+g+'"]').hasClass("is-hidden"))y[g]=null;else if(y[u])try{if(A=new Date(Date.parse(y[u]+"T00:00:00Z")),o=function(t){return parseInt(t)<10&&(t="0"+t),t},"Invalid Date"===A)throw"Invalid Date "+y[u];y[g]=A.getUTCFullYear()+"-"+o(A.getUTCMonth()+1)+"-"+o(A.getUTCDate())}catch(x){r=x,y[g]="invalid "+y[u],console.log("ERR",r)}else y[g]=null;delete y[u]}else if("{datetime}"===u.substr(0,10)){if(g=u.substr(10,u.length),f.find('[data-name="'+g+'"]').hasClass("is-hidden"))y[g]=null;else if(y[u])try{if("Invalid Datetime"===(A=new Date(Date.parse(y[u]))))throw"Invalid Datetime "+y[u];y[g]=A.toISOString().replace(/:\d\d\.\d\d\dZ$/,":00.000Z")}catch(x){r=x,y[g]="invalid "+y[u],console.log("ERR",r)}else y[g]=null;delete y[u]}for(u in l={},y)(b=u.split("::"))[0]&&void 0!==b[1]&&(void 0===b[1]||l[b[0]]||(l[b[0]]={}),void 0===b[2]||l[b[0]][b[1]]||(l[b[0]][b[1]]={}),void 0===b[3]||l[b[0]][b[1]][b[2]]||(l[b[0]][b[1]][b[2]]={}),void 0!==b[3]?(l[b[0]][b[1]][b[2]][b[3]]=y[u],delete y[u]):void 0!==b[2]?(l[b[0]][b[1]][b[2]]=y[u],delete y[u]):void 0!==b[1]&&(l[b[0]][b[1]]=y[u],delete y[u]));for(u in l)y[u]=l[u];for(u in y)if("{business_hours}"===u.substr(0,16)){if(g=u.substr(16,u.length),f.find('[data-name="'+g+'"]').hasClass("is-hidden"))y[g]=null;else if(y[u]){for(i in v={},T=y[u])if(C=T[i],v[i]={},v[i].active=!1,"true"===C.active&&(v[i].active=!0),v[i].timeframes=[],_.isArray(C.start))for(w in C.start)v[i].timeframes.push([C.start[w],C.end[w]]);else v[i].timeframes.push([C.start,C.end]);y[g]=v}else y[g]=void 0;delete y[u]}return y},s.formId=function(){var t;return(t=(new Date).getTime()+Math.floor(99999*Math.random())).toString().substr(t.toString().length-9,9)},s.findForm=function(t){return t&&t.target&&(t=t.target),t instanceof jQuery||(t=$(t)),!0===t.is("form")?t:!0===t.find("form").is("form")?t.find("form"):!0===$(t).closest("form").is("form")?t.closest("form"):(this.finishForm&&App.Log.error("ControllerForm","no form found!",t),t)},s.disable=function(t,e){var n;return null==e&&(e="form"),(n=this.findForm(t))&&"form"===e?n.is("button, input, select, textarea, div, span")?(App.Log.debug("ControllerForm","disable item...",n),n.prop("readonly",!0),void n.prop("disabled",!0)):(App.Log.debug("ControllerForm","disable form...",n),n.find("button, input, select, textarea").prop("readonly",!0),n.find("input[type=checkbox], input[type=radio]").prop("disabled",!0),n.find("button").prop("disabled",!0)):(App.Log.debug("ControllerForm","disable item...",t),t.prop("readonly",!0),t.prop("disabled",!0))},s.enable=function(t,e){var n;return null==e&&(e="form"),(n=this.findForm(t))&&"form"===e?n.is("button, input, select, textarea, div, span")?(App.Log.debug("ControllerForm","disable item...",n),n.prop("readonly",!1),void n.prop("disabled",!1)):(App.Log.debug("ControllerForm","enable form...",n),n.find("button, input, select, textarea").prop("readonly",!1),n.find("input[type=checkbox], input[type=radio]").prop("disabled",!1),n.find("button").prop("disabled",!1)):(App.Log.debug("ControllerForm","enable item...",t),t.prop("readonly",!1),t.prop("disabled",!1))},s.validate=function(t){var e,n,i,s,r,o;for(i in(s=this.findForm(t.form)).find(".has-error").removeClass("has-error"),s.find(".help-inline").html(""),o=t.errors)r=o[i],(e=s.find('[name="'+i+'"]').closest(".form-group")).addClass("has-error"),e.find(".help-inline").html(r),(n=s.find('[data-name="'+i+'"]').closest(".form-group")).addClass("has-error"),n.find(".help-inline").html(r),(e=s.find('[name="'+i+'"]').closest(".form-control")).trigger("validate"),(n=s.find('[data-name="'+i+'"]').closest(".form-control")).trigger("validate");return App.Delay.set(function(){return s.find(".has-error").find("input, textarea, select").first().focus()},200,"validate")},s}(App.Controller)}.call(this),function(){var s=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;App.ControllerGenericNew=function(t){function e(){return this.content=s(this.content,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.headPrefix="New",e.prototype.showTrySupport=!0,e.prototype.content=function(){return this.head=this.pageData.head||this.pageData.object,this.controller=new App.ControllerForm({model:App[this.genericObject],params:this.item,screen:this.screen||"edit",autofocus:!0}),this.controller.form},e.prototype.onSubmit=function(n){var t,e,i,s;return i=this.formParam(n.target),(e=new App[this.genericObject]).load(i),(t=e.validate())?(this.log("error",t),this.formValidate({form:n.target,errors:t}),!1):(this.formDisable(n),s=this,e.save({done:function(){var t;return s.callback&&(t=App[s.genericObject].fullLocal(this.id),s.callback(t)),s.close()},fail:function(t,e){return s.log("errors",e),s.formEnable(n),s.controller.showAlert(e.error_human||e.error||"Unable to create object!")}}))},e}(App.ControllerModal),App.ControllerGenericEdit=function(t){function e(){return this.content=s(this.content,this),e.__super__.constructor.apply(this,
arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.headPrefix="Edit",e.prototype.content=function(){return this.item=App[this.genericObject].find(this.id),this.head=this.pageData.head||this.pageData.object,this.controller=new App.ControllerForm({model:App[this.genericObject],params:this.item,screen:this.screen||"edit",autofocus:!0}),this.controller.form},e.prototype.onSubmit=function(n){var t,e,i;return e=this.formParam(n.target),this.item.load(e),(t=this.item.validate())?(this.log("error",t),this.formValidate({form:n.target,errors:t}),!1):(this.formDisable(n),(i=this).item.save({done:function(){var t;return i.callback&&(t=App[i.genericObject].fullLocal(this.id),i.callback(t)),i.close()},fail:function(t,e){return App[i.genericObject].fetch({id:this.id}),i.log("errors"),i.formEnable(n),i.controller.showAlert(e.error_human||e.error||"Unable to update object!")}}))},e}(App.ControllerModal),App.ControllerGenericIndex=function(t){function e(){var n;this.description=s(this.description,this),this.edit=s(this.edit,this),this.render=s(this.render,this),this.release=s(this.release,this),this.hide=s(this.hide,this),this.show=s(this.show,this),e.__super__.constructor.apply(this,arguments),this.pageData.title&&this.title(this.pageData.title,!0),this.pageData.navupdate&&this.navupdate(this.pageData.navupdate),this.disableRender||(this.subscribeId=App[this.genericObject].subscribe(this.render)),App[this.genericObject].bind("ajaxError",(n=this,function(t,e){if(n.log("error","ajax",e.status),401===e.status)return n.log("error","ajax",t,e,e.status),n.navigate("login")})),this.render(),this.disableInitFetch||App[this.genericObject].fetchFull(function(){},{clear:!0})}return r(e,t),e.prototype.events={"click [data-type=edit]":"edit","click [data-type=new]":"new","click [data-type=import]":"import","click .js-description":"description"},e.prototype.show=function(){if(this.table)return this.table.show()},e.prototype.hide=function(){if(this.table)return this.table.hide()},e.prototype.release=function(){if(this.subscribeId)return App[this.genericObject].unsubscribe(this.subscribeId)},e.prototype.render=function(){var t,e,n,i;return e=App[this.genericObject].search({sortBy:this.defaultSortBy||"name",order:this.defaultOrder}),this.ignoreObjectIDs&&(e=_.filter(e,function(t){if(1!==t.id)return t})),!this.table&&(i=!1,App[this.genericObject].description&&!_.isEmpty(e)&&(i=!0),this.html(App.view("generic/admin/index")({head:this.pageData.objects,notes:this.pageData.notes,buttons:this.pageData.buttons,menus:this.pageData.menus,showDescription:i})),_.isEmpty(e)&&App[this.genericObject].description)?(t=marked(App[this.genericObject].description),void this.$(".table-overview").html(t)):(n=_.extend({tableId:this.genericObject+"-generic-overview",el:this.$(".table-overview"),model:App[this.genericObject],objects:e,bindRow:{events:{click:this.edit}},container:this.container,explanation:this.pageData.explanation,groupBy:this.groupBy,dndCallback:this.dndCallback},this.pageData.tableExtend),this.table?this.table.update({objects:e}):this.table=new App.ControllerTable(n))},e.prototype.edit=function(t,e){var n;if(e.preventDefault(),n=App[this.genericObject].find(t),!this.editCallback)return new App.ControllerGenericEdit({id:n.id,pageData:this.pageData,genericObject:this.genericObject,container:this.container,small:this.small,large:this.large,veryLarge:this.veryLarge});this.editCallback(n)},e.prototype["new"]=function(t){return t.preventDefault(),new App.ControllerGenericNew({pageData:this.pageData,genericObject:this.genericObject,container:this.container,small:this.small,large:this.large,veryLarge:this.veryLarge})},e.prototype["import"]=function(t){return t.preventDefault(),this.importCallback()},e.prototype.description=function(){return new App.ControllerGenericDescription({description:App[this.genericObject].description,container:this.container})},e}(App.Controller),App.ControllerGenericDescription=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.content=s(this.content,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!1,e.prototype.buttonSubmit="Close",e.prototype.head="Description",e.prototype.content=function(){return marked(App.i18n.translateContent(this.description))},e.prototype.onSubmit=function(){return this.close()},e}(App.ControllerModal),App.ControllerModalLoading=function(t){function e(){this.hide=s(this.hide,this),this.localOnClosed=s(this.localOnClosed,this),this.showIcon=s(this.showIcon,this),this.hideIcon=s(this.hideIcon,this),this.update=s(this.update,this),e.__super__.constructor.apply(this,arguments),this.container&&this.el.addClass("modal--local"),this.render(),this.el.modal({keyboard:!1,show:!0,backdrop:"static",container:this.container}).on({"hidden.bs.modal":this.localOnClosed})}return r(e,t),e.prototype.className="modal fade",e.prototype.showTrySupport=!0,e.prototype.render=function(){return this.html(App.view("generic/modal_loader")({head:this.head,message:App.i18n.translateContent(this.message)}))},e.prototype.update=function(t,e){return null==e&&(e=!0),e&&(t=App.i18n.translateContent(t)),this.$(".js-loading").html(t)},e.prototype.hideIcon=function(){return this.$(".js-loadingIcon").addClass("hide")},e.prototype.showIcon=function(){return this.$(".js-loadingIcon").removeClass("hide")},e.prototype.localOnClosed=function(){return this.el.remove()},e.prototype.hide=function(t){var e,n;if(n=this,e=function(){return n.el.modal("hide")},t)return App.Delay.set(e,1e3*t);e()},e}(App.Controller),App.ControllerGenericDestroyConfirm=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="delete",e.prototype.buttonClass="btn--danger",e.prototype.head="Confirm",e.prototype.small=!0,e.prototype.content=function(){return App.i18n.translateContent("Sure to delete this object?")},e.prototype.onSubmit=function(){var t,e,n;return(t=this.options||{}).done=(e=this,function(){if(e.close(),e.callback)return e.callback()}),t.fail=(n=this,function(){return n.log("errors"),n.close()}),this.item.destroy(t)},e}(App.ControllerModal),App.ControllerConfirm=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="yes",e.prototype.buttonClass="btn--danger",e.prototype.head="Confirm",e.prototype.small=!0,e.prototype.content=function(){return App.i18n.translateContent(this.message)},e.prototype.onSubmit=function(){if(this.close(),this.callback)return this.callback()},e}(App.ControllerModal),App.ControllerErrorModal=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!1,e.prototype.buttonSubmit="Close",e.prototype.head="Error",e.prototype.showTrySupport=!0,e.prototype.content=function(){return this.message},e.prototype.onSubmit=function(){if(this.close(),this.callback)return this.callback()},e}(App.ControllerModal),App.ControllerDrox=function(t){function e(t){e.__super__.constructor.apply(this,arguments),t.data&&(t.data.text||t.data.html)&&this.inline(t.data)}return r(e,t),e.prototype.inline=function(t){if(this.html(App.view("generic/drox")(t)),t.text&&this.$(".drox-body").text(t.text),t.html)return this.$(".drox-body").html(t.html)},e.prototype.template=function(t){var e,n;return n=$(App.view("generic/drox")(t)),e=App.view(t.file)(t.params),n.find(".drox-body").append(e),n},e}(App.Controller),App.ControllerTabs=function(t){function e(t){if(this.tabRemember=s(this.tabRemember,this),this.hide=s(this.hide,this),this.show=s(this.show,this),this.originParams=t,e.__super__.constructor.call(this,t),this.requiredPermission&&!this.permissionCheckRedirect(this.requiredPermission))throw"No permission for "+this.requiredPermission}return r(e,t),e.prototype.events={'click .nav-tabs [data-toggle="tab"]':"tabRemember"},e.prototype.show=function(){var t,e,n,i,s;if(this.controllerList){for(s=[],t=0,e=(i=this.controllerList).length;t<e;t++)(n=i[t])&&n.show?s.push(n.show()):s.push(void 0);return s}},e.prototype.hide=function(){var t,e,n,i,s;if(this.controllerList){for(s=[],t=0,e=(i=this.controllerList).length;t<e;t++)(n=i[t])&&n.hide?s.push(n.hide()):s.push(void 0);return s}},e.prototype.render=function(){var t,e,n,i,s;for(this.html(App.view("generic/tabs")({header:this.header,subHeader:this.subHeader,tabs:this.tabs,addTab:this.addTab,headerSwitchName:this.headerSwitchName,headerSwitchChecked:this.headerSwitchChecked})),t=0,e=(i=this.tabs).length;t<e;t++)s=i[t],this.$(".tab-content").append('<div class="tab-pane" id="'+s.target+'"></div>'),s.controller&&((n=s.params||{}).name=s.name,n.target=s.target,n.el=this.$("#"+s.target),this.controllerList||(this.controllerList=[]),this.controllerList.push(new s.controller(_.extend(this.originParams,n))));if(!(this.tabs.length<=1))return this.lastActiveTab=this.Config.get("lastTab"),this.lastActiveTab&&this.$(".nav-tabs li a[href='"+this.lastActiveTab+"']")[0]?this.$(".nav-tabs li a[href='"+this.lastActiveTab+"']").tab("show"):this.$(".nav-tabs li:first a").tab("show");this.$(".tab-pane").addClass("active")},e.prototype.tabRemember=function(t){return this.lastActiveTab=$(t.target).attr("href"),this.Config.set("lastTab",this.lastActiveTab)},e}(App.Controller),App.ControllerNavSidbar=function(t){function n(t){var e;this.currentPosition=s(this.currentPosition,this),this.setPosition=s(this.setPosition,this),this.executeController=s(this.executeController,this),this.selectedItem=s(this.selectedItem,this),this.groupsSorted=s(this.groupsSorted,this),this.updateNavigation=s(this.updateNavigation,this),this.render=s(this.render,this),this.hide=s(this.hide,this),this.show=s(this.show,this),n.__super__.constructor.apply(this,arguments),this.authenticateRequired&&this.authenticateCheckRedirect(),this.render(!0),this.bind("ui:rerender",(e=this,function(){return e.render(!0),e.updateNavigation(!0,t)}))}return r(n,t),n.prototype.show=function(t){var e,n;if(null==t&&(t={}),this.navupdate(""),this.shown=!0,t)for(e in t)n=t[e],"el"!==e&&"shown"!==e&&"match"!==e&&(this[e]=n);if(this.updateNavigation(!1,t),this.activeController&&_.isFunction(this.activeController.show))return this.activeController.show(t)},n.prototype.hide=function(){if(this.shown=!1,this.activeController&&_.isFunction(this.activeController.hide))return this.activeController.hide()},n.prototype.render=function(t){var e,n;return null==t&&(t=!1),e=this.groupsSorted(),n=this.selectedItem(e),this.html(App.view("generic/navbar_level2/index")({className:this.configKey})),this.$(".sidebar").html(App.view("generic/navbar_level2/navbar")({groups:e,className:this.configKey,selectedItem:n}))},n.prototype.updateNavigation=function(t,e){var n,i;if(n=this.groupsSorted(),(i=this.selectedItem(n))&&(t||!this.lastTarget||i.target!==this.lastTarget))return this.lastTarget=i.target,this.$(".sidebar li").removeClass("active"),this.$('.sidebar li a[href="'+i.target+'"]').parent().addClass("active"),this.executeController(i,e)},n.prototype.groupsSorted=function(){var t,e,n,i,s,r,o,a,l;for(s in e=[],t=App.Config.get(this.configKey))if(!(i=t[s]).controller)if(i.permission)for(o=!1,n=0,r=(l=i.permission).length;n<r;n++)a=l[n],!o&&this.permissionCheck(a)&&(o=!0,e.push(i));else e.push(i);return _.sortBy(e,function(t){return t.prio})},n.prototype.selectedItem=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T,A;for(n=0,p=t.length;n<p;n++){for(l in e=t[n],r=[],s=App.Config.get(this.configKey))if((i=s[l]).parent===e.target&&i.controller)if(i.permission)for(v=!1,o=0,u=(w=i.permission).length;o<u;o++)b=w[o],!v&&this.permissionCheck(b)&&(v=!0,r.push(i));else r.push(i);e.items=_.sortBy(r,function(t){return t.prio})}for(A=void 0,a=0,h=t.length;a<h;a++)if((e=t[a]).items)for(c=0,d=(k=e.items).length;c<d;c++)(i=k[c]).target.match("/"+this.target+"$")?(i.active=!0,A=i):i.active=!1;if(!A)for(g=0,f=t.length;g<f&&(e=t[g],!A);g++)if(e.items)for(y=0,m=(T=e.items).length;y<m;y++){(i=T[y]).active=!0,A=i;break}return A},n.prototype.executeController=function(t,e){return this.activeController&&(this.activeController.el.remove(),this.activeController=void 0),this.$(".main").append("<div>"),this.activeController=new t.controller(_.extend(e,{el:this.$(".main div")}))},n.prototype.setPosition=function(t){if(!this.shown&&t)return t.main&&this.$(".main").scrollTop(t.main),t.sidebar?this.$(".sidebar").scrollTop(t.sidebar):void 0},n.prototype.currentPosition=function(){return{main:this.$(".main").scrollTop(),sidebar:this.$(".sidebar").scrollTop()}},n}(App.Controller),App.GenericHistory=function(t){function e(){this.sortorder=s(this.sortorder,this),this.onShown=s(this.onShown,this),this.content=s(this.content,this),e.__super__.constructor.apply(this,arguments),this.fetch()}return r(e,t),e.extend(App.PopoverProvidable),e.registerPopovers("User"),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!1,e.prototype.buttonSubmit=!1,e.prototype.head="History",e.prototype.shown=!1,e.prototype.content=function(){var t,e,n;return e=this.reworkItems(this.items),(t=$(App.view("generic/history")({items:e}))).find('a[data-type="sortorder"]').bind("click",(n=this,function(t){return t.preventDefault(),n.sortorder()})),t},e.prototype.onShown=function(){return this.renderPopovers()},e.prototype.sortorder=function(){return this.items=this.items.reverse(),this.update()},e.prototype.T=function(t){return App.i18n.translateInline(t)},e.prototype.reworkItems=function(t){var e,n,i,s,r,o,a,l,c,p,u,h;for(p=[],c={},o=a=void 0,i=0,l=(t=clone(t)).length;i<l;i++)"Ticket::Article"===(s=t[i]).object&&(s.object="Article"),s.created_by=App.User.find(s.created_by_id),n=new Date(s.created_at),r=new Date(new Date(o).getTime()+15e3),(a!==s.created_by_id||r<n)&&(o=s.created_at,a=s.created_by_id,_.isEmpty(c)||p.push(c),c={created_at:s.created_at,created_by:App.User.find(s.created_by_id),records:[]}),e="","notification"===s.type||"email"===s.type?e=this.T(s.type)+" "+this.T("sent to")+" '"+s.value_to+"'":"received_merge"===s.type?(u=App.Ticket.find(s.id_from),h='<a href="#ticket/zoom/'+s.id_from+'">#'+u.number+"</a>",e=this.T("Ticket")+" "+h+" "+this.T("was merged into this ticket")):"merged_into"===s.type?(u=App.Ticket.find(s.id_to),h='<a href="#ticket/zoom/'+s.id_to+'">#'+u.number+"</a>",e=this.T("This ticket was merged into")+" "+this.T("ticket")+" "+h):(e=this.T(s.type)+" "+this.T(s.object)+" ",s.attribute&&(e+=""+this.T(s.attribute),"User"===s.object&&"last_login"===s.attribute&&(s.value_from&&(s.value_from=App.i18n.translateTimestamp(s.value_from)),s.value_to&&(s.value_to=App.i18n.translateTimestamp(s.value_to)))),s.value_from&&(s.value_to&&(e+=" "+this.T("from")),e+=" '"+App.Utils.htmlEscape(s.value_from)+"'"),s.value_to&&(s.value_from&&(e+=" "+this.T("to")),e+=" '"+App.Utils.htmlEscape(s.value_to)+"'")),c.records.push(e);return _.isEmpty(c)||p.push(c),p},e}(App.ControllerModal),App.ActionRow=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.render()}return r(e,t),e.prototype.render=function(){var t,e,n,i,s;for(this.html(App.view("generic/actions")({items:this.items,type:this.type})),s=[],t=0,n=(i=this.items).length;t<n;t++)e=i[t],s.push(function(t){return function(e){return t.$('[data-type="'+e.name+'"]').on("click",function(t){return t.preventDefault(),e.callback()})}}(this)(e));return s},e}(App.Controller),App.Sidebar=function(t){function e(){var t;this.toggleTab=s(this.toggleTab,this),this.toggleSidebar=s(this.toggleSidebar,this),this.badgeRenderLocal=s(this.badgeRenderLocal,this),this.badgeRender=s(this.badgeRender,this),this.render=s(this.render,this),e.__super__.constructor.apply(this,arguments),this.render(),this.name&&(t=this.name),!t&&this.sidebarState&&(t=this.sidebarState.active),t||(t=this.tabs.first().data("tab")),this.toggleTabAction(t)}return r(e,t),e.prototype.elements={".tabsSidebar-tab":"tabs",".sidebar":"sidebars"},e.prototype.events={"click .tabsSidebar-tab":"toggleTab","click .tabsSidebar-close":"toggleSidebar","click .sidebar-header .js-headline":"toggleDropdown"},e.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p,u;for(s=[],e=0,a=(u=this.items).length;e<a;e++)(i=(n=u[e]).sidebarItem())&&s.push(i);for(p=$(App.view("generic/sidebar_tabs")({items:s,scrollbarWidth:App.Utils.getScrollBarWidth(),dir:App.i18n.dir()})),r=0,l=s.length;r<l;r++)n=s[r],t=p.find('.tabsSidebar-tab[data-tab="'+n.name+'"]'),n.badgeCallback?n.badgeCallback(t):this.badgeRender(t,n);for(o=0,c=s.length;o<c;o++)(n=s[o]).sidebarCallback&&(t=p.filter('.sidebar[data-tab="'+n.name+'"]'),n.sidebarCallback(t.find(".sidebar-content")),_.isEmpty(n.sidebarActions)||new App.ActionRow({el:t.find(".js-actions"),items:n.sidebarActions,type:"small"}));return this.html(p)},e.prototype.badgeRender=function(t,e){return this.badgeEl=t,this.badgeRenderLocal(e)},e.prototype.badgeRenderLocal=function(t){return this.badgeEl.html(App.view("generic/sidebar_tabs_item")({icon:t.badgeIcon}))},e.prototype.toggleDropdown=function(t){return t.stopPropagation(),$(t.currentTarget).next(".js-actions").find(".dropdown-toggle").dropdown("toggle")},e.prototype.toggleSidebar=function(){return this.el.parent().find(".tabsSidebar-sidebarSpacer").toggleClass("is-closed"),this.el.parent().find(".tabsSidebar").toggleClass("is-closed")},e.prototype.showSidebar=function(){return this.el.parent().find(".tabsSidebar-sidebarSpacer").removeClass("is-closed"),this.el.parent().find(".tabsSidebar").removeClass("is-closed")},e.prototype.toggleTab=function(t){var e;if(e=$(t.target).closest(".tabsSidebar-tab").data("tab"))return e===this.currentTab?this.toggleSidebar():this.toggleTabAction(e)},e.prototype.toggleTabAction=function(t){if(t)return this.sidebarState&&(this.sidebarState.active=t),this.tabs.removeClass("active"),this.$(".tabsSidebar-tab[data-tab="+t+"]").addClass("active"),this.sidebars.addClass("hide"),this.$(".sidebar[data-tab="+t+"]").removeClass("hide"),this.currentTab=t,this.showSidebar()},e}(App.Controller),App.WizardModal=function(t){function e(){var t;this.showInvalidField=s(this.showInvalidField,this),this.hide=s(this.hide,this),this.enable=s(this.enable,this),this.disable=s(this.disable,this),this.hideAlert=s(this.hideAlert,this),this.showAlert=s(this.showAlert,this),this.showSlide=s(this.showSlide,this),this.goToSlide=s(this.goToSlide,this),e.__super__.constructor.apply(this,arguments),this.bind("ui:rerender",(t=this,function(){return t.render(),"wizard"}))}return r(e,t),e.prototype.className="modal fade",e.prototype.goToSlide=function(t){var e;if(t.preventDefault(),e=$(t.target).data("slide"))return this.showSlide(e)},e.prototype.showSlide=function(t){return this.hideAlert(t),this.$(".setup.wizard").addClass("hide"),this.$(".setup.wizard."+t).removeClass("hide"),this.$(".setup.wizard."+t+" input, .setup.wizard."+t+" select").first().focus()},e.prototype.showAlert=function(t,e){return this.$("."+t).find(".alert").first().removeClass("hide").text(App.i18n.translatePlain(e))},e.prototype.hideAlert=function(t){return this.$("."+t).find(".alert").first().addClass("hide")},e.prototype.disable=function(t){return this.formDisable(t),this.$(".wizard-controls .btn").attr("disabled",!0)},e.prototype.enable=function(t){return this.formEnable(t),this.$(".wizard-controls .btn").attr("disabled",!1)},e.prototype.hide=function(t){return t.preventDefault(),this.el.modal("hide")},e.prototype.showInvalidField=function(t,e){var n,i;if(this.$("."+t).find(".form-group").removeClass("has-error"),e){for(n in i=[],e)e[n]?i.push(this.$("."+t).find('[name="options::'+n+'"]').closest(".form-group").addClass("has-error")):i.push(void 0);return i}},e.prototype.render=function(){},e}(App.Controller),App.WizardFullScreen=function(t){function e(){e.__super__.constructor.apply(this,arguments),$(".content").addClass("hide"),$("#content").removeClass("hide")}return r(e,t),e.prototype.className="getstarted fit",e}(App.WizardModal),App.CollectionController=function(t){function i(){var t,e,n;this.remove=s(this.remove,this),this.click=s(this.click,this),this.location=s(this.location,this),this.renderItem=s(this.renderItem,this),this.renderParts=s(this.renderParts,this),this.itemGet=s(this.itemGet,this),this.itemAttributes=s(this.itemAttributes,this),this.itemAttributesSet=s(this.itemAttributesSet,this),this.itemAttributesGet=s(this.itemAttributesGet,this),this.itemAttributesDelete=s(this.itemAttributesDelete,this),this.itemAttributesDiff=s(this.itemAttributesDiff,this),this.itemsAll=s(this.itemsAll,this),this.itemDestroy=s(this.itemDestroy,this),this.renderAll=s(this.renderAll,this),this.domChange=s(this.domChange,this),this.domRemove=s(this.domRemove,this),this.collectionSync=s(this.collectionSync,this),this.collectionOrderSet=s(this.collectionOrderSet,this),this.collectionOrderGet=s(this.collectionOrderGet,this),this.uIRunner=s(this.uIRunner,this),this.release=s(this.release,this),this.events||(this.events=this.constructor.events),this.observe||(this.observe=this.constructor.observe),this.currentItems={},this.renderList={},this.queue=[],this.queueRunning=!1,this.lastOrder=[],i.__super__.constructor.apply(this,arguments),this.queue.push(["renderAll"]),this.uIRunner(),this.model&&(this.subscribeId=App[this.model].subscribe(this.collectionSync)),this.globalRerender&&this.bind("ui:rerender",(t=this,function(){return t.queue.push(["renderAll"]),t.uIRunner()})),this.bind("auth:login",(e=this,function(){return e.queue.push(["renderAll"]),e.uIRunner()})),this.bind("auth:logout",(n=this,function(){return n.queue.push(["renderAll"]),n.uIRunner()})),this.log("debug","Init @uniqKey",this.uniqKey),this.log("debug","Init @observe",this.observe),this.log("debug","Init @model",this.model)}return r(i,t),i.prototype.events={"click .js-remove":"remove","click .js-item":"click","click .js-locationVerify":"location"},i.prototype.observe={field1:!0,field2:!1},i.prototype.template="_need_to_be_defined_",i.prototype.uniqKey="id",i.prototype.model="_need_to_be_defined_",i.prototype.sortBy="name",i.prototype.order="ASC",i.prototype.insertPosition="after",i.prototype.globalRerender=!0,i.prototype.release=function(){if(this.subscribeId)return App[this.model].unsubscribe(this.subscribeId)},i.prototype.uIRunner=function(){var t,e;if(this.queue[0]&&!this.queueRunning){for(this.queueRunning=!0,e=[];;){if("domChange"===(t=this.queue.shift())[0]?this.domChange(t[1]):"domRemove"===t[0]?this.domRemove(t[1]):"change"===t[0]?this.collectionSync(t[1]):"destroy"===t[0]?this.collectionSync(t[1],"destroy"):"renderAll"===t[0]?this.renderAll():this.log("error","Unknown type "+t[0],t[1]),!this.queue[0]){this.onRenderEnd(),this.queueRunning=!1;break}e.push(void 0)}return e}},i.prototype.collectionOrderGet=function(){var t,e,n,i,s;for(s=[],e=0,i=(t=this.itemsAll()).length;e<i;e++)n=t[e],s.push(n[this.uniqKey]);return s},i.prototype.collectionOrderSet=function(t){return null==t&&(t=!1),t||(t=this.collectionOrderGet()),this.lastOrder=t},i.prototype.collectionSync=function(t,e){var n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k;if("destroy"===e){for(l=[],o=0,f=t.length;o<f;o++)c=t[o],l.push(c[this.uniqKey]);return this.queue.push(["domRemove",l]),void this.uIRunner()}if(_.isEmpty(this.renderList))return this.queue.push(["renderAll"]),void this.uIRunner();if(b=this.collectionOrderGet(),k=_.difference(this.lastOrder,b),n=_.difference(b,this.lastOrder),this.log("debug","collectionSync removedIds",k),this.log("debug","collectionSync addedIds",n),this.log("debug","collectionSync @lastOrder",this.lastOrder),this.log("debug","collectionSync newOrder",b),i=!1,!_.isEmpty(n)){for(d=[],p=0,m=(w=this.lastOrder).length;p<m;p++)a=w[p],_.contains(k,a)||d.push(a);if(this.log("debug","collectionSync lastOrderNew",d),r=App.Utils.diffPositionAdd(d,b),this.log("debug","collectionSync applyOrder",r),!r)return this.queue.push(["renderAll"]),void this.uIRunner();for(_.isEmpty(k)||(i=!0,this.queue.push(["domRemove",k]),this.uIRunner()),y=[],u=0,g=r.length;u<g;u++)s=r[u],(c=this.itemGet(s.id)).meta_position=s.position,y.push(c);this.queue.push(["domChange",y]),this.uIRunner()}for(i||_.isEmpty(k)||(this.queue.push(["domRemove",k]),this.uIRunner()),y=[],h=0,v=t.length;h<v;h++)c=t[h],_.contains(k,c.id)||_.contains(n,c.id)||y.push(c);return _.isEmpty(y)?void 0:(this.queue.push(["domChange",y]),this.uIRunner())},i.prototype.domRemove=function(t){var e,n,i;for(this.log("debug","domRemove",t),e=0,i=t.length;e<i;e++)n=t[e],this.itemAttributesDelete(n),this.renderList[n]&&(this.renderList[n].remove(),delete this.renderList[n]),this.onRemoved(n);return this.collectionOrderSet()},i.prototype.domChange=function(t){var e,n,i,s,r,o,a,l;for(this.log("debug","domChange items",t),this.log("debug","domChange @currentItems",this.currentItems),n=[],o=0,l=t.length;o<l;o++)if(a=t[o],this.log("debug","domChange|item",a),e=this.itemAttributes(a),i=this.itemAttributesGet(a[this.uniqKey])){for(r in this.log("debug","domChange|change",a),this.log("debug","domChange|change|observe attributes",this.observe),this.log("debug","domChange|change|current",i),this.log("debug","domChange|change|new",e),this.observe)if(this.log("debug","domChange|change|compare",r,i[r],e[r]),s=!_.isEqual(i[r],e[r]),this.log("debug","domChange|diff",s),s){n.push(a),this.itemAttributesSet(a[this.uniqKey],e);break}}else this.log("debug","domChange|add",a),n.push(a),this.itemAttributesSet(a[this.uniqKey],e);if(!_.isEmpty(n))return this.renderParts(n)},i.prototype.renderAll=function(){var t,e,n,i,s,r;for(i=this.itemsAll(),this.log("debug","renderAll",i),r=[],e=0,s=i.length;e<s;e++)n=i[e],t=this.itemAttributes(n),this.itemAttributesSet(n[this.uniqKey],t),r.push(this.renderItem(n,!1));return this.html(r),this.collectionOrderSet(),this.onRenderEnd()},i.prototype.itemDestroy=function(t){return App[this.model].destroy(t)},i.prototype.itemsAll=function(){return App[this.model].search({sortBy:this.sortBy,order:this.order})},i.prototype.itemAttributesDiff=function(t){var e,n,i,s;for(s in e=this.itemAttributes(t),n=this.itemAttributesGet(t[this.uniqKey]),this.observe)if(this.log("debug","itemAttributesDiff|compare",s,n[s],e[s]),i=!_.isEqual(n[s],e[s]))return this.log("debug","itemAttributesDiff|diff",i),!0;return!1},i.prototype.itemAttributesDelete=function(t){return delete this.currentItems[t]},i.prototype.itemAttributesGet=function(t){return this.currentItems[t]},i.prototype.itemAttributesSet=function(t,e){return this.currentItems[t]=e},i.prototype.itemAttributes=function(t){var e,n;for(n in e={},this.observe)e[n]=t[n];return e},i.prototype.itemGet=function(t){return App[this.model].find(t)},i.prototype.renderParts=function(t){var e,n,i;for(this.log("debug","renderParts",t),e=0,i=t.length;e<i;e++)n=t[e],this.renderList[n[this.uniqKey]]?this.renderItem(n,this.renderList[n[this.uniqKey]]):this.renderItem(n);return this.collectionOrderSet()},i.prototype.renderItem=function(t,e){var n,i,s,r;return this.prepareForObjectListItemSupport&&(t=this.prepareForObjectListItem(t)),this.log("debug","renderItem",t,this.template,e,this.renderList[t[this.uniqKey]]),i=$(App.view(this.template)({item:t})),this.onRenderItemEnd&&this.onRenderItemEnd(t,i),s=Object.keys(this.renderList).length,this.renderList[t[this.uniqKey]]=i,!1===e?i:e?e.replaceWith(i):((r=t.meta_position)<s&&(r+=1),(n=this.el.find(".js-item:nth-child("+r+")")).get(0)?"before"===this.insertPosition?n.before(i):n.after(i):void this.el.append(i))},i.prototype.onRenderEnd=function(){},i.prototype.location=function(t){return this.locationVerify(t)},i.prototype.click=function(t){var e;return e=$(t.target).closest(".js-item").data("id"),this.onClick(e,t)},i.prototype.onClick=function(){},i.prototype.remove=function(t){var e;return t.preventDefault(),t.stopPropagation(),e=$(t.target).closest(".js-item").data("id"),this.onRemove(e,t),this.itemDestroy(e)},i.prototype.onRemove=function(){},i.prototype.onRemoved=function(){},i}(App.Controller),App.ObserverController=function(t){function e(){var t;this.release=s(this.release,this),this.render=s(this.render,this),this.maybeRender=s(this.maybeRender,this),this.subscribe=s(this.subscribe,this),e.__super__.constructor.apply(this,arguments),this.log("debug","new",this.object_id,this.model),App[this.model].exists(this.object_id)?this.maybeRender(App[this.model].fullLocal(this.object_id)):App[this.model].full(this.object_id,this.maybeRender),this.globalRerender&&this.bind("ui:rerender",(t=this,function(){return t.lastAttributres=void 0,t.maybeRender(App[t.model].fullLocal(t.object_id))}))}return r(e,t),e.prototype.model="Ticket",e.prototype.template="tba",e.prototype.globalRerender=!0,e.prototype.subscribe=function(t,e){return this.maybeRender(t,e)},e.prototype.maybeRender=function(t,e){var n,i,s,r,o;if("remove"===e)return this.release(),void this.el.remove();if(this.log("debug","maybeRender",this.object_id,t,this.model),this.subscribeId||(this.subscribeId=t.subscribe(this.subscribe)),n={},this.observe)for(s in r=this.observe)r[s]&&(n[s]=t[s]);if(this.observeNot)for(s in t)o=t[s],"cid"===s||this.observeNot[s]||_.isFunction(o)||_.isObject(o)||(n[s]=o);if(this.lastAttributres){if(i=difference(n,this.lastAttributres),_.isEmpty(i))return void this.log("debug","maybeRender no diff, no rerender")}else this.lastAttributres={};return this.log("debug","maybeRender.diff",i,this.observe,this.model),this.lastAttributres=n,this.render(t,i)},e.prototype.render=function(t,e){if(this.log("debug","render",this.template,t,e),this.html(App.view(this.template)({object:t})),this.renderPost)return this.renderPost(t)},e.prototype.release=function(){return this.log("debug","release",this.object_id,this.model,this.subscribeId),App[this.model].unsubscribe(this.subscribeId)},e}(App.Controller),App.ObserverActionRow=function(t){function e(){this.render=s(this.render,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.render=function(n){var t,e,i,s,r;if(!_.isEmpty(n)){for(t=this.actions(n),this.html(App.view("generic/actions")({items:t,type:this.type})),r=[],e=0,s=t.length;e<s;e++)i=t[e],r.push(function(t){return function(e){return t.$('[data-type="'+e.name+'"]').on("click",function(t){return t.preventDefault(),e.callback(n)})}}(this)(i));return r}},e}(App.ObserverController),App.Import=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.content=s(this.content,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="Import",e.prototype.autoFocusOnFirstInput=!1,e.prototype.head="Import",e.prototype.large=!0,e.prototype.templateDirectory="generic/object_import",e.prototype.baseUrl="/api/v1/text_modules",e.prototype.content=function(){var t,e;return t=$(App.view(this.templateDirectory+"/index")({head:"Import",import_example_url:this.baseUrl+"/import_example",deleteOption:this.deleteOption})),this.data&&(e=App.view(this.templateDirectory+"/result")(this.data),t.find(".js-error").html(e),e?t.find(".js-error").removeClass("hide"):t.find(".js-error").addClass("hide")),t},e.prototype.onSubmit=function(n){var e,i,s;return(e=new FormData($(n.currentTarget).closest("form").get(0))).set("try",!0),_.isEmpty(e.get("data"))&&e["delete"]("data"),this.formDisable(n),this.ajax({id:"csv_import",type:"POST",url:this.baseUrl+"/import",processData:!1,contentType:!1,cache:!1,data:e,success:(s=this,function(t){return"success"===t.result?(new App.ImportTryResult({container:s.el.closest(".content"),result:t,params:e,templateDirectory:s.templateDirectory,baseUrl:s.baseUrl}),void s.close()):(s.data=t,s.update(),s.formEnable(n))}),error:(i=this,function(t){var e;return e=t.responseJSON||{},i.notify({type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to import!"),timeout:6e3}),i.formEnable(n)})})},e}(App.ControllerModal),App.ImportTryResult=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.content=s(this.content,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="Yes, start real import.",e.prototype.autoFocusOnFirstInput=!1,e.prototype.head="Import",e.prototype.large=!0,e.prototype.templateDirectory="generic/object_import/",e.prototype.baseUrl="/api/v1/text_modules",e.prototype.content=function(){var t,e;return t=$(App.view(this.templateDirectory+"/import_try")({head:"Import",import_example_url:this.baseUrl+"/import",result:this.result})),this.data&&(e=App.view(this.templateDirectory+"/result")(this.data),t.find(
".js-error").html(e),e?t.find(".js-error").removeClass("hide"):t.find(".js-error").addClass("hide")),t},e.prototype.onSubmit=function(n){return this.params.set("try",!1),this.formDisable(n),this.ajax({id:"csv_import",type:"POST",url:this.baseUrl+"/import",processData:!1,contentType:!1,cache:!1,data:this.params,success:(e=this,function(t){return"success"===t.result?(new App.ImportResult({container:e.el.closest(".content"),result:t,params:e.params,templateDirectory:e.templateDirectory,baseUrl:e.baseUrl}),void e.close()):(e.data=t,e.update(),e.formEnable(n))}),error:(i=this,function(t){var e;return e=t.responseJSON||{},i.notify({type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to import!"),timeout:6e3}),i.formEnable(n)})});var i,e},e}(App.ControllerModal),App.ImportResult=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.content=s(this.content,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="Close",e.prototype.autoFocusOnFirstInput=!1,e.prototype.head="Import",e.prototype.large=!0,e.prototype.templateDirectory="generic/object_import/",e.prototype.content=function(){return $(App.view(this.templateDirectory+"/imported")({head:"Imported",result:this.result}))},e.prototype.onSubmit=function(){return this.close()},e}(App.ControllerModal)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ControllerReorderModal=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.head="Drag to reorder",e.prototype.content=function(){var t,e;return e=$(App.view("reorder_modal")()),t=new App.ControllerTable({baseColWidth:null,dndCallback:function(){return!0},overview:["title"],attribute_list:[{name:"title",display:"Name"}],objects:this.items}),e.find(".js-table-container").html(t.el),e},e.prototype.onShown=function(){return e.__super__.onShown.apply(this,arguments),this.$(".js-submit").focus()},e.prototype.save=function(){var t,n,e;return t=this.$("tr.item").toArray().map(function(t){return parseInt(t.dataset.id)}),this.$(".alert").addClass("hidden"),this.formDisable(this.el),this.ajax({id:"reorder_save",type:"PATCH",data:JSON.stringify({ordered_ids:t}),url:this.url,processData:!0,success:(e=this,function(t){return App.Collection.loadAssets(t),App.Event.trigger("knowledge_base::sidebar::rerender"),e.close()}),error:(n=this,function(t){var e;return e=JSON.parse(t.responseText),n.$(".alert--danger").removeClass("hidden").text(e.error),n.formEnable(n.el)})})},e.prototype.onSubmit=function(){return e.__super__.onSubmit.apply(this,arguments),this.save()},e}(App.ControllerModal)}.call(this),function(){var o=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty,C=[].slice;App.ControllerTable=function(t){function r(){var t,e,n,i,s;if(this.getBulkSelected=o(this.getBulkSelected,this),this.preferencesStoreKey=o(this.preferencesStoreKey,this),this.preferencesGet=o(this.preferencesGet,this),this.sortByColumn=o(this.sortByColumn,this),this.onColResizeMouseup=o(this.onColResizeMouseup,this),this.onColResizeMousemove=o(this.onColResizeMousemove,this),this.onColResizeMousedown=o(this.onColResizeMousedown,this),this.onResize=o(this.onResize,this),this.setHeaderWidths=o(this.setHeaderWidths,this),this.toggleActionDropdown=o(this.toggleActionDropdown,this),this.runAction=o(this.runAction,this),this.onActionButtonClicked=o(this.onActionButtonClicked,this),this.sortList=o(this.sortList,this),this.objectsOfPage=o(this.objectsOfPage,this),this.setMaxPage=o(this.setMaxPage,this),this.tableHeaders=o(this.tableHeaders,this),this.tableHeadersHasChanged=o(this.tableHeadersHasChanged,this),this.renderTableRow=o(this.renderTableRow,this),this.renderTableGroupByRow=o(this.renderTableGroupByRow,this),this.renderTableRows=o(this.renderTableRows,this),this.renderTableContainer=o(this.renderTableContainer,this),this.renderTableFull=o(this.renderTableFull,this),this.renderEmptyList=o(this.renderEmptyList,this),this.render=o(this.render,this),this.renderPager=o(this.renderPager,this),this.renderQueue=o(this.renderQueue,this),this.update=o(this.update,this),this.release=o(this.release,this),this.show=o(this.show,this),r.__super__.constructor.apply(this,arguments),this.model||(this.model={}),this.overviewAttributes||(this.overviewAttributes=this.overview||this.model.configure_overview||[]),this.attributesListRaw||(this.attributesListRaw=this.attribute_list||this.model.configure_attributes||{}),this.attributesList=App.Model.attributesGet(!1,this.attributesListRaw),this.destroy=this.model.configure_delete,this.clone=this.model.configure_clone,_.isEmpty(this.overviewAttributes))throw"overviewAttributes needed";if(_.isEmpty(this.attributesList))throw"attributesList needed";if(t={},this.tableId&&(t=this.preferencesGet()).order)for(e in n=t.order)s=n[e],this[e]=s;if(t.headerWidth)for(e in i=t.headerWidth)s=i[e],this.headerWidth[e]=s;this.availableWidth||(this.availableWidth=this.el.width(),0===this.availableWidth&&(this.availableWidth=this.minTableWidth)),this.renderQueue()}return e(r,t),r.prototype.minColWidth=30,r.prototype.baseColWidth=130,r.prototype.minTableWidth=612,r.prototype.checkBoxColWidth=30,r.prototype.radioColWidth=22,r.prototype.sortableColWidth=36,r.prototype.events={"click .js-sort":"sortByColumn"},r.prototype.overviewAttributes=void 0,r.prototype.objects=[],r.prototype.checkbox=!1,r.prototype.radio=!1,r.prototype.renderState=void 0,r.prototype.groupBy=void 0,r.prototype.groupDirection=void 0,r.prototype.shownPerPage=150,r.prototype.shownPage=0,r.prototype.destroy=!1,r.prototype.customActions=[],r.prototype.columnsLength=void 0,r.prototype.headers=void 0,r.prototype.headerWidth={},r.prototype.currentRows=[],r.prototype.orderDirection="ASC",r.prototype.orderBy=void 0,r.prototype.lastOrderDirection=void 0,r.prototype.lastOrderBy=void 0,r.prototype.lastOverview=void 0,r.prototype.customOrderDirection=void 0,r.prototype.customOrderBy=void 0,r.prototype.frontendTimeUpdateExecute=!0,r.prototype.bindCol={},r.prototype.bindRow={},r.prototype.show=function(){if(!0===this.windowIsResized)return this.windowIsResized=!1,this.onResize()},r.prototype.hide=function(){},r.prototype.release=function(){return $(window).off("resize.table",this.onResize)},r.prototype.update=function(t){var e,n;if(!0!==t.sync)return this.renderQueue(t);for(e in t)n=t[e],this[e]=n;return this.render()},r.prototype.renderQueue=function(n){var t,i;return i=this,t=function(){var t,e;for(t in n)e=n[t],i[t]=e;return i.render()},App.QueueManager.add("tableRender",t),App.QueueManager.run("tableRender")},r.prototype.renderPager=function(t,e){var n,i;if(null==e&&(e=!1),!((i=parseInt((this.objects.length-1)/this.shownPerPage))<1))return n=App.view("generic/table_pager")({page:this.shownPage,pages:i}),e?t.find(".js-pager").html(n):t.filter(".js-pager").html(n);e?t.find(".js-pager").html(""):t.filter(".js-pager").html("")},r.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g;if(this.setMaxPage(),void 0===this.renderState)return _.isEmpty(this.objects)?(this.renderState="emptyList",this.el.html(this.renderEmptyList()),$(window).on("resize.table",this.onResize),["emptyList.new"]):(this.renderState="List",this.renderTableFull(),$(window).on("resize.table",this.onResize),["fullRender.new"]);if("emptyList"===this.renderState&&!_.isEmpty(this.objects))return this.renderState="List",this.renderTableFull(),["fullRender"];if("emptyList"!==this.renderState&&_.isEmpty(this.objects))return this.renderState="emptyList",this.el.html(this.renderEmptyList()),["emptyList"];if(this.tableHeadersHasChanged())return this.renderTableFull(),["fullRender.overviewAttributesChanged"];if(c=this.renderTableRows(!0),m=_.difference(this.currentRows,c),e=_.difference(c,this.currentRows),this.log("debug","table newRows",c),this.log("debug","table removedRows",m),this.log("debug","table addedRows",e),(!_.isEmpty(e)||!_.isEmpty(m))&&e.length<10&&m.length<15&&m.length<c.length&&!_.isEmpty(c)){for(l=[],f=[],p=n=0,u=this.currentRows.length-1;0<=u?n<=u:u<=n;p=0<=u?++n:--n)_.contains(m,this.currentRows[p])?f.push(p):l.push(this.currentRows[p]);for(t=[],p=i=0,h=c.length-1;0<=h?i<=h:h<=i;p=0<=h?++i:--i)_.contains(e,c[p])&&(t.push(p),l.splice(p,0,c[p]));if(!0===this._isSame(c,l)){for(s=0,r=(d=f.reverse()).length;s<r;s++)p=d[s],this.$("tbody > tr:nth-child("+(p+1)+")").remove();for(a=0,o=t.length;a<o;a++)0===(p=t[a])?this.$("tbody tr:nth-child(1)").get(0)?this.$("tbody tr:nth-child(1)").before(l[p]):this.$("tbody").append(l[p]):this.$("tbody > tr:nth-child("+p+")").after(l[p]);return this.currentRows=l,this.log("debug","table.fullRender.contentRemoved",f,t),this.renderPager(this.el,!0),!0===this.frontendTimeUpdateExecute&&this.frontendTimeUpdateElement(this.el),["fullRender.contentRemoved",f,t]}}return c.length!==this.currentRows.length?(g=["fullRender.lenghtChanged",this.currentRows.length,c.length],this.renderTableFull(c),this.log("debug","table.fullRender.lenghtChanged",g),g):!0!==(g=this._isSame(c,this.currentRows))?(this.renderTableFull(c),this.log("debug","table.fullRender.contentChanged|row("+g+")"),["fullRender.contentChanged",g]):(this.log("debug","table.noChanges"),["noChanges"])},r.prototype.renderEmptyList=function(){return App.view("generic/admin/empty")({explanation:this.explanation})},r.prototype.renderTableFull=function(t,e){var n,o,i,s,r,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T,A,S;if(null==e&&(e={}),this.log("debug","table.renderTableFull",this.orderBy,this.orderDirection),this.tableHeaders(e),this.sortList(),n=this.getBulkSelected(),i=this.renderTableContainer(),t||(t=this.renderTableRows()),this.currentRows=clone(t),i.find(".js-tableBody").html(t),!0===this.frontendTimeUpdateExecute&&this.frontendTimeUpdateElement(i),this.renderPager(i),s={click:"pointer",dblclick:"pointer"},!_.isEmpty(this.bindCol))for(g in y=this.bindCol)if((d=y[g]).events){for(v=0,this.dndCallback&&(v+=1),this.checkbox&&(v+=1),h=!1,f=0,m=(b=this.headers).length;f<m;f++)u=b[f],h||(v+=1),u.name!==g&&u.name!==g+"_id"&&u.name!==g+"_bulkIds"||(h=!0);if(h)for(a in l=function(t,e,n){return s[e]&&t.find("tbody > tr > td:nth-child("+v+")").css("cursor",s[e]),t.on(e,"tbody > tr > td:nth-child("+v+")",function(t){var e;return t.stopPropagation(),e=$(t.target).parents("tr").data("id"),n(e,t,t.currentTarget)})},w=d.events)o=w[a],l(i,a,o)}if(!_.isEmpty(this.bindRow)&&this.bindRow.events)for(a in c=function(t,e,n){return s[e]&&t.find("tbody > tr").css("cursor",s[e]),t.on(e,"tbody > tr",function(t){var e;return e=$(t.target).parents("tr").data("id"),n(e,t)})},k=this.bindRow.events)o=k[a],c(i,a,o);if(this.bindCheckbox&&this.bindCheckbox.events)for(a in p=function(t,e,i){return t.delegate('input[name="bulk"]',e,function(t){var e,n;return t.stopPropagation(),n=$(t.currentTarget).parents("tr").data("id"),e=$(t.currentTarget).prop("checked"),i(n,e,t)})},T=this.bindCheckbox.events)o=T[a],p(i,a,o);return this.tableId&&(i.on("mousedown",".js-col-resize",this.onColResizeMousedown),i.on("click",".js-col-resize",this.stopPropagation)),this.checkbox&&(i.delegate("tr > td:nth-child(1)","click",function(t){return t.stopPropagation()}),i.delegate('input[name="bulk_all"]',"change",(A=this,function(i){var s,r,t,e,n;if(i.stopPropagation(),r=[],$(i.currentTarget).prop("checked")?$(i.currentTarget).parents("table").find('[name="bulk"]').each(function(){var t,e;if(!(t=$(this)).prop("checked"))return t.prop("checked",!0),e=t.parents("tr").data("id"),r.push([e,!0])}):$(i.currentTarget).parents("table").find('[name="bulk"]').each(function(){var t,e;if((t=$(this)).prop("checked"))return t.prop("checked",!1),e=t.parents("tr").data("id"),r.push([e,!1])}),A.bindCheckbox&&A.bindCheckbox.events&&!_.isEmpty(r)){if(!A.bindCheckbox.select_all){for(a in n=[],e=A.bindCheckbox.events)o=e[a],"click"===a||"change"===a?n.push(function(){var t,e,n;for(n=[],t=0,e=r.length;t<e;t++)s=r[t],n.push(o.apply(null,C.call(s).concat([i])));return n}()):n.push(void 0);return n}(t=A.bindCheckbox).select_all.apply(t,C.call(r[0]).concat([i]))}}))),this.dndCallback&&(r={tolerance:"pointer",distance:15,opacity:.6,forcePlaceholderSize:!0,items:"tr",helper:function(t,e){var n,i;return i=e.children(),(n=e.clone()).children().each(function(t){return $(this).width(i.eq(t).outerWidth())}),n},update:this.dndCallback},i.find("tbody").sortable(r)),i.delegate(".js-page","click",(S=this,function(t){var e,n;return t.stopPropagation(),e=$(t.currentTarget).attr("data-page"),n=function(){return S.shownPage=e,S.renderTableFull()},App.QueueManager.add("tableRender",n),App.QueueManager.run("tableRender")})),this.el.html(i),this.setBulkSelected(n)},r.prototype.renderTableContainer=function(){return $(App.view("generic/table")({tableId:this.tableId,headers:this.headers,checkbox:this.checkbox,radio:this.radio,"class":this["class"],sortable:this.dndCallback}))},r.prototype.renderTableRows=function(t){var e,n,i,s,r,o,a,l;for(null==t&&(t=!1),!0===t&&this.sortList(),a=0,this.headers.length,(this.checkbox||this.radio)&&0,n="",l=[],i=0,s=(o=this.objectsOfPage(this.shownPage)).length;i<s;i++)(r=o[i])&&(a++,this.groupBy&&n!==(e=App.viewPrint(r,this.groupBy,this.attributesList))&&(n=e,l.push(this.renderTableGroupByRow(r,a,e))),l.push(this.renderTableRow(r,a)));return l},r.prototype.renderTableGroupByRow=function(t,e,n){var i,s,r,o,a,l;if(!(s=void 0)===this.Config.get("ui_table_group_by_show_count")&&(i=this.groupBy,(r=t[this.groupBy])||(r=t[i=this.groupBy+"_id"]),s=0,this.objects))for(o=0,a=(l=this.objects).length;o<a;o++)l[o][i]===r&&(s+=1);return App.view("generic/table_row_group_by")({position:e,groupByName:n,groupByCount:s,columnsLength:this.columnsLength})},r.prototype.renderTableRow=function(t,e){return App.view("generic/table_row")({headers:this.headers,attributes:this.attributesList,checkbox:this.checkbox,radio:this.radio,callbacks:this.callbackAttributes,sortable:this.dndCallback,position:e,object:t,actions:this.actions})},r.prototype.tableHeadersHasChanged=function(){return this.overviewAttributes!==this.lastOverview},r.prototype.tableHeaders=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y;if(null==t&&(t={}),p=this.customOrderBy||this.orderBy,u=this.customOrderDirection||this.orderDirection,this.headers&&this.lastOrderBy===p&&this.lastOrderDirection===u&&!this.tableHeadersHasChanged())return this.log("debug","table.Headers: same overviewAttributes just return headers",this.headers),["headers are the same",this.headers];for(this.lastOverview=this.overviewAttributes,this.headers=[],this.actions=[].concat(this.customActions),i=this.availableWidth,o=0,l=(h=this.overviewAttributes).length;o<l;o++)for(n in r=h[o],!1,d=this.attributesList)e=d[n],this.groupBy&&this.groupBy===r||(e.style||(e.style={}),n!==r&&n!==r+"_id"&&n!==r+"_ids"||(!0,t.skipHeadersResize||(this.headerWidth[e.name]?e.displayWidth=this.headerWidth[e.name]*i:e.width?(g=parseInt(e.width,10),m=e.width.match(/[px|%]+/)[0],e.displayWidth="%"===m?g/100*i:g):e.displayWidth=this.baseColWidth),this.headers.push(e)));if(this.callbackHeader)for(a=0,c=(f=this.callbackHeader).length;a<c;a++)s=f[a],this.headers=s(this.headers);if(_.isEmpty(this.headers))throw"no headers found";return this.clone&&this.actions.push({name:"clone",display:"Clone",icon:"clipboard","class":"create  js-clone",callback:(v=this,function(t){return(r=v.model.find(t)).name="Clone: "+r.name,new App.ControllerGenericNew({item:r,pageData:{object:r.constructor.className},callback:function(){return v.renderTableFull()},genericObject:r.constructor.className,container:v.container})})}),this.destroy&&this.actions.push({name:"delete",display:"Delete",icon:"trash","class":"danger js-delete",callback:(y=this,function(t){return r=y.model.find(t),new App.ControllerGenericDestroyConfirm({item:r,container:y.container})})}),this.actions.length&&(this.headers.push({name:"action",display:"Action",width:"50px",displayWidth:50,align:"right",parentClass:"noTruncate no-padding",unresizable:!0}),this.bindCol.action={events:{click:this.toggleActionDropdown}}),this.calculateHeaderWidths(),this.storeHeaderWidths(),this.columnsLength=this.headers.length,(this.checkbox||this.radio)&&this.columnsLength++,this.log("debug","table.Headers: new headers",this.headers),["new headers",this.headers]},r.prototype.setMaxPage=function(){var t;if(t=parseInt((this.objects.length-1)/this.shownPerPage),parseInt(this.shownPage)>t)return this.shownPage=t},r.prototype.objectsOfPage=function(t){return null==t&&(t=0),t=parseInt(t),this.objects.slice(t*this.shownPerPage,(t+1)*this.shownPerPage)},r.prototype.sortList=function(){var n,t,e,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T;if(!(_.isEmpty(this.objects)||(g=this.customOrderBy||this.orderBy,v=this.customOrderDirection||this.orderDirection,this.log("debug","table.order",this.orderBy,this.orderDirection),this.log("debug","table.customOrder",this.customOrderBy,this.customOrderDirection),_.isEmpty(g)&&_.isEmpty(this.groupBy)||this.lastSortedobjects===this.objects&&this.lastOrderDirection===v&&this.lastOrderBy===g))){if(this.lastOrderDirection=v,k=function(t,e){return _.sortBy(t,function(t){return e(t)||"\uffff"})},this.lastOrderBy=g){for(a=0,u=(y=this.headers).length;a<u;a++)(r=y[a]).name===g||r.name+"_id"===g||r.name===g+"_id"?(f=k(this.objects,function(t){var e;return t?r.translate?App.i18n.translateInline(t[r.name]):r.relation?t[r.name]&&(e=App[r.relation].findNative(t[r.name]))?(e.displayName&&(e=e.displayName().toLowerCase()),e.name&&(e=e.name.toLowerCase()),e):"":t[r.name]:(console.log("Got empty object in order by with header _.sortBy"),"")}),"DESC"===v?(r.sortOrderIcon=["arrow-down","table-sort-arrow"],f=f.reverse()):r.sortOrderIcon=["arrow-up","table-sort-arrow"]):r.sortOrderIcon=void 0;if(!f)for(t in b=this.attributesList)n=b[t],t!==g&&t+"_id"!==g&&t!==g+"_id"||(f=_.sortBy(this.objects,function(t){var e;return t?n.translate?App.i18n.translateInline(t[n.name]):n.relation?t[n.name]&&(e=App[n.relation].findNative(t[n.name]))?(e.displayName&&(e=e.displayName().toLowerCase()),e.name&&(e=e.name.toLowerCase()),e):"":t[n.name]:(console.log("Got empty object in order by in attribute _.sortBy"),"")}),"DESC"===v&&(f=f.reverse()));f?this.objects=f:console.log("Unable to orderBy objects, no attribute found with name "+g)}if(this.groupBy){for(i={},l=0,h=(w=this.objects).length;l<h;l++)(e=(m=w[l])[this.groupBy])||m[T=this.groupBy+"_id"]&&this.attributesList[T]&&this.attributesList[T].relation&&App[this.attributesList[T].relation].exists(m[T])&&((o=App[this.attributesList[T].relation].findNative(m[T]))&&o.displayName?e=o.displayName().toLowerCase():o.name&&(e=o.name.toLowerCase())),_.isEmpty(e)&&(e=""),e.displayName?e=e.displayName().toLowerCase():e.name&&(e=e.name.toLowerCase()),i[e]||(i[e]=[]),i[e].push(m);for(c in s=[],i)s.push(c);for(s=s.sort(),"DESC"===this.groupDirection&&s.reverse(),f=[],p=0,d=s.length;p<d;p++)e=s[p],f=f.concat(i[e]),i[e]=[]}if(void 0!==f)return this.objects=f,this.lastSortedobjects=f}},r.prototype.onActionButtonClicked=function(t){var e,n;return e=$(t.currentTarget).parents("tr").data("id"),n=t.currentTarget.getAttribute("data-table-action"),this.runAction(n,e),console.log("onActionButtonClicked")},r.prototype.runAction=function(t,e){return _.findWhere(this.actions,{name:t}).callback(e)},r.prototype.toggleActionDropdown=function(t,e,n){var i,s;return e.stopPropagation(),(i=$(n).find(".js-table-action-menu")).length?(i.dropdown("toggle"),i.one("click.dropdown","[data-table-action]",this.onActionButtonClicked),i.parent().one("hide.bs.dropdown",function(){return i.off("click.dropdown")})):(s=$(n).find("[data-table-action]").attr("data-table-action"),this.runAction(s,t))},r.prototype.calculateHeaderWidths=function(){var t,e,n,i;if(this.tableId&&this.headers)return t=this.availableWidth,this.headers=_.map(this.headers,function(t){return t.displayWidth=Math.floor(t.displayWidth),t}),n=Math.ceil((this.getHeaderWidths()-t)/this.getShrinkableHeadersCount()),this.headers=_.map(this.headers,(i=this,function(t){return t.unresizable||(t.displayWidth=Math.max(i.minColWidth,t.displayWidth-n)),t})),0<(e=t-this.getHeaderWidths())&&e<10&&(this.headers[this.headers.length-1].displayWidth=this.headers[this.headers.length-1].displayWidth+e),!0},r.prototype.getShrinkableHeadersCount=function(){return _.reduce(this.headers,function(t,e){return e.unresizable?t:t+1},0)},r.prototype.getHeaderWidths=function(){var t;return t=_.reduce(this.headers,function(t,e){return t+e.displayWidth},0),this.checkbox&&(t+=this.checkBoxColWidth),this.radio&&(t+=this.radioColWidth),this.dndCallback&&(t+=this.sortableColWidth),t},r.prototype.setHeaderWidths=function(){var n;if(this.calculateHeaderWidths())return this.$(".js-tableHead").each((n=this,function(t,e){return e.style.width=n.headers[t].displayWidth+"px"})),this.storeHeaderWidths()},r.prototype.storeHeaderWidths=function(){var t,e,n,i,s;for(s={},e=0,n=(i=this.headers).length;e<n;e++)s[(t=i[e]).name]=t.displayWidth/this.availableWidth;return this.headerWidth=s,App.LocalStorage.set(this.preferencesStoreKey(),{headerWidth:s},this.Session.get("id"))},r.prototype.onResize=function(){var t,e,n;if(0!==(e=this.el.width()))return this.availableWidth=e,t=function(){var t;return t=function(){return n.availableWidth=n.el.width(),n.setHeaderWidths()},App.QueueManager.add("tableRender",t),App.QueueManager.run("tableRender")},(n=this).delay(t,200,"table-resize-finish");this.windowIsResized=!0},r.prototype.stopPropagation=function(t){return t.stopPropagation()},r.prototype.onColResizeMousedown=function(t){return this.resizeTargetLeft=$(t.currentTarget).parents("th"),this.resizeTargetRight=this.resizeTargetLeft.next(),this.resizeStartX=t.pageX,this.resizeLeftStartWidth=this.resizeTargetLeft.width(),this.resizeRightStartWidth=this.resizeTargetRight.width(),$(document).on("mousemove.resizeCol",this.onColResizeMousemove),$(document).one("mouseup",this.onColResizeMouseup),this.tableWidth=this.el.width()},r.prototype.onColResizeMousemove=function(t){var e;return e="rtl"===App.i18n.dir()?this.resizeStartX-t.pageX:t.pageX-this.resizeStartX,this.resizeLeftStartWidth+e<this.minColWidth&&(e=-(this.resizeLeftStartWidth-this.minColWidth)),this.resizeRightStartWidth-e<this.minColWidth&&(e=this.resizeRightStartWidth-this.minColWidth),this.resizeTargetLeft.width(this.resizeLeftStartWidth+e),this.resizeTargetRight.width(this.resizeRightStartWidth-e)},r.prototype.onColResizeMouseup=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h;for($(document).off("mousemove.resizeCol"),c=this.resizeTargetLeft.parents("table").width(),s=this.resizeTargetLeft.outerWidth()/c,h=this.resizeTargetRight.outerWidth()/c,i=this.resizeTargetLeft.attr("data-column-key"),u=this.resizeTargetRight.attr("data-column-key"),this.preferencesStore("headerWidth",i,s),this.headerWidth[i]=s,e=0,r=(a=this.headers).length;e<r;e++)(t=a[e]).name===i&&(t.displayWidth=this.resizeTargetLeft.outerWidth());if(u){for(this.preferencesStore("headerWidth",u,h),this.headerWidth[u]=h,p=[],n=0,o=(l=this.headers).length;n<o;n++)(t=l[n]).name===u?p.push(t.displayWidth=this.resizeTargetRight.outerWidth()):p.push(void 0);return p}},r.prototype.sortByColumn=function(t){var e,n,i,s,r;return e=$(t.currentTarget).closest("[data-column-key]").attr("data-column-key"),n=this.customOrderBy||this.orderBy,i=this.customOrderDirection||this.orderDirection,n!==e?(n=e,i="ASC"):i="ASC"===i?"DESC":"ASC",this.orderBy=n,this.orderDirection=i,this.customOrderBy=n,this.customOrderDirection=i,this.preferencesStore("order","customOrderBy",this.orderBy),this.preferencesStore("order","customOrderDirection",this.orderDirection),r=this,s=function(){return r.renderTableFull(!1,{skipHeadersResize:!0})},App.QueueManager.add("tableRender",s),App.QueueManager.run("tableRender")},r.prototype.preferencesStore=function(t,e,n){var i;return(i=this.preferencesGet())[t]||(i[t]={}),i[t][e]||(i[t][e]={}),i[t][e]=n,App.LocalStorage.set(this.preferencesStoreKey(),i,this.Session.get("id"))},r.prototype.preferencesGet=function(){return App.LocalStorage.get(this.preferencesStoreKey(),this.Session.get("id"))||{}},r.prototype.preferencesStoreKey=function(){return"tablePrefs:"+this.tableId},r.prototype.getBulkSelected=function(){var i;return i=[],this.$('[name="bulk"]:checked').each(function(t,e){var n;return n=$(e).val(),i.push(n)}),i},r.prototype.setBulkSelected=function(o){return this.$('[name="bulk"]').each(function(t,e){var n,i,s,r;for(n=$(e).val(),r=[],i=0,s=o.length;i<s;i++)o[i]===n?r.push($(e).prop("checked",!0)):r.push(void 0);return r})},r.prototype._isSame=function(t,e){var n,i,s;for(i=n=0,s=t.length-1;0<=s?n<=s:s<=n;i=0<=s?++n:--n)if(t[i]!==e[i])return i;return!0},r}(App.Controller)}.call(this),function(){var n,i=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;App.ChannelChat=function(t){function e(){this.updateParams=i(this.updateParams,this),this.toggleChatBotSetting=i(this.toggleChatBotSetting,this),this.toggleChatSetting=i(this.toggleChatSetting,this),this.toggleChat=i(this.toggleChat,this),this.onColorPicked=i(this.onColorPicked,this),this.renderDemoWebsite=i(this.renderDemoWebsite,this),this.updatePreview=i(this.updatePreview,this),this.selectBrowserWidth=i(this.selectBrowserWidth,this),this.render=i(this.render,this),this.load=i(this.load,this),e.__super__.constructor.apply(this,arguments),this.Session.get("email")&&(this.previewUrl="www."+this.Session.get("email").replace(/^.+?\@/,"")),this.load(),this.permanent={chatId:1},this.widgetDesignerPermanentParams={id:"id"},$(window).on("resize.chat-designer",this.resizeDemo)}return s(e,t),e.prototype.requiredPermission="admin.channel_chat",e.prototype.header="Chat",e.prototype.events={"change .js-params":"updateParams","input .js-params":"updateParams","submit .js-demo-head":"onUrlSubmit","click .js-selectBrowserWidth":"selectBrowserWidth","click .js-swatch":"usePaletteColor","click .js-toggle-chat":"toggleChat","change .js-chatSetting input":"toggleChatSetting","change .js-chatBotSetting input":"toggleChatBotSetting","click .js-eyedropper":"pickColor"},e.prototype.elements={".js-browser":"browser",".js-browserBody":"browserBody",".js-screenshot":"screenshot",".js-website":"website",".js-chat":"chat",".js-chatHeader":"chatHeader",".js-chat-welcome":"chatWelcome",".js-testurl-input":"urlInput",".js-backgroundColor":"chatBackground",".js-code":"code",".js-palette":"palette",".js-color":"colorField",".js-chatSetting input":"chatSetting",".js-chatBotSetting input":"chatBotSetting",".js-eyedropper":"eyedropper"},e.prototype.apiOptions=[{name:"chatId","default":"1",type:"Number",description:"Identifier of the chat-topic."},{name:"show","default":!0,type:"Boolean",description:"Show the chat when ready."},{name:"target","default":"$('body')",type:"jQuery Object",description:"Where to append the chat to."},{name:"host","default":"(Empty)",type:"String",description:"If left empty, the host gets auto-detected - in this case %s. The auto-detection reads out the host from the <script> tag. If you don't include it via a <script> tag you need to specify the host.",descriptionSubstitute:window.location.origin},{name:"debug","default":!1,type:"Boolean",description:"Enables console logging."},{name:"title","default":"'<strong>Chat</strong> with us!'",type:"String",description:"Welcome Title shown on the closed chat. Can contain HTML."},{name:"fontSize","default":"undefined",type:"String",description:"CSS font-size with a unit like 12px, 1.5em. If left to undefined it inherits the font-size of the website."},{name:"flat","default":"false",type:"Boolean",description:"Removes the shadows for a flat look."},{name:"buttonClass","default":"'open-zammad-chat'",type:"String",description:"Add this class to a button on your page that should open the chat."},{name:"inactiveClass","default":"'is-inactive'",type:"String",description:"This class gets added to the button on initialization and gets removed once the chat connection got established."},{name:"cssAutoload","default":"true",type:"Boolean",description:"Automatically loads the chat.css file. If you want to use your own css, just set it to false."},{name:"cssUrl","default":"undefined",type:"String",description:"Location of an external chat.css file."}],e.prototype.isOpen=!0,e.prototype.browserWidth=1280,e.prototype.browserWidthMax=1280,e.prototype.previewUrl="",e.prototype.previewScale=1,e.prototype.load=function(){return this.startLoading(),this.ajax({id:"chat_index",type:"GET",url:this.apiPath+"/chats",processData:!0,success:(n=this,function(t){var e;return App.Collection.loadAssets(t.assets),(e=App.Chat.first())&&(n.permanent={chatId:e.id}),n.stopLoading(),n.render(t)})});var n},e.prototype.render=function(t){return null==t&&(t={}),this.html(App.view("channel/chat")({baseurl:window.location.origin,apiOptions:this.apiOptions,previewUrl:this.previewUrl,chatSetting:this.Config.get("chat"),chatBotSetting:this.Config.get("chatbot_status")})),new n({el:this.$(".js-topics")}),this.code.each(function(t,e){return hljs.highlightBlock(e)}),this.updatePreview(),this.updateParams(),this.changeDemoWebsite(),$(window).on("resize.chat-designer",(e=this,function(){return e.updatePreview(!1)}));var e},e.prototype.release=function(){return $(window).off("resize.chat-designer"),this.website.off("click.eyedropper")},e.prototype.selectBrowserWidth=function(t){var e;return(e=$(t.target).closest("[data-value]")).addClass("is-selected").siblings().removeClass("is-selected"),this.browserWidth=e.attr("data-value"),this.updatePreview()},e.prototype.updatePreview=function(t){var e;if(null==t&&(t=!0),e=parseInt(this.browserWidth,10),this.chat.removeClass("is-fullscreen").toggleClass("no-transition",!t).css("transform","translateY("+this.getChatOffset()+"px)"),this.browser.css("width",""),this.website.css({transform:"",width:"",height:""}),this.previewScale=1,"fit"!==this.browserWidth)return e<this.el.width()&&375===e?(this.chat.addClass("is-fullscreen").css("transform","translateY("+this.getChatOffset(!0)+"px)"),this.browser.css("width",e+"px")):(this.el.width()>e&&e===this.browserWidthMax?this.previewScale=1:this.previewScale=this.el.width()/e,this.chat.css("transform","translateY("+this.getChatOffset()*this.previewScale+"px) scale("+this.previewScale+")"),this.website.css({transform:"scale("+this.previewScale+")",width:this.el.width()/this.previewScale,height:this.browserBody.height()/this.previewScale}))},e.prototype.getChatOffset=function(t){return this.isOpen?0:t?this.browserBody.height()-this.chatHeader.outerHeight():this.chat.height()-this.chatHeader.outerHeight()},e.prototype.onUrlSubmit=function(t){return t&&t.preventDefault(),this.urlInput.focus(),this.changeDemoWebsite()},e.prototype.changeDemoWebsite=function(){if(""!==this.urlInput.val()&&this.urlInput.val()!==this.urlCache)return this.urlCache=this.urlInput.val(),this.url=this.urlCache,this.url.startsWith("http")||(this.url="http://"+this.url),this.urlInput.addClass("is-loading"),this.palette.empty(),this.screenshot.attr("src",""),$.ajax({url:"https://images.zammad.com/api/v1/webpage/combined",data:{url:this.url,count:20},success:this.renderDemoWebsite,dataType:"json"})},e.prototype.renderDemoWebsite=function(t){return this._screenshotSource=t.data_url,this.screenshot.attr("src",this._screenshotSource),this.renderPalette(t.palette),this.urlInput.removeClass("is-loading")},e.prototype.renderPalette=function(t){var e,n,i,s,r,o;for(t=_.map(t,tinycolor),n="",o=8,i=s=0,r=(t=_.filter(t,function(t){return t.getLuminance()<.85})).length;s<r&&(e=t[i],n+=App.view("channel/color_swatch")({color:e.toHexString()}),i!==o);i=++s);if(this.palette.html(n),t[0])return this.usePaletteColor(void 0,t[0].toHexString())},e.prototype.usePaletteColor=function(t,e){return t&&(e=$(t.currentTarget).attr("data-color")),this.colorField.val(e),this.updateParams()},e.prototype.pickColor=function(){if(this._screenshotSource)return this._pickingColor?(this._pickingColor=!1,this.website.off("click.eyedropper").removeClass("is-picking"),this.eyedropper.removeClass("is-active")):(this._pickingColor=!0,this.website.on("click.eyedropper",this.onColorPicked).addClass("is-picking"),this.eyedropper.addClass("is-active"))},e.prototype.onColorPicked=function(t){var e,n,i,s,r,o;return r=t.pageX-this.website.offset().left,
o=t.pageY-this.website.offset().top,(i=new Image).src=this._screenshotSource,n=(e=document.createElement("canvas")).getContext("2d"),e.width=i.width,e.height=i.height,n.drawImage(i,0,0,this.previewScale*e.width,this.previewScale*e.height),s=n.getImageData(r,o,1,1).data,this.colorField.val("rgb("+s.slice(0,3).join(",")+")").trigger("change")},e.prototype.toggleChat=function(){return this.chat.toggleClass("is-open"),this.isOpen=this.chat.hasClass("is-open"),this.updatePreview()},e.prototype.toggleChatSetting=function(){var t;return t=this.chatSetting.prop("checked"),App.Setting.set("chat",t)},e.prototype.toggleChatBotSetting=function(){var t;return t=this.chatBotSetting.prop("checked"),App.Setting.set("chatbot_status",t)},e.prototype.updateParams=function(){var t,e,n,i,s,r;if(i=function(t){return t.replace&&(t=t.replace("'","\\'").replace(/\</g,"&lt;").replace(/\>/g,"&gt;")),t},n=this.formParam(this.$(".js-params")),2<parseInt(n.fontSize,10)&&this.chat.css("font-size",n.fontSize),this.chatBackground.css("background",n.background),"on"===n.flat?(this.chat.addClass("zammad-chat--flat"),n.flat=!0):this.chat.removeClass("zammad-chat--flat"),this.chatWelcome.html(n.title),this.updatePreview(!1),this.permanent)for(t in s=this.permanent)r=s[t],n[t]=r;for(t in e="",n)r=n[t],(_.isNumber(r)||_.isBoolean(r)||!_.isEmpty(r))&&(""!==e&&(e+=",\n"),!0===r||!1===r||_.isNumber(r)?e+="    "+t+": "+r:e+="    "+t+": '"+i(r)+"'");return this.$(".js-modal-params").html(e),this.code.each(function(t,e){return hljs.highlightBlock(e)})},e}(App.ControllerSubContent),App.Config.set("Chat",{prio:4e3,name:"Chat",parent:"#channels",target:"#channels/chat",controller:App.ChannelChat,permission:["admin.channel_chat"]},"NavBarAdmin"),n=function(t){function e(){this.remove=i(this.remove,this),this.edit=i(this.edit,this),this["new"]=i(this["new"],this),this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return s(e,t),e.prototype.events={"click .js-add":"new","click .js-edit":"edit","click .js-remove":"remove"},e.prototype.render=function(){return this.html(App.view("channel/topics")({chats:App.Chat.all()}))},e.prototype["new"]=function(){return new App.ControllerGenericNew({pageData:{title:"Chats",object:"Chat",objects:"Chats"},genericObject:"Chat",callback:this.render,container:this.el.closest(".content"),large:!0})},e.prototype.edit=function(t){var e;return t.preventDefault(),e=$(t.target).closest("tr").data("id"),new App.ControllerGenericEdit({id:e,genericObject:"Chat",pageData:{object:"Chat"},container:this.el.closest(".content"),callback:this.render})},e.prototype.remove=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest("tr").data("id"),n=App.Chat.find(e),new App.ControllerGenericDestroyConfirm({item:n,container:this.el.closest(".content"),callback:this.render})},e}(App.Controller)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty,i=function(t,e){return function(){return t.apply(e,arguments)}};App.ChannelEmail=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.title("Email",!0),this.tabs=[{name:"Accounts",target:"c-account",controller:App.ChannelEmailAccountOverview},{name:"Filter",target:"c-filter",controller:App.ChannelEmailFilter},{name:"Signatures",target:"c-signature",controller:App.ChannelEmailSignature},{name:"Settings",target:"c-setting",controller:App.SettingsArea,params:{area:"Email::Base"}}],this.render()}return n(e,t),e.prototype.requiredPermission="admin.channel_email",e.prototype.header="Email",e}(App.ControllerTabs),App.ChannelEmailFilter=function(t){function e(){this.edit=i(this.edit,this),this["new"]=i(this["new"],this),this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments),App.PostmasterFilter.subscribe(this.render,{initFetch:!0})}return n(e,t),e.prototype.events={"click [data-type=new]":"new"},e.prototype.render=function(){var t,e,n;return t=App.PostmasterFilter.search({sortBy:"name"}),n=$('<div><div class="overview"></div><a data-type="new" class="btn btn--success">'+App.i18n.translateContent("New")+"</a></div>"),e="With filters you can e. g. dispatch new tickets into certain groups or set a certain priority for tickets of a VIP customer.",new App.ControllerTable({el:n.find(".overview"),model:App.PostmasterFilter,objects:t,bindRow:{events:{click:this.edit}},explanation:e}),this.html(n)},e.prototype["new"]=function(t){return t.preventDefault(),new App.ControllerGenericNew({pageData:{object:"Postmaster Filter"},genericObject:"PostmasterFilter",container:this.el.closest(".content"),callback:this.load})},e.prototype.edit=function(t,e){return e.preventDefault(),new App.ControllerGenericEdit({id:t,pageData:{object:"Postmaster Filter"},genericObject:"PostmasterFilter",container:this.el.closest(".content"),callback:this.load})},e}(App.Controller),App.ChannelEmailSignature=function(t){function e(){this.edit=i(this.edit,this),this["new"]=i(this["new"],this),this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments),App.Signature.subscribe(this.render,{initFetch:!0})}return n(e,t),e.prototype.events={"click [data-type=new]":"new"},e.prototype.render=function(){var t,e,n;return t=App.Signature.search({sortBy:"name"}),n=$('<div><div class="overview"></div><a data-type="new" class="btn btn--success">'+App.i18n.translateContent("New")+"</a></div>"),e="You can define different signatures for each group. So you can have different email signatures for different departments.\n\nOnce you have created a signature here, you need also to edit the groups where you want to use it.",new App.ControllerTable({el:n.find(".overview"),model:App.Signature,objects:t,bindRow:{events:{click:this.edit}},explanation:e}),this.html(n)},e.prototype["new"]=function(t){return t.preventDefault(),new App.ChannelEmailSignatureEdit({container:this.el.closest(".content")})},e.prototype.edit=function(t,e){var n;return e.preventDefault(),n=App.Signature.find(t),new App.ChannelEmailSignatureEdit({object:n,container:this.el.closest(".content")})},e}(App.Controller),App.ChannelEmailSignatureEdit=function(t){function e(){return this.onSubmit=i(this.onSubmit,this),this.content=i(this.content,this),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.head="Signature",e.prototype.content=function(){return this.object?this.form=new App.ControllerForm({model:App.Signature,params:this.object,autofocus:!0}):this.form=new App.ControllerForm({model:App.Signature,autofocus:!0}),this.form.form},e.prototype.onSubmit=function(n){var t,e,i,s,r;return i=this.formParam(n.target),(e=this.object||new App.Signature).load(i),(t=this.form.validate(i))?(this.log("error",t),this.formValidate({form:n.target,errors:t}),!1):(this.formDisable(n),e.save({done:(r=this,function(){return r.close()}),fail:(s=this,function(t,e){return s.log("errors",e),s.formEnable(n),s.form.showAlert(e.error_human||e.error||"Unable to create object!")})}))},e}(App.ControllerModal),App.ChannelEmailAccountOverview=function(t){function e(){this.migrateGoogleMail=i(this.migrateGoogleMail,this),this.editNotificationOutbound=i(this.editNotificationOutbound,this),this.emailAddressDelete=i(this.emailAddressDelete,this),this.emailAddressEdit=i(this.emailAddressEdit,this),this.emailAddressNew=i(this.emailAddressNew,this),this.groupChange=i(this.groupChange,this),this.enable=i(this.enable,this),this.disable=i(this.disable,this),this["delete"]=i(this["delete"],this),this.editOutbound=i(this.editOutbound,this),this.editInbound=i(this.editInbound,this),this.wizard=i(this.wizard,this),this.render=i(this.render,this),this.load=i(this.load,this),e.__super__.constructor.apply(this,arguments),this.interval(this.load,3e4)}return n(e,t),e.prototype.events={"click .js-channelNew":"wizard","click .js-channelDelete":"delete","click .js-channelDisable":"disable","click .js-channelEnable":"enable","click .js-channelGroupChange":"groupChange","click .js-editInbound":"editInbound","click .js-editOutbound":"editOutbound","click .js-emailAddressNew":"emailAddressNew","click .js-emailAddressEdit":"emailAddressEdit","click .js-emailAddressDelete":"emailAddressDelete","click .js-editNotificationOutbound":"editNotificationOutbound","click .js-migrateGoogleMail":"migrateGoogleMail"},e.prototype.load=function(){return this.startLoading(),this.ajax({id:"email_index",type:"GET",url:this.apiPath+"/channels_email",processData:!0,success:(e=this,function(t){return e.stopLoading(),App.Collection.loadAssets(t.assets),e.render(t)})});var e},e.prototype.render=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b;for(null==t&&(t={}),this.channelDriver=t.channel_driver,n=[],a=0,u=(v=t.account_channel_ids).length;a<u;a++)s=v[a],(e=App.Channel.fullLocal(s)).group_id?e.group=App.Group.find(e.group_id):e.group="-",n.push(e);for(l=0,h=n.length;l<h;l++)i=n[l],o=App.EmailAddress.search({filter:{channel_id:i.id}}),i.email_addresses=o;for(m=[],c=0,d=(y=t.not_used_email_address_ids).length;c<d;c++)r=y[c],m.push(App.EmailAddress.find(r));for(g=[],p=0,f=(b=t.notification_channel_ids).length;p<f;p++)s=b[p],g.push(App.Channel.find(s));return this.html(App.view("channel/email_account_overview")({account_channels:n,not_used_email_addresses:m,notification_channels:g,accounts_fixed:t.accounts_fixed,config:t.config}))},e.prototype.wizard=function(t){return t.preventDefault(),new App.ChannelEmailAccountWizard({container:this.el.closest(".content"),callback:this.load,channelDriver:this.channelDriver})},e.prototype.editInbound=function(t){var e,n,i;return t.preventDefault(),n=$(t.target).closest(".action").data("id"),e=App.Channel.find(n),i="js-inbound",new App.ChannelEmailAccountWizard({container:this.el.closest(".content"),slide:i,channel:e,callback:this.load,channelDriver:this.channelDriver})},e.prototype.editOutbound=function(t){var e,n,i;return t.preventDefault(),n=$(t.target).closest(".action").data("id"),e=App.Channel.find(n),i="js-outbound",new App.ChannelEmailAccountWizard({container:this.el.closest(".content"),slide:i,channel:e,callback:this.load,channelDriver:this.channelDriver})},e.prototype["delete"]=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),new App.ControllerConfirm({message:"Sure?",callback:(n=this,function(){return n.ajax({id:"email_delete",type:"DELETE",url:n.apiPath+"/channels_email",data:JSON.stringify({id:e}),processData:!0,success:function(){return n.load()}})}),container:this.el.closest(".content")})},e.prototype.disable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"email_disable",type:"POST",url:this.apiPath+"/channels_email_disable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e.prototype.enable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"email_enable",type:"POST",url:this.apiPath+"/channels_email_enable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e.prototype.groupChange=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),n=App.Channel.find(e),new App.ChannelEmailEdit({container:this.el.closest(".content"),item:n,callback:this.load})},e.prototype.emailAddressNew=function(t){var e;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),new App.ControllerGenericNew({pageData:{object:"Email Address"},genericObject:"EmailAddress",container:this.el.closest(".content"),item:{channel_id:e},callback:this.load})},e.prototype.emailAddressEdit=function(t){var e;return t.preventDefault(),e=$(t.target).closest("li").data("id"),new App.ControllerGenericEdit({pageData:{object:"Email Address"},genericObject:"EmailAddress",container:this.el.closest(".content"),id:e,callback:this.load})},e.prototype.emailAddressDelete=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest("li").data("id"),n=App.EmailAddress.find(e),new App.ControllerGenericDestroyConfirm({item:n,container:this.el.closest(".content"),callback:this.load})},e.prototype.editNotificationOutbound=function(t){var e,n;return t.preventDefault(),n=$(t.target).closest(".action").data("id"),e=App.Channel.find(n),"js-outbound",new App.ChannelEmailNotificationWizard({container:this.el.closest(".content"),channel:e,callback:this.load,channelDriver:this.channelDriver})},e.prototype.migrateGoogleMail=function(t){var e;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.navigate("#channels/google/"+e)},e}(App.Controller),App.ChannelEmailEdit=function(t){function e(){return this.onSubmit=i(this.onSubmit,this),this.content=i(this.content,this),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.head="Channel",e.prototype.content=function(){var t;return t=[{name:"group_id",display:"Destination Group",tag:"select","null":!1,relation:"Group",nulloption:!0,filter:{active:!0}}],this.form=new App.ControllerForm({model:{configure_attributes:t,className:""},params:this.item}),this.form.form},e.prototype.onSubmit=function(n){var t,e,i,s;return e=this.formParam(n.target),(t=this.form.validate(e))?(this.log("error",t),this.formValidate({form:n.target,errors:t}),!1):(this.formDisable(n),this.ajax({id:"channel_email_group",type:"POST",url:this.apiPath+"/channels_email_group/"+this.item.id,data:JSON.stringify(e),processData:!0,success:(s=this,function(){return s.callback(),s.close()}),error:(i=this,function(t){var e;return e=JSON.parse(t.responseText),i.formEnable(n),i.el.find(".alert").removeClass("hidden").text(e.error||"Unable to save changes.")})}))},e}(App.ControllerModal),App.ChannelEmailAccountWizard=function(t){function e(){var t;this.hide=i(this.hide,this),this.verify=i(this.verify,this),this.probleOutbound=i(this.probleOutbound,this),this.probeInbound=i(this.probeInbound,this),this.probeBasedOnIntro=i(this.probeBasedOnIntro,this),this.toggleOutboundAdapter=i(this.toggleOutboundAdapter,this),this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments),this.account={inbound:{adapter:void 0,options:void 0},outbound:{adapter:void 0,options:void 0},meta:{}},this.channel&&(this.account={inbound:clone(this.channel.options.inbound),outbound:clone(this.channel.options.outbound),meta:{}},this.account.inbound.options&&this.account.inbound.options.password&&(this.inboundPassword=this.account.inbound.options.password,this.account.inbound.options.password=this.passwordPlaceholder),this.account.outbound.options&&this.account.outbound.options.password&&(this.outboundPassword=this.account.outbound.options.password,this.account.outbound.options.password=this.passwordPlaceholder)),this.container&&this.el.addClass("modal--local"),this.render(),this.channel&&this.$(".js-goToSlide[data-slide=js-intro]").addClass("hidden"),this.el.modal({keyboard:!0,show:!0,backdrop:!0,container:this.container}).on({"hidden.bs.modal":(t=this,function(){return t.callback&&t.callback(),t.el.remove()})}),this.slide&&this.showSlide(this.slide)}return n(e,t),e.prototype.elements={".modal-body":"body"},e.prototype.events={"submit .js-intro":"probeBasedOnIntro","submit .js-inbound":"probeInbound","change .js-outbound [name=adapter]":"toggleOutboundAdapter","submit .js-outbound":"probleOutbound","click  .js-goToSlide":"goToSlide","click  .js-expert":"probeBasedOnIntro","click  .js-close":"hide"},e.prototype.inboundPassword="",e.prototype.outboundPassword="",e.prototype.passwordPlaceholder="{{{{{{{{{{{{SECRTE_PASSWORD}}}}}}}}}}}}",e.prototype.render=function(){var t,e,n,i,s;return this.html(App.view("channel/email_account_wizard")()),this.showSlide("js-intro"),t=[{name:"realname",display:"Organization & Department Name",tag:"input",type:"text",limit:160,"null":!1,placeholder:"Organization Support",autocomplete:"off"},{name:"email",display:"Email",tag:"input",type:"email",limit:120,"null":!1,placeholder:"support@example.com",autocapitalize:!1,autocomplete:"off"},{name:"password",display:"Password",tag:"input",type:"password",limit:120,"null":!1,autocapitalize:!1,autocomplete:"new-password",single:!0},{name:"group_id",display:"Destination Group",tag:"select","null":!1,relation:"Group",nulloption:!0}],this.formMeta=new App.ControllerForm({el:this.$(".base-settings"),model:{configure_attributes:t,className:""},params:this.account.meta}),n=[{name:"adapter",display:"Send Mails via",tag:"select",multiple:!1,"null":!1,options:this.channelDriver.email.outbound}],new App.ControllerForm({el:this.$(".base-outbound-type"),model:{configure_attributes:n,className:""},params:{adapter:this.account.outbound.adapter||"smtp"}}),this.toggleOutboundAdapter(),e=[{name:"adapter",display:"Type",tag:"select",multiple:!1,"null":!1,options:this.channelDriver.email.inbound},{name:"options::host",display:"Host",tag:"input",type:"text",limit:120,"null":!1,autocapitalize:!1},{name:"options::user",display:"User",tag:"input",type:"text",limit:120,"null":!1,autocapitalize:!1,autocomplete:"off"},{name:"options::password",display:"Password",tag:"input",type:"password",limit:120,"null":!1,autocapitalize:!1,autocomplete:"new-password",single:!0},{name:"options::ssl",display:"SSL/STARTTLS",tag:"boolean","null":!0,options:{"true":"yes","false":"no"},"default":!0,translate:!0,item_class:"formGroup--halfSize"},{name:"options::port",display:"Port",tag:"input",type:"text",limit:6,"null":!0,autocapitalize:!1,"default":"993",item_class:"formGroup--halfSize"},{name:"options::folder",display:"Folder",tag:"input",type:"text",limit:120,"null":!0,autocapitalize:!1,item_class:"formGroup--halfSize"},{name:"options::keep_on_server",display:"Keep messages on server",tag:"boolean","null":!0,options:{"true":"yes","false":"no"},translate:!0,"default":!1,item_class:"formGroup--halfSize"}],s=function(t,e,n,i,s,r){if(t)return"imap"===t.adapter?(r.show("options::folder"),void r.show("options::keep_on_server")):(r.hide("options::folder"),r.hide("options::keep_on_server"))},i=function(t){var e;t&&t.options&&(e=this.$('[name="options::port"]').val(),!0!==t.options.ssl?!1===t.options.ssl&&(e&&"993"!==e||this.$('[name="options::port"]').val("143")):e||this.$('[name="options::port"]').val("993"))},new App.ControllerForm({el:this.$(".base-inbound-settings"),model:{configure_attributes:e,className:""},params:this.account.inbound,handlers:[s,i]})},e.prototype.toggleOutboundAdapter=function(){var t,e;if(t={options:{}},this.account.meta&&(t.options.user=this.account.meta.email,t.options.password=this.account.meta.password,t.options.folder=this.account.meta.folder,t.options.keep_on_server=this.account.meta.keep_on_server),this.$(".base-outbound-settings").html(""),"smtp"===this.$(".js-outbound [name=adapter]").val())return e=[{name:"options::host",display:"Host",tag:"input",type:"text",limit:120,"null":!1,autocapitalize:!1,autofocus:!0},{name:"options::user",display:"User",tag:"input",type:"text",limit:120,"null":!0,autocapitalize:!1,autocomplete:"off"},{name:"options::password",display:"Password",tag:"input",type:"password",limit:120,"null":!0,autocapitalize:!1,autocomplete:"new-password",single:!0},{name:"options::port",display:"Port",tag:"input",type:"text",limit:6,"null":!0,autocapitalize:!1}],this.form=new App.ControllerForm({el:this.$(".base-outbound-settings"),model:{configure_attributes:e,className:""},params:this.account.outbound})},e.prototype.probeBasedOnIntro=function(r){var t,e,n,o;return r.preventDefault(),e=this.formParam(r.target),this.account.meta=e,this.channel&&(e.channel_id=this.channel.id),$(r.currentTarget).hasClass("js-expert")?((t=this.formMeta.validate(e))&&delete t.password,_.isEmpty(t)?(this.showSlide("js-inbound"),this.$('.js-inbound [name="options::user"]').val(e.email),void this.$('.js-inbound [name="options::password"]').val(e.password)):void this.formValidate({form:r.target,errors:t})):(this.disable(r),this.$(".js-probe .js-email").text(e.email),this.showSlide("js-probe"),this.ajax({id:"email_probe",type:"POST",url:this.apiPath+"/channels_email_probe",data:JSON.stringify(e),processData:!0,success:(o=this,function(t){var e,n,i,s;if("ok"===t.result){if(t.setting)for(e in i=t.setting)s=i[e],o.account[e]=s;t.content_messages&&0<t.content_messages&&(!o.account.inbound.options||!0!==o.account.inbound.options.keep_on_server)?(n=App.i18n.translateContent("We have already found %s email(s) in your mailbox. Zammad will move it all from your mailbox into Zammad.",t.content_messages),o.$(".js-inbound-acknowledge .js-message").html(n),o.$(".js-inbound-acknowledge .js-back").attr("data-slide","js-intro"),o.$(".js-inbound-acknowledge .js-next").attr("data-slide",""),o.$(".js-inbound-acknowledge .js-next").unbind("click.verify").bind("click.verify",function(t){return t.preventDefault(),o.verify(o.account)}),o.showSlide("js-inbound-acknowledge")):o.verify(o.account)}else"duplicate"===t.result?(o.showSlide("js-intro"),o.showAlert("js-intro","Account already exists!")):(o.showSlide("js-inbound"),o.showAlert("js-inbound","Unable to detect your server settings. Manual configuration needed."),o.$('.js-inbound [name="options::user"]').val(o.account.meta.email),o.$('.js-inbound [name="options::password"]').val(o.account.meta.password));return o.enable(r)}),error:(n=this,function(){return n.enable(r),n.showSlide("js-intro")})}))},e.prototype.probeInbound=function(n){var i,s,r;return n.preventDefault(),(i=this.formParam(n.target)).options&&i.options.password===this.passwordPlaceholder&&(i.options.password=this.inboundPassword),this.channel&&(i.channel_id=this.channel.id),this.disable(n),this.showSlide("js-test"),this.ajax({id:"email_inbound",type:"POST",url:this.apiPath+"/channels_email_inbound",data:JSON.stringify(i),processData:!0,success:(r=this,function(t){var e;return"ok"===t.result?(r.account.inbound=i,t.content_messages&&0<t.content_messages&&(!r.account.inbound.options||!0!==r.account.inbound.options.keep_on_server)?(e=App.i18n.translateContent("We have already found %s email(s) in your mailbox. Zammad will move it all from your mailbox into Zammad.",t.content_messages),r.$(".js-inbound-acknowledge .js-message").html(e),r.$(".js-inbound-acknowledge .js-back").attr("data-slide","js-inbound"),r.$(".js-inbound-acknowledge .js-next").unbind("click.verify"),r.showSlide("js-inbound-acknowledge")):r.showSlide("js-outbound"),r.channel||(r.account.inbound.options?(r.$('.js-outbound [name="options::host"]').val(r.account.inbound.options.host),r.$('.js-outbound [name="options::user"]').val(r.account.inbound.options.user),r.$('.js-outbound [name="options::password"]').val(r.account.inbound.options.password)):(r.$('.js-outbound [name="options::user"]').val(r.account.meta.email),r.$('.js-outbound [name="options::password"]').val(r.account.meta.password)))):(r.showSlide("js-inbound"),r.showAlert("js-inbound",t.message_human||t.message),r.showInvalidField("js-inbound",t.invalid_field)),r.enable(n)}),error:(s=this,function(t){var e;return e=JSON.parse(t.responseText),s.showSlide("js-inbound"),s.showAlert("js-inbound",e.message_human||e.message||e.error),s.showInvalidField("js-inbound",e.invalid_field),s.enable(n)})})},e.prototype.probleOutbound=function(n){var t,e,i,s;return n.preventDefault(),(e=this.formParam(n.target)).email=this.account.meta.email,e.options&&e.options.password===this.passwordPlaceholder&&(e.options.password=this.outboundPassword),!e.email&&this.channel&&(t=App.EmailAddress.search({filter:{channel_id:this.channel.id}}))&&t[0]&&(e.email=t[0].email),this.channel&&(e.channel_id=this.channel.id),this.disable(n),this.showSlide("js-test"),this.ajax({id:"email_outbound",type:"POST",url:this.apiPath+"/channels_email_outbound",data:JSON.stringify(e),processData:!0,success:(s=this,function(t){return"ok"===t.result?(s.account.outbound=e,s.verify(s.account)):(s.showSlide("js-outbound"),s.showAlert("js-outbound",t.message_human||t.message),s.showInvalidField("js-outbound",t.invalid_field)),s.enable(n)}),error:(i=this,function(t){var e;return e=JSON.parse(t.responseText),i.showSlide("js-outbound"),i.showAlert("js-outbound",e.message_human||e.message||e.error),i.showInvalidField("js-outbound",e.invalid_field),i.enable(n)})})},e.prototype.verify=function(t,e){var n,i,s;return null==e&&(e=0),this.showSlide("js-verify"),this.channel&&(t.channel_id=this.channel.id),t.meta.group_id?t.group_id=t.meta.group_id:this.channel.group_id&&(t.group_id=this.channel.group_id),!t.email&&this.channel&&(n=App.EmailAddress.search({filter:{channel_id:this.channel.id}}))&&n[0]&&(t.email=n[0].email),this.ajax({id:"email_verify",type:"POST",url:this.apiPath+"/channels_email_verify",data:JSON.stringify(t),processData:!0,success:(s=this,function(t){return"ok"===t.result?s.el.modal("hide"):"inbound"===t.source||"outbound"===t.source?(s.showSlide("js-"+t.source),s.showAlert("js-"+t.source,t.message_human||t.message),s.showInvalidField("js-"+t.source,t.invalid_field)):2===e?(s.showAlert("js-verify",t.message_human||t.message),s.delay(function(){return s.showSlide("js-intro"),s.showAlert("js-intro","Unable to verify sending and receiving. Please check your settings.")},2300)):(t.subject&&s.account&&(s.account.subject=t.subject),s.verify(s.account,e+1))}),error:(i=this,function(){return i.showSlide("js-intro"),i.showAlert("js-intro","Unable to verify sending and receiving. Please check your settings.")})})},e.prototype.hide=function(t){return t.preventDefault(),this.el.modal("hide")},e}(App.WizardModal),App.ChannelEmailNotificationWizard=function(t){function e(){var t;this.probleOutbound=i(this.probleOutbound,this),this.toggleOutboundAdapter=i(this.toggleOutboundAdapter,this),this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments),this.account={inbound:{adapter:void 0,options:void 0},outbound:{adapter:void 0,options:void 0},meta:{}},this.channel&&(this.account={inbound:clone(this.channel.options.inbound),outbound:clone(this.channel.options.outbound)},this.account.inbound&&this.account.inbound.options&&this.account.inbound.options.password&&(this.inboundPassword=this.account.inbound.options.password,this.account.inbound.options.password=this.passwordPlaceholder),this.account.outbound&&this.account.outbound.options&&this.account.outbound.options.password&&(this.outboundPassword=this.account.outbound.options.password,this.account.outbound.options.password=this.passwordPlaceholder)),this.container&&this.el.addClass("modal--local"),this.render(),this.el.modal({keyboard:!0,show:!0,backdrop:!0,container:this.container}).on({"show.bs.modal":this.onShow,"shown.bs.modal":this.onShown,"hidden.bs.modal":(t=this,function(){return t.callback&&t.callback(),t.el.remove()})}),this.slide&&this.showSlide(this.slide)}return n(e,t),e.prototype.elements={".modal-body":"body"},e.prototype.events={"change .js-outbound [name=adapter]":"toggleOutboundAdapter","submit .js-outbound":"probleOutbound","click  .js-close":"hide"},e.prototype.inboundPassword="",e.prototype.outboundPassword="",e.prototype.passwordPlaceholder="{{{{{{{{{{{{SECRTE_PASSWORD}}}}}}}}}}}}",e.prototype.render=function(){var t;return this.html(App.view("channel/email_notification_wizard")()),this.showSlide("js-outbound"),t=[{name:"adapter",display:"Send Mails via",tag:"select",multiple:!1,"null":!1,options:this.channelDriver.email.outbound}],new App.ControllerForm({el:this.$(".base-outbound-type"),model:{configure_attributes:t,className:""},params:{adapter:this.account.outbound.adapter||"sendmail"}}),this.toggleOutboundAdapter()},e.prototype.toggleOutboundAdapter=function(){var t;if(this.el.find(".base-outbound-settings").html(""),"smtp"===this.$(".js-outbound [name=adapter]").val())return t=[{name:"options::host",display:"Host",tag:"input",type:"text",limit:120,"null":!1,autocapitalize:!1,autofocus:!0},{name:"options::user",display:"User",tag:"input",type:"text",limit:120,"null":!0,autocapitalize:!1,autocomplete:"off"},{name:"options::password",display:"Password",tag:"input",type:"password",limit:120,"null":!0,autocapitalize:!1,autocomplete:"new-password",single:!0},{name:"options::port",display:"Port",tag:"input",type:"text",limit:6,"null":!0,autocapitalize:!1}],this.form=new App.ControllerForm({el:this.$(".base-outbound-settings"),model:{configure_attributes:t,className:""},params:this.account.outbound})},e.prototype.probleOutbound=function(n){var t,i,e;return n.preventDefault(),(t=this.formParam(n.target)).options&&t.options.password===this.passwordPlaceholder&&(t.options.password=this.outboundPassword),t.channel_id=this.channel.id,this.disable(n),this.showSlide("js-test"),this.ajax({id:"email_outbound",type:"POST",url:this.apiPath+"/channels_email_notification",data:JSON.stringify(t),processData:!0,success:(e=this,function(t){return"ok"===t.result?e.el.modal("hide"):(e.showSlide("js-outbound"),e.showAlert("js-outbound",t.message_human||t.message),e.showInvalidField("js-outbound",t.invalid_field)),e.enable(n)}),error:(i=this,function(t){var e;return e=JSON.parse(t.responseText),i.showSlide("js-outbound"),i.showAlert("js-outbound",e.message_human||e.message||e.error),i.showInvalidField("js-outbound",e.invalid_field),i.enable(n)})})},e}(App.WizardModal),App.Config.set("Email",{prio:3e3,name:"Email",parent:"#channels",target:"#channels/email",controller:App.ChannelEmail,permission:["admin.channel_email"]},"NavBarAdmin")}.call(this),function(){var i,n,t,s=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=function(t){function e(){this.enable=s(this.enable,this),this.disable=s(this.disable,this),this["delete"]=s(this["delete"],this),this.edit=s(this.edit,this),this.configApp=s(this.configApp,this),this.show=s(this.show,this),this.render=s(this.render,this),this.load=s(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return r(e,t),e.prototype.requiredPermission="admin.channel_facebook",e.prototype.header="Facebook",e.prototype.events={"click .js-new":"new","click .js-edit":"edit","click .js-delete":"delete","click .js-disable":"disable","click .js-enable":"enable","click .js-configApp":"configApp"},e.prototype.load=function(){return this.startLoading(),this.ajax({id:"facebook_index",type:"GET",url:this.apiPath+"/channels_facebook",processData:!0,success:(e=this,function(t){return e.stopLoading(),App.Collection.loadAssets(t.assets),e.callbackUrl=t.callback_url,e.render(t)})});var e},e.prototype.render=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f;if(App.ExternalCredential.findByAttribute("name","facebook")){for(i=[],r=0,a=(h=t.channel_ids).length;r<a;r++){if(n=h[r],(e=App.Channel.find(n))&&e.options&&e.options.sync&&(s="-",e.options.sync.wall&&e.options.sync.wall.group_id&&(s=App.Group.find(e.options.sync.wall.group_id).displayName()),e.options.sync||(e.options.sync={}),e.options.sync.wall||(e.options.sync.wall={}),e.options.sync.wall.groupName=s,e.options&&e.options.pages))for(o=0,l=(d=e.options.pages).length;o<l;o++)for(u in c=d[o],s="-",f=e.options.sync.pages)p=f[u],c.id===u&&p.group_id&&(s=App.Group.find(p.group_id).displayName(),c.groupName=s);i.push(e)}return this.html(App.view("facebook/list")({channels:i})),this.channel_id?(this.edit(void 0,this.channel_id),this.channel_id=void 0):void 0}this.html(App.view("facebook/index")())},e.prototype.show=function(t){var e,n,i;for(e in n=[],t)i=t[e],"el"!==e&&"shown"!==e&&"match"!==e?n.push(this[e]=i):n.push(void 0);return n},e.prototype.configApp=function(){return new n({container:this.el.parents(".content"),callbackUrl:this.callbackUrl,load:this.load})},e.prototype["new"]=function(){return window.location.href=this.apiPath+"/external_credentials/facebook/link_account"},e.prototype.edit=function(t,e){var n;if(t&&(t.preventDefault(),e=$(t.target).closest(".action").data("id")),n=App.Channel.find(e))return new i({channel:n,container:this.el.parents(".content"),load:this.load});this.navigate("#channels/facebook")},e.prototype["delete"]=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),new App.ControllerConfirm({message:"Sure?",callback:(n=this,function(){return n.ajax({id:"facebook_delete",type:"DELETE",url:n.apiPath+"/channels_facebook",data:JSON.stringify({id:e}),processData:!0,success:function(){return n.load()}})}),container:this.el.closest(".content")})},e.prototype.disable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"facebook_disable",
type:"POST",url:this.apiPath+"/channels_facebook_disable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e.prototype.enable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"facebook_enable",type:"POST",url:this.apiPath+"/channels_facebook_enable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e}(App.ControllerSubContent),n=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.onClosed=s(this.onClosed,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.head="Connect Facebook App",e.prototype.shown=!0,e.prototype.button="Connect",e.prototype.buttonCancel=!0,e.prototype.small=!0,e.prototype.content=function(){var t,e;return this.external_credential=App.ExternalCredential.findByAttribute("name","facebook"),(t=$(App.view("facebook/app_config")({external_credential:this.external_credential,callbackUrl:this.callbackUrl}))).find(".js-select").on("click",(e=this,function(t){return e.selectAll(t)})),t},e.prototype.onClosed=function(){if(this.isChanged)return this.isChanged=!1,this.load()},e.prototype.onSubmit=function(e){return this.formDisable(e),this.ajax({id:"facebook_app_verify",type:"POST",url:this.apiPath+"/external_credentials/facebook/app_verify",data:JSON.stringify(this.formParams()),processData:!0,success:(n=this,function(t){return t.attributes?(n.external_credential||(n.external_credential=new App.ExternalCredential),n.external_credential.load({name:"facebook",credentials:n.formParams()}),void n.external_credential.save({done:function(){return n.isChanged=!0,n.close()},fail:function(){return n.el.find(".alert").removeClass("hidden").text("Unable to create entry.")}})):(n.formEnable(e),n.el.find(".alert").removeClass("hidden").text(t.error||"Unable to verify App."))})});var n},e}(App.ControllerModal),i=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.onClosed=s(this.onClosed,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.head="Facebook Account",e.prototype.shown=!0,e.prototype.buttonCancel=!0,e.prototype.content=function(){var t,e,n,i,s,r,o,a,l,c;if(this.channel.options.sync||(this.channel.options.sync={}),this.channel.options.sync.wall||(this.channel.options.sync.wall={}),this.channel.options.sync.pages||(this.channel.options.sync.pages={}),t=$(App.view("facebook/account_edit")({channel:this.channel})),(e=function(t,e,n){var i;return i=App.UiElement.select.render({name:n+"::group_id",multiple:!1,limit:100,"null":!1,relation:"Group",nulloption:!0,value:t,"class":"form-control--small"}),e.html(i)})(this.channel.options.sync.wall.group_id,t.find(".js-wall .js-groups"),"wall"),this.channel.options.pages)for(n=0,i=(l=this.channel.options.pages).length;n<i;n++){for(a in s=l[n],r=!1,c=this.channel.options.sync.pages)o=c[a],s.id===a&&(r=!0,e(o.group_id,t.find(".js-groups[data-page-id="+s.id+"]"),"pages::"+s.id));r||e("",t.find(".js-groups[data-page-id="+s.id+"]"),"pages::"+s.id)}return t},e.prototype.onClosed=function(){if(this.isChanged)return this.isChanged=!1,this.load()},e.prototype.onSubmit=function(n){return this.formDisable(n),this.channel.options.sync=this.formParams(),this.ajax({id:"channel_facebook_update",type:"POST",url:this.apiPath+"/channels_facebook/"+this.channel.id,data:JSON.stringify(this.channel.attributes()),processData:!0,success:(t=this,function(){return t.isChanged=!0,t.close()}),error:(i=this,function(t){var e;return e=JSON.parse(t.responseText),i.formEnable(n),i.el.find(".alert").removeClass("hidden").text(e.error||"Unable to save changes.")})});var i,t},e}(App.ControllerModal),App.Config.set("Facebook",{prio:5100,name:"Facebook",parent:"#channels",target:"#channels/facebook",controller:t,permission:["admin.channel_facebook"]},"NavBarAdmin")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ChannelForm=function(t){function e(){this.updateGroup=n(this.updateGroup,this),this.toggleFormSetting=n(this.toggleFormSetting,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),App.Setting.fetchFull(this.render,{force:!1})}return i(e,t),e.prototype.requiredPermission="admin.channel_formular",e.prototype.header="Form",e.prototype.events={"change form.js-paramsDesigner":"updateParamsDesigner","keyup form.js-paramsDesigner":"updateParamsDesigner","change .js-formSetting input":"toggleFormSetting","change .js-paramsSetting select":"updateGroup"},e.prototype.elements={".js-code":"code",".js-paramsSetting":"paramsSetting",".js-formSetting input":"formSetting"},e.prototype.render=function(){var t,e,n,i;return i=App.Setting.get("form_ticket_create"),t=$(App.view("channel/form")({baseurl:window.location.origin,formSetting:i})),e=App.Setting.get("form_ticket_create_group_id"),n=App.UiElement.select.render({name:"group_id",multiple:!1,"null":!1,relation:"Group",nulloption:!1,value:e}),t.find(".js-groupSelector").html(n),this.html(t),this.code.each(function(t,e){return hljs.highlightBlock(e)}),this.updateParamsDesigner()},e.prototype.updateParamsDesigner=function(){var t,e,n,i,s;for(t in i=function(t){return t.replace("'","\\'").replace(/\</g,"&lt;").replace(/\>/g,"&gt;")},e="",n=this.formParam(this.$(".js-paramsDesigner")))s=n[t],_.isEmpty(s)||(""!==e&&(e+=",\n"),e+="true"===s||"false"===s?"    "+t+": "+s:"    "+t+": '"+i(s)+"'");return this.$(".js-modal-params").html(e),n.test=!0,n.modal?(this.$(".js-modal").removeClass("hide"),this.$(".js-inlineForm").addClass("hide"),this.$(".js-formInline").addClass("hide"),this.$(".js-formBtn").removeClass("hide"),this.$(".js-formBtn").ZammadForm(n),this.$(".js-formBtn").text("Feedback")):(this.$(".js-modal").addClass("hide"),this.$(".js-inlineForm").removeClass("hide"),this.$(".js-formBtn").addClass("hide"),this.$(".js-formInline").removeClass("hide"),this.$(".js-formInline").ZammadForm(n))},e.prototype.toggleFormSetting=function(){var t;return t=this.formSetting.prop("checked"),App.Setting.set("form_ticket_create",t)},e.prototype.updateGroup=function(){var t;return t=this.paramsSetting.find("[name=group_id]").val(),App.Setting.set("form_ticket_create_group_id",t)},e}(App.ControllerSubContent),App.Config.set("Form",{prio:2e3,name:"Form",parent:"#channels",target:"#channels/form",controller:App.ChannelForm,permission:["admin.formular"]},"NavBarAdmin")}.call(this),function(){var n,i,s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty,o=function(t,e){return function(){return t.apply(e,arguments)}};App.ChannelGoogle=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.title("Google",!0),this.tabs=[{name:"Accounts",target:"c-account",controller:i},{name:"Filter",target:"c-filter",controller:App.ChannelEmailFilter},{name:"Signatures",target:"c-signature",controller:App.ChannelEmailSignature},{name:"Settings",target:"c-setting",controller:App.SettingsArea,params:{area:"Email::Base"}}],this.render()}return s(e,t),e.prototype.requiredPermission="admin.channel_email",e.prototype.header="Google",e}(App.ControllerTabs),i=function(t){function e(){this.emailAddressDelete=o(this.emailAddressDelete,this),this.emailAddressEdit=o(this.emailAddressEdit,this),this.emailAddressNew=o(this.emailAddressNew,this),this.groupChange=o(this.groupChange,this),this.rollbackMigration=o(this.rollbackMigration,this),this.editInbound=o(this.editInbound,this),this.enable=o(this.enable,this),this.disable=o(this.disable,this),this["delete"]=o(this["delete"],this),this.configApp=o(this.configApp,this),this.show=o(this.show,this),this.render=o(this.render,this),this.load=o(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return s(e,t),e.prototype.requiredPermission="admin.channel_google",e.prototype.events={"click .js-new":"new","click .js-delete":"delete","click .js-configApp":"configApp","click .js-disable":"disable","click .js-enable":"enable","click .js-channelGroupChange":"groupChange","click .js-editInbound":"editInbound","click .js-rollbackMigration":"rollbackMigration","click .js-emailAddressNew":"emailAddressNew","click .js-emailAddressEdit":"emailAddressEdit","click .js-emailAddressDelete":"emailAddressDelete"},e.prototype.load=function(t){return null==t&&(t=!1),t&&(this.channel_id=void 0,this.navigate("#channels/google")),this.startLoading(),this.ajax({id:"google_index",type:"GET",url:this.apiPath+"/channels_google",processData:!0,success:(e=this,function(t){return e.stopLoading(),App.Collection.loadAssets(t.assets),e.callbackUrl=t.callback_url,e.render(t)})});var e},e.prototype.render=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f;if(!(o=App.ExternalCredential.findByAttribute("name","google")))return this.html(App.view("google/index")()),void(this.channel_id&&this.configApp());for(i=[],a=0,p=(d=t.channel_ids).length;a<p;a++)n=d[a],(e=App.Channel.find(n)).group_id?e.group=App.Group.find(e.group_id):e.group="-",r=App.EmailAddress.search({filter:{channel_id:e.id}}),e.email_addresses=r,i.push(e);if(!this.channel_id||!(l=App.Channel.find(this.channel_id))||"Google::Account"===l.area){for(h=[],c=0,u=(f=t.not_used_email_address_ids).length;c<u;c++)s=f[c],h.push(App.EmailAddress.find(s));return this.html(App.view("google/list")({channels:i,external_credential:o,not_used_email_addresses:h})),this.channel_id&&(l=App.Channel.find(this.channel_id))&&"Google::Account"===l.area&&l.options&&void 0===l.options.backup_imap_classic?(this.editInbound(void 0,this.channel_id,!0),this.channel_id=void 0):void 0}this["new"]()},e.prototype.show=function(t){var e,n,i;for(e in n=[],t)i=t[e],"el"!==e&&"shown"!==e&&"match"!==e?n.push(this[e]=i):n.push(void 0);return n},e.prototype.configApp=function(){return new n({container:this.el.parents(".content"),callbackUrl:this.callbackUrl,load:this.load})},e.prototype["new"]=function(){return window.location.href=this.apiPath+"/external_credentials/google/link_account"},e.prototype["delete"]=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),new App.ControllerConfirm({message:"Sure?",callback:(n=this,function(){return n.ajax({id:"google_delete",type:"DELETE",url:n.apiPath+"/channels_google",data:JSON.stringify({id:e}),processData:!0,success:function(){return n.load()}})}),container:this.el.closest(".content")})},e.prototype.disable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"google_disable",type:"POST",url:this.apiPath+"/channels_google_disable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e.prototype.enable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"google_enable",type:"POST",url:this.apiPath+"/channels_google_enable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e.prototype.editInbound=function(t,e,n){var i;return e||(t.preventDefault(),e=$(t.target).closest(".action").data("id")),i=App.Channel.find(e),new App.ChannelInboundEdit({container:this.el.closest(".content"),item:i,callback:this.load,set_active:n})},e.prototype.rollbackMigration=function(t){var e,n,i;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"google_rollback_migration",type:"POST",url:this.apiPath+"/channels_google_rollback_migration",data:JSON.stringify({id:e}),processData:!0,success:(i=this,function(){return i.load(),i.notify({type:"success",msg:"Rollback of channel migration succeeded!"})}),error:(n=this,function(){return n.notify({type:"error",msg:"Failed to rollback migration of the channel!"})})})},e.prototype.groupChange=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),n=App.Channel.find(e),new App.ChannelGroupEdit({container:this.el.closest(".content"),item:n,callback:this.load})},e.prototype.emailAddressNew=function(t){var e;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),new App.ControllerGenericNew({pageData:{object:"Email Address"},genericObject:"EmailAddress",container:this.el.closest(".content"),item:{channel_id:e},callback:this.load})},e.prototype.emailAddressEdit=function(t){var e;return t.preventDefault(),e=$(t.target).closest("li").data("id"),new App.ControllerGenericEdit({pageData:{object:"Email Address"},genericObject:"EmailAddress",container:this.el.closest(".content"),id:e,callback:this.load})},e.prototype.emailAddressDelete=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest("li").data("id"),n=App.EmailAddress.find(e),new App.ControllerGenericDestroyConfirm({item:n,container:this.el.closest(".content"),callback:this.load})},e}(App.ControllerSubContent),App.ChannelInboundEdit=function(t){function e(){return this.onSubmit=o(this.onSubmit,this),this.content=o(this.content,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.head="Channel",e.prototype.content=function(){var t;return t=[{name:"options::folder",display:"Folder",tag:"input",type:"text",limit:120,"null":!0,autocapitalize:!1,placeholder:"optional"},{name:"options::keep_on_server",display:"Keep messages on server",tag:"boolean","null":!0,options:{"true":"yes","false":"no"},translate:!0,"default":!1}],this.form=new App.ControllerForm({model:{configure_attributes:t,className:""},params:this.item.options.inbound}),this.form.form},e.prototype.onSubmit=function(n){var t,e,i,s;return this.startLoading(),e=this.formParam(n.target),(t=this.form.validate(e))?(this.log("error",t),this.formValidate({form:n.target,errors:t}),!1):(this.formDisable(n),this.set_active&&(e.active=!0),this.ajax({id:"channel_email_inbound",type:"POST",url:this.apiPath+"/channels_google_inbound/"+this.item.id,data:JSON.stringify(e),processData:!0,success:(s=this,function(){return s.callback(!0),s.close()}),error:(i=this,function(t){var e;return i.stopLoading(),i.formEnable(n),e=t.responseJSON||{},i.notify({type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to save changes."),timeout:6e3})})}))},e}(App.ControllerModal),App.ChannelGroupEdit=function(t){function e(){return this.onSubmit=o(this.onSubmit,this),this.content=o(this.content,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.head="Channel",e.prototype.content=function(){var t;return t=[{name:"group_id",display:"Destination Group",tag:"select","null":!1,relation:"Group",nulloption:!0,filter:{active:!0}}],this.form=new App.ControllerForm({model:{configure_attributes:t,className:""},params:this.item}),this.form.form},e.prototype.onSubmit=function(n){var t,e,i,s;return e=this.formParam(n.target),(t=this.form.validate(e))?(this.log("error",t),this.formValidate({form:n.target,errors:t}),!1):(this.formDisable(n),this.ajax({id:"channel_email_group",type:"POST",url:this.apiPath+"/channels_google_group/"+this.item.id,data:JSON.stringify(e),processData:!0,success:(s=this,function(){return s.callback(),s.close()}),error:(i=this,function(t){var e;return e=JSON.parse(t.responseText),i.formEnable(n),i.el.find(".alert").removeClass("hidden").text(e.error||"Unable to save changes.")})}))},e}(App.ControllerModal),n=function(t){function e(){return this.onSubmit=o(this.onSubmit,this),this.onClosed=o(this.onClosed,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.head="Connect Google App",e.prototype.shown=!0,e.prototype.button="Connect",e.prototype.buttonCancel=!0,e.prototype.small=!0,e.prototype.content=function(){var t,e;return this.external_credential=App.ExternalCredential.findByAttribute("name","google"),(t=$(App.view("google/app_config")({external_credential:this.external_credential,callbackUrl:this.callbackUrl}))).find(".js-select").on("click",(e=this,function(t){return e.selectAll(t)})),t},e.prototype.onClosed=function(){if(this.isChanged)return this.isChanged=!1,this.load()},e.prototype.onSubmit=function(e){return this.formDisable(e),this.ajax({id:"google_app_verify",type:"POST",url:this.apiPath+"/external_credentials/google/app_verify",data:JSON.stringify(this.formParams()),processData:!0,success:(n=this,function(t){return t.attributes?(n.external_credential||(n.external_credential=new App.ExternalCredential),n.external_credential.load({name:"google",credentials:t.attributes}),void n.external_credential.save({done:function(){return n.isChanged=!0,n.close()},fail:function(){return n.el.find(".alert").removeClass("hidden").text("Unable to create entry.")}})):(n.formEnable(e),n.el.find(".alert").removeClass("hidden").text(t.error||"Unable to verify App."))})});var n},e}(App.ControllerModal),App.Config.set("google",{prio:5e3,name:"Google",parent:"#channels",target:"#channels/google",controller:App.ChannelGoogle,permission:["admin.channel_google"]},"NavBarAdmin")}.call(this),function(){var n,i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty,r=function(t,e){return function(){return t.apply(e,arguments)}};App.ChannelSms=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.title("SMS",!0),this.tabs=[{name:"Accounts",target:"c-account",controller:App.ChannelSmsAccountOverview}],this.render()}return i(e,t),e.prototype.requiredPermission="admin.channel_sms",e.prototype.header="SMS",e}(App.ControllerTabs),App.ChannelSmsAccountOverview=function(t){function e(){this.editNotification=r(this.editNotification,this),this.enable=r(this.enable,this),this.disable=r(this.disable,this),this["delete"]=r(this["delete"],this),this.change=r(this.change,this),this.render=r(this.render,this),this.load=r(this.load,this),e.__super__.constructor.apply(this,arguments),this.interval(this.load,3e4)}return i(e,t),e.prototype.events={"click .js-channelEdit":"change","click .js-channelDelete":"delete","click .js-channelDisable":"disable","click .js-channelEnable":"enable","click .js-editNotification":"editNotification"},e.prototype.load=function(){return this.startLoading(),this.ajax({id:"sms_index",type:"GET",url:this.apiPath+"/channels_sms",processData:!0,success:(e=this,function(t){return e.config=t.config,e.stopLoading(),App.Collection.loadAssets(t.assets),e.render(t)})});var e},e.prototype.render=function(t){var e,n,i,s,r,o,a,l;for(null==t&&(t={}),this.channelDriver=t.channel_driver,this.account_channels=[],i=0,r=(a=t.account_channel_ids).length;i<r;i++)n=a[i],(e=App.Channel.fullLocal(n)).group_id?e.group=App.Group.find(e.group_id):e.group="-",this.account_channels.push(e);for(this.notification_channels=[],s=0,o=(l=t.notification_channel_ids).length;s<o;s++)n=l[s],this.notification_channels.push(App.Channel.find(n));return this.html(App.view("channel/sms_account_overview")({account_channels:this.account_channels,notification_channels:this.notification_channels,config:this.config}))},e.prototype.change=function(t){var e,n;return t.preventDefault(),e=(n=$(t.target).closest(".action").data("id"))?App.Channel.find(n):new App.Channel({active:!0}),new App.ChannelSmsAccount({container:this.el.closest(".content"),channel:e,callback:this.load,channelDriver:this.channelDriver,config:this.config})},e.prototype["delete"]=function(t){var e,n,i;return t.preventDefault(),n=$(t.target).closest(".action").data("id"),e=App.Channel.find(n),new App.ControllerGenericDestroyConfirm({item:e,options:{url:"/api/v1/channels_sms/"+e.id},container:this.el.closest(".content"),callback:(i=this,function(){return i.load()})})},e.prototype.disable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"sms_disable",type:"POST",url:this.apiPath+"/channels_sms_disable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e.prototype.enable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"sms_enable",type:"POST",url:this.apiPath+"/channels_sms_enable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e.prototype.editNotification=function(t){var e,n;return t.preventDefault(),n=$(t.target).closest(".action").data("id"),e=App.Channel.find(n),new App.ChannelSmsNotification({container:this.el.closest(".content"),channel:e,callback:this.load,channelDriver:this.channelDriver,config:this.config})},e}(App.Controller),App.ChannelSmsAccount=function(t){function e(){return this.onDelete=r(this.onDelete,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.head="SMS Account",e.prototype.buttonCancel=!0,e.prototype.centerButtons=[{text:"Test",className:"js-test"}],e.prototype.elements={form:"form",'select[name="options::adapter"]':"adapterSelect"},e.prototype.events={"click .js-test":"onTest"},e.prototype.content=function(){var t,e,n,i,s,r,o,a;for(e=$('<div><div class="js-channelAdapterSelector"></div><div class="js-channelWebhook"></div><div class="js-channelAdapterOptions"></div></div>'),s={},{},n=0,i=(r=this.config).length;n<i;n++)(t=r[n]).account&&(s[t.adapter]=t.name);return new App.ControllerForm({el:e.find(".js-channelAdapterSelector"),model:{configure_attributes:[{name:"options::adapter",display:"Provider",tag:"select","null":!1,options:s,nulloption:!0}],className:""},params:this.channel}),this.renderAdapterOptions(null!=(o=this.channel.options)?o.adapter:void 0,e),e.find('[name="options::adapter"]').bind("change",(a=this,function(t){return a.renderAdapterOptions(t.target.value,e)})),e},e.prototype.renderAdapterOptions=function(t,e){var n,i,s,r,o,a,l,c,p,u,h;for(e.find(".js-channelWebhook").html(""),e.find(".js-channelAdapterOptions").html(""),s={},r=0,a=(p=this.config).length;r<a;r++)(i=p[r]).adapter===t&&i.account&&(s=i.account);if(!_.isEmpty(s)){if(_.isEmpty(this.channel.options)||_.isEmpty(this.channel.options.webhook_token))for((n=this.channel).options||(n.options={}),this.channel.options.webhook_token="?",o=0,l=s.length;o<l;o++)"options::webhook_token"===(c=s[o]).name&&(this.channel.options.webhook_token=c["default"]);return h=this.Config.get("http_type")+"://"+this.Config.get("fqdn")+"/api/v1/sms_webhook/"+(null!=(u=this.channel.options)?u.webhook_token:void 0),new App.ControllerForm({el:e.find(".js-channelWebhook"),model:{configure_attributes:[{name:"options::webhook",display:"Webhook",tag:"input",type:"text",limit:200,"null":!1,"default":h,disabled:!0}],className:""},params:this.channel}),new App.ControllerForm({el:e.find(".js-channelAdapterOptions"),model:{configure_attributes:s,className:""},params:this.channel})}},e.prototype.onDelete=function(){return!0===this.channel.isNew()?(this.close(),void this.callback()):new App.ControllerGenericDestroyConfirm({item:this.channel,options:{url:"/api/v1/channels_sms/"+this.channel.id},container:this.el.closest(".content"),callback:(t=this,function(){return t.close(),t.callback()})});var t},e.prototype.onSubmit=function(n){var t,e,i,s,r,o,a,l,c;if(n.preventDefault(),""!==this.adapterSelect.val()){for(i in this.formDisable(n),(t=this.channel).options||(t.options={}),o=this.formParam(this.el))if(c=o[i],"options"===i)for(s in c)r=c[s],(e=this.channel).options||(e.options={}),this.channel.options[s]=r;else this.channel[i]=c;return this.channel.area="Sms::Account",l="/api/v1/channels_sms",this.channel.isNew()||(l="/api/v1/channels_sms/"+this.channel.id),(a=this).channel.save({url:l,done:function(){return a.formEnable(n),a.channel=App.Channel.find(this.id),a.close(),a.callback()},fail:function(t,e){return a.log("errors",e),a.formEnable(n),a.showAlert(e.error_human||e.error||"Unable to update object!")}})}this.onDelete()},e.prototype.onTest=function(t){return t.preventDefault(),new n({channel:this.formParam(this.el),container:this.el.closest(".content")})},e}(App.ControllerModal),App.ChannelSmsNotification=function(t){function e(){return this.onDelete=r(this.onDelete,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.head="SMS Notification",e.prototype.buttonCancel=!0,e.prototype.centerButtons=[{text:"Test",className:"js-test"}],e.prototype.elements={form:"form",'select[name="options::adapter"]':"adapterSelect"},e.prototype.events={"click .js-test":"onTest"},e.prototype.content=function(){var t,e,n,i,s,r,o,a;for(e=$('<div><div class="js-channelAdapterSelector"></div><div class="js-channelAdapterOptions"></div></div>'),this.channel||(this.channel=new App.Channel({active:!0})),s={},{},n=0,i=(r=this.config).length;n<i;n++)(t=r[n]).notification&&(s[t.adapter]=t.name);return new App.ControllerForm({el:e.find(".js-channelAdapterSelector"),model:{configure_attributes:[{name:"options::adapter",display:"Provider",tag:"select","null":!1,options:s,nulloption:!0}],className:""},params:this.channel}),this.renderAdapterOptions(null!=(o=this.channel.options)?o.adapter:void 0,e),e.find('[name="options::adapter"]').bind("change",(a=this,function(t){return a.renderAdapterOptions(t.target.value,e)})),e},e.prototype.renderAdapterOptions=function(t,e){var n,i,s,r,o;for(e.find(".js-channelAdapterOptions").html(""),i={},s=0,r=(o=this.config).length;s<r;s++)(n=o[s]).adapter===t&&n.notification&&(i=n.notification);if(!_.isEmpty(i))return new App.ControllerForm({el:e.find(".js-channelAdapterOptions"),model:{configure_attributes:i,className:""},params:this.channel})},e.prototype.onDelete=function(){return!0===this.channel.isNew()?(this.close(),void this.callback()):new App.ControllerGenericDestroyConfirm({item:this.channel,options:{url:"/api/v1/channels_sms/"+this.channel.id},container:this.el.closest(".content"),callback:(t=this,function(){return t.close(),t.callback()})});var t},e.prototype.onSubmit=function(n){var t,e,i,s,r,o;if(n.preventDefault(),""!==this.adapterSelect.val()){for(e in this.formDisable(n),(t=this.channel).options||(t.options={}),i=this.formParam(this.el))o=i[e],this.channel[e]=o;return this.channel.area="Sms::Notification",r="/api/v1/channels_sms",this.channel.isNew()||(r="/api/v1/channels_sms/"+this.channel.id),(s=this).channel.save({url:r,done:function(){return s.formEnable(n),s.channel=App.Channel.find(this.id),s.close(),s.callback()},fail:function(t,e){return s.log("errors",e),s.formEnable(n),s.showAlert(e.error_human||e.error||"Unable to update object!")}})}this.onDelete()},e.prototype.onTest=function(t){return t.preventDefault(),new n({channel:this.formParam(this.el),container:this.el.closest(".content")})},e}(App.ControllerModal),n=function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return i(s,t),s.prototype.head="Test SMS provider",s.prototype.buttonCancel=!0,s.prototype.content=function(){return new App.ControllerForm({model:{configure_attributes:[{name:"recipient",display:"Recipient",tag:"input","null":!1},{name:"message",display:"Message",tag:"input","null":!1,"default":"Test message from Zammad"}],className:""}}).form},s.prototype.T=function(t){return App.i18n.translateInline(t)},s.prototype.submit=function(t){var e,n,i;return s.__super__.submit.call(this,t),this.el.find(".js-danger").addClass("hide"),this.el.find(".js-success").addClass("hide"),this.formDisable(this.el),e=_.extend(this.formParam(t.currentTarget),{options:this.channel.options}),this.ajax({type:"POST",url:this.apiPath+"/channels_sms/test",data:JSON.stringify(e),processData:!0,success:(i=this,function(t){var e;return i.formEnable(i.el),(e=t.error||t.error_human)?i.el.find(".js-danger").text(i.T(e)).removeClass("hide"):i.el.find(".js-success").text(i.T("SMS successfully sent")).removeClass("hide")}),error:(n=this,function(t){var e;return e=JSON.parse(t.responseText),n.formEnable(n.el),n.el.find(".js-danger").text(n.T(e.error||"Unable to perform test")).removeClass("hide")})})},s}(App.ControllerModal),App.Config.set("SMS",{prio:3100,name:"SMS",parent:"#channels",target:"#channels/sms",controller:App.ChannelSms,permission:["admin.channel_sms"]},"NavBarAdmin")}.call(this),function(){var n,i,t,s=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=function(t){function e(){this.enable=s(this.enable,this),this.disable=s(this.disable,this),this["delete"]=s(this["delete"],this),this.edit=s(this.edit,this),this["new"]=s(this["new"],this),this.render=s(this.render,this),this.load=s(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return r(e,t),e.prototype.requiredPermission="admin.channel_telegram",e.prototype.events={"click .js-new":"new","click .js-edit":"edit","click .js-delete":"delete","click .js-disable":"disable","click .js-enable":"enable"},e.prototype.load=function(){return this.startLoading(),this.ajax({id:"telegram_index",type:"GET",url:this.apiPath+"/channels_telegram",processData:!0,success:(e=this,function(t){return e.stopLoading(),App.Collection.loadAssets(t.assets),e.render(t)})});var e},e.prototype.render=function(t){var e,n,i,s,r,o,a;for(i=[],r=0,o=(a=t.channel_ids).length;r<o;r++)n=a[r],(e=App.Channel.find(n))&&e.options&&(s="-",e.group_id&&(s=App.Group.find(e.group_id).displayName()),e.options.groupName=s),i.push(e);return this.html(App.view("telegram/index")({channels:i}))},e.prototype["new"]=function(t){return t.preventDefault(),new n({container:this.el.parents(".content"),load:this.load})},e.prototype.edit=function(t){var e,n;return t.preventDefault(),n=$(t.target).closest(".action").data("id"),e=App.Channel.find(n),new i({channel:e,container:this.el.parents(".content"),load:this.load})},e.prototype["delete"]=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),new App.ControllerConfirm({message:"Sure?",callback:(n=this,function(){return n.ajax({id:"telegram_delete",type:"DELETE",url:n.apiPath+"/channels_telegram",data:JSON.stringify({id:e}),processData:!0,success:function(){return n.load()}})}),container:this.el.closest(".content")})},e.prototype.disable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"telegram_disable",type:"POST",url:this.apiPath+"/channels_telegram_disable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e.prototype.enable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"telegram_enable",type:"POST",url:this.apiPath+"/channels_telegram_enable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e}(App.ControllerSubContent),n=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.onClosed=s(this.onClosed,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.head="Add Telegram Bot",e.prototype.shown=!0,e.prototype.button="Add",e.prototype.buttonCancel=!0,e.prototype.small=!0,e.prototype.content=function(){var t,e,n;return e=function(t){return App.UiElement.select.render({name:"group_id",multiple:!1,limit:100,"null":!1,relation:"Group",nulloption:!0,value:t,"class":"form-control--small"})},(t=$(App.view("telegram/bot_add")())).find(".js-select").on("click",(n=this,function(t){return n.selectAll(t)})),t.find(".js-messagesGroup").replaceWith(e(1)),t},e.prototype.onClosed=function(){if(this.isChanged)return this.isChanged=!1,this.load()},e.prototype.onSubmit=function(i){return this.formDisable(i),this.ajax({id:"telegram_app_verify",type:"POST",url:this.apiPath+"/channels_telegram",data:JSON.stringify(this.formParams()),processData:!0,success:(t=this,function(){return t.isChanged=!0,t.close()}),error:(s=this,function(t){var e,n;return e=JSON.parse(t.responseText),s.formEnable(i),n=App.i18n.translateContent(e.error||"Unable to save Bot."),s.el.find(".alert").removeClass("hidden").text(n)})});var s,t},e}(App.ControllerModal),i=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.onClosed=s(this.onClosed,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.head="Telegram Account",e.prototype.shown=!0,e.prototype.buttonCancel=!0,e.prototype.content=function(){var t,e;return e=function(t){return App.UiElement.select.render({name:"group_id",multiple:!1,limit:100,"null":!1,relation:"Group",nulloption:!0,value:t,"class":"form-control--small"})},(t=$(App.view(
"telegram/bot_edit")({channel:this.channel}))).find(".js-messagesGroup").replaceWith(e(this.channel.group_id)),t},e.prototype.onClosed=function(){if(this.isChanged)return this.isChanged=!1,this.load()},e.prototype.onSubmit=function(i){var t,s,e;return this.formDisable(i),t=this.formParams(),this.channel.options=t,this.ajax({id:"channel_telegram_update",type:"PUT",url:this.apiPath+"/channels_telegram/"+this.channel.id,data:JSON.stringify(this.formParams()),processData:!0,success:(e=this,function(){return e.isChanged=!0,e.close()}),error:(s=this,function(t){var e,n;return e=JSON.parse(t.responseText),s.formEnable(i),n=App.i18n.translateContent(e.error||"Unable to save changes."),s.el.find(".alert").removeClass("hidden").text(n)})})},e}(App.ControllerModal),App.Config.set("Telegram",{prio:5100,name:"Telegram",parent:"#channels",target:"#channels/telegram",controller:t,permission:["admin.channel_telegram"]},"NavBarAdmin")}.call(this),function(){var i,n,t,s=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=function(t){function e(){this.enable=s(this.enable,this),this.disable=s(this.disable,this),this["delete"]=s(this["delete"],this),this.edit=s(this.edit,this),this.configApp=s(this.configApp,this),this.show=s(this.show,this),this.render=s(this.render,this),this.load=s(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return r(e,t),e.prototype.requiredPermission="admin.channel_twitter",e.prototype.events={"click .js-new":"new","click .js-edit":"edit","click .js-delete":"delete","click .js-configApp":"configApp","click .js-disable":"disable","click .js-enable":"enable"},e.prototype.load=function(){return this.startLoading(),this.ajax({id:"twitter_index",type:"GET",url:this.apiPath+"/channels_twitter",processData:!0,success:(e=this,function(t){return e.stopLoading(),App.Collection.loadAssets(t.assets),e.callbackUrl=t.callback_url,e.render(t)})});var e},e.prototype.render=function(t){var e,n,i,s,r,o,a,l,c,p,u,h;if(r=App.ExternalCredential.findByAttribute("name","twitter")){for(i=[],o=0,l=(p=t.channel_ids).length;o<l;o++){if(n=p[o],(e=App.Channel.find(n))&&e.options&&e.options.sync&&e.options.sync.search)for(a=0,c=(u=e.options.sync.search).length;a<c;a++)s="-",(h=u[a]).group_id&&(s=App.Group.find(h.group_id).displayName()),h.groupName=s;e&&e.options&&e.options.sync&&e.options.sync.mentions&&(s="-",e.options.sync.mentions.group_id&&(s=App.Group.find(e.options.sync.mentions.group_id).displayName()),e.options.sync.mentions.groupName=s),e&&e.options&&e.options.sync&&e.options.sync.direct_messages&&(s="-",e.options.sync.direct_messages.group_id&&(s=App.Group.find(e.options.sync.direct_messages.group_id).displayName()),e.options.sync.direct_messages.groupName=s),i.push(e)}return this.html(App.view("twitter/list")({channels:i,external_credential:r})),this.channel_id?(this.edit(void 0,this.channel_id),this.channel_id=void 0):void 0}this.html(App.view("twitter/index")())},e.prototype.show=function(t){var e,n,i;for(e in n=[],t)i=t[e],"el"!==e&&"shown"!==e&&"match"!==e?n.push(this[e]=i):n.push(void 0);return n},e.prototype.configApp=function(){return new n({container:this.el.parents(".content"),callbackUrl:this.callbackUrl,load:this.load})},e.prototype["new"]=function(){return window.location.href=this.apiPath+"/external_credentials/twitter/link_account"},e.prototype.edit=function(t,e){var n;if(t&&(t.preventDefault(),e=$(t.target).closest(".action").data("id")),n=App.Channel.find(e))return new i({channel:n,container:this.el.parents(".content"),load:this.load});this.navigate("#channels/twitter")},e.prototype["delete"]=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),new App.ControllerConfirm({message:"Sure?",callback:(n=this,function(){return n.ajax({id:"twitter_delete",type:"DELETE",url:n.apiPath+"/channels_twitter",data:JSON.stringify({id:e}),processData:!0,success:function(){return n.load()}})}),container:this.el.closest(".content")})},e.prototype.disable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"twitter_disable",type:"POST",url:this.apiPath+"/channels_twitter_disable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e.prototype.enable=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),this.ajax({id:"twitter_enable",type:"POST",url:this.apiPath+"/channels_twitter_enable",data:JSON.stringify({id:e}),processData:!0,success:(n=this,function(){return n.load()})})},e}(App.ControllerSubContent),n=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.onClosed=s(this.onClosed,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.head="Connect Twitter App",e.prototype.shown=!0,e.prototype.button="Connect",e.prototype.buttonCancel=!0,e.prototype.small=!0,e.prototype.content=function(){var t,e;return this.external_credential=App.ExternalCredential.findByAttribute("name","twitter"),(t=$(App.view("twitter/app_config")({external_credential:this.external_credential,callbackUrl:this.callbackUrl}))).find(".js-select").on("click",(e=this,function(t){return e.selectAll(t)})),t},e.prototype.onClosed=function(){if(this.isChanged)return this.isChanged=!1,this.load()},e.prototype.onSubmit=function(e){return this.formDisable(e),this.ajax({id:"twitter_app_verify",type:"POST",url:this.apiPath+"/external_credentials/twitter/app_verify",data:JSON.stringify(this.formParams()),processData:!0,success:(n=this,function(t){return t.attributes?(n.external_credential||(n.external_credential=new App.ExternalCredential),n.external_credential.load({name:"twitter",credentials:t.attributes}),void n.external_credential.save({done:function(){return n.isChanged=!0,n.close()},fail:function(){return n.el.find(".alert").removeClass("hidden").text("Unable to create entry.")}})):(n.formEnable(e),n.el.find(".alert").removeClass("hidden").text(t.error||"Unable to verify App."))})});var n},e}(App.ControllerModal),i=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.onClosed=s(this.onClosed,this),this.getParams=s(this.getParams,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.head="Twitter Account",e.prototype.shown=!0,e.prototype.buttonCancel=!0,e.prototype.content=function(){var t,a,l,e,i,n,s,c;return a=$(App.view("twitter/account_edit")({channel:this.channel})),l=function(t,e){return App.UiElement.select.render({name:e+"::group_id",multiple:!1,limit:100,"null":!1,relation:"Group",nulloption:!0,value:t,"class":"form-control--small"})},t=function(){var t;return t=n.getParams(),n.searchTerms=t.search||[],n.searchTerms.push({term:"",group_id:""}),i(),a.find('.js-searchTermList [name="search::term"]').last().focus()},e=function(t){var e,n;return e=$(t.currentTarget).attr("data-index"),n=s.getParams(),s.searchTerms=n.search||[],s.searchTerms.splice(e,1),i()},i=function(){var t,e,n,i,s,r,o;if(c.searchTerms){for(a.find(".js-searchTermList").empty(),r=[],t=n=0,i=(s=c.searchTerms).length;n<i;t=++n)e=s[t],a.find(".js-searchTermList").append(App.view("twitter/search_term")({term:e.term,index:t})),o=l(e.group_id,"search"),r.push(a.find('.js-termGroup[data-index="'+t+'"]').replaceWith(o));return r}},(c=s=n=this).channel.options&&this.channel.options.sync&&this.channel.options.sync.search?this.searchTerms=this.channel.options.sync.search:this.searchTerms=[],i(),a.find(".js-searchTermAdd").click(t),a.find(".js-searchTermList").on("click",".js-searchTermRemove",e),a.find(".js-mentionsGroup").replaceWith(l(this.channel.options.sync.mentions.group_id,"mentions")),a.find(".js-directMessagesGroup").replaceWith(l(this.channel.options.sync.direct_messages.group_id,"direct_messages")),a},e.prototype.getParams=function(){var t,e,n,i,s,r,o;if(o=[],s=0,(i=this.formParams()).search)if(_.isArray(i.search.term))for(e=0,n=(r=i.search.term).length;e<n;e++)r[e],t={term:i.search.term[s],group_id:i.search.group_id[s]},o.push(t),s+=1;else o.push(i.search);return i.search=o,i.track_retweets?i.track_retweets=!0:i.track_retweets=!1,i},e.prototype.onClosed=function(){if(this.isChanged)return this.isChanged=!1,this.load()},e.prototype.onSubmit=function(n){return this.formDisable(n),this.channel.options.sync=this.getParams(),this.ajax({id:"channel_twitter_update",type:"POST",url:this.apiPath+"/channels_twitter/"+this.channel.id,data:JSON.stringify(this.channel.attributes()),processData:!0,success:(t=this,function(){return t.isChanged=!0,t.close()}),error:(i=this,function(t){var e;return e=JSON.parse(t.responseText),i.formEnable(n),i.el.find(".alert").removeClass("hidden").text(e.error||"Unable to save changes.")})});var i,t},e}(App.ControllerModal),App.Config.set("Twitter",{prio:5e3,name:"Twitter",parent:"#channels",target:"#channels/twitter",controller:t,permission:["admin.channel_twitter"]},"NavBarAdmin")}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ChannelWeb=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.title("Web",!0),this.tabs=[{name:"Settings",target:"w-setting",controller:App.SettingsArea,params:{area:"CustomerWeb::Base"}}],this.render()}return n(e,t),e.prototype.requiredPermission="admin.channel_web",e.prototype.header="Web",e}(App.ControllerTabs),App.Config.set("Web",{prio:1e3,name:"Web",parent:"#channels",target:"#channels/web",controller:App.ChannelWeb,permission:["admin.channel_web"]},"NavBarAdmin")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.DashboardActivityStream=function(t){function e(){this.onRenderEnd=n(this.onRenderEnd,this),this.itemsAll=n(this.itemsAll,this),this.itemGet=n(this.itemGet,this),this.load=n(this.load,this),this.fetch=n(this.fetch,this),e.__super__.constructor.apply(this,arguments),this.fetch(),this.bind("activity_stream_rebuild",this.load)}return i(e,t),e.prototype.model=!1,e.prototype.template="dashboard/activity_stream_item",e.prototype.uniqKey="id",e.prototype.observe={updated_at:!0},e.prototype.prepareForObjectListItemSupport=!0,e.prototype.items=[],e.prototype.insertPosition="before",e.prototype.fetch=function(){var t,e;return(t=App.SessionStorage.get("activity_stream"))?this.load(t):this.ajax({id:"dashoard_activity_stream",type:"GET",url:this.apiPath+"/activity_stream?full=true",data:{limit:this.limit||8},processData:!0,success:(e=this,function(t){return e.load(t)})})},e.prototype.load=function(t){return App.SessionStorage.set("activity_stream",t),App.ActivityStream.refresh([],{clear:!0}),App.Collection.loadAssets(t.assets),this.items=App.ActivityStream.search({sortBy:"created_at",order:"DESC"}),this.collectionSync(this.items)},e.prototype.itemGet=function(t){var e,n,i,s;for(e=0,i=(s=this.items).length;e<i;e++)if(t===(n=s[e]).id)return n},e.prototype.itemDestroy=function(){},e.prototype.itemsAll=function(){return this.items||[]},e.prototype.onRenderEnd=function(){if(!_.isEmpty(this.items))return this.el.closest(".sidebar").find(".activity-description").addClass("hidden")},e.prototype.onRenderItemEnd=function(t,e){return new App.WidgetAvatar({el:e.find(".js-avatar"),object_id:t.created_by_id,size:40})},e}(App.CollectionController)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.DashboardFirstSteps=function(t){function e(){this.testTicket=n(this.testTicket,this),this.testTicketLoading=n(this.testTicketLoading,this),this.scrollIntoView=n(this.scrollIntoView,this),this.load=n(this.load,this),e.__super__.constructor.apply(this,arguments),this.interval(this.load,2e4)}return i(e,t),e.prototype.events={"click a":"scrollIntoView","click .js-testTicket":"testTicket","click .js-inviteAgent":"inviteAgent","click .js-inviteCustomer":"inviteCustomer"},e.prototype.load=function(){var e;if(!this.lastData||this.el.is(":visible"))return this.ajax({type:"GET",url:this.apiPath+"/first_steps",success:(e=this,function(t){if(!_.isEqual(e.lastData,t))return e.lastData=t,e.render(t)})})},e.prototype.render=function(t){return this.html(App.view("dashboard/first_steps")({data:t}))},e.prototype.scrollIntoView=function(t){var e,n,i;if((n=$(t.currentTarget).attr("href"))&&"#"!==n)return e=function(){var t;return t=$("[href='"+n+"']"),i.scrollToIfNeeded(t)},(i=this).delay(e,40)},e.prototype.inviteAgent=function(t){return t.preventDefault(),new App.InviteUser({head:"Invite Colleagues",screen:"invite_agent"})},e.prototype.inviteCustomer=function(t){return t.preventDefault(),new App.InviteUser({head:"Invite Customer",screen:"invite_customer",role:"Customer"})},e.prototype.testTicketLoading=function(){var t,e,s;return e=App.view("dashboard/first_steps_test_ticket_loading")(),t=function(){return s.ajax({id:"test_ticket",type:"POST",url:s.apiPath+"/first_steps/test_ticket",processData:!0,success:function(t){var e,n,i;return App.Collection.loadAssets(t.assets),i=App.Ticket.fullLocal(t.ticket_id),n=App.Overview.fullLocal(t.overview_id),e=s.testTicketFinish({overviewName:App.i18n.translatePlain(n.name),overviewUrl:n.uiUrl(),ticketUrl:i.uiUrl(),ticketNumber:i.number}),$(".modal .modal-body").html(e)}})},(s=this).delay(t,2800),e},e.prototype.testTicketFinish=function(t){return App.view("dashboard/first_steps_test_ticket_finish")(t)},e.prototype.testTicket=function(t){var e;return t.preventDefault(),e=new App.ControllerModal({head:"Test Ticket",content:this.testTicketLoading,shown:!0,buttonSubmit:!1,buttonCancel:!1,small:!0,closeOnAnyClick:!0,onSubmit:function(){return e.close()}})},e}(App.Controller)}.call(this),function(){var i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.FirstStepsClues=function(t){function n(t){var e;this.hideWindow=i(this.hideWindow,this),this.showWindow=i(this.showWindow,this),this.showClue=i(this.showClue,this),this.render=i(this.render,this),this.close=i(this.close,this),this.previous=i(this.previous,this),this.next=i(this.next,this),$("#app").append('<div class="js-modal--clue"></div>'),t.el=$("#app .js-modal--clue"),n.__super__.constructor.call(this,t),this.position=0,this.render(),this.bind("ui:rerender",(e=this,function(){return e.render(),"clues"}))}return e(n,t),n.prototype.clues=[{container:".js-dashboardMenuItem",headline:"Dashboard",text:"Here you see a quick overview of your and other agents' performance.",actions:["hover"]},{container:".search-holder",headline:"Search",text:'Here you can search for tickets, customers and organizations. Use the wildcard \xa7*\xa7 to find everything. E. g. \xa7smi*\xa7 or \xa7rosent*l\xa7. You also can use ||double quotes|| for searching phrases \xa7"some phrase"\xa7.',actions:[]},{container:".user-menu",headline:"Create",text:"Here you can create new tickets. Also if you have the permissions you can create new customers and organizations.",actions:["click .add .js-action","hover .add"]},{container:".user-menu",headline:"Personal Settings",text:"Here you can sign out, change the frontend language and see your last viewed items.",actions:["click .user .js-action","hover .user"]},{container:".js-overviewsMenuItem",headline:"Overviews",text:"Here you find your ticket overviews for open, assigned and escalated tickets.",actions:["hover"]}],n.prototype.elements={".js-positionOrigin":"modalWindow",".js-backdrop":"backdrop"},n.prototype.events={click:"stopPropagation","click .js-next":"next","click .js-previous":"previous","click .js-close":"close"},n.prototype.stopPropagation=function(t){return t.stopPropagation()},n.prototype.next=function(t){return t.stopPropagation(),this.navigate(1)},n.prototype.previous=function(t){return t.stopPropagation(),this.navigate(-1)},n.prototype.close=function(){return this.cleanUp(),this.options.onComplete(),this.remove()},n.prototype.remove=function(){return this.el.remove()},n.prototype.navigate=function(t){return this.cleanUp((e=this,function(){return e.position+=t,e.position<e.clues.length?e.showClue():(e.options.onComplete(),e.remove())}));var e},n.prototype.cleanUp=function(n){return this.hideWindow((i=this,function(){var t,e;if(t=i.clues[i.position],(e=$("#app "+t.container)).removeClass("selected-clue"),t.actions&&i.perform(t.actions,e,"cleanup"),n)return n()}));var i},n.prototype.render=function(){return this.el.addClass("modal modal--clue"),this.html(App.view("dashboard/first_steps_clues")),this.backdrop.velocity({properties:{opacity:[1,0]},options:{duration:300,complete:this.showClue}})},n.prototype.showClue=function(){var t,e,n,i;return n=this.clues[this.position],(i=$("#app "+n.container)).addClass("selected-clue"),n.actions&&this.perform(n.actions,i,"show"),e={x:(t=this.getVisibleBoundingBox(i.get(0))).left+t.width/2,y:t.top+t.height/2},this.modalWindow.html(App.view("dashboard/first_steps_clues_content")({headline:n.headline,text:n.text,position:this.position,max:this.clues.length})),this.placeWindow(t),this.backdrop.velocity({properties:{translateX:e.x,translateY:e.y,translateZ:0},options:{duration:300,complete:this.showWindow}})},n.prototype.showWindow=function(){return this.modalWindow.velocity({properties:{scale:[1,.2],opacity:[1,0]},options:{duration:300,easing:[.34,1.61,.7,1]}})},n.prototype.hideWindow=function(t){return this.modalWindow.velocity({properties:{scale:[.2,1],opacity:0},options:{duration:200,complete:t}})},n.prototype.placeWindow=function(t){var e,n,i,s,r,o,a,l,c;return $.Velocity.hook(this.modalWindow,"scale",1),s=this.modalWindow.get(0).getBoundingClientRect(),a="",l=e=0,i=$(window).width(),n=$(window).height(),t.height>t.width?(t.right+s.width<=i?(e=t.right,a="right"):(e=t.left-s.width,a="left"),a&&(l=t.top+t.height/2-s.height/2)):(t.height<=t.width||!a)&&(0<=t.top-s.height?(l=t.top-s.height,a="above"):(l=t.bottom,a="below"),a&&(e=t.left+t.width/2-s.width/2)),e<0?(r=s.width/2+e,e=0):e+s.width>i&&(r=s.width/2+i-(e+s.width),e=i-s.width),l<0?(r=s.height/2+l,l=0):l+s.height>n&&(r=s.height/2+n-(l+s.height),l=n-s.height),c=this.getTransformOrigin(s,a),r&&(o="above"===a||"below"===a?"left":"top",this.modalWindow.find(".js-arrow").css(o,r),"above"===a||"below"===a?c.x=r:c.y=r),this.modalWindow.attr("data-position",a).css({left:e,top:l,transformOrigin:c.x+"px "+c.y+"px"})},n.prototype.getTransformOrigin=function(t,e){return{above:{x:t.width/2,y:t.height},below:{x:t.width/2,y:0},left:{x:t.width+this.transformOriginPadding,y:t.height/2},right:{x:-this.transformOriginPadding,y:t.height/2}}[e]},n.prototype.getVisibleBoundingBox=function(t){var e,n,i,s,r,o;for(i=t.querySelectorAll("*"),s={left:(e=t.getBoundingClientRect()).left,right:e.right,top:e.top,bottom:e.bottom},r=0,o=i.length;r<o;r++)n=i[r],!1!==getComputedStyle(n).position&&0!==(e=n.getBoundingClientRect()).width&&0!==e.height&&(e.left<s.left&&(s.left=e.left),e.top<s.top&&(s.top=e.top),e.right>s.right&&(s.right=e.right),e.bottom>s.bottom&&(s.bottom=e.bottom));return s.width=s.right-s.left,s.height=s.bottom-s.top,s},n.prototype.perform=function(t,e,n){var i,s,r,o,a,l;for(a=[],r=0,o=t.length;r<o;r++)switch((i=t[r]).indexOf(" ")<0?(s=i,l=e):(s=i.substr(0,i.indexOf(" ")),l=e.find(i.substr(i.indexOf(" ")+1))),s){case"click":a.push(l.trigger("click"));break;case"hover":$("#app .navigation .is-active").removeClass("is-active"),"show"===n?a.push(l.addClass("is-hovered")):a.push(l.removeClass("is-hovered"));break;default:a.push(void 0)}return a},n}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.DashboardStats=function(t){function e(){this.load=n(this.load,this),e.__super__.constructor.apply(this,arguments),this.load(),this.bind("dashboard_stats_rebuild",this.load)}return i(e,t),e.prototype.load=function(){return this.setupStatsWidget("Stats","stats",this.el)},e.prototype.setupStatsWidget=function(t,e,n){var i,s,r,o,a,l;if(App.Event.trigger(e+":init"),o=App.Config.get(t))for(l=$.map(o,function(t){return t}),s=0,r=(l=_.sortBy(l,function(t){return t.prio})).length;s<r;s++)if(a=l[s],this.permissionCheck(a.permission))try{new a.controller({el:n}),this.$(".js-stat-help").tooltip()}catch(c){i=c,this.log("error","statsWidgets "+a+":",i)}return App.Event.trigger(e+":ready")},e}(App.Controller)}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.load=n(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return i(e,t),e.prototype.load=function(){var t;return(t=App.StatsStore.first())?this.render(t.data):this.render()},e.prototype.render=function(t){var e,n,i,s,r;for(i in null==t&&(t={}),t.StatsTicketChannelDistribution||(t.StatsTicketChannelDistribution={channels:{1:{icon:"email",sender:"email",inbound:0,outbound:0,inbound_in_percent:0,outbound_in_percent:0},2:{icon:"phone",sender:"phone",inbound:0,outbound:0,inbound_in_percent:0,outbound_in_percent:0}}}),r=_.reduce(t.StatsTicketChannelDistribution.channels,function(t,e){return t+e.inbound+e.outbound},0),_.size(t.StatsTicketChannelDistribution.channels),s=t.StatsTicketChannelDistribution.channels)(e=s[i]).overal_percentage=Math.round((e.inbound+e.outbound)/r*100)||0;return t.StatsTicketChannelDistribution.description="How many of your tickets are coming from email, phone, Twitter, or Facebook? (Shows percentages for both inbound and outbound tickets.)",n=App.view("dashboard/stats/ticket_channel_distribution")(t),0<this.$(".ticket_channel_distribution").length?this.$(".ticket_channel_distribution").html(n):this.el.append(n)},e}(App.Controller),App.Config.set("ticket_channel_distribution",{controller:t,permission:"ticket.agent",prio:300},"Stats")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.load=n(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return i(e,t),e.prototype.load=function(){var t;return(t=App.StatsStore.first())?this.render(t.data):this.render()},e.prototype.render=function(t){var e;return null==t&&(t={}),t.StatsTicketEscalation||(t.StatsTicketEscalation={state:"supergood",own:0,total:0}),t.StatsTicketEscalation.description="How many escalated tickets do you have open? (Mr. Bubbles gets grumpy if you have too many\u2026)",e=App.view("dashboard/stats/ticket_escalation")(t),0<this.$(".ticket_escalation").length?this.$(".ticket_escalation").html(e):this.el.append(e)},e}(App.Controller),App.Config.set("ticket_escalation",{controller:t,permission:"ticket.agent",prio:200},"Stats")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.load=n(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return i(e,t),e.prototype.load=function(){var t;return(t=App.StatsStore.first())?this.render(t.data):this.render()},e.prototype.render=function(t){var e;return null==t&&(t={}),t.StatsTicketInProcess||(t.StatsTicketInProcess={state:"supergood",percent:0,average_per_agent:0}),t.StatsTicketInProcess.description="What percentage of your tickets have you responded to, updated, or modified in some way today?",e=App.view("dashboard/stats/ticket_in_process")(t),0<this.$(".ticket_in_process").length?this.$(".ticket_in_process").html(e):this.el.append(e)},e}(App.Controller),App.Config.set("ticket_in_process",{controller:t,permission:"ticket.agent",prio:500},"Stats")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.load=n(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return i(e,t),e.prototype.load=function(){var t;return(t=App.StatsStore.first())?this.render(t.data):this.render()},e.prototype.render=function(t){var e;return null==t&&(t={}),t.StatsTicketLoadMeasure||(t.StatsTicketLoadMeasure={state:"supergood",percent:0,own:0,total:0,average_per_agent:0}),t.StatsTicketLoadMeasure.description="Out of all open tickets (company-wide), how many are assigned to you?",e=App.view("dashboard/stats/ticket_load_measure")(t),0<this.$(".ticket_load_measure").length?this.$(".ticket_load_measure").html(e):this.el.append(e)},e}(App.Controller),App.Config.set("ticket_load_measure",{controller:t,permission:"ticket.agent",prio:400},"Stats")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.load=n(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return i(e,t),e.prototype.load=function(){var t;return(t=App.StatsStore.first())?this.render(t.data):this.render()},e.prototype.render=function(t){var e;return null==t&&(t={}),t.StatsTicketReopen||(t.StatsTicketReopen={state:"supergood",percent:0,average_per_agent:0}),t.StatsTicketReopen.description="How many of your tickets have been re-opened after being marked \u201cclosed\u201d?",e=App.view("dashboard/stats/ticket_reopen")(t),0<this.$(".ticket_reopen").length?this.$(".ticket_reopen").html(e):this.el.append(e)},e}(App.Controller),App.Config.set("ticket_reopen",{controller:t,permission:"ticket.agent",prio:600},"Stats")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.renderWidgetClockFace=n(this.renderWidgetClockFace,this),this.load=n(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return i(e,t),e.prototype.load=function(){var t;return(t=App.StatsStore.first())?this.render(t.data):this.render()},e.prototype.render=function(t){var e;if(null==t&&(t={}),t.StatsTicketWaitingTime||(t.StatsTicketWaitingTime={handling_time:0,average:0,state:"supergood",average_per_agent:0}),t.StatsTicketWaitingTime.description="How long has each customer had to wait, on average, to get a response from you today?",e=App.view("dashboard/stats/ticket_waiting_time")(t),0<this.$(".ticket_waiting_time").length?this.$(".ticket_waiting_time").html(e):this.el.append(e),t.StatsTicketWaitingTime)return this.renderWidgetClockFace(t.StatsTicketWaitingTime.handling_time,t.StatsTicketWaitingTime.state,t.StatsTicketWaitingTime.percent)},e.prototype.renderWidgetClockFace=function(t,e,n){var i,s,r,o,a,l,c,p,u;for(l in a=window.devicePixelRatio||1,o=(r=this.el.find("canvas")).get(0).getContext("2d"),p=26,this.el.find(".time.stat-widget .stat-amount").text(t),r.attr("width",2*p*a),r.attr("height",2*p*a),o.scale(a,a),c={supergood:"#38AE6A",good:"#A9AC41",ok:"#FAAB00",bad:"#F6820B",superbad:"#F35910"})if(u=c[l],e===l){s=u;break}return 0!==t&&(o.globalAlpha=.3),o.fillStyle=s,o.beginPath(),o.arc(p,p,p,0,2*Math.PI,!0),o.closePath(),o.fill(),o.globalAlpha=1,o.beginPath(),o.moveTo(p,p),i=2*Math.PI*n,o.arc(p,p,p,-Math.PI/2,i-Math.PI/2,!1),o.lineTo(p,p),o.closePath(),o.fill()},e}(App.Controller),App.Config.set("ticket_waiting_time",{controller:t,permission:"ticket.agent",prio:100},"Stats")}.call(this),function(){App.Config.set("History",[]),App.Config.set("User",{prio:1e3,parent:"",callback:function(){var t;return(t={}).name=App.Session.get("login"),t},target:"#current_user","class":"user"},"NavBarRight"),App.Config.set("Admin",{prio:9e3,parent:"",name:"Admin",translate:!0,target:"#manage",icon:"cog",permission:["admin.*"]},"NavBarRight"),App.Config.set("New",{prio:2e4,parent:"",name:"New",translate:!0,target:"#new","class":"add",icon:"plus"},"NavBarRight"),App.Config.set("Misc",{prio:9e4,parent:"",name:"Tools",translate:!0,target:"#tools",child:!0,"class":"tools"},"NavBar")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ControllerIntegrationBase=function(t){function e(){this.render=n(this.render,this),this["switch"]=n(this["switch"],this),e.__super__.constructor.apply(this,arguments),this.title(this.featureName,!0),this.initalRender=!0,App.Setting.fetchFull(this.render,{force:!1})}return i(e,t),e.prototype.events={"change .js-switch input":"switch"},e.prototype.featureIntegration="tbd_integration",e.prototype.featureName="Tbd",e.prototype["switch"]=function(){var t;return t=this.$(".js-switch input").prop("checked"),App.Setting.set(this.featureIntegration,t)},e.prototype.render=function(){if(this.initalRender)return this.html(App.view("integration/base")({header:this.featureName,description:this.description,feature:this.featureIntegration,featureEnabled:App.Setting.get(this.featureIntegration)})),this.initalRender=!1},e}(App.Controller)}.call(this),function(){var t,e,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.featureIntegration="check_mk_integration",e.prototype.featureName="Check_MK",e.prototype.featureConfig="check_mk_config",e.prototype.description=[["This service receives http requests or emails from %s and creates tickets with host and service.","Check_MK"],["If the host and service is recovered again, the ticket will be closed automatically."]],e.prototype.render=function(){return e.__super__.render.apply(this,arguments),new App.SettingsForm({area:"Integration::CheckMK",el:this.$(".js-form")}),new App.ScriptSnipped({el:this.$(".js-scriptSnippedPre"),style:"bash",description:[['To enable %s for sending http requests to %s, you need create a own "notification rule" in %s.',"Check_MK","Zammad","Check_MK"],["Configurable in the admin interface of %s.","Check_MK"],["You can use the following script to post the data to %s.","Zammad"]]}),new App.ScriptSnipped({el:this.$(".js-scriptSnipped"),header:"Service Notification",style:"bash",description:[["Script can be located under: ||%s||","/opt/omd/site/SITENAME/local/share/check_mk/notifications/zammad-service"],["Please make sure that the script is executable: ||%s||","chmod +x /opt/omd/site/SITENAME/local/share/check_mk/notifications/zammad-service"]],content:'#!/bin/bash\n\ncurl -X POST -F "event_id=$NOTIFY_SERVICEPROBLEMID" -F "host=$NOTIFY_HOSTNAME" -F "service=$NOTIFY_SERVICEDESC" -F "state=$NOTIFY_SERVICESTATE" -F "text=$NOTIFY_SERVICEOUTPUT" '+App.Config.get("http_type")+"://"+App.Config.get("fqdn")+"/api/v1/integration/check_mk/"+App.Setting.get("check_mk_token")}),new App.ScriptSnipped({el:this.$(".js-scriptSnippedExtended"),header:"Host Notification",style:"bash",description:[["Script can be located under: ||%s||","/opt/omd/site/SITENAME/local/share/check_mk/notifications/zammad-host"],[
"Please make sure that the script is executable: ||%s||","chmod +x /opt/omd/site/SITENAME/local/share/check_mk/notifications/zammad-host"]],content:'#!/bin/bash\n\ncurl -X POST -F "event_id=$NOTIFY_HOSTPROBLEMID" -F "host=$NOTIFY_HOSTNAME" -F "service=$NOTIFY_SERVICEDESC" -F "state=$NOTIFY_HOSTSTATE" -F "text=$NOTIFY_HOSTOUTPUT" '+App.Config.get("http_type")+"://"+App.Config.get("fqdn")+"/api/v1/integration/check_mk/"+App.Setting.get("check_mk_token")}),new App.ScriptSnipped({el:this.$(".js-scriptSnippedPost"),header:"Further Attributes",style:"bash",description:[["It is also possible to set further attributes of created tickets. To do this, you only need to pass one additional parameter."]],content:'... -F "additional_ticket_attribute=some_value" ...'}),new App.HttpLog({el:this.$(".js-log"),facility:"check_mk"})},e}(App.ControllerIntegrationBase),e=function(){function t(){}return t.current=function(){return App.Setting.get("check_mk_integration")},t}(),App.Config.set("IntegrationCheckMk",{name:"Check_MK",target:"#system/integration/check_mk",description:"An open source monitoring tool.",controller:t,state:e,permission:["admin.integration.check_mk"]},"NavBarIntegrations")}.call(this),function(){var n,t,e,i=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function e(){return this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.featureIntegration="clearbit_integration",e.prototype.featureName="Clearbit",e.prototype.featureConfig="clearbit_config",e.prototype.description=[["Automatically enrich your customers and organizations with fresh, up-to-date intel. Map data directly to object fields."]],e.prototype.render=function(){return e.__super__.render.apply(this,arguments),new n({el:this.$(".js-form")}),new App.HttpLog({el:this.$(".js-log"),facility:"clearbit"})},e}(App.ControllerIntegrationBase),n=function(t){function e(){this.removeRow=i(this.removeRow,this),this.addOrganizationSync=i(this.addOrganizationSync,this),this.addUserSync=i(this.addUserSync,this),this.update=i(this.update,this),this.updateCurrentConfig=i(this.updateCurrentConfig,this),this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return s(e,t),e.prototype.events={"submit form":"update","click .js-userSync .js-add":"addUserSync","click .js-organizationSync .js-add":"addOrganizationSync","click .js-userSync .js-remove":"removeRow","click .js-organizationSync .js-remove":"removeRow"},e.prototype.currentConfig=function(){var t;return(t=clone(App.Setting.get("clearbit_config")))||(t={}),void 0===t.organization_autocreate&&(t.organization_autocreate=!0),void 0===t.organization_shared&&(t.organization_shared=!1),t.user_sync||(t.user_sync={"person.name.givenName":"user.firstname","person.name.familyName":"user.lastname","person.email":"user.email","person.bio":"user.note","company.url":"user.web","person.site":"user.web","company.location":"user.address","person.location":"user.address"}),t.organization_sync||(t.organization_sync={"company.legalName":"organization.name","company.name":"organization.name","company.description":"organization.note"}),t},e.prototype.setConfig=function(t){return App.Setting.set("clearbit_config",t,{notify:!0})},e.prototype.render=function(){var t,e,n,i,s;for(this.config||(this.config=this.currentConfig()),s=[{name:"api_key",display:"API Key",tag:"input",type:"text",limit:100,"null":!1,placeholder:"...",note:"Your api key."},{name:"organization_autocreate",display:"Auto create",tag:"boolean",type:"boolean","null":!1,note:"Create organizations automatically if record has one."},{name:"organization_shared",display:"Shared",tag:"boolean",type:"boolean","null":!1,note:"New organizations are shared."}],this.html(App.view("integration/clearbit")({config:this.config,settings:s})),n=[],t=0,e=s.length;t<e;t++)(i=s[t]).display="",n.push(new App.ControllerForm({el:this.$("[data-name="+i.name+"]"),model:{configure_attributes:[i]},params:this.config}));return n},e.prototype.updateCurrentConfig=function(){var i,s,t;return s=this.config,i=this.cleanupInput,t=this.formParam(this.$("form")),s.api_key=t.api_key,s.organization_autocreate=t.organization_autocreate,s.organization_shared=t.organization_shared,s.user_sync={},this.$(".js-userSync .js-row").each(function(){var t,e,n;return e=$(this),n=i(e.find('input[name="source"]').val()),t=i(e.find('input[name="destination"]').val()),s.user_sync[n]=t}),s.organization_sync={},this.$(".js-organizationSync .js-row").each(function(){var t,e,n;return e=$(this),n=i(e.find('input[name="source"]').val()),t=i(e.find('input[name="destination"]').val()),s.organization_sync[n]=t}),this.config=s},e.prototype.update=function(t){return t.preventDefault(),this.updateCurrentConfig(),this.setConfig(this.config)},e.prototype.cleanupInput=function(t){return t?t.replace(/\s/g,"").trim():t},e.prototype.addUserSync=function(t){var e,n,i;if(t.preventDefault(),this.updateCurrentConfig(),n=$(t.currentTarget).closest("tr"),i=this.cleanupInput(n.find('input[name="source"]').val()),e=this.cleanupInput(n.find('input[name="destination"]').val()),!_.isEmpty(i)&&!_.isEmpty(e))return this.config.user_sync[i]=e,this.render()},e.prototype.addOrganizationSync=function(t){var e,n,i;if(t.preventDefault(),this.updateCurrentConfig(),n=$(t.currentTarget).closest("tr"),i=this.cleanupInput(n.find('input[name="source"]').val()),e=this.cleanupInput(n.find('input[name="destination"]').val()),!_.isEmpty(i)&&!_.isEmpty(e))return this.config.organization_sync[i]=e,this.render()},e.prototype.removeRow=function(t){return t.preventDefault(),this.updateCurrentConfig(),$(t.currentTarget).closest("tr").remove(),this.updateCurrentConfig()},e}(App.Controller),e=function(){function t(){}return t.current=function(){return App.Setting.get("clearbit_integration")},t}(),App.Config.set("IntegrationClearbit",{name:"Clearbit",target:"#system/integration/clearbit",description:"A powerful service to get more information about your customers.",controller:t,state:e,permission:["admin.integration.clearbit"]},"NavBarIntegrations")}.call(this),function(){var n,t,e,i=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function e(){return this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.featureIntegration="cti_integration",e.prototype.featureName="CTI (generic)",e.prototype.featureConfig="cti_config",e.prototype.description=[["This service shows you contacts of incoming calls and a caller list in realtime."],["Also caller id of outbound calls can be changed."]],e.prototype.events={"click .js-select":"selectAll","change .js-switch input":"switch"},e.prototype.render=function(){return e.__super__.render.apply(this,arguments),new n({el:this.$(".js-form")}),new App.HttpLog({el:this.$(".js-log"),facility:"cti"})},e}(App.ControllerIntegrationBase),n=function(t){function e(){this.removeNotifyMap=i(this.removeNotifyMap,this),this.removeOutboundRouting=i(this.removeOutboundRouting,this),this.removeInboundBlockCallerId=i(this.removeInboundBlockCallerId,this),this.addNotifyMap=i(this.addNotifyMap,this),this.addOutboundRouting=i(this.addOutboundRouting,this),this.addInboundBlockCallerId=i(this.addInboundBlockCallerId,this),this.update=i(this.update,this),this.updateCurrentConfig=i(this.updateCurrentConfig,this),this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return s(e,t),e.prototype.events={"submit form":"update","click .js-inboundBlockCallerId .js-add":"addInboundBlockCallerId","click .js-outboundRouting .js-add":"addOutboundRouting","click .js-notifyMap .js-addMap":"addNotifyMap","click .js-inboundBlockCallerId .js-remove":"removeInboundBlockCallerId","click .js-outboundRouting .js-remove":"removeOutboundRouting","click .js-notifyMap .js-removeMap":"removeNotifyMap"},e.prototype.currentConfig=function(){var t;return(t=App.Setting.get("cti_config")).outbound||(t.outbound={}),t.outbound.routing_table||(t.outbound.routing_table=[]),t.inbound||(t.inbound={}),t.inbound.block_caller_ids||(t.inbound.block_caller_ids=[]),t.notify_map||(t.notify_map=[]),t},e.prototype.setConfig=function(t){return App.Setting.set("cti_config",t,{notify:!0})},e.prototype.render=function(){var t,e,n,i,s,r;for(this.config=this.currentConfig(),this.html(App.view("integration/cti")({config:this.config,cti_token:App.Setting.get("cti_token")})),t=[{name:"user_ids",display:"",tag:"column_select",multiple:!0,"null":!0,relation:"User",sortBy:"firstname"}],new App.ControllerForm({el:this.$(".js-userSelectorBlank"),model:{configure_attributes:t},params:{user_ids:[]},autofocus:!1}),s=[],e=0,n=(i=this.config.notify_map).length;e<n;e++)r=i[e],t=[{name:"user_ids",display:"",tag:"column_select",multiple:!0,"null":!0,relation:"User",sortBy:"firstname"}],s.push(new App.ControllerForm({el:this.$("[name=queue][value='"+r.queue+"']").closest("tr").find(".js-userSelector"),model:{configure_attributes:t},params:{user_ids:r.user_ids},autofocus:!1}));return s},e.prototype.updateCurrentConfig=function(){var i,s,t;return s=this.config,i=this.cleanupInput,t=this.$("input[name=default_caller_id]").val(),s.outbound.default_caller_id=i(t),s.outbound.routing_table=[],this.$(".js-outboundRouting .js-row").each(function(){var t,e,n;return e=i($(this).find('input[name="dest"]').val()),t=i($(this).find('input[name="caller_id"]').val()),n=$(this).find('input[name="note"]').val(),s.outbound.routing_table.push({dest:e,caller_id:t,note:n})}),s.inbound.block_caller_ids=[],this.$(".js-inboundBlockCallerId .js-row").each(function(){var t,e;return t=$(this).find('input[name="caller_id"]').val(),e=$(this).find('input[name="note"]').val(),s.inbound.block_caller_ids.push({caller_id:i(t),note:e})}),s.notify_map=[],this.$(".js-notifyMap .js-row").each(function(){var t,e;return t=$(this).find('input[name="queue"]').val(),e=$(this).find('select[name="user_ids"]').val(),s.notify_map.push({queue:i(t),user_ids:e})}),this.config=s},e.prototype.update=function(t){return t.preventDefault(),this.updateCurrentConfig(),this.setConfig(this.config)},e.prototype.cleanupInput=function(t){return t?t.replace(/\s/g,"").trim():t},e.prototype.addInboundBlockCallerId=function(t){var e,n,i;if(t.preventDefault(),this.updateCurrentConfig(),e=(n=$(t.currentTarget).closest("tr")).find('input[name="caller_id"]').val(),i=n.find('input[name="note"]').val(),!_.isEmpty(e)&&!_.isEmpty(i))return this.config.inbound.block_caller_ids.push({caller_id:this.cleanupInput(e),note:i}),this.render()},e.prototype.addOutboundRouting=function(t){var e,n,i,s;if(t.preventDefault(),this.updateCurrentConfig(),i=$(t.currentTarget).closest("tr"),n=this.cleanupInput(i.find('input[name="dest"]').val()),e=this.cleanupInput(i.find('input[name="caller_id"]').val()),s=i.find('input[name="note"]').val(),!(_.isEmpty(e)||_.isEmpty(n)||_.isEmpty(s)))return this.config.outbound.routing_table.push({dest:n,caller_id:e,note:s}),this.render()},e.prototype.addNotifyMap=function(t){var e,n,i,s,r,o;if(t.preventDefault(),this.updateCurrentConfig(),e=$(t.currentTarget).closest("tr"),s=this.cleanupInput(e.find('input[name="queue"]').val()),o=e.find('select[name="user_ids"]').val(),_.isEmpty(s))this.notify({type:"error",msg:App.i18n.translateContent("A queue is required!"),timeout:6e3});else{if(!_.isEmpty(o)){for(n=0,i=(r=this.config.notify_map).length;n<i;n++)if(r[n].queue===s)return void this.notify({type:"error",msg:App.i18n.translateContent("Queue already exists!"),timeout:6e3});return this.config.notify_map.push({queue:s,user_ids:o}),this.render()}this.notify({type:"error",msg:App.i18n.translateContent("A user is required!"),timeout:6e3})}},e.prototype.removeInboundBlockCallerId=function(t){return t.preventDefault(),this.updateCurrentConfig(),$(t.currentTarget).closest("tr").remove(),this.updateCurrentConfig()},e.prototype.removeOutboundRouting=function(t){return t.preventDefault(),this.updateCurrentConfig(),$(t.currentTarget).closest("tr").remove(),this.updateCurrentConfig()},e.prototype.removeNotifyMap=function(t){return t.preventDefault(),this.updateCurrentConfig(),$(t.currentTarget).closest("tr").remove(),this.updateCurrentConfig()},e}(App.Controller),e=function(){function t(){}return t.current=function(){return App.Setting.get("cti_integration")},t}(),App.Config.set("IntegrationCti",{name:"CTI (generic)",target:"#system/integration/cti",description:"Generic API to integrate VoIP service provider with realtime push.",controller:t,state:e},"NavBarIntegrations")}.call(this),function(){var n,e,t,i,s=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=function(t){function n(){return this["switch"]=s(this["switch"],this),this.render=s(this.render,this),n.__super__.constructor.apply(this,arguments)}return r(n,t),n.prototype.featureIntegration="exchange_integration",n.prototype.featureName="Exchange",n.prototype.featureConfig="exchange_config",n.prototype.description=[["This service enables Zammad to connect with your Exchange server."]],n.prototype.events={"change .js-switch input":"switch"},n.prototype.render=function(){return n.__super__.render.apply(this,arguments),new e({el:this.$(".js-form")}),new App.HttpLog({el:this.$(".js-log"),facility:"exchange"})},n.prototype["switch"]=function(){var t,e;if(n.__super__["switch"].apply(this,arguments),this.$(".js-switch input").prop("checked"))return e=this,t=function(){return e.ajax({id:"jobs_config",type:"POST",url:e.apiPath+"/integration/exchange/job_start",processData:!0,success:function(){return e.render(!0)}})},App.Delay.set(t,600,"job_start")},n}(App.ControllerIntegrationBase),e=function(t){function e(){this.activeDryRun=s(this.activeDryRun,this),this.lastResultShow=s(this.lastResultShow,this),this.lastResult=s(this.lastResult,this),this.startWizard=s(this.startWizard,this),this.startSync=s(this.startSync,this),this.render=s(this.render,this),this.setConfig=s(this.setConfig,this),e.__super__.constructor.apply(this,arguments),this.render(),this.lastResult(),this.activeDryRun()}return r(e,t),e.prototype.elements={".js-lastImport":"lastImport",".js-wizard":"wizardButton"},e.prototype.events={"click .js-wizard":"startWizard","click .js-start-sync":"startSync"},e.prototype.currentConfig=function(){return App.Setting.get("exchange_config")||{}},e.prototype.setConfig=function(t){return App.Setting.set("exchange_config",t,{notify:!0}),this.startSync()},e.prototype.render=function(t){var e,n,i,s,r,o,a;if(null==t&&(t=!1),this.config=this.currentConfig(),i=[],!_.isEmpty(this.config.folders))for(s=0,r=(o=this.config.folders).length;s<r;s++)n=o[s],i.push(this.config.wizardData.backend_folders[n]);if(this.html(App.view("integration/exchange")({config:this.config,folders:i})),_.isEmpty(this.config)?(this.$(".js-notConfigured").removeClass("hide"),this.$(".js-summary").addClass("hide")):(this.$(".js-notConfigured").addClass("hide"),this.$(".js-summary").removeClass("hide")),t)return e=function(){return a.scrollToIfNeeded($(".content.active .page-header"))},(a=this).delay(e,500)},e.prototype.startSync=function(){return this.ajax({id:"jobs_config",type:"POST",url:this.apiPath+"/integration/exchange/job_start",processData:!0,success:(t=this,function(){return t.render(!0),t.lastResult()})});var t},e.prototype.startWizard=function(t){return t.preventDefault(),new n({container:this.el.closest(".content"),config:this.config,callback:(e=this,function(t){return e.setConfig(t)})});var e},e.prototype.lastResult=function(){return this.ajax({id:"jobs_start_index",type:"GET",url:this.apiPath+"/integration/exchange/job_start",processData:!0,success:(e=this,function(t){return _.isEmpty(t)||e.lastResultShowJob&&e.lastResultShowJob.updated_at===t.updated_at||(e.lastResultShowJob=t,e.lastResultShow(t),t.finished_at?e.wizardButton.attr("disabled",!1):e.wizardButton.attr("disabled",!0)),e.delay(e.lastResult,5e3)})});var e},e.prototype.lastResultShow=function(t){var e,n,i,s,r;if(!_.isEmpty(t)){for(s in t.result.roles||(t.result.roles={}),n=t.result.role_ids)r=n[s],i=App.Role.find(s),t.result.roles[i.displayName()]=r;return e=$(App.view("integration/exchange_last_import")({job:t})),this.lastImport.html(e)}this.lastImport.html("")},e.prototype.activeDryRun=function(){return this.ajax({id:"jobs_try_index",type:"GET",url:this.apiPath+"/integration/exchange/job_try",data:{finished:!1},processData:!0,success:(e=this,function(t){if(!_.isEmpty(t))return new n({container:e.el.closest(".content"),config:t.payload,start:"tryLoop",callback:function(t){return e.wizardButton.attr("disabled",!1),e.setConfig(t)}}),e.wizardButton.attr("disabled",!0)})});var e},e}(App.Controller),i=function(){function t(){}return t.current=function(){return App.Setting.get("exchange_integration")},t}(),n=function(t){function n(){var t;this.tryResult=s(this.tryResult,this),this.tryLoop=s(this.tryLoop,this),this.tryShow=s(this.tryShow,this),this.addUserMapping=s(this.addUserMapping,this),this.buildRowUserAttribute=s(this.buildRowUserAttribute,this),this.buildRowsUserMap=s(this.buildRowsUserMap,this),this.mappingChange=s(this.mappingChange,this),this.mappingShow=s(this.mappingShow,this),this.mapping=s(this.mapping,this),this.handleCertificateIssue=s(this.handleCertificateIssue,this),this.foldersShow=s(this.foldersShow,this),this.folders=s(this.folders,this),this.discover=s(this.discover,this),this.showSlideDiscover=s(this.showSlideDiscover,this),this.showBindDetails=s(this.showBindDetails,this),this.showDiscoverDetails=s(this.showDiscoverDetails,this),this.showSlide=s(this.showSlide,this),this.save=s(this.save,this),this.render=s(this.render,this),n.__super__.constructor.apply(this,arguments),_.isEmpty(this.config)||(this.wizardConfig=this.config),this.container&&this.el.addClass("modal--local"),this.render(),this.el.modal({keyboard:!0,show:!0,backdrop:!0,container:this.container}).on({"show.bs.modal":this.onShow,"shown.bs.modal":this.onShown,"hidden.bs.modal":(t=this,function(){return t.el.remove()})}),this.slide?this.showSlide(this.slide):this.showDiscoverDetails(),this.start&&this[this.start]()}return r(n,t),n.prototype.wizardConfig={},n.prototype.slideMethod={"js-folders":"foldersShow","js-mapping":"mappingShow"},n.prototype.events={"submit form.js-discover":"discover","submit form.js-discoverCertificateIssue":"discover","submit form.js-bind":"folders","submit form.js-bindCertificateIssue":"folders","submit form.js-folders":"mapping","click .js-cancelSsl":"showSlideDiscover","click .js-mapping .js-submitTry":"mappingChange","click .js-try .js-submitSave":"save","click .js-close":"hide","click .js-remove":"removeRow","click .js-userMappingForm .js-add":"addUserMapping","click .js-goToSlide":"goToSlide"},n.prototype.elements={".modal-body":"body",".js-foldersSelect":"foldersSelect",".js-folders .js-submitTry":"foldersSelectSubmit",".js-userMappingForm":"userMappingForm",".js-expertForm":"expertForm"},n.prototype.render=function(){return this.html(App.view("integration/exchange_wizard")())},n.prototype.save=function(t){return t.preventDefault(),this.callback(this.wizardConfig),this.hide(t)},n.prototype.showSlide=function(t){var e;return(e=this.slideMethod[t])&&this[e]&&this[e](!0),n.__super__.showSlide.apply(this,arguments)},n.prototype.showDiscoverDetails=function(){return this.$('.js-discover input[name="user"]').val(this.wizardConfig.user),this.$('.js-discover input[name="password"]').val(this.wizardConfig.password)},n.prototype.showBindDetails=function(){return this.$('.js-bind input[name="endpoint"]').val(this.wizardConfig.endpoint),this.$('.js-bind input[name="user"]').val(this.wizardConfig.user),this.$('.js-bind input[name="password"]').val(this.wizardConfig.password)},n.prototype.showSlideDiscover=function(){return this.showSlide("js-discover")},n.prototype.discover=function(t){var e,i,n;return t.preventDefault(),this.showSlide("js-connect"),e=this.formParam(t.target),this.ajax({id:"exchange_discover",type:"POST",url:this.apiPath+"/integration/exchange/autodiscover",data:JSON.stringify(e),processData:!0,success:(n=this,function(t){if("ok"===t.result)return n.wizardConfig.disable_ssl_verify=e.disable_ssl_verify,n.wizardConfig.user=e.user,n.wizardConfig.password=e.password,n.showSlide("js-bind"),n.showBindDetails();n.handleCertificateIssue({message:t.message,wizardClass:"js-discover",user:e.user,password:e.password})}),error:(i=this,function(t){var e,n;return n=t.responseText,e={},_.isEmpty(n)||(e=JSON.parse(n)),i.showSlide("js-discover"),i.showAlert("js-discover",e.error||"Unable to perform backend.")})})},n.prototype.folders=function(t){var e,i,n;return t.preventDefault(),this.showSlide("js-analyze"),e=this.formParam(t.target),this.ajax({id:"exchange_folders",type:"POST",url:this.apiPath+"/integration/exchange/folders",data:JSON.stringify(e),processData:!0,success:(n=this,function(t){if("ok"===t.result)return n.wizardConfig.disable_ssl_verify=e.disable_ssl_verify,n.wizardConfig.endpoint=e.endpoint,n.wizardConfig.user=e.user,n.wizardConfig.password=e.password,n.wizardConfig.wizardData={},n.wizardConfig.wizardData.backend_folders=t.folders,n.foldersShow();n.handleCertificateIssue({message:t.message,wizardClass:"js-bind",endpoint:e.endpoint,user:e.user,password:e.password})}),error:(i=this,function(t){var e,n;return n=t.responseText,e={},_.isEmpty(n)||(e=JSON.parse(n)),i.showSlide("js-bind"),i.showAlert("js-bind",e.error||"Unable to perform backend.")})})},n.prototype.foldersShow=function(t){return t||this.showSlide("js-folders"),this.foldersSelect.html(this.createColumnSelection("folders",this.wizardConfig.wizardData.backend_folders,this.wizardConfig.folders))},n.prototype.createColumnSelection=function(t,e,n){return App.UiElement.column_select.render({name:t,"null":!1,nulloption:!1,options:e,value:n,onChange:(i=this,function(t){return t&&0<t.length?i.foldersSelectSubmit.removeClass("is-disabled"):i.foldersSelectSubmit.addClass("is-disabled")})});var i},n.prototype.handleCertificateIssue=function(t){var e,n,i;return-1===t.message.indexOf("certificate")?(this.showSlide(t.wizardClass),this.showAlert(t.wizardClass,t.message)):(n=t.wizardClass+"CertificateIssue",e=this.domainFromMessageOrEmail({message:t.message,user:t.user}),i=App.view("integration/exchange_certificate_issue")({wizardClass:n,endpoint:t.endpoint,user:t.user,password:t.password,domain:e}),this.$(".js-certificateIssuePlaceholder").html(i),this.showSlide(n))},n.prototype.domainFromMessageOrEmail=function(t){var e,n;return(n=t.message.match(/hostname[ ]\"([^\"]+)"/i))?n[1]:(e=t.user.match(/@(.*)$/))?e[1]:user},n.prototype.mapping=function(t){var r,i,o;return t.preventDefault(),this.showSlide("js-analyze"),"string"==typeof(r=this.formParam(t.target)).folders&&(r.folders=[r.folders]),r.endpoint=this.wizardConfig.endpoint,r.user=this.wizardConfig.user,r.password=this.wizardConfig.password,this.ajax({id:"exchange_mapping",type:"POST",url:this.apiPath+"/integration/exchange/mapping",data:JSON.stringify(r),processData:!0,success:(o=this,function(t){var e,n,i,s;if("ok"!==t.result)return o.showSlide("js-folders"),void o.showAlert("js-folders",t.message);for(n in e={},i=App.User.attributesGet())s=i[n],"login"!==n&&("input"!==s.tag&&"richtext"!==s.tag&&"textarea"!==s.tag||"password"===s.type||(e[n]=s.display||n));return o.wizardConfig.wizardData.attributes=e,o.wizardConfig.folders=r.folders,o.wizardConfig.wizardData.backend_attributes=t.attributes,o.mappingShow()}),error:(i=this,function(t){var e,n;return n=t.responseText,e={},_.isEmpty(n)||(e=JSON.parse(n)),i.showSlide("js-folders"),i.showAlert("js-folders",e.error||"Unable to perform backend.")})})},n.prototype.mappingShow=function(t){var e;return t||this.showSlide("js-mapping"),e=this.wizardConfig.attributes,_.isEmpty(e)&&(e={given_name:"firstname",surname:"lastname","email_addresses.emailaddress1":"email","phone_numbers.businessphone":"phone"}),this.userMappingForm.find("tbody tr.js-entry").remove(),this.userMappingForm.find("tbody tr").before(this.buildRowsUserMap(e))},n.prototype.mappingChange=function(t){var e,n,i,s,r,o,a,l,c;for(t.preventDefault(),e=this.formParam(this.userMappingForm),s=0,a=(l=["source","dest"]).length;s<a;s++)o=l[s],_.isArray(e[o])||(e[o]=[e[o]]);for(n={},i=r=0,c=e.source.length-1;0<=c?r<=c:c<=r;i=0<=c?++r:--r)e.source[i]&&e.dest[i]&&(n[e.source[i]]=e.dest[i]);return this.wizardConfig.attributes=n,this.tryShow()},n.prototype.buildRowsUserMap=function(t){var e,n,i;for(i in n=[],t)e=t[i],i in this.wizardConfig.wizardData.backend_attributes&&n.push(this.buildRowUserAttribute(i,e));return n},n.prototype.buildRowUserAttribute=function(t,e){var n;return(n=$(App.view("integration/exchange_user_attribute_row")())).find(".js-exchangeAttribute").html(this.createSelection("source",this.wizardConfig.wizardData.backend_attributes,t)),n.find(".js-userAttribute").html(this.createSelection("dest",this.wizardConfig.wizardData.attributes,e)),n},n.prototype.createSelection=function(t,e,n,i){return App.UiElement.searchable_select.render({name:t,multiple:!1,limit:100,"null":!1,nulloption:!1,options:e,value:n,unknown:i,"class":"form-control--small"})},n.prototype.removeRow=function(t){return t.preventDefault(),$(t.target).closest("tr").remove()},n.prototype.addUserMapping=function(t){return t.preventDefault(),this.userMappingForm.find("tbody tr").last().before(this.buildRowUserAttribute())},n.prototype.tryShow=function(t){return t&&t.preventDefault(),this.showSlide("js-analyze"),this.ajax({id:"exchange_try",type:"POST",url:this.apiPath+"/integration/exchange/job_try",data:JSON.stringify(this.wizardConfig),processData:!0,success:(e=this,function(){return e.tryLoop()})});var e},n.prototype.tryLoop=function(){return this.showSlide("js-dry"),this.ajax({id:"jobs_try_index",type:"GET",url:this.apiPath+"/integration/exchange/job_try",data:{finished:!0},processData:!0,success:(e=this,function(t){return t.result&&(t.result.error||t.result.info)?(e.showSlide("js-error"),void e.showAlert("js-error",t.result.error||t.result.info)):(t.result&&0<_.keys(t.result).length&&(e.$(".js-preprogress").addClass("hide"),e.$(".js-analyzing").removeClass("hide"),e.$(".js-progress progress").attr("value",t.result.sum),e.$(".js-progress progress").attr("max",t.result.total)),t.finished_at?(e.$(".js-preprogress").removeClass("hide"),e.$(".js-analyzing").addClass("hide"),e.tryResult(t)):e.delay(e.tryLoop,4e3))})});var e},n.prototype.tryResult=function(t){var e;return this.showSlide("js-try"),e=$(App.view("integration/exchange_summary")({job:t})),this.el.find(".js-summary").html(e)},n}(App.WizardModal),App.Config.set("IntegrationExchange",{name:"Exchange",target:"#system/integration/exchange",description:"Exchange integration for contacts management.",controller:t,state:i,permission:["admin.integration.exchange"]},"NavBarIntegrations")}.call(this),function(){var t,e,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.featureIntegration="icinga_integration",e.prototype.featureName="Icinga",e.prototype.featureConfig="icinga_config",e.prototype.description=[["This service receives emails from %s and creates tickets with host and service.","Icinga"],["If the host and service is recovered again, the ticket will be closed automatically."]],e.prototype.render=function(){return e.__super__.render.apply(this,arguments),new App.SettingsForm({area:"Integration::Icinga",el:this.$(".js-form")})},e}(App.ControllerIntegrationBase),e=function(){function t(){}return t.current=function(){return App.Setting.get("icinga_integration")},t}(),App.Config.set("IntegrationIcinga",{name:"Icinga",target:"#system/integration/icinga",description:"An open source monitoring tool.",controller:t,state:e,permission:["admin.integration.icinga"]},"NavBarIntegrations")}.call(this),function(){var n,t,e,i=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function e(){return this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.featureIntegration="idoit_integration",e.prototype.featureName="i-doit",e.prototype.featureConfig="idoit_config",e.prototype.description=[["This service allows you to connect %s with %s.","i-doit","Zammad"]],e.prototype.events={"change .js-switch input":"switch"},e.prototype.render=function(){return e.__super__.render.apply(this,arguments),new n({el:this.$(".js-form")}),new App.HttpLog({el:this.$(".js-log"),facility:"idoit"})},e}(App.ControllerIntegrationBase),n=function(t){function e(){this.validateAndSave=i(this.validateAndSave,this),this.update=i(this.update,this),this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return s(e,t),e.prototype.events={"submit form":"update"},e.prototype.currentConfig=function(){return App.Setting.get("idoit_config")},e.prototype.setConfig=function(t){return App.Setting.set("idoit_config",t,{notify:!0})},e.prototype.render=function(){return this.config=this.currentConfig(),this.html(App.view("integration/idoit")({config:this.config}))},e.prototype.update=function(t){return t.preventDefault(),this.config=this.formParam(t.target),this.validateAndSave()},e.prototype.validateAndSave=function(){return this.ajax({id:"idoit",type:"POST",url:this.apiPath+"/integration/idoit/verify",data:JSON.stringify({method:"cmdb.object_types",api_token:this.config.api_token,endpoint:this.config.endpoint,client_id:this.config.client_id}),success:(e=this,function(t){if("failed"!==t.result)return e.setConfig(e.config);new App.ControllerErrorModal({message:t.message,container:e.el.closest(".content")})}),error:(i=this,function(t,e){var n;if("abort"!==e)return n=t.responseJSON||{},i.notify({type:"error",msg:App.i18n.translateContent(n.error_human||n.error||"Unable to save!")})})});var i,e},e}(App.Controller),e=function(){function t(){}return t.current=function(){return App.Setting.get("idoit_integration")},t}(),App.Config.set("IntegrationIdoit",{name:"i-doit",target:"#system/integration/idoit",description:"CMDB to document complex relations of your network components.",controller:t,state:e},"NavBarIntegrations")}.call(this),function(){var n,e,t,i,s=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=function(t){function n(){return this["switch"]=s(this["switch"],this),this.render=s(this.render,this),n.__super__.constructor.apply(this,arguments)}return r(n,t),n.prototype.featureIntegration="ldap_integration",n.prototype.featureName="LDAP",n.prototype.featureConfig="ldap_config",n.prototype.description=[["This service enables Zammad to connect with your LDAP server."]],n.prototype.events={"change .js-switch input":"switch"},n.prototype.render=function(){return n.__super__.render.apply(this,arguments),new e({el:this.$(".js-form")}),new App.HttpLog({el:this.$(".js-log"),facility:"ldap"})},n.prototype["switch"]=function(){var t,e;if(n.__super__["switch"].apply(this,arguments),this.$(".js-switch input").prop("checked"))return e=this,t=function(){return e.ajax({id:"jobs_config",type:"POST",url:e.apiPath+"/integration/ldap/job_start",processData:!0,success:function(){return e.render(!0)}})},App.Delay.set(t,600,"job_start")},n}(App.ControllerIntegrationBase),e=function(t){function e(){this.activeDryRun=s(this.activeDryRun,this),this.lastResultShow=s(this.lastResultShow,this),this.lastResult=s(this.lastResult,this),this.startWizard=s(this.startWizard,this),this.startSync=s(this.startSync,this),this.render=s(this.render,this),this.setConfig=s(this.setConfig,this),e.__super__.constructor.apply(this,arguments),this.render(),this.lastResult(),this.activeDryRun()}return r(e,t),e.prototype.elements={
".js-lastImport":"lastImport",".js-wizard":"wizardButton"},e.prototype.events={"click .js-wizard":"startWizard","click .js-start-sync":"startSync"},e.prototype.currentConfig=function(){return App.Setting.get("ldap_config")||{}},e.prototype.setConfig=function(t){return App.Setting.set("ldap_config",t,{notify:!0}),this.startSync()},e.prototype.render=function(t){var e,n,i,s,r,o;for(r in null==t&&(t=!1),this.config=this.currentConfig(),i={},s=this.config.group_role_map)n=s[r],i[r]=n.map(function(t){return App.Role.find(t).displayName()}).join(", ");if(this.html(App.view("integration/ldap")({config:this.config,group_role_map:i})),_.isEmpty(this.config)?(this.$(".js-notConfigured").removeClass("hide"),this.$(".js-summary").addClass("hide")):(this.$(".js-notConfigured").addClass("hide"),this.$(".js-summary").removeClass("hide")),t)return e=function(){return o.scrollToIfNeeded($(".content.active .page-header"))},(o=this).delay(e,500)},e.prototype.startSync=function(){return this.ajax({id:"jobs_config",type:"POST",url:this.apiPath+"/integration/ldap/job_start",processData:!0,success:(t=this,function(){return t.render(!0),t.lastResult()})});var t},e.prototype.startWizard=function(t){return t.preventDefault(),new n({container:this.el.closest(".content"),config:this.config,callback:(e=this,function(t){return e.setConfig(t)})});var e},e.prototype.lastResult=function(){return this.ajax({id:"jobs_start_index",type:"GET",url:this.apiPath+"/integration/ldap/job_start",processData:!0,success:(e=this,function(t){return _.isEmpty(t)||e.lastResultShowJob&&e.lastResultShowJob.updated_at===t.updated_at||(e.lastResultShowJob=t,e.lastResultShow(t),t.finished_at?e.wizardButton.attr("disabled",!1):e.wizardButton.attr("disabled",!0)),e.delay(e.lastResult,5e3)})});var e},e.prototype.lastResultShow=function(t){var e,n,i,s,r;if(!_.isEmpty(t)){for(s in t.result.roles||(t.result.roles={}),n=t.result.role_ids)r=n[s],i=App.Role.find(s),t.result.roles[i.displayName()]=r;return e=$(App.view("integration/ldap_last_import")({job:t})),this.lastImport.html(e)}this.lastImport.html("")},e.prototype.activeDryRun=function(){return this.ajax({id:"jobs_try_index",type:"GET",url:this.apiPath+"/integration/ldap/job_try",data:{finished:!1},processData:!0,success:(e=this,function(t){if(!_.isEmpty(t))return new n({container:e.el.closest(".content"),config:t.payload,start:"tryLoop",callback:function(t){return e.wizardButton.attr("disabled",!1),e.setConfig(t)}}),e.wizardButton.attr("disabled",!0)})});var e},e}(App.Controller),i=function(){function t(){}return t.current=function(){return App.Setting.get("ldap_integration")},t}(),n=function(t){function n(){var t;this.tryResult=s(this.tryResult,this),this.tryLoop=s(this.tryLoop,this),this.tryShow=s(this.tryShow,this),this.addGroupRoleMapping=s(this.addGroupRoleMapping,this),this.addUserMapping=s(this.addUserMapping,this),this.buildRowGroupRole=s(this.buildRowGroupRole,this),this.buildRowsGroupRole=s(this.buildRowsGroupRole,this),this.buildRowUserAttribute=s(this.buildRowUserAttribute,this),this.buildRowsUserMap=s(this.buildRowsUserMap,this),this.mappingChange=s(this.mappingChange,this),this.mappingShow=s(this.mappingShow,this),this.bindChange=s(this.bindChange,this),this.bindShow=s(this.bindShow,this),this.discover=s(this.discover,this),this.buildRowSslVerify=s(this.buildRowSslVerify,this),this.checkSslVerifyVisibility=s(this.checkSslVerifyVisibility,this),this.sslVerifyChange=s(this.sslVerifyChange,this),this.showHost=s(this.showHost,this),this.showSlide=s(this.showSlide,this),this.save=s(this.save,this),this.render=s(this.render,this),n.__super__.constructor.apply(this,arguments),_.isEmpty(this.config)||(this.wizardConfig=this.config),this.container&&this.el.addClass("modal--local"),this.render(),this.el.modal({keyboard:!0,show:!0,backdrop:!0,container:this.container}).on({"show.bs.modal":this.onShow,"shown.bs.modal":this.onShown,"hidden.bs.modal":(t=this,function(){return t.el.remove()})}),this.slide?this.showSlide(this.slide):this.showHost(),this.start&&this[this.start]()}return r(n,t),n.prototype.className="modal fade modal--large",n.prototype.wizardConfig={},n.prototype.slideMethod={"js-bind":"bindShow","js-mapping":"mappingShow"},n.prototype.events={"submit form.js-discover":"discover","submit form.js-bind":"bindChange","click .js-mapping .js-submitTry":"mappingChange","click .js-try .js-submitSave":"save","click .js-close":"hide","click .js-remove":"removeRow","click .js-userMappingForm .js-add":"addUserMapping","click .js-groupRoleForm .js-add":"addGroupRoleMapping","click .js-goToSlide":"goToSlide","input .js-hostUrl":"sslVerifyChange"},n.prototype.elements={".modal-body":"body",".js-userMappingForm":"userMappingForm",".js-groupRoleForm":"groupRoleForm",".js-expertForm":"expertForm"},n.prototype.render=function(){return this.html(App.view("integration/ldap_wizard")())},n.prototype.save=function(t){return t.preventDefault(),this.callback(this.wizardConfig),this.hide(t)},n.prototype.showSlide=function(t){var e;return(e=this.slideMethod[t])&&this[e]&&this[e](!0),n.__super__.showSlide.apply(this,arguments)},n.prototype.showHost=function(){return this.$('.js-discover input[name="host_url"]').val(this.wizardConfig.host_url),this.checkSslVerifyVisibility(this.wizardConfig.host_url)},n.prototype.sslVerifyChange=function(t){return this.checkSslVerifyVisibility($(t.currentTarget).val())},n.prototype.checkSslVerifyVisibility=function(t){var e,n,i;return i=(n=this.$(".js-discover .js-sslVerify")).length,e=!0,t&&t.startsWith("ldaps")&&(e=!1),i&&e?n.parent().remove():i||e?void 0:this.$(".js-discover tbody tr").last().after(this.buildRowSslVerify())},n.prototype.buildRowSslVerify=function(){var t,e,n;return t=$(App.view("integration/ldap_ssl_verify_row")()),n=!0,"undefined"!=typeof this.wizardConfig.ssl_verify&&(n=this.wizardConfig.ssl_verify),e=App.UiElement["boolean"].render({name:"ssl_verify","null":!1,options:{"true":"yes","false":"no"},"default":n,translate:!0,"class":"form-control form-control--small"}),t.find(".js-sslVerify").html(e),t},n.prototype.discover=function(t){var a,i,l;return t.preventDefault(),this.showSlide("js-connect"),a=this.formParam(t.target),this.ajax({id:"ldap_discover",type:"POST",url:this.apiPath+"/integration/ldap/discover",data:JSON.stringify(a),processData:!0,success:(l=this,function(t){var e,n,i,s,r,o;if("ok"!==t.result)return l.showSlide("js-discover"),void l.showAlert("js-discover",t.message);if(l.wizardConfig.host_url=a.host_url,l.wizardConfig.ssl_verify=a.ssl_verify,s="",r={},!_.isEmpty(t.attributes)&&!_.isEmpty(t.attributes.namingcontexts))for(n=0,i=(o=t.attributes.namingcontexts).length;n<i;n++)r[e=o[n]]=e,""===s&&(s=e),s.length>e.length&&(s=e);return l.wizardConfig.options=r,l.wizardConfig.option=s,l.bindShow()}),error:(i=this,function(t){var e,n;return n=t.responseText,e={},_.isEmpty(n)||(e=JSON.parse(n)),i.showSlide("js-discover"),i.showAlert("js-discover",e.error||"Unable to perform backend.")})})},n.prototype.bindShow=function(t){return t||this.showSlide("js-bind"),this.$(".js-bind .js-baseDn").html(this.createSelection("base_dn",this.wizardConfig.options,this.wizardConfig.base_dn||this.wizardConfig.option,!0)),this.$('.js-bind input[name="bind_user"]').val(this.wizardConfig.bind_user),this.$('.js-bind input[name="bind_pw"]').val(this.wizardConfig.bind_pw)},n.prototype.bindChange=function(t){var f,i,m;return t.preventDefault(),this.showSlide("js-analyze"),(f=this.formParam(t.target)).host_url=this.wizardConfig.host_url,f.ssl_verify=this.wizardConfig.ssl_verify,this.ajax({id:"ldap_bind",type:"POST",url:this.apiPath+"/integration/ldap/bind",data:JSON.stringify(f),processData:!0,success:(m=this,function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d;if("ok"!==t.result)return m.showSlide("js-bind"),void m.showAlert("js-bind",t.message);if(_.isEmpty(t.user_attributes))return m.showSlide("js-bind"),void m.showAlert("js-bind","Unable to retrive user information, please check your bind user permissions.");if(_.isEmpty(t.groups))return m.showSlide("js-bind"),void m.showAlert("js-bind","Unable to retrive group information, please check your bind user permissions.");for(s in f)d=f[s],m.wizardConfig[s]=d;for(s in h={},a=App.User.attributesGet())"input"!==(d=a[s]).tag&&"richtext"!==d.tag&&"textarea"!==d.tag||"password"===d.type||(h[s]=d.display||s);for(u={},n=0,r=(l=App.Role.findAllByAttribute("active",!0)).length;n<r;n++)u[(p=l[n]).id]=p.displayName();for(m.wizardConfig.wizardData={},m.wizardConfig.wizardData.backend_user_attributes=t.user_attributes,m.wizardConfig.wizardData.backend_groups=t.groups,m.wizardConfig.wizardData.user_attributes=h,m.wizardConfig.wizardData.roles=u,i=0,o=(c=["user_uid","user_filter","group_uid","group_filter"]).length;i<o;i++)s=c[i],null==(e=m.wizardConfig)[s]&&(e[s]=t[s]);return m.mappingShow()}),error:(i=this,function(t){var e,n;return n=t.responseText,e={},_.isEmpty(n)||(e=JSON.parse(n)),i.showSlide("js-bind"),i.showAlert("js-bind",e.error||"Unable to perform backend.")})})},n.prototype.mappingShow=function(t){var e,n;return t||this.showSlide("js-mapping"),n=this.wizardConfig.user_attributes,_.isEmpty(n)&&(n={givenname:"firstname",sn:"lastname",mail:"email",samaccountname:"login",telephonenumber:"phone"}),this.userMappingForm.find("tbody tr.js-entry").remove(),this.userMappingForm.find("tbody tr").before(this.buildRowsUserMap(n)),this.groupRoleForm.find("tbody tr.js-entry").remove(),this.groupRoleForm.find("tbody tr").before(this.buildRowsGroupRole(this.wizardConfig.group_role_map)),this.$('.js-mapping input[name="user_filter"]').val(this.wizardConfig.user_filter),e={sigup_roles:App.i18n.translatePlain("Assign signup roles"),skip_sync:App.i18n.translatePlain("Don't synchronize")},this.$(".js-unassignedUsers").html(this.createSelection("unassigned_users",e,this.wizardConfig.unassigned_users||"sigup_roles"))},n.prototype.mappingChange=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y;for(t.preventDefault(),v=this.formParam(this.userMappingForm),r=0,p=(h=["source","dest"]).length;r<p;r++)l=h[r],_.isArray(v[l])||(v[l]=[v[l]]);for(y={},e=o=0,d=v.source.length-1;0<=d?o<=d:d<=o;e=0<=d?++o:--o)v.source[e]&&v.dest[e]&&(y[v.source[e]]=v.dest[e]);if(g=Object.keys(y).some(function(t){return"login"===y[t]}),this.wizardConfig.user_attributes=y,!g)return this.showSlide("js-mapping"),void this.showAlert("js-mapping",App.i18n.translatePlain("Attribute '%s' is required in the mapping","login"));for(i=this.formParam(this.groupRoleForm),a=0,u=(f=["source","dest"]).length;a<u;a++)l=f[a],_.isArray(i[l])||(i[l]=[i[l]]);for(s={},e=c=0,m=i.source.length-1;0<=m?c<=m:m<=c;e=0<=m?++c:--c)i.source[e]&&i.dest[e]&&(_.isArray(s[i.source[e]])||(s[i.source[e]]=[]),s[i.source[e]].push(i.dest[e]));return this.wizardConfig.group_role_map=s,n=this.formParam(this.expertForm),this.wizardConfig.user_filter=n.user_filter,this.wizardConfig.unassigned_users=n.unassigned_users,this.tryShow()},n.prototype.buildRowsUserMap=function(t){var e,n,i;for(i in n=[],t)e=t[i],i in this.wizardConfig.wizardData.backend_user_attributes&&n.push(this.buildRowUserAttribute(i,e));return n},n.prototype.buildRowUserAttribute=function(t,e){var n;return(n=$(App.view("integration/ldap_user_attribute_row")())).find(".js-ldapAttribute").html(this.createSelection("source",this.wizardConfig.wizardData.backend_user_attributes,t)),n.find(".js-userAttribute").html(this.createSelection("dest",this.wizardConfig.wizardData.user_attributes,e)),n},n.prototype.buildRowsGroupRole=function(t){var e,n,i,s,r,o;for(o in i=[],t)for(s=0,r=(n=t[o]).length;s<r;s++)e=n[s],i.push(this.buildRowGroupRole(o,e));return i},n.prototype.buildRowGroupRole=function(t,e){var n;return(n=$(App.view("integration/ldap_group_role_row")())).find(".js-ldapList").html(this.createSelection("source",this.wizardConfig.wizardData.backend_groups,t)),n.find(".js-roleList").html(this.createSelection("dest",this.wizardConfig.wizardData.roles,e)),n},n.prototype.createSelection=function(t,e,n,i){return App.UiElement.searchable_select.render({name:t,multiple:!1,limit:100,"null":!1,nulloption:!1,options:e,value:n,unknown:i,"class":"form-control--small"})},n.prototype.removeRow=function(t){return t.preventDefault(),$(t.target).closest("tr").remove()},n.prototype.addUserMapping=function(t){return t.preventDefault(),this.userMappingForm.find("tbody tr").last().before(this.buildRowUserAttribute())},n.prototype.addGroupRoleMapping=function(t){return t.preventDefault(),this.groupRoleForm.find("tbody tr").last().before(this.buildRowGroupRole())},n.prototype.tryShow=function(t){return t&&t.preventDefault(),this.showSlide("js-analyze"),this.ajax({id:"ldap_try",type:"POST",url:this.apiPath+"/integration/ldap/job_try",data:JSON.stringify(this.wizardConfig),processData:!0,success:(e=this,function(){return e.tryLoop()})});var e},n.prototype.tryLoop=function(){return this.showSlide("js-dry"),this.ajax({id:"jobs_try_index",type:"GET",url:this.apiPath+"/integration/ldap/job_try",data:{finished:!0},processData:!0,success:(e=this,function(t){return t.result&&(t.result.error||t.result.info)?(e.showSlide("js-error"),void e.showAlert("js-error",t.result.error||t.result.info)):(t.result&&t.result.total&&(e.$(".js-preprogress").addClass("hide"),e.$(".js-analyzing").removeClass("hide"),e.$(".js-progress progress").attr("value",t.result.sum),e.$(".js-progress progress").attr("max",t.result.total)),t.finished_at?(e.$(".js-preprogress").removeClass("hide"),e.$(".js-analyzing").addClass("hide"),void e.tryResult(t)):void e.delay(e.tryLoop,4e3))})});var e},n.prototype.tryResult=function(t){var e,n,i,s,r;for(s in t.result.roles||(t.result.roles={}),n=t.result.role_ids)r=n[s],i=App.Role.find(s),t.result.roles[i.displayName()]=r;return this.showSlide("js-try"),e=$(App.view("integration/ldap_summary")({job:t})),this.el.find(".js-summary").html(e)},n}(App.WizardModal),App.Config.set("IntegrationLDAP",{name:"LDAP",target:"#system/integration/ldap",description:"LDAP integration for user management.",controller:t,state:i,permission:["admin.integration.ldap"]},"NavBarIntegrations")}.call(this),function(){var t,e,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.featureIntegration="monit_integration",e.prototype.featureName="Monit",e.prototype.featureConfig="monit_config",e.prototype.description=[["This service receives emails from %s and creates tickets with host and service.","Monit"],["If the host and service is recovered again, the ticket will be closed automatically."]],e.prototype.render=function(){return e.__super__.render.apply(this,arguments),new App.SettingsForm({area:"Integration::Monit",el:this.$(".js-form")})},e}(App.ControllerIntegrationBase),e=function(){function t(){}return t.current=function(){return App.Setting.get("monit_integration")},t}(),App.Config.set("IntegrationMonit",{name:"Monit",target:"#system/integration/monit",description:"An open source monitoring tool.",controller:t,state:e,permission:["admin.integration.monit"]},"NavBarIntegrations")}.call(this),function(){var t,e,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.featureIntegration="nagios_integration",e.prototype.featureName="Nagios",e.prototype.featureConfig="nagios_config",e.prototype.description=[["This service receives emails from %s and creates tickets with host and service.","Nagios"],["If the host and service is recovered again, the ticket will be closed automatically."]],e.prototype.render=function(){return e.__super__.render.apply(this,arguments),new App.SettingsForm({area:"Integration::Nagios",el:this.$(".js-form")})},e}(App.ControllerIntegrationBase),e=function(){function t(){}return t.current=function(){return App.Setting.get("nagios_integration")},t}(),App.Config.set("IntegrationNagios",{name:"Nagios",target:"#system/integration/nagios",description:"An open source monitoring tool.",controller:t,state:e},"NavBarIntegrations")}.call(this),function(){var n,t,e,i=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function e(){return this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.featureIntegration="placetel_integration",e.prototype.featureName="Placetel",e.prototype.featureConfig="placetel_config",e.prototype.description=[["This service shows you contacts of incoming calls and a caller list in realtime."],["Also caller id of outbound calls can be changed."]],e.prototype.events={"click .js-select":"selectAll","change .js-switch input":"switch"},e.prototype.render=function(){return e.__super__.render.apply(this,arguments),new n({el:this.$(".js-form")}),new App.HttpLog({el:this.$(".js-log"),facility:"placetel"})},e}(App.ControllerIntegrationBase),n=function(t){function e(){this.removeUserDeviceMap=i(this.removeUserDeviceMap,this),this.addUserDeviceMap=i(this.addUserDeviceMap,this),this.removeOutboundRouting=i(this.removeOutboundRouting,this),this.addOutboundRouting=i(this.addOutboundRouting,this),this.removeInboundBlockCallerId=i(this.removeInboundBlockCallerId,this),this.addInboundBlockCallerId=i(this.addInboundBlockCallerId,this),this.update=i(this.update,this),this.updateCurrentConfig=i(this.updateCurrentConfig,this),this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return s(e,t),e.prototype.events={"submit form":"update","click .js-inboundBlockCallerId .js-add":"addInboundBlockCallerId","click .js-inboundBlockCallerId .js-remove":"removeInboundBlockCallerId","click .js-outboundRouting .js-add":"addOutboundRouting","click .js-outboundRouting .js-remove":"removeOutboundRouting","click .js-userDeviceMap .js-add":"addUserDeviceMap","click .js-userDeviceMap .js-remove":"removeUserDeviceMap"},e.prototype.currentConfig=function(){var t;return(t=App.Setting.get("placetel_config")).outbound||(t.outbound={}),t.outbound.routing_table||(t.outbound.routing_table=[]),t.inbound||(t.inbound={}),t.inbound.block_caller_ids||(t.inbound.block_caller_ids=[]),t.user_device_map||(t.user_device_map=[]),t},e.prototype.setConfig=function(t){return App.Setting.set("placetel_config",t,{notify:!0})},e.prototype.render=function(){return this.config=this.currentConfig(),this.html(App.view("integration/placetel")({config:this.config,placetel_token:App.Setting.get("placetel_token")}))},e.prototype.updateCurrentConfig=function(){var i,s,t;return s=this.config,i=this.cleanupInput,s.api_token=i(this.$("input[name=api_token]").val()),t=this.$("input[name=default_caller_id]").val(),s.outbound.default_caller_id=i(t),s.outbound.routing_table=[],this.$(".js-outboundRouting .js-row").each(function(){var t,e,n;return e=i($(this).find('input[name="dest"]').val()),t=i($(this).find('input[name="caller_id"]').val()),n=$(this).find('input[name="note"]').val(),s.outbound.routing_table.push({dest:e,caller_id:t,note:n})}),s.inbound.block_caller_ids=[],this.$(".js-inboundBlockCallerId .js-row").each(function(){var t,e;return t=$(this).find('input[name="caller_id"]').val(),e=$(this).find('input[name="note"]').val(),s.inbound.block_caller_ids.push({caller_id:i(t),note:e})}),s.user_device_map=[],this.$(".js-userDeviceMap .js-row").each(function(){var t,e;return t=$(this).find('input[name="device_id"]').val(),e=$(this).find('input[name="user_id"]').val(),s.user_device_map.push({device_id:t,user_id:e})}),this.config=s},e.prototype.update=function(t){return t.preventDefault(),this.updateCurrentConfig(),this.setConfig(this.config)},e.prototype.cleanupInput=function(t){return t?t.replace(/\s/g,"").trim():t},e.prototype.addInboundBlockCallerId=function(t){var e,n,i;if(t.preventDefault(),this.updateCurrentConfig(),e=(n=$(t.currentTarget).closest("tr")).find('input[name="caller_id"]').val(),i=n.find('input[name="note"]').val(),!_.isEmpty(e)&&!_.isEmpty(i))return this.config.inbound.block_caller_ids.push({caller_id:this.cleanupInput(e),note:i}),this.render()},e.prototype.removeInboundBlockCallerId=function(t){return t.preventDefault(),this.updateCurrentConfig(),$(t.currentTarget).closest("tr").remove(),this.updateCurrentConfig()},e.prototype.addOutboundRouting=function(t){var e,n,i,s;if(t.preventDefault(),this.updateCurrentConfig(),i=$(t.currentTarget).closest("tr"),n=this.cleanupInput(i.find('input[name="dest"]').val()),e=this.cleanupInput(i.find('input[name="caller_id"]').val()),s=i.find('input[name="note"]').val(),!(_.isEmpty(e)||_.isEmpty(n)||_.isEmpty(s)))return this.config.outbound.routing_table.push({dest:n,caller_id:e,note:s}),this.render()},e.prototype.removeOutboundRouting=function(t){return t.preventDefault(),this.updateCurrentConfig(),$(t.currentTarget).closest("tr").remove(),this.updateCurrentConfig()},e.prototype.addUserDeviceMap=function(t){var e,n,i;if(t.preventDefault(),this.updateCurrentConfig(),n=$(t.currentTarget).closest("tr"),i=this.cleanupInput(n.find('input[name="user_id"]').val()),e=this.cleanupInput(n.find('input[name="device_id"]').val()),!_.isEmpty(i)&&!_.isEmpty(e))return this.config.user_device_map.push({user_id:i,device_id:e}),this.render()},e.prototype.removeUserDeviceMap=function(t){return t.preventDefault(),this.updateCurrentConfig(),$(t.currentTarget).closest("tr").remove(),this.updateCurrentConfig()},e}(App.Controller),e=function(){function t(){}return t.current=function(){return App.Setting.get("placetel_integration")},t}(),App.Config.set("IntegrationPlacetel",{name:"Placetel",target:"#system/integration/placetel",description:"VoIP service provider with realtime push.",controller:t,state:e},"NavBarIntegrations")}.call(this),function(){var n,t,e,i=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function e(){return this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.featureIntegration="sipgate_integration",e.prototype.featureName="sipgate.io",e.prototype.featureConfig="sipgate_config",e.prototype.description=[["This service shows you contacts of incoming calls and a caller list in realtime."],["Also caller id of outbound calls can be changed."]],e.prototype.events={"click .js-select":"selectAll","change .js-switch input":"switch"},e.prototype.render=function(){return e.__super__.render.apply(this,arguments),new n({el:this.$(".js-form")}),new App.HttpLog({el:this.$(".js-log"),facility:"sipgate.io"})},e}(App.ControllerIntegrationBase),n=function(t){function e(){this.removeUserRemoteMap=i(this.removeUserRemoteMap,this),this.addUserRemoteMap=i(this.addUserRemoteMap,this),this.removeOutboundRouting=i(this.removeOutboundRouting,this),this.removeInboundBlockCallerId=i(this.removeInboundBlockCallerId,this),this.addOutboundRouting=i(this.addOutboundRouting,this),this.addInboundBlockCallerId=i(this.addInboundBlockCallerId,this),this.update=i(this.update,this),this.updateCurrentConfig=i(this.updateCurrentConfig,this),this.render=i(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return s(e,t),e.prototype.events={"submit form":"update","click .js-inboundBlockCallerId .js-add":"addInboundBlockCallerId","click .js-outboundRouting .js-add":"addOutboundRouting","click .js-inboundBlockCallerId .js-remove":"removeInboundBlockCallerId","click .js-outboundRouting .js-remove":"removeOutboundRouting","click .js-userRemoteMap .js-add":"addUserRemoteMap","click .js-userRemoteMap .js-remove":"removeUserRemoteMap"},e.prototype.currentConfig=function(){var t;return(t=App.Setting.get("sipgate_config")).outbound||(t.outbound={}),t.outbound.routing_table||(t.outbound.routing_table=[]),t.inbound||(t.inbound={}),t.inbound.block_caller_ids||(t.inbound.block_caller_ids=[]),t.user_remote_map||(t.user_remote_map=[]),t},e.prototype.setConfig=function(t){return App.Setting.set("sipgate_config",t,{notify:!0})},e.prototype.render=function(){return this.config=this.currentConfig(),this.html(App.view("integration/sipgate")({config:this.config}))},e.prototype.updateCurrentConfig=function(){var i,s,t;return s=this.config,i=this.cleanupInput,s.api_user=i(this.$("input[name=api_user]").val()),s.api_password=i(this.$("input[name=api_password]").val()),t=this.$("input[name=default_caller_id]").val(),s.outbound.default_caller_id=i(t),s.outbound.routing_table=[],this.$(".js-outboundRouting .js-row").each(function(){var t,e,n;return e=i($(this).find('input[name="dest"]').val()),t=i($(this).find('input[name="caller_id"]').val()),n=$(this).find('input[name="note"]').val(),s.outbound.routing_table.push({dest:e,caller_id:t,note:n})}),s.inbound.block_caller_ids=[],this.$(".js-inboundBlockCallerId .js-row").each(function(){var t,e;return t=$(this).find('input[name="caller_id"]').val(),e=$(this).find('input[name="note"]').val(),s.inbound.block_caller_ids.push({caller_id:i(t),note:e})}),s.user_remote_map=[],this.$(".js-userRemoteMap .js-row").each(function(){var t,e;return t=$(this).find('input[name="remote_user_id"]').val(),e=$(this).find('input[name="user_id"]').val(),s.user_remote_map.push({remote_user_id:t,user_id:e})}),this.config=s},e.prototype.update=function(t){return t.preventDefault(),this.updateCurrentConfig(),this.setConfig(this.config)},e.prototype.cleanupInput=function(t){return t?t.replace(/\s/g,"").trim():t},e.prototype.addInboundBlockCallerId=function(t){var e,n,i;if(t.preventDefault(),this.updateCurrentConfig(),e=(n=$(t.currentTarget).closest("tr")).find('input[name="caller_id"]').val(),i=n.find('input[name="note"]').val(),!_.isEmpty(e)&&!_.isEmpty(i))return this.config.inbound.block_caller_ids.push({caller_id:this.cleanupInput(e),note:i}),this.render()},e.prototype.addOutboundRouting=function(t){var e,n,i,s;if(t.preventDefault(),this.updateCurrentConfig(),i=$(t.currentTarget).closest("tr"),n=this.cleanupInput(i.find('input[name="dest"]').val()),e=this.cleanupInput(i.find('input[name="caller_id"]').val()),s=i.find('input[name="note"]').val(),!(_.isEmpty(e)||_.isEmpty(n)||_.isEmpty(s)))return this.config.outbound.routing_table.push({dest:n,caller_id:e,note:s}),this.render()},e.prototype.removeInboundBlockCallerId=function(t){return t.preventDefault(),this.updateCurrentConfig(),$(t.currentTarget).closest("tr").remove(),this.updateCurrentConfig()},e.prototype.removeOutboundRouting=function(t){return t.preventDefault(),this.updateCurrentConfig(),$(t.currentTarget).closest("tr").remove(),this.updateCurrentConfig()},e.prototype.addUserRemoteMap=function(t){var e,n,i;if(t.preventDefault(),this.updateCurrentConfig(),e=$(t.currentTarget).closest("tr"),i=this.cleanupInput(e.find('input[name="user_id"]').val()),n=this.cleanupInput(e.find('input[name="remote_user_id"]').val()),!_.isEmpty(i)&&!_.isEmpty(n))return this.config.user_remote_map.push({user_id:i,remote_user_id:n}),this.render()},e.prototype.removeUserRemoteMap=function(t){return t.preventDefault(),this.updateCurrentConfig(),$(t.currentTarget).closest("tr").remove(),this.updateCurrentConfig()},e}(App.Controller),e=function(){function t(){}return t.current=function(){return App.Setting.get("sipgate_integration")},t}(),App.Config.set("IntegrationSipgate",{name:"sipgate.io",target:"#system/integration/sipgate",description:"VoIP service provider with realtime push.",controller:t,state:e},"NavBarIntegrations")}.call(this),function(){var t,e,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function d(){return this.update=n(this.update,this),this.render=n(this.render,this),d.__super__.constructor.apply(this,arguments)}return i(d,t),d.prototype.featureIntegration="slack_integration",d.prototype.featureName="Slack",d.prototype.featureConfig="slack_config",d.prototype.description=[["This service sends notifications to your %s channel.","Slack"],['To set up this service you need to create a new |"Incoming webhook"| in your %s integration panel, and enter the web hook URL below.',"Slack"]],d.prototype.events={"click .js-submit":"update","submit .js-form":"update","change .js-switch input":"switch"},d.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h;for(d.__super__.render.apply(this,arguments),(c=App.Setting.get(this.featureConfig))&&c.items&&(c=c.items[0]||{}),o=(t=[{name:"types",display:"Trigger",tag:"checkbox",options:{create:"1. Ticket Create",update:"2. Ticket Update",reminder_reached:"3. Ticket Reminder Reached",escalation:"4. Ticket Escalation",escalation_warning:"5. Ticket Escalation Warning"},"null":!(u=[]),"class":"vertical",note:"When notification is being sent."},{name:"group_ids",display:"Group",tag:"select",relation:"Group",multiple:!(i=0),"null":!1,note:"Only for these groups."},{name:"webhook",display:"Webhook",tag:"input",type:"url",limit:200,"null":!1,placeholder:"https://hooks.slack.com/services/..."},{name:"username",display:"Username",tag:"input",type:"text",limit:100,"null":!1,placeholder:"username"},{name:"channel",display:"Channel",tag:"input",type:"text",limit:100,"null":!0,placeholder:"#channel"},{name:"icon_url",display:"Icon Url",tag:"input",type:"url",limit:200,"null":!0,placeholder:"https://example.com/logo.png"}]).length;i<o;i++)p={options:{form:[s=t[i]]},name:s.name,description:s.note||"",title:s.display},u.push(p);for(n=$(App.view("settings/form")({settings:u})),r=0,a=u.length;r<a;r++)(e=(p=u[r]).options.form)[0].display="",h=c[p.name],(l={})[p.name]=h,new App.ControllerForm({el:n.find("[data-name="+p.name+"]"),model:{configure_attributes:e,className:""},params:l});return this.$(".js-form").html(n),new App.HttpLog({el:this.$(".js-log"),facility:"slack_webhook"})},d.prototype.update=function(t){var e;return t.preventDefault(),e={items:[this.formParam(t.target)]},App.Setting.set(this.featureConfig,e,{notify:!0})},d}(App.ControllerIntegrationBase),e=function(){function t(){}return t.current=function(){return App.Setting.get("slack_integration")},t}(),App.Config.set("IntegrationSlack",{name:"Slack",target:"#system/integration/slack",description:"A team communication tool for the 21st century.",controller:t,state:e},"NavBarIntegrations")}.call(this),function(){var n,i,s,t,r,o,e,a=function(t,e){return function(){return t.apply(e,arguments)}},l=function(t,e){function n(){this.constructor=t}for(var i in e)c.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;t=function(t){function e(){return this.render=a(this.render,this),e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.featureIntegration="smime_integration",e.prototype.featureName="S/MIME",e.prototype.featureConfig="smime_config",e.prototype.description=[["S/MIME (Secure/Multipurpose Internet Mail Extensions) is a widely accepted method (or more precisely, a protocol) for sending digitally signed and encrypted messages."]],e.prototype.events={"change .js-switch input":"switch"},e.prototype.render=function(){return e.__super__.render.apply(this,arguments),new i({el:this.$(".js-form")}),new App.HttpLog({el:this.$(".js-log"),facility:"S/MIME"})},e}(App.ControllerIntegrationBase),i=function(t){function e(){this.updateGroup=a(this.updateGroup,this),this.addPrivateKey=a(this.addPrivateKey,this),this.addCertificate=a(this.addCertificate,this),this.groupList=a(this.groupList,this),this.certList=a(this.certList,this),this.render=a(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return l(e,t),e.prototype.events={"click .js-addCertificate":"addCertificate","click .js-addPrivateKey":"addPrivateKey","click .js-updateGroup":"updateGroup"},e.prototype.currentConfig=function(){return App.Setting.get("smime_config")},e.prototype.setConfig=function(t){return App.Setting.set("smime_config",t,{notify:!0})},e.prototype.render=function(){return this.config=this.currentConfig(),this.html(App.view("integration/smime")({config:this.config})),
this.certList(),this.groupList()},e.prototype.certList=function(){return new r({el:this.$(".js-certList")})},e.prototype.groupList=function(){return new s({el:this.$(".js-groupList"),config:this.config})},e.prototype.addCertificate=function(){return new n({callback:this.certList})},e.prototype.addPrivateKey=function(){return new o({callback:this.certList})},e.prototype.updateGroup=function(t){var e;return e=App.ControllerForm.params(t),this.setConfig(e)},e}(App.Controller),n=function(t){function e(){return this.onSubmit=a(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="Add",e.prototype.autoFocusOnFirstInput=!1,e.prototype.head="Add Certificate",e.prototype.large=!0,e.prototype.content=function(){return $(App.view("integration/smime_certificate_add")({head:"Add Certificate"}))},e.prototype.onSubmit=function(t){var e,n,i;return(e=new FormData($(t.currentTarget).closest("form").get(0))).set("try",!0),_.isEmpty(e.get("data"))&&e["delete"]("data"),this.formDisable(t),this.ajax({id:"smime-certificate-add",type:"POST",url:this.apiPath+"/integration/smime/certificate",processData:!1,contentType:!1,cache:!1,data:e,success:(i=this,function(){return console.log("success"),i.close(),i.callback()}),error:(n=this,function(t){var e;return console.log("error"),n.close(),e=t.responseJSON||{},n.notify({type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to import!"),timeout:6e3})})})},e}(App.ControllerModal),o=function(t){function e(){return this.onSubmit=a(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="Add",e.prototype.autoFocusOnFirstInput=!1,e.prototype.head="Add Private Key",e.prototype.large=!0,e.prototype.content=function(){return $(App.view("integration/smime_private_key_add")({head:"Add Private Key"}))},e.prototype.onSubmit=function(t){var e,n,i;return(e=new FormData($(t.currentTarget).closest("form").get(0))).set("try",!0),_.isEmpty(e.get("data"))&&e["delete"]("data"),this.formDisable(t),this.ajax({id:"smime-private_key-add",type:"POST",url:this.apiPath+"/integration/smime/private_key",processData:!1,contentType:!1,cache:!1,data:e,success:(i=this,function(){return i.close(),i.callback()}),error:(n=this,function(t){var e;return n.close(),e=t.responseJSON||{},n.notify({type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to import!"),timeout:6e3})})})},e}(App.ControllerModal),r=function(t){function e(){this.remove=a(this.remove,this),this.render=a(this.render,this),this.load=a(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return l(e,t),e.prototype.events={"click .js-remove":"remove"},e.prototype.load=function(){return this.ajax({id:"smime-list",type:"GET",url:this.apiPath+"/integration/smime/certificate",success:(e=this,function(t){return e.render(t)}),error:(i=this,function(t,e){var n;if("abort"!==e)return n=t.responseJSON||{},i.notify({type:"error",msg:App.i18n.translateContent(n.error_human||n.error||"Unable to load list of certificates!")})})});var i,e},e.prototype.render=function(t){return this.html(App.view("integration/smime_list")({certs:t}))},e.prototype.remove=function(t){var e,i,n;if(t.preventDefault(),e=$(t.currentTarget).parents("tr").data("id"))return this.ajax({id:"smime-list",type:"DELETE",url:this.apiPath+"/integration/smime/certificate",data:JSON.stringify({id:e}),success:(n=this,function(){return n.load()}),error:(i=this,function(t,e){var n;if("abort"!==e)return n=t.responseJSON||{},i.notify({type:"error",msg:App.i18n.translateContent(n.error_human||n.error||"Unable to save!")})})})},e}(App.Controller),s=function(t){function e(){this.render=a(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return l(e,t),e.prototype.render=function(){var i,t,e,n,s,r,o,a,l;for(t=App.Group.search({sortBy:"name",filter:{active:!0}}),this.html(App.view("integration/smime_group")({groups:t})),s=[],e=0,n=t.length;e<n;e++)i=t[e],s.push(function(){var t,e,n;for(l in n=[],t={default_sign:"js-signDefault",default_encryption:"js-encryptionDefault"})a=t[l],r=!0,(null!=(e=this.config)?e.group_id:void 0)&&this.config.group_id[l]&&(r=this.config.group_id[l][i.id.toString()]),o=App.UiElement["boolean"].render({name:"group_id::"+l+"::"+i.id,multiple:!1,"null":!1,nulloption:!1,value:r,"class":"form-control--small"}),n.push(this.$("[data-id="+i.id+"] ."+a).html(o));return n}.call(this));return s},e}(App.Controller),e=function(){function t(){}return t.current=function(){return App.Setting.get("smime_integration")},t}(),App.Config.set("Integrationsmime",{name:"S/MIME",target:"#system/integration/smime",description:"S/MIME enables you to send digitally signed and encrypted messages.",controller:t,state:e},"NavBarIntegrations")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.title("Branding",!0),this.tabs=[{name:"Base",target:"base",controller:App.SettingsArea,params:{area:"System::Branding"}}],this.render()}return n(e,t),e.prototype.requiredPermission="admin.branding",e.prototype.header="Branding",e}(App.ControllerTabs),App.Config.set("SettingBranding",{prio:1200,parent:"#settings",name:"Branding",target:"#settings/branding",controller:t,permission:["admin.branding"]},"NavBarAdmin")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ManageKnowledgeBase=function(t){function e(){this.fetchAndRender=n(this.fetchAndRender,this),e.__super__.constructor.apply(this,arguments),this.render(),this.fetchAndRender()}return i(e,t),e.prototype.header="Knowledge Base",e.prototype.headerSwitchName="kb-activate",e.prototype.events={"hidden.bs.tab li":"didHideTab","show.bs.tab li":"willShowTab","change .js-header-switch input":"didChangeHeaderSwitch"},e.prototype.elements={".js-header-switch input":"headerSwitchInput"},e.prototype.didHideTab=function(t){var e;return e=$(t.relatedTarget).attr("href"),this.$(e).trigger("hidden.bs.tab")},e.prototype.willShowTab=function(t){var e;return e=$(t.target).attr("href"),this.$(e).trigger("show.bs.tab")},e.prototype.tabs=[],e.prototype.fetchAndRender=function(){return this.startLoading(),this.ajax({id:"knowledge_bases_init_admin",type:"GET",url:this.apiPath+"/knowledge_bases/manage/init",processData:!0,success:(n=this,function(t){var e;return App.Collection.loadAssets(t),n.knowledge_base_id=null!=(e=App.KnowledgeBase.first())?e.id:void 0,n.stopLoading(),n.processLoaded()}),error:(t=this,function(){return t.knowledge_base_id=void 0,t.stopLoading()})});var t,n},e.prototype.clear=function(){return App.KnowledgeBase.find(this.knowledge_base_id).remove({clear:!0}),this.fetchAndRender()},e.prototype.release=function(){var t;return e.__super__.release.apply(this,arguments),null!=(t=this.modal)?t.el.remove():void 0},e.prototype.processLoaded=function(){return this.knowledge_base_id?this.renderLoaded():this.renderNonExistant()},e.prototype.renderNonExistant=function(){return this.renderScreenError({detail:"No Knowledge Base. Please create first Knowledge Base",el:this.$(".page-content")}),this.headerSwitchInput.prop("checked",!1),this.modal=new App.KnowledgeBaseNewModal({parentVC:this,container:this.el.closest(".main")})},e.prototype.didChangeHeaderSwitch=function(){var t,e,n,i,s;return this.headerSwitchInput.prop("disabled",!0),t=(n=this.headerSwitchInput.prop("checked"))?"activate":"deactivate",e=App.KnowledgeBase.find(this.knowledge_base_id),this.ajax({id:"knowledge_bases_init_admin",type:"PATCH",url:e.manageUrl(t),processData:!0,success:(s=this,function(t){return App.Collection.loadAssets(t),s.processLoaded(),s.headerSwitchInput.prop("disabled",!1)}),error:(i=this,function(){return i.headerSwitchInput.prop("checked",!n),i.headerSwitchInput.prop("disabled",!1)})})},e.prototype.renderLoaded=function(){var t;return t={knowledge_base_id:this.knowledge_base_id,parentVC:this},this.tabs=[{name:"Theme",target:"style",controller:App.KnowledgeBaseForm,params:_.extend({},t,{screen:"style",split:!0})},{name:"Languages",target:"languages",controller:App.KnowledgeBaseForm,params:_.extend({},t,{screen:"languages"})},{name:"Public Menu",target:"public_menu",controller:App.KnowledgeBasePublicMenuManager,params:_.extend({},t,{screen:"public_menu"})},{name:"Delete",target:"delete",controller:App.KnowledgeBaseDelete,params:t}],App.Config.get("system_online_service")||this.tabs.splice(-1,0,{name:"Custom URL",target:"custom_address",controller:App.KnowledgeBaseCustomAddressForm,params:_.extend({},t,{screen:"custom_address"})}),this.render(),this.headerSwitchInput.prop("checked",App.KnowledgeBase.find(this.knowledge_base_id).active)},e}(App.ControllerTabs),App.Config.set("KnowledgeBase",{prio:1e4,name:"Knowledge Base",parent:"#manage",target:"#manage/knowledge_base",controller:App.ManageKnowledgeBase,permission:["admin.knowledge_base"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.title("Security",!0),this.tabs=[{name:"Base",target:"base",controller:App.SettingsArea,params:{area:"Security::Base"}},{name:"Password",target:"password",controller:App.SettingsArea,params:{area:"Security::Password"}},{name:"Third-party Applications",target:"third_party_auth",controller:App.SettingsArea,params:{area:"Security::ThirdPartyAuthentication"}}],this.render()}return n(e,t),e.prototype.requiredPermission="admin.security",e.prototype.header="Security",e}(App.ControllerTabs),App.Config.set("SettingSecurity",{prio:1600,parent:"#settings",name:"Security",target:"#settings/security",controller:t,permission:["admin.security"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.title("System",!0),this.tabs=[],App.Config.get("system_online_service")||this.tabs.push({name:"Base",target:"base",controller:App.SettingsArea,params:{area:"System::Base"}}),this.tabs.push({name:"Services",target:"services",controller:App.SettingsArea,params:{area:"System::Services"}}),App.Config.get("system_online_service")||this.tabs.push({name:"Storage",target:"storage",controller:App.SettingsArea,params:{area:"System::Storage"}}),App.Config.get("system_online_service")||this.tabs.push({name:"Network",target:"network",controller:App.SettingsArea,params:{area:"System::Network"}}),this.tabs.push({name:"Frontend",target:"ui",controller:App.SettingsArea,params:{area:"System::UI"}}),this.render()}return n(e,t),e.prototype.requiredPermission="admin.setting_system",e.prototype.header="System",e}(App.ControllerTabs),App.Config.set("SettingSystem",{prio:1400,parent:"#settings",name:"System",target:"#settings/system",controller:t,permission:["admin.setting_system"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.title("Ticket",!0),this.tabs=[{name:"Base",target:"base",controller:App.SettingsArea,params:{area:"Ticket::Base"}},{name:"Number",target:"number",controller:App.SettingsArea,params:{area:"Ticket::Number"}},{name:"Auto Assignment",target:"auto_assignment",controller:App.SettingTicketAutoAssignment}],this.render()}return n(e,t),e.prototype.requiredPermission="admin.ticket",e.prototype.header="Ticket",e}(App.ControllerTabs),App.Config.set("SettingTicket",{prio:1700,parent:"#settings",name:"Ticket",target:"#settings/ticket",controller:t,permission:["admin.ticket"]},"NavBarAdmin")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingTicketAutoAssignment=function(t){function e(){this.setTicketAutoAssignment=n(this.setTicketAutoAssignment,this),this.setFilter=n(this.setFilter,this),this.render=n(this.render,this),this.release=n(this.release,this),e.__super__.constructor.apply(this,arguments),this.subscribeId=App.Setting.subscribe(this.render,{initFetch:!0,clear:!1})}return i(e,t),e.prototype.requiredPermission="admin.ticket_auto_assignment",e.prototype.events={"change .js-ticketAutoAssignment input":"setTicketAutoAssignment","click .js-timeAccountingFilter":"setFilter","click .js-timeAccountingFilterReset":"resetFilter"},e.prototype.elements={".js-ticketAutoAssignment input":"ticketAutoAssignment"},e.prototype.release=function(){return App.Setting.unsubscribe(this.subscribeId)},e.prototype.render=function(){var t,e,n,i;return e=this.Config.get("ticket_auto_assignment")||!1,this.lastNewTagSetting=e,this.html(App.view("settings/ticket_auto_assignment")()),t=[{name:"condition",display:"Conditions for effected objects",tag:"ticket_selector","null":!1,preview:!1,action:!1,hasChanged:!1}],n=App.Setting.get("ticket_auto_assignment_selector"),this.filter=new App.ControllerForm({el:this.$(".js-selector"),model:{configure_attributes:t},params:{condition:n.condition},autofocus:!0}),t=[{name:"user_ids",display:"Exception users",tag:"column_select",multiple:!0,"null":!0,relation:"User",sortBy:"firstname"}],i=App.Setting.get("ticket_auto_assignment_user_ids_ignore"),this.filter=new App.ControllerForm({el:this.$(".js-users"),model:{configure_attributes:t},params:{user_ids:i},autofocus:!1})},e.prototype.setFilter=function(t){var e;return t.preventDefault(),e=this.formParam(this.filter.form),App.Setting.set("ticket_auto_assignment_selector",{condition:e.condition},{notify:!0}),App.Setting.set("ticket_auto_assignment_user_ids_ignore",e.user_ids,{notify:!1})},e.prototype.resetFilter=function(t){return t.preventDefault(),App.Setting.set("ticket_auto_assignment_selector",{},{notify:!0}),App.Setting.set("ticket_auto_assignment_user_ids_ignore",[],{notify:!1})},e.prototype.setTicketAutoAssignment=function(){var t;return t=this.ticketAutoAssignment.prop("checked"),App.Setting.set("ticket_auto_assignment",t)},e}(App.ControllerSubContent)}.call(this),function(){var n,s,t,i=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=function(t){function e(){this.onUpload=i(this.onUpload,this),this.storeImage=i(this.storeImage,this),this.openCamera=i(this.openCamera,this),this.pick=i(this.pick,this),this.onDelete=i(this.onDelete,this),this.onSelect=i(this.onSelect,this),this.render=i(this.render,this),this.loadAvatarList=i(this.loadAvatarList,this),e.__super__.constructor.apply(this,arguments),this.avatars=[],this.loadAvatarList()}return r(e,t),e.prototype.requiredPermission="user_preferences.avatar",e.prototype.header="Avatar",e.prototype.elements={".js-upload":"fileInput",".avatar-gallery":"avatarGallery"},e.prototype.events={"click .js-openCamera":"openCamera","change .js-upload":"onUpload","click .avatar":"onSelect","click .avatar-delete":"onDelete"},e.prototype.loadAvatarList=function(){return this.ajax({id:"avatar_list",type:"GET",url:this.apiPath+"/users/avatar",processData:!0,success:(e=this,function(t){return e.avatars=t.avatars,e.render()})});var e},e.prototype.hasGetUserMedia=function(){return!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)},e.prototype.render=function(){return this.html(App.view("profile/avatar")({webcamSupport:this.hasGetUserMedia(),avatars:this.avatars})),this.$('.avatar[data-id="'+this.Session.get("id")+'"]').attr("data-id","").attr("data-avatar-id","0")},e.prototype.onSelect=function(t){return this.pick($(t.currentTarget))},e.prototype.onDelete=function(t){var e;if(t.stopPropagation(),confirm(App.i18n.translateInline("Delete Avatar?")))return e={id:$(t.currentTarget).parent(".avatar-holder").find(".avatar").data("avatar-id")},$(t.currentTarget).parent(".avatar-holder").remove(),this.pick(this.$(".avatar").last()),this.ajax({id:"avatar_delete",type:"DELETE",url:this.apiPath+"/users/avatar",data:JSON.stringify(e),processData:!0})},e.prototype.pick=function(t){var e,i;return this.$(".avatar").removeClass("is-active"),t.addClass("is-active"),e={id:t.data("avatar-id")},this.ajax({id:"avatar_set_default",type:"POST",url:this.apiPath+"/users/avatar/set",data:JSON.stringify(e),processData:!0,success:(i=this,function(){var t,e,n;return n=(t=i.$(".avatar.is-active")).attr("style"),t.text()?n+=";background-size:auto":n+=";background-size:cover",(e=$('.avatar[data-id="'+i.Session.get("id")+'"]')).attr("style",n),t.text()?(e.text(t.text()),e.addClass("avatar--unique")):(e.text(""),e.removeClass("avatar--unique"))})}),t},e.prototype.openCamera=function(){return new n({callback:this.storeImage})},e.prototype.storeImage=function(n,t){var e,i;return this.oldDataUrl=n,i=this,e=function(t){return i.ajax({id:"avatar_new",type:"POST",url:i.apiPath+"/users/avatar",data:JSON.stringify({avatar_full:i.oldDataUrl,avatar_resize:t}),processData:!0,success:function(t){var e;return e=$(App.view("profile/avatar-holder")({src:n,avatar:t.avatar})),i.avatarGallery.append(e),i.pick(e.find(".avatar"))}})},App.ImageService.resizeForAvatar(n,"auto",160,t,e)},e.prototype.onUpload=function(t){var n,i;return i=t.target.files[0],n=this.storeImage,EXIF.getData(i,function(){var e,t;return e=this.exifdata.Orientation,(t=new FileReader).onload=function(t){return new s({imageSource:t.target.result,type:i.type,callback:n,orientation:e})},t.readAsDataURL(this)})},e}(App.ControllerSubContent),App.Config.set("Avatar",{prio:1100,name:"Avatar",parent:"#profile",target:"#profile/avatar",controller:t,permission:["user_preferences.avatar"]},"NavBarProfile"),s=function(t){function e(){return this.onSubmit=i(this.onSubmit,this),this.initializeCropper=i(this.initializeCropper,this),this.onShown=i(this.onShown,this),this.orientateImage=i(this.orientateImage,this),this.post=i(this.post,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="Save",e.prototype.head="Crop Image",e.prototype.elements={".imageCropper-image":"image",".imageCropper-holder":"holder"},e.prototype.content=function(){return App.view("profile/imageCropper")()},e.prototype.post=function(){var t,e,n;return this.size=256,t={1:0,3:180,6:90,8:-90},this.angle=t[this.orientation],void 0===this.angle&&(this.angle=0),n=this,e=function(t){var e;return 0!==n.angle?(n.isOrientating=!0,(e=new Image).addEventListener("load",n.orientateImage),e.src=t):n.image.attr({src:t})},App.ImageService.resize(this.imageSource,600,"auto",2,this.type,.9,e)},e.prototype.orientateImage=function(t){var e,n,i;if(i=t.currentTarget,n=(e=document.createElement("canvas")).getContext("2d"),180===this.angle?(e.width=i.width,e.height=i.height):(e.width=i.height,e.height=i.width),n.translate(e.width/2,e.height/2),n.rotate(this.angle*Math.PI/180),n.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),this.image.attr({src:e.toDataURL()}),this.isOrientating=!1,this.isShown)return this.initializeCropper()},e.prototype.onShown=function(){if(this.isShown=!0,!this.isOrientating)return this.initializeCropper()},e.prototype.initializeCropper=function(){return this.image.cropper({aspectRatio:1,guides:!1,autoCrop:!0,autoCropArea:1,minContainerWidth:500,minContainerHeight:300,preview:".imageCropper-preview"})},e.prototype.onSubmit=function(t){return this.formDisable(t),this.callback(this.image.cropper("getCroppedCanvas").toDataURL(),this.type),this.image.cropper("destroy"),this.close()},e}(App.ControllerModal),n=function(t){function e(){return this.stopStream=i(this.stopStream,this),this.onSubmit=i(this.onSubmit,this),this.onClose=i(this.onClose,this),this.updatePreview=i(this.updatePreview,this),this.setupPreview=i(this.setupPreview,this),this.onWebcamError=i(this.onWebcamError,this),this.onWebcamReady=i(this.onWebcamReady,this),this.shoot=i(this.shoot,this),this.onShootClick=i(this.onShootClick,this),this.post=i(this.post,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="Save",e.prototype.buttonClass="btn--success is-disabled",e.prototype.centerButtons=[{className:"btn--success js-shoot is-disabled",text:"Shoot"}],e.prototype.head="Camera",e.prototype.elements={".js-shoot":"shootButton",".js-submit":"submitButton",".camera-preview":"preview",".camera":"camera",video:"video"},e.prototype.events={"click .js-shoot:not(.is-disabled)":"onShootClick"},e.prototype.content=function(){return App.view("profile/camera")()},e.prototype.post=function(){return this.size=256,this.photoTaken=!1,this.backgroundColor="white",this.ctx=this.preview.get(0).getContext("2d"),Modernizr.prefixed("getUserMedia",navigator)({video:!0},this.onWebcamReady,this.onWebcamError),this.initializeCache()},e.prototype.onShootClick=function(){return this.photoTaken?(this.photoTaken=!1,this.submitButton.addClass("is-disabled"),this.shootButton.removeClass("btn--danger").addClass("btn--success").text(App.i18n.translateInline("Shoot")),this.updatePreview()):(this.shoot(),this.shootButton.removeClass("btn--success").addClass("btn--danger").text(App.i18n.translateInline("Discard")))},e.prototype.shoot=function(){return this.photoTaken=!0,this.submitButton.removeClass("is-disabled")},e.prototype.onWebcamReady=function(t){if(this.shootButton.removeClass("is-disabled"),!this.hidden){this.stream=t,this.video.on("canplay",this.setupPreview),this.video.on("playing",this.updatePreview);try{this.video.get(0).srcObject=t}catch(e){e,this.video.attr("src",window.URL.createObjectURL(t))}return this.video.get(0).play()}this.stopStream()},e.prototype.onWebcamError=function(t){var e;if(!this.hidden)return e={PermissionDeniedError:App.i18n.translateInline("You have to allow access to your webcam."),ConstraintNotSatisfiedError:App.i18n.translateInline("No camera found.")},alert(e[t.name]),this.close()},e.prototype.setupPreview=function(){return this.video.attr("height",this.size),this.preview.attr({width:this.size,height:this.size}),this.centerX=this.size/2,this.centerY=this.size/2,this.ctx.translate(this.centerX,this.centerY),this.ctx.scale(-1,1),this.ctx.strokeStyle=this.backgroundColor,this.ctx.lineWidth=2},e.prototype.updatePreview=function(){var t;try{return this.ctx.globalCompositeOperation="source-over",this.ctx.clearRect(0,0,this.size,this.size),this.ctx.beginPath(),this.ctx.arc(0,0,this.size/2,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.fill(),this.ctx.globalCompositeOperation="source-atop",this.ctx.drawImage(this.video.get(0),-this.video.width()/2,-this.size/2,this.video.width(),this.size),this.ctx.beginPath(),this.ctx.arc(0,0,this.size/2,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.stroke(),this.photoTaken?this.cacheScreenshot():requestAnimationFrame(this.updatePreview)}catch(e){if("NS_ERROR_NOT_AVAILABLE"===(t=e).name)return setTimeout(this.updatePreview,200);throw t}},e.prototype.initializeCache=function(){return this.cache=$("<canvas>"),this.cacheCtx=this.cache.get(0).getContext("2d")},e.prototype.cacheScreenshot=function(){var t;return this.video.attr({height:""}),t=Math.min(this.video.height(),this.video.width()),this.cache.attr({width:t,height:t}),this.cacheCtx.save(),this.cacheCtx.translate(t/2,t/2),this.cacheCtx.scale(-1,1),this.cacheCtx.drawImage(this.video.get(0),-this.video.width()/2,-this.video.height()/2,this.video.width(),this.video.height()),this.cacheCtx.restore(),this.video.attr({height:this.size})},e.prototype.onClose=function(){return this.stopStream(),this.hidden=!0},e.prototype.onSubmit=function(t){return this.formDisable(t),window.file=this.cache.get(0).toDataURL(),this.callback(this.cache.get(0).toDataURL()),this.close()},e.prototype.stopStream=function(){if(this.stream)return this.stream.getTracks&&this.stream.getTracks().forEach(function(t){return t.stop()}),this.stream.stop?this.stream.stop():void 0},e}(App.ControllerModal)}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.error=n(this.error,this),this.success=n(this.success,this),this.onOptionsChange=n(this.onOptionsChange,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.translationTable={new_open:App.i18n.translatePlain("new & open"),pending:App.i18n.translatePlain("pending"),escalation:App.i18n.translatePlain("escalation")},this.render()}return i(e,t),e.prototype.requiredPermission="user_preferences.calendar+ticket.agent",e.prototype.header="Calendar",e.prototype.elements={"input[type=checkbox]":"options",output:"output"},e.prototype.events={"change input[type=checkbox]":"onOptionsChange","click .js-select":"selectAll","click .js-showLink":"showLink"},e.prototype.render=function(){var t;return t=this.Session.get("preferences"),this.preferences=App.Config.get("defaults_calendar_subscriptions_tickets"),t.calendar_subscriptions&&t.calendar_subscriptions.tickets&&_.extend(this.preferences,t.calendar_subscriptions.tickets),this.html(App.view("profile/calendar_subscriptions")({baseurl:window.location.origin,preferences:this.preferences,translationTable:this.translationTable}))},e.prototype.showLink=function(t){return $(t.currentTarget).next().removeClass("is-hidden"),$(t.currentTarget).remove()},e.prototype.onOptionsChange=function(){var t,e,n,i,s,r;for(e in this.setAllPreferencesToFalse(),i=this.options.serializeArray())r=(s=(t=i[e]).name.split("/"))[0],n=s[1],r&&n?this.preferences[r][n]=!0:this.preferences[t.name]=!0;return this.store()},e.prototype.setAllPreferencesToFalse=function(){var t,e;for(e in this.preferences.alarm=!1,t=[],this.preferences)_.isObject(this.preferences)?(this.preferences[e].own=!1,t.push(this.preferences[e].not_assigned=!1)):t.push(void 0);return t},e.prototype.store=function(){var t;return t={calendar_subscriptions:{tickets:this.preferences}},this.ajax({id:"preferences",type:"PUT",url:this.apiPath+"/users/preferences",data:JSON.stringify(t),success:this.success,error:this.error})},e.prototype.success=function(){return App.User.full(App.Session.get("id"),(t=this,function(){return t.notify({type:"success",msg:App.i18n.translateContent("Successful!")})}),!0);var t},e.prototype.error=function(t){var e;return this.render(),e=JSON.parse(t.responseText),this.notify({type:"error",msg:App.i18n.translateContent(e.message)})},e}(App.ControllerSubContent),App.Config.set("CalendarSubscriptions",{prio:3e3,name:"Calendar",parent:"#profile",target:"#profile/calendar_subscriptions",permission:["user_preferences.calendar+ticket.agent"],controller:t},"NavBarProfile")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){var t;this.error=n(this.error,this),this["delete"]=n(this["delete"],this),this.render=n(this.render,this),this.load=n(this.load,this),e.__super__.constructor.apply(this,arguments),this.load(),this.interval((t=this,function(){return t.load()}),62e3)}return i(e,t),e.prototype.requiredPermission="user_preferences.device",e.prototype.header="Devices",e.prototype.events={"click [data-type=delete]":"delete"},e.prototype.load=function(e){return null==e&&(e=!1),this.ajax({id:"user_devices",type:"GET",url:this.apiPath+"/user_devices",success:(n=this,function(t){if(e||!n.lastestUpdated||!t||!t[0]||n.lastestUpdated.updated_at!==t[0].updated_at)return n.lastestUpdated=t[0],n.data=t,n.render()})});var n},e.prototype.render=function(){return this.html(App.view("profile/devices")({devices:this.data||[]}))},e.prototype["delete"]=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest("div").data("device-id"),this.ajax({id:"user_devices_delete",type:"DELETE",url:this.apiPath+"/user_devices/"+e,processData:!0,success:(n=this,function(){return n.load(!0)}),error:this.error})},e.prototype.error=function(t){var e;return e=JSON.parse(t.responseText),this.notify({type:"error",msg:App.i18n.translateContent(e.message)})},e}(App.ControllerSubContent),App.Config.set("Devices",{prio:3100,name:"Devices",parent:"#profile",target:"#profile/devices",controller:t,permission:["user_preferences.device"]},"NavBarProfile")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.error=n(this.error,this),this.success=n(this.success,this),this.update=n(this.update,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.requiredPermission="user_preferences.language",e.prototype.header="Language",e.prototype.events={"submit form":"update"},e.prototype.render=function(){var t,e,n,i,s,r,o;for(e=$(App.view("profile/language")()),o={},n=0,i=(r=App.Locale.all()).length;n<i;n++)o[(s=r[n]).locale]=s.name;return t=[{name:"locale",display:"",tag:"searchable_select","null":!1,"class":"input",options:o,"default":App.i18n.get()}],this.form=new App.ControllerForm({el:e.find(".language_item"),model:{configure_attributes:t},autofocus:!1}),this.html(e)},e.prototype.update=function(t){var e,n;return t.preventDefault(),n=this.formParam(t.target),(e=this.form.validate(n))?(this.formValidate({form:t.target,errors:e}),!1):(this.formDisable(t),this.locale=n.locale,this.ajax({id:"preferences",type:"PUT",url:this.apiPath+"/users/preferences",data:JSON.stringify(n),processData:!0,success:this.success,error:this.error}))},e.prototype.success=function(){return App.User.full(App.Session.get("id"),(t=this,function(){return App.i18n.set(t.locale),App.Event.trigger("ui:rerender"),t.notify({type:"success",msg:App.i18n.translateContent("Successful!")})}),!0);var t},e.prototype.error=function(t){var e;return this.render(),e=JSON.parse(t.responseText),this.notify({type:"error",msg:App.i18n.translateContent(e.message)})},e}(App.ControllerSubContent),App.Config.set("Language",{prio:1e3,name:"Language",parent:"#profile",target:"#profile/language",controller:t,permission:["user_preferences.language"]},"NavBarProfile")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.error=n(this.error,this),this.success=n(this.success,this),this.remove=n(this.remove,this),this.add=n(this.add,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.requiredPermission="user_preferences.linked_accounts",e.prototype.header="Linked Accounts",e.prototype.events={"click .js-add":"add","click .js-remove":"remove"},e.prototype.render=function(){var t,e,n,i;for(n in e={},t=App.Config.get("auth_provider_all"))i=t[n],!0!==this.Config.get(i.config)&&"true"!==this.Config.get(i.config)||(e[n]=i);return this.html(App.view("profile/linked_accounts")({user:App.Session.get(),auth_providers:e}))},e.prototype.add=function(t){var e;return t.preventDefault(),e=$(t.target).data("key"),this.el.find(".js-addForm-"+e).submit()},e.prototype.remove=function(t){var e,n;return t.preventDefault(),e=$(t.target).data("provider"),n=$(t.target).data(
"uid"),this.ajax({id:"account",type:"DELETE",url:this.apiPath+"/users/account",data:JSON.stringify({provider:e,uid:n}),processData:!0,success:this.success,error:this.error})},e.prototype.success=function(){var t,e;return this.notify({type:"success",msg:App.i18n.translateContent("Successful!")}),e=this,t=function(){return e.render()},App.User.full(this.Session.get("id"),t,!0)},e.prototype.error=function(t){var e;return this.render(),e=JSON.parse(t.responseText),this.notify({type:"error",msg:App.i18n.translateContent(e.message)})},e}(App.ControllerSubContent),App.Config.set("LinkedAccounts",{prio:4e3,name:"Linked Accounts",parent:"#profile",target:"#profile/linked",controller:t,permission:["user_preferences.linked_accounts"]},"NavBarProfile"),App.Config.set("auth_provider_all",{facebook:{url:"/auth/facebook",name:"Facebook",config:"auth_facebook","class":"facebook"},twitter:{url:"/auth/twitter",name:"Twitter",config:"auth_twitter","class":"twitter"},linkedin:{url:"/auth/linkedin",name:"LinkedIn",config:"auth_linkedin","class":"linkedin"},github:{url:"/auth/github",name:"GitHub",config:"auth_github","class":"github"},gitlab:{url:"/auth/gitlab",name:"GitLab",config:"auth_gitlab","class":"gitlab"},microsoft_office365:{url:"/auth/microsoft_office365",name:"Office 365",config:"auth_microsoft_office365","class":"office365"},google_oauth2:{url:"/auth/google_oauth2",name:"Google",config:"auth_google_oauth2","class":"google"},oauth2:{url:"/auth/oauth2",name:"OAuth2",config:"auth_oauth2","class":"oauth2"},weibo:{url:"/auth/weibo",name:"Weibo",config:"auth_weibo","class":"weibo"},saml:{url:"/auth/saml",name:"CSI",config:"auth_advanced_saml","class":"csi"}})}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.previewSound=n(this.previewSound,this),this.error=n(this.error,this),this.success=n(this.success,this),this.update=n(this.update,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.requiredPermission="user_preferences.notifications+ticket.agent",e.prototype.header="Notifications",e.prototype.events={"submit form":"update","change .js-notificationSound":"previewSound"},e.prototype.sounds=[{name:"Bell",file:"Bell.mp3"},{name:"Kalimba",file:"Kalimba.mp3"},{name:"Marimba",file:"Marimba.mp3"},{name:"Peep",file:"Peep.mp3"},{name:"Plop",file:"Plop.mp3"},{name:"Ring",file:"Ring.mp3"},{name:"Space",file:"Space.mp3"},{name:"Wood",file:"Wood.mp3"},{name:"Xylo",file:"Xylo.mp3"}],e.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d;if(t={group_ids:[],matrix:{create:{name:"New Ticket"},update:{name:"Ticket update"},reminder_reached:{name:"Ticket reminder reached"},escalation:{name:"Ticket escalation"}}},(h=this.Session.get("preferences").notification_config)&&(t=$.extend(!0,{},t,h)),d=!0,h&&h.group_ids&&!_.isEmpty(h.group_ids)&&"-"!==h.group_ids[0]||(d=!1),s=[],i=App.User.find(this.Session.get("id")).allGroupIds())for(r=0,a=i.length;r<a;r++)n=i[r],e=App.Group.find(n),s.push(e),d||(t.group_ids||(t.group_ids=[]),t.group_ids.push(n.toString()));for(o=0,l=(c=this.sounds).length;o<l;o++)(u=c[o]).selected=null!=(p=u.file===App.OnlineNotification.soundFile())?p:{"true":!1};return this.html(App.view("profile/notification")({groups:s,config:t,sounds:this.sounds,notificationSoundEnabled:App.OnlineNotification.soundEnabled()}))},e.prototype.update=function(t){var e,n,i,s,r,o;for(i in t.preventDefault(),s={notification_config:{}},n=this.formParam(t.target))o=n[i],"group_ids"===i?("object"!=typeof o&&(o=[o]),s.notification_config[i]=o):("true"===o&&(o=!0),"matrix"===(e=i.split("."))[0]&&("criteria"===e[2]&&(s.notification_config[e[0]]||(s.notification_config[e[0]]={}),s.notification_config[e[0]][e[1]]||(s.notification_config[e[0]][e[1]]={}),s.notification_config[e[0]][e[1]][e[2]]||(s.notification_config[e[0]][e[1]][e[2]]={owned_by_me:!1,owned_by_nobody:!1,no:!1}),s.notification_config[e[0]][e[1]][e[2]][e[3]]=o),"channel"===e[2]&&(s.notification_config[e[0]]||(s.notification_config[e[0]]={}),s.notification_config[e[0]][e[1]]||(s.notification_config[e[0]][e[1]]={}),"email"===o&&(s.notification_config[e[0]][e[1]][e[2]]={email:!0,online:!0}))));if(s.notification_config)for(i in r=s.notification_config.matrix)(o=r[i]).channel||(o.channel={email:!1,online:!0});return s.notification_config.group_ids&&!_.isEmpty(s.notification_config.group_ids)||(s.notification_config.group_ids=["-"]),this.formDisable(t),s.notification_sound=n.notification_sound,s.notification_sound.enabled?s.notification_sound.enabled=!0:s.notification_sound.enabled=!1,this.ajax({id:"preferences",type:"PUT",url:this.apiPath+"/users/preferences",data:JSON.stringify(s),processData:!0,success:this.success,error:this.error})},e.prototype.success=function(){return App.User.full(App.Session.get("id"),(t=this,function(){return App.Event.trigger("ui:rerender"),t.notify({type:"success",msg:App.i18n.translateContent("Successful!")})}),!0);var t},e.prototype.error=function(t){var e;return this.render(),e=JSON.parse(t.responseText),this.notify({type:"error",msg:App.i18n.translateContent(e.message)})},e.prototype.previewSound=function(t){var e;if((e=this.formParam(t.target)).notification_sound&&e.notification_sound.file)return App.OnlineNotification.play(e.notification_sound.file)},e}(App.ControllerSubContent),App.Config.set("Notifications",{prio:2600,name:"Notifications",parent:"#profile",target:"#profile/notifications",permission:["user_preferences.notifications+ticket.agent"],controller:t},"NavBarProfile")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.error=n(this.error,this),this.success=n(this.success,this),this.store=n(this.store,this),this.submit=n(this.submit,this),this.disable=n(this.disable,this),this.enable=n(this.enable,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.requiredPermission="user_preferences.out_of_office+ticket.agent",e.prototype.header="Out of Office",e.prototype.events={"submit form":"submit","click .js-disabled":"disable","click .js-enable":"enable"},e.prototype.render=function(){var t,e,n,i,s;return s=this.Session.get(),this.localData||(this.localData={out_of_office:s.out_of_office,out_of_office_start_at:s.out_of_office_start_at,out_of_office_end_at:s.out_of_office_end_at,out_of_office_replacement_id:s.out_of_office_replacement_id,out_of_office_replacement_id_completion:s.preferences.out_of_office_replacement_id_completion,out_of_office_text:s.preferences.out_of_office_text}),i=$(App.view("profile/out_of_office")({user:s,localData:this.localData,placeholder:App.User.outOfOfficeTextPlaceholder()})),n=new App.ControllerForm({model:{configure_attributes:[{name:"out_of_office_start_at",display:"",tag:"date",past:!1,future:!0,"null":!1}]},noFieldset:!0,params:this.localData}),i.find(".js-startDate").html(n.form),e=new App.ControllerForm({model:{configure_attributes:[{name:"out_of_office_end_at",display:"",tag:"date",past:!1,future:!0,"null":!1}]},noFieldset:!0,params:this.localData}),i.find(".js-endDate").html(e.form),t=new App.ControllerForm({model:{configure_attributes:[{name:"out_of_office_replacement_id",display:"",relation:"User",tag:"user_autocompletion",autocapitalize:!1,multiple:!1,limit:30,minLengt:2,placeholder:"Enter Person or Organization/Company","null":!1,translate:!1,disableCreateObject:!0,value:this.localData}]},noFieldset:!0,params:this.localData}),i.find(".js-recipientDropdown").html(t.form),!0===this.localData.out_of_office?i.find(".js-disabled").removeClass("is-disabled"):i.find(".js-disabled").addClass("is-disabled"),this.html(i)},e.prototype.enable=function(t){var e;return t.preventDefault(),(e=this.formParam(t.target)).out_of_office=!0,this.store(t,e)},e.prototype.disable=function(t){var e;return t.preventDefault(),(e=this.formParam(t.target)).out_of_office=!1,this.store(t,e)},e.prototype.submit=function(t,e){return t.preventDefault(),e=this.formParam(t.target),this.store(t,e)},e.prototype.store=function(t,e){var n,i;for(n in this.formDisable(t),e)i=e[n],this.localData[n]=i;return App.Ajax.request({id:"user_out_of_office",type:"PUT",url:this.apiPath+"/users/out_of_office",data:JSON.stringify(e),processData:!0,success:this.success,error:this.error})},e.prototype.success=function(t){return"ok"===t.message?(this.render(),this.notify({type:"success",msg:App.i18n.translateContent("Successfully!"),timeout:1e3})):(t.notice?this.notify({type:"error",msg:App.i18n.translateContent(t.notice[0],t.notice[1]),removeAll:!0}):this.notify({type:"error",msg:"Please contact your administrator.",removeAll:!0}),this.formEnable(this.$("form")))},e.prototype.error=function(t,e,n){var i,s;if(this.formEnable(this.$("form")),"abort"!==e)return i=JSON.parse(t.responseText),s=401===t.status||"Unauthorized"===n?"\xbb "+App.i18n.translateInline("Unauthorized")+" \xab":404===t.status||"Not Found"===n?"\xbb "+App.i18n.translateInline("Not Found")+" \xab":i.error?App.i18n.translateInline(i.error):"\xbb "+App.i18n.translateInline("Error")+" \xab",this.notify({type:"error",msg:App.i18n.translateContent(s),removeAll:!0})},e}(App.ControllerSubContent),App.Config.set("OutOfOffice",{prio:2800,name:"Out of Office",parent:"#profile",target:"#profile/out_of_office",permission:["user_preferences.out_of_office+ticket.agent"],controller:t},"NavBarProfile")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.success=n(this.success,this),this.update=n(this.update,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.requiredPermission="user_preferences.password",e.prototype.header="Password",e.prototype.events={"submit form":"update"},e.prototype.render=function(){var t,e;return e=$(App.view("profile/password")()),t=[{name:"password_old",display:"Current password",tag:"input",type:"password",limit:100,"null":!1,"class":"input",single:!0},{name:"password_new",display:"New password",tag:"input",type:"password",limit:100,"null":!1,"class":"input"}],this.form=new App.ControllerForm({el:e.find(".password_item"),model:{configure_attributes:t},autofocus:!1}),this.html(e)},e.prototype.update=function(t){var e;return t.preventDefault(),e=this.formParam(t.target),this.formDisable(t),e.password_new_confirm!==e.password_new?(this.formEnable(t),this.$("[name=password_new]").val(""),this.$("[name=password_new_confirm]").val(""),void this.notify({type:"error",msg:"Can't update password, your new passwords do not match. Please try again!",removeAll:!0})):e.password_new?this.ajax({id:"password_reset",type:"POST",url:this.apiPath+"/users/password_change",data:JSON.stringify(e),processData:!0,success:this.success}):(this.formEnable(t),void this.notify({type:"error",msg:"Please supply your new password!",removeAll:!0}))},e.prototype.success=function(t){return"ok"===t.message?(this.render(),this.notify({type:"success",msg:App.i18n.translateContent("Password changed successfully!")})):(t.notice?this.notify({type:"error",msg:App.i18n.translateContent(t.notice[0],t.notice[1]),removeAll:!0}):this.notify({type:"error",msg:"Unable to set password. Please contact your administrator.",removeAll:!0}),this.formEnable(this.$("form")))},e}(App.ControllerSubContent),App.Config.set("Password",{prio:2e3,name:"Password",parent:"#profile",target:"#profile/password",controller:t,permission:["user_preferences.password"]},"NavBarProfile")}.call(this),function(){var n,t,i=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function e(){var t;this.error=i(this.error,this),this["delete"]=i(this["delete"],this),this.create=i(this.create,this),this.render=i(this.render,this),this.load=i(this.load,this),e.__super__.constructor.apply(this,arguments),this.load(),this.interval((t=this,function(){return t.load()}),62e3)}return s(e,t),e.prototype.requiredPermission="user_preferences.access_token",e.prototype.header="Token Access",e.prototype.events={"click .js-delete":"delete","click .js-create":"create"},e.prototype.load=function(n){return null==n&&(n=!1),this.ajax({id:"user_access_token",type:"GET",url:this.apiPath+"/user_access_token",success:(i=this,function(t){var e;if(e=t.tokens,n||!i.lastestUpdated||!e||!e[0]||i.lastestUpdated.updated_at!==e[0].updated_at)return i.lastestUpdated=e[0],i.tokens=t.tokens,i.permissions=t.permissions,i.render()})});var i},e.prototype.render=function(){return this.html(App.view("profile/token_access")({tokens:this.tokens}))},e.prototype.create=function(t){return t.preventDefault(),new n({container:this.el.closest(".content"),permissions:this.permissions,load:this.load})},e.prototype["delete"]=function(t){var e,n,i;return t.preventDefault(),n=$(t.currentTarget).data("token-id"),i=this,e=function(){return i.ajax({id:"user_access_token_delete",type:"DELETE",url:i.apiPath+"/user_access_token/"+n,processData:!0,success:function(){return i.load(!0)},error:i.error})},new App.ControllerConfirm({message:"Sure?",callback:e,container:this.el.closest(".content")})},e.prototype.error=function(t){var e;return e=JSON.parse(t.responseText),this.notify({type:"error",msg:App.i18n.translateContent(e.message||e.error)})},e}(App.ControllerSubContent),n=function(t){function e(){return this.error=i(this.error,this),this.onClosed=i(this.onClosed,this),this.show=i(this.show,this),this.onSubmit=i(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.head="Add a Personal Access Token",e.prototype.buttonSubmit="Create",e.prototype.buttonCancel=!0,e.prototype.shown=!0,e.prototype.content=function(){var t,e;return t=$(App.view("profile/token_access_create")({permissions:this.permissions})),e=App.UiElement.date.render({name:"expires_at"}),t.find(".js-date").html(e),t},e.prototype.onSubmit=function(t){var e;if(t.preventDefault(),e=this.formParam(t.target),!_.isEmpty(e.permission))return _.isArray(e.permission)||(e.permission=[e.permission]),this.ajax({id:"user_access_token_create",type:"POST",url:this.apiPath+"/user_access_token",data:JSON.stringify(e),processData:!0,success:this.show,error:this.error});alert("Min. one permission is needed!")},e.prototype.show=function(t){return this.load(),this.newToken=t,this.close()},e.prototype.onClosed=function(){var t;if(this.newToken)return t=this,new App.ControllerModal({head:"Your New Personal Access Token",buttonSubmit:"OK, I've copied my token",content:function(){return App.view("profile/token_access_created")({name:t.newToken.name})},onShown:function(){return this.$(".js-select").on("click",t.selectAll)},onCancel:function(){return this.close()},onSubmit:function(){return this.close()},container:this.container})},e.prototype.error=function(t){var e;return e=JSON.parse(t.responseText),this.notify({type:"error",msg:App.i18n.translateContent(e.message||e.error)})},e}(App.ControllerModal),App.Config.set("Token Access",{prio:3200,name:"Token Access",parent:"#profile",target:"#profile/token_access",controller:t,permission:["user_preferences.access_token"]},"NavBarProfile")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsArea=function(t){function e(){this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),App.Setting.fetchFull(this.render,{force:!1})}return i(e,t),e.prototype.render=function(){var t,e,n,i,s,r;if(r=App.Setting.search({filter:{area:this.area}}),!App.Config.get("system_online_service")||(r=_.filter(r,function(t){if(!(t.online_service||t.preferences&&t.preferences.online_service_disable))return t}),!_.isEmpty(r))){for(r=_.filter(r,function(t){if(!t.preferences||!t.preferences.disabled)return t}),t=[],e=0,i=(r=_.sortBy(r,function(t){if(t.preferences)return t.preferences.prio})).length;e<i;e++)!0!==(s=r[e]).preferences.hidden&&(n=s.preferences.controller&&App[s.preferences.controller]?new App[s.preferences.controller]({setting:s}):new App.SettingsAreaItem({setting:s}),t.push(n.el));return this.html(t)}},e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsAreaItem=function(t){function e(){this.update=n(this.update,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.template="settings/item",e.prototype.events={"submit form":"update"},e.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p,u;if(!this.setting.options)throw"No such options for "+this.setting.name;if(!this.setting.options.form)throw"No such options.form for "+this.setting.name;for(n=e=0,o=(c=this.setting.options.form).length;n<o;n++)i=c[n],e+=1;if(1<e)for(s=0,a=(p=this.setting.options.form).length;s<a;s++)(i=p[s])["default"]=this.setting.state_current.value[i.name];else i["default"]=this.setting.state_current.value;for(this.configure_attributes=this.setting.options.form,r=0,l=(u=this.configure_attributes).length;r<l;r++)"boolean"===(t=u[r]).tag&&(t.translate=!0);return this.html(App.view(this.template)({setting:this.setting})),new App.ControllerForm({el:this.el.find(".form-item"),model:{configure_attributes:this.configure_attributes,className:""},autofocus:!1})},e.prototype.update=function(t){var e,n,i,s,r,o,a,l;for(t.preventDefault(),this.formDisable(t),r=this.formParam(t.target),e=void(n=0),i=0,s=(o=this.setting.options.form).length;i<s;i++)n+=1,e=r[o[i].name];return a=void 0,a=1<n?r:e,App.Setting.set(this.setting.name,a,{doneLocal:(l=this,function(){return l.formEnable(t)})})},e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsAreaItemDefaultLocale=function(t){function e(){return this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.render=function(){var t,e,n,i,s,r;for(r={},e=0,n=(s=App.Locale.all()).length;e<n;e++)r[(i=s[e]).locale]=i.name;return t=[{name:"locale_default",display:"",tag:"searchable_select","null":!1,"class":"input",options:r,"default":this.setting.state_current.value}],this.html(App.view(this.template)({setting:this.setting})),new App.ControllerForm({el:this.el.find(".form-item"),model:{configure_attributes:t,className:""},autofocus:!1})},e}(App.SettingsAreaItem)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsAreaItemDefaultTimezone=function(t){function e(){return this.fetchTimezones=n(this.fetchTimezones,this),this.localRender=n(this.localRender,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.result={},e.prototype.render=function(){return this.fetchTimezones()},e.prototype.localRender=function(t){var e,n,i,s,r;for(r in i={},s=t.timezones)(n=s[r]).toString().match(/(\+|\-)/)||(n="+"+n),i[r]=r+" (GMT"+n+")";return e=[{name:"timezone_default",display:"",tag:"searchable_select","null":!1,"class":"input",options:i,"default":this.setting.state_current.value}],this.html(App.view(this.template)({setting:this.setting})),new App.ControllerForm({el:this.el.find(".form-item"),model:{configure_attributes:e,className:""},autofocus:!1})},e.prototype.fetchTimezones=function(){return this.ajax({id:"calendar_timezones",type:"GET",url:this.apiPath+"/calendars/timezones",success:(e=this,function(t){return e.result=t,e.localRender(t)})});var e},e}(App.SettingsAreaItem)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsAreaLogo=function(t){function e(){this.submit=n(this.submit,this),this.onLogoPick=n(this.onLogoPick,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.elements={".logo-preview":"logoPreview"},e.prototype.events={"submit form":"submit","change .js-upload":"onLogoPick"},e.prototype.render=function(){var t;return(t=$(App.view("settings/logo")({setting:this.setting}))).find(".js-loginPreview").html(App.view("generic/login_preview")({logoUrl:this.logoUrl(),logoChange:!0,maintananceChange:!1})),this.html(t)},e.prototype.onLogoPick=function(t){var e,n,i,s;if((i=new FileReader).onload=(s=this,function(t){return s.logoPreview.attr("src",t.target.result)}),e=t.target.files[0])return n=8,e.size&&e.size>1048576*n?(App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent("File too big, max. %s MB allowed.",n),timeout:2e3}),void this.logoPreview.attr("src","")):i.readAsDataURL(e)},e.prototype.submit=function(a){var t,l;return a.preventDefault(),this.formDisable(a),this.params=this.formParam(a.target),this.params.logo=this.logoPreview.attr("src"),l=this,t=function(t){return l.params.logo_resize=t,l.ajax({id:"setting_image_"+l.setting.id,type:"PUT",url:l.apiPath+"/settings/image/"+l.setting.id,data:JSON.stringify(l.params),processData:!0,success:function(t){var e,n,i,s,r,o;if(l.formEnable(a),"ok"!==t.result)return App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent(t.message),timeout:2e3});for(App.Event.trigger("notify",{type:"success",msg:App.i18n.translateContent("Update successful!"),timeout:2e3}),s=[],e=0,n=(i=t.settings).length;e<n;e++)r=i[e],o=App.Setting.get(r.name),s.push(App.Config.set(name,o));return s},fail:function(){return l.formEnable(a)}})},App.ImageService.resizeForApp(this.params.logo,this.logoPreview.width(),this.logoPreview.height(),t)},e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsAreaProxy=function(t){function e(){this.testConnection=n(this.testConnection,this),this.update=n(this.update,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.events={"submit form":"update","click .js-submit":"update","click .js-test":"testConnection"},e.prototype.render=function(){return this.html(App.view("settings/proxy")({setting:App.Setting.findByAttribute("name","proxy"),proxy:App.Setting.get("proxy"),proxy_username:App.Setting.get("proxy_username"),proxy_password:App.Setting.get("proxy_password"),proxy_no:App.Setting.get("proxy_no")}))},e.prototype.update=function(t){var e;return t.preventDefault(),this.formDisable(t),e=this.formParam(t),App.Setting.set("proxy",e.proxy),App.Setting.set("proxy_username",e.proxy_username),App.Setting.set("proxy_password",e.proxy_password),App.Setting.set("proxy_no",e.proxy_no),this.formEnable(t),this.render()},e.prototype.testConnection=function(t){var e,n;return t.preventDefault(),e=this.formParam(t),this.ajax({id:"proxy_test",type:"POST",url:this.apiPath+"/proxy",data:JSON.stringify(e),processData:!0,success:(n=this,function(t){return"success"===t.result?(n.$(".js-test").addClass("hide"),n.$(".js-submit").removeClass("hide"),void App.Event.trigger("notify",{type:"success",msg:App.i18n.translateContent("Connection test successful"),timeout:2e3})):new App.ControllerConfirm({head:"Error",message:t.message,buttonClass:"btn--success",buttonCancel:!1,buttonSubmit:"Close",container:n.el.closest(".content")})})})},e}(App.Controller)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsAreaStorageProvider=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.template="settings/storage_provider",e}(App.SettingsAreaItem)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsAreaSwitch=function(t){function e(){this.update=n(this.update,this),this.toggleSetting=n(this.toggleSetting,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.events={"change .js-setting input":"toggleSetting","submit form":"update"},e.prototype.elements={".js-setting input":"uiSetting"},e.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m;for(e=t=0,o=(u=this.setting.options.form).length;e<o;e++)n=u[e],t+=1;if(1<t)for(i=0,a=(h=this.setting.options.form).length;i<a;i++)(n=h[i])["default"]=this.setting.state_current.value[n.name];else n["default"]=this.setting.state_current.value;for(this.configure_attributes=this.setting.options.form,this.subSetting=[],s=0,l=(d=this.setting.preferences.sub).length;s<l;s++)p=d[s],this.subSetting.push(App.Setting.findByAttribute("name",p));for(this.html(App.view("settings/switch")({checked:App.Setting.get(this.setting.name),setting:this.setting,subSetting:this.subSetting})),m=[],r=0,c=(f=this.subSetting).length;r<c;r++)p=f[r],m.push(new App.ControllerForm({el:this.$(".form-item"),params:p.state_current.value,model:{configure_attributes:p.options.form,className:""},autofocus:!1}));return m},e.prototype.toggleSetting=function(){var t;return t=this.uiSetting.prop("checked"),App.Setting.set(this.setting.name,t)},e.prototype.update=function(n){var t,e,i,s,r,o,a,l,c,p;for(n.preventDefault(),this.formDisable(n),o=this.formParam(n.target),r=$(n.currentTarget).data("name"),t=void(e=0),i=0,s=(a=(l=App.Setting.findByAttribute("name",r)).options.form).length;i<s;i++)e+=1,t=o[a[i].name];return c=1<e?{value:o}:{value:t},l.state_current=c,p=this,l.save({done:function(){return p.formEnable(n),App.Event.trigger("notify",{type:"success",msg:App.i18n.translateContent("Update successful!"),timeout:2e3}),App.Setting.preferencesPost(l)},fail:function(t,e){return p.formEnable(n),App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to update object!"),timeout:2e3})}})},e}(App.Controller)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsAreaTicketHookPosition=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.template="settings/ticket_hook_position",e}(App.SettingsAreaItem)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsAreaTicketNumber=function(t){function e(){this.update=n(this.update,this),this.paramsPreferences=n(this.paramsPreferences,this),this.showPreferences=n(this.showPreferences,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.events={"submit form":"update"},e.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y;for(n=t=0,o=(u=this.setting.options.form).length;n<o;n++)i=u[n],t+=1;if(1<t)for(s=0,a=(h=this.setting.options.form).length;s<a;s++)(i=h[s])["default"]=this.setting.state_current.value[i.name];else i["default"]=this.setting.state_current.value;for(this.map={"Ticket::Number::Increment":"ticket_number_increment","Ticket::Number::Date":"ticket_number_date"},this.configure_attributes=this.setting.options.form,this.html(App.view("settings/ticket_number")({setting:this.setting})),f=function(t,e,n){if(v.attributes=n,"ticket_number"===e.name)return v.showPreferences(t.ticket_number)},y=v=this,m=function(){var t,e,n,i,s,r,o,a,l,c,p;if(c=y.formParam(y.$(".js-form")),a=App.Config.get("ticket_hook")+"???","Ticket::Number::Increment"===c.ticket_number){if(l=y.paramsPreferences("Ticket::Number::Increment"),a=""+App.Config.get("ticket_hook")+App.Config.get("system_id"),t="1",l.min_size&&(o=parseInt(l.min_size)-(""+App.Config.get("system_id")).length,l.checksum&&(o-=1),1<o))for(r=2,p=o;2<=p?r<=p:p<=r;2<=p?++r:--r)t="0"+t;a+=t,l.checksum&&(a+="9")}else"Ticket::Number::Date"===c.ticket_number&&(l=y.paramsPreferences("Ticket::Number::Date"),n=(e=new Date).getDate(),i=e.getMonth()+1,s=e.getFullYear(),a=""+App.Config.get("ticket_hook")+s+i+n+App.Config.get("system_id")+"001",l.checksum&&(a+="9"));return y.$(".js-preview").text(a)},new App.ControllerForm({el:this.el.find(".js-form"),model:{configure_attributes:this.configure_attributes,className:""},autofocus:!1,handlers:[f,m]}),r=0,l=(p=this.setting.preferences.settings_included||["ticket_number_increment","ticket_number_date"]).length;r<l;r++)c=p[r],d=App.Setting.findByAttribute("name",c),g=App.Setting.get(c),e=$(App.view("settings/"+c)({setting:d})),new App.ControllerForm({el:e.find(".js-formItem"),model:{configure_attributes:d.options.form,className:""},autofocus:!1,params:g,handlers:[m]}),this.$(".js-formPreferences").append(e);return this.showPreferences(i["default"])},e.prototype.showPreferences=function(t){return this.$(".js-formPreferencesItem").addClass("hidden"),this.$('.js-formPreferencesItem[data-backend="'+t+'"]').removeClass("hidden")},e.prototype.paramsPreferences=function(t){return this.formParam(this.$('.js-formPreferencesItem[data-backend="'+t+'"] form'))},e.prototype.update=function(n){var t,e,i,s,r;return n.preventDefault(),this.formDisable(this.$(".js-form")),(t=this.formParam(this.$(".js-form"))).ticket_number&&(e=this.paramsPreferences(t.ticket_number),(i=this.map[t.ticket_number])&&e&&App.Setting.set(i,e)),this.setting.state_current={value:t.ticket_number},(s=this).setting.save({done:(r=this,function(){return s.formEnable(n),App.Event.trigger("notify",{type:"success",msg:App.i18n.translateContent("Update successful!"),timeout:2e3}),App.Setting.preferencesPost(r.setting)}),fail:function(t,e){return s.formEnable(n),App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to update object!"),timeout:2e3})}})},e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SettingsForm=function(t){function e(){this.update=n(this.update,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),App.Setting.fetchFull(this.render,{force:!1})}return i(e,t),e.prototype.events={"submit form":"update"},e.prototype.render=function(){var t,e,n,i,s,r,o,a;if(o=App.Setting.search({filter:{area:this.area}}),!App.Config.get("system_online_service")||(o=_.filter(o,function(t){if(!(t.online_service||t.preferences&&t.preferences.online_service_disable))return t}),!_.isEmpty(o))){for(o=_.filter(o,function(t){if(!t.preferences||!t.preferences.disabled)return t}),o=_.sortBy(o,function(t){if(
t.preferences)return t.preferences.prio}),i=$(App.view("settings/form")({settings:o})),e=0,n=o.length;e<n;e++)t=(r=o[e]).options.form,a=App.Setting.get(r.name),(s={})[r.name]=a,new App.ControllerForm({el:i.find("[data-name="+r.name+"]"),model:{configure_attributes:t},params:s});return this.html(i)}},e.prototype.update=function(t){var e,n,i,s,r,o;for(n in t.preventDefault(),this.formDisable(t),i=this.formParam(t.target),r=this,e=0,s=[],i)o=i[n],App.Setting.findByAttribute("name",n)?(e+=1,s.push(App.Setting.set(n,o,{done:function(){return r.formEnable(t),0===(e-=1)&&App.Event.trigger("notify",{type:"success",msg:App.i18n.translateContent("Update successful!"),timeout:2e3}),App.Setting.preferencesPost(this)},fail:function(t,e){return App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to update object!"),timeout:2e3})}}))):s.push(void 0);return s},e}(App.Controller)}.call(this),function(){App.UiElement.ApplicationUiElement=function(){function t(){}return t.sortOptions=function(t){var e,n,i,s,r,o,a,l;if(null!==t.sortBy&&!_.isEmpty(t.options)){if(!_.isArray(t.options)){for(e in s=[],r={},a=t.options)l=a[e].toString().toLowerCase(),s.push(l),r[l]=e;for(s=s.sort(),t.order&&"DESC"===t.order&&(s=s.reverse()),o=[],n=0,i=s.length;n<i;n++)e=s[n],o.push(r[e]);return t.options=o}t.order&&"DESC"===t.order&&(t.options=t.options.reverse())}},t.addNullOption=function(t){if(t.options&&t.nulloption)return _.isArray(t.options)?t.options.unshift({name:"-",value:""}):t.options[""]="-"},t.getConfigOptionList=function(t){var n,e,i,s,r,o,a,l,c,p;if(!_.isEmpty(t.options)){if(p=t.options,t.options=[],_.isArray(p))for(e=0,r=p.length;e<r;e++)c=p[e],t.translate&&(c.name=App.i18n.translateInline(c.name)),t.options.push(c);else for(n=function(t){return p[t]&&p[t].toString?p[t].toString():""},i=0,o=(l=_.keys(p).sort(function(t,e){return n(t).localeCompare(n(e))})).length;i<o;i++)s=l[i],a=p[s],t.translate&&(a=App.i18n.translateInline(a)),t.options.push({name:a,value:s});return t.sortBy=null}},t.getRelationOptionList=function(t,e){var n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k;if(!_.isEmpty(t.relation)&&App[t.relation]){if(t.options=[],m=[],t.filter)if(App.Log.debug("ControllerForm","_getRelationOptionList:filter",t.filter),"function"==typeof t.filter)App.Log.debug("ControllerForm","_getRelationOptionList:filter-function"),n=App[t.relation].search({sortBy:t.sortBy}),m=t.filter(n,"collection",e);else if(t.filter[t.name])for(s=t.filter[t.name],App.Log.debug("ControllerForm","_getRelationOptionList:filter-data",s),o=0,p=(b=App[t.relation].search({sortBy:t.sortBy})).length;o<p;o++)for(y=b[o],a=0,u=s.length;a<u;a++)l=s[a],y.id===l&&m.push(y);else if(t.filter&&_.isArray(t.filter)){for(App.Log.debug("ControllerForm","_getRelationOptionList:filter-array",t.filter),c=0,h=(w=App[t.relation].search({sortBy:t.sortBy})).length;c<h;c++)for(y=w[c],g=0,d=(k=t.filter).length;g<d;g++)l=k[g],(y.id===l||y.id&&l&&y.id.toString()===l.toString())&&m.push(y);if(e[t.name]&&!t.rejectNonExistentValues){for(r=!1,v=0,f=m.length;v<f;v++)m[v].id.toString()===e[t.name].toString()&&(r=!0);r||(i=App[t.relation].find(e[t.name]),m.push(i))}}else App.Log.debug("ControllerForm","_getRelationOptionList:filter-data no filter matched"),m=App[t.relation].search({sortBy:t.sortBy});else App.Log.debug("ControllerForm","_getRelationOptionList:filter-no filter defined"),m=App[t.relation].search({sortBy:t.sortBy});return App.Log.debug("ControllerForm","_getRelationOptionList",t,m),this.buildOptionList(m,t)}},t.buildOptionList=function(t,e){var n,i,s,r,o,a,l;for(r=0,o=t.length;r<o;r++)i=!1,(n="active"in(s=t[r]))&&!s.active&&(i=this._selectedOptionsIsSelected(e.value,{name:s.name||"",value:s.id})),(s.active||!n||i)&&(a="?",s.displayName?a=s.displayName():s.name&&(a=s.name),e.translate&&(a=App.i18n.translateInline(a)),l={value:s.id,note:s.note,name:a,title:s.email?s.email:a},s.graphic&&(l.graphic=s.graphic,s.aspect_ratio&&(l.aspect_ratio=s.aspect_ratio)),e.options.push(l));return e.sortBy=null},t.filterOption=function(t){if(t.filter&&!_.isEmpty(t.options)&&"function"==typeof t.filter)return App.Log.debug("ControllerForm","_filterOption:filter-function"),t.options=t.filter(t.options,t)},t.selectedOptions=function(t){var e,n,i,s,r,o,a,l,c,p,u,h;if(t.options){for(e=0,s=(l=t.options).length;e<s;e++)a=l[e],this._selectedOptionsIsSelected(t.value,a)&&(a.selected="selected",a.checked="checked");for(h=!1,n=0,r=(c=t.options).length;n<r;n++)((a=c[n]).selected||a.checked)&&(h=!0);if(!h){for(u=[],i=0,o=(p=t.options).length;i<o;i++)a=p[i],this._selectedOptionsIsSelected(t["default"],a)?(a.selected="selected",u.push(a.checked="checked")):u.push(void 0);return u}}},t._selectedOptionsIsSelected=function(t,e){var n,i,s;if(_.isArray(t))for(n=0,i=t.length;n<i;n++)if(s=t[n],this._selectedOptionsIsSelectedItem(s,e))return!0;return!(null!=t&&"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||!this._selectedOptionsIsSelectedItem(t,e))},t._selectedOptionsIsSelectedItem=function(t,e){var n,i,s;if(null==(s=t)&&(s=""),null==(i=e.value)&&(i=""),null==(n=e.name)&&(n=""),"string"==typeof s||"number"==typeof s||"boolean"==typeof s){if(i.toString()===s.toString()||n.toString()===s.toString())return!0}else if(s&&i&&_.include(s,i)||s&&n&&_.include(s,n))return!0;return!1},t.disabledOptions=function(t){var e,n,i,s,r;if(t.options&&_.isArray(t.options)){for(r=[],e=0,n=(s=t.options).length;e<n;e++)!0===(i=s[e]).disable?r.push(i.disabled="disabled"):r.push(i.disabled="");return r}},t}()}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.active=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e){var n;return t["null"]=!1,t.translate=!0,t.options=[{name:"active",value:!0},{name:"inactive",value:!1}],this.getConfigOptionList(t,e),this.sortOptions(t,e),this.selectedOptions(t,e),(n=$(App.view("generic/select")({attribute:t}))).find("select").data("field-type","boolean"),n},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){App.UiElement.autocompletion=function(){function t(){}return t.render=function(s,r){var t,e,o;return r[s.name+"_autocompletion_value_shown"]&&(s.valueShown=r[s.name+"_autocompletion_value_shown"]),e=$(App.view("generic/autocompletion")({attribute:s})),o=this,t=function(){var n,i,t,e;return i="#"+s.id,t="#"+s.id+"_autocompletion",o.callback=s.callback,o.callback&&s.value&&o.params&&o.callback(o.params),n=function(t,e){if($(i).val(e.id).trigger("change"),$(i+"_autocompletion_value_shown").val(e.value),o.callback)return r=App.ControllerForm.params(form),o.callback(r)},"string"==typeof(e=s.source)&&(e=e.replace("#{@apiPath}",App.Config.get("api_path"))),$(t).autocomplete({source:e,minLength:s.minLengt||3,select:function(t,e){return n(t,e.item)}})},App.Delay.set(t,280,void 0,"form_autocompletion"),e},t}()}.call(this),function(){App.UiElement.autocompletion_ajax=function(){function t(){}return t.render=function(t,e,n){var i;return null==e&&(e={}),(e[t.name]||t.value)&&(i=App[t.relation].find(e[t.name]||t.value).displayName()),new App.SearchableAjaxSelect({delegate:n,attribute:{value:e[t.name]||t.value,valueName:i,name:t.name,id:e.organization_id||t.id,placeholder:App.i18n.translateInline("Search..."),limit:40,object:t.relation,ajax:!0}}).element()},t}()}.call(this),function(){var s=[].slice;App.UiElement.basedate=function(){function t(){}return t.templateName=function(){throw"Must override in a subclass"},t.render=function(t){var e,n;return(e=_.clone(t)).nameRaw=e.name,e.name="{"+this.templateName()+"}"+e.name,n=$(App.view("generic/"+this.templateName())({attribute:e})),$.fn.datepicker.defaults.template=App.view("generic/datepicker")(),$.fn.datepicker.dates.custom=this.buildCustomDates(),this.applyPickers(n,e),this.bindEvents(n,e),n},t.log=function(t){var e,n,i;return n=t,e=2<=arguments.length?s.call(arguments,1):[],(i=App.Log).debug.apply(i,["Ui.element."+this.templateName()+"."+n].concat(s.call(e)))},t.applyPickers=function(t,e){return t.find(".js-datepicker").datepicker({weekStart:1,autoclose:!0,todayBtn:"linked",todayHighlight:!0,format:App.i18n.timeFormat().date,rtl:"rtl"===App.i18n.dir(),container:t,language:"custom",orientation:e.orientation,disableScroll:e.disableScroll}),this.setNewTimeInitial(t,e)},t.bindEvents=function(t,e){var n,i;return t.find("input").bind("focus",function(){return t.find(".js-datepicker").datepicker("rerender")}).bind("keyup blur change",(n=this,function(){return n.setNewTime(t,e,0),n.validation(t,e,!0)})),t.bind("validate",(i=this,function(){return i.validation(t,e)}))},t.setNewTime=function(t,e,n){var i;if(null==n&&(n=!1),i=this.currentInput(t,e)){if(this.validateInput(i))return t.find('[name="'+e.name+'"]').val(this.buildTimestamp(i));t.find('[name="'+e.name+'"]').val("")}},t.currentInput=function(t,e){var n,i,s,r;return(n=t.find(".js-datepicker").datepicker("getDate"))&&"Invalid Date"!==n.toString()?(this.log("setNewTime",n),r=n.getFullYear(),s=n.getMonth()+1,i=n.getDate(),[App.Utils.formatTime(r)+"-"+App.Utils.formatTime(s,2)+"-"+App.Utils.formatTime(i,2)]):(t.find('[name="'+e.name+'"]').val(""),!1)},t.validateInput=function(t){return""!==t[0]},t.buildTimestamp=function(){throw"Must override in a subclass"},t.dateSetter=function(){throw"Must override in a subclass"},t.setNewTimeInitial=function(t,e){var n,i;if(i=t.find('[name="'+e.name+'"]').val(),this.log("setNewTimeInitial",i),i)return n=new Date(Date.parse(i)),this.log("setNewTimeInitial",i,n),this.setTimestamp(t,n),t.find(".js-datepicker").datepicker("update");this.setNoTimestamp(t)},t.setNoTimestamp=function(){},t.setTimestamp=function(t,e){return t.find(".js-datepicker").datepicker(this.dateSetter(),e)},t.validation=function(t,e){var n,i,s,r,o;if("self"===e.validationContainer?t.find(".js-datepicker").removeClass("has-error"):(t.closest(".form-group").removeClass("has-error"),t.find(".has-error").removeClass("has-error"),t.find(".help-inline").html(""),t.closest(".form-group").find(".help-inline").html("")),n={},(o=t.find('[name="'+e.name+'"]').val())?new Date(Date.parse(o)):e["null"]||(n[e.name]="missing"),this.log("validation",n),!_.isEmpty(n)){if("self"===e.validationContainer)return t.find(".js-datepicker").addClass("has-error");for(s in i=t.closest(".form-group"),r=[],n)n[s],r.push(i.addClass("has-error"));return r}},t.buildCustomDates=function(){var t;return t={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"today",clear:"clear"},App.i18n.translateDeep(t)},t}()}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement["boolean"]=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e){var n;return _.isEmpty(t.options)&&(t.options=[{name:"yes",value:!0},{name:"no",value:!1}],t.translate=!0),this.getConfigOptionList(t,e),this.sortOptions(t,e),this.selectedOptions(t,e),(n=$(App.view("generic/select")({attribute:t}))).find("select").data("field-type","boolean"),n},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){App.UiElement.business_hours=function(){function t(){}return t.render=function(t){var e,n;return(e=_.clone(t)).nameRaw=e.name,e.name="{business_hours}"+e.name,e.value||(e.value={mon:{active:!0,timeframes:[["09:00","17:00"]]},tue:{active:!0,timeframes:[["09:00","17:00"]]},wed:{active:!0,timeframes:[["09:00","17:00"]]},thu:{active:!0,timeframes:[["09:00","17:00"]]},fri:{active:!0,timeframes:[["09:00","17:00"]]},sat:{active:!1,timeframes:[["10:00","14:00"]]},sun:{active:!1,timeframes:[["10:00","14:00"]]}}),(n=new App.BusinessHours({attribute:e,hours:e.value})).render(),n.el},t}()}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.checkbox=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e){return this.getConfigOptionList(t,e),this.getRelationOptionList(t,e),this.addNullOption(t,e),this.sortOptions(t,e),this.selectedOptions(t,e),this.disabledOptions(t,e),this.filterOption(t,e),$(App.view("generic/checkbox")({attribute:t}))},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.checkboxTicketAttributes=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e){var n,i,s,r,o;for(i in n=[],r=App.Ticket.attributesGet())"password"!==(o=r[i]).type&&"tag"!==o.type&&"tags"!==o.name&&(s=o.name,"_ids"===o.name.substr(o.name.length-4,4)?s=o.name.substr(0,o.name.length-4):"_id"===o.name.substr(o.name.length-3,3)&&(s=o.name.substr(0,o.name.length-3)),n.push({value:s,name:o.display}));return t.sortBy=null,t.item_class="checkbox",t.options=n,App.UiElement.checkbox.render(t,e)},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.color=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t){return new App.Color({attribute:t}).element()},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.column_select=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e){return t.multiple="multiple",this.getConfigOptionList(t,e),this.getRelationOptionList(t,e),this.addNullOption(t,e),this.sortOptions(t,e),this.selectedOptions(t,e),this.disabledOptions(t,e),this.filterOption(t,e),new App.ColumnSelect({attribute:t}).element()},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.date=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.templateName=function(){return"date"},e.buildTimestamp=function(t){return t[0]},e.dateSetter=function(){return"setUTCDate"},e}(App.UiElement.basedate)}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.datetime=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.templateName=function(){return"datetime"},r.applyPickers=function(t,e){return r.__super__.constructor.applyPickers.call(this,t,e),t.find(".js-timepicker").timepicker()},r.currentInput=function(t,e){var n;return n=r.__super__.constructor.currentInput.call(this,t,e),_.isArray(n)&&n.push(t.find(".js-timepicker").val()),n},r.validateInput=function(t){return""!==t[0]||""!==t[1]},r.setNoTimestamp=function(t){return t.find(".js-timepicker").val("08:00")},r.setTimestamp=function(t,e){var n,i,s;return r.__super__.constructor.setTimestamp.call(this,t,e),n=e.getHours(),i=e.getMinutes(),s=App.Utils.formatTime(n,2)+":"+App.Utils.formatTime(i,2),t.find(".js-timepicker").val(s)},r.buildTimestamp=function(t){var e,n;return n=t[0]+"T"+t[1]+":00.000Z",e=new Date(Date.parse(n)),isNaN(e)?"":(e.setMinutes(e.getMinutes()+e.getTimezoneOffset()),this.log("setNewTime",e.toString()),e.toISOString().replace(/\d\d\.\d\d\dZ$/,"00.000Z"))},r.dateSetter=function(){return"setDate"},r}(App.UiElement.basedate)}.call(this),function(){App.UiElement.datetime_search=function(){function t(){}return t.render=function(t){var e;return(e=_.clone(t)).disable_feature=!0,e["null"]=!1,App.UiElement.datetime.render(e)},t}()}.call(this),function(){App.UiElement.holiday_selector=function(){function t(){}return t.render=function(t){var e,n,i,s,r,o,a,l,c;if(s={},t.value)for(s=t.value,r={},a=0,c=(o=_.keys(s).sort()).length;a<c;a++)r[i=o[a]]=s[i];return(l=$(App.view("calendar/holiday_selector")({attribute:t,days:r}))).find(".js-boolean").data("field-type","boolean"),e={name:t.name+"_date",disable_feature:!0,"class":"form-control--small",validationContainer:"self"},n=App.UiElement.date.render(e),l.find(".js-datePicker").html(n),l.delegate(".js-active","click",function(t){var e,n,i;return e=$(t.target).prop("checked"),i=$(t.target).closest("tr"),n=$(t.target).closest("tr").find(".js-summary"),e?(i.removeClass("is-inactive"),n.prop("readonly",!1),n.removeClass("is-disabled")):(i.addClass("is-inactive"),n.prop("readonly",!0),n.addClass("is-disabled"))}),l.delegate(".js-remove","click",function(t){return $(t.target).closest("tr").remove()}),l.find(".js-summary").bind("keydown",function(t){if(13===t.which)return t.preventDefault(),l.find(".js-add").click()}),l.find(".js-add").bind("click",function(t){var e,n,i;if((e=$(t.target).closest("tr").find('[name="{date}public_holidays_date"]').val())&&(n=$(t.target).closest("tr").find(".js-summary").val())){if(!l.find("[data-date="+e+"]").get(0))return $(t.target).closest("tr").find(".js-summary").val(""),i=App.view("calendar/holiday_selector_placeholder")({placeholderDate:e,placeholderSummary:n,nameSummary:"public_holidays::"+e+"::summary",nameActive:"public_holidays::"+e+"::active"}),l.find(".settings-list-controlRow").before(i),l.find(".js-boolean").data("field-type","boolean");alert(App.i18n.translateInline("Aready exists!"))}}),l},t}()}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.ical_feed=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t){var e,n,i,s,r,o;return e=App.Config.get("ical_feeds")||{},n=App.Utils.sortByValue(e),i=$(App.view("generic/ical_feed")({attribute:t,icalFeeds:n})),s=function(){if(!i.find(".js-checkList").prop("checked")&&i.find(".js-list").val())return i.find(".js-checkList").prop("checked",!0),i.find(".js-checkManual").prop("checked",!1)},r=function(){if(!i.find(".js-checkManual").prop("checked"))return i.find(".js-checkList").prop("checked",!1),i.find(".js-checkManual").prop("checked",!0)},o=function(t){return t||(t=i.find(".js-check:checked").attr("value")),"manual"===t?i.find(".js-shadow").val(i.find(".js-manual").val()):i.find(".js-shadow").val(i.find(".js-list").val())},e[t.value]?s():(r(),i.find(".js-manual").val(t.value)),i.find(".js-check").bind("change",function(){return o()}),i.find(".js-list").bind("click change",function(){return s(),o("list")}),i.find(".js-manual").bind("keyup focus blur",function(){return r(),o("manual")}),i},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.icon_picker=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t){return new App.IconPicker({attribute:t}).element()},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.iconset_picker=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t){return new App.IconsetPicker({attribute:t}).element()},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){App.UiElement.input=function(){function t(){}return t.render=function(t){return $(App.view("generic/input")({attribute:t}))},t}()}.call(this),function(){App.UiElement.integer=function(){function t(){}return t.render=function(t){var e;return t.type="number",t.step="1",(e=$(App.view("generic/input")({attribute:t}))).data("field-type","integer"),e},t}()}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.multi_locales=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e,n){var i;return new App.MultiLocales({attribute:t,object:null!=n&&null!=(i=n.parentController)?i.object():void 0}).el},e.prepareParams=function(t,s,e){var r;if("string"==typeof e[t.name]&&(e[t.name]=[e[t.name]]),Array.isArray(e[t.name]))return r=s.find("[name="+t.name+"_primary_locale_id]:checked").val(),e[t.name+"_attributes"]=e[t.name].filter(function(t){return t}).map(function(t){var e,n,i;return e={system_locale_id:t,primary:t===r},(n=s.find(".js-primary input[value="+t+"]").closest("tr")).hasClass("settings-list--deleted")&&(e._destroy="1"),(i=n.data("kbLocaleId"))&&(e.id=parseInt(i)),e}),delete e[""+t.name],delete e[t.name+"_primary_locale_id"]},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.object_manager_attribute=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(a,l){var t,e,n,i,s,r,c;if(null==l&&(l={}),l.data_option_new&&!_.isEmpty(l.data_option_new)&&(l.data_option=l.data_option_new),"select"===a.value&&null!=l.data_option&&null!=l.data_option.options&&(s=_.map(l.data_option.options,function(t,e){return[e.toString(),t.toString()]}),l.data_option.sorted=s.sort(function(t,e){return t[1].localeCompare(e[1])})),e=$(App.view("object_manager/attribute")({attribute:a})),c=this,r=function(t,e,n,i,s){var r,o;if(t.data_type)return r=$(App.view("object_manager/attribute/"+t.data_type)({attribute:a,params:l})),c[t.data_type](r,t,l,a),(o=s.closest(".js-data")).find(".js-dataMap").html(r),o.find(".js-dataScreens").html(c.dataScreens(a,t,l))},i={datetime:"Datetime",date:"Date",input:"Text",select:"Select",tree_select:"Tree Select","boolean":"Boolean",integer:"Integer"},l.data_type)for(n in i)i[n],n!==l.data_type&&delete i[n];return t=[{name:a.name,display:"",tag:"select","null":!1,options:i,translate:!0,"default":"input",disabled:a.disabled}],new App.ControllerForm({el:e.find(".js-dataType"),model:{configure_attributes:t},noFieldset:!0,handlers:[r],params:l}),e.find(".js-boolean").data("field-type","boolean"),e.find('.js-dataType [name="data_type"]').trigger("change"),e},e.dataScreens=function(t,e,n){var i,s,r,o,a,l,c,p,u,h,d,f,m;if(p=n.object,a=!(u={Ticket:{"ticket.customer":{create_middle:{shown:!0,required:!1},edit:{shown:!0,required:!1}},"ticket.agent":{create_middle:{shown:!0,required:!1},edit:{shown:!0,required:!1}}},User:{"ticket.customer":{create:{shown:!0,required:!1},view:{shown:!0},signup:{shown:!1,required:!1}},"ticket.agent":{create:{shown:!0,required:!1},edit:{shown:!0,required:!1},view:{shown:!0},invite_customer:{shown:!1,required:!1}},"admin.user":{create:{shown:!0,required:!1},edit:{shown:!0,required:!1},view:{shown:!0},invite_agent:{shown:!1,required:!1},invite_customer:{shown:!1,required:!1}}},Organization:{"ticket.customer":{view:{shown:!0}},"ticket.agent":{create:{shown:!0,required:!1},edit:{shown:!0,required:!1},view:{shown:!0}},"admin.organization":{create:{shown:!0,required:!1},edit:{shown:!0,required:!1},view:{shown:!0}}},Group:{"admin.group":{create:{shown:!0,required:!1},edit:{shown:!0,required:!1},view:{shown:!0}}}}),n&&!n.id&&(a=!0),r=u[p],a)for(d in r)for(f in m=r[d])for(c in h=m[f])o=h[c],n.screens||(n.screens={}),(i=n.screens)[f]||(i[f]={}),(s=n.screens[f])[d]||(s[d]={}),n.screens[f][d][c]=o;return(l=$(App.view("object_manager/screens")({attribute:t,data:u[p],params:n,init:a}))).find(".js-boolean").data("field-type","boolean"),l},e.input=function(t,e,n){var i,s,r,o,a;return i=[{name:"data_option::default",display:"Default",tag:"input",type:"text","null":!0,"default":""}],s=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),i=[{name:"data_option::type",display:"Type",tag:"select","null":!1,"default":"text",options:{text:"Text",tel:"Phone",email:"Email",url:"Url"},translate:!0}],a=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),i=[{name:"data_option::maxlength",display:"Maxlength",tag:"integer","null":!1,"default":120}],o=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),i=[{name:"data_option::linktemplate",display:"Link-Template",tag:"input",type:"text","null":!0,"default":"",placeholder:"https://example.com/?q=#{object.attribute_name} - use ticket, user or organization as object"}],r=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),t.find(".js-inputDefault").html(s.form),t.find(".js-inputType").html(a.form),t.find(".js-inputMaxlength").html(o.form),t.find(".js-inputLinkTemplate").html(r.form)},e.datetime=function(t,e,n){var i,s,r,o;return i=[{name:"data_option::future",display:"Allow future",tag:"boolean","null":!1,"default":!0}],r=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),i=[{name:"data_option::past",display:"Allow past",tag:"boolean","null":!1,"default":!0}],o=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),i=[{name:"data_option::diff",display:"Default time Diff (minutes)",tag:"integer","null":!1,"default":24}],s=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),t.find(".js-datetimeFuture").html(r.form),t.find(".js-datetimePast").html(o.form),t.find(".js-datetimeDiff").html(s.form)},e.date=function(t,e,n){var i,s;return i=[{name:"data_option::diff",display:"Default time Diff (hours)",tag:"integer","null":!1,"default":24}],s=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),t.find(".js-dateDiff").html(s.form)},e.integer=function(t,e,n){var i,s,r,o;return i=[{name:"data_option::default",display:"Default",tag:"integer","null":!0,"default":"",min:1}],s=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),i=[{name:"data_option::min",display:"Minimal",tag:"integer","null":!1,"default":0,min:1}],o=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),i=[{name:"data_option::max",display:"Maximal",tag:"integer","null":!1,"default":999999999,min:2}],r=new App.ControllerForm({model:{configure_attributes:i},noFieldset:!0,params:n}),t.find(".js-integerDefault").html(s.form),t.find(".js-integerMin").html(o.form),t.find(".js-integerMax").html(r.form)},e.select=function(o,t,e){var n,i,s;return o.find(".js-add").on("click",function(t){var e,n,i,s,r;return n=(e=$(t.target).closest("tr")).find(".js-key").val(),r=e.find(".js-value").val(),e.find(".js-selected[value]").attr("value",n),s=e.find(".js-selected").prop("checked"),(i=o.find(".js-template").clone().removeClass("js-template")).find(".js-key").val(n),i.find(".js-value").val(r),i.find(".js-value[value]").attr("name","data_option::options::"+n),i.find(".js-selected").prop("checked",s),i.find(".js-selected").val(n),i.find(".js-selected").attr("name","data_option::default"),o.find(".js-Table tr").last().before(i),e.find(".js-key").val(""),e.find(".js-value").val(""),e.find(".js-selected").prop("checked",!1)}),o.on("change",".js-key",function(t){var e;return e=$(t.target).val(),$(t.target).closest("tr").find(".js-value[name]").attr("name","data_option::options::"+e)}),o.on("click",".js-remove",function(t){return $(t.target).closest("tr").remove()}),s=void 0,o.on("click",".js-selected",function(t){var e,n;return e=$(t.target).prop("checked"),n=$(t.target).attr("value"),e&&s&&s===n?($(t.target).prop("checked",!1),void(s=!1)):s=n}),n=[{name:"data_option::linktemplate",display:"Link-Template",tag:"input",type:"text","null":!0,"default":"",placeholder:"https://example.com/?q=#{ticket.attribute_name}"}],i=new App.ControllerForm({model:{configure_attributes:n},noFieldset:!0,params:e}),o.find(".js-inputLinkTemplate").html(i.form)},e.buildRow=function(t,e,n,i){var s,r,o,a,l,c;if(null==n&&(n=0),(o=t.find(".js-template").clone().removeClass("js-template")).find(".js-key").attr("level",n),o.find(".js-key").val(e.name),o.find("td").first().css("padding-left",20*n+10+"px"),5===n&&o.find(".js-addChild").addClass("hide"),i)i.after(o);else if(t.find(".js-treeTable").append(o),e.children){for(l=[],s=0,r=(a=e.children).length;s<r;s++)c=a[s],l.push(this.buildRow(t,c,n+1));return l}},e.tree_select=function(i,t,e){var n,s,r,o,a,l,c;if(e.data_option||(e.data_option={}),(n=e.data_option).options||(n.options=[]),_.isEmpty(e.data_option.options))this.buildRow(i,{});else for(r=0,o=(a=e.data_option.options).length;r<o;r++)s=a[r],this.buildRow(i,s);return i.on("click",".js-addRow",(l=this,function(t){var e,n;return t.stopPropagation(),t.preventDefault(),e=$(t.currentTarget).closest("tr"),n=parseInt(e.find(".js-key").attr("level")),l.buildRow(i,{},n,e)})),i.on("click",".js-addChild",(c=this,function(t){var e,n;return t.stopPropagation(),t.preventDefault(),e=$(t.currentTarget).closest("tr"),n=parseInt(e.find(".js-key").attr("level"))+1,c.buildRow(i,{},n,e)})),i.on("click",".js-remove",function(t){var e,n,i,s,r,o,a,l;for(t.stopPropagation(),t.preventDefault(),t.stopPro,e=$(t.target).closest("tr"),r=parseInt(e.find(".js-key").attr("level")),l=0,n=[o=e];(o=o.next()).get(0)&&!(parseInt(o.find(".js-key").attr("level"))<=r);)l+=1,n.push(o);if(0===l||confirm("Delete "+l+" sub elements?")){for(a=[],i=0,s=n.length;i<s;i++)e=n[i],a.push(e.remove());return a}})},e["boolean"]=function(t){var i;return i=void 0,t.on("click",".js-selected",function(t){var e,n;return e=$(t.target).prop("checked"),n=$(t.target).attr("value"),e&&i&&i===n?($(t.target).prop("checked",!1),void(i=!1)):i=n})},e.autocompletion=function(t,e,n){var i,s,r,o;return o=[{name:"data_option::default",display:"Default",tag:"input",type:"text","null":!0,"default":""}],i=new App.ControllerForm({model:{configure_attributes:o},noFieldset:!0,params:n}),o=[{name:"data_option::url",display:"Url (AJAX Endpoint)",tag:"input",type:"url","null":!1,"default":"",placeholder:"https://example.com/serials"}],r=new App.ControllerForm({model:{configure_attributes:o},noFieldset:!0,params:n}),o=[{name:"data_option::method",display:"Method (AJAX Endpoint)",tag:"input",type:"url","null":!1,"default":"",placeholder:"GET"}],s=new App.ControllerForm({model:{configure_attributes:o},noFieldset:!0,params:n}),t.find(".js-autocompletionDefault").html(i.form),t.find(".js-autocompletionUrl").html(r.form),t.find(".js-autocompletionMethod").html(s.form)},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.permission=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e){var n,i,s,r,o,a,l,c,p,u,h,d;for(null==e&&(e={}),u=App.Permission.search({sortBy:"name"}),i=[],r={},o=0,c=(s=App.Group.search({sortBy:"name"})).length;o<c;o++)if((n=s[o]).active&&(i.push(n),e.group_ids))for(l=0,p=(h=e.group_ids).length;l<p;l++)h[l].toString()===n.id.toString()&&(r[n.id]=!0);return(a=$(App.view("generic/permission")({attribute:t,params:e,permissions:u,groups:i,groupsSelected:r,groupAccesses:App.Group.accesses()}))).find("[name=permission_ids]").bind("change",(d=this,function(t){return d.checkUncheck($(t.currentTarget),u,a)})),a.find("[name=permission_ids]").trigger(
"change"),a},e.checkUncheck=function(t,e,n){var i,s,r,o,a,l,c,p,u,h,d,f,m;if(i=t.prop("checked"),(h=t.prop("value"))&&(u=App.Permission.find(h))){if(!u.name.match(/\./))for(s=0,o=e.length;s<o;s++)c=e[s],f=new RegExp("^"+u.name),c.name.match(f)&&(l=n.find("[name=permission_ids][value="+c.id+"]").closest(".js-subPermissionList"),i?l.addClass("hide"):l.removeClass("hide"));if(i&&u.preferences.not){for(m=[],r=0,a=(d=u.preferences.not).length;r<a;r++)c=d[r],(p=App.Permission.findByAttribute("name",c))?m.push(n.find("[name=permission_ids][value="+p.id+"]").prop("checked",!1)):m.push(void 0);return m}}},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){App.UiElement.postmaster_match=function(){function t(){}return t.defaults=function(){return{general:{name:"Basic Settings",options:[{value:"from",name:"From"},{value:"to",name:"To"},{value:"cc",name:"Cc"},{value:"x-any-recipient",name:"Any Recipient"},{value:"subject",name:"Subject"},{value:"body",name:"Body"}]},expert:{name:"Expert Settings",options:[{value:"x-spam",name:"X-Spam"},{value:"x-spam-flag",name:"X-Spam-Flag"},{value:"x-spam-level",name:"X-Spam-Level"},{value:"x-spam-score",name:"X-Spam-Score"},{value:"x-spam-status",name:"X-Spam-Status"},{value:"x-dspam-result",name:"X-DSPAM-Result"},{value:"x-dspam-confidence",name:"X-DSPAM-Confidence"},{value:"x-dspam-probability",name:"X-DSPAM-Probability"},{value:"x-dspam-signature",name:"X-DSPAM-Signature"},{value:"importance",name:"Importance"},{value:"x-priority",name:"X-Priority"},{value:"organization",name:"Organization"},{value:"x-original-to",name:"X-Original-To"},{value:"delivered-to",name:"Delivered-To"},{value:"envelope-to",name:"Envelope-To"},{value:"return-path",name:"Return-Path"},{value:"mailing-list",name:"Mailing-List"},{value:"list-id",name:"List-Id"},{value:"list-archive",name:"List-Archive"},{value:"message-id",name:"Message-Id"},{value:"in-reply-to",name:"In-Reply-To"},{value:"auto-submitted",name:"Auto-Submitted"},{value:"x-loop",name:"X-Loop"}]}}},t.render=function(s,t){var e,n,i,r,o,a,l,c,p,u,h,d,f,m,g;if(null==t&&(t={}),r=this.defaults(),u=this.buildAttributeSelector(r,s),(o=$(App.view("generic/postmaster_match")({attribute:s}))).find(".js-attributeSelector").prepend(u),o.find(".js-add").bind("click",function(t){var e,n;return n=(e=$(t.target).closest(".js-filterElement")).clone(!0),e.after(n),n.find(".js-attributeSelector select").trigger("change")}),o.find(".js-remove").bind("click",(f=this,function(t){if(!$(t.currentTarget).hasClass("is-disabled"))return $(t.target).closest(".js-filterElement").remove(),f.rebuildAttributeSelectors(o)})),o.find(".js-attributeSelector select").bind("change",(m=this,function(t){var e,n;return n=$(t.target).find("option:selected").attr("value"),e=$(t.target).closest(".js-filterElement"),m.rebuildAttributeSelectors(o,e,n,s),m.rebuildOperater(o,e,n,r,void 0,s),m.buildValue(o,e,n,r,void 0,void 0,s)})),o.find(".js-operator select").bind("change",(g=this,function(t){var e,n,i;return n=$(t.target).find(".js-attributeSelector option:selected").attr("value"),i=$(t.target).find("option:selected").attr("value"),e=$(t.target).closest(".js-filterElement"),g.buildValue(o,e,n,r,void 0,i,s)})),_.isEmpty(t[s.name]))o.find(".js-filterElement .js-attributeSelector select").trigger("change");else{for(a in h=!1,p=t[s.name])h=!0,c=(l=p[a]).operator,d=l.value,n=o.find(".js-filterElement").first(),i=o.find(".js-filterElement").last(),e=n.clone(!0),this.rebuildAttributeSelectors(o,e,a,s),this.rebuildOperater(o,e,a,r,c,s),this.buildValue(o,e,a,r,d,c,s),i.after(e);o.find(".js-attributeSelector select").trigger("change"),h&&o.find(".js-filterElement").first().remove()}return o},t.buildValue=function(t,e,n,i,s,r,o){var a,l,c;if(c=o.name+"::"+n+"::value",!e.find('[name="'+c+'"]').get(0))return a={name:c,tag:"input",type:"text",value:s},l=App.UiElement[a.tag].render(a,{}),e.find(".js-value").html(l)},t.buildAttributeSelector=function(t){var e,n,i,s,r,o,a,l,c;for(i in c=$('<select class="form-control"></select>'),t)for(s=t[i],e=App.i18n.translateInline(s.name),c.closest("select").append('<optgroup label="'+e+'" class="js-'+i+'"></optgroup>'),a=c.find("optgroup.js-"+i),r=0,o=(l=s.options).length;r<o;r++)n=l[r],e=App.i18n.translateInline(n.name),a.append('<option value="'+n.value+'">'+e+"</option>");return c},t.rebuildAttributeSelectors=function(e,t,n){if(e.find(".js-attributeSelector select option").removeAttr("disabled"),e.find(".js-attributeSelector select").each(function(){var t;return t=$(this).val(),e.find('.js-attributeSelector select option[value="'+t+'"]').attr("disabled",!0)}),1<e.find(".js-attributeSelector select").length?e.find(".js-remove").removeClass("is-disabled"):e.find(".js-remove").addClass("is-disabled"),n)return t.find(".js-attributeSelector select").val(n)},t.buildOperator=function(t,e,n,i,s,r){var o,a,l,c,p,u,h;for(h=$('<select class="form-control" name="'+r.name+"::"+n+'::operator"></select>'),o=0,a=(p=["contains","contains not"]).length;o<a;o++)l=p[o],c=App.i18n.translateInline(l),u="",s===l&&(u='selected="selected"'),h.append('<option value="'+l+'" '+u+">"+c+"</option>");return h},t.rebuildOperater=function(t,e,n,i,s,r){var o,a;if(n&&(o=r.name+"::"+n+"::operator",!e.find('[name="'+o+'"]').get(0)))return a=this.buildOperator(t,e,n,i,s,r),e.find(".js-operator select").replaceWith(a)},t}()}.call(this),function(){App.UiElement.postmaster_set=function(){function t(){}return t.defaults=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b;for(i in e={},r={ticket:{name:"Ticket",model:"Ticket",options:[{value:"priority_id",name:"Priority",relation:"TicketPriority"},{value:"state_id",name:"State",relation:"TicketState"},{value:"tags",name:"Tag",tag:"tag"},{value:"customer_id",name:"Customer",relation:"User",tag:"user_autocompletion",disableCreateObject:!0},{value:"group_id",name:"Group",relation:"Group"},{value:"owner_id",name:"Owner",relation:"User",tag:"user_autocompletion",disableCreateObject:!0}]},article:{name:"Article",options:[{value:"x-zammad-article-internal",name:"Internal",options:{"true":"yes","false":"no"}},{value:"x-zammad-article-type_id",name:"Type",relation:"TicketArticleType"},{value:"x-zammad-article-sender_id",name:"Sender",relation:"TicketArticleSender"}]},expert:{name:"Expert",options:[{value:"x-zammad-ignore",name:"Ignore Message",options:{"true":"yes","false":"no"}}]}})if((s=r[i]).model&&App[s.model])for(o=0,u=(m=App[s.model].configure_attributes).length;o<u;o++)"password"!==(b=m[o]).type&&"_ids"!==b.name.substr(b.name.length-4,4)&&(b.readonly||("tag"===(t=_.clone(b)).tag&&(t.operator=["add","remove"]),e["x-zammad-ticket-"+t.name]=t));for(l=0,h=(g=App.Ticket.configure_attributes).length;l<h;l++){for(b=g[l],n=!1,c=0,d=(v=r.ticket.options).length;c<d;c++)(a=v[c]).value===b.name?n=!0:"datetime"!==b.tag&&"date"!==b.tag&&"tag"!==b.tag||(n=!0);n||"password"===b.type||"_ids"===b.name.substr(b.name.length-4,4)||b.readonly||(a={value:b.name,name:b.display,relation:b.relation,tag:b.tag,options:b.options},r.ticket.options.push(a))}for(p=0,f=(y=r.ticket.options).length;p<f;p++)(a=y[p]).value="x-zammad-ticket-"+a.value;return[e,r]},t.placeholder=function(t,e,n,i){var s,r;return null==n&&(n={}),s=$(App.view("generic/postmaster_set_row")({attribute:e})),r=this.buildAttributeSelector(t,i,e,s),s.find(".js-attributeSelector").prepend(r),s},t.render=function(i,s){var t,r,e,o,a,n,l,c,p,u,h,d,f,m;if(null==s&&(s={}),p=this.defaults(),r=p[0],o=p[1],(a=$(App.view("generic/postmaster_set")({attribute:i}))).on("click",".js-add",(d=this,function(t){var e,n;return e=$(t.target).closest(".js-filterElement"),n=d.placeholder(a,i,s,o),e.get(0)?e.after(n):a.append(n),n.find(".js-attributeSelector select").trigger("change")})),a.on("click",".js-remove",(f=this,function(t){if(!$(t.currentTarget).hasClass("is-disabled"))return $(t.target).closest(".js-filterElement").remove(),f.rebuildAttributeSelectors(a)})),a.on("change",".js-attributeSelector select",(m=this,function(t){var e,n;return n=(e=$(t.target).closest(".js-filterElement")).find(".js-attributeSelector option:selected").attr("value"),m.rebuildAttributeSelectors(a,e,n,i),m.buildOperator(a,e,n,r,{},i),m.buildValue(a,e,n,o,void 0,void 0,i)})),_.isEmpty(s[i.name]))return t=this.placeholder(a,i,s,o),a.append(t),e=t.find(".js-attributeSelector option:selected").attr("value"),this.rebuildAttributeSelectors(a,t,e,i),this.buildOperator(a,t,e,r,{},i),this.buildValue(a,t,e,o,void 0,void 0,i),a;for(n in u=s[i.name])c=(l=u[n]).operator,h=l.value,e=(t=this.placeholder(a,i,s,o)).find(".js-attributeSelector option:selected").attr("value"),this.rebuildAttributeSelectors(a,t,n,i),this.buildOperator(a,t,n,r,{},i),this.buildValue(a,t,n,o,h,c,i),a.append(t);return a.find(".js-attributeSelector select").trigger("change"),a},t.buildValue=function(t,e,n,i,s,r,o){var a,l,c,p,u,h,d,f;if(d=o.name+"::"+n+"::value",!e.find('[name="'+d+'"]').get(0)){for(c in a={},i)for(p=0,h=(f=i[c].options).length;p<h;p++)(l=f[p]).value===n&&(a=clone(l));return a.tag||(a.relation||a.options?a.tag="select":(a.tag="input",a.type="text")),a.name=d,a.value=s,u=App.UiElement[a.tag].render(a,{}),e.find(".js-value").html(u)}},t.buildAttributeSelector=function(t,e){var n,i,s,r,o,a,l,c,p,u,h;for(s in u="",t.find(".js-attributeSelector select option").each(function(){if(!u&&!$(this).prop("disabled"))return u=$(this).val()}),h=$('<select class="form-control"></select>'),e)for(r=e[s],n=App.i18n.translateInline(r.name),h.closest("select").append('<optgroup label="'+n+'" class="js-'+s+'"></optgroup>'),l=h.find("optgroup.js-"+s),o=0,a=(c=r.options).length;o<a;o++)i=c[o],n=App.i18n.translateInline(i.name),p="",i.value===u&&(p='selected="selected"'),l.append('<option value="'+i.value+'" '+p+">"+n+"</option>");return h},t.rebuildAttributeSelectors=function(e,t,n){if(e.find(".js-attributeSelector select option").removeAttr("disabled"),e.find(".js-attributeSelector select").each(function(){var t;return t=$(this).val(),e.find('.js-attributeSelector select option[value="'+t+'"]').attr("disabled",!0)}),1<e.find(".js-attributeSelector select").length?e.find(".js-remove").removeClass("is-disabled"):e.find(".js-remove").addClass("is-disabled"),n)return t.find(".js-attributeSelector select").val(n)},t.buildOperator=function(t,e,n,i,s,r){var o,a,l,c,p,u,h,d,f,m;if(a=e.find(".js-operator option:selected").attr("value"),s.operator||(s.operator=a),p=r.name+"::"+n+"::operator",m=$('<select class="form-control" name="'+p+'"></select>'),(o=i[n])&&o.operator?e.find(".js-operator").removeClass("hide"):e.find(".js-operator").addClass("hide"),o&&o.operator)for(l=0,c=(d=o.operator).length;l<c;l++)u=d[l],h=App.i18n.translateInline(u),f="",s.operator===u&&(f='selected="selected"'),m.append('<option value="'+u+'" '+f+">"+h+"</option>");return e.find(".js-operator select").replaceWith(m)},t}()}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.radio=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.template_name="radio",e.render=function(t,e){return this.getConfigOptionList(t,e),this.getRelationOptionList(t,e),this.addNullOption(t,e),this.sortOptions(t,e),this.selectedOptions(t,e),this.disabledOptions(t,e),this.filterOption(t,e),$(App.view("generic/"+this.template_name)({attribute:t}))},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.radio_graphic=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.template_name="radio_graphic",e}(App.UiElement.radio)}.call(this),function(){App.UiElement.richtext=function(){function t(){}return t.render=function(t,e,n){var o,i,a,s,r,l,c,p,u,h,d,f,m,g,v,y,b,w;if(_.isObject(t.value)&&(t.attachments=t.value.attachments,t.value=t.value.text),a=$(App.view("generic/richtext")({attribute:t,toolButtons:this.toolButtons})),this.contenteditable=a.find("[contenteditable]").ce({mode:t.type,maxlength:t.maxlength,buttons:t.buttons}),a.find("a.btn--action[data-action]").click((v=this,function(t){return v.toolButtonClicked(t,n)})),t.plugins)for(i=0,l=(h=t.plugins).length;i<l;i++)(e=(u=h[i]).params||{}).el=a.find("[contenteditable]").parent(),new App[u.controller](e);if(t.upload){if(this.attachments=[],a.append($(App.view("generic/attachment")({attribute:t}))),w=this,m=function(t){return a.find(".attachments").append(App.view("generic/attachment_item")(t)),w.attachments.push(t)},e&&e.attachments)for(s=0,c=(d=e.attachments).length;s<c;s++)o=d[s],m(o);if(t.attachments)for(r=0,p=(f=t.attachments).length;r<p;r++)o=f[r],m(o);App.Event.bind("ui::ticket::addArticleAttachent",function(t){var e,n,i,s,r;if(e=a.closest("form").find("[name=form_id]").val(),t.form_id===e&&!_.isEmpty(t.attachments)){for(r=[],n=0,i=(s=t.attachments).length;n<i;n++)o=s[n],r.push(m(o));return r}},n.form_id),a.find(".attachments").on("click",".js-delete",(b=this,function(t){var e,n,i;if(i=$(t.currentTarget).data("id"),b.attachments=_.filter(b.attachments,function(t){if(t.id.toString()!==i.toString())return t}),n=a.closest("form").find("[name=form_id]").val(),App.Ajax.request({type:"DELETE",url:App.Config.get("api_path")+"/upload_caches/"+n+"/items/"+i,processData:!1}),e=$(t.currentTarget).closest(".attachments"),$(t.currentTarget).closest(".attachment").remove(),0===e.find(".attachment").length)return e.empty()})),this.progressBar=a.find(".attachmentUpload-progressBar"),this.progressText=a.find(".js-percentage"),this.attachmentPlaceholder=a.find(".attachmentPlaceholder"),this.attachmentUpload=a.find(".attachmentUpload"),this.attachmentsHolder=a.find(".attachments"),this.cancelContainer=a.find(".js-cancel"),y=this,g=function(){return html5Upload.initialize({uploadUrl:App.Config.get("api_path")+"/attachments",dropContainer:a.closest("form").get(0),cancelContainer:y.cancelContainer,inputField:a.find("input").get(0),maxSimultaneousUploads:1,key:"File",data:{form_id:a.closest("form").find("[name=form_id]").val()},onFileAdded:function(t){return t.on({onStart:function(){return y.attachmentPlaceholder.addClass("hide"),y.attachmentUpload.removeClass("hide"),y.cancelContainer.removeClass("hide"),a.find("[contenteditable]").trigger("fileUploadStart"),App.Log.debug("UiElement.richtext","upload start")},onAborted:function(){return y.attachmentPlaceholder.removeClass("hide"),y.attachmentUpload.addClass("hide"),a.find("input").val(""),a.find("[contenteditable]").trigger("fileUploadStop",["aborted"])},onCompleted:function(t){return t=JSON.parse(t),y.attachmentPlaceholder.removeClass("hide"),y.attachmentUpload.addClass("hide"),y.progressBar.width(parseInt(0)+"%"),y.progressText.text(""),m(t.data),a.find("input").val(""),a.find("[contenteditable]").trigger("fileUploadStop",["completed"]),App.Log.debug("UiElement.richtext","upload complete",t.data)},onProgress:function(t){return y.progressBar.width(parseInt(t)+"%"),y.progressText.text(parseInt(t)),90<=parseInt(t)&&y.cancelContainer.addClass("hide"),App.Log.debug("UiElement.richtext","uploadProgress ",parseInt(t))}})}})},App.Delay.set(g,100,void 0,"form_upload")}return a},t.toolButtonClicked=function(t,e){var n,i;return n=$(t.currentTarget).data("action"),null!=(i=this.toolButtons[n])?i.onClick(t,e):void 0},t.toolButtons={},t.additions={},t.allDirectionalSiblings=function(t,e,n){var i,s,r;if(null==n&&(n=null),null==t)return[];for(s=[],i=t;(r=App.UiElement.richtext.directionalSibling(i,e))&&(i=r,null==n||r!==n);)s.push(r);return s},t.directionalSibling=function(t,e){return 0<e?t.nextSibling:t.previousSibling},t.buildParentsList=function(t,e){return $(t).parentsUntil(e).toArray()},t.buildParentsListWithSelf=function(t,e){var n;return(n=App.UiElement.richtext.buildParentsList(t,e)).unshift(t),n},t}()}.call(this),function(){App.UiElement.richtext.additions.RichTextToolButton=function(){function t(){}return t.icon=void 0,t.text=void 0,t.klass=function(){},t.pickExisting=function(){},t.initializeAttributes={},t.instantiateContent=function(t,e,n){var i;return(i=$.extend(!0,{},this.initializeAttributes)).event=t,i.selection=e,i.container=$(t.currentTarget).closest(".content"),i.delegate=n,new(this.klass())(i).el},t.popoverAttributes=function(t,e,n){return{trigger:"manual",backdrop:!0,html:!0,animation:!1,delay:0,placement:"auto right",theme:"dark",content:this.instantiateContent(t,e,n),container:"body",template:'<div class="popover popover--has-horizontal-form" role="tooltip"><div class="arrow"></div><h2 class="popover-title"></h2><div class="popover-content"></div></div>'}},t.closeOtherPopovers=function(t){return $(t.currentTarget).closest(".richtext-controls").find(".btn").toArray().filter(function(t){return $(t).attr("aria-describedby")}).forEach(function(t){return $(t).popover("hide")})},t.selectionSnapshot=function(t){var e,n;return n=$(event.currentTarget).closest(".richtext.form-control").find("[contenteditable]"),(e=this.pickExisting(t,n))?{type:"existing",dom:$(e)}:"Range"===t.type&&$(t.anchorNode).closest("[contenteditable]",n)[0]?(t.getRangeAt(0),{type:"range",range:t.getRangeAt(0)}):$(t.anchorNode).closest("[contenteditable]",n)[0]&&!$(t.anchorNode).is("[contenteditable]")?{type:"caret",dom:$(t.anchorNode),offset:t.anchorOffset}:{type:"append",dom:n}},t.onClick=function(t,e){var n,i;if(t.stopPropagation(),t.preventDefault(),!$(t.currentTarget).attr("aria-describedby"))return this.closeOtherPopovers(t),$(t.currentTarget).closest(".richtext.form-control").find("[contenteditable]"),n=document.getSelection(),i=this.selectionSnapshot(n),n.removeAllRanges(),$(t.currentTarget).popover(this.popoverAttributes(t,i,e)).popover("show");$(t.currentTarget).popover("hide")},t}()}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.richtext.additions.RichTextToolButtonLink=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.pickLinkInSingleContainer=function(t,e){var n,i;return"A"===t.nodeName?t:(i=$(t).find("a")[0])?i:e&&(n=$(t).closest("a",e)[0])?n:null},e.pickLinkAt=function(t,e,n,i){var s,r,o,a,l,c,p,u;for(null==i&&(i=null),s=0,o=(p=App.UiElement.richtext.buildParentsListWithSelf(t,e)).length;s<o;s++){if("A"===(c=p[s]).nodeName)return c;for(r=0,a=(u=App.UiElement.richtext.allDirectionalSiblings(c,n,i)).length;r<a;r++)if(t=u[r],l=this.pickLinkInSingleContainer(t))return l}return null},e.pickExisting=function(t,e){var n,i,s,r,o,a,l;if(t.isCollapsed&&(r=$(t.anchorNode).closest("a")[0]))return r;if(t.isCollapsed)return null;if((o=t.getRangeAt(0)).startContainer===o.endContainer)return this.pickLinkInSingleContainer(o.startContainer,e);if(r=this.pickLinkAt(o.startContainer,o.commonAncestorContainer,1,o.endContainer))return r;if(l=App.UiElement.richtext.buildParentsList(o.startContainer,o.commonAncestorContainer).pop())for(i=0,s=(a=App.UiElement.richtext.allDirectionalSiblings(l,1,o.endContainer)).length;i<s;i++)if(n=a[i],r=this.pickLinkInSingleContainer(n))return r;return(r=this.pickLinkAt(o.endContainer,o.commonAncestorContainer,-1))?r:null},e}(App.UiElement.richtext.additions.RichTextToolButton)}.call(this),function(){var a=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.richtext.additions.RichTextToolPopup=function(t){function o(t){var e,n,i,s,r;this.onClear=a(this.onClear,this),"existing"===t.selection.type?(t.selection.dom.attr("href"),s=this.labelExisting,e=[{className:"btn btn--danger js-clear",text:this.labelClear}]):s=this.labelNew,n={params:this.formParams(t),fullForm:!0,formClass:"form--horizontal",fullFormSubmitLabel:s,fullFormSubmitAdditionalClasses:"btn--create",fullFormAdditionalButtons:e,autofocus:!0,model:{configure_attributes:[]}},i=$.extend(!0,{},n,t),o.__super__.constructor.call(this,i),this.didInitialize(),$(this.event.currentTarget).on("hidden.bs.popover",(r=this,function(t){return r.willClose(t)}))}return e(o,t),o.prototype.events={"submit form":"onSubmit","click .js-clear":"onClear"},o.prototype.labelNew="Link",o.prototype.labelExisting="Update",o.prototype.labelClear="Remove",o.prototype.formParams=function(){},o.prototype.getAjaxAttributes=function(t,e){var n;return null!=(n=this.delegate)&&"function"==typeof n.getAjaxAttributes?n.getAjaxAttributes(t,e):void 0},o.prototype.onClear=function(t){return t.preventDefault(),t.stopPropagation(),this.clear(),$(this.event.currentTarget).popover("hide")},o.prototype.clear=function(){},o.wrapElement=function(t,e){var n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,_,w,k,T,A,S,C,x,j;if(x=(j=App.UiElement.richtext.buildParentsList(e.range.startContainer,e.range.commonAncestorContainer).reverse()).shift()){for(b=s=x.cloneNode(!1),a=0,u=j.length;a<u;a++){for(n=(_=j[a]).cloneNode(!1),b.append(n),l=0,h=(w=App.UiElement.richtext.allDirectionalSiblings(_,1)).length;l<h;l++)r=w[l],b.append(r.cloneNode(!0));b=n}for(S=e.range.startContainer.cloneNode(!0).splitText(e.range.startOffset),b.append(S),t.append(s),c=0,d=(k=App.UiElement.richtext.allDirectionalSiblings(e.range.startContainer,1)).length;c<d;c++)r=k[c],b.append(r.cloneNode(!0))}else x=e.range.startContainer,S=e.range.startContainer.cloneNode(!0).splitText(e.range.startOffset),t.append(S);for(p=0,f=(T=App.UiElement.richtext.allDirectionalSiblings(x,1,e.range.endContainer)).length;p<f;p++)r=T[p],t.append(r.cloneNode(!0));if(C=(j=App.UiElement.richtext.buildParentsList(e.range.endContainer,e.range.commonAncestorContainer).reverse()).shift()){for(b=i=C.cloneNode(!1),v=0,m=j.length;v<m;v++){for(n=(_=j[v]).cloneNode(!1),b.append(n),y=0,g=(A=App.UiElement.richtext.allDirectionalSiblings(_,-1)).length;y<g;y++)r=A[y],b.prepend(r.cloneNode(!0));b=n}(o=e.range.endContainer.cloneNode(!0)).splitText(e.range.endOffset),b.append(o),t.append(i)}else(o=e.range.endContainer.cloneNode(!0)).splitText(e.range.endOffset),t.append(o);return document.getSelection().removeAllRanges(),document.getSelection().addRange(e.range),document.getSelection().deleteFromDocument(),document.getSelection().removeAllRanges(),t.insertAfter(x)},o.prototype.apply=function(t){return t()},o.prototype.onSubmit=function(t){return t.preventDefault(),this.apply((e=this,function(){return $(e.event.currentTarget).popover("destroy")}));var e},o.prototype.didInitialize=function(){var t,e;switch(this.selection.type){case"existing":return this.selection.dom.addClass("highlight-emulator");case"range":return t=$("<span>").addClass("highlight-emulator"),this.selection.range.startContainer===this.selection.range.endContainer?(this.selection.range.startContainer.splitText(this.selection.range.endOffset),e=this.selection.range.startContainer.splitText(this.selection.range.startOffset),$(e).wrap(t)):this.constructor.wrapElement(t,this.selection)}},o.prototype.willClose=function(t){switch(this.selection.type){case"existing":this.selection.dom.removeClass("highlight-emulator");break;case"range":$(this.event.currentTarget).closest(".richtext.form-control").find("[contenteditable]").find("span.highlight-emulator").contents().unwrap()}return $(this.event.currentTarget).off("hidden.bs.popover"),$(t.currentTarget).popover("destroy")},o}(App.ControllerForm)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.richtext.toolButtons.embed_video=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.icon="cloud",e.text="Video",e.klass=function(){return App.UiElement.richtext.additions.RichTextToolPopupVideo},e.initializeAttributes={model:{configure_attributes:[{name:"link",display:"Link",tag:"input",placeholder:"Youtube or Vimeo address"}]}},e.pickExisting=function(t,e){var n,i,s,r,o,a,l,c,p;if(s=i=l=a=null,e[0].contains(t.anchorNode)){for((c=document.createTreeWalker(e[0])).currentNode=t.anchorNode;!a&&("#text"===c.currentNode.nodeName||"SPAN"===c.currentNode.nodeName)&&c.currentNode;)c.currentNode instanceof Text&&(r=c.currentNode.textContent.indexOf("(")),null!=r&&-1<r&&(a=c.currentNode,l=r),c.previousNode();for(c.currentNode=t.anchorNode;!i&&("#text"===c.currentNode.nodeName||"SPAN"===c.currentNode.nodeName)&&c.currentNode;)c.currentNode instanceof Text&&(r=c.currentNode.textContent.indexOf(")")),null!=r&&-1<r&&(c.currentNode!==t.anchorNode||l<r)&&(i=c.currentNode,s=r+1),c.nextNode();return a&&i?((o=document.createRange()).setStart(a,l),o.setEnd(i,s),n=o.cloneContents(),(p=document.createElement("span")).append(n),o.deleteContents(),o.insertNode(p),p):void 0}},e}(App.UiElement.richtext.additions.RichTextToolButton)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.richtext.toolButtons.insert_image=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.icon="web",e.text="Image",e.klass=function(){return App.UiElement.richtext.additions.RichTextToolPopupImage},e.initializeAttributes={model:{configure_attributes:[{name:"link",display:"Image",tag:"input",type:"file"}]}},e.pickExisting=function(t,e){return e.find("img.objectResizingEditorActive")[0]},e}(App.UiElement.richtext.additions.RichTextToolButton)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.richtext.toolButtons.link_answer=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.icon="knowledge-base-answer",e.text="Link Answer",e.klass=function(){return App.UiElement.richtext.additions.RichTextToolPopupAnswer},e.initializeAttributes={model:{configure_attributes:[{name:"link",display:"Answer",relation:"KnowledgeBaseAnswerTranslation",tag:"autocompletion_ajax"}]}},e}(App.UiElement.richtext.additions.RichTextToolButtonLink)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.richtext.toolButtons.link=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.icon="chain",e.text="Weblink",e.klass=function(){return App.UiElement.richtext.additions.RichTextToolPopupLink},e.initializeAttributes={model:{configure_attributes:[{name:"link",display:"Link",tag:"input",placeholder:"http://"}]}},e}(App.UiElement.richtext.additions.RichTextToolButtonLink)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.richtext.additions.RichTextToolPopupAnswer=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.formParams=function(t){return{link:"existing"===t.selection.type&&"knowledge-base-answer"===t.selection.dom.attr("data-target-type")?t.selection.dom.attr("data-target-id"):void 0}},e.prototype.applyOnto=function(t,e,n){return null==n&&(n=null),t.attr("href",e.uiUrl("edit")).attr("data-target-id",e.id).attr("data-target-type","knowledge-base-answer"),null!=n&&t.text(n),t},e.prototype.apply=function(t){var e,n,i,s,r;switch(e=this.el.find("input").val(),i=App.KnowledgeBaseAnswerTranslation.find(e),r=$(this.event.currentTarget).closest(".richtext.form-control").find("[contenteditable]"),this.selection.type){case"existing":this.applyOnto(this.selection.dom,i);break;case"append":n=$("<a>"),this.applyOnto(n,i,i.title),this.selection.dom.append(n);break;case"caret":n=$("<a>"),this.applyOnto(n,i,i.title),this.selection.dom[0].splitText(this.selection.offset),n.insertAfter(this.selection.dom);break;case"range":s=r.find("span.highlight-emulator"),n=$("<a>"),this.applyOnto(n,i),s.wrap(n),s.contents()}return t()},e.prototype.clear=function(){switch(this.selection.type){case"existing":return $(this.selection.dom).contents().unwrap()}},e}(App.UiElement.richtext.additions.RichTextToolPopup)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.richtext.additions.RichTextToolPopupImage=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.labelNew="Insert",e.prototype.labelExisting="Replace",e.prototype.apply=function(t){var e,n,i;return this.el.find("btn--create").attr("disabled",!0),e=this.el.find("input")[0].files[0],(n=new FileReader).addEventListener("load",(i=this,function(){return i.insertImage(n.result),t()}),!1),n.readAsDataURL(e)},e.prototype.applyOnto=function(t,e){return t.attr("src",e)},e.prototype.insertImage=function(t){var e,n,i;switch(i=$(this.event.currentTarget).closest(".richtext.form-control").find("[contenteditable]"),this.selection.type){case"existing":return this.applyOnto(this.selection.dom,t);case"append":return(e=$("<img>")[0]).src=t,e.style="width: 1000px; max-width: 100%;",this.selection.dom.append(e);case"caret":return(e=$("<img>")).attr("src",t),e.attr("style","width: 1000px; max-width: 100%;"),this.selection.dom[0]instanceof Text&&this.selection.dom[0].splitText(this.selection.offset),e.insertAfter(this.selection.dom);case"range":return(e=$("<img>")).attr("src",t),e.attr("style","width: 1000px; max-width: 100%;"),(n=i.find("span.highlight-emulator")).empty(),n.append(e)}},e.prototype.clear=function(){switch(this.selection.type){case"existing":return this.selection.dom.closest(".enableObjectResizingShim").remove(),this.selection.dom.remove()}},e}(App.UiElement.richtext.additions.RichTextToolPopup)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.richtext.additions.RichTextToolPopupLink=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.formParams=function(t){return{link:"existing"===t.selection.type&&null==t.selection.dom.attr("data-target-type")?t.selection.dom.attr("href"):void 0}},e.prototype.applyOnto=function(t,e,n){return null==n&&(n=null),t.attr("href",e).removeAttr("data-target-id").removeAttr("data-target-type"),null!=n&&t.text(n),t},e.prototype.ensureProtocol=function(t){return(t=t.trim()).match(/^\S+\:\/\//)||"/"===t[0]?t:"http://"+t},e.prototype.apply=function(t){var e,n,i,s,r,o;switch(n=this.el.find("input").val(),o=this.ensureProtocol(n),r=$(this.event.currentTarget).closest(".richtext.form-control").find("[contenteditable]"),this.selection.type){case"existing":this.applyOnto(this.selection.dom,o);break;case"append":i=$("<a>"),this.applyOnto(i,o,n),this.selection.dom.append(i);break;case"caret":i=$("<a>"),this.applyOnto(i,o,n),"function"==typeof(e=this.selection.dom[0]).splitText&&e.splitText(this.selection.offset),i.insertAfter(this.selection.dom);break;case"range":s=r.find("span.highlight-emulator"),i=$("<a>"),this.applyOnto(i,o),s.wrap(i),s.contents()}return t()},e.prototype.clear=function(){switch(this.selection.type){case"existing":return $(this.selection.dom).contents().unwrap()}},e}(App.UiElement.richtext.additions.RichTextToolPopup)}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.richtext.additions.RichTextToolPopupVideo=function(t){function l(){return l.__super__.constructor.apply(this,arguments)}return e(l,t),l.prototype.labelNew="Insert",l.prototype.labelExisting="Replace",l.regexps={youtube:[/youtube.com\/watch\?v=([\w]+)/,/youtu.be\/([\w]+)/],vimeo:[/vimeo.com\/([\w]+)/]},l.detectProviderAndId=function(t){var e,n,i,s,r,o,a;if(t)for(i in null,s=l.regexps)for(e=0,n=(o=s[i]).length;e<n;e++)if(r=o[e],a=t.match(r))return[i,a[1]]},l.urlToMarkup=function(t){var e;if(
e=this.detectProviderAndId(t))return"( widget: video, provider: "+e[0]+", id: "+e[1]+" )"},l.prototype.apply=function(t){var e,n;if(e=this.el.find("input").val(),n=this.constructor.urlToMarkup(e))return this.insertVideo(n),t();new App.ControllerErrorModal({message:"Invalid video URL"})},l.prototype.insertVideo=function(t){var e,n,i;switch(i=$(this.event.currentTarget).closest(".richtext.form-control").find("[contenteditable]"),this.selection.type){case"existing":return this.selection.dom.text(t);case"append":return e=document.createTextNode(t),this.selection.dom.append(e);case"caret":return e=document.createTextNode(t),this.selection.dom[0]instanceof Text&&this.selection.dom[0].splitText(this.selection.offset),$(e).insertAfter(this.selection.dom);case"range":return e=document.createTextNode(t),(n=i.find("span.highlight-emulator")).empty(),n.append(e)}},l}(App.UiElement.richtext.additions.RichTextToolPopup)}.call(this),function(){App.UiElement.richtext_search=function(){function t(){}return t.render=function(t){return $(App.view("generic/input")({attribute:t}))},t}()}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.searchable_select=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e){return t.multiple?t.multiple="multiple":t.multiple="",this.getConfigOptionList(t,e),this.getRelationOptionList(t,e),this.addNullOption(t,e),this.sortOptions(t,e),this.selectedOptions(t,e),this.disabledOptions(t,e),this.filterOption(t,e),new App.SearchableSelect({attribute:t}).element()},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty,o=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};App.UiElement.select=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e,n){return null==n&&(n={}),t.multiple?t.multiple="multiple":t.multiple="",n.rejectNonExistentValues&&(t.rejectNonExistentValues=!0),this.addDeletedOptions(t,e),this.getConfigOptionList(t,e),this.getRelationOptionList(t,e),this.addNullOption(t,e),this.sortOptions(t,e),this.selectedOptions(t,e),this.disabledOptions(t,e),this.filterOption(t,e),$(App.view("generic/select")({attribute:t}))},e.addDeletedOptions=function(n){var i,s,e;if(_.isEmpty(n.relation)&&!n.rejectNonExistentValues&&(e=n.value)&&!_.isArray(e)&&n.options&&_.isObject(n.options)&&!(e in n.options||0<=o.call(function(){var t,e;for(i in e=[],t=n.options)r.call(t,i)&&(s=t[i],e.push(s));return e}(),e))){if(_.isArray(n.options)){if(e in n.options)return;if(null!==n.options.filter(function(t){return t.value===e}))return}else if(0<=o.call(function(){var t,e;for(i in e=[],t=n.options)r.call(t,i)&&(s=t[i],e.push(s));return e}(),e))return;return n.historical_options&&e in n.historical_options?n.options[e]=n.historical_options[e]:n.options[e]=e}},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.selectTicketAttributes=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e){var n,i,s,r,o;for(i in n=[],r=App.Ticket.attributesGet())"password"!==(o=r[i]).type&&"tag"!==o.type&&"tags"!==o.name&&(s=o.name,"_ids"===o.name.substr(o.name.length-4,4)?s=o.name.substr(0,o.name.length-4):"_id"===o.name.substr(o.name.length-3,3)&&(s=o.name.substr(0,o.name.length-3)),n.push({value:s,name:o.display}));return t.sortBy=null,t.options=n,App.UiElement.select.render(t,e)},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.select_search=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e){return t.multiple?t.multiple="multiple":t.multiple="",delete t.filter,this.getConfigOptionList(t,e),this.getRelationOptionList(t,e),this.addNullOption(t,e),this.sortOptions(t,e),this.selectedOptions(t,e),this.disabledOptions(t,e),this.filterOption(t,e),$(App.view("generic/select")({attribute:t}))},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){App.UiElement.sla_times=function(){function t(){}return t.render=function(t,e){var n,s;return null==e&&(e={}),e.id||e.first_response_time||(e.first_response_time=120),(n=$(App.view("generic/sla_times")({attribute:t,first_response_time:e.first_response_time,update_time:e.update_time,solution_time:e.solution_time,first_response_time_in_text:this.toText(e.first_response_time),update_time_in_text:this.toText(e.update_time),solution_time_in_text:this.toText(e.solution_time)}))).find(".js-timeConvertFrom").timepicker({maxHours:999}),n.find(".js-activateRow").bind("change",function(t){var e,n;return n=(e=$(t.target)).closest("tr"),e.prop("checked")?n.addClass("is-active"):(n.removeClass("is-active"),n.find(".js-timeConvertFrom").val(""),n.find(".js-timeConvertTo").val(""),n.find(".help-inline").empty(),n.removeClass("has-error"))}),n.find(".js-timeConvertFrom").bind("keyup focus blur",(s=this,function(t){var e,n,i;return n=(e=$(t.target)).val(),(i=e.closest("tr")).find(".js-activateRow").prop("checked",!0),i.addClass("is-active"),e.closest("td").find(".js-timeConvertTo").val(s.toMinutes(n)||"")})),n.find(".js-forward-click").bind("click",function(t){return $(t.currentTarget).closest("tr").find(".checkbox-replacement").click()}),n.find(".js-focus-input").bind("click",function(t){return $(t.currentTarget).find(".form-control").focus()}),n.find(".js-timeConvertFrom").bind("changeTime.timepicker",function(t){if("00:00"===$(t.currentTarget).val())return $(t.currentTarget).val("")}),n.find(".js-timeConvertFrom").each(function(){var t,e;return t=(e=$(this).closest("tr")).find(".js-activateRow"),$(this).val()?(t.prop("checked",!0),e.addClass("is-active")):t.prop("checked",!1)}),n},t.toMinutes=function(t){var e,n;if(t=t.split(":"),e=parseInt(t[0]),n=parseInt(t[1]),NaN!==e&&NaN!==n&&(0!==e||0!==n))return 60*e+n},t.toText=function(t){var e,n;if(t=parseInt(t))return(n=t%60)<10&&(n="0"+n),(e=Math.floor(t/60))<10&&(e="0"+e),e+":"+n},t}()}.call(this),function(){App.UiElement.tag=function(){function t(){}return t.render=function(t){var e,o,a,n;return t.id||(t.id="tag-"+(new Date).getTime()+"-"+Math.floor(999999*Math.random())),o=$(App.view("generic/input")({attribute:t})),n=App.Config.get("api_path")+"/tag_search",a={},e=function(){return $("#"+t.id).tokenfield({createTokensOnBlur:!0,autocomplete:{source:n,minLength:2,response:function(t,e){var n,i,s,r;if(e&&e.content){for(r=[],n=0,i=(s=e.content).length;n<i;n++)o=s[n],r.push(a[o.value]=!0);return r}}}}).on("tokenfield:createtoken",function(t){return!(!1===App.Config.get("tag_new")&&!a[t.attrs.value])||(t.preventDefault(),!1)}),$("#"+t.id).parent().css("height","auto")},App.Delay.set(e,500,void 0,"tags"),o},t}()}.call(this),function(){App.UiElement.textarea=function(){function t(){}return t.render=function(t){var e,n,i,s;return n="file-uploader-"+(new Date).getTime()+"-"+Math.floor(99999*Math.random()),i=$(App.view("generic/textarea")({attribute:t})+'<div class="file-uploader '+t["class"]+'" id="'+n+'"></div>'),e=function(){return $(i[0]).is(":visible")&&!$(i[0]).expanding("active")&&$(i[0]).expanding(),$(i[0]).on("focus",function(){if($(i[0]).is(":visible")&&!$(i[0]).expanding("active"))return $(i[0]).expanding().focus()})},App.Delay.set(e,80),t.upload&&(s=function(){var t;if($("#"+n)[0])return t=i.closest("form").find("[name=form_id]").val(),$("#"+n).fineUploader({request:{endpoint:App.Config.get("api_path")+"/upload_caches/"+t},text:{uploadButton:App.Utils.icon("paperclip")},template:'<div class="qq-uploader"><pre class="btn qq-upload-icon qq-upload-drop-area"><span>{dragZoneText}</span></pre><div class="btn btn-default qq-upload-icon2 qq-upload-button pull-right" style="">{uploadButtonText}</div><ul class="qq-upload-list span5" style="margin-top: 10px;"></ul></div>',customHeaders:{"X-CSRF-Token":App.Ajax.token()},classes:{success:"",fail:""},debug:!1})},App.Delay.set(s,100,void 0,"form_upload")),i},t}()}.call(this),function(){App.UiElement.ticket_perform_action=function(){function t(){}return t.defaults=function(t){var e,n,i,s,r,o,a,l,c,p;for(s in n=["ticket.state_id"],o={ticket:{name:"Ticket",model:"Ticket"},article:{name:"Article",model:"Article"}},t.notification&&(o.notification={name:"Notification",model:"Notification"}),i={},o)if((r=o[s]).model&&App[r.model])for(a=0,l=(c=App[r.model].configure_attributes).length;a<l;a++)"password"!==(p=c[a]).type&&"_ids"!==p.name.substr(p.name.length-4,4)&&(p.readonly||("tag"===(e=_.clone(p)).tag&&(e.operator=["add","remove"]),i[s+"."+e.name]=e));else"notification"===s?(i[s+".email"]={name:"email",display:"Email"},i[s+".sms"]={name:"sms",display:"SMS"}):"article"===s&&(i[s+".note"]={name:"note",display:"Note"});return t.ticket_delete&&(i["ticket.action"]={name:"action",display:"Action",tag:"select","null":!1,translate:!0,options:{"delete":"Delete"}}),[n,o,i]},t.placeholder=function(t,e,n,i,s){var r,o;return r=$(App.view("generic/ticket_perform_action/row")({attribute:e})),o=this.buildAttributeSelector(t,i,s),r.find(".js-attributeSelector").prepend(o),r},t.render=function(i,s){var t,e,r,n,o,a,l,c,p,u,h,d,f,m,g;if(null==s&&(s={}),t=(u=this.defaults(i))[0],o=u[1],r=u[2],(l=$(App.view("generic/ticket_perform_action/index")({attribute:i}))).on("click",".js-rowActions .js-add",(d=this,function(t){var e,n;return e=$(t.target).closest(".js-filterElement"),n=d.placeholder(l,i,s,o,r),e.get(0)?e.after(n):l.append(n),n.find(".js-attributeSelector select").trigger("change"),d.updateAttributeSelectors(l)})),l.on("click",".js-rowActions .js-remove",(f=this,function(t){if(!$(t.currentTarget).hasClass("is-disabled"))return $(t.target).closest(".js-filterElement").remove(),f.updateAttributeSelectors(l)})),l.on("change",".js-attributeSelector select",(m=this,function(t){var e,n;return n=(e=$(t.target).closest(".js-filterElement")).find(".js-attributeSelector option:selected").attr("value"),m.rebuildAttributeSelectors(l,e,n,r,{},i),m.updateAttributeSelectors(l)})),l.on("change",".js-operator select",(g=this,function(t){var e,n;return n=(e=$(t.target).closest(".js-filterElement")).find(".js-attributeSelector option:selected").attr("value"),g.buildOperator(l,e,n,r,{},i)})),_.isEmpty(s[i.name]))for(a=0,c=t.length;a<c;a++)n=t[a],e=this.placeholder(l,i,s,o,r),l.append(e),this.rebuildAttributeSelectors(l,e,n,r,{},i);else for(n in h=s[i.name])p=h[n],e=this.placeholder(l,i,s,o,r),this.rebuildAttributeSelectors(l,e,n,r,p,i),l.append(e);return this.disableRemoveForOneAttribute(l),l},t.buildAttributeSelector=function(t,e,n){var i,s,r,o,a,l,c,p,u;for(o in p="",t.find(".js-attributeSelector select option").each(function(){if(!p&&!$(this).prop("disabled"))return p=$(this).val()}),u=$('<select class="form-control"></select>'),e)for(r in a=e[o],s=App.i18n.translateInline(a.name),u.closest("select").append('<optgroup label="'+s+'" class="js-'+o+'"></optgroup>'),l=u.find("optgroup.js-"+o),n)n[r],r.split(/\./)[0]===o&&(i=n[r],s=App.i18n.translateInline(i.display),c="",r===p&&(c='selected="selected"'),l.append('<option value="'+r+'" '+c+">"+s+"</option>"));return u},t.disableRemoveForOneAttribute=function(t){return 1<t.find(".js-attributeSelector select").length?t.find(".js-remove").removeClass("is-disabled"):t.find(".js-remove").addClass("is-disabled")},t.updateAttributeSelectors=function(e){return e.find(".js-attributeSelector select option").removeAttr("disabled"),e.find(".js-attributeSelector select").each(function(){var t;return t=$(this).val(),e.find('.js-attributeSelector select option[value="'+t+'"]').attr("disabled",!0)}),this.disableRemoveForOneAttribute(e)},t.rebuildAttributeSelectors=function(t,e,n,i,s,r){var o,a,l,c,p;return n&&e.find(".js-attributeSelector select").val(n),p=n.match(/^notification.([\w]+)$/),a=n.match(/^article.([\w]+)$/),_.isArray(p)&&(c=p[1])?(e.find(".js-setAttribute").html("").addClass("hide"),e.find(".js-setArticle").html("").addClass("hide"),this.buildNotificationArea(c,t,e,n,i,s,r)):_.isArray(a)&&(o=a[1])?(e.find(".js-setAttribute").html("").addClass("hide"),e.find(".js-setNotification").html("").addClass("hide"),this.buildArticleArea(o,t,e,n,i,s,r)):(e.find(".js-setNotification").html("").addClass("hide"),e.find(".js-setArticle").html("").addClass("hide"),e.find(".js-setAttribute div").get(0)||(l=$(App.view("generic/ticket_perform_action/attribute_selector")({attribute:r,name:name,meta:s||{}})),e.find(".js-setAttribute").html(l).removeClass("hide")),this.buildOperator(t,e,n,i,s,r))},t.buildOperator=function(t,e,n,i,s,r){var o,a,l,c,p,u,h,d,f,m;if(a=e.find(".js-operator option:selected").attr("value"),s.operator||(s.operator=a),p=r.name+"::"+n+"::operator",m=$('<select class="form-control" name="'+p+'"></select>'),(o=i[n])&&o.operator?e.find(".js-operator").removeClass("hide"):e.find(".js-operator").addClass("hide"),o&&o.operator)for(l=0,c=(d=o.operator).length;l<c;l++)u=d[l],h=App.i18n.translateInline(u),f="",s.operator===u&&(f='selected="selected"'),m.append('<option value="'+u+'" '+f+">"+h+"</option>");return e.find(".js-operator select").replaceWith(m),this.buildPreCondition(t,e,n,i,s,r)},t.buildPreCondition=function(t,e,n,i,s,r){var o,a,l,c,p,u,h,d,f,m,g,v;if(e.find(".js-operator option:selected").attr("value"),l=e.find(".js-preCondition option:selected").attr("value"),s.pre_condition||(s.pre_condition=l),v=this,m=function(){return"specific"!==e.find(".js-preCondition option:selected").attr("value")?(e.find(".js-value select").html(""),e.find(".js-value").addClass("hide")):(e.find(".js-value").removeClass("hide"),v.buildValue(t,e,n,i,s,o))},p=(o=_.clone(r)).name+"::"+n+"::value",h=!1,"User"===(a=i[n]).relation&&(h="user",o.tag="user_autocompletion"),"Organization"===a.relation&&(h="org",o.tag="autocompletion_ajax"),!h)return e.find(".js-preCondition select").html(""),e.find(".js-preCondition").addClass("hide"),m(),void this.buildValue(t,e,n,i,s,o);for(c in e.find(".js-preCondition").removeClass("hide"),p=o.name+"::"+n+"::pre_condition",f=$('<select class="form-control" name="'+p+'" ></select>'),u={},"user"===h?u={"current_user.id":App.i18n.translateInline("current user"),specific:App.i18n.translateInline("specific user")}:"org"===h&&(u={"current_user.organization_id":App.i18n.translateInline("current user organization"),specific:App.i18n.translateInline("specific organization")}),u)g=u[c],d="",c===s.pre_condition&&(d='selected="selected"'),f.append('<option value="'+c+'" '+d+">"+App.i18n.translateInline(g)+"</option>");return e.find(".js-preCondition").removeClass("hide"),e.find(".js-preCondition select").replaceWith(f),e.find(".js-preCondition select").bind("change",function(){return m()}),this.buildValue(t,e,n,i,s,o),m()},t.buildValue=function(t,e,n,i,s,r){var o,a,l,c,p;return c=r.name+"::"+n+"::value",o=i[n],"User"===(a=_.clone(o)).relation&&(a.tag="user_autocompletion"),"Organization"===a.relation&&(a.tag="autocompletion_ajax"),l="",a&&App.UiElement[a.tag]&&(a.name=c,r.value&&r.value[n]&&(a.value=_.clone(r.value[n].value)),a.multiple=!1,a.nulloption=!1,"checkbox"===a.tag&&(a.tag="select"),p=a.tag+"_search",l=App.UiElement[p]?App.UiElement[p].render(a,{}):App.UiElement[a.tag].render(a,{})),"before (relative)"!==s.operator&&"within next (relative)"!==s.operator&&"within last (relative)"!==s.operator&&"after (relative)"!==s.operator||(a.name=r.name+"::"+n,r.value&&r.value[n]&&(a.value=_.clone(r.value[n])),l=App.UiElement.time_range.render(a,{})),e.find(".js-value").removeClass("hide").html(l)},t.buildNotificationArea=function(t,e,n,i,s,r,o){var a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T,A,S,C,x,j,P;if(!n.find(".js-setNotification .js-body-"+t).get(0)){for(h in n.find(".js-setNotification").empty(),b={article_last_sender:"Article Last Sender",ticket_owner:"Owner",ticket_customer:"Customer",ticket_agents:"All Agents"},v=o.name+"::notification."+t,g=function(){switch(t){case"sms":return 160;default:return 2e5}}(),_.isArray(r.recipient)||(r.recipient=[r.recipient]),a=[],b){for(j=b[h],A=void 0,c=0,d=(w=r.recipient).length;c<d;c++)h===w[c]&&(A=!0);a.push({value:h,name:App.i18n.translateInline(j),selected:A})}for(l=[],p=0,f=(k=App.User.all()).length;p<f;p++){for(h="userid_"+(x=k[p]).id,A=void 0,u=0,m=(T=r.recipient).length;u<m;u++)h===T[u]&&(A=!0);l.push({value:h,name:x.firstname+" "+x.lastname,selected:A})}return C=new App.ColumnSelect({attribute:{name:v+"::recipient",options:[{label:"Variables",group:a},{label:"User",group:l}]}}).element(),(y=$(App.view("generic/ticket_perform_action/notification")({attribute:o,name:v,notificationType:t,meta:r||{}}))).find(".js-recipient select").replaceWith(C),P=App.UiElement.select.render({name:v+"::internal",multiple:!1,"null":!1,options:{"true":"internal","false":"public"},value:r.internal||"false",translate:!0}),y.find(".js-internal").html(P),y.find('.js-body div[contenteditable="true"]').ce({mode:"richtext",placeholder:"message",maxlength:g}),new App.WidgetPlaceholder({el:y.find('.js-body div[contenteditable="true"]').parent(),objects:[{prefix:"ticket",object:"Ticket",display:"Ticket"},{prefix:"article",object:"TicketArticle",display:"Article"},{prefix:"user",object:"User",display:"Current User"}]}),n.find(".js-setNotification").html(y).removeClass("hide"),!0===App.Config.get("smime_integration")?(S=App.UiElement.select.render({name:v+"::sign",multiple:!1,options:{no:"Do not sign email",discard:"Sign email (if not possible, discard notification)",always:"Sign email (if not possible, send notification anyway)"},value:r.sign,translate:!0}),n.find(".js-sign").html(S),S=App.UiElement.select.render({name:v+"::encryption",multiple:!1,options:{no:"Do not encrypt email",discard:"Encrypt email (if not possible, discard notification)",always:"Encrypt email (if not possible, send notification anyway)"},value:r.encryption,translate:!0}),n.find(".js-encryption").html(S)):void 0}},t.buildArticleArea=function(t,e,n,i,s,r,o){var a,l,c;if(!n.find(".js-setArticle .js-body-"+t).get(0))return n.find(".js-setArticle").empty(),l=o.name+"::article."+t,console.log("meta",r),c=App.UiElement.select.render({name:l+"::internal",multiple:!1,"null":!1,label:"Visibility",options:{"true":"internal","false":"public"},value:r.internal,translate:!0}),(a=$(App.view("generic/ticket_perform_action/article")({attribute:o,name:l,articleType:t,meta:r||{}}))).find(".js-internal").html(c),a.find('.js-body div[contenteditable="true"]').ce({mode:"richtext",placeholder:"message",maxlength:2e5}),new App.WidgetPlaceholder({el:a.find('.js-body div[contenteditable="true"]').parent(),objects:[{prefix:"ticket",object:"Ticket",display:"Ticket"},{prefix:"article",object:"TicketArticle",display:"Article"},{prefix:"user",object:"User",display:"Current User"}]}),n.find(".js-setArticle").html(a).removeClass("hide")},t.humanText=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f;if(l=App.i18n.translateContent("No filter."),_.isEmpty(t))return[l];for(e in(u=this.defaults())[0],u[1],u[2],s=u[3],h=[],t)if(d=t[e],c=e.split(/\./),meta&&c[1]){if(a=toCamelCase(c[0]),n=s[e],f=[],_.isArray(d))for(r=0,o=d.length;r<o;r++)i=d[r],p=this.humanTextLookup(n,i),f.push(p);else f.push(this.humanTextLookup(n,d));f.join&&(f=f.join(", ")),h.push(App.i18n.translateContent("Set")+" <b>"+App.i18n.translateContent(a)+" -> "+App.i18n.translateContent(n.display)+"</b> "+App.i18n.translateContent("to")+" <b>"+f+"</b>.")}return _.isEmpty(h)?[l]:h},t.humanTextLookup=function(t,e){var n;return App[t.relation]&&App[t.relation].exists(e)&&(n=App[t.relation].fullLocal(e))?n.displayName?App.i18n.translateContent(n.displayName()):valueHuman.push(App.i18n.translateContent(n.name)):e},t}()}.call(this),function(){App.UiElement.ticket_selector=function(){function t(){}return t.defaults=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m;for(s in null==t&&(t={}),n=["ticket.state_id"],o={ticket:{name:"Ticket",model:"Ticket"},article:{name:"Article",model:"TicketArticle"},customer:{name:"Customer",model:"User"},organization:{name:"Organization",model:"Organization"}},t.executionTime&&(o.execution_time={name:"Execution Time"}),d={"^datetime$":["before (absolute)","after (absolute)","before (relative)","after (relative)","within next (relative)","within last (relative)"],"^timestamp$":["before (absolute)","after (absolute)","before (relative)","after (relative)","within next (relative)","within last (relative)"],"^date$":["before (absolute)","after (absolute)","before (relative)","after (relative)","within next (relative)","within last (relative)"],boolean$:["is","is not"],integer$:["is","is not"],"^radio$":["is","is not"],"^select$":["is","is not"],"^tree_select$":["is","is not"],"^input$":["contains","contains not"],"^richtext$":["contains","contains not"],"^textarea$":["contains","contains not"],"^tag$":["contains all","contains one","contains all not","contains one not"]},t.hasChanged&&(d={"^datetime$":["before (absolute)","after (absolute)","before (relative)","after (relative)","within next (relative)","within last (relative)","has changed"],"^timestamp$":["before (absolute)","after (absolute)","before (relative)","after (relative)","within next (relative)","within last (relative)","has changed"],"^date$":["before (absolute)","after (absolute)","before (relative)","after (relative)","within next (relative)","within last (relative)","has changed"],boolean$:["is","is not","has changed"],integer$:["is","is not","has changed"],"^radio$":["is","is not","has changed"],"^select$":["is","is not","has changed"],"^tree_select$":["is","is not","has changed"],"^input$":["contains","contains not","has changed"],"^richtext$":["contains","contains not","has changed"],"^textarea$":["contains","contains not","has changed"],"^tag$":["contains all","contains one","contains all not","contains one not"]}),h={_id$:["is","is not"],_ids$:["is","is not"]},t.hasChanged&&(h={_id$:["is","is not","has changed"],_ids$:["is","is not","has changed"]}),i={},t.action&&(i["ticket.action"]={name:"action",display:"Action",tag:"select","null":!1,translate:!0,options:{create:"created",update:"updated"},operator:["is","is not"]}),o)if(r=o[s],"execution_time"===s)t.executionTime&&(i["execution_time.calendar_id"]={name:"calendar_id",display:"Calendar",tag:"select",relation:"Calendar","null":!1,translate:!1,operator:["is in working time","is not in working time"]});else for(a=0,l=(f=App[r.model].configure_attributes).length;a<l;a++)if("password"!==(m=f[a]).type&&"_ids"!==m.name.substr(m.name.length-4,4)&&!1!==m.searchable){for(u in e=_.clone(m),d)p=d[u],c=new RegExp(u,"i"),e.tag&&e.tag.match(c)&&(e.operator=p),i[s+"."+e.name]=e;for(u in h)p=h[u],c=new RegExp(u,"i"),e.name&&e.name.match(c)&&(e.operator=p),i[s+"."+e.name]=e;"select"===e.tag&&(e.multiple=!0)}return t.out_of_office&&(i["ticket.out_of_office_replacement_id"]={name:"out_of_office_replacement_id",display:"Out of office replacement",tag:"autocompletion_ajax",relation:"User","null":!1,translate:!0,operator:["is","is not"]}),[n,o,i]},t.rowContainer=function(t,e,n){var i,s;return i=$(App.view("generic/ticket_selector_row")({attribute:n})),s=this.buildAttributeSelector(t,e),i.find(".js-attributeSelector").prepend(s),i},t.render=function(r,t){var e,o,n,a,i,l,s,c,p,u,h,d,f,m,g,v,y,b;if(null==t&&(t={}),e=(p=this.defaults(r))[0],a=p[1],o=p[2],(l=$(App.view("generic/ticket_selector")({attribute:r}))).delegate(".js-add","click",(m=this,function(t){var e,n,i,s;for(i in e=$(t.target).closest(".js-filterElement"),n=void 0,o)if(o[i],!l.find('.js-attributeSelector [value="'+i+'"]:selected').get(0)){n=i;break}if(n)return s=m.rowContainer(a,o,r),e.after(s),s.find(".js-attributeSelector select").trigger("change"),m.rebuildAttributeSelectors(l,s,n,o,{},r),!1!==r.preview?m.preview(l):void 0})),l.delegate(".js-remove","click",(g=this,function(t){if(!$(t.currentTarget).hasClass("is-disabled"))return $(t.target).closest(".js-filterElement").remove(),g.updateAttributeSelectors(l),!1!==r.preview?g.preview(l):void 0})),_.isEmpty(t[r.name]))for(i=0,s=e.length;i<s;i++)n=e[i],h=this.rowContainer(a,o,r),this.rebuildAttributeSelectors(l,h,n,o,{},r),l.filter(".js-filter").append(h);else for(n in!1,u=t[r.name])c=u[n],!0,h=this.rowContainer(a,o,r),this.rebuildAttributeSelectors(l,h,n,o,c,r),l.filter(".js-filter").append(h);return l.delegate(".js-attributeSelector select","change",(v=this,function(t){var e;if(e=$(t.target).closest(".js-filterElement"),n=e.find(".js-attributeSelector option:selected").attr("value"))return v.rebuildAttributeSelectors(l,e,n,o,{},r),v.updateAttributeSelectors(l)})),l.delegate(".js-operator select","change",(y=this,function(t){var e;if(e=$(t.target).closest(".js-filterElement"),n=e.find(".js-attributeSelector option:selected").attr("value"))return y.buildOperator(l,e,n,o,{},r)})),!1!==r.preview&&(b=this,d=function(){return b.preview(l)},f=function(){return l.find(".js-previewCounterContainer").addClass("hide"),l.find(".js-previewLoader").removeClass("hide"),App.Delay.set(d,600,"preview")},l.on("change","select",function(){return f()}),l.on("change keyup","input",function(){return f()})),this.disableRemoveForOneAttribute(l),l},t.preview=function(e){var t,n;return t=App.ControllerForm.params(e),App.Ajax.request({id:"ticket_selector",type:"POST",url:App.Config.get("api_path")+"/tickets/selector",data:JSON.stringify(t),processData:!0,success:(n=this,function(t){return App.Collection.loadAssets(t.assets),e.find(".js-previewCounterContainer").removeClass("hide"),e.find(".js-previewLoader").addClass("hide"),n.ticketTable(t.ticket_ids,t.ticket_count,e)})})},t.ticketTable=function(t,e,n){return n.find(".js-previewCounter").html(e),new App.TicketList({tableId:"ticket-selector",el:n.find(".js-previewTable"),ticket_ids:t})},t.buildAttributeSelector=function(t,e){var n,i,s,r,o,a,l;for(r in l=$('<select class="form-control"></select>'),t)for(s in o=t[r],i=App.i18n.translateInline(o.name),l.closest("select").append('<optgroup label="'+i+'" class="js-'+r+'"></optgroup>'),a=l.find("optgroup.js-"+r),e)e[s],s.split(/\./)[0]===r&&(n=e[s]).operator&&(i=App.i18n.translateInline(n.display),a.append('<option value="'+s+'">'+i+"</option>"));return l},t.disableRemoveForOneAttribute=function(t){return 1<t.find(".js-attributeSelector select").length?t.find(".js-remove").removeClass("is-disabled"):t.find(".js-remove").addClass("is-disabled")},t.updateAttributeSelectors=function(e){return e.find(".js-attributeSelector select option").removeAttr("disabled"),e.find(".js-attributeSelector select").each(function(){var t;return t=$(this).val(),e.find('.js-attributeSelector select option[value="'+t+'"]').attr("disabled",!0)}),this.disableRemoveForOneAttribute(e)},t.rebuildAttributeSelectors=function(t,e,n,i,s,r){return n&&e.find(".js-attributeSelector select").val(n),this.buildOperator(t,e,n,i,s,r)},t.buildOperator=function(t,e,n,i,s,r){var o,a,l,c,p,u,h,d,f,m,g,v,y,b,_,w,k;if(a=e.find(".js-operator option:selected").attr("value"),f=r.name+"::"+n+"::operator",!s.operator&&a&&(s.operator=a),k=$('<select class="form-control" name="'+f+'"></select>'),(o=i[n]).operator){for(g=!1,l=0,u=(y=o.operator).length;l<u;l++)if(m=y[l],s.operator===m){g=!0;break}if(!g)for(c=0,h=(b=o.operator).length;c<h;c++){m=b[c],s.operator=m;break}for(p=0,d=(_=o.operator).length;p<d;p++)m=_[p],v=App.i18n.translateInline(m),w="",(n.match(/^ticket/)||"has changed"!==m)&&(s.operator===m&&(w='selected="selected"'),k.append('<option value="'+m+'" '+w+">"+v+"</option>"))}return e.find(".js-operator select").replaceWith(k),this.buildPreCondition(t,e,n,i,s,r)},t.buildPreCondition=function(t,e,n,i,s,r){var o,a,l,c,p,u,h,d,f,m,g,v;if(e.find(".js-operator option:selected").attr("value"),l=e.find(".js-preCondition option:selected").attr("value"),s.pre_condition||(s.pre_condition=l),v=this,m=function(){return"specific"!==e.find(".js-preCondition option:selected").attr("value")?(e.find(".js-value select").html(""),e.find(".js-value").addClass("hide")):(e.find(".js-value").removeClass("hide"),v.buildValue(t,e,n,i,s,o))},p=(o=_.clone(r)).name+"::"+n+"::value",h=!1,"User"===(a=i[n]).relation&&(h="user",o.tag="user_autocompletion"),"Organization"===a.relation&&(h="org",o.tag="autocompletion_ajax"),!h)return e.find(".js-preCondition select").html(""),e.find(".js-preCondition").addClass("hide"),m(),void this.buildValue(t,e,n,i,s,o);for(c in e.find(".js-preCondition").removeClass("hide"),p=o.name+"::"+n+"::pre_condition",f=$('<select class="form-control" name="'+p+'" ></select>'),u={},"user"===h?u={"current_user.id":App.i18n.translateInline("current user"),specific:App.i18n.translateInline("specific user"),not_set:App.i18n.translateInline("not set (not defined)")}:"org"===h&&(u={"current_user.organization_id":App.i18n.translateInline("current user organization"),specific:App.i18n.translateInline("specific organization"),not_set:App.i18n.translateInline("not set (not defined)")}),u)g=u[c],d="",c===s.pre_condition&&(d='selected="selected"'),f.append('<option value="'+c+'" '+d+">"+App.i18n.translateInline(g)+"</option>");return e.find(".js-preCondition").removeClass("hide"),e.find(".js-preCondition select").replaceWith(f),e.find(".js-preCondition select").bind("change",function(){return m()}),this.buildValue(t,e,n,i,s,o),m()},t.buildValue=function(t,e,n,i,s,r){var o,a,l,c,p;return c=r.name+"::"+n+"::value",o=i[n],"User"===(a=_.clone(o)).relation&&(a.tag="user_autocompletion"),"Organization"===a.relation&&(a.tag="autocompletion_ajax"),l="",a&&App.UiElement[a.tag]&&(a.name=c,r.value&&r.value[n]&&(a.value=_.clone(r.value[n].value)),"multiple"in a&&(a.multiple=!0,a.nulloption=!1),"User"===a.relation&&(a.multiple=!1,a.nulloption=!1,a.guess=!1),"Organization"===a.relation&&(a.multiple=!1,a.nulloption=!1,a.guess=!1),"checkbox"===a.tag&&(a.tag="select"),p=a.tag+"_search",l=App.UiElement[p]?App.UiElement[p].render(a,{}):App.UiElement[a.tag].render(a,{})),"before (relative)"!==s.operator&&"within next (relative)"!==s.operator&&"within last (relative)"!==s.operator&&"after (relative)"!==s.operator||(a.name=r.name+"::"+n,r.value&&r.value[n]&&(a.value=_.clone(r.value[n])),l=App.UiElement.time_range.render(a,{})),e.find(".js-value").removeClass("hide").html(l),"has changed"===s.operator?(e.find(".js-value").addClass("hide"),e.find(".js-preCondition").addClass("hide")):e.find(".js-value").removeClass("hide")},t.humanText=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g;if(c=App.i18n.translateContent("No filter."),_.isEmpty(t))return[c];for(e in(d=this.defaults())[0],d[1],s=d[2],f=[],t)if(a=t[e],p=e.split(/\./),a&&p[1]){if(u=a.operator,m=a.value,l=toCamelCase(p[0]),n=s[e],g=[],_.isArray(m))for(r=0,o=m.length;r<o;r++)i=m[r],h=this.humanTextLookup(n,i),g.push(h);else g.push(this.humanTextLookup(n,m));g.join&&(g=g.join(", ")),f.push(App.i18n.translateContent("Where")+" <b>"+App.i18n.translateContent(l)+" -> "+App.i18n.translateContent(n.display)+"</b> "+App.i18n.translateContent(u)+" <b>"+g+"</b>.")}return _.isEmpty(f)?[c]:f},t.humanTextLookup=function(t,e){var n;return App[t.relation]&&App[t.relation].exists(e)&&(n=App[t.relation].fullLocal(e))?n.displayName?App.i18n.translateContent(n.displayName()):valueHuman.push(App.i18n.translateContent(n.name)):e},t}()}.call(this),function(){App.UiElement.time_range=function(){function t(){}return t.render=function(e){var t,n,i,s,r,o,a,l,c,p,u,h,d;for(r in a={minute:"Minute(s)",hour:"Hour(s)",day:"Day(s)",month:"Month(s)",year:"Year(s)"})u=a[r],a[r]=App.i18n.translateInline(u);return o="minute",e.value&&e.value.range&&(o=e.value.range),h={minute:function(){for(l=[],n=1;n<=120;n++)l.push(n);return l}.apply(this),hour:function(){for(c=[],i=1;i<=48;i++)c.push(i);return c}.apply(this),day:function(){for(p=[],s=1;s<=31;s++)p.push(s);return p}.apply(this),month:[1,2,3,4,5,6,7,8,9,10,11,12],year:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},t=$(App.view("generic/time_range")({attribute:e,ranges:a})),this.localRenderPulldown(t.filter(".js-valueRangeSelector"),h[o],e),t.find("select.form-control.js-range").on("change",(d=this,function(t){return o=$(t.currentTarget).val(),d.localRenderPulldown($(t.currentTarget).closest(".js-filterElement").find(".js-valueRangeSelector"),h[o],e)})),t},t.localRenderPulldown=function(t,e,n){
var i,s,r,o,a;if(e){for(a={},s=0,r=e.length;s<r;s++)a[(i=e[s]).toString()]=i.toString();return o=App.view("generic/time_range_value_selector")({attribute:n,values:a}),t.html(o)}},t}()}.call(this),function(){App.UiElement.timer=function(){function s(){}return s.render=function(t){var e,n,i,s,r;return e={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday",Sat:"Saturday",Sun:"Sunday"},n={0:"12 am",1:"1 am",2:"2 am",3:"3 am",4:"4 am",5:"5 am",6:"6 am",7:"7 am",8:"8 am",9:"9 am",10:"10 am",11:"11 am",12:"12 am",13:"1 pm",14:"2 pm",15:"3 pm",16:"4 pm",17:"5 pm",18:"6 pm",19:"7 pm",20:"8 pm",21:"9 pm",22:"10 pm",23:"11 pm"},n={0:"00",1:"01",2:"02",3:"03",4:"04",5:"05",6:"06",7:"07",8:"08",9:"09",10:"10",11:"11",12:"12",13:"13",14:"14",15:"15",16:"16",17:"17",18:"18",19:"19",20:"20",21:"21",22:"22",23:"23"},i={0:"00",10:"10",20:"20",30:"30",40:"40",50:"50"},t.value||(t.value={}),_.isEmpty(t.value.days)&&(t.value.days={Mon:!0}),_.isEmpty(t.value.hours)&&(t.value.hours={0:!0}),_.isEmpty(t.value.minutes)&&(t.value.minutes={0:!0}),(s=$(App.view("generic/timer")({attribute:t,days:e,hours:n,minutes:i}))).find(".js-boolean").data("field-type","boolean"),s.find(".select-value").bind("click",(r=this,function(t){return r.select(t)})),this.createOutputString(s),s},s.select=function(t){var e,n;return(n=$(t.currentTarget)).hasClass("is-selected")?0<n.siblings(".is-selected").size()&&(n.removeClass("is-selected"),n.next().val("false")):(n.addClass("is-selected"),n.next().val("true")),e=$(t.currentTarget).closest(".form-group"),s.createOutputString(e)},s.createOutputString=function(t){var e,n,i;return e=$.map(t.find("[data-type=day]").filter(".is-selected"),function(t){return $(t).text()}),n=$.map(t.find("[data-type=hour]").filter(".is-selected"),function(t){return $(t).text()}),i=$.map(t.find("[data-type=minute]").filter(".is-selected"),function(t){return $(t).text()}),n=s.injectMinutes(n,i),e=s.joinItems(e),n=s.joinItems(n),t.find(".js-timerResult").text(App.i18n.translateInline("Run every %s at %s",e,n))},s.injectMinutes=function(t,e){var n,i,s,r,o,a,l,c,p;for(l=[],s=0,o=t.length;s<o;s++)for(i=(c=(i=t[s]).split(" "))[0],p=c[1],r=0,a=e.length;r<a;r++)n=i+":"+e[r],p&&(n+=" "+p),l.push(n);return l},s.joinItems=function(t){switch(t.length){case 1:return t[0];case 2:return t[0]+" "+App.i18n.translateInline("and")+" "+t[1];default:return t.slice(0,-1).join(", ")+" "+App.i18n.translateInline("and")+" "+t[t.length-1]}},s}()}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.timezone=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.render=function(t,e){var n,i,s,r;for(s in t.options=[],r=App.Config.get("timezones"))0<(i=r[s])&&(i="+"+i),n={name:s+" (GMT"+i+")",value:s},t.options.push(n);return this.addNullOption(t,e),this.sortOptions(t,e),this.selectedOptions(t,e),t.tag="searchable_select",t.placeholder=App.i18n.translateInline("Enter timezone..."),App.UiElement.searchable_select.render(t)},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UiElement.tree_select=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.optionsSelect=function(t,e){var n,i,s,r;if(t){for(r=[],i=0,s=t.length;i<s;i++)(n=t[i]).value===e&&(n.selected=!0),n.children?r.push(this.optionsSelect(n.children,e)):r.push(void 0);return r}},e.render=function(t,e){return t.multiple?t.multiple="multiple":t.multiple="",this.getConfigOptionList(t,e),this.getRelationOptionList(t,e),this.addNullOption(t,e),this.sortOptions(t,e),t.options&&this.optionsSelect(t.options,t.value),this.disabledOptions(t,e),this.filterOption(t,e),new App.SearchableSelect({attribute:t}).element()},e}(App.UiElement.ApplicationUiElement)}.call(this),function(){App.UiElement.user_autocompletion=function(){function t(){}return t.render=function(t,e){return null==e&&(e={}),new App.UserOrganizationAutocompletion({attribute:t,params:e}).element()},t}()}.call(this),function(){App.UiElement.user_autocompletion_search=function(){function t(){}return t.render=function(t,e){var n;return null==e&&(e={}),(n=_.clone(t)).disableCreateObject=!0,new App.UserOrganizationAutocompletion({attribute:n,params:e}).element()},t}()}.call(this),function(){App.UiElement.user_permission=function(){function t(){}return t.render=function(t,e){var n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T,A,S,C,x,j,P,I,E,D,O,N,R,M,L,U,z,B,F,q;if(null==e&&(e={}),t.options={},_.isEmpty(e.group_ids)&&_.isEmpty(e.role_ids)&&!_.isEmpty(t.value)){for(e.role_ids=t.value,B=!1,l=0,u=(I=e.role_ids).length;l<u;l++)if(k=I[l],R=App.Role.find(k))for(c=0,h=(E=R.permission_ids).length;c<h;c++)if(x=E[c],(w=App.Permission.find(x))&&"ticket.agent"===w.name){B=!0;break}if(B)for(e.group_ids=[],p=0,d=(s=App.Group.search({sortBy:"name"})).length;p<d;p++)n=s[p],e.group_ids.push(n.id)}for(M=[],U={},T=0,f=(L=App.Role.search({sortBy:"name"})).length;T<f;T++)if((R=L[T]).active&&(M.push(R),e.role_ids))for(A=0,m=(D=e.role_ids).length;A<m;A++)D[A].toString()===R.id.toString()&&(U[R.id]=!0);for(i=[],r={},S=0,g=(s=App.Group.search({sortBy:"name"})).length;S<g;S++)if((n=s[S]).active&&(i.push(n),e.group_ids))for(C=0,v=(O=e.group_ids).length;C<v;C++)O[C].toString()===n.id.toString()&&(r[n.id]=!0);for(o=!1,i.length<=1&&(o=!0),z={},j=0,y=L.length;j<y;j++)if((R=L[j]).active)for(P=0,b=(N=R.permission_ids).length;P<b;P++)x=N[P],(w=App.Permission.find(x))&&w.preferences&&_.contains(w.preferences.plugin,"groups")&&(z[R.id]="group");return M=_.indexBy(M,"name"),M=_.sortBy(M,function(t){return t.name}),(a=$(App.view("generic/user_permission")({attribute:t,roles:M,params:e,rolesSelected:U}))).find(".js-groups").html(App.view("generic/user_permission_group")({attribute:t,groups:i,params:e,groupsSelected:r,hideGroups:o,groupAccesses:App.Group.accesses()})),F=_.throttle(function(){var t,e,n;return e=!(t=$(this).find("input")).prop("checked"),n=t.val(),console.log(e),console.log(n),"full"===n&&!0===e?$(this).closest("tr").find("input:not([value=full])").prop("checked",!1):"full"!==n&&!0===e?$(this).closest("tr").find("input[value=full]").prop("checked",!1):void 0},300,{trailing:!1}),a.on("click",".checkbox-replacement",F),a.find("[name=role_ids]").bind("change",(q=this,function(t){return q.checkUncheck($(t.currentTarget),z,a,o)})),a.find("[name=role_ids]").trigger("change"),a},t.checkUncheck=function(t,e,n,i){var s,r,o,a,l,c,p,u,h,d,f,m,g,v;if(s=t.prop("checked"),(f=t.prop("value"))&&(d=App.Role.find(f))){if(v=[],s&&d&&d.preferences&&d.preferences.not)for(r=0,a=(u=d.preferences.not).length;r<a;r++)if(p=u[r],(c=App.Role.findByAttribute("name",p))&&n.find("[name=role_ids][value="+c.id+"]").prop("checked")){if(!confirm(App.i18n.translateInline("Role %s is conflicting with role %s, do you want to continue?",d.name,c.name,c.name)))return void n.find("[name=role_ids][value="+f+"]").prop("checked",!1);n.find("[name=role_ids][value="+c.id+"]").prop("checked",!1),v.push(n.find("[name=role_ids][value="+c.id+"]"))}if(s){for("group"===e[f]&&(n.find(".js-groupList:not(.js-groupListHide)").removeClass("hidden"),i&&n.find(".js-groupList .js-groupListItem[value=full]").prop("checked",!0)),h=[],o=0,l=v.length;o<l;o++)g=v[o],h.push(g.trigger("change"));return h}for(f in m=!1,e)e[f],n.find("[name=role_ids][value="+f+"]").prop("checked")&&(m=!0);m||(n.find(".js-groupList").addClass("hidden"),i&&n.find(".js-groupList .js-groupListItem[value=full]").prop("checked",!1))}},t}()}.call(this),function(){var t,o=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketCreate=function(t){function r(e){var t,n,i,s;this.submitEnable=o(this.submitEnable,this),this.submitDisable=o(this.submitDisable,this),this.submit=o(this.submit,this),this.params=o(this.params,this),this.localUserInfoCallback=o(this.localUserInfoCallback,this),this.localUserInfo=o(this.localUserInfo,this),this.renderQueue=o(this.renderQueue,this),this.buildScreen=o(this.buildScreen,this),this.autosaveStart=o(this.autosaveStart,this),this.autosaveStop=o(this.autosaveStop,this),this.updateSecurityOptions=o(this.updateSecurityOptions,this),this.changed=o(this.changed,this),this.hide=o(this.hide,this),this.show=o(this.show,this),this.url=o(this.url,this),this.meta=o(this.meta,this),this.setFormTypeInUi=o(this.setFormTypeInUi,this),this.changeFormType=o(this.changeFormType,this),this.currentChannel=o(this.currentChannel,this),this.release=o(this.release,this),r.__super__.constructor.apply(this,arguments),this.sidebarState={},this.defaultType=this.Config.get("ui_ticket_create_default_type"),this.availableTypes=this.Config.get("ui_ticket_create_available_types")||[],_.isArray(this.availableTypes)||(this.availableTypes=[this.availableTypes]),_.contains(this.availableTypes,this.defaultType)||(this.defaultType=this.availableTypes[0]),this.formId=App.ControllerForm.formId(),this.queueKey="TicketCreate"+this.taskKey,this.split="",this.ticket_id&&this.article_id&&(this.split="/"+this.ticket_id+"/"+this.article_id),t=function(t){return App.Collection.loadAssets(t.assets),n.formMeta=t.form_meta,n.buildScreen(e)},(n=this).bindId=App.TicketCreateCollection.one(t),this.bind("ui:rerender",(i=this,function(){if(i.authenticateCheck())return i.renderQueue(),i.tokanice()})),this.bind("ui::ticket::sidebarRerender",(s=this,function(t){if(t.taskKey===s.taskKey&&s.sidebarWidget)return s.sidebarWidget.render(s.params())}))}return e(r,t),r.include(App.SecurityOptions),r.prototype.elements={".tabsSidebar":"sidebar"},r.prototype.events={"click .type-tabs .tab":"changeFormType","submit form":"submit","click .js-cancel":"cancel","click .js-active-toggle":"toggleButton"},r.prototype.types={"phone-in":{icon:"received-calls",label:"Received Call"},"phone-out":{icon:"outbound-calls",label:"Outbound Call"},"email-out":{icon:"email",label:"Send Email"}},r.prototype.release=function(){return App.TicketCreateCollection.unbindById(this.bindId)},r.prototype.currentChannel=function(){var t;return t||(t=this.$(".type-tabs .tab.active").data("type")),t||(t=this.defaultType),t},r.prototype.changeFormType=function(t){var e;return e=$(t.currentTarget).data("type"),this.setFormTypeInUi(e),this.tokanice()},r.prototype.setFormTypeInUi=function(t){var e,n,i;return t||(t=this.currentChannel()),this.$(".type-tabs .tab").removeClass("active"),(n=this.$(".type-tabs .tab .icon")).addClass("gray"),n.removeClass("white"),this.$(".type-tabs .tab[data-type='"+t+"']").addClass("active"),e={"phone-in":{sender:"Customer",article:"phone",title:"Call Inbound",screen:"create_phone_in"},"phone-out":{sender:"Agent",article:"phone",title:"Call Outbound",screen:"create_phone_out"},"email-out":{sender:"Agent",article:"email",title:"Email",screen:"create_email_out"}},this.articleAttributes=e[t],this.$('[name="formSenderType"]').val(t),this.$('[name="group_id"]').trigger("change"),this.$('[name="cc"], [name="group_id"], [name="customer_id"]').bind("change",(i=this,function(){return i.updateSecurityOptions()})),this.updateSecurityOptions(),"email-out"===t?(this.$('[name="cc"]').closest(".form-group").removeClass("hide"),this.securityEnabled()&&this.securityOptionsShow()):(this.$('[name="cc"]').closest(".form-group").addClass("hide"),this.securityEnabled()&&this.securityOptionsHide()),this.$(".js-note").addClass("hide"),this.$(".js-note[data-type='"+t+"']").removeClass("hide"),App.TaskManager.touch(this.taskKey)},r.prototype.meta=function(){var t,e;return t="",this.articleAttributes&&(t=App.i18n.translateInline(this.articleAttributes.title)),(e=this.$("[name=title]").val())&&(t=t+": "+e),{url:this.url(),head:t,title:t,id:this.id,iconClass:"pen"}},r.prototype.url=function(){return"#ticket/create/id/"+this.id},r.prototype.show=function(){return this.navupdate("#ticket/create/id/"+this.id+this.split,{type:"menu"}),this.autosaveStart(),this.bind("ticket_create_rerender",(e=this,function(t){return e.renderQueue(t)}));var e},r.prototype.hide=function(){return this.autosaveStop(),this.unbind("ticket_create_rerender",(e=this,function(t){return e.renderQueue(t)}));var e},r.prototype.changed=function(){var t,e;return e=this.formParam(this.$(".ticket-create")),!(!(t=difference(this.formDefault,e))||_.isEmpty(t))},r.prototype.updateSecurityOptions=function(){var t;return(t=this.params()).customer_id_completion&&(t.to=t.customer_id_completion),this.updateSecurityOptionsRemote(this.taskKey,t,t,this.paramsSecurity())},r.prototype.autosaveStop=function(){return this.clearDelay("ticket-create-form-update"),this.el.off("change.local blur.local keyup.local paste.local input.local")},r.prototype.autosaveStart=function(){var t,e,n,i;return this.autosaveLast||((t=App.TaskManager.get(this.taskKey))&&!t.state&&(t.state={}),this.autosaveLast=t.state||{}),e=function(){var t,e;if(t=n.formParam(n.$(".ticket-create")),!_.isEmpty(t))return e=difference(n.autosaveLast,t),!_.isEmpty(n.autosaveLast)&&_.isEmpty(e)||(n.autosaveLast=t,n.log("debug","form hash changed",e,t),App.TaskManager.update(n.taskKey,{state:t}),n.latestTitle===t.title)?void 0:(n.latestTitle=t.title,App.TaskManager.touch(n.taskKey))},(n=this).el.on("change.local blur.local keyup.local paste.local input.local","form, .js-textarea",(i=this,function(){return i.delay(e,250,"ticket-create-form-update")})),this.delay(e,800,"ticket-create-form-update")},r.prototype.buildScreen=function(i){return _.isEmpty(i.ticket_id)&&_.isEmpty(i.article_id)?_.isEmpty(i.customer_id)?void this.renderQueue():void this.renderQueue({options:i}):this.ajax({id:"ticket_split"+this.taskKey,type:"GET",url:this.apiPath+"/ticket_split",data:{ticket_id:i.ticket_id,article_id:i.article_id,form_id:this.formId},processData:!0,success:(s=this,function(t){var e,n;return App.Collection.loadAssets(t.assets),n=App.Ticket.find(i.ticket_id).attributes(),e=App.TicketArticle.find(i.article_id),n.owner_id=0,n.customer_id_completion=e.from,n.subject=e.subject||n.title,e.content_type.match(/\/html/)?n.body=e.body:n.body=App.Utils.text2html(e.body),n.attachments=t.attachments,s.renderQueue({options:n})})});var s},r.prototype.renderQueue=function(t){var e,n;if(null==t&&(t={}),n=this,e=function(){return n.render(t)},App.QueueManager.add(this.queueKey,e),this.formMeta)return App.QueueManager.run(this.queueKey)},r.prototype.render=function(t){var e,n,i,s,r,o;if(null==t&&(t={}),this.formMeta)return i=this.prefilledParams||{},t&&!_.isEmpty(t.options)?i=t.options:App.TaskManager.get(this.taskKey)&&!_.isEmpty(App.TaskManager.get(this.taskKey).state)&&((i=App.TaskManager.get(this.taskKey).state).attachments=App.TaskManager.get(this.taskKey).attachments,_.isEmpty(i.form_id)||(this.formId=i.form_id)),this.html(App.view("agent_ticket_create")({head:"New Ticket",agent:this.permissionCheck("ticket.agent"),admin:this.permissionCheck("admin"),types:this.types,availableTypes:this.availableTypes,form_id:this.formId})),App.Ticket.configure_attributes.push({name:"cc",display:"Cc",tag:"input",type:"text",maxlength:1e3,"null":!0,screen:{create_top:{Agent:{"null":!0}},create_middle:{},edit:{}}}),n=this.Config.get("TicketCreateFormHandler"),new App.ControllerForm({el:this.$(".ticket-form-top"),form_id:this.formId,model:App.Ticket,screen:"create_top",events:{"change [name=customer_id]":this.localUserInfo},handlersConfig:n,filter:this.formMeta.filter,formMeta:this.formMeta,autofocus:!0,params:i,taskKey:this.taskKey}),new App.ControllerForm({el:this.$(".article-form-top"),form_id:this.formId,model:App.TicketArticle,screen:"create_top",events:{"fileUploadStart .richtext":(r=this,function(){return r.submitDisable()}),"fileUploadStop .richtext":(s=this,function(){return s.submitEnable()})},params:i,taskKey:this.taskKey}),new App.ControllerForm({el:this.$(".ticket-form-middle"),form_id:this.formId,model:App.Ticket,screen:"create_middle",events:{"change [name=customer_id]":this.localUserInfo},handlersConfig:n,filter:this.formMeta.filter,formMeta:this.formMeta,params:i,noFieldset:!0,taskKey:this.taskKey,rejectNonExistentValues:!0}),new App.ControllerForm({el:this.$(".ticket-form-bottom"),form_id:this.formId,model:App.Ticket,screen:"create_bottom",events:{"change [name=customer_id]":this.localUserInfo},handlersConfig:n,filter:this.formMeta.filter,formMeta:this.formMeta,params:i,taskKey:this.taskKey}),App.Utils.htmlImage2DataUrlAsyncInline(this.$("[contenteditable=true]")),App.Ticket.configure_attributes.pop(),this.setFormTypeInUi(i.formSenderType),this.formDefault=this.formParam(this.$(".ticket-create")),this.textModule=new App.WidgetTextModule({el:this.$('[data-name="body"]').parent(),data:{config:App.Config.all(),user:App.Session.get()},taskKey:this.taskKey}),$("#tags").tokenfield(),this.sidebarWidget=new App.TicketCreateSidebar({el:this.sidebar,params:this.formDefault,sidebarState:this.sidebarState,taskKey:this.taskKey,query:this.query}),this.formDefault.customer_id&&(o=this,e=function(t){return o.localUserInfoCallback(o.formDefault,t)},App.User.full(this.formDefault.customer_id,e)),App.TaskManager.touch(this.taskKey),this.tokanice()},r.prototype.toggleButton=function(t){return this.$(t.currentTarget).toggleClass("btn--active")},r.prototype.tokanice=function(){return App.Utils.tokanice(".content.active input[name=cc]","email")},r.prototype.localUserInfo=function(t){var e,n,i;if(this.sidebarWidget)return(n=App.ControllerForm.params($(t.target).closest("form"))).customer_id?(i=this,e=function(t){return i.localUserInfoCallback(n,t)},void App.User.full(n.customer_id,e)):this.localUserInfoCallback(n)},r.prototype.localUserInfoCallback=function(t,e){return null==e&&(e={}),this.sidebarWidget.render(t),this.textModule.reload({config:App.Config.all(),user:App.Session.get(),ticket:{customer:e}})},r.prototype.cancel=function(t){return t.preventDefault(),this.navigate("#")},r.prototype.params=function(){return this.formParam(this.$(".main form"))},r.prototype.submit=function(n){var t,e,i,s,r,o,a,l,c,p,u,h,d,f;return n.preventDefault(),(a=this.params()).title||(a.title=a.subject),c=new App.Ticket,l=App.TicketArticleSender.findByAttribute("name",this.articleAttributes.sender),d=App.TicketArticleType.findByAttribute("name",this.articleAttributes.article),a.group_id&&(r=App.Group.find(a.group_id)),this.ticket_id&&(a.links={Ticket:{child:[this.ticket_id]}}),"email-out"!==this.currentChannel()&&delete a.cc,"Customer"===l.name?a.article={to:r&&r.name||"",from:a.customer_id_completion,cc:a.cc,subject:a.subject,body:a.body,type_id:d.id,sender_id:l.id,form_id:this.formId,content_type:"text/html"}:(a.article={from:r&&r.name||"",to:a.customer_id_completion,cc:a.cc,subject:a.subject,body:a.body,type_id:d.id,sender_id:l.id,form_id:this.formId,content_type:"text/html"},this.securityOptionsShown()&&((i=a.article).preferences||(i.preferences={}),a.article.preferences.security=this.paramsSecurity())),c.load(a),h=c.validate({screen:"create_top"}),u=c.validate({screen:"create_middle"}),p=c.validate({screen:"create_bottom"}),(t=new App.TicketArticle).load(a.article),e=t.validate({screen:"create_top"}),s={},s=_.extend(s,h),s=_.extend(s,u),s=_.extend(s,p),s=_.extend(s,e),_.isEmpty(s)?t.body&&this.$(".richtext .attachments .attachment").length<1&&(o=App.Utils.checkAttachmentReference(t.body))&&!confirm(App.i18n.translateContent("You use %s in text but no attachment is attached. Do you want to continue?",o))?void 0:(this.sidebarWidget&&this.sidebarWidget.postParams&&this.sidebarWidget.postParams({ticket:c}),this.submitDisable(n),f=this,c.save({done:function(){if(f.notify({type:"success",msg:App.i18n.translateInline("Ticket %s created!",this.number),link:"#ticket/zoom/"+this.id,timeout:4e3}),App.TaskManager.remove(f.taskKey),f.scrollTo(),f.sidebarWidget&&f.sidebarWidget.commit({ticket_id:this.id}),!this.editable("change"))return f.navigate("#");f.navigate("#ticket/zoom/"+this.id)},fail:function(t,e){return f.log("errors",e),f.submitEnable(n),f.notify({type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to create object!"),timeout:6e3})}})):(this.log("error",s),void this.formValidate({form:n.target,errors:s}))},r.prototype.submitDisable=function(t){if(!t)return this.formDisable(this.$(".js-submit"),"button");this.formDisable(t)},r.prototype.submitEnable=function(t){if(!t)return this.formEnable(this.$(".js-submit"),"button");this.formEnable(t)},r}(App.Controller),t=function(t){function s(t){var e,n,i;if(s.__super__.constructor.apply(this,arguments),!t.id)return i="",t.ticket_id&&t.article_id&&(i="/"+t.ticket_id+"/"+t.article_id),t.customer_id&&(i="/customer/"+t.customer_id),t.query&&(i="/query/"+t.query),n=Math.floor(99999*Math.random()),void this.navigate("#ticket/create/id/"+n+i);e={ticket_id:t.ticket_id,article_id:t.article_id,type:t.type,customer_id:t.customer_id,query:t.query,id:t.id},App.TaskManager.execute({key:"TicketCreateScreen-"+t.id,controller:"TicketCreate",params:e,show:!0})}return e(s,t),s.prototype.requiredPermission="ticket.agent",s}(App.ControllerPermanent),App.Config.set("ticket/create",t,"Routes"),App.Config.set("ticket/create/",t,"Routes"),App.Config.set("ticket/create/id/:id",t,"Routes"),App.Config.set("ticket/create/customer/:customer_id",t,"Routes"),App.Config.set("ticket/create/id/:id/customer/:customer_id",t,"Routes"),App.Config.set("ticket/create/id/:id/query/:query",t,"Routes"),App.Config.set("ticket/create/:ticket_id/:article_id",t,"Routes"),App.Config.set("ticket/create/id/:id/:ticket_id/:article_id",t,"Routes"),App.Config.set("TicketCreate",{prio:8003,parent:"#new",name:"New Ticket",translate:!0,target:"#ticket/create",permission:["ticket.agent"],divider:!0},"NavBarRight")}.call(this),function(){var t;t=function(){function t(){}return t.run=function(t,e,n,i,s,r){var o,a,l,c,p,u;if(e&&"group_id"===e.name)return l=void 0,t.group_id&&(a=App.Group.find(t.group_id))&&a.signature_id&&(l=App.Signature.find(a.signature_id)),u=r.el.closest(".content").find('[name="formSenderType"]').val(),l&&l.body&&"email-out"===u?(c=App.Utils.replaceTags(l.body,{user:App.Session.get(),config:App.Config.all()}),o=r.el.closest(".content").find("[data-name=body]"),!_.isEmpty(o)&&App.Utils.signatureCheck(o.html()||"",c)?((p=r.el.closest(".content").find("[data-signature=true]").data("signature-id"))&&p.toString()!==l.id.toString()&&r.el.closest(".content").find('[data-signature="true"]').remove(),App.Utils.htmlLastLineEmpty(o)||o.append("<br><br>"),l=$('<div data-signature="true" data-signature-id="'+l.id+'">'+c+"</div>"),App.Utils.htmlStrip(l),o.append(l),r.el.closest(".content").find("[data-name=body]").replaceWith(o)):void 0):r.el.closest(".content").find('[data-name="body"]').find("[data-signature=true]").remove()},t}(),App.Config.set("200-ticketFormSignature",t,"TicketCreateFormHandler")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketCreateSidebar=function(t){function e(){this.render=n(this.render,this),this.postParams=n(this.postParams,this),this.commit=n(this.commit,this),this.reload=n(this.reload,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.reload=function(t){var e,n,i,s;for(n in s=[],i=this.sidebarBackends)(e=i[n])&&e.reload?s.push(e.reload(t)):s.push(void 0);return s},e.prototype.commit=function(t){var e,n,i,s;for(n in s=[],i=this.sidebarBackends)(e=i[n])&&e.commit?s.push(e.commit(t)):s.push(void 0);return s},e.prototype.postParams=function(t){var e,n,i,s;for(n in s=[],i=this.sidebarBackends)(e=i[n])&&e.postParams?s.push(e.postParams(t)):s.push(void 0);return s},e.prototype.render=function(t){var e,n,i,s,r;for(t&&(this.params=t),this.sidebarBackends||(this.sidebarBackends={}),this.sidebarItems=[],r=App.Config.get("TicketCreateSidebar"),e=0,s=(i=_.keys(r).sort()).length;e<s;e++)n=i[e],this.sidebarBackends[n]&&this.sidebarBackends[n].reload?this.sidebarBackends[n].reload({params:this.params,query:this.query}):this.sidebarBackends[n]=new r[n]({params:this.params,query:this.query,taskGet:this.taskGet,taskKey:this.taskKey}),this.sidebarItems.push(this.sidebarBackends[n]);return new App.Sidebar({el:this.el,sidebarState:this.sidebarState,items:this.sidebarItems})},e}(App.Controller)}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.editCustomer=n(this.editCustomer,this),this.showCustomer=n(this.showCustomer,this),this.badgeRenderLocal=n(this.badgeRenderLocal,this),this.badgeRender=n(this.badgeRender,this),this.metaBadge=n(this.metaBadge,this),this.sidebarItem=n(this.sidebarItem,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.sidebarItem=function(){if(this.permissionCheck("ticket.agent")&&!_.isEmpty(this.params.customer_id))return this.item={name:"customer",badgeCallback:this.badgeRender,sidebarHead:"Customer",sidebarCallback:this.showCustomer,sidebarActions:[]},App.User.exists(this.params.customer_id)&&App.User.find(this.params.customer_id).isAccessibleBy(App.User.current(),"change")&&this.item.sidebarActions.push({title:"Edit Customer",name:"customer-edit",callback:this.editCustomer}),this.item},e.prototype.metaBadge=function(t){var e,n;return n=e="",e=this.sidebarItemCounter(t),!0===this.Config.get("ui_sidebar_open_ticket_indicator_colored")&&(1===e&&(n="tabsSidebar-tab-count--warning"),1<e&&(n="tabsSidebar-tab-count--danger")),{name:"customer",icon:"person",counterPossible:!0,counter:e,cssClass:n}},e.prototype.badgeRender=function(t){var e;if(this.badgeEl=t,App.User.exists(this.params.customer_id))return e=App.User.find(this.params.customer_id),this.badgeRenderLocal(e)},e.prototype.badgeRenderLocal=function(t){return this.badgeEl.html(App.view("generic/sidebar_tabs_item")(this.metaBadge(t)))},e.prototype.sidebarItemCounter=function(t){var e;return e="",t&&t.preferences&&t.preferences.tickets_open&&(e=t.preferences.tickets_open),e},e.prototype.showCustomer=function(t){if(this.elSidebar=t,!_.isEmpty(this.params.customer_id))return new App.WidgetUser({el:this.elSidebar,user_id:this.params.customer_id,callback:this.badgeRenderLocal})},e.prototype.editCustomer=function(){return new App.ControllerGenericEdit({id:this.params.customer_id,genericObject:"User",screen:"edit",pageData:{title:"Users",object:"User",objects:"Users"},container:this.elSidebar.closest(".content")})},e}(App.Controller),App.Config.set("200-Customer",t,"TicketCreateSidebar")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.editOrganization=n(this.editOrganization,this),this.showOrganization=n(this.showOrganization,this),this.sidebarItem=n(this.sidebarItem,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.sidebarItem=function(){var t;if(this.permissionCheck("ticket.agent")&&this.params.customer_id&&App.User.exists(this.params.customer_id)&&(t=App.User.find(this.params.customer_id),this.organization_id=t.organization_id,this.organization_id))return this.item={name:"organization",badgeIcon:"group",sidebarHead:"Organization",sidebarCallback:this.showOrganization,sidebarActions:[{title:"Edit Organization",name:"organization-edit",callback:this.editOrganization}]},this.item},e.prototype.showOrganization=function(t){return this.elSidebar=t,new App.WidgetOrganization({el:this.elSidebar,organization_id:this.organization_id})},e.prototype.editOrganization=function(){return new App.ControllerGenericEdit({id:this.organization_id,genericObject:"Organization",pageData:{title:"Organizations",object:"Organization",objects:"Organizations"},container:this.elSidebar.closest(".content")})},e}(App.Controller),App.Config.set("300-Organization",t,"TicketCreateSidebar")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.showTemplates=n(this.showTemplates,this),this.sidebarItem=n(this.sidebarItem,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.sidebarItem=function(){if(this.permissionCheck("ticket.agent"))return this.item={name:"template",badgeIcon:"templates",badgeCallback:this.badgeRender,sidebarHead:"Templates",sidebarActions:[],sidebarCallback:this.showTemplates},this.item},e.prototype.showTemplates=function(t){return this.el=t,new App.WidgetTemplate({el:t})},e}(App.Controller),App.Config.set("100-Template",t,"TicketCreateSidebar")}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketMerge=function(t){function i(){this.onSubmit=e(this.onSubmit,this),this.content=e(this.content,this),this.onShown=e(this.onShown,this),i.__super__.constructor.apply(this,arguments),this.fetch()}return n(i,t),i.prototype.buttonClose=!0,i.prototype.buttonCancel=!0,i.prototype.buttonSubmit=!0,i.prototype.head="Merge",i.prototype.veryLarge=!0,i.prototype.shown=!1,i.prototype.fetch=function(){return this.ajax({id:"ticket_related",type:"GET",url:this.apiPath+"/ticket_related/"+this.ticket.id,processData:!0,success:(e=this,function(t){return App.Collection.loadAssets(t.assets),e.ticket_ids_by_customer=t.ticket_ids_by_customer,e.ticket_ids_recent_viewed=t.ticket_ids_recent_viewed,e.render()})});var e},i.prototype.onShown=function(t){var e,n;return i.__super__.onShown.apply(this,arguments),e=function(){if(n.tableCustomerTickets&&n.tableCustomerTickets.show(),n.tableRecentViewedTickets)return n.tableRecentViewedTickets.show()},(n=this).delay(e,300)},i.prototype.content=function(){var t;return t=$(App.view("agent_ticket_merge")()),this.tableCustomerTickets=new App.TicketList({tableId:"ticket-merge-customer-tickets",el:t.find("#ticket-merge-customer-tickets"),ticket_ids:this.ticket_ids_by_customer,radio:!0}),this.tableRecentViewedTickets=new App.TicketList({tableId:"ticket-merge-recent-tickets",el:t.find("#ticket-merge-recent-tickets"),ticket_ids:this.ticket_ids_recent_viewed,radio:!0}),t.delegate('[name="master_ticket_number"]',"focus",function(t){return $(t.target).parents().find('[name="radio"]').prop("checked",!1)}),t.delegate('[name="radio"]',"click",function(t){var e,n;if($(t.target).prop("checked"))return n=$(t.target).val(),e=App.Ticket.fullLocal(n),$(t.target).parents().find('[name="master_ticket_number"]').val(e.number)}),t},i.prototype.onSubmit=function(n){var t,i,e;return this.formDisable(n),(t=this.formParam(n.target)).master_ticket_number?this.ajax({id:"ticket_merge",type:"GET",url:this.apiPath+"/ticket_merge/"+this.ticket.id+"/"+t.master_ticket_number,processData:!0,success:(e=this,function(t){return"success"===t.result?(App.Collection.load({type:"Ticket",data:[t.master_ticket]}),App.Collection.load({type:"Ticket",data:[t.slave_ticket]}),e.close(),e.log("notice","nav...",App.Ticket.find(t.master_ticket.id)),e.navigate("#ticket/zoom/"+t.master_ticket.id),e.notify({type:"success",msg:App.i18n.translateContent("Ticket %s merged!",t.slave_ticket.number),timeout:4e3}),App.TaskManager.remove("Ticket-"+t.slave_ticket.id)):(e.notify({type:"error",msg:App.i18n.translateContent(t.message),timeout:6e3}),e.formEnable(n))}),error:(i=this,function(t){var e;return e=t.responseJSON||{},i.notify({type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to merge!"),timeout:6e3}),i.formEnable(n)})}):(alert(App.i18n.translateInline("%s required!","Ticket#")),void this.formEnable(n))},i}(App.ControllerModal)}.call(this),function(){var t,n,i,s=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}
for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=function(t){function e(){this.appEdit=s(this.appEdit,this),this.togglePasswordAccess=s(this.togglePasswordAccess,this),this.toggleTokenAccess=s(this.toggleTokenAccess,this),this.release=s(this.release,this),this.render=s(this.render,this),e.__super__.constructor.apply(this,arguments),App.Setting.fetchFull(this.render,{force:!1})}return r(e,t),e.prototype.requiredPermission="admin.api",e.prototype.header="API",e.prototype.events={"click .action":"action","change .js-TokenAccess input":"toggleTokenAccess","change .js-PasswordAccess input":"togglePasswordAccess","click .js-appNew":"appNew"},e.prototype.elements={".js-TokenAccess input":"TokenAccess",".js-PasswordAccess input":"PasswordAccess"},e.prototype.render=function(){var t,e,i;return t=App.Setting.search({filter:{area:"API::Base"}}),this.html(App.view("api")({settings:t})),this.subscribeApplicationId&&App.Setting.unsubscribe(this.subscribeApplicationId),i=this,(e=function(){var t,e,n;return t=function(t){var e;return e={name:"view",display:"View"},t.splice(3,0,e),e={name:"token",display:"Token"},t.splice(4,0,e),t},n=function(){return"X"},e=function(){return"X"},new App.ControllerTable({el:i.$(".js-appList"),model:App.Application,tableId:"applications",objects:App.Application.all(),bindRow:{events:{click:i.appEdit}},bindCol:{view:{events:{click:i.appView}},token:{events:{click:i.appToken}}},callbackHeader:[t],callbackAttributes:{view:[n],token:[e]}})})(),this.subscribeApplicationId=App.Application.subscribe(e,{initFetch:!0,clear:!0})},e.prototype.release=function(){if(e.__super__.release.apply(this,arguments),this.subscribeApplicationId)return App.Application.unsubscribe(this.subscribeApplicationId)},e.prototype.action=function(t){var e,n,i;if(t.preventDefault(),n=$(t.target).parents("[data-id]").data("id"),"uninstall"===$(t.target).data("type")&&(e="DELETE"),e)return this.ajax({id:"packages",type:e,url:this.apiPath+"/packages",data:JSON.stringify({id:n}),processData:!1,success:(i=this,function(){return i.load()})})},e.prototype.toggleTokenAccess=function(){var t;return t=this.TokenAccess.prop("checked"),App.Setting.set("api_token_access",t)},e.prototype.togglePasswordAccess=function(){var t;return t=this.PasswordAccess.prop("checked"),App.Setting.set("api_password_access",t)},e.prototype.appToken=function(t,e){return e.preventDefault(),new i({app:App.Application.find(t)})},e.prototype.appView=function(t,e){return e.preventDefault(),new n({app:App.Application.find(t)})},e.prototype.appNew=function(t){return t.preventDefault(),new App.ControllerGenericNew({pageData:{object:"Application"},genericObject:"Application",callback:(e=this,function(){return e.render()}),container:this.el.closest(".content")});var e},e.prototype.appEdit=function(t,e){var n,i;return e.preventDefault(),n=App.Application.find(t),new App.ControllerGenericEdit({id:n.id,pageData:{object:"Application"},genericObject:"Application",callback:(i=this,function(){return i.render()}),container:this.el.closest(".content")})},e}(App.ControllerSubContent),n=function(t){function e(t){this.head=t.app.name,e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.headPrefix="App",e.prototype.buttonSubmit=!1,e.prototype.buttonCancel=!0,e.prototype.shown=!0,e.prototype.small=!0,e.prototype.events={"click .js-select":"selectAll"},e.prototype.content=function(){return'AppID: <input class="js-select" type="text" value="'+this.app.uid+'"> <br> Secret: <input class="js-select" type="text" value="'+this.app.secret+'">'},e}(App.ControllerModal),i=function(t){function e(t){this.onSubmit=s(this.onSubmit,this),this.head=t.app.name,e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.headPrefix="Generate Token",e.prototype.buttonSubmit="Generate Token",e.prototype.buttonCancel=!0,e.prototype.shown=!0,e.prototype.small=!0,e.prototype.events={"click .js-select":"selectAll"},e.prototype.content=function(){return""+App.i18n.translateContent("Generate Access Token for |%s|",App.Session.get().displayNameLong())},e.prototype.onSubmit=function(){return this.ajax({id:"application_token",type:"POST",url:this.apiPath+"/applications/token",processData:!0,data:JSON.stringify({id:this.app.id}),success:(e=this,function(t){return e.contentInline=App.i18n.translateContent("New Access Token is")+': <input class="js-select" type="text" value="'+t.token+'">',e.update(),e.$(".js-submit").remove()})});var e},e}(App.ControllerModal),App.Config.set("API",{prio:1200,name:"API",parent:"#system",target:"#system/api",controller:t,permission:["admin.api"]},"NavBarAdmin")}.call(this),function(){var t,i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function n(){var e;this.description=i(this.description,this),this["delete"]=i(this["delete"],this),this.edit=i(this.edit,this),this["new"]=i(this["new"],this),this.release=i(this.release,this),this.render=i(this.render,this),n.__super__.constructor.apply(this,arguments),this.subscribeId=App.Calendar.subscribe(this.render),this.startLoading(),this.ajax({id:"calendar_index",type:"GET",url:this.apiPath+"/calendars_init",processData:!0,success:(e=this,function(t){return App.Config.set("ical_feeds",t.ical_feeds),App.Config.set("timezones",t.timezones),App.Collection.loadAssets(t.assets),e.stopLoading(),e.render()})})}return e(n,t),n.prototype.requiredPermission="admin.calendar",n.prototype.header="Calendars",n.prototype.events={"click .js-new":"new","click .js-edit":"edit","click .js-delete":"delete","click .js-default":"default","click .js-description":"description"},n.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y;for(r=0,p=(e=App.Calendar.search({sortBy:"name"})).length;r<p;r++){for(t=e[r],a=0,u=(m=["mon","tue","wed","thu","fri","sat","sun"]).length;a<u;a++)n=m[a],t.business_hours[n]||(t.business_hours[n]={});for(n in g=t.business_hours)(d=g[n]).active||(d.active=!1),d.timeframes||(d.timeframes=[]);if(f={},t.public_holidays)for(s=(new Date).setTime((new Date).getTime()-432e6),y=(new Date).setTime((new Date).getTime()+6048e6),l=0,h=(c=Object.keys(t.public_holidays).reverse()).length;l<h;l++)n=c[l],(o=new Date(Date.parse(n+"T00:00:00Z")))<y&&s<o&&t.public_holidays[n]&&t.public_holidays[n].active&&(f[n]=t.public_holidays[n]);t.public_holidays_preview=App.Utils.sortByKey(f)}return v=!1,App.Calendar.description&&(_.isEmpty(e)?i=marked(App.Calendar.description):v=!0),this.html(App.view("calendar/index")({calendars:e,showDescription:v,description:i}))},n.prototype.release=function(){if(this.subscribeId)return App.Calendar.unsubscribe(this.subscribeId)},n.prototype["new"]=function(){return new App.ControllerGenericNew({pageData:{title:this.header,object:"Calendar",objects:"Calendars"},genericObject:"Calendar",container:this.el.closest(".content"),large:!0})},n.prototype.edit=function(t){var e;return e=$(t.target).closest(".action").data("id"),new App.ControllerGenericEdit({id:e,pageData:{title:this.header,object:"Calendar",objects:"Calendars"},genericObject:"Calendar",container:this.el.closest(".content"),large:!0})},n.prototype["delete"]=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),n=App.Calendar.find(e),new App.ControllerGenericDestroyConfirm({item:n,container:this.el.closest(".content"),callback:this.load})},n.prototype["default"]=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),(n=App.Calendar.find(e))["default"]=!0,n.save()},n.prototype.description=function(){return new App.ControllerGenericDescription({description:App.Calendar.description,container:this.el.closest(".content")})},n}(App.ControllerSubContent),App.Config.set("Calendars",{prio:2400,name:"Calendars",parent:"#manage",target:"#manage/calendars",controller:t,permission:["admin.calendar"]},"NavBarAdmin")}.call(this),function(){var t,r,e,n,c=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.CustomerChat=function(t){function s(){var t,e,n,i;this.currentPosition=c(this.currentPosition,this),this.setPosition=c(this.setPosition,this),this.idleTimeoutStop=c(this.idleTimeoutStop,this),this.idleTimeoutStart=c(this.idleTimeoutStart,this),this.acceptChat=c(this.acceptChat,this),this.propagateLayoutChange=c(this.propagateLayoutChange,this),this.removeChat=c(this.removeChat,this),this.windowCount=c(this.windowCount,this),this.updateMeta=c(this.updateMeta,this),this.activeChatTopcis=c(this.activeChatTopcis,this),this["switch"]=c(this["switch"],this),this.counter=c(this.counter,this),this.active=c(this.active,this),this.show=c(this.show,this),this.featureActive=c(this.featureActive,this),this.pushState=c(this.pushState,this),this.stopPushState=c(this.stopPushState,this),this.startPushState=c(this.startPushState,this),s.__super__.constructor.apply(this,arguments),this.popovers=[],this.chatWindows={},this.maxChatWindows=4,(t=this.Session.get("preferences"))&&t.chat&&t.chat.max_windows&&(this.maxChatWindows=parseInt(t.chat.max_windows)),this.pushStateIntervalOn=void 0,this.idleTimeout=parseInt(this.Config.get("chat_agent_idle_timeout")||120),this.messageCounter=0,this.meta={active:!1,waiting_chat_count:0,waiting_chat_count_by_chat:{},waiting_chat_session_list:[],waiting_chat_session_list_by_chat:{},running_chat_count:0,running_chat_session_list:[],active_agent_count:0,active_agent_ids:[]},this.render(),this.on("layout-has-changed",this.propagateLayoutChange),this.bind("chat_status_agent",(e=this,function(t){if(t.assets&&App.Collection.loadAssets(t.assets),e.meta=t,e.updateMeta(),!0===t.active)return e.startPushState()})),this.bind("chat_session_start",(n=this,function(t){if(t.session)return n.addChat(t.session)})),this.bind("ws:login chat_agent_state",function(){return App.WebSocket.send({event:"chat_status_agent"})}),App.WebSocket.send({event:"chat_status_agent"}),this.bind("ui:rerender chat:rerender",(i=this,function(){var t,e;if(i.authenticateCheck()){for(e in t=i.chatWindows)t[e].el.remove();return i.chatWindows={},i.render(),App.WebSocket.send({event:"chat_status_agent"})}}))}return o(s,t),s.prototype.events={"click .js-acceptChat":"acceptChat","click .js-settings":"settings"},s.prototype.elements={".js-acceptChat":"acceptChatElement",".js-badgeWaitingCustomers":"badgeWaitingCustomers",".js-totalInfo":"totalInfo",".js-badgeChattingCustomers":"badgeChattingCustomers",".js-badgeActiveAgents":"badgeActiveAgents",".chat-workspace":"workspace"},s.prototype.sounds={chat_new:new Audio("assets/sounds/chat_new.mp3")},s.prototype.startPushState=function(){if(!this.pushStateIntervalOn)return this.pushStateIntervalOn=!0,this.interval(this.pushState,55e3,"pushState")},s.prototype.stopPushState=function(){return this.pushStateIntervalOn=!1,this.clearInterval("pushState")},s.prototype.pushState=function(){return App.WebSocket.send({event:"chat_agent_state",data:{active:this.meta.active}})},s.prototype.featureActive=function(){return!!this.Config.get("chat")},s.prototype.render=function(){if(this.permissionCheck("chat.agent")){if(this.Config.get("chat"))return this.html(App.view("customer_chat/index")());this.renderScreenError({detail:"Feature disabled!"})}else this.renderScreenUnauthorized({objectName:"Chat"})},s.prototype.chatSessionList=function(t){var e,n,i,s;for(t||(t=[]),i=0,s=t.length;i<s;i++)n=t[i],e=App.Chat.find(n.chat_id),n.name=e.displayName()+" [#"+n.id+"]",n.geo_data="",n.preferences&&n.preferences.geo_ip&&(n.preferences.geo_ip.country_name&&(n.geo_data+=n.preferences.geo_ip.country_name),n.preferences.geo_ip.city_name&&(n.geo_data+=" "+n.preferences.geo_ip.city_name)),n.user_id&&(n.user=App.User.find(n.user_id));return App.view("customer_chat/chat_list")({chat_sessions:t})},s.prototype.show=function(t){var e,n;if(this.title("Customer Chat",!0),this.navupdate("#customer_chat"),t.session_id)return n=this,e=function(t){return n.addChat(t)},App.ChatSession.full(t.session_id,e),this.navigate("#customer_chat")},s.prototype.active=function(t){return void 0===t?this.shown:this.shown=t},s.prototype.counter=function(){var t,e,n,i;for(e in t=0,this.meta.waiting_chat_count&&(t+=this.meta.waiting_chat_count),this.lastWaitingChatCount!==t&&(this["switch"]()&&0<t&&void 0!==this.lastWaitingChatCount&&(this.sounds.chat_new.play(),this.notifyDesktop({title:t+" "+App.i18n.translateInline("Waiting Customers"),url:"#customer_chat"})),this.lastWaitingChatCount=t),n=this.chatWindows)(i=n[e])&&(t+=i.unreadMessages());return this.messageCounter=t},s.prototype["switch"]=function(t){var e,n;return null==t&&(t=void 0),void 0===t?this.meta.active:(this.meta.active=t)?(this.startPushState(),n=this.Session.get("preferences"),App.Chat.first()&&!n||!n.chat||!n.chat.active||_.isEmpty(n.chat.active)?App.Chat.count()<2?(n.chat={},n.chat.active={},n.chat.active[App.Chat.first().id]="on",this.ajax({id:"preferences",type:"PUT",url:this.apiPath+"/users/preferences",data:JSON.stringify({chat:n.chat}),processData:!0,success:this.success,error:this.error})):(e="To be able to chat you need to select min. one chat topic below!",this.settings({errors:{settings:e},active:this.meta.active}),this.meta.active=!1,this.pushState()):void 0):(this.stopPushState(),this.pushState())},s.prototype.activeChatTopcis=function(){var t,e,n,i,s,r;if(!(s=this.Session.get("preferences")))return[];if(!s.chat)return[];if(!s.chat.active)return[];for(e=[],n=0,i=(r=App.Chat.all()).length;n<i;n++)t=r[n],"on"!==s.chat.active[t.id]&&"on"!==s.chat.active[t.id.toString()]||e.push(t);return e},s.prototype.updateMeta=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y;for(i=0,a=(u=this.popovers).length;i<a;i++)u[i].popover("destroy");if(this.popovers=[],t=this.activeChatTopcis(),this.$(".js-header").html(App.view("customer_chat/chat_header")({chats:t})),this.refreshElements(),this.meta.waiting_chat_count&&this.maxChatWindows>this.windowCount()){if(this.acceptChatElement.not("[data-chat-id]").addClass("is-active pulsate-animation"),1<t.length)for(s=0,l=t.length;s<l;s++)e=t[s],this.meta.waiting_chat_count_by_chat[e.id]&&this.$(".js-header .js-acceptChat[data-chat-id="+e.id+"]").addClass("is-active pulsate-animation").attr("disabled",!1);this.idleTimeoutStart()}else this.acceptChatElement.removeClass("is-active pulsate-animation"),this.idleTimeoutStop();if(1<t.length)for(h=App.Chat.all(),g=this,n=function(t){return g.$(".js-header .js-waitingCustomers[data-chat-id="+t.id+"] .js-badgeWaitingCustomers").text(g.meta.waiting_chat_count_by_chat[t.id]),g.popovers.push(g.el.find(".js-waitingCustomers[data-chat-id="+t.id+"] .js-info").popover({trigger:"hover",html:!0,animation:!1,delay:0,placement:"bottom",container:"body",title:function(){return App.i18n.translateContent("Waiting Customers")},content:function(){return g.chatSessionList(g.meta.waiting_chat_session_list_by_chat[t.id])}}))},r=0,c=h.length;r<c;r++)n(e=h[r]);else this.badgeWaitingCustomers.text(this.meta.waiting_chat_count),this.popovers.push(this.el.find(".js-waitingCustomers .js-totalInfo").popover({trigger:"hover",html:!0,animation:!1,delay:0,placement:"bottom",container:"body",title:function(){return App.i18n.translateContent("Waiting Customers")},content:(m=this,function(){return m.chatSessionList(m.meta.waiting_chat_session_list_by_chat[t[0].id])})}));if(this.badgeChattingCustomers.text(this.meta.running_chat_count),this.badgeActiveAgents.text(this.meta.active_agent_count),this.meta.active_sessions)for(o=0,p=(d=this.meta.active_sessions).length;o<p;o++)f=d[o],this.addChat(f);return this.meta.active_sessions=!1,this.popovers.push(this.el.find(".js-chattingCustomers .js-info").popover({trigger:"hover",html:!0,animation:!1,delay:0,placement:"bottom",container:"body",title:function(){return App.i18n.translateContent("Chatting Customers")},content:(v=this,function(){return v.chatSessionList(v.meta.running_chat_session_list)})})),this.popovers.push(this.el.find(".js-activeAgents .js-info").popover({trigger:"hover",html:!0,animation:!1,delay:0,placement:"bottom",container:"body",title:function(){return App.i18n.translateContent("Active Agents")},content:(y=this,function(){var t,e,n,i,s;for(s=[],e=0,t=(n=y.meta.active_agent_ids).length;e<t;e++)i=n[e],s.push(App.User.find(i));return App.view("customer_chat/user_list")({users:s})})})),this.updateNavMenu()},s.prototype.addChat=function(t){var e;if(!this.chatWindows[t.session_id])return e=new r({session:t,removeCallback:this.removeChat,messageCallback:this.updateNavMenu}),this.workspace.append(e.el),e.render(),this.chatWindows[t.session_id]=e,1===this.windowCount()?e.focus():void 0},s.prototype.windowCount=function(){var t,e;for(t in e=0,this.chatWindows)e++;return e},s.prototype.removeChat=function(t){return delete this.chatWindows[t],this.updateMeta()},s.prototype.propagateLayoutChange=function(){var t,e,n,i;for(i in n=[],e=this.chatWindows)t=e[i],n.push(t.trigger("layout-changed"));return n},s.prototype.acceptChat=function(t){var e;if(!(this.windowCount()>=this.maxChatWindows))return e=$(t.currentTarget).attr("data-chat-id"),App.WebSocket.send({event:"chat_session_start",chat_id:e}),this.idleTimeoutStop()},s.prototype.settings=function(t){return null==t&&(t={}),new n({windowSpace:this,errors:t.errors,active:t.active})},s.prototype.idleTimeoutStart=function(){var t,e;if(!this.idleTimeoutId)return t=function(){return e["switch"](!1),e.notify({type:"notice",msg:App.i18n.translateContent("Chat not answered, set to offline automatically.")})},(e=this).idleTimeoutId=this.delay(t,1e3*this.idleTimeout)},s.prototype.idleTimeoutStop=function(){if(this.idleTimeoutId)return this.clearDelay(this.idleTimeoutId),this.idleTimeoutId=void 0},s.prototype.setPosition=function(t){return this.$(".main").scrollTop(t)},s.prototype.currentPosition=function(){return this.$(".main").scrollTop()},s}(App.Controller),r=function(t){function l(){var e,n,i,s,r,o,a;this.ticketCreate=c(this.ticketCreate,this),this.transfer=c(this.transfer,this),this.detectScrolledtoBottom=c(this.detectScrolledtoBottom,this),this.addTimestamp=c(this.addTimestamp,this),this.goOffline=c(this.goOffline,this),this.removeWritingLoader=c(this.removeWritingLoader,this),this.showWritingLoader=c(this.showWritingLoader,this),this.addMessage=c(this.addMessage,this),this.resetUnreadMessages=c(this.resetUnreadMessages,this),this.addUnreadMessages=c(this.addUnreadMessages,this),this.unreadMessages=c(this.unreadMessages,this),this.receiveMessage=c(this.receiveMessage,this),this.updateModified=c(this.updateModified,this),this.sendMessage=c(this.sendMessage,this),this.onKeydown=c(this.onKeydown,this),this.onKeyup=c(this.onKeyup,this),this.clearUnread=c(this.clearUnread,this),this.release=c(this.release,this),this.close=c(this.close,this),this.disconnect=c(this.disconnect,this),this.onTransitionend=c(this.onTransitionend,this),this.focus=c(this.focus,this),this.displayFlag=c(this.displayFlag,this),this.sendMetaForm=c(this.sendMetaForm,this),this.showMeta=c(this.showMeta,this),this.hideMeta=c(this.hideMeta,this),this.toggleMeta=c(this.toggleMeta,this),this.onLayoutChange=c(this.onLayoutChange,this),this.raiseFlagBtnClick=c(this.raiseFlagBtnClick,this),this.peekAgentBtnClick=c(this.peekAgentBtnClick,this),this.peekCustomerBtnClick=c(this.peekCustomerBtnClick,this),this.whisperingBtnClick=c(this.whisperingBtnClick,this),this.adjustForMonitoring=c(this.adjustForMonitoring,this),l.__super__.constructor.apply(this,arguments),this.showTimeEveryXMinutes=2,this.lastTimestamp,this.lastAddedType,this.isTyping=!1,this.isAgentTyping=!1,this.resetUnreadMessages(),this.scrolledToBottom=!0,this.scrollSnapTolerance=10,this.flag_raised=this.session.flag_raised,this.whispering=!1,this.peekingCustomer=!1,this.peekingAgent=!1,this.chat=App.Chat.find(this.session.chat_id),this.name=this.chat.displayName(),this.session&&!_.isEmpty(this.session.name)&&(this.name=this.session.name),this.on("layout-change",this.onLayoutChange),this.bind("chat_session_typing",(e=this,function(t){if(t.session_id===e.session.session_id&&!t.self_written)return e.showWritingLoader()})),this.bind("chat_session_message",(n=this,function(t){if(t.session_id===n.session.session_id&&(n.monitored||!t.self_written))return n.receiveMessage(t.message)})),this.bind("chat_session_notice",(i=this,function(t){if(t.session_id===i.session.session_id&&!t.self_written)return i.addNoticeMessage(t.message)})),this.bind("chat_session_left",(s=this,function(t){if(t.session_id===s.session.session_id&&!t.self_written)return s.addStatusMessage("<strong>"+t.realname+"</strong> left the conversation"),s.goOffline()})),this.bind("chat_session_closed",(r=this,function(t){if(t.session_id===r.session.session_id&&!t.self_written)return r.addStatusMessage("<strong>"+t.realname+"</strong> closed the conversation"),r.goOffline()})),this.bind("chat_focus",(o=this,function(t){if(t.session_id===o.session.session_id)return o.focus()})),this.bind("chat_session_flag",(a=this,function(t){if(t.session_id===a.session.session_id)return a.flag_raised=t.state,a.displayFlag()}))}return o(l,t),l.prototype.className="chat-window",l.prototype.events={"keydown .js-customerChatInput":"onKeydown","keyup .js-customerChatInput":"onKeyup","focus .js-customerChatInput":"clearUnread",click:"clearUnread","click .js-send":"sendMessage","click .js-close":"close","click .js-disconnect":"disconnect","click .js-scrollHint":"onScrollHintClick","click .js-info":"toggleMeta","click .js-createTicket":"ticketCreate","click .js-transferChat":"transfer","click .js-chat-btn.whisper":"whisperingBtnClick","click .js-chat-btn.peek-customer":"peekCustomerBtnClick","click .js-chat-btn.peek-agent":"peekAgentBtnClick","click .js-chat-btn.raise-flag":"raiseFlagBtnClick","submit .js-metaForm":"sendMetaForm"},l.prototype.elements={".js-chat-header":"header",".js-send":"send",".js-customerChatInput":"input",".js-status":"status",".js-close":"closeButton",".js-disconnect":"disconnectButton",".js-body":"body",".js-meta":"meta",".js-name":"metaName",".js-scrollHolder":"scrollHolder",".js-scrollHint":"scrollHint",".js-metaForm":"metaForm",".js-chat-btn.whisper":"whisperBtn",".js-chat-btn.peek-customer":"peekCustomerBtn",".js-chat-btn.peek-agent":"peekAgentBtn",".js-chat-btn.raise-flag":"raiseFlagBtn"},l.prototype.sounds={message:new Audio("assets/sounds/chat_message.mp3")},l.prototype.adjustForMonitoring=function(){return this.header.parent().css("min-height","400px"),this.disconnectButton.addClass("is-hidden"),this.closeButton.removeClass("is-hidden"),this.peekAgentBtn.removeClass("hidden")},l.prototype.whisperingBtnClick=function(){return this.whispering=!this.whispering,this.whisperBtn.hasClass("enabled")?this.whisperBtn.removeClass("enabled"):this.whisperBtn.addClass("enabled")},l.prototype.peekCustomerBtnClick=function(){return this.peekingCustomer=!this.peekingCustomer,this.peekCustomerBtn.hasClass("enabled")?this.peekCustomerBtn.removeClass("enabled"):this.peekCustomerBtn.addClass("enabled")},l.prototype.peekAgentBtnClick=function(){return this.peekingAgent=!this.peekingAgent,this.peekAgentBtn.hasClass("enabled")?this.peekAgentBtn.removeClass("enabled"):this.peekAgentBtn.addClass("enabled")},l.prototype.raiseFlagBtnClick=function(){return this.flagRaised=!this.flagRaised,this.raiseFlagBtn.hasClass("enabled")?(this.raiseFlagBtn.removeClass("enabled"),App.WebSocket.send({event:"chat_session_flag",session_id:this.session.session_id,state:!1})):this.monitored?void 0:(App.WebSocket.send({event:"chat_session_flag",session_id:this.session.session_id,state:!0}),this.raiseFlagBtn.addClass("enabled"))},l.prototype.onLayoutChange=function(){return this.scrollToBottom()},l.prototype.toggleMeta=function(){return this.meta.hasClass("hidden")?this.showMeta():this.hideMeta()},l.prototype.hideMeta=function(){return this.body.removeClass("hidden"),this.meta.addClass("hidden"),this.sendMetaForm()},l.prototype.showMeta=function(){return this.body.addClass("hidden"),this.meta.removeClass("hidden")},l.prototype.sendMetaForm=function(t){var e;if(t&&t.preventDefault(),e=this.formParam(this.metaForm),App.WebSocket.send({event:"chat_session_update",data:{session_id:this.session.session_id,name:e.name,tags:e.tags}}),!_.isEmpty(e.name))return this.metaName.text(e.name)},l.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c;if(this.html(App.view("customer_chat/chat_window")({name:this.name,session:this.session,chats:App.Chat.all()})),this.el.one("transitionend",this.onTransitionend),this.scrollHolder.scroll(this.detectScrolledtoBottom),this.el.prop("offsetHeight"),this.el.addClass("is-open"),this.session){if(t=!0,"closed"===this.session.state&&(t=!1),this.session&&this.session.preferences&&this.session.preferences.url&&this.addNoticeMessage(this.session.preferences.url,void 0,t),this.session.messages)for(n=0,i=(c=this.session.messages).length;n<i;n++)(s=c[n]).created_by_id?this.addMessage(s.content,"agent",!1,t,s.whispering):this.addMessage(s.content,"customer",!1,t,s.whispering);t&&_.isEmpty(this.session.messages)&&(l=this.Session.get("preferences")).chat&&l.chat.phrase&&(o=l.chat.phrase[this.session.chat_id])&&(r=(a=o.split(";"))[_.random(0,a.length-1)],this.input.html(r),this.sendMessage(1600)),t||this.goOffline()}return new App.WidgetTextModule({el:this.input,data:{user:App.Session.get(),config:App.Config.all()}}),e=[{name:"name",display:"Name",tag:"input","null":!0},{name:"tags",display:"Tags",tag:"tag","null":!0}],new App.ControllerForm({el:this.$(".js-metaForm"),model:{configure_attributes:e,className:""},params:this.session}),this.displayFlag()},l.prototype.displayFlag=function(){if(this.flag_raised){if(this.raiseFlagBtn.hasClass("enabled")||this.raiseFlagBtn.addClass("enabled"),this.raiseFlagBtn.hasClass("hidden")&&this.raiseFlagBtn.removeClass("hidden"),this.monitored&&(this.header.parent().hasClass("bounce")||this.header.parent().addClass("bounce"),console.log(this.row),!this.row.hasClass(".flashing-row")))return this.row.addClass(".flashing-row")}else if(this.raiseFlagBtn.hasClass("enabled")&&this.raiseFlagBtn.removeClass("enabled"),this.monitored&&(this.header.parent().hasClass("bounce")&&this.header.parent().removeClass("bounce"),this.raiseFlagBtn.addClass("hidden"),this.row.hasClass(".flashing-row")))return this.row.removeClass(".flashing-row")},l.prototype.focus=function(){return this.input.focus()},l.prototype.onTransitionend=function(t){return this.trigger("layout-has-changed"),t.data&&t.data.callback&&t.data.callback(),this.input.ce({mode:"richtext",multiline:!0,maxlength:4e4,imageWidth:"relative"})},l.prototype.disconnect=function(){return this.addStatusMessage("<strong>You</strong> left the conversation"),App.WebSocket.send({event:"chat_session_close",data:{session_id:this.session.session_id}}),this.goOffline()},l.prototype.close=function(){if(this.sendMetaForm(),this.el.one("transitionend",{callback:this.release},this.onTransitionend),this.el.removeClass("is-open"),this.removeCallback)return this.removeCallback(this.session.session_id)},l.prototype.release=function(){return this.trigger("closed"),this.el.remove(),l.__super__.release.apply(this,arguments)},l.prototype.clearUnread=function(){return this.$(".chat-message--new").removeClass("chat-message--new"),this.updateModified(!1),this.resetUnreadMessages()},l.prototype.onKeyup=function(t){var e,n;if(n=9,e=13,t.keyCode!==n&&t.keyCode!==e&&!this.monitored)return App.WebSocket.send({event:"chat_session_message",data:{content:this.input.html(),session_id:this.session.session_id,whispering:this.whispering,sneak_peek:!0}})},l.prototype.onKeydown=function(t){var e,n,i,s,r;if(n=9,e=13,t.keyCode!==n&&t.keyCode!==e){if(!this.whispering&&this.isAgentTyping&&this.isAgentTyping>new Date((new Date).getTime()-1400))return;this.isAgentTyping=new Date,App.WebSocket.send({event:"chat_session_typing",data:{session_id:this.session.session_id}})}switch(t.keyCode){case n:if(s=(i=this.input.not('[disabled="disabled"]')).size(),r=i.index(this.input),1<s)switch(r){case s-1:if(!t.shiftKey)return t.preventDefault(),i.eq(0).focus();break;case 0:if(t.shiftKey)return t.preventDefault(),i.eq(s-1).focus()}break;case e:if(!(t.shiftKey||t.altKey||t.ctrlKey||t.metaKey))return t.preventDefault(),this.sendMessage()}},l.prototype.sendMessage=function(t){var e,n,i;if((e=this.input.html())&&!this.el.hasClass("is-offline"))return i=this,n=function(){return App.WebSocket.send({event:"chat_session_message",data:{content:e,session_id:i.session.session_id,whispering:i.whispering}})},t?(App.WebSocket.send({event:"chat_session_typing",data:{session_id:this.session.session_id}}),this.delay(n,t)):n(),this.hideMeta(),this.monitored||this.addMessage(e,"agent",!1,!0,this.whispering),this.input.html("")},l.prototype.updateModified=function(t){return this.status.toggleClass("is-modified",t)},l.prototype.receiveMessage=function(t){var e,n;if(e=this.input.is(":focus"),this.removeWritingLoader(),t.created_by_id?this.addMessage(t.content,"agent",!e,!0,t.whispering,t.sneak_peek):this.addMessage(t.content,"customer",!e,!0,t.whispering,t.sneak_peek),!e&&!t.sneak_peek)return this.addUnreadMessages(),this.updateModified(!0),this.sounds.message.play(),this.notifyDesktop({title:this.name,body:App.Utils.html2text(t.content),url:"#customer_chat",callback:(n=this,function(){return App.Event.trigger("chat_focus",{session_id:n.session.session_id})})})},l.prototype.unreadMessages=function(){return this.unreadMessagesCounter},l.prototype.addUnreadMessages=function(){return this.messageCallback&&this.messageCallback(this.session.session_id),this.unreadMessagesCounter+=1},l.prototype.resetUnreadMessages=function(){return this.messageCallback&&this.messageCallback(this.session.session_id),this.unreadMessagesCounter=0},l.prototype.addMessage=function(t,e,n,i,s,r){var o;if(null==i&&(i=!0),null==s&&(s=!1),null==r&&(r=!1),r){if("customer"===e&&!this.peekingCustomer)return;if("agent"===e&&!this.peekingAgent)return}return 0<(o=this.$(".chat-message--"+e+".chat-message--sneak-peek")).length&&r?(o.text(t),!s&&o.hasClass("chat-message--whispered")?o.removeClass("chat-message--whispered"):s&&!o.hasClass("chat-message--whispered")?o.addClass("chat-message--whispered"):void 0):(o.remove(),i&&this.maybeAddTimestamp(),this.lastAddedType=e,this.body.append(App.view("customer_chat/chat_message")({message:t,sender:e,isNew:n,timestamp:Date.now(),whispered:s,sneakPeekMessage:r})),this.scrollToBottom({showHint:!0}))},l.prototype.showWritingLoader=function(){return this.isTyping||(this.isTyping=!0,this.maybeAddTimestamp(),this.body.append(App.view("customer_chat/chat_loader")()),this.scrollToBottom()),this.delay(this.removeWritingLoader,2e3,"typing")},l.prototype.removeWritingLoader=function(){return this.isTyping=!1,this.$(".js-loader").remove()},l.prototype.goOffline=function(){return this.status.attr("data-status","offline"),this.disconnectButton.addClass("is-hidden"),this.closeButton.removeClass("is-hidden"),this.el.addClass("is-offline"),this.input.attr("disabled",!0),this.body.append(App.view("customer_chat/chat_footer")())},l.prototype.maybeAddTimestamp=function(){var t,e,n;if(n=Date.now(),!this.lastTimestamp||n-this.lastTimestamp>6e4*this.showTimeEveryXMinutes)return t=App.i18n.translateInline("today"),e=(new Date).toTimeString().substr(0,5),"timestamp"===this.lastAddedType?(this.updateLastTimestamp(t,e),this.lastTimestamp=n):(this.addTimestamp(t,e),this.lastTimestamp=n,this.lastAddedType="timestamp")},l.prototype.addTimestamp=function(t,e){return this.body.append(App.view("customer_chat/chat_timestamp")({label:t,time:e}))},l.prototype.updateLastTimestamp=function(t,e){return this.body.find(".js-timestamp").last().replaceWith(App.view("customer_chat/chat_timestamp")({label:t,time:e}))},l.prototype.addStatusMessage=function(t,e,n){return null==n&&(n=!0),n&&this.maybeAddTimestamp(),this.body.append(App.view("customer_chat/chat_status_message")({message:t,args:e})),this.scrollToBottom()},l.prototype.addNoticeMessage=function(t,e,n){return null==n&&(n=!0),n&&this.maybeAddTimestamp(),this.body.append(App.view("customer_chat/chat_notice_message")({message:t,args:e})),this.scrollToBottom()},l.prototype.detectScrolledtoBottom=function(){var t;if(t=this.scrollHolder.scrollTop()+this.scrollHolder.outerHeight(),this.scrolledToBottom=Math.abs(t-this.scrollHolder.prop("scrollHeight"))<=this.scrollSnapTolerance,this.scrolledToBottom)return this.scrollHint.addClass("is-hidden")},l.prototype.showScrollHint=function(){
return this.scrollHint.removeClass("is-hidden"),this.scrollHolder.scrollTop(this.scrollHolder.scrollTop()+this.scrollHint.outerHeight())},l.prototype.onScrollHintClick=function(){return this.scrollHolder.animate({scrollTop:this.scrollHolder.prop("scrollHeight")},300)},l.prototype.scrollToBottom=function(t){var e;return e=(null!=t?t:{showHint:!1}).showHint,this.scrolledToBottom?this.scrollHolder.scrollTop(this.scrollHolder.prop("scrollHeight")):e?this.showScrollHint():void 0},l.prototype.transfer=function(t){var e;return t.preventDefault(),e=$(t.currentTarget).attr("data-chat-id"),App.WebSocket.send({event:"chat_transfer",chat_id:e,session_id:this.session.id}),this.close()},l.prototype.ticketCreate=function(t){var e,n,i,s,r,o;return t.preventDefault(),s=Math.floor(99999*Math.random()),this.navigate("#ticket/create/id/"+s),n=App.Config.get("fqdn"),i=App.Config.get("http_type"),o="",(r=this.session)&&!r.uiUrl&&(r=new App.ChatSession(r)),r&&r.uiUrl&&(o=r.uiUrl()),e={id:s,prefilledParams:{body:i+"://"+n+"/"+o,title:"Chat"}},App.TaskManager.execute({key:"TicketCreateScreen-"+s,controller:"TicketCreate",params:e,show:!0})},l}(App.Controller),n=function(t){function e(){return this.error=c(this.error,this),this.success=c(this.success,this),this.submit=c(this.submit,this),this.content=c(this.content,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.head="Settings",e.prototype.content=function(){var t;return(t=this.Session.get("preferences"))||(t={}),t.chat||(t.chat={}),t.chat.active||(t.chat.active={}),t.chat.phrase||(t.chat.phrase={}),t.chat.max_windows||(t.chat.max_windows=this.windowSpace.maxChatWindows),App.view("customer_chat/setting")({chats:App.Chat.all(),preferences:t,errors:this.errors||{}})},e.prototype.submit=function(t){var e;return t.preventDefault(),e=this.formParam(t.target),this.formDisable(t),this.windowSpace.maxChatWindows=e.chat.max_windows,!e.chat||!_.isEmpty(e.chat.active)&&_.includes(_.values(e.chat.active),"on")||(this.active=!1),this.ajax({id:"preferences",type:"PUT",url:this.apiPath+"/users/preferences",data:JSON.stringify(e),processData:!0,success:this.success,error:this.error})},e.prototype.success=function(){return!0===this.active||!1===this.active?(this.windowSpace.meta.active=this.active,this.windowSpace.pushState()):App.WebSocket.send({event:"chat_status_agent"}),App.User.full(App.Session.get("id"),(t=this,function(){return t.close()}),!0);var t},e.prototype.error=function(t){var e;return e=JSON.parse(t.responseText),this.notify({type:"error",msg:App.i18n.translateContent(e.message)})},e}(App.ControllerModal),e=function(t){function n(t){var e;n.__super__.constructor.apply(this,arguments),e={session_id:t.session_id},App.TaskManager.execute({key:"CustomerChat",controller:"CustomerChat",params:e,show:!0,persistent:!0})}return o(n,t),n.prototype.requiredPermission="chat.agent",n}(App.ControllerPermanent),App.Config.set("customer_chat",e,"Routes"),App.Config.set("customer_chat/session/:session_id",e,"Routes"),App.Config.set("CustomerChat",{controller:"CustomerChat",permission:["chat.agent"]},"permanentTask"),App.Config.set("CustomerChat",{prio:1200,parent:"",name:"Customer Chat",target:"#customer_chat",key:"CustomerChat",shown:!1,permission:["chat.agent"],"class":"chat"},"NavBar"),App.ChatMonitor=function(t){function n(){var t,e;this.counter=c(this.counter,this),n.__super__.constructor.apply(this,arguments),this.render(),this.bind("chat_session_start",(t=this,function(){return t.showTable()})),this.bind("chat_session_flag",(e=this,function(t){return t.state?(i++,e.sounds.flag_new.play()):i=Math.max(0,i-1),e.updateNavMenu(),e.showTable()}))}var a,i,l;return o(n,t),n.prototype.elements={"#chat-table-wrapper":"table_wrapper"},l=[],i=0,n.prototype.sounds={flag_new:new Audio("assets/sounds/chat_new.mp3")},n.prototype.render=function(){if(this.permissionCheck("chat.supervisor"))return this.navupdate("#chat_monitor"),this.html(App.view("chat_monitor/index")()),this.showTable();this.renderScreenUnauthorized({objectName:"Chat"})},n.prototype.showTable=function(){return this.ajax({id:"chat_session_index",type:"GET",url:App.Config.get("api_path")+"/chat_monitor",processData:!0,context:this,success:(e=this,function(t){return l=t,e.table_wrapper.html(""),e.table=new App.ControllerTable({tableId:"chat-monitoring-table",el:e.table_wrapper,overview:["state","id","user_id","stop_chatbot","flag_raised","created_at"],attribute_list:[{name:"id",display:"Session Id"},{name:"chat_id",display:"Chat Id"},{name:"user_id",display:"Agent Id"},{name:"flag_raised",display:"Requiring help"},{name:"stop_chatbot",display:"Handoff"},{name:"name",display:"Name",tag:"input",type:"text",limit:100,"null":!1},{name:"state",display:"State",readonly:1},{name:"created_by_id",display:"Created by",relation:"User",readonly:1},{name:"created_at",display:"Created",tag:"datetime",readonly:1},{name:"updated_by_id",display:"Updated by",relation:"User",readonly:1},{name:"updated_at",display:"Updated",tag:"datetime",readonly:1}],orderBy:"created_at",orderDirection:"DESC",objects:t,callbackHeader:null,callbackAttributes:null,radio:!0,bindRow:{events:{click:e.rowClick}}})})});var e},a=function(t,e){var n;return n=new r({session:t,removeCallback:this.removeChat,messageCallback:this.updateNavMenu,monitored:!0,row:e}),$("#monitored-chats").append(n.el),n.render(),n},n.prototype.rowClick=function(t,e){var n,i,s,r,o;for(e.preventDefault(),r=$(e.target),s=[],n=0,i=l.length;n<i;n++){if((o=l[n]).id===t){$.ajax({id:"chat_session_messages",type:"GET",url:App.Config.get("api_path")+"/chat_monitor/messages/"+t,processData:!0,success:function(t){return o.messages=t,a(o,r).adjustForMonitoring()}});break}s.push(void 0)}return s},n.prototype.counter=function(){return i},n}(App.Controller),t=function(t){function n(t){var e;n.__super__.constructor.apply(this,arguments),e={session_id:t.session_id},App.TaskManager.execute({key:"ChatMonitor",controller:"ChatMonitor",params:e,show:!0,persistent:!0})}return o(n,t),n.prototype.requiredPermission="chat.supervisor",n}(App.ControllerPermanent),App.Config.set("chat_monitor",t,"Routes"),App.Config.set("chat_monitor/session/:session_id",t,"Routes"),App.Config.set("ChatMonitor",{controller:"ChatMonitor",permission:["chat.supervisor"]},"permanentTask"),App.Config.set("ChatMonitor",{prio:1300,parent:"",name:"Chat Monitor",target:"#chat_monitor",key:"ChatMonitor",shown:!0,permission:["chat.supervisor"],"class":"eye"},"NavBar")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.clues=n(this.clues,this),e.__super__.constructor.apply(this,arguments),this.navupdate("#",!0),this.clues()}return i(e,t),e.prototype.clues=function(){return new App.FirstStepsClues({el:this.el,onComplete:(t=this,function(){return App.Ajax.request({id:"preferences",type:"PUT",url:t.apiPath+"/users/preferences",data:JSON.stringify({intro:!0}),processData:!0}),t.navigate("#")})});var t},e}(App.Controller),App.Config.set("clues",t,"Routes")}.call(this),function(){var t,r,c=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.CTI=function(t){function l(){var t,e,n,r,i,s,o,a;this.currentPosition=c(this.currentPosition,this),this.setPosition=c(this.setPosition,this),this["switch"]=c(this["switch"],this),this.counter=c(this.counter,this),this.active=c(this.active,this),this.show=c(this.show,this),this.newTicket=c(this.newTicket,this),this.done=c(this.done,this),this.doneAll=c(this.doneAll,this),this.featureActive=c(this.featureActive,this),this.ringingCalls=c(this.ringingCalls,this),l.__super__.constructor.apply(this,arguments),t=this.Session.get("preferences")||{},this.meta.active=t.cti||!1,this.load(),this.bind("cti_list_push",(e=this,function(){var t;return t=function(){return e.load()},e.delay(t,500,"cti_list_push_render"),"cti_list_push"})),this.bind("cti_event",(n=this,function(t){if("newCall"===t.state&&"in"===t.direction&&!0===n["switch"]())return document.hasFocus()||n.notify(t),"cti_event"})),this.bind("menu:render",(r=this,function(){var t,e,n,i,s;if(!0===r["switch"]()){for(i="",t=0,n=(s=r.ringingCalls()).length;t<n;t++)e=s[t],i+=App.view("navigation/menu_cti_ringing")({item:e});return $(".js-phoneMenuItem").after(i),$(".call-widget").find(".js-newUser").bind("click",function(t){return r.newUser(t)}),$(".call-widget").find(".js-newTicket").bind("click",function(t){var e,n;return e=void 0,(n=$(t.currentTarget).data("user-id"))&&(e=App.User.find(n)),console.log("user_id",n,e),r.newTicket(e)})}})),this.bind("auth",(i=this,function(){return i.meta.counter=0})),this.bind("cti:reload",(s=this,function(){return s.load(),"cti_reload"})),this.bind("ui:rerender",(o=this,function(){return o.render(),"cti_rerender"})),this.bind("spool:sent",(a=this,function(){if(!a.initSpoolSent)return a.initSpoolSent=!0;a.load()}))}return n(l,t),l.extend(App.PopoverProvidable),l.registerPopovers("User"),l.prototype.elements={".js-callerLog":"callerLog"},l.prototype.events={"click .js-check":"done","click .js-checkAll":"doneAll","click .js-newUser":"newUser"},l.prototype.list=[],l.prototype.backends=[],l.prototype.meta={active:!1,counter:0,state:{}},l.prototype.backendEnabled=!1,l.prototype.ringingCalls=function(){var t,e,n,i,s;for(i=[],t=0,e=(n=this.list).length;t<e;t++)"newCall"===(s=n[t]).state&&!1===s.done&&i.push(s);return i},l.prototype.load=function(){return this.ajax({id:"cti_log",type:"GET",url:this.apiPath+"/cti/log",success:(r=this,function(t){var e,n,i,s;if(t.assets&&App.Collection.loadAssets(t.assets),t.backends){for(r.backends=t.backends,e=!1,n=0,i=(s=r.backends).length;n<i;n++)s[n].enabled&&(e=!0);e!==r.backendEnabled&&(r.renderDone=!1),r.backendEnabled=e}if(t.list)return r.list=t.list,r.updateNavMenu(),r.renderDone?void r.renderCallerLog():r.render()})});var r},l.prototype.notify=function(t){var e,n;return e=App.i18n.translateContent("Call from %s for %s",t.from_comment||t.from,t.to_comment||t.to),n=App.Utils.html2text(e.replace(/<.+?>/g,'"')),this.notifyDesktop({url:"#cti",title:n})},l.prototype.featureActive=function(){return!!this.Config.get("sipgate_integration")||(!!this.Config.get("cti_integration")||!!this.Config.get("placetel_integration"))},l.prototype.render=function(){if(this.renderDone=!0,this.permissionCheck("cti.agent"))return this.backendEnabled?(this.html(App.view("cti/index")()),this.renderCallerLog()):(this.html(App.view("cti/not_configured")({backends:this.backends,isAdmin:this.permissionCheck("admin.integration")})),void this.updateNavMenu());this.renderScreenUnauthorized({objectName:"CTI"})},l.prototype.renderCallerLog=function(){var t,e,n,i,s;for(t=0,n=(s=this.list).length;t<n;t++)(e=s[t]).status_class="",e.disabled=!0,"newCall"===e.state?(e.state_human="ringing",e.status_class="neutral"):"answer"===e.state?(e.state_human="connected",e.status_class="ok"):"hangup"===e.state?(e.disabled=!1,e.state_human=function(){switch(e.comment){case"cancel":case"noAnswer":case"congestion":return"not reached";case"busy":return"busy";case"notFound":return"not exist";case"normalClearing":return"";default:return e.comment}}()):(e.state_human=e.state,e.comment&&(e.state_human+=", "+e.comment)),1<(Date.now()-Date.parse(e.created_at))/1e3/60&&(e.disabled=!1);return this.removePopovers(),(i=$(App.view("cti/caller_log")({list:this.list}))).find(".js-avatar").each(function(){var t;return t=$(this),new r({el:t,object_id:t.attr("data-id"),level:t.attr("data-level"),size:40})}),this.callerLog.html(i),this.updateNavMenu()},l.prototype.doneAll=function(){return this.logIds=$(".js-callerLog").map(function(){if(!$(this).find(".js-check").prop("checked"))return $(this).data("id")}).get(),this.ajax({type:"POST",url:this.apiPath+"/cti/done/bulk",data:JSON.stringify({ids:this.logIds})})},l.prototype.done=function(t){var e,n,i;return i=(n=$(t.currentTarget)).closest("tr").data("id"),e=n.prop("checked"),this.ajax({type:"POST",url:this.apiPath+"/cti/done/"+i,data:JSON.stringify({done:e}),queue:"cti_done_queue"})},l.prototype.newTicket=function(t){if(!t)return this.navigate("ticket/create");this.navigate("ticket/create/customer/"+t.id)},l.prototype.newUser=function(t){var e;return t.preventDefault(),e=$(t.currentTarget).data("phone"),new App.ControllerGenericNew({pageData:{title:"Users",home:"users",object:"User",objects:"Users",navupdate:"#users"},genericObject:"User",item:{phone:e},callback:this.ticketNew})},l.prototype.ticketNew=function(t){return this.navigate("#ticket/create/customer/"+t.id)},l.prototype.show=function(){return this.title("CTI",!0),this.navupdate("#cti")},l.prototype.active=function(t){return void 0===t?this.shown:this.shown=t},l.prototype.counter=function(){var t,e,n,i;for(e=t=0,n=(i=this.list).length;e<n;e++)i[e].done||t++;return this.meta.counter=t},l.prototype["switch"]=function(t){return null==t&&(t=void 0),void 0===t?this.meta.active:(this.meta.active=t,this.ajax({id:"preferences",type:"PUT",url:this.apiPath+"/users/preferences",data:JSON.stringify({cti:t}),processData:!0}))},l.prototype.setPosition=function(t){return this.$(".main").scrollTop(t)},l.prototype.currentPosition=function(){return this.$(".main").scrollTop()},l}(App.Controller),r=function(t){function e(){return this.render=c(this.render,this),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.extend(App.PopoverProvidable),e.registerPopovers("User"),e.prototype.model="User",e.prototype.observe={login:!0,firstname:!0,lastname:!0,organization_id:!0,email:!0,image:!0,vip:!0,out_of_office:!0,out_of_office_start_at:!0,out_of_office_end_at:!0,out_of_office_replacement_id:!0,active:!0},e.prototype.globalRerender=!1,e.prototype.render=function(t){var e;return e=["user-popover","u-textTruncate"],t.active||e.push("is-inactive"),this.html(App.view("cti/caller_log_avatar")({user:t,classes:e,level:this.level})),this.renderPopovers()},e}(App.ObserverController),t=function(t){function e(t){e.__super__.constructor.apply(this,arguments),App.TaskManager.execute({key:"CTI",controller:"CTI",params:{},show:!0,persistent:!0})}return n(e,t),e.prototype.requiredPermission="cti.agent",e}(App.ControllerPermanent),App.Config.set("cti",t,"Routes"),App.Config.set("CTI",{controller:"CTI",permission:["cti.agent"]},"permanentTask"),App.Config.set("CTI",{prio:1300,parent:"",name:"Phone",target:"#cti",key:"CTI",shown:!1,permission:["cti.agent"],"class":"phone"},"NavBar")}.call(this),function(){var t,s=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function i(t){var e,n;this.submitEnable=s(this.submitEnable,this),this.submitDisable=s(this.submitDisable,this),i.__super__.constructor.apply(this,arguments),this.title("New Ticket"),this.form_id=App.ControllerForm.formId(),this.navupdate("#customer_ticket_new"),e=function(t){return App.Collection.loadAssets(t.assets),n.formMeta=t.form_meta,n.render()},(n=this).bindId=App.TicketCreateCollection.one(e)}return e(i,t),i.prototype.requiredPermission="ticket.customer",i.prototype.events={"submit form":"submit","click .submit":"submit","click .cancel":"cancel"},i.prototype.render=function(t){var e,n,i,s,r;if(null==t&&(t={}),this.Config.get("customer_ticket_create"))return e=t.options||{},i=this.Config.get("TicketCreateFormHandler"),(n=App.Config.get("customer_ticket_create_group_ids"))&&(_.isArray(n)||(n=[n]),this.formMeta.filter.group_id=n),this.html(App.view("customer_ticket_create")({head:"New Ticket",form_id:this.form_id})),new App.ControllerForm({el:this.el.find(".ticket-form-top"),form_id:this.form_id,model:App.Ticket,screen:"create_top",handlersConfig:i,filter:this.formMeta.filter,formMeta:this.formMeta,autofocus:!0,params:e}),new App.ControllerForm({el:this.el.find(".article-form-top"),form_id:this.form_id,model:App.TicketArticle,screen:"create_top",events:{"fileUploadStart .richtext":(r=this,function(){return r.submitDisable()}),"fileUploadStop .richtext":(s=this,function(){return s.submitEnable()})},filter:this.formMeta.filter,formMeta:this.formMeta,params:e,handlersConfig:i}),new App.ControllerForm({el:this.el.find(".ticket-form-middle"),form_id:this.form_id,model:App.Ticket,screen:"create_middle",filter:this.formMeta.filter,formMeta:this.formMeta,params:e,noFieldset:!0,handlersConfig:i,rejectNonExistentValues:!0}),_.isEmpty(App.Ticket.attributesGet("create_bottom",!1,!0))||new App.ControllerForm({el:this.el.find(".ticket-form-bottom"),form_id:this.form_id,model:App.Ticket,screen:"create_bottom",handlersConfig:i,filter:this.formMeta.filter,formMeta:this.formMeta,params:e}),new App.ControllerDrox({el:this.el.find(".sidebar"),data:{header:App.i18n.translateInline("What can you do here?"),html:App.i18n.translateInline('The way to communicate with us is this thing called "ticket".')+" "+App.i18n.translateInline("Here you can create one.")}});this.renderScreenError({detail:"Your role cannot create new ticket. Please contact your administrator.",objectName:"Ticket"})},i.prototype.cancel=function(){return this.navigate("#")},i.prototype.submit=function(n){var t,e,i,s,r,o,a,l,c,p,u,h,d;return n.preventDefault(),(r=this.formParam(n.target)).customer_id=this.Session.get("id"),r.priority_id||(o=App.TicketPriority.findByAttribute("default_create",!0),r.priority_id=o.id),r.state_id||(l=App.TicketState.findByAttribute("default_create",!0),r.state_id=l.id),r.title||(r.title=r.subject),c=new App.Ticket,this.log("CustomerTicketCreate","notice","updateAttributes",r),a=App.TicketArticleSender.findByAttribute("name","Customer"),h=App.TicketArticleType.findByAttribute("name","web"),r.group_id&&(s=App.Group.find(r.group_id)),r.article={from:""+this.Session.get().displayName(),to:s&&s.name||"",subject:r.subject,body:r.body,type_id:h.id,sender_id:a.id,form_id:this.form_id,content_type:"text/html"},c.load(r),u=c.validate({screen:"create_top"}),p=c.validate({screen:"create_middle"}),(t=new App.TicketArticle).load(r.article),e=t.validate({screen:"create_top"}),i={},i=_.extend(i,u),i=_.extend(i,p),i=_.extend(i,e),_.isEmpty(i)?(this.submitDisable(n),d=this,c.save({done:function(){return d.navigate("#ticket/zoom/"+this.id)},fail:function(t,e){return d.log("errors",e),d.submitEnable(n),d.notify({type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to create object!"),timeout:6e3})}})):(this.log("CustomerTicketCreate","error","can not create",i),this.formValidate({form:n.target,errors:i}))},i.prototype.submitDisable=function(t){if(!t)return this.formDisable(this.$(".js-submit"),"button");this.formDisable(t)},i.prototype.submitEnable=function(t){if(!t)return this.formEnable(this.$(".js-submit"),"button");this.formEnable(t)},i}(App.ControllerContent),App.Config.set("customer_ticket_new",t,"Routes"),App.Config.set("CustomerTicketNew",{prio:8003,parent:"#new",name:"New Ticket",translate:!0,target:"#customer_ticket_new",permission:["ticket.customer"],setting:["customer_ticket_create"],divider:!0},"NavBarRight")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Dashboard=function(t){function e(){var t;(this.toggle=n(this.toggle,this),this.show=n(this.show,this),this.active=n(this.active,this),this.clues=n(this.clues,this),this.mayBeClues=n(this.mayBeClues,this),e.__super__.constructor.apply(this,arguments),this.permissionCheck("ticket.agent"))?(this.render(),this.bind("ui:rerender",(t=this,function(){if(t.authenticateCheck())return t.render()})),this.mayBeClues()):this.clueAccess=!1}return i(e,t),e.prototype.clueAccess=!0,e.prototype.events={"click .tabs .tab":"toggle","click .js-intro":"clues"},e.prototype.render=function(){var t;return t=$(App.view("dashboard")({head:"Dashboard",isAdmin:this.permissionCheck("admin")})),new App.DashboardStats({el:t.find(".stat-widgets")}),new App.DashboardActivityStream({el:t.find(".js-activityContent"),limit:25}),new App.DashboardFirstSteps({el:t.find(".first-steps-widgets")}),this.html(t)},e.prototype.mayBeClues=function(){var t;if(this.clueAccess&&this.shown&&!this.Config.get("switch_back_to_possible")&&(t=this.Session.get("preferences"),this.clueAccess=!1,!t.intro))return this.clues()},e.prototype.clues=function(t){return this.clueAccess=!1,t&&t.preventDefault(),this.navigate("#clues")},e.prototype.active=function(t){return void 0===t?this.shown:(this.shown=t)?this.mayBeClues():void 0},e.prototype.url=function(){return"#dashboard"},e.prototype.show=function(){if(!this.permissionCheck("ticket.customer")||this.permissionCheck("ticket.agent")){if(this.permissionCheck("ticket.customer")||this.permissionCheck("ticket.agent")||!this.permissionCheck("admin"))return this.title("Dashboard"),this.navupdate("#dashboard");this.navigate("#manage",!0)}else this.navigate("#ticket/view",!0)},e.prototype.changed=function(){return!1},e.prototype.release=function(){},e.prototype.toggle=function(t){var e;return this.$(".tabs .tab").removeClass("active"),$(t.target).addClass("active"),e=$(t.target).data("area"),this.$(".tab-content").addClass("hidden"),this.$(".tab-content."+e).removeClass("hidden")},e}(App.Controller),t=function(t){function e(t){e.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),App.TaskManager.execute({key:"Dashboard",controller:"Dashboard",params:{},show:!0,persistent:!0})}return i(e,t),e.prototype.requiredPermission=["*"],e}(App.ControllerPermanent),App.Config.set("dashboard",t,"Routes"),App.Config.set("Dashboard",{controller:"Dashboard",permission:["*"]},"permanentTask"),App.Config.set("Dashboard",{prio:100,parent:"",name:"Dashboard",target:"#dashboard",key:"Dashboard",permission:["ticket.agent"],"class":"dashboard"},"NavBar")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),"/test"!==window.location.pathname.substr(0,5)&&(this.Config.get("system_init_done")||!this.Config.get("import_mode")?this.Config.get("system_init_done")?this.Config.get("default_controller")?this.navigate(this.Config.get("default_controller"),!0):this.navigate("#dashboard",!0):this.navigate("#getting_started",!0):this.navigate("#import",!0))}return n(e,t),e}(App.Controller),App.Config.set("",t,"Routes"),App.Config.set("/",t,"Routes")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.verifyCall=n(this.verifyCall,this),e.__super__.constructor.apply(this,arguments),this.verifyCall()}return i(e,t),e.prototype.verifyCall=function(){return this.ajax({id:"email_verify",type:"POST",url:this.apiPath+"/users/email_verify",data:JSON.stringify({token:this.token}),processData:!0,success:(e=this,function(){return App.Auth.loginCheck(),e.navigate("#"),e.notify({type:"success",msg:App.i18n.translateContent("Woo hoo! Your email address has been verified!"),removeAll:!0,timeout:2e3})}),error:(t=this,function(){return t.navigate("#"),t.notify({type:"error",msg:App.i18n.translateContent("Unable to verify email. Please contact your administrator."),removeAll:!0})})});var t,e},e}(App.Controller),App.Config.set("email_verify/:token",t,"Routes")}.call(this),function(){var t,e,n,i,s,r,o,a,l,c=function(t,e){return function(){return t.apply(e,arguments)}},p=function(t,e){function n(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=function(t){function e(){this.release=c(this.release,this),e.__super__.constructor.apply(this,arguments),!this.authenticateCheck()||this.permissionCheck("admin.wizard")?(this.title("Get Started"),this.Config.get("system_init_done")?this.navigate("#login"):this.Config.get("ImportPlugins")?this.fetch():this.navigate("getting_started/admin")):this.navigate("#")}return p(e,t),e.prototype.release=function(){return this.el.removeClass("fit getstarted")},e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(e=this,function(t){if(!0!==t.auto_wizard){if(!0!==t.import_mode)return e.render();e.navigate("#import/"+t.import_backend)}else e.renderAutoWizard()})});var e},e.prototype.render=function(){return this.html(App.view("getting_started/intro")())},e.prototype.renderAutoWizard=function(){return this.html(App.view("getting_started/auto_wizard_enabled")())},e}(App.WizardFullScreen),App.Config.set("getting_started",l,"Routes"),n=function(t){function e(){this.release=c(this.release,this),e.__super__.constructor.apply(this,arguments),!this.authenticateCheck()||this.permissionCheck("admin.wizard")?this.Config.get("system_init_done")?this.navigate("#login"):(this.title("Auto Wizard"),this.renderSplash(),this.fetch()):this.navigate("#")}return p(e,t),e.prototype.release=function(){return this.el.removeClass("fit getstarted")},e.prototype.fetch=function(){var t,n;return t=this.apiPath+"/getting_started/auto_wizard",this.token&&(t+="/"+this.token),this.ajax({id:"auto_wizard",type:"GET",url:t,processData:!0,success:(n=this,function(t){var e;if(!1!==t.auto_wizard){if(!0===t.auto_wizard_success)return e=function(){return App.Auth.loginCheck(),n.navigate("#")},void n.delay(e,800);if(!1!==t.auto_wizard_success)return n.navigate("#login");t.message?n.renderFailed(t):n.renderToken()}else n.navigate("#")})})},e.prototype.renderFailed=function(t){return this.html(App.view("getting_started/auto_wizard_failed")(t))},e.prototype.renderSplash=function(){return this.html(App.view("getting_started/auto_wizard_splash")())},e.prototype.renderToken=function(){return this.html(App.view("getting_started/auto_wizard_enabled")())},e}(App.WizardFullScreen),App.Config.set("getting_started/auto_wizard",n,"Routes"),App.Config.set("getting_started/auto_wizard/:token",n,"Routes"),t=function(t){function e(){this.relogin=c(this.relogin,this),this.submit=c(this.submit,this),this.release=c(this.release,this),e.__super__.constructor.apply(this,arguments),!this.authenticateCheck()||this.permissionCheck("admin.wizard")?(this.title("Create Admin"),this.Config.get("system_init_done")?this.navigate("#login"):this.fetch()):this.navigate("#")}return p(e,t),e.prototype.events={"submit form":"submit"},e.prototype.release=function(){return this.el.removeClass("fit getstarted")},e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(e=this,function(t){if(!0!==t.import_mode)return App.Collection.load({type:"Group",data:t.groups}),e.render();e.navigate("#import/"+t.import_backend)})});var e},e.prototype.render=function(){return this.html(App.view("getting_started/admin")()),new App.ControllerForm({el:this.$(".js-admin-form"),model:App.User,screen:"signup",autofocus:!0})},e.prototype.submit=function(n){var t,e,i,s;return n.preventDefault(),this.formDisable(n),this.params=this.formParam(n.target),this.params.role_ids=[],(e=new App.User).load(this.params),(t=e.validate({screen:"signup"}))?(this.log("error new",t),this.formValidate({form:n.target,errors:t}),this.formEnable(n),!1):e.save({done:(s=this,function(){return App.Auth.login({data:{username:s.params.email,password:s.params.password},success:s.relogin,error:function(){return App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent("Signin failed! Please contact the support team!"),timeout:2500})}}),s.Config.set("system_init_done",!0)}),fail:(i=this,function(t,e){return i.formEnable(n),App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent(e.error_human||"Can't create user!"),timeout:2500})})})},e.prototype.relogin=function(t){return this.log("notice","relogin:success",t),App.Event.trigger("notify:removeall"),this.navigate("getting_started/base")},e}(App.WizardFullScreen),App.Config.set("getting_started/admin",t,"Routes"),i=function(t){function e(){this.showAlert=c(this.showAlert,this),this.hideAlerts=c(this.hideAlerts,this),this.submit=c(this.submit,this),this.onLogoPick=c(this.onLogoPick,this),this.release=c(this.release,this),e.__super__.constructor.apply(this,arguments),this.permissionCheck("admin.wizard")?(this.title("Configure Base"),this.fetch()):this.navigate("#")}return p(e,t),e.prototype.elements={".logo-preview":"logoPreview"},e.prototype.events={"submit form":"submit","change .js-upload":"onLogoPick"},e.prototype.release=function(){return this.el.removeClass("fit getstarted")},e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(s=this,function(t){var e,n,i;if(!0!==t.import_mode){if(t.config)for(e in n=t.config)i=n[e],App.Config.set(e,i);return s.render()}s.navigate("#import/"+t.import_backend)})});var s},e.prototype.render=function(){var t,e,n,i;return t=App.Config.get("fqdn"),e=App.Config.get("http_type"),i=t&&"zammad.example.com"!==t?e+"://"+t:window.location.origin,n=App.Config.get("organization"),this.html(App.view("getting_started/base")({url:i,logoUrl:this.logoUrl(),organization:n})),this.$("input, select").first().focus()},e.prototype.onLogoPick=function(t){var e,n,i,s;if((i=new FileReader).onload=(s=this,function(t){return s.logoPreview.attr("src",t.target.result)}),e=t.target.files[0],this.hideAlerts(),e)return n=8,e.size&&e.size>1048576*n?(this.showAlert("logo",App.i18n.translateInline("File too big, max. %s MB allowed.",n)),void this.logoPreview.attr("src","")):i.readAsDataURL(e)},e.prototype.submit=function(r){var t,o;return r.preventDefault(),this.hideAlerts(),this.disable(r),this.params=this.formParam(r.target),this.params.logo=this.logoPreview.attr("src"),this.params.locale_default=App.i18n.detectBrowserLocale(),this.params.timezone_default=App.i18n.detectBrowserTimezone(),o=this,t=function(t){return o.params.logo_resize=t,o.ajax({id:"getting_started_base",type:"POST",url:o.apiPath+"/getting_started/base",data:JSON.stringify(o.params),processData:!0,success:function(t){var e,n,i,s;if("ok"===t.result){for(e in n=t.settings)s=n[e],App.Config.set(e,s);return App.Config.get("system_online_service")?o.navigate("getting_started/channel/email_pre_configured"):o.navigate("getting_started/email_notification")}for(e in i=t.messages)s=i[e],o.showAlert(e,s);return o.enable(r)},fail:function(){return o.enable(r)}})},App.ImageService.resizeForApp(this.params.logo,this.logoPreview.width(),this.logoPreview.height(),t)},e.prototype.hideAlerts=function(){return this.$(".form-group").removeClass("has-error"),this.$(".alert").addClass("hide")},e.prototype.showAlert=function(t,e){return this.$("[name="+t+"]").closest(".form-group").addClass("has-error"),this.$("[name="+t+"]").closest(".form-group").find(".alert").removeClass("hide").text(App.i18n.translateInline(e))},e}(App.WizardFullScreen),App.Config.set("getting_started/base",i,"Routes"),a=function(t){function e(){this.submit=c(this.submit,this),this.toggleOutboundAdapter=c(this.toggleOutboundAdapter,this),this.release=c(this.release,this),e.__super__.constructor.apply(this,arguments),this.permissionCheck("admin.wizard")?(this.title("Email Notifications"),this.channelDriver={email:{inbound:{},outbound:{}}},this.fetch()):this.navigate("#")}return p(e,t),e.prototype.events={"change .js-outbound [name=adapter]":"toggleOutboundAdapter","submit .js-outbound":"submit"},e.prototype.release=function(){return this.el.removeClass("fit getstarted")},e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(e=this,function(t){if(!0!==t.import_mode)return e.channelDriver=t.channel_driver,e.render();e.navigate("#import/"+t.import_backend)})});var e},e.prototype.render=function(){var t;return this.html(App.view("getting_started/email_notification")()),t=[{name:"adapter",
display:"Send Mails via",tag:"select",multiple:!1,"null":!1,options:this.channelDriver.email.outbound}],new App.ControllerForm({el:this.$(".base-outbound-type"),model:{configure_attributes:t,className:""},params:{adapter:"sendmail"}}),this.toggleOutboundAdapter()},e.prototype.toggleOutboundAdapter=function(){var t;if(this.el.find(".base-outbound-settings").html(""),"smtp"===this.$(".js-outbound [name=adapter]").val())return t=[{name:"options::host",display:"Host",tag:"input",type:"text",limit:120,"null":!1,autocapitalize:!1,autofocus:!0},{name:"options::user",display:"User",tag:"input",type:"text",limit:120,"null":!0,autocapitalize:!1,autocomplete:"off"},{name:"options::password",display:"Password",tag:"input",type:"password",limit:120,"null":!0,autocapitalize:!1,autocomplete:"off",single:!0},{name:"options::port",display:"Port",tag:"input",type:"text",limit:6,"null":!0,autocapitalize:!1}],this.form=new App.ControllerForm({el:this.$(".base-outbound-settings"),model:{configure_attributes:t,className:""}})},e.prototype.submit=function(s){var t,e,r;return s.preventDefault(),(t=this.formParam(s.target)).email="me@localhost",this.disable(s),this.showSlide("js-test"),this.ajax({id:"email_notification",type:"POST",url:this.apiPath+"/channels_email_notification",data:JSON.stringify(t),processData:!0,success:(r=this,function(t){var e,n,i;if("ok"!==t.result)return r.showSlide("js-outbound"),r.showAlert("js-outbound",t.message_human||t.message),r.showInvalidField("js-outbound",t.invalid_field),r.enable(s);for(e in n=t.settings)i=n[e],App.Config.set(e,i);return App.Config.get("system_online_service")?r.navigate("getting_started/channel/email_pre_configured"):r.navigate("getting_started/channel")}),fail:(e=this,function(){return e.showSlide("js-outbound"),e.showAlert("js-outbound",data.message_human||data.message),e.showInvalidField("js-outbound",data.invalid_field),e.enable(s)})})},e}(App.WizardFullScreen),App.Config.set("getting_started/email_notification",a,"Routes"),s=function(t){function e(){this.release=c(this.release,this),e.__super__.constructor.apply(this,arguments),this.permissionCheck("admin.wizard")?(this.title("Connect Channels"),this.adapters=[{name:"Email","class":"email",link:"#getting_started/channel/email"}],this.fetch()):this.navigate("#")}return p(e,t),e.prototype.release=function(){return this.el.removeClass("fit getstarted")},e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(e=this,function(t){if(!0!==t.import_mode)return e.render();e.navigate("#import/"+t.import_backend)})});var e},e.prototype.render=function(){return this.html(App.view("getting_started/channel")({adapters:this.adapters}))},e}(App.WizardFullScreen),App.Config.set("getting_started/channel",s,"Routes"),o=function(t){function e(){this.release=c(this.release,this),e.__super__.constructor.apply(this,arguments),this.permissionCheck("admin.wizard")?(this.title("Connect Channels"),this.fetch()):this.navigate("#")}return p(e,t),e.prototype.release=function(){return this.el.removeClass("fit getstarted")},e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(e=this,function(t){if(!0!==t.import_mode)return e.render(t);e.navigate("#import/"+t.import_backend)})});var e},e.prototype.render=function(t){return this.html(App.view("getting_started/email_pre_configured")(t))},e}(App.WizardFullScreen),App.Config.set("getting_started/channel/email_pre_configured",o,"Routes"),r=function(t){function e(){this.verify=c(this.verify,this),this.probleOutbound=c(this.probleOutbound,this),this.probeInbound=c(this.probeInbound,this),this.probeBasedOnIntro=c(this.probeBasedOnIntro,this),this.toggleOutboundAdapter=c(this.toggleOutboundAdapter,this),this.release=c(this.release,this),e.__super__.constructor.apply(this,arguments),this.permissionCheck("admin.wizard")?(this.title("Email Account"),this.account={inbound:{},outbound:{},meta:{}},this.channelDriver={email:{inbound:{},outbound:{}}},this.fetch()):this.navigate("#")}return p(e,t),e.prototype.events={"submit .js-intro":"probeBasedOnIntro","submit .js-inbound":"probeInbound","change .js-outbound [name=adapter]":"toggleOutboundAdapter","submit .js-outbound":"probleOutbound","click  .js-goToSlide":"goToSlide"},e.prototype.release=function(){return this.el.removeClass("fit getstarted")},e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(e=this,function(t){if(!0!==t.import_mode)return e.channelDriver=t.channel_driver,e.render();e.navigate("#import/"+t.import_backend)})});var e},e.prototype.render=function(){var t,e,n,i;return this.html(App.view("getting_started/email")()),this.showSlide("js-intro"),e=[{name:"adapter",display:"Send Mails via",tag:"select",multiple:!1,"null":!1,options:this.channelDriver.email.outbound}],new App.ControllerForm({el:this.$(".base-outbound-type"),model:{configure_attributes:e,className:""},params:{adapter:this.account.outbound.adapter||"smtp"}}),this.toggleOutboundAdapter(),t=[{name:"adapter",display:"Type",tag:"select",multiple:!1,"null":!1,options:this.channelDriver.email.inbound},{name:"options::host",display:"Host",tag:"input",type:"text",limit:120,"null":!1,autocapitalize:!1},{name:"options::user",display:"User",tag:"input",type:"text",limit:120,"null":!1,autocapitalize:!1,autocomplete:"off"},{name:"options::password",display:"Password",tag:"input",type:"password",limit:120,"null":!1,autocapitalize:!1,autocomplete:"off",single:!0},{name:"options::ssl",display:"SSL/STARTTLS",tag:"boolean","null":!0,options:{"true":"yes","false":"no"},"default":!0,translate:!0,item_class:"formGroup--halfSize"},{name:"options::port",display:"Port",tag:"input",type:"text",limit:6,"null":!0,autocapitalize:!1,"default":"993",item_class:"formGroup--halfSize"},{name:"options::folder",display:"Folder",tag:"input",type:"text",limit:120,"null":!0,autocapitalize:!1,item_class:"formGroup--halfSize"},{name:"options::keep_on_server",display:"Keep messages on server",tag:"boolean","null":!0,options:{"true":"yes","false":"no"},translate:!0,"default":!1,item_class:"formGroup--halfSize"}],i=function(t,e,n,i,s,r){if(t)return"imap"===t.adapter?(r.show("options::folder"),void r.show("options::keep_on_server")):(r.hide("options::folder"),r.hide("options::keep_on_server"))},n=function(t){var e;t&&t.options&&(e=this.$('.base-inbound-settings [name="options::port"]').val(),!0!==t.options.ssl?!1===t.options.ssl&&(e&&"993"!==e||this.$('.base-inbound-settings [name="options::port"]').val("143")):e||this.$('.base-inbound-settings [name="options::port"]').val("993"))},new App.ControllerForm({el:this.$(".base-inbound-settings"),model:{configure_attributes:t,className:""},params:this.account.inbound,handlers:[i,n]})},e.prototype.toggleOutboundAdapter=function(){var t,e;if(t={options:{}},this.account.meta&&(t.options.user=this.account.meta.email,t.options.password=this.account.meta.password,t.options.folder=this.account.meta.folder,t.options.keep_on_server=this.account.meta.keep_on_server),this.$(".base-outbound-settings").html(""),"smtp"===this.$(".js-outbound [name=adapter]").val())return e=[{name:"options::host",display:"Host",tag:"input",type:"text",limit:120,"null":!1,autocapitalize:!1,autofocus:!0},{name:"options::user",display:"User",tag:"input",type:"text",limit:120,"null":!0,autocapitalize:!1,autocomplete:"off"},{name:"options::password",display:"Password",tag:"input",type:"password",limit:120,"null":!0,autocapitalize:!1,autocomplete:"off",single:!0},{name:"options::port",display:"Port",tag:"input",type:"text",limit:6,"null":!0,autocapitalize:!1}],this.form=new App.ControllerForm({el:this.$(".base-outbound-settings"),model:{configure_attributes:e,className:""},params:this.account.outbound})},e.prototype.probeBasedOnIntro=function(r){var t,e,o;return r.preventDefault(),t=this.formParam(r.target),this.account.meta=t,this.disable(r),this.$(".js-probe .js-email").text(t.email),this.showSlide("js-probe"),this.ajax({id:"email_probe",type:"POST",url:this.apiPath+"/channels_email_probe",data:JSON.stringify(t),processData:!0,success:(o=this,function(t){var e,n,i,s;if("ok"===t.result){if(t.setting)for(e in i=t.setting)s=i[e],o.account[e]=s;t.content_messages&&0<t.content_messages&&(!o.account.inbound.options||!0!==o.account.inbound.options.keep_on_server)?(n=App.i18n.translateContent("We have already found %s email(s) in your mailbox. Zammad will move it all from your mailbox into Zammad.",t.content_messages),o.$(".js-inbound-acknowledge .js-message").html(n),o.$(".js-inbound-acknowledge .js-back").attr("data-slide","js-intro"),o.$(".js-inbound-acknowledge .js-next").attr("data-slide",""),o.$(".js-inbound-acknowledge .js-next").unbind("click.verify").bind("click.verify",function(t){return t.preventDefault(),o.verify(o.account)}),o.showSlide("js-inbound-acknowledge")):o.verify(o.account)}else"duplicate"===t.result?(o.showSlide("js-intro"),o.showAlert("js-intro","Account already exists!")):(o.showSlide("js-inbound"),o.showAlert("js-inbound","Unable to detect your server settings. Manual configuration needed."),o.$('.js-inbound [name="options::user"]').val(o.account.meta.email),o.$('.js-inbound [name="options::password"]').val(o.account.meta.password));return o.enable(r)}),fail:(e=this,function(){return e.enable(r),e.showSlide("js-intro")})})},e.prototype.probeInbound=function(n){var i,t,s;return n.preventDefault(),i=this.formParam(n.target),this.disable(n),this.showSlide("js-test"),this.ajax({id:"email_inbound",type:"POST",url:this.apiPath+"/channels_email_inbound",data:JSON.stringify(i),processData:!0,success:(s=this,function(t){var e;return"ok"===t.result?(s.account.inbound=i,t.content_messages&&0<t.content_messages&&(!s.account.inbound.options||!0!==s.account.inbound.options.keep_on_server)?(e=App.i18n.translateContent("We have already found %s emails in your mailbox. Zammad will move it all from your mailbox into Zammad.",t.content_messages),s.$(".js-inbound-acknowledge .js-message").html(e),s.$(".js-inbound-acknowledge .js-back").attr("data-slide","js-inbound"),s.$(".js-inbound-acknowledge .js-next").unbind("click.verify"),s.showSlide("js-inbound-acknowledge")):s.showSlide("js-outbound"),s.channel||(s.account.inbound.options?(s.$('.js-outbound [name="options::host"]').val(s.account.inbound.options.host),s.$('.js-outbound [name="options::user"]').val(s.account.inbound.options.user),s.$('.js-outbound [name="options::password"]').val(s.account.inbound.options.password)):(s.$('.js-outbound [name="options::user"]').val(s.account.meta.email),s.$('.js-outbound [name="options::password"]').val(s.account.meta.password)))):(s.showSlide("js-inbound"),s.showAlert("js-inbound",t.message_human||t.message),s.showInvalidField("js-inbound",t.invalid_field)),s.enable(n)}),fail:(t=this,function(){return t.showSlide("js-inbound"),t.showAlert("js-inbound",data.message_human||data.message),t.showInvalidField("js-inbound",data.invalid_field),t.enable(n)})})},e.prototype.probleOutbound=function(e){var n,t,i;return e.preventDefault(),(n=this.formParam(e.target)).email=this.account.meta.email,this.disable(e),this.showSlide("js-test"),this.ajax({id:"email_outbound",type:"POST",url:this.apiPath+"/channels_email_outbound",data:JSON.stringify(n),processData:!0,success:(i=this,function(t){return"ok"===t.result?(i.account.outbound=n,i.verify(i.account)):(i.showSlide("js-outbound"),i.showAlert("js-outbound",t.message_human||t.message),i.showInvalidField("js-outbound",t.invalid_field)),i.enable(e)}),fail:(t=this,function(){return t.showSlide("js-outbound"),t.showAlert("js-outbound",data.message_human||data.message),t.showInvalidField("js-outbound",data.invalid_field),t.enable(e)})})},e.prototype.verify=function(t,e){return null==e&&(e=0),this.showSlide("js-verify"),this.ajax({id:"email_verify",type:"POST",url:this.apiPath+"/channels_email_verify",data:JSON.stringify(t),processData:!0,success:(i=this,function(t){return"ok"===t.result?i.navigate("getting_started/agents"):"inbound"===t.source||"outbound"===t.source?(i.showSlide("js-"+t.source),i.showAlert("js-"+t.source,t.message_human||t.message),i.showInvalidField("js-"+t.source,t.invalid_field)):2===e?(i.showAlert("js-verify",t.message_human||t.message),i.delay(function(){return i.showSlide("js-intro"),i.showAlert("js-intro","Unable to verify sending and receiving. Please check your settings.")},2300)):(t.subject&&i.account&&(i.account.subject=t.subject),i.verify(i.account,e+1))}),fail:(n=this,function(){return n.showSlide("js-intro"),n.showAlert("js-intro","Unable to verify sending and receiving. Please check your settings.")})});var n,i},e}(App.WizardFullScreen),App.Config.set("getting_started/channel/email",r,"Routes"),e=function(t){function e(){this.submit=c(this.submit,this),this.release=c(this.release,this),e.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),this.title("Invite Agents"),this.fetch()}return p(e,t),e.prototype.events={"submit form":"submit"},e.prototype.release=function(){return this.el.removeClass("fit getstarted")},e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(e=this,function(t){if(!0!==t.import_mode)return App.Collection.load({type:"Group",data:t.groups}),e.render();e.navigate("#import/"+t.import_backend)})});var e},e.prototype.render=function(){return this.html(App.view("getting_started/agent")()),new App.ControllerForm({el:this.$(".js-agent-form"),model:App.User,screen:"invite_agent",autofocus:!0})},e.prototype.submit=function(n){var t,e,i,s,r;return n.preventDefault(),this.formDisable(n),this.params=this.formParam(n.target),this.params.role_ids=[],this.params.invite=!0,(e=App.Role.findByAttribute("name","Agent"))&&(this.params.role_ids=e.id),(i=new App.User).load(this.params),(t=i.validate({screen:"invite_agent"}))?(this.log("error new",t),this.formValidate({form:n.target,errors:t}),this.formEnable(n),!1):i.save({done:(r=this,function(){return App.Event.trigger("notify",{type:"success",msg:App.i18n.translateContent("Invitation sent!"),timeout:3500}),r.render()}),fail:(s=this,function(t,e){return s.formEnable(n),App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent(e.error_human||"Can't create user!"),timeout:2500})})})},e}(App.WizardFullScreen),App.Config.set("getting_started/agents",e,"Routes"),s=function(t){function e(){this.release=c(this.release,this),e.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),this.title("Setup Finished"),this.render()}return p(e,t),e.prototype.release=function(){return this.el.removeClass("fit getstarted")},e.prototype.render=function(){var t,e;return this.html(App.view("getting_started/finish")()),this.delay((t=this,function(){return t.$(".wizard-slide").addClass("hide")}),2300),this.delay((e=this,function(){return e.navigate("#")}),4300)},e}(App.WizardFullScreen),App.Config.set("getting_started/finish",s,"Routes")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.genericController=new App.ControllerGenericIndex({el:this.el,id:this.id,genericObject:"Group",pageData:{home:"groups",object:"Group",objects:"Groups",navupdate:"#groups",notes:["Groups are ..."],buttons:[{name:"New Group","data-type":"new","class":"btn--success"}]},container:this.el.closest(".content")})}return n(e,t),e.prototype.requiredPermission="admin.group",e.prototype.header="Groups",e}(App.ControllerSubContent),App.Config.set("Group",{prio:1500,name:"Groups",parent:"#manage",target:"#manage/groups",controller:t,permission:["admin.group"]},"NavBarAdmin")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.IdoitObjectSelector=function(t){function e(){return this.onSubmit=n(this.onSubmit,this),this.renderResult=n(this.renderResult,this),this.search=n(this.search,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.head="i-doit",e.prototype.lastSearchTermEmpty=!1,e.prototype.content=function(){var n,i;return this.ajax({id:"idoit-object-selector",type:"POST",url:this.apiPath+"/integration/idoit",data:JSON.stringify({method:"cmdb.object_types"}),success:(i=this,function(t){var e;return"failed"===t.result?(i.contentInline=t.message,void i.render()):(e=_.sortBy(t.response.result,"title"),i.contentInline=$(App.view("integration/idoit_object_selector")()),i.contentInline.find(".js-typeSelect").html(i.renderTypeSelector(e)),i.contentInline.on("change","input.js-shadow",function(t){var e;return e=i.formParam(t.target),i.search(e)}),i.contentInline.on("keyup","input.js-searchField",function(t){var e;return e=i.formParam(t.target),i.search(e)}),i.render(),i.$(".js-input").focus())}),error:(n=this,function(t,e){if("abort"!==e)return n.contentInline="Unable to load content",n.render()})}),""},e.prototype.search=function(t){return _.isEmpty(t.type)&&_.isEmpty(t.title)?(this.lastSearchTermEmpty=!0,void this.renderResult()):(_.isEmpty(t.type)&&delete t.type,_.isEmpty(t.title)?delete t.title:t.title="%"+t.title+"%",this.lastSearchTermEmpty=!1,this.ajax({id:"idoit-object-selector",type:"POST",url:this.apiPath+"/integration/idoit",data:JSON.stringify({method:"cmdb.objects",filter:t}),success:(e=this,function(t){if(!e.lastSearchTermEmpty)return e.renderResult(t.response.result)}),error:(n=this,function(t,e){if("abort"!==e)return n.contentInline="Unable to load content",n.render()})}));var n,e},e.prototype.renderResult=function(t){var e;return e=App.view("integration/idoit_object_result")({items:t}),this.el.find(".js-result").html(e)},e.prototype.renderTypeSelector=function(t){var e,n,i,s;for(s={},e=0,i=t.length;e<i;e++)s[(n=t[e]).id]=n.title;return App.UiElement.searchable_select.render({name:"type",multiple:!1,limit:100,"null":!1,nulloption:!1,options:s})},e.prototype.onSubmit=function(){var t,e,n;if(t=this.el.find(".js-result"),n=this.formParam(t),!_.isEmpty(n.object_id))return e=_.isArray(n.object_id)?n.object_id:[n.object_id],this.formDisable(t),this.callback(e,this)},e}(App.ControllerModal)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.title("Import"),this.fetch()}return n(e,t),e.prototype.className="getstarted fit",e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(e=this,function(t){if(e.Config.get("system_init_done"))e.navigate("#login");else{if(!0!==t.import_mode)return e.render();e.navigate("#import/"+t.import_backend)}})});var e},e.prototype.render=function(){var t;return t=App.Config.get("ImportPlugins"),this.html(App.view("import/index")({items:t}))},e}(App.ControllerContent),App.Config.set("import",t,"Routes")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.updateMigration=n(this.updateMigration,this),this.startMigration=n(this.startMigration,this),this.checkMigration=n(this.checkMigration,this),this.updateUrl=n(this.updateUrl,this),this.showImportNotice=n(this.showImportNotice,this),this.showImportState=n(this.showImportState,this),this.showLink=n(this.showLink,this),this.startDownload=n(this.startDownload,this),e.__super__.constructor.apply(this,arguments),this.title("Import"),this.Config.get("system_init_done")?this.navigate("#login"):this.fetch()}return i(e,t),e.prototype.className="getstarted fit",e.prototype.elements={".input-feedback":"urlStatus",".js-migration-check":"nextStartMigration",".otrs-link-error":"linkErrorMessage"},e.prototype.events={"click .js-otrs-link":"showLink","click .js-download":"startDownload","click .js-migration-start":"startMigration","click .js-migration-check":"checkMigration","keyup #otrs-link":"updateUrl"},e.prototype.updateMigrationDisplayLoop=0,e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(e=this,function(t){if(!0!==t.import_mode||"otrs"===t.import_backend)return e.render(),!0===t.import_mode?(e.showImportState(),e.updateMigration()):void 0;e.navigate("#import/"+t.import_backend)})});var e},e.prototype.render=function(){return this.html(App.view("import/otrs")())},e.prototype.startDownload=function(){return this.$(".js-otrs-link").removeClass("hide")},e.prototype.showLink=function(t){return t.preventDefault(),this.$("[data-slide=otrs-plugin]").toggleClass("hide"),this.$("[data-slide=otrs-link]").toggleClass("hide")},e.prototype.showImportState=function(){return this.$("[data-slide=otrs-plugin]").addClass("hide"),this.$("[data-slide=otrs-link]").addClass("hide"),this.$("[data-slide=otrs-import]").removeClass("hide"),this.$("[data-slide=otrs-import-notice]").addClass("hide")},e.prototype.showImportNotice=function(){return this.$("[data-slide=otrs-plugin]").addClass("hide"),this.$("[data-slide=otrs-link]").addClass("hide"),this.$("[data-slide=otrs-import]").addClass("hide"),this.$("[data-slide=otrs-import-notice]").removeClass("hide")},e.prototype.updateUrl=function(t){var e,n,i;return n=$(t.target).val(),this.urlStatus.attr("data-state","loading"),this.linkErrorMessage.text(""),e=function(){return i.ajax({id:"import_otrs_url",type:"POST",url:i.apiPath+"/import/otrs/url_check",data:JSON.stringify({url:n}),processData:!0,success:function(t){return"ok"===t.result?(i.urlStatus.attr("data-state","success"),i.linkErrorMessage.text(""),i.nextStartMigration.removeClass("hide")):(i.urlStatus.attr("data-state","error"),i.linkErrorMessage.text(t.message_human||t.message),i.nextStartMigration.addClass("hide"))}})},(i=this).delay(e,700,"import_otrs_url")},e.prototype.checkMigration=function(t){return t.preventDefault(),this.ajax({id:"import_otrs_check",type:"POST",url:this.apiPath+"/import/otrs/import_check",processData:!0,success:(r=this,function(t){var e,n,i,s;if("ok"!==t.result){for(e=0,i=(s=t.issues).length;e<i;e++)n=s[e],r.$(".js-"+n).removeClass("hide");return r.showImportNotice()}r.startMigration()})});var r},e.prototype.startMigration=function(t){return t&&t.preventDefault(),this.showImportState(),this.ajax({id:"import_start",type:"POST",url:this.apiPath+"/import/otrs/import_start",processData:!0,success:(e=this,function(t){if("ok"===t.result)return e.delay(e.updateMigration,2e3)})});var e},e.prototype.updateMigration=function(){return this.updateMigrationDisplayLoop+=1,this.showImportState(),this.ajax({id:"import_status",type:"GET",url:this.apiPath+"/import/otrs/import_status",processData:!0,success:(r=this,function(t){var e,n,i,s;if("import_done"!==t.result){if("error"===t.result?(r.$(".js-error").removeClass("hide"),r.$(".js-error").html(App.i18n.translateContent(t.message))):r.$(".js-error").addClass("hide"),"not running"===t.message&&10<r.updateMigrationDisplayLoop)return r.$(".js-error").removeClass("hide"),void r.$(".js-error").html(App.i18n.translateContent("Background process did not start or has not finished! Please contact your support."));if("in_progress"===t.result)for(i in s=t.data)(n=s[i]).done>n.total&&(n.done=n.total),(e=r.$(".js-"+i.toLowerCase())).find(".js-done").text(n.done),e.find(".js-total").text(n.total),e.find("progress").attr("max",n.total),e.find("progress").attr("value",n.done),n.total<=n.done?e.addClass("is-done"):e.removeClass("is-done");return r.delay(r.updateMigration,6500)}window.location.reload()})});var r},e}(App.ControllerContent),App.Config.set("import/otrs",t,"Routes"),App.Config.set("otrs",{title:"OTRS",name:"OTRS","class":"js-otrs",url:"#import/otrs"},"ImportPlugins")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.updateMigration=n(this.updateMigration,this),this.startMigration=n(this.startMigration,this),this.showImportState=n(this.showImportState,this),this.showCredentials=n(this.showCredentials,this),this.updateApiToken=n(this.updateApiToken,this),this.updateUrl=n(this.updateUrl,this),e.__super__.constructor.apply(this,arguments),this.title("Import"),this.Config.get("system_init_done")?this.navigate("#login"):this.fetch()}return i(e,t),e.prototype.className="getstarted fit",e.prototype.elements={".input-feedback":"urlStatus","[data-target=zendesk-credentials]":"nextEnterCredentials","[data-target=zendesk-start-migration]":"nextStartMigration","#zendesk-url":"zendeskUrl",".js-zendeskUrlApiToken":"zendeskUrlApiToken",".zendesk-url-error":"linkErrorMessage",".zendesk-api-token-error":"apiTokenErrorMessage","#zendesk-email":"zendeskEmail","#zendesk-api-token":"zendeskApiToken",".js-ticket-count-info":"ticketCountInfo"},e.prototype.updateMigrationDisplayLoop=0,e.prototype.events={"click .js-zendesk-credentials":"showCredentials","click .js-migration-start":"startMigration","keyup #zendesk-url":"updateUrl","keyup #zendesk-api-token":"updateApiToken"},e.prototype.fetch=function(){return this.ajax({id:"getting_started",type:"GET",url:this.apiPath+"/getting_started",processData:!0,success:(e=this,function(t){if(!0!==t.import_mode||"zendesk"===t.import_backend)return e.render(),!0===t.import_mode?(e.showImportState(),e.updateMigration()):void 0;e.navigate("#import/"+t.import_backend)})});var e},e.prototype.render=function(){return this.html(App.view("import/zendesk")())},e.prototype.updateUrl=function(){var t,e;return this.urlStatus.attr("data-state","loading"),this.linkErrorMessage.text(""),t=function(){return e.ajax({id:"import_zendesk_url",type:"POST",url:e.apiPath+"/import/zendesk/url_check",data:JSON.stringify({url:e.zendeskUrl.val()}),processData:!0,success:function(t){return console.log(t),"ok"===t.result?(e.urlStatus.attr("data-state","success"),e.linkErrorMessage.text(""),e.nextEnterCredentials.removeClass("hide")):(e.urlStatus.attr("data-state","error"),e.linkErrorMessage.text(t.message_human||t.message),e.nextEnterCredentials.addClass("hide"))}})},(e=this).delay(t,700,"import_zendesk_url")},e.prototype.updateApiToken=function(){var t,e;return this.urlStatus.attr("data-state","loading"),this.apiTokenErrorMessage.text(""),t=function(){return e.ajax({id:"import_zendesk_api_token",type:"POST",url:e.apiPath+"/import/zendesk/credentials_check",data:JSON.stringify({username:e.zendeskEmail.val(),token:e.zendeskApiToken.val()}),processData:!0,success:function(t){return console.log(t),"ok"===t.result?(e.urlStatus.attr("data-state","success"),e.apiTokenErrorMessage.text(""),e.nextStartMigration.removeClass("hide")):(e.urlStatus.attr("data-state","error"),e.apiTokenErrorMessage.text(t.message_human||t.message),e.nextStartMigration.addClass("hide"))}})},(e=this).delay(t,700,"import_zendesk_api_token")},e.prototype.showCredentials=function(t){var e;return t.preventDefault(),this.urlStatus.attr("data-state",""),e=this.zendeskUrl.val()+"/agent/admin/api",this.zendeskUrlApiToken.attr("href",e.replace(/([^:])\/\/+/g,"$1/")),this.zendeskUrlApiToken.val("HERE"),this.$("[data-slide=zendesk-url]").toggleClass("hide"),this.$("[data-slide=zendesk-credentials]").toggleClass("hide")},e.prototype.showImportState=function(){return this.$("[data-slide=zendesk-url]").addClass("hide"),this.$("[data-slide=zendesk-credentials]").addClass("hide"),this.$("[data-slide=zendesk-import]").removeClass("hide")},e.prototype.startMigration=function(t){return t.preventDefault(),this.showImportState(),this.ajax({id:"import_start",type:"POST",url:this.apiPath+"/import/zendesk/import_start",processData:!0,success:(e=this,function(t){if(console.log(t),"ok"===t.result)return e.delay(e.updateMigration,3e3)})});var e},e.prototype.updateMigration=function(){return this.updateMigrationDisplayLoop+=1,this.showImportState(),this.ajax({id:"import_status",type:"GET",url:this.apiPath+"/import/zendesk/import_status",processData:!0,success:(r=this,function(t){var e,n,i,s;if(_.isEmpty(t.result)&&16<r.updateMigrationDisplayLoop)return r.$(".js-error").removeClass("hide"),void r.$(".js-error").html(App.i18n.translateContent("Background process did not start or has not finished! Please contact your support."));if(_.isEmpty(t.result.error)?r.$(".js-error").addClass("hide"):(r.$(".js-error").removeClass("hide"),r.$(".js-error").html(App.i18n.translateContent(t.result.error))),_.isEmpty(t.finished_at)||!_.isEmpty(t.result.error)){if(!_.isEmpty(t.result))for(n in i=t.result)(s=i[n]).sum>s.total&&(s.sum=s.total),"Ticket"===n&&1e3<=s.total&&r.ticketCountInfo.removeClass("hide"),(e=r.$(".js-"+n.toLowerCase())).find(".js-done").text(s.sum),e.find(".js-total").text(s.total),e.find("progress").attr("max",s.total),e.find("progress").attr("value",s.sum),s.total<=s.sum?e.addClass("is-done"):e.removeClass("is-done");return r.delay(r.updateMigration,5e3)}window.location.reload()})});var r},e}(App.ControllerContent),App.Config.set("import/zendesk",t,"Routes"),App.Config.set("zendesk",{title:"Zendesk",name:"Zendesk","class":"js-zendesk",url:"#import/zendesk"},"ImportPlugins")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.release=n(this.release,this),this.render=n(this.render,this),this.show=n(this.show,this),e.__super__.constructor.apply(this,arguments),this.integrationItems=App.Config.get("NavBarIntegrations"),this.subscribeId=App.Setting.subscribe(this.render,{initFetch:!0,clear:!1})}return i(e,t),e.prototype.requiredPermission="admin.integration",e.prototype.header="Integrations",e.prototype.show=function(t){var e,n,i,s;if(!this.initRender||t.target||t.integration)if(this.target=t.target,this.integration=t.integration,this.initRender){if(this.integration){for(n in i=this.integrationItems)if((s=i[n]).target==="#system/"+t.target+"/"+t.integration){e=s;break}return new e.controller({el:this.el})}t.noRender||this.render()}else this.requestedIntegration=!0},e.prototype.render=function(){var t,e,n,i,s,r,o,a,l;if(!this.initRender||!this.integration){for(n in this.initRender=!0,e=[],o=this.integrationItems)if((l=o[n]).permission)for(s=!1,t=0,i=(a=l.permission).length;t<i;t++)r=a[t],!s&&this.permissionCheck(r)&&(s=!0,l.key=n,e.push(l));else l.key=n,e.push(l);if(e=_.sortBy(e,function(t){return t.name}),this.html(App.view("integration/index")({head:"Integrations",integrations:e})),this.requestedIntegration)return this.show({target:this.target,integration:this.integration,noRender:!0}),this.requestedIntegration=void 0}},e.prototype.release=function(){if(this.subscribeId)return App.Setting.unsubscribe(this.subscribeId)},e}(App.ControllerSubContent),App.Config.set("Integration",{prio:1e3,name:"Integrations",parent:"#system",target:"#system/integration",controller:t,permission:["admin.integration"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.genericController=new App.ControllerGenericIndex({el:this.el,id:this.id,genericObject:"Job",defaultSortBy:"name",pageData:{home:"Jobs",object:"Scheduler",objects:"Schedulers",navupdate:"#Jobs",notes:["Scheduler are ..."],buttons:[{name:"New Scheduler","data-type":"new","class":"btn--success"}]},container:this.el.closest(".content"),large:!0})}return n(e,t),e.prototype.requiredPermission="admin.scheduler",e.prototype.header="Scheduler",e}(App.ControllerSubContent),App.Config.set("Job",{prio:3400,name:"Scheduler",parent:"#manage",target:"#manage/job",controller:t,
permission:["admin.scheduler"]},"NavBarAdmin")}.call(this),function(){var t;t=function(){function t(){new App.KeyboardShortcutModal}return t}(),App.Config.set("keyboard_shortcuts",t,"Routes"),App.Config.set("KeyboardShortcuts",{prio:1700,parent:"#current_user",name:"Keyboard Shortcuts",translate:!0,target:"#keyboard_shortcuts",permission:["admin","ticket.agent"]},"NavBarRight")}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseAddForm=function(t){function i(t){var e,n;for(e in t)n=t[e],this[e]=n;this.head=this.object.objectActionName(),i.__super__.constructor.call(this,t)}return e(i,t),i.prototype.buttonSubmit="Create",i.prototype.content=function(){var t;return t=this.parentController.kb_locale(),this.formController=new App.KnowledgeBaseFormController(this.object,t,"agent_create",$("<div>")),this.form=this.formController.form,this.formController.el},i.prototype.submit=function(t){var e;if(this.preventDefaultAndStopPropagation(t),this.formController.validateAndShowErrors())return(e=this.formController.paramsForSaving()).translations_attributes[0].content_attributes={body:""},this.parentController.coordinator.saveChanges(this.object,e,this)},i.prototype.showAlert=function(t){var e;return null!=(e=this.formController)?e.showAlert(t):void 0},i.prototype.didSaveCallback=function(t){var e;return e=this.object.constructor.find(t.id).uiUrl(this.parentController.kb_locale(),"edit"),this.parentController.navigate(e)},i}(App.ControllerModal)}.call(this),function(){var s=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;App.KnowledgeBaseAgentController=function(t){function i(t){var e,n;this.checkUpdatesAction=s(this.checkUpdatesAction,this),this.render=s(this.render,this),this.loadInitial=s(this.loadInitial,this),this.fetchAndRender=s(this.fetchAndRender,this),this.show=s(this.show,this),this.loadChange=s(this.loadChange,this),i.__super__.constructor.apply(this,arguments),this.bind("config_update_local",(e=this,function(t){return e.configUpdated(t)})),this.permissionCheck("knowledge_base.*")&&App.Config.get("kb_active")?this.updateNavMenu():App.Config.get("kb_active_publicly")&&this.loadInitial({},{success:(n=this,function(){return n.updateNavMenu()})})}return e(i,t),i.prototype.className="knowledge-base vertical",i.prototype.name="Knowledge Base",i.prototype.elements={".js-body":"body",".js-navigation":"navigation",".js-sidebar":"sidebar"},i.prototype.configUpdated=function(t){if("kb_active"===t.name||"kb_active_publicly"===t.name)return this.updateNavMenu()},i.prototype.firstRunIfNeeded=function(){var e,n,i;if(!this.firstRunDone)return this.firstRunDone=!0,this.coordinator=new App.KnowledgeBaseEditorCoordinator({parentController:this}),this.fetchAndRender(),this.bind("ui:rerender",(e=this,function(){var t;return e.render(!0),null!=(t=e.contentController)&&(t.url=null),e.lastParams.selectedSystemLocale=App.KnowledgeBaseLocale.detect(e.getKnowledgeBase()).systemLocale(),e.show(e.lastParams)})),this.bind("kb_data_changed",(n=this,function(t){var e;return e="kb_pull_"+t["class"]+"_"+t.id,App.Delay.set(function(){return n.loadChange(t)},1e3,e,"kb_data_changed_loading")})),this.listenTo(App.KnowledgeBase,"kb_data_change_loaded",(i=this,function(){var t;if(i.displayingError&&(t=i.constructor.pickObjectUsing(i.lastParams,i),i.objectVisibleInternally(t)))return i.renderControllers(i.lastParams)})),this.checkForUpdates()},i.prototype.loadChange=function(i){var t,s,e,r,n;return e=i.url+"?full=true","KnowledgeBase::Answer"===i["class"]&&(t=null!=(s=App.KnowledgeBaseAnswer.find(i.id))?s.translations().map(function(t){var e;return null!=(e=t.content())?e.id:void 0}).filter(function(t){return void 0!==t}):void 0)&&0!==t.length&&(e+="&include_contents="+t.join(",")),this.ajax({id:"kb_pull_"+i["class"]+"_"+i.id,type:"GET",url:e,processData:!0,success:(n=this,function(t){return App.Collection.loadAssets(t.assets),n.notifyChangeLoaded()}),error:(r=this,function(t){var e,n;if(404===t.status)return e=i["class"].replace(/::/g,""),(s=null!=(n=App[e])?n.find(i.id):void 0)?(s.remove({clear:!0}),r.notifyChangeLoaded()):void 0})})},i.prototype.objectVisibleInternally=function(t){return!!t&&(!(t instanceof App.KnowledgeBaseAnswer&&!t.exists())&&!(t instanceof App.KnowledgeBaseCategory&&!t.visibleInternally(this.kb_locale())))},i.prototype.notifyChangeLoaded=function(){return App.KnowledgeBase.trigger("kb_data_change_loaded")},i.prototype.active=function(t){return void 0===t?this.shown:this.shown=t},i.prototype.featureActive=function(){return this.permissionCheck("knowledge_base.*")&&App.Config.get("kb_active")||App.Config.get("kb_active_publicly")&&null!=App.KnowledgeBase.first()},i.prototype.activeLocaleSuffix=function(){return this.kb_locale().urlSuffix()},i.prototype.requiredPermissionSuffix=function(t){return"edit"===t.action?"editor":"*"},i.prototype.show=function(t){var e,n,i;if(this.firstRunIfNeeded(),this.navupdate("#knowledge_base"),null!=(i=this.bodyModal)&&i.close(),this.bodyModal=null,this.permissionCheckRedirect("knowledge_base."+this.requiredPermissionSuffix(t)))if(this.loaded&&this.rendered&&this.lastParams&&!t.knowledge_base_id&&this.contentController&&null!=this.kb_locale())this.navigate(this.lastParams.match[0],!0);else{if(this.contentController&&this.contentController.url===t.match[0])return this.title(this.lastTitle),void("function"==typeof(e=this.contentController).restoreVisibility&&e.restoreVisibility());if(this.rendered=!0,this.lastParams=t,!this.loaded||null!==t.selectedSystemLocale||!t.selectedSystemLocalePresent)return this.displayingError=!1,this.loaded?t.knowledge_base_id?this.renderControllers(t):(n=App.KnowledgeBase.all()[0])?this.navigate(n.uiUrl(App.KnowledgeBaseLocale.detect(n)),!0):this.renderScreenErrorInContent("No Knowledge Base created"):this.pendingParams=t;this.renderError()}},i.prototype.renderScreenErrorInContent=function(t){return this.contentController=void 0,this.renderScreenError({detail:t,el:this.$(".page-content")}),this.displayingError=!0},i.prototype.renderControllers=function(t){var e,n,i,s,r;if((n=this.constructor.pickObjectUsing(t,this))&&(this.isEditor()||n.visibleInternally(this.kb_locale())))return r=n instanceof App.KnowledgeBase?"search"===t.action?App.i18n.translateInline("Search"):"":n.guaranteedTitle(this.kb_locale().id),this.updateTitle(r),e=this.contentControllerClass(t),this.contentController=this.buildUsing(e,t,n),null!=(i=this.navigationController)&&i.show(n,t.action),null!=(s=this.sidebarController)?s.show(n,t.action):void 0;this.renderNotFound()},i.prototype.updateTitle=function(t){var e,n,i;return e=(null!=(n=this.getKnowledgeBase())?n.guaranteedTitle(null!=(i=this.kb_locale())?i.id:void 0):void 0)||"",""!==t&&(e&&(e+=" - "),e+=t),this.title(e),this.lastTitle=e},i.prototype.contentControllerClass=function(t){return"search"===t.action?App.KnowledgeBaseSearchController:"edit"===t.action?App.KnowledgeBaseContentController:t.answer_id?App.KnowledgeBaseReaderController:App.KnowledgeBaseReaderListController},i.prototype.edit=!1,i.prototype.renderNotFound=function(){var t,e,n;return n=App.i18n.translateInline("Not Found"),this.updateTitle(n),null!=(t=this.navigationController)&&t.show(void 0,n),this.renderScreenErrorInContent("The page was not found"),null!=(e=this.sidebarController)?e.hide():void 0},i.prototype.renderNotAvailableAnymore=function(){return this.updateTitle(App.i18n.translateInline("Not Available")),this.renderScreenErrorInContent("The page is not available anymore")},i.prototype.renderError=function(){var t,e;return null!=(t=this.bodyModal)&&t.close(),e=App.Utils.joinUrlComponents(this.lastParams.effectivePath,this.getKnowledgeBase().primaryKbLocale().urlSuffix()),this.bodyModal=new App.ControllerModal({head:"Locale not found",contentInline:"<a href='"+e+"'>Open in primary locale</a>",buttonClose:!1,buttonSubmit:!1,backdrop:"static",keyboard:!1,container:this.el})},i.prototype.kb_locale=function(){var t,e;if(t=this.getKnowledgeBase())return this.lastParams.selectedSystemLocale?t.kb_locales().filter((e=this,function(t){return t.system_locale_id===e.lastParams.selectedSystemLocale.id}))[0]:void 0},i.prototype.getKnowledgeBase=function(){return App.KnowledgeBase.find(this.lastParams.knowledge_base_id)},i.prototype.fetchAndRender=function(){return this.fetch(!0,!0)},i.prototype.fetch=function(t,e){var n,i,s;return t&&this.startLoading(),n={answer_translation_content_ids:App.KnowledgeBaseAnswerTranslationContent.all().map(function(t){return t.id})},this.loadInitial(n,{success:(s=this,function(){if(t&&s.stopLoading(),e)return s.processLoaded()}),error:(i=this,function(){if(t)return i.stopLoading()})})},i.prototype.loadInitial=function(t,i){return null==i&&(i={}),this.ajax({id:"knowledge_bases_init",type:"POST",url:this.apiPath+"/knowledge_bases/init",data:JSON.stringify(t),processData:!0,success:(s=this,function(t,e,n){return s.loaded=!0,s.loadKbData(t),"function"==typeof i.success?i.success(t,e,n):void 0}),error:function(t){return"function"==typeof i.error?i.error(t):void 0}});var s},i.prototype.loadKbData=function(t){var r,e,o,n,i,s;for(App.Collection.loadAssets(t),s=[],e=0,n=(i=this.calculateIdsToDelete(t)).length;e<n;e++)r=i[e],s.push(function(){var t,e,n,i,s;for(s=[],t=0,e=(n=r.ids).length;t<e;t++)o=n[t],s.push(null!=(i=App[r.modelName].find(o))?i.remove({clear:!0}):void 0);return s}());return s},i.prototype.calculateIdsToDelete=function(n){return Object.keys(n).filter(function(t){return t.match(/^KnowledgeBase/)}).map(function(t){var e;return e=Object.keys(n[t]),{modelName:t,ids:App[t].all().map(function(t){return t.id}).filter(function(t){return!_.includes(e,String(t))})}},{})},i.prototype.processLoaded=function(){if(this.render(!0),this.pendingParams)return this.show(this.pendingParams),this.pendingParams=void 0},i.prototype.render=function(t){return null==t&&(t=!1),this.html(App.view("knowledge_base/agent")()),this.navigationController=new App.KnowledgeBaseNavigation({el:this.$(".js-navigation"),parentController:this}),this.sidebarController=new App.KnowledgeBaseSidebar({el:this.$(".js-sidebar"),parentController:this})},i.prototype.isEditor=function(){return App.User.current().permission("knowledge_base.editor")},i.prototype.checkForUpdates=function(){return this.interval(this.checkUpdatesAction,6e5,"kb_interval_check")},i.prototype.checkUpdatesAction=function(){if(this.loaded)return this.fetch(!1,!1)},i.prototype.buildUsing=function(t,e,n){return new t({el:this.$(".page-content"),object:n,parentController:this,selectedSystemLocale:e.selectedSystemLocale,url:e.match[0]})},i.prototype.onclick=function(){return!(this.permissionCheck("knowledge_base.*")&&App.Config.get("kb_active"))&&App.Config.get("kb_active_publicly")&&null!=App.KnowledgeBase.first()},i.prototype.accessoryIcon=function(){if(this.onclick())return"external"},i.prototype.clicked=function(){return window.open(App.KnowledgeBase.first().publicBaseUrl(),"_blank")},i.pickObjectUsing=function(t,e){var n,i,s;if(s=e.getKnowledgeBase())return(n=t.answer_id)?App.KnowledgeBaseAnswer.find(n):(i=t.category_id)?App.KnowledgeBaseCategory.find(i):t.knowledge_base_id?s:void 0},i}(App.Controller),App.Config.set("KnowledgeBase",{controller:"KnowledgeBaseAgentController"},"permanentTask"),App.Config.set("KnowledgeBase",{prio:1150,parent:"",name:"Knowledge Base",target:"#knowledge_base",key:"KnowledgeBase","class":"knowledge-base",shown:!1},"NavBar")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseContentCanBePublishedDialog=function(t){function e(t){this.submitTiming=n(this.submitTiming,this),this.saveUpdate=n(this.saveUpdate,this),this.content=n(this.content,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.events={"click .scheduled-widget-delete":"clickedCancelTimer","submit form":"submitTiming"},e.prototype.head="Visibility",e.prototype.includeForm=!1,e.prototype.buttonSubmit=!1,e.prototype.content=function(){return this.formController=new App.KnowledgeBaseContentCanBePublishedForm({object:this.object}),this.formController.form},e.prototype.saveUpdate=function(t,e){return null==e&&(e=null),this.clearAlerts(),this.formController.toggleDisabled(!0),this.ajax({id:"knowledge_base_can_be_published",type:"POST",data:JSON.stringify(t),url:this.object.generateURL("has_publishing_update"),processData:!0,success:(i=this,function(t){return App.Collection.load({type:"KnowledgeBaseAnswer",data:[t]}),"function"==typeof e&&e(),i.formController.toggleDisabled(!1)}),error:(n=this,function(t){var e;return n.formController.toggleDisabled(!1),n.showAlert((null!=(e=t.responseJSON)?e.error:void 0)||"Unable to save changes")})});var n,i},e.prototype.clickedCancelTimer=function(t){var e,n,i;return(e={})[(i=$(t.currentTarget).closest(".scheduled-widget")).data("state")+"_at"]=null,n=e,this.saveUpdate(n,function(){return i.remove()})},e.prototype.submitTiming=function(t){var e,n,i,s,r,o,a,l,c,p;if(this.preventDefaultAndStopPropagation(t),(r={})[(e=this.formParams()).visibility+"_at"]="scheduled"===e.timing?e.scheduled:"--now--",a=r,(s=this.formController.states.indexOf(e.visibility))<(o=this.formController.states.indexOf(this.formController.params.visibility)))for(i=n=l=s+1,c=o;l<=c?n<=c:c<=n;i=l<=c?++n:--n)a[this.formController.states[i]+"_at"]=null;return this.saveUpdate(a,(p=this,function(){if("now"!==e.timing)return p.update(),p.initalFormParams=p.formParams();p.close()}))},e}(App.ControllerModal)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseContentCanBePublishedForm=function(t){function e(t){this.postRendering=n(this.postRendering,this),this.timingHandler=n(this.timingHandler,this),this.visibilityHandler=n(this.visibilityHandler,this),this.scheduledHandler=n(this.scheduledHandler,this),this.prepare(t),e.__super__.constructor.apply(this,arguments),this.postRendering(),this.visibilityRadios.trigger("change")}return i(e,t),e.prototype.elements={".js-datepicker":"datePicker","[name=visibility]":"visibilityRadios","[value=now]":"timingNow","[value=scheduled]":"timingScheduled"},e.prototype.prepare=function(t){return this.handlers=[this.timingHandler,this.visibilityHandler,this.scheduledHandler],this.params={visibility:t.object.can_be_published_state()}},e.prototype.scheduledHandler=function(t,e){if("scheduled"===e.name&&t.scheduled)return this.timingScheduled.prop("checked",!0)},e.prototype.visibilityHandler=function(t,e){var n,i;if("visibility"===e.name)return this.toggleDisabled(!1),0<(i=this.form.find(".scheduled-widget[data-state="+t.visibility+"]")).length&&!this.form.find(".controls--datetime input[data-item=date]").val()?(n=i.data("date"),this.datePicker.datepicker("setDate",n)):(this.datePicker.datepicker("clearDates"),this.timingNow.prop("checked",!0))},e.prototype.timingHandler=function(t,e){if("timing"===e.name&&"now"===t.timing&&t.scheduled)return this.datePicker.datepicker("clearDates")},e.prototype.postRendering=function(){var t,e,n,i,s,r,o,a,l,c;for(e in r=this.elements)this[r[e]]=this.form.find(e);for(this.timingScheduled.parent().addClass("additional-radio-controls").append(this.form.find('[data-name="scheduled"]')),this.form.find('[data-attribute-name="scheduled"]').remove(),this.datePicker.datepicker("setStartDate",new Date),s=new Date,a=[],t=0,i=(o=this.states).length;t<i;t++)l=o[t],this.object[l+"_at"]&&new Date(this.object[l+"_at"])>s?(n=this.form.find("input[value="+l+"]").closest("label"),c=new App.KnowledgeBaseScheduledWidget({object:this.object,state:l}),a.push(n.after(c.el))):a.push(void 0);return a},e.prototype.toggleDisabled=function(t){var e,n,i;return n=this.visibilityRadios.filter(":checked").val(),i=this.params.visibility===n,e=this.states.indexOf(this.params.visibility)>this.states.indexOf(n),this.form.find("[value=now], [type=submit]").attr("disabled",t||i),this.form.find("[value=scheduled], .controls--datetime input").attr("disabled",t||i||e),this.visibilityRadios.attr("disabled",t)},e.prototype.fullForm=!0,e.prototype.fullFormSubmitLabel="Update",e.prototype.fullFormSubmitAdditionalClasses="btn--primary",e.prototype.states=["draft","internal","published","archived"],e.prototype.model={configure_attributes:[{name:"visibility",display:"Permissions",tag:"radio","default":!1,options:[{value:"draft",name:"Draft",note:"Only visible to editors"},{value:"internal",name:"Internal",note:"Visible to agents & editors"},{value:"published",name:"Public",note:"Visible to everyone"},{value:"archived",name:"Archived"}]},{name:"timing",display:"Timing",tag:"radio","default":"now",options:[{value:"now",name:"now"},{value:"scheduled",name:"Schedule for"}]},{name:"scheduled",display:"Date",tag:"datetime","class":"form-control--small","null":!0}]},e}(App.ControllerForm)}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseContentController=function(t){function n(){var t,e;if(n.__super__.constructor.apply(this,arguments),(t=this.object.translation(this.parentController.kb_locale().id))&&!t.fullyLoaded())return this.html(App.view("knowledge_base/content")(this)),this.startLoading(),void t.loadFull((e=this,function(t){if(e.stopLoading(),t)return e.initialize()}));this.initialize()}return e(n,t),n.prototype.elements={".js-form":"form",".js-discard":"discardButton",".js-submitContainer":"submitContainer"},n.prototype.events={"click .js-submit":"submit","click .js-discard":"discardChanges","submit .js-form":"submit","input .js-form":"showDiscardButton","click .js-submit-action":"submit"},n.prototype.initialize=function(){var t,e;return this.render(),this.listenTo(App.KnowledgeBase,"kb_data_change_loaded",(t=this,function(){return t.objectRefreshed(),!0})),this.listenTo(this.object,"refresh",(e=this,function(){return e.renderAvailabilityWidgets()}))},n.prototype.render=function(){return this.html(App.view("knowledge_base/content")(this)),this.renderAvailabilityWidgets(),this.formController=this.buildFormController(this.form),this.startingParams=App.ControllerForm.params(this.formController.el)},n.prototype.buildFormController=function(t){return null==t&&(t=void 0),new App.KnowledgeBaseFormController(this.object,this.parentController.kb_locale(),"agent_edit",t)},n.prototype.remoteDidntChangeSinceStart=function(){var t;return t=this.buildFormController().rawParams(),App.KnowledgeBaseFormController.compareParams(t,this.startingParams)},n.prototype.objectRefreshed=function(){if(this.renderAvailabilityWidgets(),this.remoteDidntChangeSinceStart())this.pendingRerender=!1;else{if(this.parentController.shown)return this.rerenderIfConfirmed();this.pendingRerender=!0}},n.prototype.rerenderIfConfirmed=function(){var t;if(t=App.i18n.translatePlain("Changes were made. Do you want to reload? You'll loose your changes"),confirm(t))return this.render()},n.prototype.renderAvailabilityWidgets=function(){var t,e;if("function"==typeof(t=this.object.constructor).canBePublished?t.canBePublished():void 0)return new App.WidgetButtonWithDropdown({el:this.submitContainer,mainActionLabel:"Update",actions:this.quickActions()}),e=App.view("knowledge_base/content_can_be_published_header_suffix")({object:this.object}),this.el.find(".js-published-header-suffix").replaceWith(e)},n.prototype.submit=function(t){var e,n,i;if(this.preventDefaultAndStopPropagation(t),this.formController.validateAndShowErrors()){if(n=this.formController.paramsForSaving(),e=$(t.currentTarget).data("id"),!this.remoteDidntChangeSinceStart())return new App.ControllerConfirm({head:"Content was changed since loading",message:"Your changes may override someone else's changes. Are you sure to save?",callback:(i=this,function(){return i.parentController.coordinator.saveChanges(i.object,n,i)})});this.parentController.coordinator.saveChanges(this.object,n,this,e)}},n.prototype.missingTranslation=function(){return void 0===this.object.translation(this.parentController.kb_locale().id)&&!this.object.isNew()},n.prototype.showDiscardButton=function(){return this.delay((e=this,function(){var t;return t=App.KnowledgeBaseFormController.compareParams(e.formController.rawParams(),e.startingParams),e.discardButton.toggleClass("hide",t)}),500,"check_unsaved_changes");var e},n.prototype.quickActions=function(){var t,e;return e=App.i18n.translatePlain("Update")+" & ",t=this.object.can_be_published_quick_actions(),[{id:"internal",name:e+App.i18n.translatePlain("Internal"),disabled:!_.includes(t,"internal")},{id:"publish",name:e+App.i18n.translatePlain("Publish"),disabled:!_.includes(t,"publish")},{id:"archive",name:e+App.i18n.translatePlain("Archive"),disabled:!_.includes(t,"archive")}]},n.prototype.discardChanges=function(){return this.render()},n.prototype.showAlert=function(t){var e;return null!=(e=this.formController)?e.showAlert(t):void 0},n.prototype.didSaveCallback=function(){return this.render(),App.Event.trigger("knowledge_base::sidebar::rerender"),App.Event.trigger("knowledge_base::navigation::rerender")},n.prototype.restoreVisibility=function(){var t;if(this.pendingRerender)return this.pendingRerender=!1,App.Delay.set((t=this,function(){return t.rerenderIfConfirmed()}))},n}(App.Controller)}.call(this),function(){var i=function(t,e){return function(){return t.apply(e,arguments)}};App.KnowledgeBaseDeleteAction=function(){function t(t){var e,n;for(e in this.deleteOk=i(this.deleteOk,this),this.doDelete=i(this.doDelete,this),t)n=t[e],this[e]=n;this.object instanceof App.KnowledgeBaseCategory&&!this.object.isEmpty()?this.showCannotDelete("Cannot delete category","Delete all child categories and answers, then try again."):this.showConfirm()}return t.prototype.showConfirm=function(){var t,e;return t=this.parentController.kb_locale(),e=this.object.guaranteedTranslation(t.id),this.dialog=new App.ControllerConfirm({head:"Delete",message:'Are you sure you want to delete "'+(null!=e?e.title:void 0)+'"?',callback:this.doDelete,container:this.parentController.el,onSubmit:function(){return this.formDisable(this.el),this.callback(this),this.dialog=null}})},t.prototype.showCannotDelete=function(t,e){var n,i;return n=new App.ControllerModal({head:t,contentInline:e,container:this.parentController.el,buttonClose:!0,buttonSubmit:"Ok",onSubmit:(i=this,function(){return n.close(),i.dialog=null})}),this.dialog=n},t.prototype.doDelete=function(e){return App.Ajax.request({type:"DELETE",url:this.object.generateURL()+"?full=true",success:(t=this,function(){return t.deleteOk(e)}),error:(n=this,function(t){return n.deleteFailure(e,t)})});var n,t},t.prototype.deleteOk=function(t){var e,n,i;return i=("function"==typeof(e=this.object).parent?e.parent():void 0)||("function"==typeof(n=this.object).category?n.category():void 0)||this.object.knowledge_base(),this.parentController.contentController.stopListening(),this.object.removeIncludingTranslations({clear:!0}),t.close(),this.parentController.navigate(i.uiUrl(this.parentController.kb_locale(),"edit"))},t.prototype.deleteFailure=function(t,e){var n;return t.formEnable(t.el),t.showAlert((null!=(n=e.responseJSON)?n.error:void 0)||"Unable to delete.")},t.prototype.close=function(){var t;return null!=(t=this.dialog)?t.close():void 0},t}()}.call(this),function(){App.KnowledgeBaseEditorCoordinator=function(){function t(t){var e,n;for(e in t)n=t[e],this[e]=n}return t.prototype.clickedCanBePublished=function(t){return new App.KnowledgeBaseContentCanBePublishedDialog({object:t,container:this.parentController.el})},t.prototype.clickedDelete=function(t){return new App.KnowledgeBaseDeleteAction({object:t,parentController:this.parentController})},t.prototype.urlFor=function(t){return t.id?t.generateURL():t.url()},t.prototype.saveChanges=function(t,e,n,i){var s;return App.ControllerForm.disable(n.form),s=this.urlFor(t)+"?full=true",i&&(s+="&additional_action="+i),App.Ajax.request({type:t.writeMethod(),data:JSON.stringify(e),url:s,success:function(t){return App.Collection.loadAssets(t.assets),n.didSaveCallback(t)},error:function(t){return e=JSON.parse(t.responseText),App.ControllerForm.enable(n.form),n.showAlert(e.error||"Unable to save changes.")}})},t}()}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseFormController=function(t){function r(t,e,n,i){var s;this.object=t,this.kb_locale=e,(s=this.currentParams()).form_id=App.ControllerForm.formId(),r.__super__.constructor.call(this,{params:s,autofocus:null!==i,grid:!0,el:i||$("<form>"),screen:n,model:{configure_attributes:this.getAttrs()}})}return e(r,t),r.prototype.getAjaxAttributes=function(t,e){var n;return this.apiPath=App.Config.get("api_path"),e.type="POST",e.url=this.apiPath+"/knowledge_bases/search",e.data.flavor="agent",e.data.knowledge_base_id=this.object.knowledge_base().id,e.data.exclude_ids=[null!=(n=this.object.translation(this.kb_locale.id))?n.id:void 0],e.data.index="KnowledgeBase::Answer::Translation",e.data.locale=this.kb_locale.systemLocale().locale,e.data.highlight_enabled=!1,e.data=JSON.stringify(e.data),e},r.prototype.currentParams=function(){return this.object.attributesIncludingTranslation(this.kb_locale.id)},r.prototype.rawParams=function(){return App.ControllerForm.params(this.el)},r.prototype.paramsForSaving=function(){return this.object.prepareNestedParams(this.rawParams(),this.kb_locale.id)},r.prototype.validateAndShowErrors=function(){var t;return t=this.validate(this.rawParams()),this.constructor.validate({errors:t,form:this.el}),!t},r.prototype.getAttrs=function(){var t,e;return(t=("function"==typeof(e=this.object).configure_attributes?e.configure_attributes(this.kb_locale):void 0)||this.object.constructor.configure_attributes).push({name:"form_id",tag:"input",type:"hidden"}),t},r.compareParams=function(t,e){var n,i,s;for(n=0,i=(s=[t,e]).length;n<i;n++)delete s[n].form_id;return _.isEqual(t,e)},r}(App.ControllerForm)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseReaderPagination=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.render()}return n(e,t),e.prototype.className="knowledge-base-article-nav",e.prototype.render=function(){var t,e,n,i,s,r,o;for(this.stopListening(),s=this.calculatePreviousAnswer(),n=this.calculateNextAnswer(),this.html(App.view("knowledge_base/_reader_pagination")({previousAnswer:null!=s?s.attributesForRendering(this.kb_locale):void 0,nextAnswer:null!=n?n.attributesForRendering(this.kb_locale):void 0})),o=[],t=0,e=(r=[this.object,s,n,this.object.category()]).length;t<e;t++)(i=r[t])?o.push(this.listenTo(i,"refresh",function(t){return function(){return t.render()}}(this))):o.push(void 0);return o},e.prototype.calculatePreviousAnswer=function(){return this.calculateSiblingAnswer(-1)},e.prototype.calculateNextAnswer=function(){return this.calculateSiblingAnswer(1)},e.prototype.calculateSiblingAnswer=function(t){var e,n,i,s,r,o;if(r=this.calculateSibling(this.object.category().answers(),this.object,t))return r;if(t<0&&(e=this.findlastAnswer(this.object.category())))return e;for(s=this.object;s;){if(n=(i=("function"==typeof s.category?s.category():void 0)||("function"==typeof s.parent?s.parent():void 0))?i.children():s.knowledge_base().rootCategories(),o=this.findAnswerInSiblingCategory(s,n,t))return o;s=i}return null},e.prototype.calculateSibling=function(t,e,n){return t[this.getIndexOf(t,e)+n]},e.prototype.getIndexOf=function(t,e){var n;return n=t.filter(function(t){return t.id===e.id})[0],t.indexOf(n)},e.prototype.findlastAnswer=function(t,e){var n,i,s,r,o;if(null==e&&(e=!1),e&&(s=t.answers().slice(-1)[0]))return s;for(i=0,r=(o=t.children().reverse()).length;i<r;i++)if(t=o[i],n=this.findlastAnswer(t,!0))return n;return null},e.prototype.findFirstAnswer=function(t){var e,n,i,s;for(n=0,i=(s=t.children()).length;n<i;n++)if(t=s[n],e=this.findFirstAnswer(t))return e;return t.answers()[0]},e.prototype.findAnswerInSiblingCategory=function(t,e,n){var i,s,r,o,a;for(s=this.getIndexOf(e,t),a=(i=n<(o=0)?e.slice(0,s).reverse():e.slice(s+1)).length;o<a;o++)if(t=i[o],r=n<0?this.findlastAnswer(t,!0):this.findFirstAnswer(t))return r;return null},e}(App.Controller)}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseNavigation=function(t){function n(){var t,e;n.__super__.constructor.apply(this,arguments),this.render(),this.bind("knowledge_base::navigation::rerender",(t=this,function(){return t.needsUpdate()})),this.listenTo(App.KnowledgeBase,"kb_data_change_loaded",(e=this,function(){return e.needsUpdate()}))}return e(n,t),n.extend(Spine.Events),n.prototype.events={"click .js-search":"clickedToggleSearch"},n.prototype.elements={".js-edit":"editButton"},n.prototype.buildCrumbsForRendering=function(t,e,n){return"search"===n&&(n=null),e?t.filter(function(t){return null!=t}).map((i=this,function(t){return"string"==typeof t?{title:t}:(i.listenToChangesOn(t),t.attributesForRendering(e,{action:n}))})):[];var i},n.prototype.listenToChangesOn=function(t){var e,n;if(e=this.parentController.kb_locale())return this.stopListening(t,"refresh"),this.listenToOnce(t.translationBindlableObject(e.id),"refresh",(n=this,function(){return n.needsUpdate()}))},n.prototype.show=function(t,e){var n,i,s;if(this.savedAction=e,!this.dontRenderFor(t))return n=(s=this.calculateTitle(t,e))?[this.parentController.getKnowledgeBase(),s]:this.breadcrumbTo(t).reverse(),i=this.buildCrumbsForRendering(n,this.parentController.kb_locale(),e),this.render(i,t,e),this.savedParams=t},n.prototype.calculateTitle=function(t,e){return"search"===e?App.i18n.translateInline("Search"):t?void 0:App.i18n.translateInline("Not found")},n.prototype.dontRenderFor=function(t){return t instanceof App.Model&&(t.isNew()&&!t.isFresh)},n.prototype.needsUpdate=function(){return this.show(this.savedParams,this.savedAction)},n.prototype.selectedLocaleDisplay=function(){var t;return(null!=(t=this.parentController.kb_locale())?t.systemLocale().alias:void 0)||"-"},n.prototype.render=function(t,e,n){var i;if(null==t&&(t=[]),null==e&&(e=null),null==n&&(n=null),i=this.parentController.kb_locale())return this.html(App.view("knowledge_base/navigation")({crumbs:t,kbLocales:this.kbLocaleOptions(e,i,n),search:this.searchOptions(e,i,n),edit:this.editOptions(e,i,n),externalUrl:this.externalUrl(e,i,n),iconset:this.parentController.getKnowledgeBase().iconset}))},n.prototype.kbLocaleOptions=function(t,e){return{selected:e,collection:this.kb_locales()}},n.prototype.searchOptions=function(t,e,n){var i,s,r;return{enabled:i="search"===n,url:!0===i?this.toggleSearchSource||(null!=(s=this.parentController.getKnowledgeBase())?s.uiUrl(e):void 0):null!=(r=this.parentController.getKnowledgeBase())?r.uiUrl(e,"search"):void 0}},n.prototype.editOptions=function(t,e,n){var i;return i="edit"===n,{url:null!=t?t.uiUrl(e,i?void 0:"edit"):void 0,enabled:i,available:this.parentController.isEditor()}},n.prototype.externalUrl=function(t,e,n){if((!n||"edit"===n)&&((null!=t&&"function"==typeof t.visiblePublicly?t.visiblePublicly(e):void 0)||null!=(null!=t&&"function"==typeof t.translation?t.translation(null!=e?e.id:void 0):void 0)&&this.parentController.isEditor()))return t.publicBaseUrl(e)},n.prototype.kb_locales=function(){var e;return e="#"+this.parentController.lastParams.match.input,this.parentController.getKnowledgeBase().kb_locales().map(function(t){return t.attributesForRendering(e)})},n.prototype.toggleSearchSource=void 0,n.prototype.clickedToggleSearch=function(){if("search"!==this.savedAction)return this.toggleSearchSource=location.hash},n.prototype.breadcrumbTo=function(t){return t?function(){switch(t.constructor){
case App.KnowledgeBaseAnswer:return this.breadcrumbToAnswer(t);case App.KnowledgeBaseCategory:return this.breadcrumbToCategory(t);case App.KnowledgeBase:return this.breadcrumbToKb(t)}}.call(this):[]},n.prototype.breadcrumbToAnswer=function(t){return[t].concat(this.breadcrumbToCategory(t.category()))},n.prototype.breadcrumbToCategory=function(t){var e,n;for(e=[t];n=(n||t).parent();)e=e.concat(n);return e.concat(this.breadcrumbToKb(t.knowledge_base()))},n.prototype.breadcrumbToKb=function(t){return[t]},n}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBasePublicMenuForm=function(t){function e(t){this.onError=n(this.onError,this),this.onSuccess=n(this.onSuccess,this),this.formParams=n(this.formParams,this),this.formItems=[],this.head=t.location.headline,e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.autoFocusOnFirstInput=!1,e.prototype.includeForm=!0,e.prototype.formParams=function(){return this.formItems.map(function(t){return t.buildData()})},e.prototype.content=function(){var n;return this.formItems=App.KnowledgeBase.find(this.knowledge_base_id).kb_locales().map((n=this,function(t){var e;return e=App.KnowledgeBaseMenuItem.using_kb_locale_location(t,n.location.identifier),new App.KnowledgeBasePublicMenuFormItem({parent:n,knowledge_base_id:n.knowledge_base_id,location:n.location.identifier,kb_locale:t,menu_items:e})})),this.formItems.map(function(t){return t.el})},e.prototype.hasError=function(){return this.formItems.map(function(t){return t.hasError()}).filter(function(t){return t}).pop()},e.prototype.onSubmit=function(t){var e,n;if(this.preventDefaultAndStopPropagation(t),!(e=this.hasError()))return this.clearAlerts(),this.formItems.forEach(function(t){return t.toggleUserInteraction(!1)}),n=App.KnowledgeBase.find(this.knowledge_base_id),this.ajax({id:"update_menu_items",type:"PATCH",url:n.manageUrl("update_menu_items"),data:JSON.stringify({menu_items_sets:this.formParams()}),processData:!0,success:this.onSuccess,error:this.onError});this.showAlert(e)},e.prototype.onSuccess=function(t){var e,n,i,s,r,o,a;for(n=0,s=(o=this.formItems).length;n<s;n++)for(e=o[n],i=0,r=(a=App.KnowledgeBaseMenuItem.using_kb_locale_location(e.kb_locale,e.location)).length;i<r;i++)a[i].remove({clear:!0});return App.Collection.loadAssets(t.assets),App.KnowledgeBaseMenuItem.trigger("kb_data_change_loaded"),this.close()},e.prototype.onError=function(t){var e;return this.showAlert((null!=(e=t.responseJSON)?e.error_human:void 0)||"Couldn't save changes"),this.formItems.forEach(function(t){return t.toggleUserInteraction(!0)})},e}(App.ControllerModal)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBasePublicMenuFormItem=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.render()}return n(e,t),e.prototype.events={"click .js-add":"add","click .js-remove":"remove","input input":"input"},e.prototype.elements={".js-alert":"alert"},e.prototype.render=function(){return this.html(App.view("knowledge_base/public_menu_form_item")({rows:this.menu_items,title:this.kb_locale.systemLocale().name})),this.applySortable()},e.prototype.applySortable=function(){var t;return t={tolerance:"pointer",distance:15,opacity:.6,items:"tr.sortable",start:function(t,e){return e.placeholder.height(e.item.height())},helper:function(t,e){var n,i;return i=e.children(),(n=e).children().each(function(t){return $(this).width(i.eq(t).width())}),n},update:this.dndCallback,stop:function(t,e){return e.item.children().each(function(t,e){return e.style.width=""})}},this.el.find("tbody").sortable(t)},e.prototype.toggleUserInteraction=function(t){return t?App.ControllerForm.enable(this.el):App.ControllerForm.disable(this.el),this.$(".js-remove, .js-add").attr("disabled",!t),this.el.find("tbody").sortable({disabled:!t})},e.prototype.buildData=function(){var t;return t=this.$("tr.sortable").toArray().map(function(t){return $(t)}).map(function(t){return{id:t.data("id"),title:t.find("input[data-name=title]").val(),url:t.find("input[data-name=url]").val(),new_tab:t.find("input[data-name=new_tab]").prop("checked"),_destroy:t.hasClass("js-deleted")}}),{kb_locale_id:this.kb_locale.id,location:this.location,menu_items:t}},e.prototype.input=function(){if(!this.hasError())return this.parent.clearAlerts()},e.prototype.add=function(){var t;return t=App.view("knowledge_base/public_menu_form_item_row")(),$(t).insertBefore(this.$("tr:has(.js-add)"))},e.prototype.remove=function(t){var e;return(e=$(t.currentTarget).closest("tr")).data("id")?(e.toggleClass("settings-list--deleted js-deleted"),e.find(".js-remove input").prop("checked",e.hasClass("settings-list--deleted")),e.find(".js-new-tab input").attr("disabled",e.hasClass("js-deleted"))):e.remove()},e.prototype.findEmptyFields=function(){return this.$("tr.sortable:not(.js-deleted)").find("input[data-name]").toArray().filter(function(t){return 0===$(t).val().length})},e.prototype.hasError=function(){return 0!==this.findEmptyFields().length&&"Please fill in all fields"},e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBasePublicMenuManager=function(t){function e(){var t;this.edit=n(this.edit,this),e.__super__.constructor.apply(this,arguments),this.listenTo(App.KnowledgeBaseMenuItem,"kb_data_change_loaded",(t=this,function(){return t.render()}))}return i(e,t),e.prototype.events={"show.bs.tab":"willShow","click .js-edit":"edit"},e.prototype.willShow=function(){return this.render()},e.prototype.render=function(){var t;return t=App.KnowledgeBase.find(this.knowledge_base_id),this.html(App.view("knowledge_base/public_menu_manager")({locations:this.locations(),locales:t.kb_locales()}))},e.prototype.locations=function(){return[{headline:"Header menu",identifier:"header",color:App.KnowledgeBase.find(this.knowledge_base_id).color_header},{headline:"Footer menu",identifier:"footer"}]},e.prototype.edit=function(t){var e,n;return this.preventDefaultAndStopPropagation(t),e=$(t.target).data("target-location"),n=_.find(this.locations(),function(t){return t.identifier===e}),new App.KnowledgeBasePublicMenuForm({location:n,knowledge_base_id:this.knowledge_base_id,container:this.el.closest(".main")})},e}(App.Controller)}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseReaderController=function(t){function n(){var t,e;if(n.__super__.constructor.apply(this,arguments),t=this.object.translation(this.parentController.kb_locale().id),this.html(App.view("knowledge_base/reader")({search_return_url:this.buildSearchReturnUrl()})),t&&!t.fullyLoaded())return this.startLoading(this.answerBody),void t.loadFull((e=this,function(t){if(e.stopLoading(),t)return e.initialize()}));this.initialize()}return e(n,t),n.extend(App.PopoverProvidable),n.registerPopovers("Ticket"),n.prototype.elements={".js-answer-title":"answerTitle",".js-answer-body":"answerBody",".js-answer-pagination":"answerPagination",".js-answer-attachments":"answerAttachments",".js-answer-linked-tickets":"answerLinkedTickets",".js-answer-meta":"answerMeta"},n.prototype.initialize=function(){return this.render()},n.prototype.render=function(){var t,e;if(this.stopListening(),t=this.parentController.kb_locale(),this.renderAnswer(this.object,t),this.object)return this.listenTo(App.KnowledgeBase,"kb_data_change_loaded",(e=this,function(){return e.renderAnswer(e.object,t)}))},n.prototype.renderAnswer=function(t,e){var n,i,s;if(t)if(t.exists()){if(this.renderAttachments(t.attachments),this.renderLinkedTickets(null!=(s=t.translation(e.id))?s.linked_tickets():void 0),i=new App.KnowledgeBaseReaderPagination({object:this.object,kb_locale:e}),this.answerPagination.html(i.el),n=t.translation(e.id))return this.answerTitle.text(n.title),this.renderBody(n),this.answerMeta.html(App.view("knowledge_base/_reader_answer_meta")({answer:t})),this.renderPopovers();this.renderTranslationMissing(t)}else this.parentController.renderNotAvailableAnymore();else this.parentController.renderNotFound()},n.prototype.renderBody=function(t){var e;return e=t.content().body,e=this.prepareLinks(e),e=this.prepareVideos(e),this.answerBody.html(e)},n.prototype.prepareLinks=function(t){var e,n,i,s,r;for(e=0,n=(r=(t=$($.parseHTML(t))).find("a").andSelf("a").toArray()).length;e<n;e++)switch(i=r[e],$(i).attr("data-target-type")){case"knowledge-base-answer":(s=App.KnowledgeBaseAnswerTranslation.find($(i).attr("data-target-id")))?$(i).attr("href",s.uiUrl()):$(i).attr("href","#")}return $("<container>").append(t).html()},n.prototype.prepareVideos=function(t){return t.replace(/\(([\s]*)widget:([\s]*)video[\W]([\s\S])+?\)/g,function(t){var e,n;return e=t.slice(1,-1).split(",").map(function(t){return t.split(":").map(function(t){return t.trim()})}).reduce(function(t,e){return t[e[0]]=e[1],t},{}),(n=function(){switch(e.provider){case"youtube":return"https://www.youtube.com/embed/"+e.id;case"vimeo":return"https://player.vimeo.com/video/"+e.id}}())?"<div class='videoWrapper'><iframe id='"+e.provider+e.id+"' type='text/html' src='"+n+"' frameborder='0'></iframe></div>":t})},n.prototype.renderAttachments=function(t){return this.answerAttachments.html(App.view("generic/attachments")({attachments:t}))},n.prototype.renderLinkedTickets=function(t){return this.answerLinkedTickets.html(App.view("knowledge_base/_reader_linked_tickets")({tickets:t}))},n.prototype.renderTranslationMissing=function(e){var n;{if(this.parentController.isEditor())return this.renderScreenPlaceholder({icon:App.Utils.icon("mood-ok"),detail:"Not available in selected language",el:this.answerBody,action:"Create a translation",actionCallback:(n=this,function(){var t;return t=e.uiUrl(n.parentController.kb_locale(),"edit"),n.navigate(t)})});this.parentController.renderNotFound()}},n.prototype.buildSearchReturnUrl=function(){if("search-return"===this.parentController.lastParams.action)return decodeURIComponent(this.parentController.lastParams.arguments)},n}(App.Controller)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseReaderListContainer=function(t){function e(){var t;e.__super__.constructor.apply(this,arguments),this.render(),this.listenTo(App.KnowledgeBase,"kb_data_change_loaded",(t=this,function(){return t.parentRefreshed()}))}return n(e,t),e.prototype.tag="ul",e.prototype.className="sections",e.prototype.parentRefreshed=function(){var t,e,n;if(t=this.children().map(function(t){return t.id}),e=this.el.children().toArray().map(function(t){return parseInt(t.dataset.id)}),!_.isEqual(t,e))return App.Delay.set((n=this,function(){return n.render()}),200,this.constructor.className+"_"+this.parent.constructor.className+":"+this.parent.id,"kb_category_refresh")},e.prototype.render=function(){var t,e,n,i,s;for(this.el.empty(),s=[],e=0,n=(i=this.children()).length;e<n;e++)t=i[e],s.push(this.el.append(new App.KnowledgeBaseReaderListItem({item:t,isEditor:this.isEditor,iconset:this.parent.knowledge_base().iconset,kb_locale:this.kb_locale,parentController:this}).el));return s},e}(App.Controller),App.KnowledgeBaseReaderListContainer.Answers=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.children=function(){var t,e;return this.parent instanceof App.KnowledgeBaseCategory?(t=this.parent.answers(),this.isEditor||(t=t.filter((e=this,function(t){return t.is_internally_published(e.kb_locale)}))),t):[]},e}(App.KnowledgeBaseReaderListContainer),App.KnowledgeBaseReaderListContainer.Categories=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.render=function(){return e.__super__.render.apply(this,arguments),this.el.addClass("sections--"+this.layout()),this.el[0].dataset.size=this.size()},e.prototype.children=function(){var t,e;return t=this.parent instanceof App.KnowledgeBase?this.parent.rootCategories():this.parent instanceof App.KnowledgeBaseCategory?this.parent.children():[],this.isEditor||(t=t.filter((e=this,function(t){return t.visibleInternally(e.kb_locale)}))),t},e.prototype.layout=function(){return this.parent instanceof App.KnowledgeBase?this.parent.knowledge_base().homepage_layout:this.parent.knowledge_base().category_layout},e.prototype.size=function(){return this.parent instanceof App.KnowledgeBase?"large":"medium"},e}(App.KnowledgeBaseReaderListContainer)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseReaderListController=function(t){function e(){var t;this.searchPanelDidEnd=n(this.searchPanelDidEnd,this),this.searchPanelWillStart=n(this.searchPanelWillStart,this),e.__super__.constructor.apply(this,arguments),this.render(),this.listenTo(App.KnowledgeBase,"kb_data_change_loaded",(t=this,function(){if(!t.objectVisibleInternally())return t.parentController.renderNotAvailableAnymore()}))}return i(e,t),e.prototype.elements={".js-readerListContainer":"container"},e.prototype.objectVisibleInternally=function(){return this.object.visibleInternally(this.parentController.kb_locale())},e.prototype.render=function(){var r,o;if(this.parentController.isEditor()||this.object&&this.object.exists()&&this.objectVisibleInternally()){var e,a;if(!this.object.isEmpty())return this.html(App.view("knowledge_base/reader_list")()),this.searchFieldPanel=new App.KnowledgeBaseSearchFieldPanel({el:this.$(".js-searchFieldContainer"),context:this.object,kb_locale:this.parentController.kb_locale(),return_path:this.object.uiUrl(this.parentController.kb_locale(),"search-inline"),willStart:this.searchPanelWillStart,didEnd:this.searchPanelDidEnd}),"search-inline"===this.parentController.lastParams.action&&this.searchFieldPanel.widget.startSearch(this.parentController.lastParams.arguments),r=this.parentController.isEditor(),o=this.parentController.kb_locale(),setTimeout((a=this,function(){var t,e,n,i,s;for(s=[],t=0,n=(i=["Categories","Answers"]).length;t<n;t++)e=i[t],s.push(a.container.append(new App.KnowledgeBaseReaderListContainer[e]({parent:a.object,isEditor:r,kb_locale:o}).el));return s}),100);this.renderScreenPlaceholder({icon:App.Utils.icon("mood-ok"),detail:"This category is empty",action:"Start Editing",actionCallback:(e=this,function(){var t;return t=e.object.uiUrl(e.parentController.kb_locale(),"edit"),e.navigate(t)})})}else this.parentController.renderNotFound()},e.prototype.searchPanelWillStart=function(){return this.container.addClass("hide")},e.prototype.searchPanelDidEnd=function(){return this.container.removeClass("hide")},e}(App.Controller)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseReaderListItem=function(t){function e(){var t;e.__super__.constructor.apply(this,arguments),this.render(),this.el[0].dataset.id=this.item.id,this.listenTo(App.KnowledgeBase,"kb_data_change_loaded",(t=this,function(){return t.render()}))}return n(e,t),e.prototype.tag="li",e.prototype.className="section",e.prototype.render=function(){var t,e;return null!==this.sort_order&&this.sort_order!==this.item.position&&App.Delay.set((e=this,function(){return e.parentController.parentRefreshed()}),1e3,"kb_reader_list_resort"),this.sort_order=this.item.position,t=this.item.attributesForRendering(this.kb_locale,{isEditor:this.isEditor}),this.el.prop("className").split(" ").filter(function(t){return t.match("kb-item--")}).forEach(function(t){return this.el.removeClass(t)}),this.el.addClass(t.className),this.html(App.view("knowledge_base/_reader_list_item")({item:t,iconset:this.iconset}))},e}(App.Controller)}.call(this),function(){var n,i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=function(t){function e(t){e.__super__.constructor.apply(this,arguments),t.locale&&(t.selectedSystemLocale=App.Locale.findByAttribute("locale",t.locale),t.selectedSystemLocalePresent=!0),this.authenticateCheckRedirect(),App.TaskManager.execute({key:"KnowledgeBase",controller:"KnowledgeBaseAgentController",params:t,show:!0,persistent:!0})}return i(e,t),e.prototype.requiredPermission="knowledge_base.*",e}(App.ControllerPermanent),["/category/:category_id","/answer/:answer_id",""].reduce(function(t,e){return t.concat([e,e+"/:action",e+"/:action/:arguments"])},[]).forEach(function(t){var e;return e="knowledge_base/:knowledge_base_id/locale/:locale"+t,App.Config.set(e,n,"Routes")}),App.Config.set("knowledge_base",n,"Routes")}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseScheduledWidget=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.el.attr("data-state",this.state),this.el.data("date",this.getDate()),this.render()}return n(e,t),e.prototype.className="scheduled-widget",e.prototype.getDate=function(){var t;if(t=this.object[this.state+"_at"])return new Date(t)},e.prototype.render=function(){return this.html(App.view("knowledge_base/scheduled_widget")({timestamp:App.i18n.translateTimestamp(this.getDate()),state:this.state}))},e}(App.Controller)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseSearchController=function(t){function e(){var t;e.__super__.constructor.apply(this,arguments),this.html(App.view("knowledge_base/search")({knowledge_base:this.parentController.getKnowledgeBase(),kb_locale:this.parentController.kb_locale()})),this.searchFieldPanel=new App.KnowledgeBaseSearchFieldPanel({el:this.$(".js-searchFieldContainer"),context:this.parentController.getKnowledgeBase(),kb_locale:this.parentController.kb_locale(),return_path:this.parentController.getKnowledgeBase().uiUrl(this.parentController.kb_locale(),"search")}),(t=this.parentController.lastParams.arguments)&&this.searchFieldPanel.widget.startSearch(t),this.searchFieldPanel.widget.focus()}return n(e,t),e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseSearchFieldPanel=function(t){function e(){this.renderResults=n(this.renderResults,this),this.renderError=n(this.renderError,this),this.widgetWillStartLoading=n(this.widgetWillStartLoading,this),this.widgetDidEnd=n(this.widgetDidEnd,this),this.widgetWillStart=n(this.widgetWillStart,this),this.clear=n(this.clear,this),e.__super__.constructor.apply(this,arguments),this.html(App.view("knowledge_base/search_field_panel")()),this.widget=new App.KnowledgeBaseSearchFieldWidget({el:this.$(".searchfield"),kb_locale:this.kb_locale,context:this.context,willStart:this.widgetWillStart,didEnd:this.widgetDidEnd,willStartLoading:this.widgetWillStartLoading,renderError:this.renderError,renderResults:this.renderResults})}return i(e,t),e.prototype.elements={".js-placeholderEmpty":"emptyPlaceholder",".js-placeholderError":"errorPlaceholder",".js-results":"resultsContainer"},e.prototype.context=void 0,e.prototype.kb_locale=null,e.prototype.willStart=null,e.prototype.didEnd=null,e.prototype.clear=function(){return this.resultsContainer.empty(),this.errorPlaceholder.addClass("hide"),this.emptyPlaceholder.addClass("hide")},e.prototype.widgetWillStart=function(){return"function"==typeof this.willStart?this.willStart():void 0},e.prototype.widgetDidEnd=function(){return this.clear(),"function"==typeof this.didEnd?this.didEnd():void 0},e.prototype.widgetWillStartLoading=function(){return this.clear()},e.prototype.renderError=function(t){return this.errorPlaceholder.removeClass("hide").find(".help-block--inner").text(App.i18n.translateInline(t))},e.prototype.renderResults=function(r,t){var o,a,e;if(this.clear(),0!==r.result.length)return a=this.buildReturnSuffix(t),o=App.Utils.joinUrlComponents(this.return_path,t),e=r.result.map(function(t,e){var n,i,s;return n=r.details[e],i=t.type.replace(/::/g,""),s=App[i].find(t.id),new App.KnowledgeBaseSearchItem({object:s,meta:t,details:n,pathSuffix:a,return_path:o})}).map(function(t){return t.el}),this.resultsContainer.append(e);this.emptyPlaceholder.removeClass("hide")},e.prototype.buildReturnSuffix=function(t){return encodeURIComponent(App.Utils.joinUrlComponents(this.return_path,t))},e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseSearchFieldWidget=function(t){function e(){var t;this.onSuccess=n(this.onSuccess,this),this.onError=n(this.onError,this),e.__super__.constructor.apply(this,arguments),this.cache={},this.html(App.view("knowledge_base/search_field_widget")({placeholder_suffix:null!=(t=this.context)?t.guaranteedTitle(this.kb_locale.id):void 0}))}return i(e,t),e.prototype.className="searchfield",e.prototype.elements={".js-searchField":"searchField",".js-emptySearchButton":"emptySearchButton"},e.prototype.events={"input .js-searchField":"input","click .js-emptySearchButton":"clear"},e.prototype.isActive=!1,e.prototype.context=void 0,e.prototype.kb_locale=null,e.prototype.renderError=null,e.prototype.renderResults=null,e.prototype.willStartLoading=null,e.prototype.willStart=null,e.prototype.didEnd=null,e.prototype.clear=function(){return this.searchField.val(""),this.emptySearchButton.addClass("hide"),this.isActive=!1,"function"==typeof this.didEnd?this.didEnd():void 0},e.prototype.input=function(){var t,e;return t=this.searchField.val(),this.emptySearchButton.toggleClass("hide",0===t.length),""===t?(this.abortAjaxCalls(),this.isActive=!1,void("function"==typeof this.didEnd&&this.didEnd())):(this.isActive||(this.isActive=!0,"function"==typeof this.willStart&&this.willStart()),"function"==typeof this.willStartLoading&&this.willStartLoading(),this.searchField.addClass("loading"),this.delay((e=this,function(){return e.makeRequest(t)}),100,"makeRequest"))},e.prototype.data=function(t){var e;return e={query:t,flavor:"agent",knowledge_base_id:this.context.knowledge_base().id,locale:this.kb_locale.systemLocale().locale},this.context instanceof App.KnowledgeBaseCategory&&(e.scope_id=this.context.id),e},e.prototype.url=function(){return App.Utils.joinUrlComponents(App.KnowledgeBase.url,"search")},e.prototype.makeRequest=function(e){var t,n;{if(!(t=this.cache[e]))return this.ajax({id:"kb_search_loading",type:"POST",url:this.url(),data:JSON.stringify(this.data(e)),success:(n=this,function(t){return n.cache[e]=t,n.onSuccess(t,e)}),error:this.onError});this.onSuccess(t)}},e.prototype.onError=function(t){var e,n,i;if(0!==t.status)return this.searchField.removeClass("loading"),i=(null!=(e=t.responseJSON)?e.error_human:void 0)||(null!=(n=t.responseJSON)?n.errorr:void 0)||"Unable to load",this.renderError(i);0===this.ajaxCalls.length&&this.searchField.removeClass("loading")},e.prototype.onSuccess=function(t,e){return this.searchField.removeClass("loading"),App.Collection.loadAssets(t.assets),"function"==typeof this.renderResults?this.renderResults(t,e):void 0},e.prototype.focus=function(){return this.searchField.focus()},e.prototype.startSearch=function(t){return this.searchField.val(t).trigger("input")},e}(App.Controller)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseSearchItem=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.render()}return n(e,t),e.prototype.tag="li",e.prototype.className="section",e.prototype.events={"click a":"searchLinkClicked"},e.prototype.data=function(){var t,e,n;return t=this.object.parent().attributesForRendering(App.KnowledgeBaseLocale.localeFor(this.object)),(e=this.details||{}).url=(null!=(n=this.object)?n.uiUrl("search-return/"+this.pathSuffix):void 0)||"#",e.state=t.state,e.iconFont=t.iconFont,e},e.prototype.render=function(){return this.html(App.view("knowledge_base/search_item")({data:this.data(),iconset:this.object.parent().knowledge_base().iconset}))},e.prototype.searchLinkClicked=function(){if(null!=window.history&&null!=this.return_path)return window.history.replaceState(null,null,this.return_path)},e}(App.Controller)}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseSidebar=function(t){function n(){var t,e;n.__super__.constructor.apply(this,arguments),this.show(),this.bind("knowledge_base::sidebar::rerender",(t=this,function(){return t.rerender()})),this.listenTo(App.KnowledgeBase,"kb_data_change_loaded",(e=this,function(){return e.rerender(),!0}))}return e(n,t),n.extend(Spine.Events),n.prototype.events={"click .js-content-actions-container a":"contentActionClicked"},n.prototype.rerender=function(){return this.show(this.savedParams,this.savedAction)},n.prototype.contentActionClicked=function(t){var e,n;return e=function(){switch(t.target.dataset.action){case"delete":return"clickedDelete";case"visibility":return"clickedCanBePublished"}}(),this.parentController.bodyModal="function"==typeof(n=this.parentController.coordinator)[e]?n[e](this.savedParams):void 0},n.prototype.show=function(t,e){var n,i,s,r,o,a;if(i="edit"===e,this.el.toggleClass("hidden",!i),this.savedParams=t,this.savedAction=e,this.el.empty(),i){for(o=[],n=0,s=(r=this.widgets(t)).length;n<s;n++)a=r[n],o.push(this.el.append(new a({object:t,kb_locale:this.parentController.kb_locale(),parentController:this.parentController}).el));return o}},n.prototype.hide=function(){return this.el.addClass("hidden")},n.prototype.widgets=function(t){var e;return e=[App.KnowledgeBaseSidebarActions],(t instanceof App.KnowledgeBase||t instanceof App.KnowledgeBaseCategory)&&e.push(App.KnowledgeBaseSidebarCategories),t instanceof App.KnowledgeBaseCategory&&e.push(App.KnowledgeBaseSidebarAnswers),t instanceof App.KnowledgeBaseAnswer&&(e.push(App.KnowledgeBaseSidebarLinkedTickets),e.push(App.KnowledgeBaseSidebarAttachments)),e},n}(App.Controller)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseSidebarGenericList=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.html(App.view("knowledge_base/sidebar/generic_list")(this.templateOptions()))}return n(e,t),e.prototype.className="sidebar-block",e.prototype.events={"click .js-reorder":"openReorder","click .js-add":"openAdd"},e.prototype.templateOptions=function(){return{iconset:this.object.knowledge_base().iconset,items:this.items(),urlNew:this.urlNew(),enabled:!0,title:this.title,emptyNote:this.emptyNote}},e.prototype.openReorder=function(t){return t.preventDefault(),t.stopPropagation(),this.parentController.bodyModal=new App.ControllerReorderModal({container:this.parentController.body,items:this.items(),url:this.reorderSaveUrl()})},e.prototype.openAdd=function(t){var e;return t.preventDefault(),t.stopPropagation(),(e=this.newObject()).isFresh=!0,this.parentController.bodyModal=new App.KnowledgeBaseAddForm({object:e,container:this.parentController.body,parentController:this.parentController})},e.prototype.newObject=function(){},e.prototype.reorderSaveUrl=function(){},e.prototype.items=function(){},e.prototype.urlNew=function(){},e}(App.Controller)}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseSidebarActions=function(t){function i(){var t,e,n;i.__super__.constructor.apply(this,arguments),e=(t=null!=(n=this.object)?n.contentSidebarActions(this.kb_locale):void 0)?App.view("knowledge_base/sidebar/actions")({actions:t}):"",this.html(e)}return e(i,t),i.prototype.className="sidebar-block",i}(App.Controller)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseSidebarAnswers=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.templateName="answers",e.prototype.title="Answers",e.prototype.emptyNote="No answers",e.prototype.urlNew=function(){return"#knowledge_base/"+this.object.knowledge_base().id+"/category/"+this.object.id+"/answers/new"},e.prototype.answers=function(){return this.object.answers()},e.prototype.items=function(){return this.answers().sort(function(t,e){return t.position-e.position}).map((e=this,function(t){return t.attributesForRendering(e.kb_locale,{action:"edit",isEditor:!0})}));var e},e.prototype.reorderSaveUrl=function(){return this.object.generateURL("reorder_answers")},e.prototype.newObject=function(){return new App.KnowledgeBaseAnswer({category_id:this.object.id})},e}(App.KnowledgeBaseSidebarGenericList)}.call(this),function(){var i,n=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;App.KnowledgeBaseSidebarAttachments=function(t){function e(){this.onProgress=n(this.onProgress,this),this.onCompleted=n(this.onCompleted,this),this.onAborted=n(this.onAborted,this),this.onStart=n(this.onStart,this),this.onFileAdded=n(this.onFileAdded,this),this.fetch=n(this.fetch,this),this["delete"]=n(this["delete"],this),this.needsUpdate=n(this.needsUpdate,this),e.__super__.constructor.apply(this,arguments),this.render(),this.listenTo(this.object,"refresh",this.needsUpdate)}return s(e,t),e.prototype.className="sidebar-block",e.prototype.events={"click .js-delete":"delete","html5Upload.dropZone.show":"showDropZone","html5Upload.dropZone.hide":"hideDropZone"},e.prototype.elements={".attachmentUpload-progressBar":"progressBar",".js-percentage":"progressText",".attachmentPlaceholder":"attachmentPlaceholder",".attachmentUpload":"attachmentUpload",".js-cancel":"cancelContainer",input:"input",".dropContainer":"dropContainer"},e.prototype.needsUpdate=function(){return this.render()},e.prototype.render=function(){return this.html(App.view("knowledge_base/sidebar/attachments")({attachments:this.object.attachments})),html5Upload.initialize({uploadUrl:this.object.generateURL("attachments"),dropContainer:this.el.get(0),cancelContainer:this.cancelContainer,inputField:this.input.get(0),maxSimultaneousUploads:1,key:"file",onFileAdded:this.onFileAdded})},e.prototype["delete"]=function(t){var e,n;return t.preventDefault(),n=parseInt($(t.currentTarget).attr("data-object-id")),e=this.object.attachments.filter(function(t){return t.id===n})[0],new i({container:this.container,answer:this.object,attachment:e,parentController:this})},e.prototype.fetch=function(){return this.ajax({id:"attachments_"+this.object.id+"_knowledge_base_answer",type:"GET",url:this.object.generateURL()+"?full=true",processData:!0,success:(e=this,
function(t){return App.Collection.loadAssets(t.assets),e.render()})});var e},e.prototype.onFileAdded=function(t){return t.on({onStart:this.onStart,onAborted:this.onAborted,onCompleted:this.onCompleted,onProgress:this.onProgress})},e.prototype.onStart=function(){return this.attachmentPlaceholder.addClass("hide"),this.attachmentUpload.removeClass("hide"),this.cancelContainer.removeClass("hide")},e.prototype.onAborted=function(){return this.attachmentPlaceholder.removeClass("hide"),this.attachmentUpload.addClass("hide"),this.input.val("")},e.prototype.onCompleted=function(t){var e;return this.attachmentPlaceholder.removeClass("hide"),this.attachmentUpload.addClass("hide"),this.progressBar.width(parseInt(0)+"%"),this.progressText.text(""),this.input.val(""),e=JSON.parse(t),App.Collection.loadAssets(e)},e.prototype.onProgress=function(t){if(this.progressBar.width(parseInt(t)+"%"),this.progressText.text(parseInt(t)),90<=parseInt(t))return this.cancelContainer.addClass("hide")},e.prototype.showDropZone=function(){if(!this.dropContainer.hasClass("is-dropTarget"))return this.dropContainer.addClass("is-dropTarget")},e.prototype.hideDropZone=function(){return this.dropContainer.removeClass("is-dropTarget")},e}(App.Controller),i=function(t){function e(){return this.error=n(this.error,this),this.success=n(this.success,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.content=function(){return App.i18n.translateContent("Are you sure to delete")+" "+this.attachment.filename+"?"},e.prototype.buttonSubmit="delete",e.prototype.onSubmit=function(){return this.formDisable(this.el),this.ajax({id:"attachment_delete",type:"DELETE",url:this.answer.generateURL("attachments/"+this.attachment.id),processData:!0,success:this.success,error:this.error})},e.prototype.success=function(t){return this.close(),App.Collection.loadAssets(t),this.parentController.render()},e.prototype.error=function(t){var e;return this.formEnable(this.el),this.showAlert((null!=(e=t.responseJSON)?e.error:void 0)||"Unable to save changes")},e}(App.ControllerConfirm)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseSidebarCategories=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.templateName="categories",e.prototype.title="Categories",e.prototype.emptyNote="No categories",e.prototype.templateOptions=function(){var t;return(t=e.__super__.templateOptions.apply(this,arguments)).isRoot=this.object instanceof App.KnowledgeBase,t},e.prototype.urlNew=function(){var t;return t="#knowledge_base/"+this.object.knowledge_base().id+"/category/",this.object instanceof App.KnowledgeBaseCategory?t+(this.object.id+"/new"):this.object instanceof App.KnowledgeBase?t+"category/new":void 0},e.prototype.categories=function(){return this.object instanceof App.KnowledgeBaseCategory?this.object.children():this.object instanceof App.KnowledgeBase?this.object.rootCategories():[]},e.prototype.items=function(){return this.categories().sort(function(t,e){return t.position-e.position}).map((e=this,function(t){return t.attributesForRendering(e.kb_locale,{action:"edit",isEditor:!0})}));var e},e.prototype.reorderSaveUrl=function(){return this.object instanceof App.KnowledgeBaseCategory?this.object.generateURL("reorder_categories"):this.object.url()+"/categories/reorder_root_categories"},e.prototype.newObject=function(){var t;return t=this.object instanceof App.KnowledgeBaseCategory?this.object:void 0,new App.KnowledgeBaseCategory({parent_id:null!=t?t.id:void 0,knowledge_base_id:this.object.knowledge_base().id})},e}(App.KnowledgeBaseSidebarGenericList)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseSidebarLinkedTickets=function(t){function e(){this["delete"]=n(this["delete"],this),this.clickedAdd=n(this.clickedAdd,this),this.fetch=n(this.fetch,this),this.needsUpdate=n(this.needsUpdate,this),e.__super__.constructor.apply(this,arguments),this.render(),this.listenTo(this.object,"refresh",this.needsUpdate)}return i(e,t),e.extend(App.PopoverProvidable),e.registerPopovers("Ticket"),e.prototype.className="sidebar-block",e.prototype.events={"click .js-add":"clickedAdd","click .js-delete":"delete"},e.prototype.needsUpdate=function(){return this.render()},e.prototype.render=function(){var t;return this.html(App.view("knowledge_base/sidebar/linked_tickets")({tickets:(null!=(t=this.object.translation(this.kb_locale.id))?t.linked_tickets():void 0)||[]})),this.renderPopovers()},e.prototype.fetch=function(){return this.ajax({id:"links_"+this.object.id+"_knowledge_base_answer",type:"GET",url:this.object.generateURL()+"?full=true",processData:!0,success:(e=this,function(t){return App.Collection.loadAssets(t.assets),e.render()})});var e},e.prototype.clickedAdd=function(t){var e;return t.preventDefault(),new App.TicketLinkAdd({link_object:"KnowledgeBase::Answer::Translation",link_object_id:null!=(e=this.object.translation(this.kb_locale.id))?e.id:void 0,link_types:[["normal","Normal"]],object:this.object.translation(this.kb_locale.id),parent:this,container:this.el.closest(".content")})},e.prototype["delete"]=function(t){var e,n;return t.preventDefault(),e={link_type:$(t.currentTarget).data("link-type"),link_object_source:$(t.currentTarget).data("object"),link_object_source_value:$(t.currentTarget).data("object-id"),link_object_target:"KnowledgeBase::Answer::Translation",link_object_target_value:null!=(n=this.object.translation(this.kb_locale.id))?n.id:void 0},this.ajax({id:"links_remove_"+this.object.id+"_"+this.object_type,type:"GET",url:this.apiPath+"/links/remove",data:e,processData:!0,success:this.fetch})},e}(App.Controller)}.call(this),function(){var t,i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function n(){var e,t;(this.error=i(this.error,this),this.success=i(this.success,this),n.__super__.constructor.apply(this,arguments),this.Config.get("system_init_done"))?this.Session.get()?this.navigate("#"):(this.navHide(),this.title("Sign in"),this.render(),this.navupdate("#login"),this.bind("config_update_local",(e=this,function(t){if(t.name.match(/^maintenance/)||t.name.match(/^auth/)||"user_lost_password"===t.name||"user_create_account"===t.name||"product_name"===t.name||"product_logo"===t.name||"fqdn"===t.name)return e.render(),"rerender"})),this.bind("ui:rerender",(t=this,function(){return t.render()}))):this.navigate("#getting_started")}return e(n,t),n.prototype.events={"submit #login":"login"},n.prototype.render=function(t){var e,n,i,s;for(i in null==t&&(t={}),n=[],e=App.Config.get("auth_provider_all"))s=e[i],!0!==this.Config.get(s.config)&&"true"!==this.Config.get(s.config)||(console.log(i),n.push(s));return this.html(App.view("login")({item:t,logoUrl:this.logoUrl(),auth_providers:n})),this.$('[name="username"]').val()?this.$('[name="password"]').focus():this.$('[name="username"]').focus(),this.scrollTo()},n.prototype.login=function(t){var e;return t.preventDefault(),t.stopPropagation(),this.formDisable(t),e=this.formParam(t.target),this.username=e.username,App.Auth.login({data:e,success:this.success,error:this.error})},n.prototype.success=function(){var t;return(t=this.Config.get("requested_url"))&&"#login"!==t&&"#logout"!==t?(this.log("notice","REDIRECT to '"+t+"'"),this.navigate(t),this.Config.set("requested_url","")):(this.log("notice","REDIRECT to -#/-"),this.navigate("#/"))},n.prototype.error=function(t){var e,n,i;return n=t.responseText,e={},_.isEmpty(n)||(e=JSON.parse(n)),this.notify({type:"error",msg:App.i18n.translateContent(e.error||"Wrong Username or Password combination."),removeAll:!0}),this.render({username:this.username}),this.delay((i=this,function(){return i.shake(i.$(".hero-unit"))}),600)},n}(App.ControllerContent),App.Config.set("login",t,"Routes")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),App.Auth.logout()}return n(e,t),e}(App.ControllerContent),App.Config.set("logout",t,"Routes"),App.Config.set("Logout",{prio:1800,parent:"#current_user",name:"Sign out",translate:!0,target:"#logout",divider:!0,iconClass:"signout"},"NavBarRight")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.genericController=new App.ControllerGenericIndex({el:this.el,id:this.id,genericObject:"Macro",pageData:{home:"macros",object:"Macro",objects:"Macros",navupdate:"#macros",notes:["Text modules are ..."],buttons:[{name:"New Macro","data-type":"new","class":"btn--success"}]},container:this.el.closest(".content")})}return n(e,t),e.prototype.requiredPermission="admin.macro",e.prototype.header="Macros",e}(App.ControllerSubContent),App.Config.set("Macros",{prio:2310,name:"Macros",parent:"#manage",target:"#manage/macros",controller:t,permission:["admin.macro"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.updateMessage=n(this.updateMessage,this),this.setLogin=n(this.setLogin,this),this.setMode=n(this.setMode,this),this.render=n(this.render,this),this.release=n(this.release,this),e.__super__.constructor.apply(this,arguments),this.subscribeId=App.Setting.subscribe(this.render,{initFetch:!0,clear:!1})}return i(e,t),e.prototype.requiredPermission="admin.maintenance",e.prototype.header="Maintenance",e.prototype.events={"change .js-modeSetting input":"setMode","change .js-loginSetting input":"setLogin","blur .js-Login":"updateMessage","submit .js-Message":"sendMessage"},e.prototype.elements={".js-modeSetting input":"modeSetting",".js-loginSetting input":"loginSetting"},e.prototype.release=function(){return App.Setting.unsubscribe(this.subscribeId)},e.prototype.render=function(){var t;return(t=$(App.view("maintenance")())).find(".js-loginPreview").html(App.view("generic/login_preview")({logoUrl:this.logoUrl(),logoChange:!1,maintananceChange:!0})),t.find(".js-textarea").ce({mode:"richtext",multiline:!0,maxlength:2e4}),this.html(t)},e.prototype.setMode=function(){var t,e,n;return t=function(){return App.Setting.set("maintenance_mode",e,{done:function(){return App.WebSocket.send({event:"maintenance",data:{type:"mode",on:e}})}})},(e=this.modeSetting.prop("checked"))?(new App.ControllerConfirm({message:"Sure?",callback:t,onCancel:(n=this,function(){return n.modeSetting.prop("checked",!1)}),container:this.el.closest(".content")}),e):t()},e.prototype.setLogin=function(){var t;return t=this.loginSetting.prop("checked"),App.Setting.set("maintenance_login",t)},e.prototype.updateMessage=function(t){var e;return t.preventDefault(),e=this.formParam(t.target),App.Setting.set("maintenance_login_message",e.message),this.notify({type:"success",msg:App.i18n.translateContent("Update successful!"),removeAll:!0})},e.prototype.sendMessage=function(t){var e;return t.preventDefault(),(e=this.formParam(t.target)).type="message",App.WebSocket.send({event:"maintenance",data:e}),this.notify({type:"success",msg:App.i18n.translateContent("Sent successfully!"),removeAll:!0}),this.render()},e}(App.ControllerSubContent),App.Config.set("Maintenance",{prio:3600,name:"Maintenance",parent:"#system",target:"#system/maintenance",controller:t,permission:["admin.maintenance"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Manage=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.authenticateRequired=!0,e.prototype.configKey="NavBarAdmin",e}(App.ControllerNavSidbar),t=function(t){function e(t){e.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),App.TaskManager.execute({key:"Manage",controller:"Manage",params:t,show:!0,persistent:!0})}return n(e,t),e.prototype.requiredPermission=["admin.*"],e}(App.ControllerPermanent),App.Config.set("manage",t,"Routes"),App.Config.set("manage/:target",t,"Routes"),App.Config.set("settings/:target",t,"Routes"),App.Config.set("channels/:target",t,"Routes"),App.Config.set("channels/:target/:channel_id",t,"Routes"),App.Config.set("system/:target",t,"Routes"),App.Config.set("system/:target/:integration",t,"Routes"),App.Config.set("Manage",{prio:1e3,name:"Manage",target:"#manage",permission:["admin.*"]},"NavBarAdmin"),App.Config.set("Channels",{prio:2500,name:"Channels",target:"#channels",permission:["admin.*"]},"NavBarAdmin"),App.Config.set("Settings",{prio:7e3,name:"Settings",target:"#settings",permission:["admin.*"]},"NavBarAdmin"),App.Config.set("System",{prio:8e3,name:"System",target:"#system",permission:["admin.*"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){var t;this.restartFailedJobs=n(this.restartFailedJobs,this),this.resetToken=n(this.resetToken,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.load(),this.interval((t=this,function(){return t.load()}),35e3)}return i(e,t),e.prototype.requiredPermission="admin.monitoring",e.prototype.header="Monitoring",e.prototype.events={"click .js-resetToken":"resetToken","click .js-select":"selectAll","click .js-restartFailedJobs":"restartFailedJobs"},e.prototype.load=function(){return this.startLoading(),this.ajax({id:"health_check",type:"GET",url:this.apiPath+"/monitoring/health_check",success:(e=this,function(t){if(e.stopLoading(),!e.data||t.token!==e.data.token||t.healthy!==e.data.healthy||t.message!==e.data.message)return e.data=t,e.render()})});var e},e.prototype.render=function(){return this.html(App.view("monitoring")({data:this.data}))},e.prototype.resetToken=function(t){return t.preventDefault(),this.formDisable(t),this.ajax({id:"health_check_token",type:"POST",url:this.apiPath+"/monitoring/token",success:(e=this,function(){return e.load()})});var e},e.prototype.restartFailedJobs=function(t){return t.preventDefault(),this.ajax({id:"restart_failed_jobs_request",type:"POST",url:this.apiPath+"/monitoring/restart_failed_jobs",success:(e=this,function(){return e.load()})});var e},e}(App.ControllerSubContent),App.Config.set("Monitoring",{prio:3600,name:"Monitoring",parent:"#system",target:"#system/monitoring",controller:t,permission:["admin.monitoring"]},"NavBarAdmin")}.call(this),function(){var l=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Navigation=function(t){function a(){var t,e,n,i,s,r,o;this.fetchRecentView=l(this.fetchRecentView,this),this.recentViewNavbarItemsRebuild=l(this.recentViewNavbarItemsRebuild,this),this.update=l(this.update,this),this.search=l(this.search,this),this.andClose=l(this.andClose,this),this.andEmpty=l(this.andEmpty,this),this.emptyAndCloseDelayed=l(this.emptyAndCloseDelayed,this),this.emptyAndClose=l(this.emptyAndClose,this),this.nudge=l(this.nudge,this),this.listNavigate=l(this.listNavigate,this),this.searchBlur=l(this.searchBlur,this),this.searchPaste=l(this.searchPaste,this),this.searchFocus=l(this.searchFocus,this),this.renderResult=l(this.renderResult,this),this.renderPersonal=l(this.renderPersonal,this),this.renderMenu=l(this.renderMenu,this),this.release=l(this.release,this),a.__super__.constructor.apply(this,arguments),this.render(),this.globalSearch=new App.GlobalSearch({render:this.renderResult}),this.bind("ui:rerender",(t=this,function(){return t.renderMenu(),t.renderPersonal()})),this.bind("menu:render",(e=this,function(){return e.renderMenu()})),this.bind("personal:render",(n=this,function(){return n.renderPersonal()})),this.bind("navupdate",(i=this,function(t){return i.update(t)})),this.bind("auth",(s=this,function(){return s.render()})),this.bind("RecentView::changed",(r=this,function(){return r.delay(function(){return r.fetchRecentView()},1e3,"recent-view-changed")})),this.bind("bell",(o=this,function(t){return"on"===t?(o.$(".bell").addClass("show"),App.Audio.play("https://www.sounddogs.com/previews/2193/mp3/219024_SOUNDDOGS__be.mp3"),o.delay(function(){return App.Event.trigger("bell","off")},3e3)):o.$(".bell").removeClass("show")}))}return e(a,t),a.extend(App.PopoverProvidable),a.registerAllPopovers(),a.prototype.className="navigation vertical",a.prototype.elements={"#global-search":"searchInput",".search":"searchContainer",".js-global-search-result":"searchResult",".js-details-link":"searchDetails"},a.prototype.events={"click .js-toggleNotifications":"toggleNotifications","click .js-emptySearch":"emptyAndClose","submit form.search-holder":"preventDefault","dblclick form.search-holder .icon-magnifier":"openExtendedSearch","focus #global-search":"searchFocus","blur #global-search":"searchBlur","paste #global-search":"searchPaste","keyup #global-search":"listNavigate","click .js-global-search-result":"emptyAndCloseDelayed","click .js-details-link":"openExtendedSearch","change .js-menu .js-switch input":"switch","click .js-onclick":"click"},a.prototype.release=function(){if(this.notificationWidget)return this.notificationWidget.remove(),this.notificationWidget=void 0},a.prototype.renderMenu=function(){var t,e,n,i,s,r,o,a,l;for(t={},i=[],s=0,r=(n=this.getItems({navbar:this.Config.get("NavBar")})).length;s<r;s++)a=!0,void 0!==(e=n[s]).shown&&(a=e.shown),e.key&&(l=App.TaskManager.worker(e.key))&&(l.counter&&(e.counter=l.counter()),l["switch"]&&(e["switch"]=l["switch"]()),l.active&&l.active()&&(t[e.target]=!0),l.onclick&&(e.onclick=l.onclick()),l.accessoryIcon&&(e.accessoryIcon=l.accessoryIcon()),l.featureActive&&(a=!!l.featureActive())),a&&i.push(e);return n=i,o={},this.$(".open").children("a").each(function(t,e){var n;return n=$(e).attr("href"),o[n]=!0}),this.$(".js-menu").html(App.view("navigation/menu")({items:n,openTab:o,activeTab:t}))},a.prototype.click=function(t){var e;return this.preventDefaultAndStopPropagation(t),e=$(t.currentTarget).data("key"),App.TaskManager.worker(e).clicked(t)},a.prototype["switch"]=function(t){var e,n,i;if(n=$(t.target).prop("checked"),(e=$(t.target).closest(".menu-item").data("key"))&&(i=App.TaskManager.worker(e)))return i["switch"](n)},a.prototype.renderPersonal=function(){var t,e,n,i,s;for(this.recentViewNavbarItemsRebuild(),n=0,i=(e=clone(this.getItems({navbar:this.Config.get("NavBarRight")}),!0)).length;n<i;n++)(t=e[n])&&t.child&&1===t.child.length&&(t.target=t.child[0].target,delete t.child);if(s={},this.$(".open").children("a").each(function(t,e){var n;return n=$(e).attr("href"),s[n]=!0}),this.$(".navbar-items-personal").html(App.view("navigation/personal")({items:e,openTab:s})),App.Session.get("id"))return new App.WidgetAvatar({el:this.$(".js-avatar"),object_id:App.Session.get("id"),type:"personal"})},a.prototype.renderResult=function(t){var e;if(null==t&&(t=[]),this.removePopovers(),!_.isEmpty(t))return e=App.view("navigation/result")({result:t}),this.searchResult.html(e),this.renderPopovers();this.searchResult.html(App.view("navigation/no_result")())},a.prototype.render=function(){var t;return t=App.Session.get(),this.html(App.view("navigation")({user:t})),this.taskbar=new App.TaskbarWidget({el:this.$(".tasks")}),this.renderMenu(),this.renderPersonal(),this.notificationWidget&&this.notificationWidget.remove(),this.notificationWidget=new App.OnlineNotificationWidget,$("#app").append(this.notificationWidget.el)},a.prototype.searchFocus=function(t){return this.clearDelay("emptyAndCloseDelayed"),this.query=void 0,this.search(10),App.PopoverProvidable.anyPopoversDestroy(),this.searchContainer.addClass("focused"),this.selectAll(t)},a.prototype.searchPaste=function(){var t,e;return t=function(){return e.clearDelay("emptyAndCloseDelayed"),e.query=void 0,e.search(10),App.PopoverProvidable.anyPopoversDestroy(),e.searchContainer.addClass("focused")},(e=this).delay(t,10,"searchFocus")},a.prototype.searchBlur=function(){var t,e;return t=function(){if(""===e.searchInput.val().trim())return e.emptyAndClose()},(e=this).delay(t,100,"removeFocused")},a.prototype.listNavigate=function(t){var e;if(27!==t.keyCode)if(38!==t.keyCode){if(40!==t.keyCode)return 13===t.keyCode?(this.searchInput.blur(),void((e=this.$(".global-search-result .nav-tab.is-hover").attr("href"))?(this.navigate(e),this.emptyAndCloseDelayed()):this.openExtendedSearch())):this.search(0);this.nudge(t,1)}else this.nudge(t,-1);else this.emptyAndClose()},a.prototype.nudge=function(t,e){var n,i,s;if(this.searchContainer.hasClass("open"))return(n=this.searchResult.find(".nav-tab.is-hover")).get(0)||1!==e?(1===e?(i=n.closest("li").nextAll("li").not(".divider").first().find(".nav-tab")).get(0)&&(n.removeClass("is-hover").popover("hide"),i.addClass("is-hover").popover("show")):(s=n.closest("li").prevAll("li").not(".divider").first().find(".nav-tab")).get(0)?(n.removeClass("is-hover").popover("hide"),s.addClass("is-hover").popover("show")):(n.removeClass("is-hover").popover("hide"),this.searchDetails.addClass("is-hover")),i&&this.scrollToIfNeeded(i,!0),s?this.scrollToIfNeeded(s,!1):void 0):this.searchDetails.hasClass("is-hover")?(this.searchDetails.removeClass("is-hover"),void this.searchResult.find(".nav-tab").first().addClass("is-hover").popover("show")):void this.searchDetails.addClass("is-hover")},a.prototype.emptyAndClose=function(){return this.andClose(),this.andEmpty()},a.prototype.emptyAndCloseDelayed=function(){var t,e;return this.andClose(),t=function(){return e.andEmpty()},(e=this).delay(t,6e4,"emptyAndCloseDelayed")},a.prototype.andEmpty=function(){return this.query="",this.searchInput.val("")},a.prototype.andClose=function(){return this.searchContainer.removeClass("focused filled open no-match loading"),this.globalSearch.close(),this.delayedRemoveAnyPopover()},a.prototype.search=function(t){var e,n,i,s,r,o;if(e=this.searchInput.val().trim(),this.searchContainer.toggleClass("filled",!!e),this.query!==e){if(this.query=e,0===t&&(t=500,2<e.length?t=350:4<e.length&&(t=200)),""!==e)return this.globalSearch.search({delay:t,query:this.query,callbackLongerAsExpected:(o=this,function(){return o.searchContainer.removeClass("open")}),callbackNoMatch:(r=this,function(){return r.searchContainer.addClass("no-match"),r.searchContainer.addClass("open")}),callbackMatch:(s=this,function(){return s.searchContainer.removeClass("no-match"),s.searchContainer.addClass("open")}),callbackStop:(i=this,function(){return i.searchContainer.removeClass("loading")}),callbackStart:(n=this,function(){return n.searchContainer.addClass("loading")})});this.searchContainer.removeClass("open")}},a.prototype.filterNavbar=function(t,s){return null==s&&(s=null),_.filter(t,(r=this,function(t){var e,n,i;if("function"==typeof t.callback)for(n in e=t.callback()||{})i=e[n],t[n]=i;return(null==s&&!t.parent||t.parent===s)&&r.filterNavbarPermissionOk(t)&&r.filterNavbarSettingOk(t)}));var r},a.prototype.filterNavbarPermissionOk=function(t){return!t.permission||_.any(t.permission,(e=this,function(t){return e.permissionCheck(t)}));var e},a.prototype.filterNavbarSettingOk=function(t){return!t.setting||_.any(t.setting,(e=this,function(t){return e.Config.get(t)}));var e},a.prototype.getItems=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d;for(h=_.values(t.navbar),u=[],n={},u=this.filterNavbar(h),r=0,l=h.length;r<l;r++)if((i=h[r]).parent&&!n[i.parent])for(n[i.parent]=this.filterNavbar(h,i.parent),o=0,c=u.length;o<c;o++)(s=u[o]).target===i.parent&&(d=this.getOrder(n[i.parent]),s.child=d);for(e=[],a=0,p=u.length;a<p;a++)(!(i=u[a]).child||i.child&&!_.isEmpty(i.child))&&e.push(i);return this.getOrder(e)},a.prototype.getOrder=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d;for(u={},r=0,l=t.length;r<l;r++)s=t[r],this.addPrioCount(u,s),u[s.prio]=s;for(i=[],o=0,c=(n=_.keys(u).sort(this.sortit)).length;o<c;o++)h=n[o],i.push(u[h]);for(e=!1,a=0,p=i.length;a<p;a++)"recentViewed"===(d=i[a]).type&&(e=!0),e&&"recentViewed"!==d.type&&(e=!(d.divider=!0));return i},a.prototype.sortit=function(t,e){return t-e},a.prototype.addPrioCount=function(t,e){if(t[e.prio]&&(e.prio++,t[e.prio]))return this.addPrioCount(t,e)},a.prototype.update=function(t){var e,n;if(n=t,_.isObject(t)&&(n=t.url,e=t.type),"menu"===e?this.$(".js-menu .is-active").removeClass("is-active"):this.$(".is-active").removeClass("is-active"),n&&"#"!==n)return this.$('.js-menu [href="'+n+'"], .tasks [href="'+n+'"]').addClass("is-active")},a.prototype.recentViewNavbarItemsRebuild=function(){var t,e,n,i,s,r,o,a,l;for(r in t=this.Config.get("NavBarRight")||{})"#current_user"===t[r].parent&&"RecendViewed"===r.split("::")[0]&&delete t[r];if(this.Session.get()){for(i=App.RecentView.search({sortBy:"created_at",order:"DESC"}),l=80,s=0,o=(i=this.prepareForObjectList(i)).length;s<o;s++)a=e=!1,80===l&&(e=!0,a="Recently viewed"),l++,t["RecendViewed::"+(n=i[s]).o_id+n.object+"-"+l]={prio:l,parent:"#current_user",name:App.i18n.translateInline(n.object)+" ("+n.title+")",target:n.link,divider:e,navheader:a,type:"recentViewed"};return this.Config.set("NavBarRight",t)}this.Config.set("NavBarRight",t)},a.prototype.fetchRecentView=function(){var t,e;return e=this,t=function(){return e.renderPersonal()},App.RecentView.fetchFull(t,{clear:!0})},a.prototype.toggleNotifications=function(t){return t.stopPropagation(),this.notificationWidget.toggle()},a.prototype.openExtendedSearch=function(t){var e;if(t&&t.preventDefault(),e=this.searchInput.val(),this.emptyAndClose(),!e)return this.navigate("#search");this.navigate("#search/"+encodeURIComponent(e))},a}(App.ControllerWidgetPermanent),App.Config.set("navigation",App.Navigation,"Navigations")}.call(this),function(){var n,t,r,i,a,s=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function n(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=function(t,e){var c,p,u;return u=[],c=[],p=[],$(t.target).closest(".modal").find(".js-treeTable .js-key").each(function(){var t,e,n,i,s,r,o,a,l;if(t=$(this),s=parseInt(t.attr("level")),i={name:r=t.val().trim()},0===s?u.push(i):c[s-1]?((e=c[s-1]).children||(e.children=[]),c[s-1].children.push(i)):console.log("ERROR",i),l=[],0<s)for(o=n=0,a=s-1;0<=a?n<=a:a<=n;o=0<=a?++n:--n)l.push(p[o]);return l.push(r),i.value=l.join("::"),c[s]=i,p=l}),u[0]&&(e.data_option||(e.data_option={}),e.data_option.options=u),e},t=function(t){function n(){var e;this.build=s(this.build,this),n.__super__.constructor.apply(this,arguments),this.startLoading(),this.ajax({id:"object_manager_attributes_list",type:"GET",url:this.apiPath+"/object_manager_attributes_list",processData:!0,success:(e=this,function(t){return e.stopLoading(),e.build(t.objects)})})}return o(n,t),n.prototype.requiredPermission="admin.object",n.prototype.build=function(t){var e,n,i,s;for(this.tabs=[],e=0,i=t.length;e<i;e++)n={name:s=t[e],target:"c-"+s,controller:r,params:{object:s}},this.tabs.push(n);return this.render()},n}(App.ControllerTabs),r=function(t){function e(){this.edit=s(this.edit,this),this["new"]=s(this["new"],this),this.render=s(this.render,this),this.release=s(this.release,this),e.__super__.constructor.apply(this,arguments),this.subscribeId=App.ObjectManagerAttribute.subscribe(this.render),App.ObjectManagerAttribute.fetch()}return o(e,t),e.prototype.header="Object Manager",e.prototype.events={"click .js-delete":"destroy","click .js-new":"new","click .js-edit":"edit","click .js-discard":"discard","click .js-execute":"execute"},e.prototype.release=function(){if(this.subscribeId)return App.ObjectManagerAttribute.unsubscribe(this.subscribeId)},e.prototype.render=function(){var t,e,n,i,s,r;for(n=App.ObjectManagerAttribute.search({filter:{object:this.object},sortBy:"position"}),i=[],t=0,s=(r=App.ObjectManagerAttribute.search({sortBy:"object"})).length;t<s;t++)!0!==(e=r[t]).to_create&&!0!==e.to_delete&&!0!==e.to_migrate&&!0!==e.to_config||i.push(e);return this.html(App.view("object_manager/index")({head:this.object,items:n,itemsToChange:i}))},e.prototype["new"]=function(t){return t.preventDefault(),new i({pageData:{head:this.object,title:"Attribute",home:"object_manager",object:"ObjectManagerAttribute",objects:"ObjectManagerAttributes",navupdate:"#object_manager"},genericObject:"ObjectManagerAttribute",container:this.el.closest(".content"),item:{object:this.object}})},e.prototype.edit=function(t){var e;return t.preventDefault(),e=$(t.target).closest("tr").data("id"),new n({pageData:{head:this.object,title:"Attribute",home:"object_manager",object:"ObjectManagerAttribute",objects:"ObjectManagerAttributes",navupdate:"#object_manager"},genericObject:"ObjectManagerAttribute",container:this.el.closest(".content"),callback:this.render,id:e})},e.prototype.destroy=function(t){var e,n,i;return t.stopPropagation(),t.preventDefault(),e=$(t.target).closest("tr").data("id"),App.ObjectManagerAttribute.find(e),(n=this).ajax({id:"object_manager_attributes/"+e,type:"DELETE",url:this.apiPath+"/object_manager_attributes/"+e,success:(i=this,function(){return i.render()}),error:function(t){return n.log("errors"),alert(t.responseJSON.error)}})},e.prototype.discard=function(t){return t.preventDefault(),this.ajax({id:"object_manager_attributes_discard_changes",type:"POST",url:this.apiPath+"/object_manager_attributes_discard_changes",success:(e=this,function(){return e.render()})});var e},e.prototype.execute=function(t){return t.preventDefault(),this.ajax({id:"object_manager_attributes_execute_migrations",type:"POST",url:this.apiPath+"/object_manager_attributes_execute_migrations",success:(e=this,function(){return e.render()})});var e},e}(App.ControllerSubContent),i=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.onSubmit=function(n){var t,e,i,s,r,o;if(i=this.formParam(n.target),(i=a(n,i)).screens&&i.screens.create_middle)for(r in s=i.screens.create_middle)s[r].item_class="column";return i.object=this.pageData.head,(e=new App[this.genericObject]).load(i),(t=e.validate())?(this.log("error",t),this.formValidate({form:n.target,errors:t}),!1):(this.formDisable(n),o=this,e.save({done:function(){var t;return o.callback&&(t=App[o.genericObject].fullLocal(this.id),o.callback(t)),o.close()},fail:function(t,e){return o.log("errors",e),o.formEnable(n),o.controller.showAlert(e.error_human||e.error||"Unable to create object!")}}))},e}(App.ControllerGenericNew),n=function(t){function e(){return this.onSubmit=s(this.onSubmit,this),this.content=s(this.content,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.content=function(){var t,e,n,i;for(this.item=App[this.genericObject].find(this.id),this.head=this.pageData.head||this.pageData.object,n=0,i=(e=clone(App[this.genericObject].configure_attributes)).length;n<i;n++)"name"===(t=e[n]).name&&(t.disabled=!0);return console.log("configure_attributes",e),this.controller=new App.ControllerForm({model:{configure_attributes:e},params:this.item,screen:this.screen||"edit",autofocus:!0}),this.controller.form},e.prototype.onSubmit=function(n){var t,e,i,s,r;if(e=this.formParam(n.target),(e=a(n,e)).screens&&e.screens.create_middle)for(s in i=e.screens.create_middle)i[s].item_class="column";return e.object=this.pageData.head,this.item.load(e),(t=this.item.validate())?(this.log("error",t),this.formValidate({form:n.target,errors:t}),!1):(this.formDisable(n),(r=this).item.save({done:function(){var t;return r.callback&&(
t=App[r.genericObject].fullLocal(this.id),r.callback(t)),r.close()},fail:function(t,e){return r.log("errors"),r.formEnable(n),r.controller.showAlert(e.error_human||e.error||"Unable to update object!")}}))},e}(App.ControllerGenericEdit),App.Config.set("SystemObject",{prio:1700,parent:"#system",name:"Objects",target:"#system/object_manager",controller:t,permission:["admin.object"]},"NavBarAdmin")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.OrganizationHistory=function(t){function e(){return this.fetch=n(this.fetch,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.fetch=function(){return this.ajax({id:"organization_history",type:"GET",url:this.apiPath+"/organizations/history/"+this.organization_id,success:(e=this,function(t){return App.Collection.loadAssets(t.assets),e.items=t.history,e.render()})});var e},e}(App.GenericHistory)}.call(this),function(){var n,d,i,s,t,r=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function n(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;App.OrganizationProfile=function(t){function e(t){this.currentPosition=r(this.currentPosition,this),this.setPosition=r(this.setPosition,this),this.render=r(this.render,this),this.show=r(this.show,this),this.url=r(this.url,this),this.meta=r(this.meta,this),e.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),App.Organization.full(this.organization_id,this.render)}return o(e,t),e.prototype.meta=function(){var t,e;return t={url:this.url(),id:this.organization_id},App.Organization.exists(this.organization_id)&&(e=App.Organization.find(this.organization_id),t.head=e.displayName(),t.title=e.displayName(),t.iconClass=e.icon()),t},e.prototype.url=function(){return"#organization/profile/"+this.organization_id},e.prototype.show=function(){return App.OnlineNotification.seen("Organization",this.organization_id),this.navupdate({url:"#",type:"menu"})},e.prototype.changed=function(){return!1},e.prototype.render=function(t){var e;return this.doNotLog||(this.doNotLog=1,this.recentView("Organization",this.organization_id)),e=$(App.view("organization_profile/index")({organization:t})),new s({object_id:t.id,el:e.find(".js-name")}),new i({el:e.find(".js-object-container"),object_id:t.id,taskKey:this.taskKey}),new n({el:e.find(".js-action"),object_id:t.id}),new App.TicketStats({el:e.find(".js-ticket-stats"),organization:t}),this.html(e),new App.UpdateTastbar({genericObject:t})},e.prototype.setPosition=function(t){return this.$(".profile").scrollTop(t)},e.prototype.currentPosition=function(){return this.$(".profile").scrollTop()},e}(App.Controller),n=function(t){function e(){return this.actions=r(this.actions,this),this.editOrganization=r(this.editOrganization,this),this.showHistory=r(this.showHistory,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.model="Organization",e.prototype.observe={member_ids:!0},e.prototype.showHistory=function(t){return new App.OrganizationHistory({organization_id:t.id,container:this.el.closest(".content")})},e.prototype.editOrganization=function(t){return new App.ControllerGenericEdit({id:t.id,genericObject:"Organization",screen:"edit",pageData:{title:"Organizations",object:"Organization",objects:"Organizations"},container:this.el.closest(".content")})},e.prototype.actions=function(){return[{name:"edit",title:"Edit",callback:this.editOrganization},{name:"history",title:"History",callback:this.showHistory}]},e}(App.ObserverActionRow),i=function(t){function e(){return this.update=r(this.update,this),this.render=r(this.render,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.model="Organization",e.prototype.observe={member_ids:!0},e.prototype.observeNot={cid:!0,created_at:!0,created_by_id:!0,updated_at:!0,updated_by_id:!0,preferences:!0,source:!0,image_source:!0},e.prototype.events={"focusout [contenteditable]":"update"},e.prototype.render=function(t){var e,n,i,s,r,o,a,l,c,p,u,h;for(n in App.TaskManager.touch(this.taskKey),c=[],p=App.Organization.attributesGet("view"))e=p[n],(l=(a=n).substr(0,a.length-3))in t&&(a=l),(t[a]||"richtext"===e.tag)&&e.shown&&"name"!==a&&c.push(e);for(this.html(App.view("organization_profile/object")({organization:t,organizationData:c})),this.$("[contenteditable]").ce({mode:"textonly",multiline:!0,maxlength:250}),o=[],s=0,r=(u=t.member_ids).length;s<r;s++)h=u[s],i=$("<div></div>"),new d({object_id:h,el:i}),o.push(i);return this.$(".js-userList").html(o)},e.prototype.update=function(t){var e,n,i,s;if(n=$(t.target).attr("data-name"),s=$(t.target).html(),(i=App.Organization.find(this.object_id))[n]!==s)return this.lastAttributres[n]=s,(e={})[n]=s,i.updateAttributes(e),this.log("debug","update",n,s,i)},e}(App.ObserverController),s=function(t){function e(){return this.render=r(this.render,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.model="Organization",e.prototype.observe={name:!0},e.prototype.render=function(t){return this.html(App.Utils.htmlEscape(t.displayName()))},e}(App.ObserverController),d=function(t){function e(){return this.render=r(this.render,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.model="User",e.prototype.observe={firstname:!0,lastname:!0,login:!0,email:!0,active:!0,image:!0},e.prototype.globalRerender=!1,e.prototype.render=function(t){return this.html(App.view("organization_profile/member")({user:t}))},e}(App.ObserverController),t=function(t){function n(t){var e;n.__super__.constructor.apply(this,arguments),e={organization_id:t.organization_id},App.TaskManager.execute({key:"Organization-"+this.organization_id,controller:"OrganizationProfile",params:e,show:!0})}return o(n,t),n.prototype.requiredPermission="ticket.agent",n}(App.ControllerPermanent),App.Config.set("organization/profile/:organization_id",t,"Routes")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.genericController=new App.ControllerGenericIndex({el:this.el,id:this.id,genericObject:"Organization",importCallback:function(){return new App.Import({baseUrl:"/api/v1/organizations",container:this.el.closest(".content")})},pageData:{home:"organizations",object:"Organization",objects:"Organizations",navupdate:"#organizations",notes:["Organizations are for any person in the system. Agents (Owners, Resposbiles, ...) and Customers."],buttons:[{name:"Import","data-type":"import","class":"btn"},{name:"New Organization","data-type":"new","class":"btn--success"}]},container:this.el.closest(".content")})}return n(e,t),e.prototype.requiredPermission="admin.organization",e.prototype.header="Organizations",e}(App.ControllerSubContent),App.Config.set("Organization",{prio:2e3,name:"Organizations",parent:"#manage",target:"#manage/organizations",controller:t,permission:["admin.organization"]},"NavBarAdmin")}.call(this),function(){var t,e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function s(){var t,e,n,i,l;for(s.__super__.constructor.apply(this,arguments),e=0,n=(i=App.Overview.configure_attributes).length;e<n;e++)"group_by"===(t=i[e]).name&&(t.options=App.Overview.groupByAttributes());this.genericController=new App.ControllerGenericIndex({el:this.el,id:this.id,genericObject:"Overview",defaultSortBy:"prio",pageData:{home:"overviews",object:"Overview",objects:"Overviews",navupdate:"#overviews",notes:["Overview are ..."],buttons:[{name:"New Overview","data-type":"new","class":"btn--success"}]},container:this.el.closest(".content"),large:!0,dndCallback:(l=this,function(t,e){var n,i,s,r,o,a;for(a=[],s=o=0,r=(i=l.el.find("table > tbody > tr")).length;s<r;s++)e=i[s],o+=1,n=$(e).data("id"),a.push([n,o]);return l.ajax({id:"overview_prio",type:"POST",url:l.apiPath+"/overviews_prio",processData:!0,data:JSON.stringify({prios:a})})})})}return e(s,t),s.prototype.requiredPermission="admin.overview",s.prototype.header="Overviews",s}(App.ControllerSubContent),App.Config.set("Overview",{prio:2300,name:"Overviews",parent:"#manage",target:"#manage/overviews",controller:t,permission:["admin.overview"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.load()}return n(e,t),e.prototype.requiredPermission="admin.package",e.prototype.header="Packages",e.prototype.events={"click .action":"action"},e.prototype.load=function(){return this.ajax({id:"packages",type:"GET",url:this.apiPath+"/packages",processData:!0,success:(e=this,function(t){return e.packages=t.packages,e.render()})});var e},e.prototype.render=function(){var t,e,n,i;for(t=0,n=(i=this.packages).length;t<n;t++)(e=i[t]).action=[],"installed"===e.state?e.action=["uninstall"]:"uninstalled"===e.state?e.action=["install"]:"deactivate"===e.state&&(e.action=["uninstall","activate"]);return this.html(App.view("package")({head:"Dashboard",packages:this.packages}))},e.prototype.action=function(t){var e,n,i;if(t.preventDefault(),n=$(t.target).parents("[data-id]").data("id"),"uninstall"===$(t.target).data("type")&&(e="DELETE"),e)return this.ajax({id:"packages",type:e,url:this.apiPath+"/packages",data:JSON.stringify({id:n}),processData:!1,success:(i=this,function(){return i.load()})})},e}(App.ControllerSubContent),App.Config.set("Packages",{prio:3700,name:"Packages",parent:"#system",target:"#system/package",controller:t,permission:["admin.package"]},"NavBarAdmin")}.call(this),function(){var t,e,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.success=n(this.success,this),e.__super__.constructor.apply(this,arguments),this.Config.get("user_lost_password")?this.authenticateCheck()?this.navigate("#"):(this.navHide(),this.title("Reset Password"),this.navupdate("#password_reset"),this.render()):this.navigate("#")}return i(e,t),e.prototype.events={"submit form":"submit","click .submit":"submit","click .retry":"retry"},e.prototype.render=function(t){var e;return e=[{name:"username",display:"Enter your username or email address",tag:"input",type:"text",limit:100,"null":!1,"class":"input span4"}],this.html(App.view("password/reset")(t)),this.form=new App.ControllerForm({el:this.el.find(".form-password-item"),model:{configure_attributes:e},autofocus:!0})},e.prototype.retry=function(t){return t.preventDefault(),this.render()},e.prototype.submit=function(t){var e;return t.preventDefault(),e=this.formParam(t.target),this.formDisable(t),this.ajax({id:"password_reset",type:"POST",url:this.apiPath+"/users/password_reset",data:JSON.stringify(e),processData:!0,success:this.success})},e.prototype.success=function(t){var e,n;return t.token&&!0===this.Config.get("developer_mode")&&(e=function(){return n.navigate("#password_reset_verify/"+t.token)},(n=this).delay(e,2e3)),this.render({sent:!0})},e}(App.ControllerContent),App.Config.set("password_reset",t,"Routes"),e=function(t){function e(){var t;this.renderChanged=n(this.renderChanged,this),this.renderChange=n(this.renderChange,this),e.__super__.constructor.apply(this,arguments),this.Config.get("user_lost_password")?this.authenticateCheck()?this.navigate("#"):(this.navHide(),this.title("Reset Password"),this.navupdate("#password_reset_verify"),t={token:this.token},this.ajax({id:"password_reset_verify",type:"POST",url:this.apiPath+"/users/password_reset_verify",data:JSON.stringify(t),processData:!0,success:this.renderChange})):this.navigate("#")}return i(e,t),e.prototype.events={"submit form":"submit","click .submit":"submit"},e.prototype.renderChange=function(t){var e;return"ok"===t.message?(e=[{name:"password",display:"Password",tag:"input",type:"password",limit:100,"null":!1,"class":"input"}],this.html(App.view("password/reset_change")()),new App.ControllerForm({el:this.el.find(".form-password-change"),model:{configure_attributes:e},autofocus:!0})):this.html(App.view("password/reset_failed")({head:"Reset Password failed!",message:"Token is invalid!"}))},e.prototype.submit=function(t){var e;return t.preventDefault(),(e=this.formParam(t.target)).token=this.token,this.password=e.password,this.formDisable(t),e.password_confirm!==e.password?(this.formEnable(t),this.$("[name=password]").val(""),this.$("[name=password_confirm]").val(""),void this.notify({type:"error",msg:"Can't update password, your new passwords do not match. Please try again!",removeAll:!0})):e.password?this.ajax({id:"password_reset_verify",type:"POST",url:this.apiPath+"/users/password_reset_verify",data:JSON.stringify(e),processData:!0,success:this.renderChanged}):(this.formEnable(t),void this.notify({type:"error",msg:"Please supply your new password!",removeAll:!0}))},e.prototype.renderChanged=function(t){return"ok"===t.message?App.Auth.login({data:{username:t.user_login,password:this.password},success:(n=this,function(){return App.Auth.loginCheck(),n.notify({type:"success",msg:"Woo hoo! Your password has been changed!",removeAll:!0}),n.navigate("#")}),error:(e=this,function(){return e.formEnable(e.$("form")),e.notify({type:"error",msg:"Something went wrong. Please contact your administrator.",removeAll:!0})})}):(t.notice?this.notify({type:"error",msg:App.i18n.translateContent(t.notice[0],t.notice[1]),removeAll:!0}):this.notify({type:"error",msg:"Unable to set password. Please contact your administrator.",removeAll:!0}),this.formEnable(this.$("form")));var e,n},e}(App.ControllerContent),App.Config.set("password_reset_verify/:token",e,"Routes")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Profile=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.authenticateRequired=!0,e.prototype.configKey="NavBarProfile",e}(App.ControllerNavSidbar),t=function(t){function e(t){e.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),App.TaskManager.execute({key:"Profile",controller:"Profile",params:t,show:!0,persistent:!0})}return n(e,t),e.prototype.requiredPermission=["user_preferences.*"],e}(App.ControllerPermanent),App.Config.set("profile",t,"Routes"),App.Config.set("profile/:target",t,"Routes"),App.Config.set("Profile",{prio:1e3,name:"Profile",target:"#profile"},"NavBarProfile"),App.Config.set("Profile",{prio:1700,parent:"#current_user",name:"Profile",target:"#profile",translate:!0},"NavBarRight")}.call(this),function(){var o,e,t,i,s,r,a=function(t,e){return function(){return t.apply(e,arguments)}},l=function(t,e){function n(){this.constructor=t}for(var i in e)c.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;t=function(t){function n(){var e;this.render=a(this.render,this),this.storeParams=a(this.storeParams,this),this.getParams=a(this.getParams,this),n.__super__.constructor.apply(this,arguments),this.title("Reporting"),this.navupdate("#report"),this.startLoading(),this.ajax({type:"GET",url:this.apiPath+"/reports/config",processData:!0,success:(e=this,function(t){if(e.stopLoading(),!t.error)return e.config=t.config,App.Collection.load({type:"ReportProfile",data:t.profiles}),e.render();e.renderScreenError({detail:t.error,objectName:"Report"})})})}return l(n,t),n.prototype.requiredPermission="report",n.prototype.getParams=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v;if(this.params)return this.params;if(this.params={},h=App.SessionStorage.get("report::params"))return this.params=h,this.params;if(this.params.timeRange="year",i=(n=new Date).getDate(),s=n.getMonth()+1,o=n.getFullYear(),r=n.getWeek(),this.params.day=i,this.params.month=s,this.params.week=r,this.params.year=o,!this.params.metric)for(c in f=this.config.metric)(e=f[c])["default"]&&(this.params.metric=e.name);if(!this.params.backendSelected)for(c in this.params.backendSelected={},m=this.config.metric)for(a=0,p=(g=(e=m[c]).backend).length;a<p;a++)(t=g[a]).selected&&(this.params.backendSelected[t.name]=!0);if(!this.params.profileSelected)for(this.params.profileSelected={},l=0,u=(v=App.ReportProfile.all()).length;l<u;l++)d=v[l],_.isEmpty(this.params.profileSelected)&&(this.params.profileSelected[d.id]=!0);return this.params},n.prototype.storeParams=function(){return App.SessionStorage.set("report::params",this.params)},n.prototype.render=function(t){return null==t&&(t={}),this.params=this.getParams(),this.html(App.view("report/main")({params:this.params})),new r({el:this.el.find(".js-timeRangePicker"),params:this.params,ui:this}),new s({el:this.el.find(".js-timePicker"),params:this.params,ui:this}),new i({el:this.el.find(".js-aside"),config:this.config,params:this.params,ui:this}),new e({el:this.el,config:this.config,params:this.params,ui:this})},n}(App.ControllerContent),e=function(t){function e(){var t;this.draw=a(this.draw,this),this.render=a(this.render,this),this.update=a(this.update,this),e.__super__.constructor.apply(this,arguments),this.bind("ui:report:rerender",(t=this,function(){return t.render()})),this.render()}return l(e,t),e.prototype.update=function(t){var e,n,i,s,r;for(n in e={},i=t.data)r=i[n],!0===this.params.backendSelected[n]&&(e[n]=r),this.ui.storeParams();if(this.lastNewData||(this.lastNewData={}),!this.lastNewData||JSON.stringify(e)!==JSON.stringify(this.lastNewData))return this.lastNewData=e,this.draw(e),s=new Date,this.el.find("#download-chart").html(s.toString()),this.downloadWidget?this.downloadWidget.update({config:this.config,params:this.params,ui:this.ui}):this.downloadWidget=new o({el:this.el.find(".js-dataDownload"),config:this.config,params:this.params,ui:this.ui})},e.prototype.render=function(){var e,t,n;return t=this.apiPath+"/reports/generate",e=3e5,"year"===this.params.timeRange&&(e=3e5),"month"===this.params.timeRange&&(e=6e4),"week"===this.params.timeRange&&(e=5e4),"day"===this.params.timeRange&&(e=3e4),"realtime"===this.params.timeRange&&(e=1e4),this.ajax({id:"report_graph",type:"POST",url:t,data:JSON.stringify({metric:this.params.metric,year:this.params.year,month:this.params.month,week:this.params.week,day:this.params.day,timeRange:this.params.timeRange,profiles:this.params.profileSelected,backends:this.params.backendSelected}),processData:!0,success:(n=this,function(t){return n.update(t),n.delay(n.render,e,"report-update","page")})})},e.prototype.draw=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b;if(this.log("draw",t),$("#placeholder").empty(),b=[],"realtime"===this.params.timeRange)for(f=a=0;a<=59;f=++a)b.push([f,""]);else if("day"===this.params.timeRange)for(o=l=0;l<=23;o=++l)b.push([o,o]);else if("month"===this.params.timeRange)for(r=p=0;p<=30;r=++p)b.push([r,r+1]);else b="week"===this.params.timeRange?[[0,"Mon"],[1,"Tue"],[2,"Wed"],[3,"Thr"],[4,"Fri"],[5,"Sat"],[6,"Sun"]]:[[0,"Jan"],[1,"Feb"],[2,"Mar"],[3,"Apr"],[4,"May"],[5,"Jun"],[6,"Jul"],[7,"Aug"],[8,"Sep"],[9,"Oct"],[10,"Nov"],[11,"Dec"]];for(c in s=[],t){if(y=t[c],g=c,this.config.metric[this.params.metric])for(d=0,u=(v=this.config.metric[this.params.metric].backend).length;d<u;d++)(e=v[d]).name===c&&(g=e.display);for(n=[],m=i=0,h=b.length;m<h;m++)b[m],n.push([i,y[i]]),i+=1;s.push({data:n,label:App.i18n.translateInline(g)})}return $.plot($("#placeholder"),s,{yaxis:{min:0},xaxis:{ticks:b}})},e}(App.ControllerContent),o=function(t){function e(t){this.tableUpdate=a(this.tableUpdate,this),this.tableRender=a(this.tableRender,this),this.render=a(this.render,this),this.update=a(this.update,this),this.selectBackend=a(this.selectBackend,this),t.el.unbind("click .js-dataDownloadBackendSelector"),e.__super__.constructor.apply(this,arguments),this.render()}return l(e,t),e.prototype.events={"click .js-dataDownloadBackendSelector":"selectBackend"},e.prototype.selectBackend=function(t){return t.preventDefault(),this.el.find(".js-dataDownloadBackendSelector").parent().removeClass("active"),$(t.target).parent().addClass("active"),this.profileSelectedId=$(t.target).data("profile-id"),this.params.downloadBackendSelected=$(t.target).data("backend"),this.ui.storeParams(),this.table=!1,this.render()},e.prototype.update=function(){return this.render()},e.prototype.render=function(){var t,e,n,i,s,r,o,a,l;if(this.contentRendered||(this.contentRendered=!0,this.html(App.view("report/download_content")())),l=[],this.config.metric[this.params.metric]){for(n=0,s=(o=this.config.metric[this.params.metric].backend).length;n<s;n++)(t=o[n]).dataDownload&&!this.params.downloadBackendSelected&&(this.params.downloadBackendSelected=t.name);this.ui.storeParams()}for(i in r=[],a=this.params.profileSelected)a[i]&&(this.profileSelectedId||(this.profileSelectedId=i),r.push(App.ReportProfile.find(i)));return(e=App.view("report/download_header")({reports:l,profiles:r,downloadBackendSelected:this.params.downloadBackendSelected,metric:this.config.metric[this.params.metric]}))!==this.downloadHeaderHtml&&(this.el.find(".js-dataDownloadHeader").html(e),this.downloadHeaderHtml=e),this.tableUpdate()},e.prototype.tableRender=function(t,e){var n,i,s,r,o,a,l,c,p,u,h;if(_.isEmpty(t))return this.$(".js-dataDownloadButton").html(""),void this.$(".js-dataDownloadTable").html("");for(a in p=0,u=this.params.profileSelected)u[a]&&(p=a);return o=this.apiPath+"/reports/sets?sheet=true;metric="+this.params.metric+";year="+this.params.year+";month="+this.params.month+";week="+this.params.week+";day="+this.params.day+";timeRange="+this.params.timeRange+";profile_id="+p+";downloadBackendSelected="+this.params.downloadBackendSelected,this.$(".js-dataDownloadButton").html(App.view("report/download_button")({count:e,downloadUrl:o})),l=function(t){var e;return e=App.Ticket.findNative(t),h.navigate(e.uiUrl())},r=function(t,e,n){return n.title=e.title,t},s=function(t,e,n){return n.link=e.uiUrl(),t},i=function(t){var e;return e={name:"icon",display:"",translation:!1,width:"28px",displayWidth:28,unresizable:!0},t.unshift(0),t[0]=e,t},n=function(t,e,n){return t=" ",n["class"]=e.iconClass(),n.link="",n.title=e.iconTitle(),t},c={el:(h=this).el.find(".js-dataDownloadTable"),model:App.Ticket,objects:t,overviewAttributes:["number","title","state","group","created_at"],bindRow:{events:{click:l}},callbackHeader:[i],callbackAttributes:{icon:[n],title:[s,r],number:[s,r]}},this.table?this.table.update({objects:t}):this.table=new App.ControllerTable(c)},e.prototype.tableUpdate=function(){return this.ajax({id:"report_download",type:"POST",url:this.apiPath+"/reports/sets",data:JSON.stringify({metric:this.params.metric,year:this.params.year,month:this.params.month,week:this.params.week,day:this.params.day,timeRange:this.params.timeRange,profiles:this.params.profileSelected,backends:this.params.backendSelected,downloadBackendSelected:this.params.downloadBackendSelected}),processData:!0,success:(a=this,function(t){var e,n,i,s,r,o;if(App.Collection.loadAssets(t.assets),o=[],t.ticket_ids)for(e=0,n=(s=t.ticket_ids).length;e<n;e++)i=s[e],r=App.Ticket.fullLocal(i),o.push(r);return a.tableRender(o,t.count)})});var a},e}(App.Controller),r=function(t){function e(){var t;this.select=a(this.select,this),this.render=a(this.render,this),e.__super__.constructor.apply(this,arguments),this.bind("ui:report:rerender",(t=this,function(){return t.render()})),this.render()}return l(e,t),e.prototype.events={"click .js-timeRange":"select"},e.prototype.render=function(){return this.html(App.view("report/time_range_picker")()),this.el.find(".js-timeRange").removeClass("active"),this.el.find('.js-timeRange[data-type="'+this.ui.params.timeRange+'"]').addClass("active")},e.prototype.select=function(t){return t.preventDefault(),this.ui.params.timeRange=$(t.target).data("type"),App.Event.trigger("ui:report:rerender")},e}(App.Controller),s=function(t){function e(){var t;this.selectTimeYear=a(this.selectTimeYear,this),this.selectTimeWeek=a(this.selectTimeWeek,this),this.selectTimeMonth=a(this.selectTimeMonth,this),this.selectTimeDay=a(this.selectTimeDay,this),this.render=a(this.render,this),e.__super__.constructor.apply(this,arguments),this._timeSlotPicker(),this.bind("ui:report:rerender",(t=this,function(){return t.render()})),this.render()}return l(e,t),e.prototype.events={"click .js-timePickerDay":"selectTimeDay","click .js-timePickerYear":"selectTimeYear","click .js-timePickerMonth":"selectTimeMonth","click .js-timePickerWeek":"selectTimeWeek"},e.prototype.render=function(){return this.html(App.view("report/time_picker")({params:this.ui.params,timeRangeDay:this.timeRangeDay,timeRangeMonth:this.timeRangeMonth,timeRangeWeek:this.timeRangeWeek,timeRangeYear:this.timeRangeYear})),this.el.find(".time-slot").removeClass("active"),this.el.find('.time-slot[data-type="'+this.ui.params.timeRange+'"]').addClass("active")},e.prototype.selectTimeDay=function(t){return t.preventDefault(),this.ui.params.day=$(t.target).data("type"),$(t.target).parent().parent().find("li").removeClass("active"),$(t.target).parent().addClass("active"),App.Event.trigger("ui:report:rerender"),this.ui.storeParams()},e.prototype.selectTimeMonth=function(t){return t.preventDefault(),this.ui.params.month=$(t.target).data("type"),$(t.target).parent().parent().find("li").removeClass("active"),$(t.target).parent().addClass("active"),App.Event.trigger("ui:report:rerender"),this.ui.storeParams()},e.prototype.selectTimeWeek=function(t){return t.preventDefault(),this.ui.params.week=$(t.target).data("type"),$(t.target).parent().parent().find("li").removeClass("active"),$(t.target).parent().addClass("active"),App.Event.trigger("ui:report:rerender"),this.ui.storeParams()},e.prototype.selectTimeYear=function(t){return t.preventDefault(),this.ui.params.year=$(t.target).data("type"),$(t.target).parent().parent().find("li").removeClass("active"),$(t.target).parent().addClass("active"),App.Event.trigger("ui:report:rerender"),this.ui.storeParams()},e.prototype._timeSlotPicker=function(){var t,e,n,i,s,r,o,a,l;for(this.timeRangeYear=[],t=e=r=(l=(new Date).getFullYear())-2,o=l;r<=o?e<=o:o<=e;t=r<=o?++e:--e)s={display:t,value:t},this.timeRangeYear.push(s);for(this.timeRangeMonth=[{display:"Jan",value:1},{display:"Feb",value:2},{display:"Mar",value:3},{display:"Apr",value:4},{display:"May",value:5},{display:"Jun",value:6},{display:"Jul",value:7},{display:"Aug",value:8},{display:"Sep",value:9},{display:"Oct",value:10},{display:"Nov",value:11},{display:"Dec",value:12}],this.timeRangeWeek=[],t=n=1;n<=52;t=++n)s={display:t,value:t},this.timeRangeWeek.push(s);for(this.timeRangeDay=[],a=[],t=i=1;i<=31;t=++i)s={display:t,value:t},a.push(this.timeRangeDay.push(s));return a},e}(App.Controller),i=function(t){function e(){this.selectBackend=a(this.selectBackend,this),this.selectProfile=a(this.selectProfile,this),this.selectMetric=a(this.selectMetric,this),this.render=a(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return l(e,t),e.prototype.events={"click .js-profileSelector":"selectProfile","click .js-backendSelector":"selectBackend","click .panel-heading":"selectMetric"},e.prototype.render=function(){var t,e;return t=this.config.metric,e=App.ReportProfile.search({filter:{active:!0}}),this.html(App.view("report/sidebar")({metrics:t,params:this.params,profiles:e}))},e.prototype.selectMetric=function(t){var e;if(!$(t.target).closest(".panel").find(".collapse.in").get(0)&&(e=$(t.target).closest(".panel").data("metric"),this.params.metric!==e))return this.params.metric=e,App.Event.trigger("ui:report:rerender"),this.ui.storeParams()},e.prototype.selectProfile=function(t){var e,n,i;for(e in n=$(t.target).val(),i=this.params.profileSelected)i[e],delete this.params.profileSelected[e];return this.params.profileSelected[n]=!0,App.Event.trigger("ui:report:rerender"),this.ui.storeParams()},e.prototype.selectBackend=function(t){var e;return e=$(t.target).val(),$(t.target).prop("checked")?this.params.backendSelected[e]=!0:delete this.params.backendSelected[e],App.Event.trigger("ui:report:rerender"),this.ui.storeParams()},e}(App.Controller),App.Config.set("report",t,"Routes"),App.Config.set("Reporting",{prio:8e3,parent:"",name:"Reporting",translate:!0,target:"#report",icon:"report",permission:["report"]},"NavBarRight")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.genericController=new App.ControllerGenericIndex({el:this.el,id:this.id,genericObject:"ReportProfile",pageData:{home:"report_profiles",object:"Report Profile",objects:"Report Profiles",navupdate:"#report_profiles",notes:[],buttons:[{name:"New Profile","data-type":"new","class":"primary"}]},container:this.el.closest(".content")})}return n(e,t),e.prototype.requiredPermission="admin.report_profile",e.prototype.header="Report Profile",e}(App.ControllerSubContent),App.Config.set("ReportProfile",{prio:8e3,name:"Report Profiles",parent:"#manage",target:"#manage/report_profiles",controller:t,permission:["admin.report_profile"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.genericController=new App.ControllerGenericIndex({el:this.el,id:this.id,genericObject:"Role",pageData:{home:"roles",object:"Role",objects:"Roles",navupdate:"#roles",notes:["Roles are ..."],buttons:[{name:"New Role","data-type":"new","class":"btn--success"}]},container:this.el.closest(".content")})}return n(e,t),e.prototype.requiredPermission="admin.role",e.prototype.header="Roles",e}(App.ControllerSubContent),App.Config.set("Role",{prio:1600,name:"Roles",parent:"#manage",target:"#manage/roles",controller:t,permission:["admin.role"]},"NavBarAdmin")}.call(this),function(){var t,i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Search=function(t){function n(){var t,e;this.updateTask=i(this.updateTask,this),this.renderTab=i(this.renderTab,this),this.showTab=i(this.showTab,this),this.renderResult=i(this.renderResult,this),this.search=i(this.search,this),this.empty=i(this.empty,this),this.listNavigate=i(this.listNavigate,this),this.show=i(this.show,this),this.meta=i(this.meta,this),n.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),(t=App.TaskManager.get(this.taskKey).state)&&t.query&&(this.query=t.query),App.TaskManager.touch(this.taskKey),this.globalSearch=new App.GlobalSearch({render:this.renderResult,limit:50}),this.render(),this.bind("ui:rerender",(e=this,function(){return e.render()}))}return e(n,t),n.extend(App.PopoverProvidable),n.prototype.elements={".js-search":"searchInput"},n.prototype.events={"click .js-emptySearch":"empty","submit form.search-holder":"preventDefault","keyup .js-search":"listNavigate","click .js-tab":"showTab","input .js-search":"updateFilledClass"},n.prototype.meta=function(){var t;return t=this.query?App.Utils.htmlEscape(this.query):App.i18n.translateInline("Extended Search"),{url:this.url(),id:"",head:t,title:t,iconClass:"searchdetail"}},n.prototype.url=function(){return"#search"},n.prototype.show=function(t){if(this.table&&this.table.show(),this.navupdate({url:"#search",type:"menu"}),!_.isEmpty(t.query)&&(this.$(".js-search").val(t.query).trigger("change"),!this.shown))return this.search(1e3,!0)},n.prototype.hide=function(){if(this.shown=!1,this.table)return this.table.hide()},n.prototype.changed=function(){},n.prototype.render=function(){var t,e,n,i,s,r,o;for(t=App.TaskManager.get(this.taskKey
).state,this.query||t&&t.query&&(this.query=t.query),this.model||(t&&t.model?this.model=t.model:this.model="Ticket"),this.tabs=[],e=0,n=(s=App.Config.get("models_searchable")).length;e<n;e++)i=(i=s[e]).replace(/::/g,""),o={name:(null!=(r=App[i])?r.display_name:void 0)||i,model:i,count:0,active:!1},this.model===i&&(o.active=!0),this.tabs.push(o);if(this.html(App.view("search/index")({query:this.query,tabs:this.tabs})),this.query)return this.search(500,!0)},n.prototype.listNavigate=function(t){if(27!==t.keyCode)return this.search(0);this.empty()},n.prototype.empty=function(){return this.searchInput.val(""),this.query="",this.updateFilledClass(),this.updateTask(),this.delayedRemoveAnyPopover()},n.prototype.search=function(t,e){var n;if(null==e&&(e=!1),n=this.searchInput.val().trim(),!e){if(!n)return;if(n===this.query)return}return this.query=n,this.updateTask(),0===t&&(t=500,2<n.length?t=350:4<n.length&&(t=200)),this.globalSearch.search({delay:t,query:this.query})},n.prototype.renderResult=function(t){var e,n,i,s,r,o;for(null==t&&(t=[]),this.result=t,r=[],n=0,i=(s=this.tabs).length;n<i;n++)e=0,t[(o=s[n]).model]&&(e=t[o.model].length),this.model===o.model&&this.renderTab(o.model,t[o.model]||[]),r.push(this.$(".js-tab"+o.model+" .js-counter").text(e));return r},n.prototype.showTab=function(t){var e,n;return n=$(t.currentTarget).closest(".tabs"),e=$(t.currentTarget).data("tab-content"),n.find(".js-tab").removeClass("active"),$(t.currentTarget).addClass("active"),this.renderTab(e,this.result[e]||[])},n.prototype.renderTab=function(t,e){var n,i,s,r,o,a,l,c,p,u;for(this.model!==t&&(this.model=t,this.updateTask()),a=[],n=0,r=e.length;n<r;n++)i=e[n],l=App[t].fullLocal(i.id),a.push(l);if("Ticket"!==t)return c=function(t){return l=App[u.model].fullLocal(t),u.navigate(l.uiUrl())},(u=this).table=new App.ControllerTable({tableId:"find_"+t,el:this.$(".js-content"),model:App[t],objects:a,bindRow:{events:{click:c}}});for(p=[],s=0,o=e.length;s<o;s++)i=e[s],p.push(i.id);return this.table=new App.TicketList({tableId:"find_"+t,el:this.$(".js-content"),columns:["number","title","customer","group","owner","created_at"],ticket_ids:p,radio:!1})},n.prototype.updateTask=function(){var t;if(t=App.TaskManager.get(this.taskKey).state)return t.query=this.query,t.model=this.model,App.TaskManager.update(this.taskKey,{state:t}),App.TaskManager.touch(this.taskKey)},n.prototype.updateFilledClass=function(){return this.searchInput.toggleClass("is-empty",!this.searchInput.val())},n}(App.Controller),t=function(t){function i(t){var e,n;i.__super__.constructor.apply(this,arguments),n=void 0,_.isEmpty(t.query)||(n=decodeURIComponent(t.query)),e={query:n},App.TaskManager.execute({key:"Search",controller:"Search",params:e,show:!0})}return e(i,t),i}(App.ControllerPermanent),App.Config.set("search",t,"Routes"),App.Config.set("search/:query",t,"Routes")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){var t;e.__super__.constructor.apply(this,arguments),this.load(),this.interval((t=this,function(){return t.load()}),45e3)}return n(e,t),e.prototype.requiredPermission="admin.session",e.prototype.header="Sessions",e.prototype.events={"click .js-delete":"destroy"},e.prototype.load=function(){return this.startLoading(),this.ajax({id:"sessions",type:"GET",url:this.apiPath+"/sessions",success:(e=this,function(t){return e.stopLoading(),App.Collection.loadAssets(t.assets),e.sessions=t.sessions,e.render()})});var e},e.prototype.render=function(){var t,e,n,i;for(t=0,e=(n=this.sessions).length;t<e;t++)(i=n[t]).data&&i.data.user_id&&(i.data.user=App.User.find(i.data.user_id));return this.html(App.view("session")({sessions:this.sessions}))},e.prototype.destroy=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest("a").data("session-id"),this.ajax({id:"sessions/"+e,type:"DELETE",url:this.apiPath+"/sessions/"+e,success:(n=this,function(){return n.load()})})},e}(App.ControllerSubContent),App.Config.set("Session",{prio:3800,name:"Sessions",parent:"#system",target:"#system/sessions",controller:t,permission:["admin.session"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.error=n(this.error,this),this.resend=n(this.resend,this),this.submit=n(this.submit,this),e.__super__.constructor.apply(this,arguments),this.Config.get("user_create_account")?(this.navHide(),this.title("Sign up"),this.navupdate("#signup"),this.render()):this.navigate("#")}return i(e,t),e.prototype.events={"submit form":"submit","click .submit":"submit","click .js-submitResend":"resend","click .cancel":"cancel"},e.prototype.render=function(){return this.html(App.view("signup")()),this.form=new App.ControllerForm({el:this.el.find("form"),model:App.User,screen:"signup",autofocus:!0})},e.prototype.cancel=function(){return this.navigate("#login")},e.prototype.submit=function(n){var t,e,i,s;return n.preventDefault(),this.formDisable(n),this.params=this.formParam(n.target),!this.params.login&&this.params.email&&(this.params.login=this.params.email),this.params.signup=!0,this.params.role_ids=[],this.log("notice","updateAttributes",this.params),(e=new App.User).load(this.params),(t=e.validate({screen:"signup"}))?(this.log("error new",t),this.formValidate({form:n.target,errors:t}),this.formEnable(n),!1):e.save({done:(s=this,function(){return s.html(App.view("signup/verify")({email:s.params.email}))}),fail:(i=this,function(t,e){return i.formEnable(n),_.isArray(e.error)?i.form.showAlert(App.i18n.translateInline(e.error[0],e.error[1])):i.form.showAlert(e.error_human||e.error||"Unable to update object!")})})},e.prototype.resend=function(e){return e.preventDefault(),this.formDisable(e),this.resendParams=this.formParam(e.target),this.ajax({id:"email_verify_send",type:"POST",url:this.apiPath+"/users/email_verify_send",data:JSON.stringify({email:this.resendParams.email}),processData:!0,success:(n=this,function(t){if(n.formEnable(e),n.notify({type:"success",msg:App.i18n.translateContent('Email sent to "%s". Please verify your email address.',n.params.email),removeAll:!0}),t.token&&!0===n.Config.get("developer_mode"))return n.navigate("#email_verify/"+t.token)}),error:this.error});var n},e.prototype.error=function(t){var e,n;return n=t.responseText,e={},_.isEmpty(n)||(e=JSON.parse(n)),this.notify({type:"error",msg:App.i18n.translateContent(e.error||"Wrong Username or Password combination."),removeAll:!0})},e}(App.ControllerContent),App.Config.set("signup",t,"Routes")}.call(this),function(){var t,i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function n(){var t,e;this.description=i(this.description,this),this["delete"]=i(this["delete"],this),this.release=i(this.release,this),this.render=i(this.render,this),n.__super__.constructor.apply(this,arguments),this.subscribeCalendarId=App.Calendar.subscribe(this.render),this.subscribeSlaId=App.Sla.subscribe(this.render),t=function(){return e.stopLoading(),e.render()},(e=this).startLoading(),App.Sla.fetchFull(t,{clear:!0})}return e(n,t),n.prototype.requiredPermission="admin.sla",n.prototype.header="SLAs",n.prototype.events={"click .js-new":"new","click .js-edit":"edit","click .js-delete":"delete","click .js-description":"description"},n.prototype.render=function(){var t,e,n,i,s,r;for(e=0,n=(r=App.Sla.search({sortBy:"name"})).length;e<n;e++)(s=r[e]).first_response_time&&(s.first_response_time_in_text=this.toText(s.first_response_time)),s.update_time&&(s.update_time_in_text=this.toText(s.update_time)),s.solution_time&&(s.solution_time_in_text=this.toText(s.solution_time)),s.rules=App.UiElement.ticket_selector.humanText(s.condition),s.calendar=App.Calendar.find(s.calendar_id);return i=!1,App.Sla.description&&(_.isEmpty(r)?t=marked(App.Sla.description):i=!0),this.html(App.view("sla/index")({slas:r,showDescription:i,description:t}))},n.prototype.release=function(){if(this.subscribeCalendarId&&App.Calendar.unsubscribe(this.subscribeCalendarId),this.subscribeSlaId)return App.Sla.unsubscribe(this.subscribeSlaId)},n.prototype["new"]=function(t){return t.preventDefault(),new App.ControllerGenericNew({pageData:{title:"SLAs",object:"SLA",objects:"SLAs"},genericObject:"Sla",container:this.el.closest(".content"),callback:this.load,large:!0})},n.prototype.edit=function(t){var e;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),new App.ControllerGenericEdit({id:e,pageData:{title:"SLAs",object:"Sla",objects:"SLAs"},genericObject:"Sla",callback:this.load,container:this.el.closest(".content"),large:!0})},n.prototype["delete"]=function(t){var e,n;return t.preventDefault(),e=$(t.target).closest(".action").data("id"),n=App.Sla.find(e),new App.ControllerGenericDestroyConfirm({item:n,container:this.el.closest(".content"),callback:this.load})},n.prototype.description=function(){return new App.ControllerGenericDescription({description:App.Calendar.description,container:this.el.closest(".content")})},n.prototype.toText=function(t){var e,n;if(t=parseInt(t))return(n=t%60)<10&&(n="0"+n),(e=Math.floor(t/60))<10&&(e="0"+e),e+":"+n},n}(App.ControllerSubContent),App.Config.set("Sla",{prio:2900,name:"SLAs",parent:"#manage",target:"#manage/slas",controller:t,permission:["admin.sla"]},"NavBarAdmin")}.call(this),function(){var i,s,t,r,n=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function n(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;t=function(t){function e(){this.create=n(this.create,this),this.setTagNew=n(this.setTagNew,this),this.render=n(this.render,this),this.release=n(this.release,this),e.__super__.constructor.apply(this,arguments),this.subscribeId=App.Setting.subscribe(this.render,{initFetch:!0,clear:!1})}return o(e,t),e.prototype.requiredPermission="admin.tag",e.prototype.header="Tags",e.prototype.events={"change .js-newTagSetting input":"setTagNew","submit .js-create":"create"},e.prototype.elements={".js-newTagSetting input":"tagNewSetting"},e.prototype.release=function(){return App.Setting.unsubscribe(this.subscribeId)},e.prototype.render=function(){var t;if((t=this.Config.get("tag_new")||!0)!==this.lastNewTagSetting)return this.lastNewTagSetting=t,this.html(App.view("tag/index")()),new r({el:this.$(".js-Table")})},e.prototype.setTagNew=function(){var t;return t=this.tagNewSetting.prop("checked"),App.Setting.set("tag_new",t)},e.prototype.create=function(t){var e,n,i;if(t.preventDefault(),n=(e=$(t.currentTarget).find("input[name]")).val().trim())return this.ajax({type:"POST",url:this.apiPath+"/tag_list",data:JSON.stringify({name:n}),success:(i=this,function(){return e.val(""),new r({el:i.$(".js-Table")})})})},e}(App.ControllerSubContent),r=function(t){function e(){this.edit=n(this.edit,this),this.render=n(this.render,this),this.load=n(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return o(e,t),e.prototype.events={"click .js-delete":"destroy","click .js-edit":"edit","click .js-search":"search"},e.prototype.load=function(){return this.ajax({id:"tag_admin_list",type:"GET",url:this.apiPath+"/tag_list",processData:!0,success:(e=this,function(t){return e.render(t)})});var e},e.prototype.render=function(t){return this.html(App.view("tag/table")({list:t}))},e.prototype.edit=function(t){var e,n,i;return t.preventDefault(),n=(i=$(t.currentTarget).closest("tr")).find(".js-name").text(),e=i.data("id"),new s({id:e,name:n,callback:this.load})},e.prototype.destroy=function(t){var e,n;return t.preventDefault(),t.stopPropagation(),e=(n=$(t.currentTarget).closest("tr")).data("id"),new i({id:e,row:n})},e.prototype.search=function(t){var e;return t.preventDefault(),t.stopPropagation(),e=$(t.target).closest("tr").find(".js-name").text(),App.GlobalSearchWidget.search(e,"tags")},e}(App.Controller),s=function(t){function e(){return this.onSubmit=n(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="Submit",e.prototype.head="Edit",e.prototype.small=!0,e.prototype.content=function(){return App.view("tag/edit")({id:this.id,name:this.name})},e.prototype.onSubmit=function(t){var e,n;return t.preventDefault(),e=this.formParam(t.target),this.ajax({id:"tag_admin_list",type:"PUT",url:this.apiPath+"/tag_list/"+this.id,data:JSON.stringify({id:this.id,name:e.name}),success:(n=this,function(){return n.callback(),n.close()})})},e}(App.ControllerModal),i=function(t){function e(){return this.onSubmit=n(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="yes",e.prototype.buttonClass="btn--danger",e.prototype.head="Confirm",e.prototype.small=!0,e.prototype.content=function(){return App.i18n.translateContent("Sure to delete this object?")},e.prototype.onSubmit=function(){return this.ajax({id:"tag_admin_list",type:"DELETE",url:this.apiPath+"/tag_list/"+this.id,processData:!0,success:(t=this,function(){return t.row.remove(),t.close()})});var t},e}(App.ControllerModal),App.Config.set("Tags",{prio:2320,name:"Tags",parent:"#manage",target:"#manage/tags",controller:t,permission:["admin.tag"]},"NavBarAdmin")}.call(this),function(){var u,a=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TaskbarWidget=function(t){function r(){var t,o,e,n,i,s;this.remove=a(this.remove,this),this.location=a(this.location,this),r.__super__.constructor.apply(this,arguments),t={tolerance:"pointer",distance:15,opacity:.6,forcePlaceholderSize:!0,items:"> a",update:(o=this,function(){var t,e,n,i,s,r;for(r=[],t=0,s=(n=o.el.find("> a")).length;t<s;t++){if(e=n[t],!(i=$(e).data("key")))throw"No such key attributes found for task item";r.push(i)}return App.TaskManager.reorder(r)})},this.el.sortable(t),this.bind("taskInit",(e=this,function(){return e.queue.push(["renderAll"]),e.uIRunner()})),this.bind("taskUpdate",(n=this,function(t){return n.queue.push(["change",t]),n.uIRunner()})),this.bind("taskRemove",(i=this,function(t){return i.queue.push(["destroy",t]),i.uIRunner()})),this.bind("taskCollectionOrderSet",(s=this,function(t){return s.collectionOrderSet(t)}))}return n(r,t),r.prototype.events={"click .js-close":"remove","click .js-locationVerify":"location"},r.prototype.model=!1,r.prototype.template="widget/task_item",r.prototype.uniqKey="key",r.prototype.observe={meta:!0,active:!0,notify:!0},r.prototype.itemGet=function(t){return App.TaskManager.get(t)},r.prototype.itemDestroy=function(t){return App.TaskManager.remove(t)},r.prototype.itemsAll=function(){return App.TaskManager.allWithMeta()},r.prototype.location=function(t){if($(t.currentTarget).hasClass("is-modified"))return this.locationVerify(t)},r.prototype.remove=function(t,e,n){var i,s,r,o,a,l,c,p;if(null==e&&(e=!1),null==n&&(n=!1),t.preventDefault(),t.stopPropagation(),e||(e=$(t.target).parents("a").data("key")),!e)throw"No such key attributes found for task item";if(p=App.TaskManager.worker(e),!n&&p&&p.changed&&p.changed())new u({key:e,ui:this,event:t});else{for(s=App.TaskManager.get(e),i=!1,r=0,o=(c=App.TaskManager.all()).length;r<o;r++)l=c[r],s.active&&l.key===e&&(i=!0);if(App.TaskManager.remove(e),i){if(!(a=App.TaskManager.nextTaskUrl()))return this.navigate("#");this.navigate(a)}}},r}(App.CollectionController),u=function(t){function e(){return this.onSubmit=a(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit="Discard Changes",e.prototype.buttonClass="btn--danger",e.prototype.head="Confirm",e.prototype.content=function(){return App.i18n.translateContent("Tab has changed, do you really want to close it?")},e.prototype.onSubmit=function(){return this.close(),this.ui.remove(this.event,this.key,!0)},e}(App.ControllerModal)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TestController1=function(t){function e(){this.changed=n(this.changed,this),this.active=n(this.active,this),this.hide=n(this.hide,this),this.show=n(this.show,this),e.__super__.constructor.apply(this,arguments),this.showState=!1,this.hideState=!1,this.activeState=!1,this.changedState||(this.changedState=!1),this.render()}return i(e,t),e.prototype.meta=function(){return{}},e.prototype.show=function(){return this.showState=!0,this.render()},e.prototype.hide=function(){return this.hideState=!0,this.render()},e.prototype.active=function(t){return this.activeState=t,this.render()},e.prototype.changed=function(){return this.changedState},e.prototype.render=function(){return this.html("<div>some test controller message:'"+this.message+"',show:'"+this.showState+"',hide:'"+this.hideState+"',active:'"+this.activeState+"'</div>")},e.prototype.url=function(){return"#/some/url/"+this.message},e}(App.Controller)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.genericController=new App.ControllerGenericIndex({el:this.el,id:this.id,genericObject:"TextModule",importCallback:function(){return new App.Import({baseUrl:"/api/v1/text_modules",container:this.el.closest(".content"),deleteOption:!0})},pageData:{home:"text_modules",object:"TextModule",objects:"Text modules",navupdate:"#text_modules",notes:["Text modules are ..."],buttons:[{name:"Import","data-type":"import","class":"btn"},{name:"New text module","data-type":"new","class":"btn--success"}]},container:this.el.closest(".content")})}return n(e,t),e.prototype.requiredPermission="admin.text_module",e.prototype.header="Text modules",e}(App.ControllerSubContent),App.Config.set("TextModule",{prio:2300,name:"Text modules",parent:"#manage",target:"#manage/text_modules",controller:t,permission:["admin.text_module"]},"NavBarAdmin")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketCustomer=function(t){function e(){return this.onSubmit=n(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.head="Change Customer",e.prototype.content=function(){var t;return t=[{name:"customer_id",display:"Customer",tag:"user_autocompletion","null":!1,placeholder:"Enter Person or Organization/Company",minLengt:2,disableCreateObject:!1}],new App.ControllerForm({model:{configure_attributes:t},autofocus:!0}).form},e.prototype.onSubmit=function(t){var e,n,i,s,r;return i=this.formParam(t.target),(s=App.Ticket.find(this.ticket_id)).customer_id=i.customer_id,n=s.validate(),_.isEmpty(n)?(this.customer_id=i.customer_id,r=this,e=function(){return r.close(),(s=App.Ticket.find(r.ticket_id)).article=void 0,s.updateAttributes({customer_id:r.customer_id})},App.User.full(this.customer_id,e)):(this.log("error",n),void this.formValidate({form:t.target,errors:n}))},e}(App.ControllerModal)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketHistory=function(t){function e(){return this.fetch=n(this.fetch,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.fetch=function(){return this.ajax({id:"ticket_history",type:"GET",url:this.apiPath+"/ticket_history/"+this.ticket_id,success:(e=this,function(t){return App.Collection.loadAssets(t.assets),e.items=t.history,e.render()})});var e},e}(App.GenericHistory)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketLinkAdd=function(t){function e(){this.onSubmit=n(this.onSubmit,this),this.content=n(this.content,this),this.fetch=n(this.fetch,this),e.__super__.constructor.apply(this,arguments),this.fetch()}return i(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.head="Link",e.prototype.shown=!1,e.prototype.url=function(){return this.object instanceof App.Ticket?this.apiPath+"/ticket_related/"+this.object.id:this.apiPath+"/ticket_recent"},e.prototype.fetch=function(){return this.ajax({id:"ticket_related",type:"GET",url:this.url(),processData:!0,success:(e=this,function(t){return App.Collection.loadAssets(t.assets),e.ticketIdsByCustomer=t.ticket_ids_by_customer,e.ticketIdsRecentViewed=t.ticket_ids_recent_viewed,e.render()})});var e},e.prototype.content=function(){var t;return t=$(App.view("link/ticket/add")({link_object:this.link_object,link_object_id:this.link_object_id,link_types:this.link_types,object:this.object,hasByCustomer:void 0!==this.ticketIdsByCustomer,hasRecentViewed:void 0!==this.ticketIdsRecentViewed})),this.ticketIdsByCustomer&&this.buildContentTable(t,this.ticketIdsByCustomer,"ticket-merge-customer-tickets"),this.ticketIdsRecentViewed&&this.buildContentTable(t,this.ticketIdsRecentViewed,"ticket-merge-recent-tickets"),t.delegate('[name="ticket_number"]',"focus",function(t){return $(t.target).parents().find('[name="radio"]').prop("checked",!1)}),t.delegate('[name="radio"]',"click",function(t){var e,n;if($(t.target).prop("checked"))return n=$(t.target).val(),e=App.Ticket.fullLocal(n),$(t.target).parents().find('[name="ticket_number"]').val(e.number)}),t},e.prototype.buildContentTable=function(t,e,n){var i;return this.object instanceof App.Ticket&&(e=e.filter((i=this,function(t){return t!==i.object.id}))),new App.TicketList({tableId:n,el:t.find("#"+n),ticket_ids:e,radio:!0})},e.prototype.onSubmit=function(t){var e,i,n;if((e=this.formParam(t.target)).ticket_number){if(e.link_type)return this.ajax({id:"links_add_"+this.object.id+"_"+this.object_type,type:"GET",url:this.apiPath+"/links/add",data:{link_type:e.link_type,link_object_target:this.link_object,link_object_target_value:this.object.id,link_object_source:"Ticket",link_object_source_number:e.ticket_number},processData:!0,success:(n=this,function(){return n.close(),n.parent.fetch()}),error:(i=this,function(t){var e,n;return n=t.responseText,e={},_.isEmpty(n)||(e=JSON.parse(n)),i.notify({type:"error",msg:App.i18n.translateContent(e.error),removeAll:!0})})});alert("Link type is needed!")}else alert("Ticket# is needed!")},e}(App.ControllerModal)}.call(this),function(){var x,s,r,t,e,c=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function n(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty,l=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};e={validUsersForTicketSelection:function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m;for(s=$(".content.active .table-overview .table").find('[name="bulk"]:checked'),f=_.map(s,function(t){return $(t).val()}),d=_.map(App.Ticket.findAll(f),function(t){return t.group_id}),m=this.usersInGroups(d),e=_.keys(null!=(a=this.formMeta)&&null!=(l=a.dependencies)?l.group_id:void 0),n=App.Group.findAll(e),i=_.sortBy(n,function(t){return t.name}),r=0,o=n.length;r<o;r++)(t=n[r]).valid_users_count=(null!=(c=this.formMeta)&&null!=(p=c.dependencies)&&null!=(u=p.group_id)&&null!=(h=u[t.id])?h.owner_id.length:void 0)||0;return{users:m,groups:i}},usersInGroups:function(t){var e,n,i,s,r;return e=_.chain(null!=(i=this.formMeta)&&null!=(s=i.dependencies)?s.group_id:void 0).pick(t).values().map(function(t){return t.owner_id}).value(),n=_.intersection.apply(_,e),r=App.User.findAll(n),_.sortBy(r,function(t){return t.firstname})}},App.TicketOverview=function(t){function i(){var t,e,n;this.listNavigate=c(this.listNavigate,this),this.keyboardOn=c(this.keyboardOn,this),this.release=c(this.release,this),this.currentPosition=c(this.currentPosition,this),this.setPosition=c(this.setPosition,this),this.hide=c(this.hide,this),this.show=c(this.show,this),this.url=c(this.url,this),this.active=c(this.active,this),this.renderOptionsMacros=c(this.renderOptionsMacros,this),this.renderOptionsGroups=c(this.renderOptionsGroups,this),this.renderOptions=c(this.renderOptions,this),this.renderBatchOverlay=c(this.renderBatchOverlay,this),this.blinkBatchEntry=c(this.blinkBatchEntry,this),this.highlightBatchEntryAtMousePosition=c(this.highlightBatchEntryAtMousePosition,this),this.showBatchAssignGroup=c(this.showBatchAssignGroup,this),this.controlBatchOverlay=c(this.controlBatchOverlay,this),this.endDragItem=c(this.endDragItem,this),this.dragItem=c(this.dragItem,this),this.startDragItem=c(this.startDragItem,this),i.__super__.constructor.apply(this,arguments),this.batchSupport=this.permissionCheck("ticket.agent"),this.render(),this.bind("ui:rerender",(e=this,function(){return e.renderBatchOverlay()})),t=function(t){return App.Collection.loadAssets(t.assets),n.formMeta=t.form_meta},(n=this).bindId=App.TicketCreateCollection.bind(t)}return o(i,t),i.prototype.className="overviews",i.prototype.activeFocus="nav",i.prototype.mouse={x:null,y:null},i.prototype.batchAnimationPaused=!1,i.prototype.elements={".js-batch-overlay":"batchOverlay",".js-batch-overlay-backdrop":"batchOverlayBackdrop",".js-batch-cancel":"batchCancel",".js-batch-macro-circle":"batchMacroCircle",".js-batch-assign-circle":"batchAssignCircle",".js-batch-assign":"batchAssign",".js-batch-assign-inner":"batchAssignInner",".js-batch-assign-group":"batchAssignGroup",".js-batch-assign-group-name":"batchAssignGroupName",".js-batch-assign-group-inner":"batchAssignGroupInner",".js-batch-macro":"batchMacro",".main":"mainContent"},i.prototype.events={"mousedown .item":"startDragItem","mouseenter .js-batch-hover-target":"highlightBatchEntry","mouseleave .js-batch-hover-target":"unhighlightBatchEntry"},i.include(e),i.prototype.startDragItem=function(t){var e;if(this.batchSupport)return this.grabbedItem=$(t.currentTarget),e=this.grabbedItem.offset(),this.batchDragger=$(App.view("ticket_overview/batch_dragger")()),this.grabbedItemClone=this.grabbedItem.clone(),this.grabbedItemClone.data("offset",this.grabbedItem.offset()),this.grabbedItemClone.addClass("batch-dragger-item js-main-item"),this.batchDragger.append(this.grabbedItemClone),this.batchDragger.data({startX:t.pageX,startY:t.pageY,dx:Math.min(t.pageX-e.left,180),dy:t.pageY-e.top,moved:!1}),$(document).on("mousemove.item",this.dragItem),$(document).one("mouseup.item",this.endDragItem)},i.prototype.dragItem=function(t){var e,n,i,s,r,o,a;if(s=this.batchDragger.data(),r=3,o=t.pageX-s.dx,a=t.pageY-s.dy,i=t.pageY>s.startY?1:-1,!s.moved){if(!(Math.abs(t.pageY-s.startY)>r||Math.abs(t.pageX-s.startX)>r))return;this.batchDragger.data("moved",!0),this.el.addClass("u-no-userselect"),this.grabbedItemWasntChecked=!this.grabbedItem.find('[name="bulk"]').prop("checked"),this.grabbedItem.find('[name="bulk"]').prop("checked",!0),this.grabbedItemClone.find('[name="bulk"]').prop("checked",!0),n=(e=this.el.find('[name="bulk"]:checked').parents(".item").not(this.grabbedItem)).clone(),this.draggedItems=this.grabbedItemClone.add(n),n.each(function(t){return $(this).data("offset",e.eq(t).offset())}),this.batchDragger.prepend(n.addClass("batch-dragger-item").get().reverse()),n.length&&this.batchDragger.find(".js-batch-dragger-count").text(this.draggedItems.length),this.renderOptions(),$("#app").append(this.batchDragger),this.draggedItems.each(function(t,e){var n,i;return n=$(e).data("offset").left-$(e).offset().left-o,i=$(e).data("offset").top-$(e).offset().top-a,$.Velocity.hook(e,"translateX",n+"px"),$.Velocity.hook(e,"translateY",i+"px")}),this.alignDraggedItems(-i),this.mouseY=t.pageY,this.showBatchOverlay()}return t.preventDefault(),$.Velocity.hook(this.batchDragger,"translateX",o+"px"),$.Velocity.hook(this.batchDragger,"translateY",a+"px")},i.prototype.endDragItem=function(){var t,s;if($(document).off("mousemove.item"),$(document).off("mouseup.item"),t=this.batchDragger.data(),this.clearDelay("clear-hovered-batch-entry"),this.hoveredBatchEntry)return $.Velocity.hook(this.batchDragger,"transformOriginX",t.dx+"px"),$.Velocity.hook(this.batchDragger,"transformOriginY",t.dy+"px"),this.hoveredBatchEntry.velocity({properties:{scale:1.1},options:{duration:200,complete:(s=this,function(){if(s.hoveredBatchEntry)return s.hoveredBatchEntry.velocity("reverse",{duration:200,complete:function(){var t,e,n,i;if(s.hoveredBatchEntry)return t=s.hoveredBatchEntry.attr("data-action"),n=s.hoveredBatchEntry.attr("data-id"),e=s.hoveredBatchEntry.attr("data-group-id"),i=s.el.find('[name="bulk"]:checked'),s.hoveredBatchEntry.removeAttr("style"),s.cleanUpDrag(!0),s.performBatchAction(i,t,n,e);s.cleanUpDrag()}});s.cleanUpDrag()})}}),this.batchDragger.velocity({properties:{scale:0},options:{duration:200}});this.cleanUpDrag()},i.prototype.cancelDrag=function(){return $(document).off("mousemove.item"),$(document).off("mouseup.item"),this.cleanUpDrag()},i.prototype.cleanUpDrag=function(t){if(this.hideBatchOverlay(),this.el.removeClass("u-no-userselect"),$(".batch-dragger").remove(),this.hoveredBatchEntry=null,this.grabbedItemWasntChecked&&this.grabbedItem.find('[name="bulk"]').prop("checked",!1),t)return this.el.find('[name="bulk"]:checked').prop("checked",!1),this.el.find('[name="bulk_all"]').prop("checked",!1)},i.prototype.alignDraggedItems=function(e){var n;return this.draggedItems.velocity({properties:{translateX:0,translateY:(n=this,function(t){return e*t*n.batchDragger.height()/2})},options:{easing:"ease-in-out",duration:300}}),this.batchDragger.find(".js-batch-dragger-count").velocity({properties:{translateY:e<0?0:8-this.batchDragger.height()},options:{easing:"ease-in-out",duration:300}})},i.prototype.performBatchAction=function(t,e,n,i){var s,r,o,a,l,c,p,u,h;if("macro"!==e)if("user_assign"!==e){if("group_assign"===e)for(this.batchCount=t.length,a=this.batchCountIndex=0,p=t.length;a<p;a++)s=t[a],(h=App.Ticket.find($(s).val())).group_id=n,h.save({done:function(t){return function(){if(t.batchCountIndex++,t.batchCountIndex===t.batchCount)return App.Event.trigger("overview:fetch")}}(this)})}else for(this.batchCount=t.length,o=this.batchCountIndex=0,c=t.length;o<c;o++)s=t[o],(h=App.Ticket.find($(s).val())).owner_id=n,_.isEmpty(i)||(h.group_id=i),h.save({done:function(t){return function(){if(t.batchCountIndex++,t.batchCountIndex===t.batchCount)return App.Event.trigger("overview:fetch")}}(this)});else for(this.batchCount=t.length,this.batchCountIndex=0,u=App.Macro.find(n),r=0,l=t.length;r<l;r++)s=t[r],h=App.Ticket.find($(s).val()),App.Ticket.macro({macro:u.perform,ticket:h}),h.save({done:function(t){return function(){if(t.batchCountIndex++,t.batchCountIndex===t.batchCount)return App.Event.trigger("overview:fetch")}}(this)})},i.prototype.showBatchOverlay=function(){return this.batchOverlay.addClass("is-visible"),$("html").css("overflow","hidden"),this.batchOverlayBackdrop.velocity({opacity:[1,0]},{duration:500}),this.batchMacroOffset=this.batchMacro.offset().top+this.batchMacro.outerHeight(),this.batchAssignOffset=this.batchAssign.offset().top,this.batchOverlayShown=!0,$(document).on("mousemove.batchoverlay",this.controlBatchOverlay)},i.prototype.hideBatchOverlay=function(){var t;if($(document).off("mousemove.batchoverlay"),this.batchOverlayShown=!1,this.batchOverlayBackdrop.velocity({opacity:[0,1]},{duration:300,queue:!1}),this.hideBatchCircles((t=this,function(){
return t.batchOverlay.removeClass("is-visible")})),$("html").css("overflow",""),this.batchAssignShown&&this.hideBatchAssign(),this.batchMacroShown&&this.hideBatchMacro(),this.batchAssignGroupShown)return this.hideBatchAssignGroup()},i.prototype.controlBatchOverlay=function(t){if(!this.batchAnimationPaused)if(this.mouse.x=t.pageX,this.mouse.y=t.pageY,this.batchAssignGroupShown&&void 0!==this.batchAssignGroupOffset)this.mouse.y<this.batchAssignGroupOffset&&(this.hideBatchAssignGroup(),this.batchAnimationPaused=!0);else switch(this.mouse.y<=this.batchMacroOffset?"top":this.mouse.y>this.batchMacroOffset&&this.mouse.y<=this.batchAssignOffset?"middle":"bottom"){case"top":if(!this.batchMacroShown)return this.hideBatchCircles(),this.showBatchMacro(),this.alignDraggedItems(1);break;case"middle":if(this.batchAssignShown&&this.hideBatchAssign(),this.batchMacroShown&&this.hideBatchMacro(),!this.batchCirclesShown)return this.showBatchCircles();break;case"bottom":if(!this.batchAssignShown)return this.hideBatchCircles(),this.showBatchAssign(),this.alignDraggedItems(-1)}},i.prototype.showBatchCircles=function(){return this.batchCirclesShown=!0,this.batchMacroCircle.velocity({properties:{translateY:[0,"-150%"],opacity:[1,0]},options:{easing:[1,-.55,.2,1.37],duration:500,visibility:"visible",delay:200}}),this.batchAssignCircle.velocity({properties:{translateY:[0,"150%"],opacity:[1,0]},options:{easing:[1,-.55,.2,1.37],duration:500,visibility:"visible",delay:200}})},i.prototype.hideBatchCircles=function(t){return this.batchMacroCircle.velocity({properties:{translateY:["-150%",0],opacity:[0,1]},options:{duration:300,visibility:"hidden",queue:!1}}),this.batchAssignCircle.velocity({properties:{translateY:["150%",0],opacity:[0,1]},options:{duration:300,complete:t,visibility:"hidden",queue:!1}}),this.batchCirclesShown=!1},i.prototype.showBatchAssign=function(){if(this.batchOverlayShown)return this.batchAssignShown=!0,this.batchCancel.css({top:0,bottom:this.batchAssign.height()}),this.batchAssign.velocity({properties:{translateY:[0,"100%"],opacity:[1,0]},options:{easing:[1,-.55,.2,1.37],duration:500,visibility:"visible",complete:this.highlightBatchEntryAtMousePosition}}),this.batchCancel.velocity({properties:{translateY:[0,"100%"],opacity:[1,0]},options:{easing:[1,-.55,.2,1.37],duration:500,visibility:"visible"}})},i.prototype.hideBatchAssign=function(){var t;return this.batchAssign.velocity({properties:{translateY:["100%",0],opacity:[0,1]},options:{duration:300,visibility:"hidden",queue:!1,complete:(t=this,function(){return $.Velocity.hook(t.batchAssign,"translateY","0%")})}}),this.batchCancel.velocity({properties:{translateY:["100%",0],opacity:[0,1]},options:{duration:300,visibility:"hidden",queue:!1}}),this.batchAssignShown=!1},i.prototype.showBatchAssignGroup=function(){var t,e,n;if(this.batchOverlayShown)return this.batchAssignGroupShown=!0,e=this.hoveredBatchEntry.attr("data-id"),t=App.Group.find(e),this.batchAssignGroupName.text(t.displayName()),this.batchAssignGroupInner.html($(App.view("ticket_overview/batch_overlay_user_group")({users:this.usersInGroups([e]),groups:[],groupId:e}))),this.batchAssignGroupInner.height(this.batchAssignInner.height()),this.batchAssignGroup.velocity({properties:{translateY:[0,"100%"],opacity:[1,0]},options:{easing:[1,-.55,.2,1.37],duration:700,visibility:"visible",complete:(n=this,function(){return n.highlightBatchEntryAtMousePosition(),n.batchAssignGroupOffset=n.batchAssignGroup.offset().top})}})},i.prototype.hideBatchAssignGroup=function(){var t;return this.batchAssignGroup.velocity({properties:{translateY:["100%",0],opacity:[0,1]},options:{duration:300,visibility:"hidden",queue:!1,complete:(t=this,function(){return t.batchAssignGroupShown=!1,t.batchAssignGroupHovered=!1,setTimeout(function(){return t.batchAnimationPaused=!1},1e3)})}}),this.batchAssignGroupOffset=void 0},i.prototype.showBatchMacro=function(){if(this.batchOverlayShown)return this.batchMacroShown=!0,this.batchCancel.css({bottom:0,top:this.batchMacro.height()}),this.batchMacro.velocity({properties:{translateY:[0,"-100%"],opacity:[1,0]},options:{easing:[1,-.55,.2,1.37],duration:500,visibility:"visible",complete:this.highlightBatchEntryAtMousePosition}}),this.batchCancel.velocity({properties:{translateY:[0,"-100%"],opacity:[1,0]},options:{easing:[1,-.55,.2,1.37],duration:500,visibility:"visible"}})},i.prototype.hideBatchMacro=function(){var t;return this.batchMacro.velocity({properties:{translateY:["-100%",0],opacity:[0,1]},options:{duration:300,visibility:"hidden",queue:!1,complete:(t=this,function(){return $.Velocity.hook(t.batchMacro,"translateY","0%")})}}),this.batchCancel.velocity({properties:{translateY:["-100%",0],opacity:[0,1]},options:{duration:300,visibility:"hidden",queue:!1}}),this.batchMacroShown=!1},i.prototype.highlightBatchEntryAtMousePosition=function(){var t;if((t=$(document.elementFromPoint(this.mouse.x,this.mouse.y)).closest(".js-batch-overlay-entry .avatar")).length)return this.hoveredBatchEntry=t.closest(".js-batch-overlay-entry").addClass("is-hovered")},i.prototype.highlightBatchEntry=function(t){if(this.clearDelay("clear-hovered-batch-entry"),this.hoveredBatchEntry=$(t.currentTarget).closest(".js-batch-overlay-entry").addClass("is-hovered"),"group_assign"===this.hoveredBatchEntry.attr("data-action"))return this.batchAssignGroupHintTimeout=setTimeout(this.blinkBatchEntry,800),this.batchAssignGroupTimeout=setTimeout(this.showBatchAssignGroup,900)},i.prototype.unhighlightBatchEntry=function(){var t,e;if(this.hoveredBatchEntry)return"group_assign"===this.hoveredBatchEntry.attr("data-action")&&(this.batchAssignGroupTimeout&&clearTimeout(this.batchAssignGroupTimeout),this.batchAssignGroupHintTimeout&&clearTimeout(this.batchAssignGroupHintTimeout)),this.hoveredBatchEntry.removeClass("is-hovered"),t=function(){return e.hoveredBatchEntry=null},(e=this).delay(t,800,"clear-hovered-batch-entry")},i.prototype.blinkBatchEntry=function(){return this.hoveredBatchEntry.velocity({opacity:[.5,1]},{duration:120}).velocity({opacity:[1,.5]},{duration:60,delay:40}).velocity({opacity:[.5,1]},{duration:120}).velocity({opacity:[1,.5]},{duration:60,delay:40})},i.prototype.render=function(){var t,e,n,i;return t=$(App.view("ticket_overview/index")()),this.navBarControllerVertical=new s({el:t.find(".overview-header"),view:this.view,vertical:!0}),this.navBarController=new s({el:t.filter(".sidebar"),view:this.view}),this.contentController=new r({el:t.find(".overview-table"),view:this.view,keyboardOn:this.keyboardOn,keyboardOff:this.keyboardOff}),this.renderBatchOverlay(t.filter(".js-batch-overlay")),this.html(t),this.el.find(".main").on("click",(e=this,function(){return e.activeFocus="overview"})),this.el.find(".sidebar").on("click",(n=this,function(){return n.activeFocus="nav"})),this.bind("overview:fetch",(i=this,function(){var t;if(i.view)return t=function(){return App.OverviewListCollection.fetch(i.view)},i.delay(t,2800,"overview:fetch")}))},i.prototype.renderBatchOverlay=function(t){if(!t)return this.batchOverlay.html(App.view("ticket_overview/batch_overlay")()),this.refreshElements();t.html(App.view("ticket_overview/batch_overlay")())},i.prototype.renderOptions=function(){return this.renderOptionsGroups(),this.renderOptionsMacros()},i.prototype.renderOptionsGroups=function(){return this.batchAssignInner.html($(App.view("ticket_overview/batch_overlay_user_group")(this.validUsersForTicketSelection())))},i.prototype.renderOptionsMacros=function(){var t,e,n,i,s,r,o,a,l,c;for(this.possibleMacros=[],l=App.Macro.getList(),t=[],i=0,r=(n=this.el.find('[name="bulk"]:checked')).length;i<r;i++)e=n[i],c=App.Ticket.find($(e).val()),t.push(c.group_id);for(t=_.uniq(t),s=0,o=l.length;s<o;s++)a=l[s],_.isEmpty(a.group_ids)&&!_.includes(this.possibleMacros,a)&&this.possibleMacros.push(a),_.isEqual(a.group_ids,t)&&!_.includes(this.possibleMacros,a)&&this.possibleMacros.push(a),_.isEmpty(a.group_ids)||!_.isEmpty(_.difference(t,a.group_ids))||_.includes(this.possibleMacros,a)||this.possibleMacros.push(a);return this.batchMacro.html($(App.view("ticket_overview/batch_overlay_macro")({macros:this.possibleMacros})))},i.prototype.active=function(t){return void 0===t?this.shown:this.shown=t},i.prototype.url=function(){return"#ticket/view/"+this.view},i.prototype.show=function(t){if(this.keyboardOn(),this.navupdate("#ticket/view"),this.view=t.view,this.view||!this.viewLast){if(this.navBarController&&this.navBarController.update({view:this.view,activeState:!0}),this.navBarControllerVertical&&this.navBarControllerVertical.update({view:this.view,activeState:!0}),this.viewLast!==this.view)return this.viewLast=this.view,this.contentController=new r({el:this.$(".overview-table"),view:this.view,keyboardOn:this.keyboardOn,keyboardOff:this.keyboardOff});this.contentController&&this.contentController.show()}else this.navigate("ticket/view/"+this.viewLast,!0)},i.prototype.hide=function(){if(this.keyboardOff(),this.navBarController&&this.navBarController.active(!1),this.navBarControllerVertical&&this.navBarControllerVertical.active(!1),this.contentController)return this.contentController.hide()},i.prototype.setPosition=function(t){return this.$(".main").scrollTop(t)},i.prototype.currentPosition=function(){return this.$(".main").scrollTop()},i.prototype.changed=function(){return!1},i.prototype.release=function(){return this.keyboardOff(),i.__super__.release.apply(this,arguments),App.TicketCreateCollection.unbindById(this.bindId)},i.prototype.keyboardOn=function(){return $(window).off("keydown.overview_navigation"),$(window).on("keydown.overview_navigation",this.listNavigate)},i.prototype.keyboardOff=function(){return $(window).off("keydown.overview_navigation")},i.prototype.listNavigate=function(t){var e;if(!$(t.target).is("textarea, input, select"))if(38===t.keyCode)t.preventDefault(),this.nudge(t,-1);else if(40===t.keyCode)t.preventDefault(),this.nudge(t,1);else if(32===t.keyCode){if(t.preventDefault(),"overview"===this.activeFocus)return this.$(".table-overview table tbody tr.is-hover td.js-checkbox-field label input").first().click()}else{if(9===t.keyCode)return t.preventDefault(),"nav"===this.activeFocus?(this.activeFocus="overview",this.nudge(t,1)):this.activeFocus="nav";if(13===t.keyCode&&"overview"===this.activeFocus&&(e=this.$(".table-overview table tbody tr.is-hover a").first().attr("href")))return this.navigate(e)}},i.prototype.nudge=function(t,e){var n,i,s,r,o;if("overview"===this.activeFocus){if(!(n=(i=this.$(".table-overview table tbody")).find("tr.is-hover")).size())return void i.find("tr").first().addClass("is-hover");if(1===e?(r=n.next("tr")).size()&&(n.removeClass("is-hover"),r.addClass("is-hover")):(o=n.prev("tr")).size()&&(n.removeClass("is-hover"),o.addClass("is-hover")),r&&this.scrollToIfNeeded(r,!0),o)return this.scrollToIfNeeded(o,!0)}else{if(!(n=(i=this.$(".sidebar")).find("li.active")).size())return void((s=i.find("li a").first().attr("href"))&&this.navigate(s));if(1===e?(r=n.next("li")).size()&&this.navigate(r.find("a").attr("href")):(o=n.prev("li")).size()&&this.navigate(o.find("a").attr("href")),r&&this.scrollToIfNeeded(r,!0),o)return this.scrollToIfNeeded(o,!0)}},i}(App.Controller),s=function(t){function e(){var t;this.render=c(this.render,this),this.active=c(this.active,this),this.autoFoldTabs=c(this.autoFoldTabs,this),this.release=c(this.release,this),this.activate=c(this.activate,this),this.onDropdownHide=c(this.onDropdownHide,this),this.onDropdownShow=c(this.onDropdownShow,this),e.__super__.constructor.apply(this,arguments),this.bindId=App.OverviewIndexCollection.bind(this.render),this.bind("ui:rerender",(t=this,function(){return t.render(App.OverviewIndexCollection.get())})),this.vertical&&$(window).on("resize.navbar",this.autoFoldTabs)}return o(e,t),e.prototype.elements={".js-tabsHolder":"tabsHolder",".js-tabsClone":"clone",".js-tabClone":"tabClone",".js-tabs":"tabs",".js-tab":"tab",".js-dropdown":"dropdown",".js-toggle":"dropdownToggle",".js-dropdownItem":"dropdownItem"},e.prototype.events={"click .js-tab":"activate","click .js-dropdownItem":"navigateTo","hide.bs.dropdown":"onDropdownHide","show.bs.dropdown":"onDropdownShow"},e.prototype.navigateTo=function(t){return location.hash=$(t.currentTarget).attr("data-target")},e.prototype.onDropdownShow=function(){return this.dropdownToggle.addClass("active")},e.prototype.onDropdownHide=function(){return this.dropdownToggle.removeClass("active")},e.prototype.activate=function(t){return this.tab.removeClass("active"),$(t.currentTarget).addClass("active")},e.prototype.release=function(){return this.vertical&&$(window).off("resize.navbar",this.autoFoldTabs),App.OverviewIndexCollection.unbindById(this.bindId)},e.prototype.autoFoldTabs=function(){var t;for(t=App.OverviewIndexCollection.get(),this.html(App.view("agent_ticket_view/navbar"+(this.vertical?"_vertical":void 0))({items:t,isAgent:this.permissionCheck("ticket.agent")}));this.clone.width()>this.tabsHolder.width();)this.tabClone.not(".hide").last().addClass("hide"),this.tab.not(".hide").last().addClass("hide"),this.dropdownItem.filter(".hide").last().removeClass("hide");if(0===this.dropdownItem.not(".hide").size())return this.dropdown.remove(),this.dropdownToggle.remove()},e.prototype.active=function(t){return this.activeState=t},e.prototype.update=function(t){var e,n;for(e in null==t&&(t={}),t)n=t[e],this[e]=n;return this.render(App.OverviewIndexCollection.get())},e.prototype.render=function(t){var e,n,i,s,r,o,a;if(t){if(e=this.el.closest(".content"),_.isArray(t)&&_.isEmpty(t))return e.find(".sidebar").addClass("hide"),e.find(".main").addClass("hide"),e.find(".js-error").removeClass("hide"),void this.renderScreenError({el:this.el.closest(".content").find(".js-error"),detail:"Currently no overview is assigned to your roles. Please contact your administrator.",objectName:"Ticket"});if(e.find(".sidebar").removeClass("hide"),e.find(".main").removeClass("hide"),e.find(".js-error").addClass("hide"),this.vertical&&(t&&t.length<=1?this.el.addClass("hidden"):this.el.removeClass("hidden")),this.activeState&&this.view&&!this.vertical)for(i=0,r=t.length;i<r;i++)(n=t[i]).link===this.view&&this.title(n.name,!0);if(!this.view&&t&&t[0]&&t[0].link&&App.WebSocket.send({event:"ticket_overview_select",data:{view:t[0].link}}),this.activeState&&!this.view&&!this.vertical)return a=t[0].link,void this.navigate("ticket/view/"+a,!0);for(s=0,o=t.length;s<o;s++)(n=t[s]).target="#ticket/view/"+n.link,n.link===this.view?(n.active=!0,n):n.active=!1;return this.html(App.view("agent_ticket_view/navbar"+(this.vertical?"_vertical":""))({items:t})),this.vertical?this.autoFoldTabs():void 0}},e}(App.Controller),r=function(t){function e(){var t;this.settings=c(this.settings,this),this.viewmode=c(this.viewmode,this),this.shouldShowBulkForm=c(this.shouldShowBulkForm,this),this.render=c(this.render,this),this.updateTable=c(this.updateTable,this),this.update=c(this.update,this),this.release=c(this.release,this),this.hide=c(this.hide,this),this.show=c(this.show,this),e.__super__.constructor.apply(this,arguments),this.view&&(this.bindId=App.OverviewListCollection.bind(this.view,this.updateTable)),this.bind("ui:rerender",(t=this,function(){if(t.authenticateCheck()&&t.view)return t.render(App.OverviewListCollection.get(t.view))}))}return o(e,t),e.extend(App.PopoverProvidable),e.registerPopovers("Organization","User"),e.prototype.events={"click [data-type=settings]":"settings","click [data-type=viewmode]":"viewmode"},e.prototype.show=function(){if(this.table)return this.table.show()},e.prototype.hide=function(){if(this.table)return this.table.hide()},e.prototype.release=function(){if(this.bindId)return App.OverviewListCollection.unbind(this.bindId)},e.prototype.update=function(t){var e,n;for(e in t)n=t[e],this[e]=n;if(this.view)return this.view?(this.bindId&&App.OverviewListCollection.unbind(this.bindId),this.bindId=App.OverviewListCollection.bind(this.view,this.updateTable)):void 0},e.prototype.updateTable=function(t){var e,n,i,s,r,o;if(this.table){if(i=t.overview,o=t.tickets,i||o){for(r=[],e=0,n=o.length;e<n;e++)s=o[e],r.push(App.Ticket.find(s.id));return this.overview=App.Overview.find(i.id),this.table.update({overviewAttributes:this.overview.view.s,objects:r,groupBy:this.overview.group_by,groupDirection:this.overview.group_direction,orderBy:this.overview.order.by,orderDirection:this.overview.order.direction})}}else this.render(t)},e.prototype.render=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,_,w,k;if(t&&(g=t.overview,w=t.tickets,g||w)){for(this.view_mode=App.LocalStorage.get("mode:"+this.view,this.Session.get("id"))||"s",console.log("notice","view:",this.view,this.view_mode),App.WebSocket.send({event:"ticket_overview_select",data:{view:this.view}}),_=[],d=0,f=w.length;d<f;d++)b=w[d],_.push(App.Ticket.find(b.id));var T,A,S,C;if(_[0]||!this.permissionCheck("ticket.customer"))return this.overview=App.Overview.find(g.id),u=!(p=!0),this.permissionCheck("admin.overview")&&(u=!0),this.permissionCheck("ticket.customer")&&(u=p=!1),k=[{name:"S",type:"s","class":"s"===this.view_mode?"active":void 0},{name:"M",type:"m","class":"m"===this.view_mode?"active":void 0}],this.permissionCheck("ticket.customer")&&(k=[]),h=App.view("agent_ticket_view/content")({overview:this.overview,view_modes:k,edit:u}),h=$(h),this.html(h),v="","m"===this.view_mode?(v=App.view("agent_ticket_view/detail")({overview:this.overview,objects:_,checkbox:p}),(v=$(v)).delegate('[name="bulk_all"]',"change",function(t){return $(t.currentTarget).prop("checked")?$(t.currentTarget).closest("table").find('[name="bulk"]').prop("checked",!0):$(t.currentTarget).closest("table").find('[name="bulk"]').prop("checked",!1)}),this.$(".table-overview").append(v)):(m=function(t){return b=App.Ticket.findNative(t),App.TaskManager.execute({key:"Ticket-"+b.id,controller:"TicketZoom",params:{ticket_id:b.id,overview_id:A.overview.id},show:!0}),A.navigate(b.uiUrl())},T=A=this,n=function(t,e,n){var i,s,r,o,a;return T.shouldShowBulkForm()?(T.bulkForm.render(),T.bulkForm.show()):T.bulkForm.hide(),T.lastChecked&&n.shiftKey&&(i=$(n.currentTarget).parents(".item"),o=$(T.lastChecked).parents(".item"),r=i.parent().children(),i.index()>o.index()?(a=o.index(),s=i.index()):(a=i.index(),s=o.index()),r.slice(a+1,s).find('[name="bulk"]').prop("checked",function(){return!this.checked})),T.lastChecked=n.currentTarget},function(t,e,n){var i;return" ",e.priority?n.title=e.priority():n.title=App.i18n.translateInline(null!=(i=App.TicketPriority.findNative(this.priority_id))?i.displayName():void 0),e.priorityIcon()},o=function(t){var e;return e={name:"icon_priority",display:"",translation:!1,width:"24px",displayWidth:24,unresizable:!0},t.unshift(0),t[0]=e,t},r=function(t,e,n){var i;return" ",i=App.TicketPriority.findNative(e.priority_id),n.title=App.i18n.translateInline(null!=i?i.name:void 0),e.priorityIcon()},i=[s=function(t){var e;return e={name:"icon",display:"",translation:!1,width:"28px",displayWidth:28,unresizable:!0},t.unshift(0),t[0]=e,t}],e={icon:[function(t,e,n){return t=" ",n["class"]=e.iconClass(),n.link="",n.title=e.iconTitle(),t}],customer_id:[c=function(t,e,n){var i;return e?(i=void 0,"customer_id"===n.name&&(i=e.customer_id),"owner_id"===n.name&&(i=e.owner_id),i&&(n["class"]="user-popover",n.data={id:i}),t):t}],organization_id:[function(t,e,n){return e&&e.organization_id&&(n["class"]="organization-popover",n.data={id:e.organization_id}),t}],owner_id:[c],title:[a=function(t,e,n){return n.link=e.uiUrl(),t},l=function(t,e,n){return n.title=e.title,t}],number:[a,l]},!0===App.Config.get("ui_ticket_overview_priority_icon")&&(i=[s,o],e.icon_priority=[r]),y={tableId:"ticket_overview_"+this.overview.id,overview:this.overview.view.s,el:this.$(".table-overview"),model:App.Ticket,objects:_,checkbox:p,groupBy:this.overview.group_by,groupDirection:this.overview.group_direction,orderBy:this.overview.order.by,orderDirection:this.overview.order.direction,"class":"table--light",bindRow:{events:{click:m}},callbackHeader:i,callbackAttributes:e,bindCheckbox:{events:{click:n},select_all:n}},0!==this.el.width()&&(this.elWidth=this.el.width()),this.elWidth&&(y.availableWidth=this.elWidth),this.table=new App.ControllerTable(y)),this.renderPopovers(),this.bulkForm=new x({holder:this.el,view:this.view}),this.el.append(this.bulkForm.el),0!==this.$(".table-overview").find('input[name="bulk"]:checked').length&&this.bulkForm.show(),this.$(".table-overview").delegate('input[name="bulk"], input[name="bulk_all"]',"change",(S=this,function(){return S.shouldShowBulkForm()?S.bulkForm.show():(S.bulkForm.hide(),S.bulkForm.reset())})),this.$(".table-overview").delegate('[name="bulk"]',"change",(C=this,function(){var t,e,n;return t=C.$(".table-overview").find('[name="bulk_all"]'),n=C.$(".table-overview").find('input[name="bulk"]:checked').length,e=C.$(".table-overview").find('input[name="bulk"]').length,0===n?(t.prop("indeterminate",!1),t.prop("checked",!1)):n===e?(t.prop("indeterminate",!1),t.prop("checked",!0)):(t.prop("checked",!1),t.prop("indeterminate",!0))}));this.html(App.view("customer_not_ticket_exists")())}},e.prototype.shouldShowBulkForm=function(){var e,t,n,i;return 0!==(t=this.$("table").find('input[name="bulk"]:checked')).length&&(i=_.map(t,function(t){return $(t).val()}),n=_.map(App.Ticket.findAll(i),function(t){return t.group_id}),n=_.uniq(n),e=App.User.find(this.Session.get("id")).allGroupIds("change"),e=_.map(e,function(t){return parseInt(t,10)}),_.every(n,function(t){return 0<=l.call(e,t)}))},e.prototype.viewmode=function(t){return t.preventDefault(),this.view_mode=$(t.target).data("mode"),App.LocalStorage.set("mode:"+this.view,this.view_mode,this.Session.get("id")),this.fetch()},e.prototype.settings=function(t){return t.preventDefault(),this.keyboardOff(),new App.OverviewSettings({overview_id:this.overview.id,view_mode:this.view_mode,container:this.el.closest(".content"),onCloseCallback:this.keyboardOn})},e}(App.Controller),x=function(t){function l(){var t,e,n,i,s,r,o,a;for(e in this.saveTicketArticle=c(this.saveTicketArticle,this),this.submit=c(this.submit,this),this.removeSpaceForTableRows=c(this.removeSpaceForTableRows,this),this.makeSpaceForTableRows=c(this.makeSpaceForTableRows,this),this.hide=c(this.hide,this),this.show=c(this.show,this),this.cancel=c(this.cancel,this),this.reset=c(this.reset,this),this.confirm=c(this.confirm,this),this.release=c(this.release,this),l.__super__.constructor.apply(this,arguments),this.configure_attributes_ticket=[],o=["state_id","pending_time","priority_id","group_id","owner_id"],n=App.Ticket.attributesGet("edit"))t=n[e],_.contains(o,e)&&((s=clone(t)).nulloption=!0,s["default"]="",s["null"]=!0,this.configure_attributes_ticket.push(s));(r=_.findWhere(this.configure_attributes_ticket,{name:"pending_time"})).orientation="top",r.disableScroll=!0,this.holder=this.options.holder,this.visible=!1,i=function(t){return App.Collection.loadAssets(t.assets),a.formMeta=t.form_meta,a.render()},(a=this).bindId=App.TicketCreateCollection.bind(i)}return o(l,t),l.prototype.className="bulkAction hide",l.prototype.events={"submit form":"submit","click .js-submit":"submit","click .js-confirm":"confirm","click .js-cancel":"reset"},l.include(e),l.prototype.release=function(){return App.TicketCreateCollection.unbind(this.bindId)},l.prototype.render=function(){var t,e,n,i,s,r,o,a;for(this.el.css("right",App.Utils.getScrollBarWidth()),this.html(App.view("agent_ticket_view/bulk")()),e=this.Config.get("TicketZoomFormHandler"),n=0,i=(r=this.configure_attributes_ticket).length;n<i;n++)"owner_id"===(t=r[n]).name&&(a=(o=this.validUsersForTicketSelection()).users,o.groups,s=_.map(a,function(t){return{value:t.id,name:t.displayName()}}),t.possible_groups_owners=s);return new App.ControllerForm({el:this.$("#form-ticket-bulk"),model:{configure_attributes:this.configure_attributes_ticket,className:"create",labelClass:"input-group-addon"},handlersConfig:e,params:{},filter:this.formMeta.filter,formMeta:this.formMeta,noFieldset:!0}),new App.ControllerForm({el:this.$("#form-ticket-bulk-comment"),model:{configure_attributes:[{name:"body",display:"Comment",tag:"textarea",rows:4,"null":!0,upload:!1,item_class:"flex"}],className:"create",labelClass:"input-group-addon"},noFieldset:!0}),this.confirm_attributes=[{name:"type_id",display:"Type",tag:"select",multiple:!1,"null":!0,relation:"TicketArticleType",filter:this.articleTypeFilter,"default":"9",translate:!0,"class":"medium"},{name:"internal",display:"Visibility",tag:"select","null":!0,options:{"true":"internal","false":"public"},"class":"medium",item_class:"","default":!1}],new App.ControllerForm({el:this.$("#form-ticket-bulk-typeVisibility"),model:{configure_attributes:this.confirm_attributes,className:"create",labelClass:"input-group-addon"},noFieldset:!0})},l.prototype.articleTypeFilter=function(t){var e,n,i;for(n=0,i=t.length;n<i;n++)if("note"===(e=t[n]).name)return[e];return t},l.prototype.confirm=function(){return this.$(".js-action-step").addClass("hide"),this.$(".js-confirm-step").removeClass("hide"),this.makeSpaceForTableRows(),setTimeout((t=this,function(){return t.$(".textarea.form-group textarea").focus()}),0);var t},l.prototype.reset=function(){if(this.cancel(),this.visible)return this.makeSpaceForTableRows()},l.prototype.cancel=function(){return this.$(".js-action-step").removeClass("hide"),this.$(".js-confirm-step").addClass("hide")},l.prototype.show=function(){return this.el.removeClass("hide"),this.visible=!0,this.makeSpaceForTableRows()},l.prototype.hide=function(){return this.el.addClass("hide"),this.visible=!1,this.removeSpaceForTableRows()},l.prototype.makeSpaceForTableRows=function(){var t,e,n;if(t=this.el.height(),e=(n=this.holder.scrollParent()).prop("scrollHeight")===n.scrollTop()+n.outerHeight(),this.holder.css("margin-bottom",t),e)return n.scrollTop(n.prop("scrollHeight")-n.outerHeight())},l.prototype.removeSpaceForTableRows=function(){return this.holder.css("margin-bottom",0)},l.prototype.ticketMergeParams=function(t){var e,n;for(e in n={},t)""!==t[e]&&null!==t[e]&&(n[e]=t[e]);return""!==t.group_id&&null!==t.group_id&&(n.owner_id=t.owner_id),n},l.prototype.submit=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f;if(t.preventDefault(),this.bulkCount=this.holder.find(".table-overview").find('[name="bulk"]:checked').length,0!==this.bulkCount){for(f=[],this.holder.find(".table-overview").find('[name="bulk"]:checked').each(function(t,e){var n;return n=$(e).val(),f.push(n)}),c=this.formParam(t.target),s=0,a=f.length;s<a;s++)if(d=f[s],u=App.Ticket.find(d),h=this.ticketMergeParams(c),u.load(h),_.isEmpty(u.title)&&(u.title="-"),i=u.validate({screen:"edit"})){for(o in this.log("error","update",i),n="",i)n+=o+": "+i[o];return this.formValidate({form:t.target,errors:i,screen:"edit"}),App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent("Bulk action stopped %s!",n)}),void this.cancel()}for(r=this.bulkCountIndex=0,l=f.length;r<l;r++){if(d=f[r],u=App.Ticket.find(d),h=this.ticketMergeParams(c),c.body&&(e=new App.TicketArticle,c.from=this.Session.get().displayName(),c.ticket_id=u.id,c.form_id=this.form_id,p=App.TicketArticleSender.findByAttribute("name","Agent"),App.TicketArticleType.find(c.type_id),c.sender_id=p.id,c.internal||(c.internal=!1),this.log("notice","update article",c,p),e.load(c),i=e.validate()))return this.log("error","update article",i),void this.formEnable(t);u.load(h),_.isEmpty(u.title)&&(u.title="-"),this.saveTicketArticle(u,e)}return this.holder.find(".table-overview").find('[name="bulk"]:checked').prop("checked",!1),App.Event.trigger("notify",{type:"success",msg:App.i18n.translateContent("Bulk action executed!")})}App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent("At least one object must be selected.")})},l.prototype.saveTicketArticle=function(e,t){return e.save({done:(i=this,function(){if(i.bulkCountIndex++,t&&t.save({fail:function(t){return i.log("error","update article",t)}}),i.bulkCountIndex===i.bulkCount)return i.render(),i.hide(),App.Event.trigger("overview:fetch")}),fail:(n=this,function(t){return n.bulkCountIndex++,n.log("error","update ticket",t),App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent("Can't update Ticket %s!",e.number)})})});var n,i},l}(App.Controller),App.OverviewSettings=function(t){function e(){return this.onSubmit=c(this.onSubmit,this),this.onClose=c(this.onClose,this),this.content=c(this.content,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.headPrefix="Edit",e.prototype.content=function(){return this.overview=App.Overview.find(this.overview_id),this.head=this.overview.name,this.configure_attributes_article=[],"d"===this.view_mode&&this.configure_attributes_article.push({name:"view::per_page",display:"Items per page",tag:"select",multiple:!1,"null":!1,"default":this.overview.view.per_page,options:{5:" 5",10:"10",15:"15",20:"20",25:"25"}}),this.configure_attributes_article.push({name:"view::"+this.view_mode,display:"Attributes",tag:"checkboxTicketAttributes","default":this.overview.view[this.view_mode],"null":!1,translate:!0,sortBy:null},{name:"order::by",display:"Order",tag:"selectTicketAttributes","default":this.overview.order.by,"null":!1,translate:!0,sortBy:null},{name:"order::direction",display:"Order by Direction",tag:"select","default":this.overview.order.direction,"null":!1,translate:!0,options:{ASC:"up",DESC:"down"}},{name:"group_by",display:"Group by",tag:"select","default":this.overview.group_by,"null":!0,nulloption:!0,translate:!0,options:App.Overview.groupByAttributes()},{name:"group_direction",display:"Group by Direction",tag:"select","default":this.overview.group_direction,"null":!1,translate:!0,options:{ASC:"up",DESC:"down"}}),new App.ControllerForm({model:{configure_attributes:this.configure_attributes_article},autofocus:!1}).form},e.prototype.onClose=function(){if(this.onCloseCallback)return this.onCloseCallback()},e.prototype.onSubmit=function(t){var e,n,i,s,r;for(e in n=this.formParam(t.target),this.reload_needed=!1,this.overview.order.by!==n.order.by&&(this.overview.order.by=n.order.by,this.reload_needed=!0),this.overview.order.direction!==n.order.direction&&(this.overview.order.direction=n.order.direction,this.reload_needed=!0),this.overview.group_direction!==n.group_direction&&(this.overview.group_direction=n.group_direction,this.reload_needed=!0),i=n.view)s=i[e],this.overview.view[e]=s;return this.overview.group_by=n.group_by,this.overview.save({done:(r=this,function(){return r.reload_needed?App.OverviewListCollection.fetch(r.overview.link):(App.OverviewIndexCollection.trigger(),App.OverviewListCollection.trigger(r.overview.link)),r.close()})})},e}(App.ControllerModal),t=function(t){function n(t){var e;n.__super__.constructor.apply(this,arguments),e={view:t.view},App.TaskManager.execute({key:"TicketOverview",controller:"TicketOverview",params:e,show:!0,persistent:!0})}return o(n,t),n.prototype.requiredPermission=["ticket.agent","ticket.customer"],n}(App.ControllerPermanent),App.Config.set("ticket/view",t,"Routes"),App.Config.set("ticket/view/:view",t,"Routes"),App.Config.set("TicketOverview",{controller:"TicketOverview",permission:["ticket.agent","ticket.customer"]},"permanentTask"),App.Config.set("TicketOverview",{prio:1e3,parent:"",name:"Overviews",target:"#ticket/view",key:"TicketOverview",permission:["ticket.agent","ticket.customer"],"class":"overviews"},"NavBar")}.call(this),function(){var t,l=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoom=function(t){function a(t){var e,n,i,s,r,o;this.taskReset=l(this.taskReset,this),this.taskUpdateAll=l(this.taskUpdateAll,this),this.taskUpdate=l(this.taskUpdate,this),this.taskGet=l(this.taskGet,this),this.reset=l(this.reset,this),this.submitPost=l(this.submitPost,this),this.submit=l(this.submit,this),this.submitEnable=l(this.submitEnable,this),this.submitDisable=l(this.submitDisable,this),this.ticketParams=l(this.ticketParams,this),this.markFormDiff=l(this.markFormDiff,this),this.formCurrent=l(this.formCurrent,this),this.currentStore=l(this.currentStore,this),this.markForm=l(this.markForm,this),this.autosaveStart=l(this.autosaveStart,this),this.autosaveStop=l(this.autosaveStop,this),this.scrollToBottom=l(this.scrollToBottom,this),this.scrollToArticle=l(this.scrollToArticle,this),this.render=l(this.render,this),this.positionPageHeaderUpdate=l(this.positionPageHeaderUpdate,this),this.positionPageHeaderStop=l(this.positionPageHeaderStop,this),this.positionPageHeaderStart=l(this.positionPageHeaderStart,this),this.articleNavigate=l(this.articleNavigate,this),
this.shortcutNavigationstop=l(this.shortcutNavigationstop,this),this.shortcutNavigationStart=l(this.shortcutNavigationStart,this),this.muteTask=l(this.muteTask,this),this.release=l(this.release,this),this.changed=l(this.changed,this),this.hide=l(this.hide,this),this.currentPosition=l(this.currentPosition,this),this.setPosition=l(this.setPosition,this),this.pagePosition=l(this.pagePosition,this),this.scrollToPosition=l(this.scrollToPosition,this),this.show=l(this.show,this),this.url=l(this.url,this),this.meta=l(this.meta,this),this.load=l(this.load,this),this.fetch=l(this.fetch,this),this.fetchMayBe=l(this.fetchMayBe,this),a.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),this.formMeta=void 0,this.ticket_id=t.ticket_id,this.article_id=t.article_id,this.sidebarState={},t.init?this.overview_id=void 0:this.overview_id=t.overview_id,this.key="ticket::"+this.ticket_id,(e=App.SessionStorage.get(this.key))&&this.load(e),n=function(){if(i.initFetched)return i.fetch(!0);i.fetch()},(i=this).interval(n,18e5,"pull_check"),this.bind("Ticket:update Ticket:touch",(s=this,function(t){if(t.id.toString()===s.ticket_id.toString())return s.fetchMayBe(t)})),this.bind("spool:sent",(r=this,function(){if(!r.initSpoolSent)return r.initSpoolSent=!0;r.fetch(!0)})),this.bind("ui::ticket::sidebarRerender",(o=this,function(t){if(t.taskKey===o.taskKey&&o.sidebarWidget)return o.sidebarWidget.render(o.formCurrent())}))}return e(a,t),a.include(App.TicketNavigable),a.prototype.elements={".main":"main",".ticketZoom":"ticketZoom",".scrollPageHeader":"scrollPageHeader"},a.prototype.events={"click .js-submit":"submit","click .js-bookmark":"bookmark","click .js-reset":"reset","click .main":"muteTask"},a.prototype.fetchMayBe=function(t){var e,n;if(this.ticketUpdatedAtLastCall){if(new Date(t.updated_at).getTime()===new Date(this.ticketUpdatedAtLastCall).getTime())return;if(new Date(t.updated_at).getTime()<new Date(this.ticketUpdatedAtLastCall).getTime())return}return this.ticketUpdatedAtLastCall=t.updated_at,e=function(){return n.fetch()},(n=this).delay(e,1e3,"ticket-zoom-"+this.ticket_id)},a.prototype.fetch=function(e){var t,s,n;if(null==e&&(e=!1),this.Session.get())return t=!1,this.initFetched||(t=!0),this.ajax({id:"ticket_zoom_"+this.ticket_id,type:"GET",url:this.apiPath+"/tickets/"+this.ticket_id+"?all=true",processData:!0,queue:t,success:(n=this,function(t){return n.load(t,e),App.SessionStorage.set(n.key,t)}),error:(s=this,function(t){var e,n,i;if(i=t.statusText,n=t.status,e=t.responseText,"abort"!==i){if(s.renderDone=!1,!s.ticketUpdatedAtLastCall||0!==n)return 401===n||"Unauthorized"===i?(s.taskHead="\xbb "+App.i18n.translateInline("Unauthorized")+" \xab",s.taskIconClass="diagonal-cross",s.renderScreenUnauthorized({objectName:"Ticket"})):404===n||"Not Found"===i?(s.taskHead="\xbb "+App.i18n.translateInline("Not Found")+" \xab",s.taskIconClass="diagonal-cross",s.renderScreenNotFound({objectName:"Ticket"})):(s.taskHead="\xbb "+App.i18n.translateInline("Error")+" \xab",s.taskIconClass="diagonal-cross",e||(e="General communication error, maybe internet is not available!"),s.renderScreenError({status:n,detail:e,objectName:"Ticket"}));console.log("network issues e. g. temp. no connection",n,i,e)}})})},a.prototype.load=function(t,e,n){var i;if(null==e&&(e=!1),null==n&&(n=!1),i=t.assets.Ticket[this.ticket_id],this.ticketUpdatedAtLastCall){if(e&&new Date(i.updated_at).getTime()===new Date(this.ticketUpdatedAtLastCall).getTime())return;if(new Date(i.updated_at).getTime()<new Date(this.ticketUpdatedAtLastCall).getTime())return;new Date(i.updated_at).getTime()>new Date(this.ticketUpdatedAtLastCall).getTime()&&(this.ticketUpdatedAtLastCall=i.updated_at)}else this.ticketUpdatedAtLastCall=i.updated_at;return this.initFetched&&i.updated_by_id!==this.Session.get("id")&&App.TaskManager.notify(this.taskKey),this.initFetched=!0,this.doNotLog||(this.doNotLog=1,this.recentView("Ticket",this.ticket_id)),this.ticket_article_ids=t.ticket_article_ids,this.links=t.links,this.tags=t.tags,this.formMeta=t.form_meta,App.Collection.loadAssets(t.assets,{targetModel:"Ticket"}),this.ticket=App.Ticket.fullLocal(this.ticket_id),this.ticket.article=void 0,this.render(n)},a.prototype.meta=function(){var t,e;return t={url:this.url(),id:this.ticket_id},this.taskIconClass&&(t.iconClass=this.taskIconClass),this.taskHead&&(t.head=this.taskHead),this.ticket_id&&App.Ticket.exists(this.ticket_id)&&(e=App.Ticket.findNative(this.ticket_id),t.head=e.title,t.title="#"+e.number+" - "+e.title,t["class"]="task-state-"+e.getState(),t.type="task",t.iconTitle=e.iconTitle(),t.iconClass=e.iconClass()),t},a.prototype.url=function(){return"#ticket/zoom/"+this.ticket_id},a.prototype.show=function(t){if(this.navupdate({url:"#",type:"menu"}),App.OnlineNotification.seen("Ticket",this.ticket_id),this.activeState&&this.ticket_article_ids&&(this.shown=!1),this.activeState=!0,this.pagePosition(t),this.positionPageHeaderStart(),this.autosaveStart(),this.shortcutNavigationStart(),this.attributeBar)return this.attributeBar.start()},a.prototype.scrollToPosition=function(t,e,n){var i,s;return i=function(){return"article"===t?(s.scrollToArticle(n),void s.positionPageHeaderUpdate()):(s.scrollToBottom(),s.positionPageHeaderUpdate())},(s=this).delay(i,e,"scrollToPosition")},a.prototype.pagePosition=function(t){var e;if(null==t&&(t={}),"init"!==t.type||this.shown)return t.article_id?(e=t.article_id,t.article_id=void 0):this.pagePositionData&&(e=this.pagePositionData,this.pagePositionData=void 0),this.shown?e&&e!==this.last_article_id?(this.last_article_id=e,void this.scrollToPosition("article",300,e)):void(this.last_ticket_article_ids&&_.isEqual(_.sortBy(this.last_ticket_article_ids),_.sortBy(this.ticket_article_ids))||(this.last_ticket_article_ids=this.ticket_article_ids,this.scrollToPosition("bottom",100,e))):(this.shown=!0,App.Event.trigger("ui::ticket::shown",{ticket_id:this.ticket_id}),void this.scrollToPosition("bottom",50,e))},a.prototype.setPosition=function(t){return this.$(".main").scrollTop(t)},a.prototype.currentPosition=function(){var t,e;return(t=this.$(".main .ticketZoom").offset())&&(e=t.top),Math.abs(e)},a.prototype.hide=function(){if(this.activeState=!1,$("body > .modal").modal("hide"),this.positionPageHeaderStop(),this.autosaveStop(),this.shortcutNavigationstop(),this.attributeBar)return this.attributeBar.stop()},a.prototype.changed=function(){var t,e,n;return!!this.ticket&&(t=this.formCurrent(),e=this.currentStore(),!(!(n=this.formDiff(t,e))||_.isEmpty(n))&&(!_.isEmpty(n.ticket)||!_.isEmpty(n.article)))},a.prototype.release=function(){return this.autosaveStop(),this.positionPageHeaderStop()},a.prototype.muteTask=function(){return App.TaskManager.mute(this.taskKey)},a.prototype.shortcutNavigationStart=function(){var t,e,n;return this.articlePager={article_id:void 0},t="alt+ctrl+left",$(document).bind("keydown.ticket_zoom"+this.ticket_id,t,(e=this,function(){return e.articleNavigate("up")})),t="alt+ctrl+right",$(document).bind("keydown.ticket_zoom"+this.ticket_id,t,(n=this,function(){return n.articleNavigate("down")}))},a.prototype.shortcutNavigationstop=function(){return $(document).unbind("keydown.ticket_zoom"+this.ticket_id)},a.prototype.articleNavigate=function(t){var e,r,n,i,s;for(r=[],this.$(".ticket-article .ticket-article-item").each(function(t,e){var n,i,s;return i=(n=$(e)).data("id"),s=n.visible(!0),r.push({article_id:i,visible:s})}),"up"===t&&(r=r.reverse()),i=void 0,n=0,s=r.length;n<s;n++){if(e=r[n],i)return this.scrollToArticle(e.article_id),void(this.articlePager.article_id=e.article_id);this.articlePager.article_id?this.articlePager.article_id===e.article_id&&(i=e.article_id):e.visible&&(i=e.article_id)}},a.prototype.positionPageHeaderStart=function(){return this.positionPageHeaderUpdate(),this.main.bind("scroll",this.positionPageHeaderUpdate)},a.prototype.positionPageHeaderStop=function(){return this.main.unbind("scroll",this.positionPageHeaderUpdate)},a.scrollHeaderPos=void 0,a.prototype.positionPageHeaderUpdate=function(){var t,e,n,i;if(t=this.scrollPageHeader.outerHeight(),n=this.main.prop("scrollHeight"),e=this.main.height(),i=this.main.scrollTop(),e+t<!n)this.scrollPageHeader.css("transform","translateY("+-t+"px)");else if(t<i&&(i=t),i!==this.scrollHeaderPos)return this.scrollPageHeader.css("transform","translateY("+(i-t)+"px)"),this.scrollHeaderPos=i},a.prototype.render=function(t){var e,n,i,s,r,o,a,l,c;if(App.TaskManager.touch(this.taskKey),!this.renderDone&&(this.renderDone=!0,this.autosaveLast={},i=$(App.view("ticket_zoom")({ticket:this.ticket,nav:this.nav,isCustomer:this.permissionCheck("ticket.customer"),scrollbarWidth:App.Utils.getScrollBarWidth(),dir:App.i18n.dir()})),new App.TicketZoomOverviewNavigator({el:i.find(".js-overviewNavigatorContainer"),ticket_id:this.ticket_id,overview_id:this.overview_id}),new App.TicketZoomTitle({object_id:this.ticket_id,overview_id:this.overview_id,el:i.find(".js-ticketTitleContainer"),taskKey:this.taskKey}),new App.TicketZoomMeta({object_id:this.ticket_id,el:i.find(".js-ticketMetaContainer")}),this.attributeBar=new App.TicketZoomAttributeBar({ticket:this.ticket,el:i.find(".js-attributeBar"),overview_id:this.overview_id,callback:this.submit,taskKey:this.taskKey}),this.form_id=this.taskGet("article").form_id||App.ControllerForm.formId(),this.articleNew=new App.TicketZoomArticleNew({ticket:this.ticket,ticket_id:this.ticket_id,el:i.find(".article-new"),formMeta:this.formMeta,form_id:this.form_id,defaults:this.taskGet("article"),taskKey:this.taskKey,ui:this,callbackFileUploadStart:this.submitDisable,callbackFileUploadStop:this.submitEnable}),this.highligher=new App.TicketZoomHighlighter({el:i.find(".js-highlighterContainer"),ticket_id:this.ticket_id}),new App.TicketZoomSetting({el:i.find(".js-settingContainer"),ticket_id:this.ticket_id}),this.articleView=new App.TicketZoomArticleView({ticket:this.ticket,el:i.find(".ticket-article"),ui:this,highligher:this.highligher,ticket_article_ids:this.ticket_article_ids,form_id:this.form_id}),new App.TicketCustomerAvatar({object_id:this.ticket_id,el:i.find(".ticketZoom-header")}),this.sidebarWidget=new App.TicketZoomSidebar({el:i,sidebarState:this.sidebarState,object_id:this.ticket_id,model:"Ticket",query:this.query,taskGet:this.taskGet,taskKey:this.taskKey,formMeta:this.formMeta,markForm:this.markForm,tags:this.tags,links:this.links}),!0===this.Config.get("ticket_auto_assignment")&&1===this.ticket.owner_id&&this.permissionCheck("ticket.agent")&&this.ticket.editable("full"))){for(a=this.Config.get("ticket_auto_assignment_user_ids_ignore")||[],_.isArray(a)||(a=[a]),l=!1,n=App.Session.get("id"),s=0,r=a.length;s<r;s++)if(a[s].toString()===n.toString()){l=!0;break}!1===l&&(o=this.Config.get("ticket_auto_assignment_selector"),App.Ticket.selector(this.ticket,o.condition)&&(e=function(){return c.ticket.owner_id=App.Session.get("id"),c.ticket.save()},(c=this).delay(e,800,"ticket-auto-assign-"+this.ticket.id)))}return i?this.html(i):this.articleView.execute({ticket_article_ids:this.ticket_article_ids}),this.sidebarWidget&&this.sidebarWidget.reload({tags:this.tags,links:this.links}),this.initDone?t?void 0:this.pagePosition({type:"init"}):(this.article_id&&(this.pagePositionData=this.article_id),this.pagePosition({type:"init"}),this.positionPageHeaderStart(),void(this.initDone=!0))},a.prototype.scrollToArticle=function(t){var e,n;if(e=document.getElementById("article-"+t))return n=e.offsetTop-100,this.main.animate({scrollTop:n},100)},a.prototype.scrollToBottom=function(){var t;if(t=0,t+=this.$(".ticketZoom-controls").height(),t+=this.$(".ticketZoom-header").height(),t+=this.$(".ticket-article").height(),!((t+=this.$(".article-new").height())<this.$(".main").height()))return this.main.scrollTop(this.main.prop("scrollHeight"));this.main.scrollTop(0)},a.prototype.autosaveStop=function(){return this.clearDelay("ticket-zoom-form-update"),this.autosaveLast={},this.el.off("change.local blur.local keyup.local paste.local input.local")},a.prototype.autosaveStart=function(){var t;return this.el.on("change.local blur.local keyup.local paste.local input.local","form, .js-textarea",(t=this,function(){return t.delay(t.markForm,250,"ticket-zoom-form-update")})),this.delay(this.markForm,800,"ticket-zoom-form-update")},a.prototype.markForm=function(t){var e,n,i,s;if(this.autosaveLast||(this.autosaveLast=this.taskGet()),this.ticket&&(e=this.formCurrent(),s=_.isEqual(e,this.autosaveLast),t||!s))return this.autosaveLast=clone(e),n=this.currentStore(),i=this.formDiff(e,n),this.setDefaultFollowUpState(i,n),this.markFormDiff(i),this.taskUpdateAll(i)},a.prototype.currentStore=function(){var t,e;if(this.ticket)return delete(e=this.ticket.attributes()).article,t={ticket:e,article:{to:"",cc:"",subject:"",type:"note",body:"",internal:this.Config.get("ui_ticket_zoom_article_note_new_internal"),in_reply_to:"",subtype:""}},this.permissionCheck("ticket.customer")&&(t.article.internal=""),t},a.prototype.setDefaultFollowUpState=function(t,e){var n;return this.isDefaultFollowUpStateSet&&!t.article.body?(this.$(".sidebar select[name=state_id]").val(e.ticket.state_id).trigger("change"),void(this.isDefaultFollowUpStateSet=!1)):t.article.body&&!t.ticket.state_id&&this.permissionCheck("ticket.customer")&&!(this.isDefaultFollowUpStateSet||this.ticket&&this.ticket.state_id&&(n=App.TicketState.findByAttribute("id",this.ticket.state_id))&&!0===n.default_create)?(this.isDefaultFollowUpStateSet=!0,(n=App.TicketState.findByAttribute("default_follow_up",!0))&&this.$(".sidebar[data-tab=ticket] select[name=state_id]").val(n.id).trigger("change"),!0):void 0},a.prototype.resetDefaultFollowUpState=function(){return this.isDefaultFollowUpStateSet=!1},a.prototype.formCurrent=function(){var t;return t={ticket:this.formParam(this.el.find(".edit")),article:this.articleNew.params()},0<this.$(".article-add .textBubble .attachments .attachment").length?t.article.attachments=!0:delete t.article.attachments,delete t.article.form_id,this.permissionCheck("ticket.customer")&&(t.article.internal=""),t},a.prototype.formDiff=function(t,e){var n,i,s;if(e.ticket)for(n in i=e.ticket)null==i[n]&&(e.ticket[n]="");if(t.ticket)for(n in s=t.ticket)null==s[n]&&(t.ticket[n]="");return{ticket:this.forRemoveMeta(App.Utils.formDiff(t.ticket,e.ticket)),article:this.forRemoveMeta(App.Utils.formDiff(t.article,e.article))}},a.prototype.forRemoveMeta=function(t){var e,n,i;for(e in null==t&&(t={}),n={},t)i=t[e],e.match(/_completion$/)||(n[e]=i);return n},a.prototype.markFormDiff=function(t){var e,n,i,s,r,o,a;if(null==t&&(t={}),o=this.$(".edit"),a=this.$('.tabsSidebar-tab[data-tab="ticket"]'),r=this.$(".js-reset"),(i={}).ticket=this.forRemoveMeta(this.ticketParams()),i.article=this.forRemoveMeta(this.articleNew.params()),_.isEmpty(t.ticket)&&_.isEmpty(t.article))return a.removeClass("is-changed"),o.removeClass("form-changed"),o.find(".form-group").removeClass("is-changed"),r.addClass("hide");for(e in o.addClass("form-changed"),_.isEmpty(t.ticket)?a.removeClass("is-changed"):a.addClass("is-changed"),s=i.ticket)s[e],(n=this.$('.edit [name="'+e+'"]').parents(".form-group")).get(0)||(n=this.$('.edit [data-name="'+e+'"]').parents(".form-group")),e in t.ticket?n.hasClass("is-changed")||n.addClass("is-changed"):n.hasClass("is-changed")&&n.removeClass("is-changed");return r.removeClass("hide")},a.prototype.ticketParams=function(){return this.formParam(this.$(".edit"))},a.prototype.submitDisable=function(t){if(!t)return this.formDisable(this.$(".js-submitDropdown"));this.formDisable(t)},a.prototype.submitEnable=function(t){if(!t)return this.formEnable(this.$(".js-submitDropdown"));this.formEnable(t)},a.prototype.submit=function(e,n){var t,i,s,r,o,a,l,c,p;if(null==n&&(n={}),e.stopPropagation(),e.preventDefault(),this.submitDisable(e),this.articleNew.validate()){for(o in l=this.ticketParams(),i=this.articleNew.params(),(a=App.Ticket.fullLocal(this.ticket_id)).article=void 0,l)p=l[o],a[o]=p;var u,h,d,f;if(n.perform&&App.Ticket.macro({macro:n.perform,ticket:a,article:i,callback:{tagAdd:(h=this,function(t){if(h.sidebarWidget&&h.sidebarWidget.reload)return h.sidebarWidget.reload({tagAdd:t,source:"macro"})}),tagRemove:(u=this,function(t){if(u.sidebarWidget&&u.sidebarWidget.reload)return u.sidebarWidget.reload({tagRemove:t})})}}),this.permissionCheck("ticket.customer")||a.owner_id||(a.owner_id=1),_.isEmpty(a.title)&&(a.title="-"),this.autosaveStop(),!n.perform&&(s=this.$(".edit").parent().get(0))&&s.reportValidity&&!s.reportValidity())return this.submitEnable(e),void this.autosaveStart();if(r=a.validate({screen:"edit"}))return this.log("error","update",r),this.formValidate({form:this.$(".edit"),errors:r,screen:"edit"}),this.submitEnable(e),void this.autosaveStart();if(i&&i.body){if((t=new App.TicketArticle).load(i),r=t.validate())return this.log("error","update article",r),this.formValidate({form:this.$(".article-add"),errors:r,screen:"edit"}),this.submitEnable(e),void this.autosaveStart();a.article=t}if(this.sidebarWidget&&this.sidebarWidget.postParams&&this.sidebarWidget.postParams({ticket:a}),a.article)if(!0===this.Config.get("time_accounting"))if(c=this.Config.get("time_accounting_selector"),App.Ticket.selector(a,c.condition))if(this.permissionCheck("ticket.customer"))this.submitPost(e,a,n);else return new App.TicketZoomTimeAccounting({container:this.el.closest(".content"),ticket:a,cancelCallback:(f=this,function(){return f.submitEnable(e)}),submitCallback:(d=this,function(t){return t.time_unit&&(a.article.time_unit=t.time_unit),d.submitPost(e,a,n)})});else this.submitPost(e,a,n);else this.submitPost(e,a,n);else this.submitPost(e,a,n)}else this.submitEnable(e)},a.prototype.submitPost=function(i,e,t){var n,s,r,o;return s=this.$(".js-secondaryActionButtonLabel").data("type"),t&&t.ux_flow_next_up&&(s=t.ux_flow_next_up),n=void 0,"closeNextInOverview"!==s&&"next_from_overview"!==s||(n=this.getNextTicketInOverview()),this.ajax({id:"ticket_update_"+e.id,type:"PUT",url:App.Ticket.url+"/"+e.id+"?all=true",data:JSON.stringify(e.attributes()),processData:!0,success:(o=this,function(t){return o.load(t,!0,!0),e.article=void 0,o.reset(),o.sidebarWidget&&o.sidebarWidget.commit(),"closeNextInOverview"===s||"next_from_overview"===s?(o.openTicketInOverview(n),void App.Event.trigger("overview:fetch")):"closeTab"===s||"next_task"===s?(App.Event.trigger("overview:fetch"),void o.taskCloseTicket(!0)):(o.autosaveStart(),o.muteTask(),o.submitEnable(i),o.scrollToPosition("bottom",50))}),error:(r=this,function(t,e){var n;return n=void 0,t&&t.responseJSON&&t.responseJSON.error&&(n=t.responseJSON.error),App.Event.trigger("notify",{type:"error",msg:App.i18n.translateContent(e.error_human||e.error||n||"Unable to update!"),timeout:2e3}),r.autosaveStart(),r.muteTask(),r.fetch(),r.submitEnable(i)})})},a.prototype.bookmark=function(t){return $(t.currentTarget).find(".bookmark.icon").toggleClass("filled")},a.prototype.reset=function(t){return t&&t.preventDefault(),this.taskReset(),this.resetDefaultFollowUpState(),App.Ajax.request({type:"DELETE",url:App.Config.get("api_path")+"/upload_caches/"+this.form_id,processData:!1}),this.$(".js-reset").addClass("hide"),App.Event.trigger("ui::ticket::taskReset",{ticket_id:this.ticket_id}),this.$('.tabsSidebar-tab[data-tab="ticket"]').removeClass("is-changed")},a.prototype.taskGet=function(t){return App.TaskManager.get(this.taskKey)?(this.localTaskData=App.TaskManager.get(this.taskKey).state||{},_.isObject(this.localTaskData.article)&&_.isArray(App.TaskManager.get(this.taskKey).attachments)&&(this.localTaskData.article.attachments=App.TaskManager.get(this.taskKey).attachments),t?(this.localTaskData[t]||(this.localTaskData[t]={}),this.localTaskData[t]):(this.localTaskData||(this.localTaskData={}),this.localTaskData)):{}},a.prototype.taskUpdate=function(t,e){return this.localTaskData[t]=e,App.TaskManager.update(this.taskKey,{state:this.localTaskData})},a.prototype.taskUpdateAll=function(t){return this.localTaskData=t,this.localTaskData.article.form_id=this.form_id,App.TaskManager.update(this.taskKey,{state:this.localTaskData})},a.prototype.taskReset=function(){return this.form_id=App.ControllerForm.formId(),this.articleNew.form_id=this.form_id,this.articleNew.render(),this.articleView.updateFormId(this.form_id),this.localTaskData={ticket:{},article:{}},App.TaskManager.update(this.taskKey,{state:this.localTaskData})},a}(App.Controller),t=function(t){function n(t){var e;n.__super__.constructor.apply(this,arguments),e={ticket_id:t.ticket_id,article_id:t.article_id,nav:t.nav,shown:!0},App.TaskManager.execute({key:"Ticket-"+this.ticket_id,controller:"TicketZoom",params:e,show:!0})}return e(n,t),n.prototype.requiredPermission=["ticket.agent","ticket.customer"],n}(App.ControllerPermanent),App.Config.set("ticket/zoom/:ticket_id",t,"Routes"),App.Config.set("ticket/zoom/:ticket_id/nav/:nav",t,"Routes"),App.Config.set("ticket/zoom/:ticket_id/:article_id",t,"Routes")}.call(this),function(){var t;t=function(){function t(){}return t.action=function(t,e,n,i){var s;return(s=this.isDeletable(t,e,n,i)).isDeletable&&(t.push({name:"delete",type:"delete",icon:"trash",href:"#"}),s.timeout&&i.delay(i.render,s.timeout,"actions-rerender")),t},t.isDeletable=function(t,e,n,i){var s;return this.deletableForAgent(t,e,n,i)?this.hasDeletableTimeframe()?(s=this.deletableTimeout(t,e,n,i))<=0?{isDeletable:!1}:{isDeletable:!0,timeout:s}:{isDeletable:!0}:{isDeletable:!1}},t.deletableTimeframeSetting=function(){return App.Config.get("ui_ticket_zoom_article_delete_timeframe")},t.hasDeletableTimeframe=function(){return this.deletableTimeframeSetting()&&0<this.deletableTimeframeSetting()},t.deletableTimeout=function(t,e,n){return 1e3*this.deletableTimeframeSetting()-(Date.parse(new Date)-Date.parse(n.created_at))},t.deletableForAgent=function(t,e,n,i){var s;return!!i.permissionCheck("ticket.agent")&&(n.created_by_id===(null!=(s=App.User.current())?s.id:void 0)&&!n.type.communication)},t.perform=function(t,e,n,i,s){var r;return"delete"!==e||(r=function(){return(i=App.TicketArticle.find(i.id)).destroy({fail:function(t,e){return s.log("errors",e),s.notify({type:"error",msg:App.i18n.translateContent(e.error_human||e.error||"Unable to delete article!"),timeout:6e3})}})},new App.ControllerConfirm({message:"Sure?",callback:r,container:s.el.closest(".content")})),!0},t}(),App.Config.set("900-Delete",t,"TicketZoomArticleAction")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.action=function(t,e,n,i){var s,r,o,a,l,c,p,u,h,d,f,m;if(!i.permissionCheck("ticket.agent"))return t;if(!e.group.email_address_id)return t;if("email"===n.type.name||"web"===n.type.name){for(t.push({name:"reply",type:"emailReply",icon:"reply",href:"#"}),m=[],"Customer"===n.sender.name&&n.from&&(h=emailAddresses.parseAddressList(n.from))&&(m=m.concat(h)),n.to&&(h=emailAddresses.parseAddressList(n.to))&&(m=m.concat(h)),n.cc&&(h=emailAddresses.parseAddressList(n.cc))&&(m=m.concat(h)),p=App.EmailAddress.all(),s=[],f={},r=0,a=m.length;r<a;r++)if(d=m[r],!_.isEmpty(d.address)&&!f[u=d.address.toString().toLowerCase()]){for(c=!(f[u]=!0),o=0,l=p.length;o<l;o++)u===p[o].email.toString().toLowerCase()&&(c=f[u]=!0);c||s.push(d)}1<s.length&&t.push({name:"reply all",type:"emailReplyAll",icon:"reply-all",href:"#"}),t.push({name:"forward",type:"emailForward",icon:"forward",href:"#"})}return"Customer"===n.sender.name&&"phone"===n.type.name&&(t.push({name:"reply",type:"emailReply",icon:"reply",href:"#"}),t.push({name:"forward",type:"emailForward",icon:"forward",href:"#"})),"Agent"===n.sender.name&&"phone"===n.type.name&&(t.push({name:"reply",type:"emailReply",icon:"reply",href:"#"}),t.push({name:"forward",type:"emailForward",icon:"forward",href:"#"})),t},e.perform=function(t,e,n,i,s){return"emailReply"!==e&&"emailReplyAll"!==e&&"emailForward"!==e||("emailReply"===e?this.emailReply(!1,n,i,s):"emailReplyAll"===e?this.emailReply(!0,n,i,s):"emailForward"===e&&this.emailForward(n,i,s)),!0},e.emailReply=function(t,e,n,i){var s,r,o,a,l,c,p;return null==t&&(t=!1),p=App.TicketArticleType.find(n.type_id),r=App.User.find(n.created_by_id),a=App.EmailAddress.all(),i.scrollToCompose(),s=App.Utils.getRecipientArticle(e,n,r,p,a,t),i.Config.get("ui_ticket_zoom_article_email_subject")&&(_.isEmpty(n.subject)?s.subject=e.title:s.subject=n.subject),o=i.el.closest(".ticketZoom").find('.article-add [data-name="body"]').html()||"",c="bottom",(l=App.ClipBoard.getSelected("html"))&&(l=App.Utils.htmlCleanup(l).html()),l||(l=App.ClipBoard.getSelected("text"))&&(l=App.Utils.textCleanup(l),l=App.Utils.text2html(l)),!l&&n&&App.Config.get("ui_ticket_zoom_article_email_full_quote")&&(c="top",n.content_type.match("html")&&(l=App.Utils.textCleanup(n.body)),n.content_type.match("plain")&&(l=App.Utils.textCleanup(n.body),l=App.Utils.text2html(l))),l&&(o=(l="<div><br><br/></div><div><blockquote type='cite'>"+this.replyQuoteHeader(n)+l+"<br></blockquote></div><div><br></div>")+o),s.body=o,p=App.TicketArticleType.findByAttribute({name:"email"}),s.subtype="reply",App.Event.trigger("ui::ticket::setArticleType",{ticket:e,type:p,article:s,signaturePosition:c}),!0},e.date_format=function(t){var e,n;n={weekday:"long",month:"long",day:"numeric",year:"numeric"},e=App.i18n.get()||"en-US";try{return new Date(t).toLocaleTimeString(e,n)}catch(i){return i,new Date(t).toLocaleTimeString("en-US",n)}},e.emailForward=function(e,n,i){var t,s,r,o;return i.scrollToCompose(),r="top",s="",n.content_type.match("html")&&(s=App.Utils.textCleanup(n.body)),n.content_type.match("plain")&&(s=App.Utils.textCleanup(n.body),s=App.Utils.text2html(s)),s='<br/><div>---Begin forwarded message:---<br/><br/></div><div><blockquote type="cite">'+App.FullQuoteHeader.fullQuoteHeaderForward(n)+s+"</blockquote></div><div><br></div>",(t={}).body=s,i.Config.get("ui_ticket_zoom_article_email_subject")&&(_.isEmpty(n.subject)?t.subject=e.title:t.subject=n.subject),o=App.TicketArticleType.findByAttribute({name:"email"}),t.subtype="forward",App.Event.trigger("ui::ticket::setArticleType",{ticket:e,type:o,article:t,signaturePosition:r,focus:"to"}),App.Ajax.request({id:"ticket_attachment_clone"+i.form_id,type:"POST",url:App.Config.get("api_path")+"/ticket_attachment_upload_clone_by_article/"+n.id,data:JSON.stringify({form_id:i.form_id}),processData:!0,success:function(t){if(!_.isEmpty(t.attachments))return App.Event.trigger("ui::ticket::addArticleAttachent",{ticket:e,article:n,attachments:t.attachments,form_id:i.form_id})}}),!0},e.articleTypes=function(t,e,n){var i;return n.permissionCheck("ticket.agent")&&e.group.email_address_id&&(i=["to","cc","subject"],n.Config.get("ui_ticket_zoom_article_email_subject")||(i=["to","cc"]),t.push({name:"email",icon:"email",attributes:i,internal:!1,features:["attachment","security"]})),t},e.setArticleTypePre=function(t,e,n){"email"!==t&&n.$("[data-name=body] [data-signature=true]").remove()},e.setArticleTypePost=function(t,e,n,i){var s,r,o,a,l,c,p,u;if("email"===t)return o=(u=App.Ticket.fullLocal(e.id)).group_id,(p=App.TaskManager.get(n.taskKey))&&p.state&&p.state.ticket&&p.state.ticket.group_id&&(o=p.state.ticket.group_id),a=void 0,(r=App.Group.find(o))&&r.signature_id&&(a=App.Signature.find(r.signature_id)),a&&a.body&&((c=n.$("[data-signature=true]").data("signature-id"))&&c.toString()!==a.id.toString()&&n.$('[data-name=body] [data-signature="true"]').remove(),l=App.Utils.replaceTags(a.body,{user:App.Session.get(),ticket:u,config:App.Config.all()}),s=n.$("[data-name=body]"),App.Utils.signatureCheck(s.html()||"",l)&&(App.Utils.htmlLastLineEmpty(s)||s.append("<br><br>"),a=$('<div data-signature="true" data-signature-id="'+a.id+'">'+l+"</div>"),App.Utils.htmlStrip(a),"top"===i?(s.prepend(a),s.prepend("<br>")):s.append(a),n.$("[data-name=body]").replaceWith(s))),App.Utils.htmlImage2DataUrlAsyncInline(n.$("[contenteditable=true]"))},e.validation=function(t,e,n){return"email"!==t||(_.isEmpty(e.to)&&_.isEmpty(e.cc)?(new App.ControllerModal({head:"Text missing",buttonCancel:"Cancel",buttonCancelClass:"btn--danger",buttonSubmit:!1,message:'Need recipient in "To" or "Cc".',shown:!0,small:!0,container:n.el.closest(".content")}),!1):!_.isEmpty(e.body)||(new App.ControllerModal({head:"Text missing",buttonCancel:"Cancel",buttonCancelClass:"btn--danger",buttonSubmit:!1,message:"Text needed",shown:!0,small:!0,container:n.el.closest(".content")}),!1))},e.replyQuoteHeader=function(t){var e,n;return App.Config.get("ui_ticket_zoom_article_email_full_quote_header")?(e=this.date_format(t.created_at),n=t.updated_by.displayName(),App.i18n.translateInline("On %s, %s wrote:",e,n)+"<br><br>"):""},e}(App.Controller),App.Config.set("200-EmailReply",t,"TicketZoomArticleAction")}.call(this),function(){var t;t=function(){function t(){}return t.action=function(t,e,n,i){return i.permissionCheck("ticket.customer")||"facebook feed post"!==n.type.name&&"facebook feed comment"!==n.type.name||t.push({name:"reply",type:"facebookFeedReply",icon:"reply",href:"#"}),t},t.perform=function(t,e,n,i,s){var r;return"facebookFeedReply"!==e||(s.scrollToCompose(),e=App.TicketArticleType.findByAttribute("name","facebook feed comment"),r={to:"",cc:"",body:"",in_reply_to:""},App.Event.trigger("ui::ticket::setArticleType",{ticket:n,type:e,article:r})),!0},t.articleTypes=function(t,e,n){return n.permissionCheck("ticket.agent")&&e&&e.create_article_type_id&&"facebook feed post"===App.TicketArticleType.find(e.create_article_type_id).name&&t.push({name:"facebook feed comment",icon:"facebook",attributes:[],internal:!1,features:[]}),t},t.params=function(t,e,n){return"facebook feed comment"===t&&(App.Utils.htmlRemoveRichtext(n.$("[data-name=body]"),!1),e.content_type="text/plain",e.body=App.Utils.html2text(e.body,!0)),e},t}(),App.Config.set("300-FacebookReply",t,"TicketZoomArticleAction")}.call(this),function(){var t;t=function(){function t(){}return t.action=function(t,e,n,i){return i.permissionCheck("ticket.customer")||(!0===n.internal?t.push({name:"set to public",type:"public",icon:"lock-open"}):t.push({name:"set to internal",type:"internal",icon:"lock"})),t},t.perform=function(t,e,n,i,s){var r;return"internal"!==e&&"public"!==e||((r=!0)===i.internal&&(r=!1),s.lastAttributres.internal=r,i.updateAttributes({internal:r}),r?t.addClass("is-internal"):t.removeClass("is-internal"),s.render()),!0},t}(),App.Config.set("100-Internal",t,"TicketZoomArticleAction")}.call(this),function(){var t;t=function(){function t(){}return t.action=function(t){return t},t.perform=function(){return!0},t.articleTypes=function(t,e,n){var i;return i=!1,n.permissionCheck("ticket.agent")&&(i=n.Config.get("ui_ticket_zoom_article_note_new_internal")),t.push({name:"note",icon:"note",attributes:[],internal:i,features:["attachment"]}),t},t}(),App.Config.set("100-Note",t,"TicketZoomArticleAction")}.call(this),function(){var t;t=function(){function t(){}return t.action=function(t){return t},t.perform=function(){return!0},t.articleTypes=function(t,e,n){return n.permissionCheck("ticket.agent")&&t.push({name:"phone",icon:"phone",attributes:[],internal:!1,features:["attachment"]}),t},t}(),App.Config.set("100-PhoneReply",t,"TicketZoomArticleAction")}.call(this),function(){var t;t=function(){function t(){}return t.action=function(t,e,n,i){return i.permissionCheck("ticket.customer")||"Customer"===n.sender.name&&"sms"===n.type.name&&t.push({name:"reply",type:"smsMessageReply",icon:"reply",href:"#"}),t},t.perform=function(t,e,n,i,s){var r;return"smsMessageReply"!==e||(s.scrollToCompose(),e=App.TicketArticleType.find(i.type_id),r={to:i.from,cc:"",body:"",in_reply_to:""},i.message_id&&(r.in_reply_to=i.message_id),r.body=s.el.closest(".ticketZoom").find('.article-add [data-name="body"]').html().trim()||"",App.Event.trigger("ui::ticket::setArticleType",{ticket:n,type:e,article:r,position:"end"})),!0},t.articleTypes=function(t,e,n){return n.permissionCheck("ticket.agent")&&e&&e.create_article_type_id&&("sms"!==App.TicketArticleType.find(e.create_article_type_id).name||t.push({name:"sms",icon:"sms",attributes:["to"],internal:!1,features:["body:limit"],maxTextLength:160,warningTextLength:30})),t},t.setArticleTypePost=function(t,e,n){var i,s;if("telegram personal-message"===t)return s=n.$("[data-name=body]").html(),(i=App.Utils.htmlRemoveRichtext(s))&&i.html()!==s?n.$("[data-name=body]").html(i):void 0},t.params=function(t,e,n){return"sms"===t&&(App.Utils.htmlRemoveRichtext(n.$("[data-name=body]"),!1),e.content_type="text/plain",e.body=App.Utils.html2text(e.body,!0)),e},t}(),App.Config.set("300-SmsReply",t,"TicketZoomArticleAction")}.call(this),function(){var t;t=function(){function t(){}return t.action=function(t,e,n,i){
return i.permissionCheck("ticket.customer")||t.push({name:"split",type:"split",icon:"split",href:"#ticket/create/"+n.ticket_id+"/"+n.id}),t},t.perform=function(t,e,n,i,s){return"split"!==e||s.navigate("#ticket/create/"+i.ticket_id+"/"+i.id),!0},t}(),App.Config.set("700-Split",t,"TicketZoomArticleAction")}.call(this),function(){var t;t=function(){function t(){}return t.action=function(t,e,n,i){return i.permissionCheck("ticket.customer")||"Customer"===n.sender.name&&"telegram personal-message"===n.type.name&&t.push({name:"reply",type:"telegramPersonalMessageReply",icon:"reply",href:"#"}),t},t.perform=function(t,e,n,i,s){var r;return"telegramPersonalMessageReply"!==e||(s.scrollToCompose(),e=App.TicketArticleType.find(i.type_id),r={to:"",cc:"",body:"",in_reply_to:""},i.message_id&&(r.in_reply_to=i.message_id),r.body=s.el.closest(".ticketZoom").find('.article-add [data-name="body"]').html().trim()||"",App.Event.trigger("ui::ticket::setArticleType",{ticket:n,type:e,article:r,position:"end"})),!0},t.articleTypes=function(t,e,n){return n.permissionCheck("ticket.agent")&&e&&e.create_article_type_id&&("telegram personal-message"!==App.TicketArticleType.find(e.create_article_type_id).name||t.push({name:"telegram personal-message",icon:"telegram",attributes:[],internal:!1,features:["attachment"],maxTextLength:1e4,warningTextLength:5e3})),t},t.setArticleTypePost=function(t,e,n){var i,s;if("telegram personal-message"===t)return s=n.$("[data-name=body]").html(),(i=App.Utils.htmlRemoveRichtext(s))&&i.html()!==s?n.$("[data-name=body]").html(i):void 0},t.params=function(t,e,n){return"telegram personal-message"===t&&(App.Utils.htmlRemoveRichtext(n.$("[data-name=body]"),!1),e.content_type="text/plain",e.body=App.Utils.html2text(e.body,!0)),e},t}(),App.Config.set("300-TelegramReply",t,"TicketZoomArticleAction")}.call(this),function(){var t;t=function(){function t(){}return t.action=function(t,e,n,i){return i.permissionCheck("ticket.customer")||("twitter status"===n.type.name&&t.push({name:"reply",type:"twitterStatusReply",icon:"reply",href:"#"}),"twitter direct-message"===n.type.name&&t.push({name:"reply",type:"twitterDirectMessageReply",icon:"reply",href:"#"})),t},t.perform=function(t,e,n,i,s){return"twitterStatusReply"!==e&&"twitterDirectMessageReply"!==e||("twitterStatusReply"===e?this.twitterStatusReply(n,i,s):"twitterDirectMessageReply"===e&&this.twitterDirectMessageReply(n,i,s)),!0},t.twitterStatusReply=function(t,e,n){var i,s,r,o,a,l,c,p,u,h;if(n.scrollToCompose(),h=App.TicketArticleType.find(e.type_id),i={to:"",cc:"",body:"",in_reply_to:""},e.message_id&&(i.in_reply_to=e.message_id),s=n.el.closest(".ticketZoom").find('.article-add [data-name="body"]').html().trim()||"",i.body=s,u=e.from,e.to&&(u&&(u+=", "),u+=e.to),u)for(p="",o=0,a=(c=u.split(",")).length;o<a;o++)(l=c[o])&&(l=l.trim().toLowerCase(),r=!1,s&&s.toLowerCase().match(l)&&(r=!0),l===("@"+t.preferences.channel_screen_name).toLowerCase()&&(r=!0),!1===r&&(""!==p&&(p+=" "),p+=l));return i.body=s?p+" "+s+"&nbsp;":p+"&nbsp;",App.Event.trigger("ui::ticket::setArticleType",{ticket:t,type:h,article:i,position:"end"})},t.twitterDirectMessageReply=function(t,e,n){var i,s,r,o;return o=App.TicketArticleType.find(e.type_id),r=App.TicketArticleSender.find(e.sender_id),s=App.User.find(e.created_by_id),n.scrollToCompose(),i={to:"",cc:"",body:"",in_reply_to:""},e.message_id&&(i.in_reply_to=e.message_id),"Agent"===r.name?i.to=e.to:i.to=e.from,!i.to&&s&&s.accounts&&(i.to=s.accounts.twitter.username||s.accounts.twitter.uid),App.Event.trigger("ui::ticket::setArticleType",{ticket:t,type:o,article:i})},t.articleTypes=function(t,e,n){var i,s;return n.permissionCheck("ticket.agent")&&e&&e.create_article_type_id&&("twitter status"===(i=App.TicketArticleType.find(e.create_article_type_id).name)?(s=["body:limit","body:initials"],n.Config.get("ui_ticket_zoom_article_twitter_initials")||(s=["body:limit"]),t.push({name:"twitter status",icon:"twitter",attributes:[],internal:!1,features:s,maxTextLength:280,warningTextLength:30})):"twitter direct-message"===i&&(s=["body:limit","body:initials"],n.Config.get("ui_ticket_zoom_article_twitter_initials")||(s=["body:limit"]),t.push({name:"twitter direct-message",icon:"twitter",attributes:["to"],internal:!1,features:s,maxTextLength:1e4,warningTextLength:500}))),t},t.validation=function(t,e,n){if("twitter status"===t&&n.maxTextLength-App.Utils.textLengthWithUrl(e.body)<0)return!1;if("twitter direct-message"===e.type){if(n.maxTextLength-App.Utils.textLengthWithUrl(e.body)<0)return!1;if(_.isEmpty(e.to))return new App.ControllerModal({head:"Text missing",buttonCancel:"Cancel",buttonCancelClass:"btn--danger",buttonSubmit:!1,message:'Need recipient in "To".',shown:!0,small:!0,container:n.el.closest(".content")}),!1}return!0},t.setArticleTypePost=function(t,e,n){var i,s;if("twitter status"===t||"twitter direct-message"===t)return s=n.$("[data-name=body]").html(),(i=App.Utils.htmlRemoveRichtext(s))&&i.html()!==s?n.$("[data-name=body]").html(i):void 0},t.params=function(t,e,n){return"twitter status"===t&&(App.Utils.htmlRemoveRichtext(n.$("[data-name=body]"),!1),e.content_type="text/plain",e.body=App.Utils.html2text(e.body,!0)),"twitter direct-message"===t&&(App.Utils.htmlRemoveRichtext(n.$("[data-name=body]"),!1),e.content_type="text/plain",e.body=App.Utils.html2text(e.body,!0)),e},t}(),App.Config.set("300-TwitterReply",t,"TicketZoomArticleAction")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoomArticleActions=function(t){function e(){this.scrollToCompose=n(this.scrollToCompose,this),this.actionPerform=n(this.actionPerform,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.events={"click .js-ArticleAction":"actionPerform"},e.prototype.render=function(){var t;return(t=this.actionRow(this.ticket,this.article))?this.html(App.view("ticket_zoom/article_view_actions")({article:this.article,actions:t})):this.html("")},e.prototype.actionRow=function(t,e){var n,i,s,r,o,a;for(n=App.Config.get("TicketZoomArticleAction"),i=[],r=0,a=(o=_.keys(n).sort()).length;r<a;r++)(s=n[o[r]])&&(i=s.action(i,t,e,this));return i},e.prototype.actionPerform=function(t){var e,n,i,s,r,o,a,l,c;for(t.preventDefault(),i=$(t.target).closest(".ticket-article-item"),c=$(t.currentTarget).attr("data-type"),l=App.Ticket.fullLocal(this.ticket.id),n=App.TicketArticle.fullLocal(this.article.id),e=App.Config.get("TicketZoomArticleAction"),[],r=0,a=(o=_.keys(e).sort()).length;r<a;r++)if((s=e[o[r]])&&!s.perform(i,c,l,n,this))return},e.prototype.scrollToCompose=function(){return this.el.closest(".content").find(".article-add").ScrollTo()},e}(App.Controller)}.call(this),function(){var s=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;App.TicketZoomArticleImageView=function(t){function i(){var e,n;this.onClose=s(this.onClose,this),this.onSubmit=s(this.onSubmit,this),i.__super__.constructor.apply(this,arguments),this.unbindAll(),$(document).bind("keydown.image_preview","right",(e=this,function(){var t;if(0!==(t=e.parentElement.closest(".attachment").next(".attachment.attachment--preview")).length)return e.close(),t.find("img").click()})),$(document).bind("keydown.image_preview","left",(n=this,function(){var t;if(0!==(t=n.parentElement.closest(".attachment").prev(".attachment.attachment--preview")).length)return n.close(),t.find("img").click()}))}return e(i,t),i.prototype.buttonClose=!0,i.prototype.buttonCancel=!0,i.prototype.buttonSubmit="Download",i.prototype.buttonClass="btn--success",i.prototype.head="",i.prototype.veryLarge=!0,i.prototype.events={"submit form":"submit","click .js-cancel":"cancel","click .js-close":"cancel"},i.prototype.content=function(){return this.image=this.image.replace(/view=preview/,"view=inline"),'<div class="centered imagePreview">'+this.image+"</div>"},i.prototype.onSubmit=function(){var t;return this.image=this.image.replace(/(\?|)view=(preview|inline)/,""),t=$(this.image).attr("src")+"?disposition=attachment",window.open(t,"_blank")},i.prototype.onClose=function(){return this.unbindAll()},i.prototype.unbindAll=function(){return $(document).unbind("keydown.image_preview")},i}(App.ControllerModal)}.call(this),function(){var u=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoomArticleNew=function(t){function p(){var t,e,n,i,s,l,r,o,a,c;if(this.bindAttachmentDelete=u(this.bindAttachmentDelete,this),this.renderAttachment=u(this.renderAttachment,this),this.onDragleave=u(this.onDragleave,this),this.onDragenter=u(this.onDragenter,this),this.closeTextarea=u(this.closeTextarea,this),this.openTextarea=u(this.openTextarea,this),this.updateInitials=u(this.updateInitials,this),this.updateLetterCount=u(this.updateLetterCount,this),this.setArticleTypePost=u(this.setArticleTypePost,this),this.updateSecurityOptions=u(this.updateSecurityOptions,this),this.setArticleTypePre=u(this.setArticleTypePre,this),this.setArticleInternal=u(this.setArticleInternal,this),this.hideSelectableArticleType=u(this.hideSelectableArticleType,this),this.selectArticleType=u(this.selectArticleType,this),this.showSelectableArticleType=u(this.showSelectableArticleType,this),this.validate=u(this.validate,this),this.params=u(this.params,this),this.release=u(this.release,this),this.setPossibleArticleTypes=u(this.setPossibleArticleTypes,this),p.__super__.constructor.apply(this,arguments),this.internalSelector=!0,this.type=this.defaults.type||"note",this.setPossibleArticleTypes(),this.permissionCheck("ticket.customer")&&(this.internalSelector=!1),this.textareaHeight={open:148,closed:20},this.dragEventCounter=0,this.attachments=[],this.render(),(this.defaults.body||this.isIE10())&&this.openTextarea(null,!0),_.isArray(this.defaults.attachments))for(e=0,n=(i=this.defaults.attachments).length;e<n;e++)t=i[e],this.renderAttachment(t);this.bind("ui::ticket::setArticleType",(s=this,function(t){var e,n,i;if(t.ticket.id.toString()===s.ticket_id.toString()){for(e in s.setArticleTypePre(t.type.name,t.signaturePosition),s.openTextarea(null,!0),n=t.article)i=n[e],"body"===e?s.$('[data-name="'+e+'"]').html(i):s.$('[name="'+e+'"]').val(i).trigger("change");if(s.setArticleTypePost(t.type.name,t.signaturePosition),t.focus)s.$('[name="'+t.focus+'"], [data-name="'+t.focus+'"]').focus().parent().find(".token-input").focus();else{if("end"!==t.position)return s.textarea.focus();s.placeCaretAtEnd(s.textarea.get(0))}}})),this.bind("ui::ticket::addArticleAttachent",(l=this,function(t){var e,n,i,s,r,o,a;if(((null!=(s=t.ticket)&&null!=(r=s.id)?r.toString():void 0)===l.ticket_id.toString()||t.form_id===l.form_id)&&!_.isEmpty(t.attachments)){for(a=[],n=0,i=(o=t.attachments).length;n<i;n++)e=o[n],a.push(l.renderAttachment(e));return a}})),this.bind("ui::ticket::taskReset",(r=this,function(t){if(t.ticket_id.toString()===r.ticket_id.toString())return r.type="note",r.defaults={},r.render()})),this.bind("ui::ticket::shown",(o=this,function(t){if(t.ticket_id.toString()===o.ticket.id.toString())return o.tokanice(o.type)})),this.bind("ui:rerender",(a=this,function(){return a.render()})),this.bind("ui::ticket::updateSecurityOptions",(c=this,function(t){if(t.taskKey===c.taskKey)return c.updateSecurityOptions()}))}return e(p,t),p.include(App.SecurityOptions),p.prototype.elements={".js-textarea":"textarea",".attachmentPlaceholder":"attachmentPlaceholder",".attachmentPlaceholder-inputHolder":"attachmentInputHolder",".attachmentPlaceholder-hint":"attachmentHint",".article-add":"articleNewEdit",".attachments":"attachmentsHolder",".attachmentUpload":"attachmentUpload",".attachmentUpload-progressBar":"progressBar",".js-percentage":"progressText",".js-cancel":"cancelContainer",".textBubble":"textBubble",".editControls-item":"editControlItem",".js-letterCount":"letterCount",".js-signature":"signature"},p.prototype.events={"click .js-toggleVisibility":"toggleVisibility","click .js-articleTypeItem":"selectArticleType","click .js-selectedArticleType":"showSelectableArticleType","click .js-mail-inputs":"stopPropagation","click .js-writeArea":"propagateOpenTextarea","click .list-entry-type div":"changeType","focus .js-textarea":"openTextarea","input .js-textarea":"updateLetterCount","click .js-active-toggle":"toggleButton"},p.prototype.tokanice=function(t){return null==t&&(t="email"),App.Utils.tokanice(".content.active .js-to, .js-cc, js-bcc",t)},p.prototype.setPossibleArticleTypes=function(){var t,e,n,i,s;for(this.articleTypes=[],s=[],e=0,n=(i=this.actions()).length;e<n;e++)(t=i[e])&&t.articleTypes?s.push(this.articleTypes=t.articleTypes(this.articleTypes,this.ticket,this)):s.push(void 0);return s},p.prototype.placeCaretAtEnd=function(t){var e,n,i;return t.focus(),"undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange?((e=document.createRange()).selectNodeContents(t),e.collapse(!1),(n=window.getSelection()).removeAllRanges(),void n.addRange(e)):"undefined"!=typeof document.body.createTextRange?((i=document.body.createTextRange()).moveToElementText(t),i.collapse(!1),i.select()):void 0},p.prototype.isIE10=function(){var t;return!!(t=App.Browser.detection()).browser&&("Explorer"===t.browser.name&&10===t.browser.major)},p.prototype.release=function(){return this.subscribeIdTextModule&&App.Ticket.unsubscribe(this.subscribeIdTextModule),this.releaseGlobalClickEvents()},p.prototype.releaseGlobalClickEvents=function(){return $(window).off("click.ticket-zoom-select-type"),$(window).off("click.ticket-zoom-textarea")},p.prototype.render=function(){var t,e,n,i;if(this.releaseGlobalClickEvents(),n=App.Ticket.fullLocal(this.ticket_id),this.html(App.view("ticket_zoom/article_new")({ticket:n,articleTypes:this.articleTypes,article:this.defaults,form_id:this.form_id,isCustomer:this.permissionCheck("ticket.customer"),internalSelector:this.internalSelector})),this.setArticleTypePre(this.type),this.setArticleTypePost(this.type),new App.WidgetAvatar({el:this.$(".js-avatar"),object_id:App.Session.get("id"),size:40,position:"right"}),this.tokanice(this.type),this.$('[data-name="body"]').ce({mode:"richtext",multiline:!0,maxlength:15e4}),html5Upload.initialize({uploadUrl:App.Config.get("api_path")+"/upload_caches/"+this.form_id,dropContainer:this.$(".article-add").get(0),cancelContainer:this.cancelContainer,inputField:this.$(".article-attachment input").get(0),key:"File",maxSimultaneousUploads:1,onFileAdded:(i=this,function(t){return t.on({onStart:function(){if(i.attachmentPlaceholder.addClass("hide"),i.attachmentUpload.removeClass("hide"),i.cancelContainer.removeClass("hide"),i.callbackFileUploadStart)return i.callbackFileUploadStart()},onAborted:function(){if(i.attachmentPlaceholder.removeClass("hide"),i.attachmentUpload.addClass("hide"),i.$(".article-attachment input").val(""),i.callbackFileUploadStop)return i.callbackFileUploadStop()},onCompleted:function(t){if(t=JSON.parse(t),i.attachments.push(t.data),i.attachmentPlaceholder.removeClass("hide"),i.attachmentUpload.addClass("hide"),i.progressBar.width(parseInt(0)+"%"),i.progressText.text(""),i.renderAttachment(t.data),i.$(".article-attachment input").val(""),i.callbackFileUploadStop)return i.callbackFileUploadStop()},onProgress:function(t){if(i.progressBar.width(parseInt(t)+"%"),i.progressText.text(parseInt(t)),90<=parseInt(t))return i.cancelContainer.addClass("hide")}})})}),this.bindAttachmentDelete(),!this.permissionCheck("ticket.customer")&&(e=new App.WidgetTextModule({el:this.$(".js-textarea").parent(),data:{ticket:n,user:App.Session.get(),config:App.Config.all()},taskKey:this.taskKey}),t=function(t){return e.reload({ticket:t,user:App.Session.get()})},!this.subscribeIdTextModule))return this.subscribeIdTextModule=n.subscribe(t)},p.prototype.params=function(){var t,e,n,i,s,r,o,a,l,c,p;for((o=this.formParam(this.$(".article-add"))).body&&(o.from=this.Session.get().displayName(),o.ticket_id=this.ticket_id,o.form_id=this.form_id,o.content_type="text/html",this.permissionCheck("ticket.customer")?(c=App.TicketArticleSender.findByAttribute("name","Customer"),p=App.TicketArticleType.findByAttribute("name","web"),o.type_id=p.id,o.sender_id=c.id):(c=App.TicketArticleSender.findByAttribute("name","Agent"),p=App.TicketArticleType.findByAttribute("name",o.type),o.sender_id=c.id,o.type_id=p.id)),o.internal?o.internal=!0:o.internal=!1,n=0,s=(a=this.actions()).length;n<s;n++)(e=a[n])&&e.params&&(o=e.params(o.type,o,this));for(i=0,r=(l=this.articleTypes).length;i<r;i++)if((t=l[i]).name===this.type&&_.contains(t.features,"body:initials")){"text/html"===o.content_type?o.body=o.body+"</br>"+this.signature.text():o.body=o.body+"\n"+this.signature.text();break}return this.securityOptionsShown()&&(o.preferences||(o.preferences={}),o.preferences.security=this.paramsSecurity()),o},p.prototype.validate=function(){var t,e,n,i,s,r,o;if(r=this.params(),t=this.$(".article-add .textBubble .attachments .attachment").length,!r.body&&0<t)return new App.ControllerModal({head:"Text missing",buttonCancel:"Cancel",buttonCancelClass:"btn--danger",buttonSubmit:!1,message:"Please fill also some text in!",shown:!0,small:!0,container:this.el.closest(".content")}),!1;if(r.body&&t<1&&(s=App.Utils.checkAttachmentReference(r.body))&&!confirm(App.i18n.translateContent("You use %s in text but no attachment is attached. Do you want to continue?",s)))return!1;for(n=0,i=(o=this.actions()).length;n<i;n++)if((e=o[n])&&e.validation&&!e.validation(r.type,r,this))return!1;return!0},p.prototype.changeType=function(t){return $(t.target).addClass("active").siblings(".active").removeClass("active")},p.prototype.toggleVisibility=function(t){return t.stopPropagation(),this.articleNewEdit.hasClass("is-public")?this.setArticleInternal(!0):this.setArticleInternal(!1)},p.prototype.showSelectableArticleType=function(t){return t.stopPropagation(),this.el.find(".js-articleTypes").removeClass("is-hidden"),$(window).on("click.ticket-zoom-select-type",this.hideSelectableArticleType)},p.prototype.selectArticleType=function(t){var e;return t.stopPropagation(),e=$(t.target).closest(".pop-selectable").data("value"),this.setArticleTypePre(e),this.hideSelectableArticleType(),this.setArticleTypePost(e),$(window).off("click.ticket-zoom-select-type"),this.tokanice(e)},p.prototype.hideSelectableArticleType=function(){return this.el.find(".js-articleTypes").addClass("is-hidden")},p.prototype.setArticleInternal=function(t){return!0===t?(this.articleNewEdit.removeClass("is-public").addClass("is-internal"),void this.$("[name=internal]").val("true")):(this.articleNewEdit.addClass("is-public").removeClass("is-internal"),this.$("[name=internal]").val(""))},p.prototype.setArticleTypePre=function(t,e){var n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T;if(null==e&&(e="bottom"),T=this.isScrolledToBottom(),t!==this.type)for(r=0,c=(v=["to","cc","bcc","subject","in_reply_to"]).length;r<c;r++)a=v[r],this.$("[name="+a+"]").val("").trigger("change");for(this.type=t,this.$("[name=type]").val(t).trigger("change"),this.articleNewEdit.attr("data-type",t),this.$(".js-selectableTypes").addClass("hide").filter("[data-type='"+t+"']").removeClass("hide"),this.setPossibleArticleTypes(),s={},o=0,p=(y=this.articleTypes).length;o<p;o++)(i=y[o]).name===t&&(s=i);for(s&&(s.internal?this.setArticleInternal(!0):this.setArticleInternal(!1)),this.maxTextLength=void 0,this.warningTextLength=void 0,l=0,u=(b=this.articleTypes).length;l<u;l++)if((n=b[l]).name===t){for(this.$(".form-group").addClass("hide"),f=0,h=(w=n.attributes).length;f<h;f++)g=w[f],this.$("[name="+g+"]").closest(".form-group").removeClass("hide");for(this.$(".article-attachment, .attachments, .js-textSizeLimit").addClass("hide"),m=0,d=(k=n.features).length;m<d;m++)"attachment"===(g=k[m])&&this.$(".article-attachment, .attachments").removeClass("hide"),"body:initials"===g&&this.updateInitials(),"body:limit"===g&&(this.maxTextLength=n.maxTextLength,this.warningTextLength=n.warningTextLength,this.delay(this.updateLetterCount,600),this.$(".js-textSizeLimit").removeClass("hide")),"security"===g&&this.securityEnabled()&&(this.securityOptionsShow(),this.$(".js-to, .js-cc").bind("change",function(t){return function(){return t.updateSecurityOptions()}}(this)),this.updateSecurityOptions())}if(this.$("[data-name=body] img").each(function(t,e){var n,i,s,r;if(r=(n=$(e)).attr("src"),!_.isEmpty(r)&&!r.match(/^data:image/i))return(i=document.createElement("canvas")).width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0),s=i.toDataURL(),n.attr("src",s)}),T)return this.scrollToBottom()},p.prototype.updateSecurityOptions=function(){return this.updateSecurityOptionsRemote(this.ticket.id,this.ui.ticketParams(),this.params(),this.paramsSecurity())},p.prototype.setArticleTypePost=function(t,e){var n,i,s,r,o;for(null==e&&(e="bottom"),o=[],n=0,i=(r=this.actions()).length;n<i;n++)(s=r[n])&&s.setArticleTypePost?o.push(s.setArticleTypePost(this.type,this.ticket,this,e)):o.push(void 0);return o},p.prototype.isScrolledToBottom=function(){return this.el.scrollParent().scrollTop()+this.el.scrollParent().height()===this.el.scrollParent().prop("scrollHeight")},p.prototype.scrollToBottom=function(){return this.el.scrollParent().scrollTop(this.el.scrollParent().prop("scrollHeight"))},p.prototype.propagateOpenTextarea=function(t){return t.stopPropagation(),this.textarea.focus()},p.prototype.updateLetterCount=function(){var t,e,n;if(this.maxTextLength&&this.warningTextLength)return e=this.params(),n=App.Utils.textLengthWithUrl(e.body),n=this.maxTextLength-n,t=function(){switch(!1){case!(n<0):return"label-danger";case!(n<this.warningTextLength):return"label-warning";default:return""}}.call(this),this.letterCount.text(n).removeClass("label-danger label-warning").addClass(t)},p.prototype.updateInitials=function(t){return void 0===t&&(t="/"+App.User.find(this.Session.get("id")).initials()),this.signature.text(t)},p.prototype.openTextarea=function(t,e){var n,i;if(t&&t.stopPropagation(),!this.articleNewEdit.hasClass("is-open"))return n=300,e&&(n=0),this.articleNewEdit.addClass("is-open"),this.textarea.velocity({properties:{minHeight:this.textareaHeight.open-38+"px"},options:{duration:n,easing:"easeOutQuad",complete:(i=this,function(){return $(window).on("click.ticket-zoom-textarea",i.closeTextarea)})}}),this.textBubble.velocity({properties:{paddingBottom:28},options:{duration:n,easing:"easeOutQuad"}}),this.textarea.velocity("scroll",{container:this.textarea.scrollParent(),offset:99999,duration:300,easing:"easeOutQuad",queue:!1}),this.editControlItem.removeClass("is-hidden").velocity({properties:{opacity:[1,0],translateX:[0,20],translateZ:0},options:{duration:300,stagger:50,drag:!0}}),this.attachmentPlaceholder.velocity({properties:{translateX:-this.attachmentInputHolder.position().left+"px"},options:{duration:n,easing:"easeOutQuad"}}),this.attachmentHint.velocity({properties:{opacity:0},options:{duration:n}})},p.prototype.closeTextarea=function(){if(!this.textarea.text().trim()&&!this.attachments.length&&!this.isIE10())return $(window).off("click.ticket-zoom-textarea"),this.textarea.velocity({properties:{minHeight:this.textareaHeight.closed+"px"},options:{duration:300,easing:"easeOutQuad",complete:(t=this,function(){return t.articleNewEdit.removeClass("is-open")})}}),this.textBubble.velocity({properties:{paddingBottom:10},options:{duration:300,easing:"easeOutQuad"}}),this.attachmentPlaceholder.velocity({properties:{translateX:0},options:{duration:300,easing:"easeOutQuad"}}),this.attachmentHint.velocity({properties:{opacity:1},options:{duration:300}}),this.editControlItem.velocity({properties:{opacity:[0,1],translateX:[20,0],translateZ:0},options:{duration:100,stagger:50,drag:!0,complete:function(t){return $(t).addClass("is-hidden")}}});var t},p.prototype.onDragenter=function(){return 0===this.dragEventCounter&&this.openTextarea(),this.dragEventCounter++,this.articleNewEdit.parent().addClass("is-dropTarget")},p.prototype.onDragleave=function(){if(this.dragEventCounter--,0===this.dragEventCounter)return this.articleNewEdit.parent().removeClass("is-dropTarget")},p.prototype.renderAttachment=function(t){return this.attachmentsHolder.append(App.view("generic/attachment_item")(t))},p.prototype.bindAttachmentDelete=function(){return this.attachmentsHolder.on("click",".js-delete",(i=this,function(t){var e,n;if(n=$(t.currentTarget).data("id"),i.attachments=_.filter(i.attachments,function(t){if(t.id.toString()!==n.toString())return t}),App.Ajax.request({type:"DELETE",url:App.Config.get("api_path")+"/upload_caches/"+i.form_id+"/items/"+n,processData:!1}),e=$(t.currentTarget).closest(".attachments"),$(t.currentTarget).closest(".attachment").remove(),0===e.find(".attachment").length)return e.empty()}));var i},p.prototype.actions=function(){var t,e,n,i,s,r;for(t=App.Config.get("TicketZoomArticleAction"),e=[],n=0,s=(i=_.keys(t).sort()).length;n<s;n++)(r=t[i[n]])&&e.push(r);return e},p.prototype.toggleButton=function(t){return this.$(t.currentTarget).toggleClass("btn--active")},p}(App.Controller)}.call(this),function(){var g,i=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;App.TicketZoomArticleView=function(t){function e(){this.ticketArticleInsertByIndex=i(this.ticketArticleInsertByIndex,this),this.run=i(this.run,this),this.execute=i(this.execute,this),e.__super__.constructor.apply(this,arguments),this.articleController={},this.run()}return s(e,t),e.prototype.execute=function(t){return this.ticket_article_ids=t.ticket_article_ids,this.run()},e.prototype.run=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m;for(t=[],o=a=0,c=(u=this.ticket_article_ids).length;a<c;o=++a)i=(m=u[o]).toString(),this.articleController[i]||(s=$("<div></div>"),this.articleController[i]=new g({ticket:this.ticket,object_id:m,el:s,ui:this.ui,highligher:this.highligher,form_id:this.form_id}),this.ticketArticleInsertByIndex(o,s)||t.push(s));for(e in this.el.append(t),f=[],h=this.articleController){for(n=h[e],r=!1,l=0,p=(d=this.ticket_article_ids).length;l<p;l++)d[l].toString()===e.toString()&&(r=!0);r?f.push(void 0):(n.remove(),f.push(delete this.articleController[e.toString()]))}return f},e.prototype.ticketArticleInsertByIndex=function(t,e){var n,i,s,r,o,a,l,c;if(!this.$(".ticket-article-item").length)return!1;for(s=r=a=t;a<=0?r<=0:0<=r;s=a<=0?++r:--r)if((i=this.ticket_article_ids[s])&&(n=this.$(".ticket-article-item[data-id="+i+"]")).length)return n.after(e),!0;for(s=o=l=t,c=this.ticket_article_ids.length-1;l<=c?o<=c:c<=o;s=l<=c?++o:--o)if((i=this.ticket_article_ids[s])&&(n=this.$(".ticket-article-item[data-id="+i+"]")).length)return n.before(e),!0;return!1},e.prototype.updateFormId=function(t){var e,n,i,s;for(e in i=[],n=this.articleController)s=n[e],i.push(s.updateFormId(t));return i},e}(App.Controller),g=function(t){function n(){var e;this.remove=i(this.remove,this),this.toggleMeta=i(this.toggleMeta,this),this.toggleMetaWithDelay=i(this.toggleMetaWithDelay,this),this.measureSeeMore=i(this.measureSeeMore,this),this.setSeeMore=i(this.setSeeMore,this),this.render=i(this.render,this),this.setHighlighter=i(this.setHighlighter,this),n.__super__.constructor.apply(this,arguments),this.seeMore=!1,this.bind("ui::ticket::shown",(e=this,function(t){if(t.ticket_id.toString()===e.ticket.id.toString())return e.setHighlighter(),e.setSeeMore()}))}return s(n,t),n.prototype.model="TicketArticle",n.prototype.observe={from:!0,to:!0,cc:!0,subject:!0,body:!0,internal:!0,preferences:!0},n.prototype.elements={".textBubble-content":"textBubbleContent",".textBubble-content img":"textBubbleImages",".textBubble-overflowContainer":"textBubbleOverflowContainer"},n.prototype.events={"click .article-meta-permanent":"toggleMetaWithDelay","click .textBubble":"toggleMetaWithDelay","click .textBubble a":"stopPropagation","click .js-toggleFold":"toggleFold","click .richtext-content img":"imageView","click .attachments img":"imageView","click .js-securityRetryProcess":"retrySecurityProcess"},n.prototype.setHighlighter=function(){var t,e;if(!this.el.is(":hidden"))return t=function(){return e.highligher.loadHighlights(e.object_id)},(e=this).delay(t,200)},n.prototype.render=function(t){var e,n,i,s,r,o,a,l,c,p,u,h;if(this.el.addClass("ticket-article-item "+t.sender.name.toLowerCase()),this.el.attr("data-id",t.id),this.el.attr("id","article-"+t.id),t.internal?this.el.addClass("is-internal"):this.el.removeClass("is-internal"),p=clone(t.preferences.links)||[],"email"===t.type.name&&(c={name:"Raw",url:this.Config.get("api_path")+"/ticket_article_plain/"+t.id,target:"_blank"},p.push(c)),i=App.TicketArticle.contentAttachments(t),t.attachments)for(a=0,l=(u=t.attachments).length;a<l;a++)o="","application/pdf"!==(null!=(n=u[a])?n.preferences["Content-Type"]:void 0)&&"text/html"!==(null!=n?n.preferences["Content-Type"]:void 0)&&(o="?disposition=attachment"),n.url=App.Config.get("api_path")+"/ticket_attachment/"+t.ticket_id+"/"+t.id+"/"+n.id+o,n.preview_url=App.Config.get("api_path")+"/ticket_attachment/"+t.ticket_id+"/"+t.id+"/"+n.id+"?view=preview",n&&n.preferences&&!0===n.preferences["original-format"]&&(c={url:App.Config.get("api_path")+"/ticket_attachment/"+t.ticket_id+"/"+t.id+"/"+n.id+"?disposition=attachment",name:"Original Formatting",target:"_blank"},p.push(c));if("text/html"===t.content_type?(s=t.body,t.preferences&&t.preferences.signature_detection?(h='<span class="js-signatureMarker"></span>',(s=(s=s.replace(h,"")).split("<br>")).splice(t.preferences.signature_detection,0,h),s=s.join("<br>")):s=App.Utils.signatureIdentifyByHtml(s),t.html=s):(r=App.Utils.text2html(t.body),t.html=App.Utils.signatureIdentifyByPlaintext(r),(t.html===r||t.preferences&&t.preferences.signature_detection<25)&&(h=!1,s=t.body,t.preferences&&t.preferences.signature_detection&&(h="########SIGNATURE########",(s=s.split("\n")).splice(t.preferences.signature_detection,0,h),s=s.join("\n")),h&&(s=App.Utils.textCleanup(s),t.html=App.Utils.text2html(s),t.html=t.html.replace(h,'<span class="js-signatureMarker"></span>')))),t.preferences.delivery_message)this.html(App.view("ticket_zoom/article_view_delivery_failed")({ticket:this.ticket,article:t,attachments:i,links:p}));else{var d;if("System"!==t.sender.name||"note"===t.type.name)return this.html(App.view("ticket_zoom/article_view")({ticket:this.ticket,article:t,attachments:App.view("generic/attachments")({attachments:i}),links:p})),new App.WidgetAvatar({el:this.$(".js-avatar"),object_id:t.origin_by_id||t.created_by_id,size:40}),this.articleActions=new App.TicketZoomArticleActions({el:this.$(".js-article-actions"),ticket:this.ticket,article:t,lastAttributres:this.lastAttributres,form_id:this.form_id}),this.shown=!1,e=function(){return d.setSeeMore()},(d=this).delay(e,50),this.setHighlighter();this.html(App.view("ticket_zoom/article_view_system")({ticket:this.ticket,article:t,attachments:i,links:p}))}},n.prototype.setSeeMore=function(){var n;if(!this.el.is(":hidden")&&!this.shown)return this.shown=!0,this.textBubbleImages.each((n=this,function(t,e){if(!e.complete)return $(e).one("load",n.measureSeeMore)})),this.measureSeeMore()},n.prototype.measureSeeMore=function(){var t,e,n,i,s,r,o,a,l;if(s=560,r=90,t=this.textBubbleContent,n=this.textBubbleOverflowContainer,!this.seeMore)return t.css("height",""),n.css("opacity",""),(l=t.find(".js-signatureMarker")).get(0)||(l=t.find("div [data-signature=true]")),(a=l.position())&&0===a.top&&(a=l.next("div, p, br").position()),e=t.height(),a&&(i=a.top),i&&i<s?((o=i+30)<r&&(o=r),t.attr("data-height",e+30),t.attr("data-height-origin",o),t.css("height",o+"px"),n.removeClass("hide")):s<e?(t.attr("data-height",e+30),t.attr("data-height-origin",s),t.css("height",s+"px"),n.removeClass("hide")):n.addClass("hide");t.css("height","auto")},n.prototype.retrySecurityProcess=function(t){var e,n,i;return t.preventDefault(),t.stopPropagation(),e=$(t.target).closest(".ticket-article-item").data("id"),this.ajax({id:"retrySecurityProcess",type:"POST",url:this.apiPath+"/ticket_articles/"+e+"/retry_security_process",processData:!0,success:(i=this,function(t){var e;return t.sign.success?i.notify({type:"success",msg:App.i18n.translateContent("Verify sign success!")}):t.sign.comment&&(
e=App.i18n.translateContent("Verify sign failed!")+" "+App.i18n.translateContent(t.sign.comment||""),i.notify({type:"error",msg:e,timeout:2e3})),t.encryption.success?i.notify({type:"success",msg:App.i18n.translateContent("Decryption success!")}):t.encryption.comment?(e=App.i18n.translateContent("Decryption failed!")+" "+App.i18n.translateContent(t.encryption.comment||""),i.notify({type:"error",msg:e,timeout:2e3})):void 0}),error:(n=this,function(){return n.notify({type:"error",msg:App.i18n.translateContent("Retry security process failed!")})})})},n.prototype.stopPropagation=function(t){return t.stopPropagation()},n.prototype.toggleMetaWithDelay=function(t){var e;return e=300,this.lastClick&&+new Date-this.lastClick<e?clearTimeout(this.toggleMetaTimeout):(this.toggleMetaTimeout=setTimeout(this.toggleMeta,e,t),this.lastClick=+new Date)},n.prototype.toggleMeta=function(t){var e,n,i,s,r,o;return t.preventDefault(),e=300,o=(n=$(t.target).closest(".ticket-article-item")).find(".article-meta-clip.top"),s=n.find(".article-meta-clip.bottom"),r=n.find(".article-content-meta.top"),i=n.find(".article-content-meta.bottom"),this.elementContainsSelection(n.get(0))?(this.stopPropagation(t),!1):r.hasClass("hide")?(n.addClass("state--folde-out"),i.removeClass("hide"),r.removeClass("hide"),n.velocity("scroll",{container:n.scrollParent(),offset:-n.offset().top+r.outerHeight(),duration:e,easing:"easeOutQuad"}),r.velocity({properties:{translateY:[0,r.outerHeight()],opacity:[1,0]},options:{speed:e,easing:"easeOutQuad"}}),i.velocity({properties:{translateY:[0,-i.outerHeight()],opacity:[1,0]},options:{speed:e,easing:"easeOutQuad"}}),o.velocity({height:r.outerHeight()},e,"easeOutQuad"),s.velocity({height:i.outerHeight()},e,"easeOutQuad")):(n.removeClass("state--folde-out"),n.velocity("scroll",{container:n.scrollParent(),offset:-n.offset().top-r.outerHeight(),duration:e,easing:"easeOutQuad"}),r.velocity({properties:{translateY:0,opacity:[0,1]},options:{speed:e,easing:"easeOutQuad",complete:function(){return r.addClass("hide")}}}),i.velocity({properties:{translateY:[-i.outerHeight(),0],opacity:[0,1]},options:{speed:e,easing:"easeOutQuad",complete:function(){return i.addClass("hide")}}}),o.velocity({height:0},e,"easeOutQuad"),s.velocity({height:0},e,"easeOutQuad"))},n.prototype.toggleFold=function(t){var e,n,i,s;return t.preventDefault(),t.stopPropagation(),e=this.textBubbleContent,n=this.textBubbleOverflowContainer,this.seeMoreOpen?(s=App.i18n.translateContent("See more"),i=e.attr("data-height-origin"),this.seeMoreOpen=!1):(s=App.i18n.translateContent("See less"),i=e.attr("data-height"),this.seeMoreOpen=!0),n.toggleClass("is-open",this.seeMoreOpen).find(".js-toggleFold").text(s),e.velocity({properties:{height:i},options:{duration:300}})},n.prototype.isOrContains=function(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1},n.prototype.elementContainsSelection=function(t){var e,n,i,s;if(0<(s=window.getSelection()).rangeCount&&s.toString()){for(e=n=0,i=s.rangeCount-1;0<=i?n<=i:i<=n;e=0<=i?++n:--n)if(!this.isOrContains(s.getRangeAt(e).commonAncestorContainer,t))return!1;return!0}return!1},n.prototype.remove=function(){return this.el.remove()},n.prototype.imageView=function(t){return t.preventDefault(),t.stopPropagation(),new App.TicketZoomArticleImageView({image:$(t.target).get(0).outerHTML,parentElement:$(t.currentTarget)})},n.prototype.updateFormId=function(t){var e;return null!=(e=this.articleActions)?e.form_id=t:void 0},n}(App.ObserverController)}.call(this),function(){var i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoomAttributeBar=function(t){function n(){var t,e;this.chooseSecondaryAction=i(this.chooseSecondaryAction,this),this.onActionMacroMouseLeave=i(this.onActionMacroMouseLeave,this),this.onActionMacroMouseEnter=i(this.onActionMacroMouseEnter,this),this.performTicketMacro=i(this.performTicketMacro,this),this.closeMacroMenu=i(this.closeMacroMenu,this),this.openMacroMenu=i(this.openMacroMenu,this),this.toggleMacroMenu=i(this.toggleMacroMenu,this),this.checkMacroChanges=i(this.checkMacroChanges,this),this.stop=i(this.stop,this),this.start=i(this.start,this),this.render=i(this.render,this),this.release=i(this.release,this),n.__super__.constructor.apply(this,arguments),this.secondaryAction="stayOnTab",this.subscribeId=App.Macro.subscribe(this.checkMacroChanges),this.render(),this.bind("ui:rerender",(t=this,function(){return t.render()})),this.bind("MacroPreconditionUpdate",(e=this,function(t){if(t.taskKey===e.taskKey)return e.searchCondition=t.params,e.render()}))}return e(n,t),n.prototype.elements={".js-submitDropdown":"buttonDropdown",".js-reset":"resetButton"},n.prototype.events={"mousedown .js-openDropdownMacro":"toggleMacroMenu","click .js-openDropdownMacro":"preventDefaultAndStopPropagation","mouseup .js-dropdownActionMacro":"performTicketMacro","mouseenter .js-dropdownActionMacro":"onActionMacroMouseEnter","mouseleave .js-dropdownActionMacro":"onActionMacroMouseLeave","click .js-secondaryAction":"chooseSecondaryAction"},n.prototype.searchCondition={},n.prototype.release=function(){return App.Macro.unsubscribe(this.subscribeId)},n.prototype.render=function(){var t,e,n,i,s,r,o;if(o=!1,this.resetButton.get(0)&&!this.resetButton.hasClass("hide")&&(o=!0),r=App.Macro.getList(),this.macroLastUpdated=App.Macro.lastUpdatedAt(),this.possibleMacros=[],_.isEmpty(r)||!this.permissionCheck("ticket.agent"))s=!0;else for(t=0,e=r.length;t<e;t++)i=r[t],(_.isEmpty(i.group_ids)||!this.searchCondition.group_id||_.includes(i.group_ids,parseInt(this.searchCondition.group_id)))&&this.possibleMacros.push(i);return n=$(App.view("ticket_zoom/attribute_bar")({macros:this.possibleMacros,macroDisabled:s,overview_id:this.overview_id,resetButtonShown:o})),this.setSecondaryAction(this.secondaryAction,n),this.permissionCheck("ticket.agent")&&(this.taskbarWatcher=new App.TaskbarWatcher({taskKey:this.taskKey,el:n.filter(".js-avatars")})),this.html(n)},n.prototype.start=function(){if(this.taskbarWatcher)return this.taskbarWatcher.start()},n.prototype.stop=function(){if(this.taskbarWatcher)return this.taskbarWatcher.stop()},n.prototype.checkMacroChanges=function(){if(App.Macro.lastUpdatedAt()!==this.macroLastUpdated)return this.render()},n.prototype.toggleMacroMenu=function(){if(!this.buttonDropdown.hasClass("is-open"))return this.openMacroMenu();this.closeMacroMenu()},n.prototype.openMacroMenu=function(){return this.buttonDropdown.addClass("is-open"),$(document).bind("click.buttonDropdown",this.closeMacroMenu)},n.prototype.closeMacroMenu=function(){return this.buttonDropdown.removeClass("is-open"),$(document).unbind("click.buttonDropdown")},n.prototype.performTicketMacro=function(t){var e,n;return n=$(t.currentTarget).data("id"),e=App.Macro.find(n),this.callback(t,e),this.closeMacroMenu()},n.prototype.onActionMacroMouseEnter=function(t){return this.$(t.currentTarget).addClass("is-active")},n.prototype.onActionMacroMouseLeave=function(t){return this.$(t.currentTarget).removeClass("is-active")},n.prototype.chooseSecondaryAction=function(t){var e;return e=$(t.currentTarget).find(".js-secondaryActionLabel").data("type"),this.setSecondaryAction(e,this.el)},n.prototype.setSecondaryAction=function(t,e){var n,i;return i=(n=e.find(".js-secondaryActionLabel[data-type="+t+"]")).text(),e.find(".js-secondaryAction .js-selectedIcon.is-selected").removeClass("is-selected"),n.closest(".js-secondaryAction").find(".js-selectedIcon").addClass("is-selected"),e.find(".js-secondaryActionButtonLabel").text(i),e.find(".js-secondaryActionButtonLabel").data("type",t)},n}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketCustomerAvatar=function(t){function e(){return this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.model="Ticket",e.prototype.observe={customer_id:!0},e.prototype.globalRerender=!1,e.prototype.render=function(t){return new App.WidgetAvatar({el:this.el.find(".js-avatar"),object_id:t.customer_id,size:50})},e}(App.ObserverController)}.call(this),function(){var t;t=function(){function t(){}return t.run=function(t,e,n,i,s,r){var o,a,l,c,p,u,h,d;if(r.formMeta&&r.formMeta.dependencies&&r.formMeta.dependencies[e.name]&&((o=r.formMeta.dependencies[e.name][parseInt(t[e.name])])||(o=r.formMeta.dependencies[e.name][t[e.name]]),o)){for(a in d=[],o){for(l=[],o[a]&&(l=o[a]),c=0,u=n.length;c<u;c++)(p=n[c]).name===a&&(p.filter={},p.filter[a]=l,p["default"]=t[p.name],p.newValue=t[p.name],h=r.formGenItem(p,i,s));h?d.push(s.find('[name="'+a+'"]').closest(".form-group").replaceWith(h)):d.push(void 0)}return d}},t}(),App.Config.set("100-ticketFormChanges",t,"TicketZoomFormHandler"),App.Config.set("100-ticketFormChanges",t,"TicketCreateFormHandler")}.call(this),function(){var t;t=function(){function t(){}return t.run=function(t,e,n,i,s,r){if("group_id"===e.name)return App.Event.trigger("MacroPreconditionUpdate",{taskKey:r.taskKey,params:t})},t}(),App.Config.set("120-ticketFormMacro",t,"TicketZoomFormHandler")}.call(this),function(){var t;t=function(){function t(){}return t.run=function(t,e,n,i,s,r){if("group_id"===e.name)return App.Event.trigger("ui::ticket::updateSecurityOptions",{taskKey:r.taskKey})},t}(),App.Config.set("140-ticketFormSecurityOptions",t,"TicketZoomFormHandler")}.call(this),function(){var t;t=function(){function t(){}return t.run=function(t,e,n,i,s,r){if("group_id"===e.name)return App.Event.trigger("TextModulePreconditionUpdate",{taskKey:r.taskKey,params:t})},t}(),App.Config.set("110-ticketFormTextModule",t,"TicketZoomFormHandler"),App.Config.set("110-ticketFormTextModule",t,"TicketCreateFormHandler")}.call(this),function(){var r=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoomHighlighter=function(t){function s(){var t,e,n,i;if(this.toggleHighlightAtSelection=r(this.toggleHighlightAtSelection,this),this.updateSelectedArticle=r(this.updateSelectedArticle,this),this.onMouseUp=r(this.onMouseUp,this),this.onMouseDown=r(this.onMouseDown,this),this.pickColor=r(this.pickColor,this),this.toggleHighlight=r(this.toggleHighlight,this),this.refreshObserver=r(this.refreshObserver,this),this.highlightDisable=r(this.highlightDisable,this),this.highlightEnable=r(this.highlightEnable,this),this.restoreOriginalHighlight=r(this.restoreOriginalHighlight,this),this.storeOriginalHighlight=r(this.storeOriginalHighlight,this),this.highlighterInstance=r(this.highlighterInstance,this),s.__super__.constructor.apply(this,arguments),this.permissionCheck("ticket.agent")){for(this.currentHighlights={},rangy.init(),this.highlighter=rangy.createHighlighter(document,"TextRange"),e=0,n=(i=this.colors).length;e<n;e++)t=i[e],this.addClassApplier(t);this.setColor(),this.render(),this.storeOriginalHighlight()}}return e(s,t),s.prototype.elements={".textBubble-content":"articles",".js-highlight-icon":"highlighterControl"},s.prototype.events={"click .js-highlight":"toggleHighlight","click .js-highlightColor":"pickColor"},s.prototype.colors=[{name:"Yellow",color:"#f7e7b2"},{name:"Green",color:"#bce7b6"},{name:"Blue",color:"#b3ddf9"},{name:"Pink",color:"#fea9c5"},{name:"Purple",color:"#eac5ee"}],s.prototype.activeColorIndex=0,s.prototype.highlightClassPrefix="highlight-",s.prototype.render=function(){return this.html(App.view("ticket_zoom/highlighter")({colors:this.colors,activeColorIndex:this.activeColorIndex}))},s.prototype.highlighterInstance=function(){return this.highlighter},s.prototype.storeOriginalHighlight=function(){return this.originalHighlight={fill:this.highlighterControl.css("fill"),opacity:this.highlighterControl.css("opacity")}},s.prototype.restoreOriginalHighlight=function(){if(this.originalHighlight)return this.highlighterControl.css("fill",this.originalHighlight.fill),this.highlighterControl.css("opacity",this.originalHighlight.opacity)},s.prototype.highlightEnable=function(){return this.isActive=!0,this.highlighterControl.css("opacity",1),this.highlighterControl.css("fill",this.activeColor),this.refreshObserver()},s.prototype.highlightDisable=function(){return this.isActive=!1,this.restoreOriginalHighlight(),this.el.closest(".content").find(".textBubble").removeAttr("data-highlightcolor"),this.refreshObserver()},s.prototype.refreshObserver=function(){var t;return(t=this.el.closest(".content").find(".textBubble-content")).off("mouseup",this.onMouseUp),t.on("mouseup",this.onMouseUp),t.off("mousedown",this.onMouseDown),t.on("mousedown",this.onMouseDown)},s.prototype.loadHighlights=function(t){var e;if(this.permissionCheck("ticket.agent")&&(e=App.TicketArticle.find(t)).preferences&&e.preferences.highlight&&!_.isEmpty(e.preferences.highlight)&&"type:TextRange"!==e.preferences.highlight&&this.currentHighlights[t]!==e.preferences.highlight)return this.currentHighlights[t]=e.preferences.highlight,this.highlighter.deserialize(e.preferences.highlight)},s.prototype.storeHighlights=function(t){var e,n,i,s,r,o,a,l;for(a="$article-content-"+t,l=[(r=(n=this.highlighter.serialize()).split("|")).shift()],i=0,o=r.length;i<o;i++)(s=r[i]).substr(s.length-a.length,s.length)===a&&l.push(s);return n=l.join("|"),(e=App.TicketArticle.find(t)).preferences.highlight=n,e.save()},s.prototype.addClassApplier=function(t){return this.highlighter.addClassApplier(rangy.createCssClassApplier(this.highlightClassPrefix+t.name))},s.prototype.setColor=function(){if(this.highlightClass=this.highlightClassPrefix+this.colors[this.activeColorIndex].name,this.activeColor=this.colors[this.activeColorIndex].color,this.isActive)return this.el.closest(".content").find(".textBubble").attr("data-highlightcolor",this.colors[this.activeColorIndex].name)},s.prototype.toggleHighlight=function(t){return this.mouseDownInside=!1,this.mouseUpInside=!1,this.isActive?($(t.currentTarget).removeClass("active"),this.highlightDisable()):(this.highlightEnable(),rangy.getSelection().isCollapsed?void 0:this.toggleHighlightAtSelection(this.content,this.article_id))},s.prototype.pickColor=function(t){return this.$(".js-highlightColor .is-selected").removeClass("is-selected"),$(t.currentTarget).find(".js-selectedIcon").addClass("is-selected"),this.activeColorIndex=$(t.currentTarget).attr("data-key"),this.setColor(),this.highlightEnable(),this.toggleHighlightAtSelection(this.content,this.article_id)},s.prototype.onMouseDown=function(t){return this.updateSelectedArticle(t)?this.mouseDownInside=!0:this.mouseDownInside=!1},s.prototype.onMouseUp=function(t){if(this.updateSelectedArticle(t)?this.mouseUpInside=!0:this.mouseUpInside=!1,this.mouseDownInside&&this.mouseUpInside&&this.isActive)return this.toggleHighlightAtSelection(this.content,this.article_id)},s.prototype.updateSelectedArticle=function(t){return this.content=$(t.currentTarget).closest(".textBubble-content"),this.article_id=this.content.data("id"),!!this.article_id||(this.content=$(t.currentTarget),this.article_id=this.content.data("id"),!!this.article_id)},s.prototype.toggleHighlightAtSelection=function(t,e){var n;return n=rangy.getSelection(),t.attr("data-highlightcolor",this.colors[this.activeColorIndex].name),this.highlighter.selectionOverlapsHighlight(n)?(console.log("SELECTION EXISTS, REMOVED IT"),this.highlighter.unhighlightSelection(),n.removeAllRanges(),this.highlightDisable(),void this.storeHighlights(e)):n&&0<n.rangeCount?(console.log("NEW SELECTION",n),this.highlighter.highlightSelection(this.highlightClass,{selection:n,containerElementId:t.get(0).id}),n.removeAllRanges(),this.highlightDisable(),this.storeHighlights(e)):void 0},s}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoomMeta=function(t){function e(){return this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.model="Ticket",e.prototype.observe={number:!0,created_at:!0,escalation_at:!0},e.prototype.render=function(t){return this.html(App.view("ticket_zoom/meta")({ticket:t,isCustomer:this.permissionCheck("ticket.customer")}))},e}(App.ObserverController)}.call(this),function(){var i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoomOverviewNavigator=function(t){function n(){var t,e;(this.open=i(this.open,this),this.render=i(this.render,this),this.release=i(this.release,this),n.__super__.constructor.apply(this,arguments),this.overview_id)&&(t=function(){return e.delay(e.render,2600,"overview-navigator")},(e=this).overview=App.Overview.find(this.overview_id),this.bindId=App.OverviewListCollection.bind(this.overview.link,t,!1),this.render())}return e(n,t),n.include(App.TicketNavigable),n.prototype.events={"click a":"open"},n.prototype.release=function(){return App.OverviewListCollection.unbind(this.bindId)},n.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p;if(this.overview_id){if(a=App.OverviewListCollection.get(this.overview.link)){for(s=i=e=!1,n=t=0,r=(c=a.tickets).length;n<r;n++)if(p=c[n],t+=1,i=a.tickets[t],s=a.tickets[t-2],p.id===this.ticket_id){e=!0;break}if(e)return i&&(o=App.Ticket.find(i.id)),s&&(l=App.Ticket.find(s.id)),this.html(App.view("ticket_zoom/overview_navigator")({title:a.overview.name,total_count:a.count,current_position:t,next:o,previous:l}));this.html("")}}else this.html("")},n.prototype.open=function(t){var e,n,i;if(t.preventDefault(),null!=(e=(n=$(t.target)).data("id")))i=n.attr("href");else{if(null==(e=n.closest("a").data("id")))return;i=n.closest("a").attr("href")}return this.taskOpenTicket(e,i)},n}(App.Controller)}.call(this),function(){var t;t=function(){function t(){}return t.run=function(t,e,n,i,s,r){var o,a;if("group_id"in t&&"owner_id"in t&&(a=_.find(n,function(t){return"owner_id"===t.name}))&&"possible_groups_owners"in a)return t.group_id?(a.relation="User",delete a.options):(a.options=a.possible_groups_owners,delete a.relation),a["default"]=t[a.name],a.newValue=t[a.name],o=r.formGenItem(a,i,s),s.find('select[name="owner_id"]').closest(".form-group").replaceWith(o)},t}(),App.Config.set("150-ticketFormChanges",t,"TicketZoomFormHandler")}.call(this),function(){var n,i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty,r=function(t,e){return function(){return t.apply(e,arguments)}};App.TicketZoomSetting=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.permissionCheck("admin")&&this.render()}return i(e,t),e.prototype.events={"click .js-setting":"show"},e.prototype.render=function(){return this.html(App.view("ticket_zoom/setting")())},e.prototype.show=function(){return new n},e}(App.Controller),n=function(t){function e(){this.post=r(this.post,this),this.render=r(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!1,e.prototype.head="Settings",e.prototype.render=function(){return e.__super__.render.apply(this,arguments)},e.prototype.post=function(){return new App.SettingsArea({area:"UI::TicketZoom",el:this.el.find(".modal-body")})},e.prototype.content=function(){return App.view("generic/page_loading")()},e}(App.ControllerModal)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoomSidebar=function(t){function e(){return this.render=n(this.render,this),this.postParams=n(this.postParams,this),this.commit=n(this.commit,this),this.reload=n(this.reload,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.model="Ticket",e.prototype.observe={customer_id:!0,organization_id:!0},e.prototype.reload=function(t){var e,n,i,s;for(n in s=[],i=this.sidebarBackends)(e=i[n])&&e.reload?s.push(e.reload(t)):s.push(void 0);return s},e.prototype.commit=function(t){var e,n,i,s;for(n in s=[],i=this.sidebarBackends)(e=i[n])&&e.commit?s.push(e.commit(t)):s.push(void 0);return s},e.prototype.postParams=function(t){var e,n,i,s;for(n in s=[],i=this.sidebarBackends)(e=i[n])&&e.postParams?s.push(e.postParams(t)):s.push(void 0);return s},e.prototype.render=function(t){var e,n,i,s,r;for(this.sidebarBackends||(this.sidebarBackends={}),this.sidebarItems=[],r=App.Config.get("TicketZoomSidebar"),e=0,s=(i=_.keys(r).sort()).length;e<s;e++)n=i[e],this.sidebarBackends[n]&&this.sidebarBackends[n].reload?this.sidebarBackends[n].reload({params:this.params,query:this.query,formMeta:this.formMeta,markForm:this.markForm,tags:this.tags,links:this.links}):this.sidebarBackends[n]=new r[n]({ticket:t,query:this.query,taskGet:this.taskGet,taskKey:this.taskKey,formMeta:this.formMeta,markForm:this.markForm,tags:this.tags,links:this.links}),this.sidebarItems.push(this.sidebarBackends[n]);return new App.Sidebar({el:this.el.find(".tabsSidebar"),sidebarState:this.sidebarState,items:this.sidebarItems})},e}(App.ObserverController)}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.showObjects=n(this.showObjects,this),this.sidebarItem=n(this.sidebarItem,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.sidebarItem=function(){if(this.Config.get("ui_ticket_zoom_sidebar_article_attachments"))return this.item={name:"attachment",badgeIcon:"paperclip",sidebarHead:"Attachments",sidebarCallback:this.showObjects,sidebarActions:[]},this.item},e.prototype.showObjects=function(t){var e,n,i,s,r,o,a,l;if(this.el=t,_.isEmpty(this.ticket)||_.isEmpty(this.ticket.article_ids))this.el.html("<div>"+App.i18n.translateInline("none")+"</div>");else{for(i="",r=s=0,o=(a=this.ticket.article_ids).length;s<o;r=++s)l=a[r],App.TicketArticle.exists(l)&&(e=App.TicketArticle.find(l),n=App.TicketArticle.contentAttachments(e),_.isEmpty(n)||(i=App.view("ticket_zoom/sidebar_article_attachment")({article:e,attachments:n})+i));return this.el.html(i),this.el.delegate(".js-attachments img","click",(c=this,function(t){return c.imageView(t)}));var c}},e.prototype.imageView=function(t){return t.preventDefault(),t.stopPropagation(),new App.TicketZoomArticleImageView({image:$(t.target).get(0).outerHTML})},e}(App.Controller),App.Config.set("900-ArticleAttachments",t,"TicketZoomSidebar")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.changeCustomer=n(this.changeCustomer,this),this.editCustomer=n(this.editCustomer,this),this.showCustomer=n(this.showCustomer,this),this.badgeRenderLocal=n(this.badgeRenderLocal,this),this.badgeRender=n(this.badgeRender,this),this.metaBadge=n(this.metaBadge,this),this.sidebarItem=n(this.sidebarItem,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.sidebarItem=function(){var t;if(this.permissionCheck("ticket.agent"))return this.item={name:"customer",badgeCallback:this.badgeRender,sidebarHead:"Customer",sidebarCallback:this.showCustomer,sidebarActions:[{title:"Change Customer",name:"customer-change",callback:this.changeCustomer}]},this.ticket&&1===this.ticket.customer_id||this.ticket.customer_id&&App.User.exists(this.ticket.customer_id)&&(null!=(t=App.User.find(this.ticket.customer_id))?t.isAccessibleBy(App.User.current(),"change"):void 0)&&this.item.sidebarActions.push({title:"Edit Customer",name:"customer-edit",callback:this.editCustomer}),this.item},e.prototype.metaBadge=function(t){var e,n;return n=e="",e=this.sidebarItemCounter(t),!0===this.Config.get("ui_sidebar_open_ticket_indicator_colored")&&(2===e&&(n="tabsSidebar-tab-count--warning"),3<e&&(n="tabsSidebar-tab-count--danger")),{name:"customer",icon:"person",counterPossible:!0,counter:e,cssClass:n}},e.prototype.badgeRender=function(t){var e;if(this.badgeEl=t,App.User.exists(this.ticket.customer_id))return e=App.User.find(this.ticket.customer_id),this.badgeRenderLocal(e)},e.prototype.badgeRenderLocal=function(t){return this.badgeEl.html(App.view("generic/sidebar_tabs_item")(this.metaBadge(t)))},e.prototype.sidebarItemCounter=function(t){var e;return e="",t&&t.preferences&&t.preferences.tickets_open&&(e=t.preferences.tickets_open),e},e.prototype.showCustomer=function(t){return this.elSidebar=t,new App.WidgetUser({el:this.elSidebar,user_id:this.ticket.customer_id,callback:this.badgeRenderLocal})},e.prototype.editCustomer=function(){return new App.ControllerGenericEdit({id:this.ticket.customer_id,genericObject:"User",screen:"edit",pageData:{title:"Users",object:"User",objects:"Users"},container:this.elSidebar.closest(".content")})},e.prototype.changeCustomer=function(){return new App.TicketCustomer({ticket_id:this.ticket.id,container:this.elSidebar.closest(".content")})},e}(App.Controller),App.Config.set("200-Customer",t,"TicketZoomSidebar")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.updateTicket=n(this.updateTicket,this),this.postParams=n(this.postParams,this),this["delete"]=n(this["delete"],this),this.reload=n(this.reload,this),this.showError=n(this.showError,this),this.showList=n(this.showList,this),this.showObjectsContent=n(this.showObjectsContent,this),this.showObjects=n(this.showObjects,this),this.changeObjects=n(this.changeObjects,this),this.sidebarItem=n(this.sidebarItem,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.sidebarItem=function(){if(this.Config.get("idoit_integration"))return this.item={name:"idoit",badgeIcon:"printer",sidebarHead:"i-doit",sidebarCallback:this.showObjects,sidebarActions:[{title:"Change Objects",name:"objects-change",callback:this.changeObjects}]},this.item},e.prototype.changeObjects=function(){return new App.IdoitObjectSelector({taskKey:this.taskKey,container:this.el.closest(".content"),callback:(n=this,function(t,e){return n.ticket&&n.ticket.id?(n.objectIds=n.objectIds.concat(t),void n.updateTicket(n.ticket.id,n.objectIds,function(){return e.close(),n.showObjectsContent(t)})):(e.close(),n.showObjectsContent(t))})});var n},e.prototype.showObjects=function(t){var e;return this.el=t,this.objectIds||(this.objectIds=[]),this.ticket&&this.ticket.preferences&&this.ticket.preferences.idoit&&this.ticket.preferences.idoit.object_ids&&(this.objectIds=this.ticket.preferences.idoit.object_ids),(e=this.queryParam())&&e.idoit_object_ids&&this.objectIds.push(e.idoit_object_ids),this.showObjectsContent()},e.prototype.showObjectsContent=function(t){var n,e;{if(t&&(this.objectIds=this.objectIds.concat(t)),!_.isEmpty(this.objectIds))return this.ajax({id:"idoit-"+this.taskKey,type:"POST",url:this.apiPath+"/integration/idoit",data:JSON.stringify({method:"cmdb.objects",filter:{ids:this.objectIds}}),success:(e=this,function(t){if(!t.response)return e.showError("Unable to load data...");e.showList(t.response.result)}),error:(n=this,function(t,e){if("abort"!==e)return n.showError("Unable to load data...")})});this.html("<div>"+App.i18n.translateInline("none")+"</div>")}},e.prototype.showList=function(t){var e,n;return(e=$(App.view("ticket_zoom/sidebar_idoit")({objects:t}))).delegate(".js-delete","click",(n=this,function(t){var e;return t.preventDefault(),e=$(t.currentTarget).attr("data-object-id"),n["delete"](e)})),this.html(e)},e.prototype.showError=function(t){return this.html(App.i18n.translateInline(t))},e.prototype.reload=function(){return this.showObjectsContent()},e.prototype["delete"]=function(t){var e,n,i,s,r;for(s=[],e=0,n=(r=this.objectIds).length;e<n;e++)i=r[e],t.toString()!==i.toString()&&s.push(i);return this.objectIds=s,this.ticket&&this.ticket.id&&this.updateTicket(this.ticket.id,this.objectIds),this.showObjectsContent()},e.prototype.postParams=function(t){var e,n;if(t.ticket&&!t.ticket.created_at&&this.objectIds&&!_.isEmpty(this.objectIds))return(e=t.ticket).preferences||(e.preferences={}),(n=t.ticket.preferences).idoit||(n.idoit={}),t.ticket.preferences.idoit.object_ids=this.objectIds},e.prototype.updateTicket=function(t,e,n){return App.Ajax.request({id:"idoit-update-"+t,type:"POST",url:this.apiPath+"/integration/idoit_ticket_update",data:JSON.stringify({ticket_id:t,object_ids:e}),success:function(){if(n)return n(e)},error:(i=this,function(t,e,n){if("abort"!==e)return i.log("errors",n),i.notify({type:"error",msg:App.i18n.translateContent(n.error_human||n.error||"Unable to update object!"),timeout:6e3})})});var i},e}(App.Controller),App.Config.set("500-Idoit",t,"TicketCreateSidebar"),App.Config.set("500-Idoit",t,"TicketZoomSidebar")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return this.editOrganization=n(this.editOrganization,this),this.showOrganization=n(this.showOrganization,this),this.sidebarItem=n(this.sidebarItem,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.sidebarItem=function(){if(this.permissionCheck("ticket.agent")&&this.ticket.organization_id)return this.item={name:"organization",badgeIcon:"group",sidebarHead:"Organization",sidebarCallback:this.showOrganization,sidebarActions:[{title:"Edit Organization",name:"organization-edit",callback:this.editOrganization}]},this.item},e.prototype.showOrganization=function(t){return this.elSidebar=t,new App.WidgetOrganization({el:this.elSidebar,organization_id:this.ticket.organization_id})},e.prototype.editOrganization=function(){return new App.ControllerGenericEdit({id:this.ticket.organization_id,genericObject:"Organization",pageData:{title:"Organizations",object:"Organization",objects:"Organizations"},container:this.elSidebar.closest(".content")})},e}(App.Controller),App.Config.set("300-Organization",t,"TicketZoomSidebar")}.call(this),function(){var i,t,s=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;i=function(t){function e(){return this.render=s(this.render,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.model="Ticket",e.prototype.observeNot={created_at:!0,updated_at:!0},e.prototype.globalRerender=!1,e.prototype.render=function(e){var t,n,i,s,r,o;if(delete(t=e.attributes()).article,n=App.Group.find(t.group_id).follow_up_possible,r=App.TicketState.find(t.state_id).name,s=this.taskGet("ticket"),i=this.Config.get("TicketZoomFormHandler"),_.isEmpty(s)||(t=_.extend(t,s)),"new_ticket"===n&&"closed"!==r||"new_ticket"!==n||this.permissionCheck("admin")||this.permissionCheck("ticket.agent")?new App.ControllerForm({elReplace:this.el,model:App.Ticket,screen:"edit",handlersConfig:i,filter:this.formMeta.filter,formMeta:this.formMeta,params:t,isDisabled:!e.editable(),taskKey:this.taskKey}):new App.ControllerForm({elReplace:this.el,model:App.Ticket,screen:"edit",handlersConfig:i,filter:this.formMeta.filter,formMeta:this.formMeta,params:t,isDisabled:e.editable(),taskKey:this.taskKey}),this.markForm(!0),!this.resetBind)return this.resetBind=!0,this.bind("ui::ticket::taskReset"
,(o=this,function(t){if(t.ticket_id.toString()===e.id.toString())return o.render(e)}))},e}(App.ObserverController),t=function(t){function n(){var e;this.changeCustomer=s(this.changeCustomer,this),this.showTicketMerge=s(this.showTicketMerge,this),this.showTicketHistory=s(this.showTicketHistory,this),this.editTicket=s(this.editTicket,this),this.reload=s(this.reload,this),this.sidebarItem=s(this.sidebarItem,this),n.__super__.constructor.apply(this,arguments),this.bind("config_update_local",(e=this,function(t){return e.configUpdated(t)}))}return r(n,t),n.prototype.configUpdated=function(t){if("kb_active"===t.name&&!t.value)return this.editTicket(this.el)},n.prototype.sidebarItem=function(){return this.item={name:"ticket",badgeIcon:"message",sidebarHead:"Ticket",sidebarCallback:this.editTicket},this.permissionCheck("ticket.agent")&&(this.item.sidebarActions=[{title:"History",name:"ticket-history",callback:this.showTicketHistory},{title:"Merge",name:"ticket-merge",callback:this.showTicketMerge},{title:"Change Customer",name:"customer-change",callback:this.changeCustomer}]),this.item},n.prototype.reload=function(t){if(this.tagWidget&&(t.tags&&this.tagWidget.reload(t.tags),t.tagAdd&&this.tagWidget.add(t.tagAdd,t.source),t.tagRemove&&this.tagWidget.remove(t.tagRemove)),this.linkWidget&&t.links&&this.linkWidget.reload(t.links),this.linkKbAnswerWidget&&t.links)return this.linkKbAnswerWidget.reload(t.links)},n.prototype.editTicket=function(t){var e;return this.el=t,e=$(App.view("ticket_zoom/sidebar_ticket")()),this.edit=new i({object_id:this.ticket.id,el:e.find(".edit"),taskGet:this.taskGet,formMeta:this.formMeta,markForm:this.markForm,taskKey:this.taskKey}),this.permissionCheck("ticket.agent")&&(this.tagWidget=new App.WidgetTag({el:e.filter(".tags"),object_type:"Ticket",object:this.ticket,tags:this.tags}),this.linkWidget=new App.WidgetLink.Ticket({el:e.filter(".links"),object_type:"Ticket",object:this.ticket,links:this.links}),this.permissionCheck("knowledge_base.*")&&App.Config.get("kb_active")&&(this.linkKbAnswerWidget=new App.WidgetLinkKbAnswer({el:e.filter(".link_kb_answers"),object_type:"Ticket",object:this.ticket,links:this.links})),this.timeUnitWidget=new App.TicketZoomTimeUnit({el:e.filter(".js-timeUnit"),object_id:this.ticket.id})),this.html(e)},n.prototype.showTicketHistory=function(){return new App.TicketHistory({ticket_id:this.ticket.id,container:this.el.closest(".content")})},n.prototype.showTicketMerge=function(){return new App.TicketMerge({ticket:this.ticket,taskKey:this.taskKey,container:this.el.closest(".content")})},n.prototype.changeCustomer=function(){return new App.TicketCustomer({ticket_id:this.ticket.id,container:this.el.closest(".content")})},n}(App.Controller),App.Config.set("100-TicketEdit",t,"TicketZoomSidebar")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TaskbarWatcher=function(t){function e(){this.stop=n(this.stop,this),this.start=n(this.start,this),this.render=n(this.render,this),this.release=n(this.release,this),e.__super__.constructor.apply(this,arguments),this.subscribeId=App.TaskManager.preferencesSubscribe(this.taskKey,this.render),App.TaskManager.preferencesTrigger(this.taskKey)}return i(e,t),e.prototype.release=function(){if(this.subscribeId)return App.TaskManager.preferencesUnsubscribe(this.subscribeId)},e.prototype.render=function(t){var e,n,i,s,r,o,a,l,c,p,u,h;if(t&&t.tasks){for(i=App.Session.get("id"),s=0,o=(l=t.tasks).length;s<o;s++)(h=l[s]).user_id!==i&&h.last_contact&&(h.idle=!1,3e5<(new Date).getTime()-new Date(h.last_contact).getTime()&&(h.idle=!0));if(this.diffrence(this.lastTasks,t.tasks)){for(this.lastTasks=clone(t.tasks),[],this.el.empty(),p=[],r=0,a=(c=t.tasks).length;r<a;r++)(h=c[r]).user_id!==i?(n=[],h.idle&&n.push("avatar--idle"),h.changed?n.push("avatar--changed"):n.push("avatar--not-changed"),this.el.append('<div class="js-avatar"></div>'),this.el.append('<div class="half-spacer"></div>'),e=new App.WidgetAvatar({el:this.el.find(".js-avatar").last(),object_id:h.user_id,size:40,cssClass:n.join(" ")}),h.changed?((u=$('<div class="avatar-status"></div>')).append(App.Utils.icon("pen")),p.push(e.el.find(".avatar").append(u))):p.push(void 0)):p.push(void 0);return p}}},e.prototype.start=function(){return this.intervalId=this.interval((t=this,function(){return App.TaskManager.preferencesTrigger(t.taskKey)}),3e5,"ticket-watcher-interval");var t},e.prototype.stop=function(){if(this.intervalId)return this.clearInterval(this.intervalId)},e.prototype.diffrence=function(t,e){var n;if(!t)return!0;if(t.length!==e.length)return!0;for(n in t){if(!t[n]||!e[n])return!0;if(t[n].user_id!==e[n].user_id)return!0;if(t[n].changed!==e[n].changed)return!0;if(t[n].idle!==e[n].idle)return!0}return!1},e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoomTimeAccounting=function(t){function e(){return this.onSubmit=n(this.onSubmit,this),this.onCancel=n(this.onCancel,this),this.skip=n(this.skip,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!1,e.prototype.buttonSubmit="Account Time",e.prototype.buttonClass="btn--success",e.prototype.leftButtons=[{className:"btn--text btn--subtle js-skip",text:"skip"}],e.prototype.head="Time Accounting",e.prototype.small=!0,e.prototype.events={"submit form":"submit","click .js-submit:not(.is-disabled)":"submit","click .js-cancel":"cancel","click .js-close":"cancel","click .js-skip":"skip"},e.prototype.content=function(){return App.view("ticket_zoom/time_accounting")()},e.prototype.skip=function(t){if(this.submitCallback)return this.submitCallback({}),this.close(t)},e.prototype.onCancel=function(){if(this.cancelCallback)return this.cancelCallback()},e.prototype.onClose=function(){if(this.cancelCallback)return this.cancelCallback()},e.prototype.onSubmit=function(){var t;if(this.$('[name="time_unit"]').removeClass("has-error"),!((t=this.formParams()).time_unit&&(t.time_unit=t.time_unit.replace(",","."),isNaN(parseFloat(t.time_unit))||t.time_unit.match(/[A-z]|\s/))))return this.close(),this.submitCallback?this.submitCallback(t):void 0;this.$('[name="time_unit"]').addClass("has-error")},e}(App.ControllerModal)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoomTimeUnit=function(t){function e(){return this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.model="Ticket",e.prototype.observe={time_unit:!0},e.prototype.render=function(t){if(this.permissionCheck("ticket.agent")&&t.time_unit)return this.html(App.view("ticket_zoom/time_unit")({ticket:t}))},e}(App.ObserverController)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketZoomTitle=function(t){function e(){return this.update=n(this.update,this),this.renderPost=n(this.renderPost,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.model="Ticket",e.prototype.template="ticket_zoom/title",e.prototype.observe={title:!0},e.prototype.globalRerender=!1,e.prototype.events={"blur .js-objectTitle":"update"},e.prototype.renderPost=function(){return this.$(".js-objectTitle").ce({mode:"textonly",multiline:!1,maxlength:250})},e.prototype.update=function(t){var e,n;if((n=$(t.target).ceg()||"")!==this.lastAttributres.title)return(e=App.Ticket.find(this.object_id)).title=n,e.article=void 0,e.save(),App.TaskManager.mute(this.taskKey),App.TaskManager.touch(this.taskKey),App.Event.trigger("overview:fetch")},e}(App.ObserverController)}.call(this),function(){var u,h,d,t,s=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function i(){var t,e,n;this.setMonth=s(this.setMonth,this),this.setYear=s(this.setYear,this),this.setTimeAccounting=s(this.setTimeAccounting,this),this.setFilter=s(this.setFilter,this),this.render=s(this.render,this),this.release=s(this.release,this),i.__super__.constructor.apply(this,arguments),(t=new Date).getDate(),e=t.getMonth()+1,n=t.getFullYear(),t.getWeek(),this.month||(this.month=e),this.year||(this.year=n),this.subscribeId=App.Setting.subscribe(this.render,{initFetch:!0,clear:!1})}return n(i,t),i.prototype.requiredPermission="admin.time_accounting",i.prototype.header="Time Accounting",i.prototype.events={"change .js-timeAccountingSetting input":"setTimeAccounting","click .js-timePickerYear":"setYear","click .js-timePickerMonth":"setMonth","click .js-timeAccountingFilter":"setFilter","click .js-timeAccountingFilterReset":"resetFilter"},i.prototype.elements={".js-timeAccountingSetting input":"timeAccountingSetting"},i.prototype.release=function(){return App.Setting.unsubscribe(this.subscribeId)},i.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p;for(e=this.Config.get("time_accounting")||!1,this.lastNewTagSetting=e,c=[],s=i=o=(p=(new Date).getFullYear())-2,a=p;o<=a?i<=a:a<=i;s=o<=a?++i:--i)r={display:s,value:s},c.push(r);return l=[{display:"Jan",value:1},{display:"Feb",value:2},{display:"Mar",value:3},{display:"Apr",value:4},{display:"May",value:5},{display:"Jun",value:6},{display:"Jul",value:7},{display:"Aug",value:8},{display:"Sep",value:9},{display:"Oct",value:10},{display:"Nov",value:11},{display:"Dec",value:12}],this.html(App.view("time_accounting/index")({timeRangeYear:c,timeRangeMonth:l,year:this.year,month:this.month,apiPath:this.apiPath})),t=[{name:"condition",display:"Conditions for effected objects",tag:"ticket_selector","null":!1,preview:!1,action:!1,hasChanged:!1}],n=App.Setting.get("time_accounting_selector"),this.filter=new App.ControllerForm({el:this.$(".js-selector"),model:{configure_attributes:t},params:n,autofocus:!0}),new d({el:this.$(".js-tableTicket"),year:this.year,month:this.month}),new u({el:this.$(".js-tableCustomer"),year:this.year,month:this.month}),new h({el:this.$(".js-tableOrganization"),year:this.year,month:this.month})},i.prototype.setFilter=function(t){var e;return t.preventDefault(),e=this.formParam(this.filter.form),App.Setting.set("time_accounting_selector",e,{notify:!0})},i.prototype.resetFilter=function(t){return t.preventDefault(),App.Setting.set("time_accounting_selector",{},{notify:!0})},i.prototype.setTimeAccounting=function(){var t;return t=this.timeAccountingSetting.prop("checked"),App.Setting.set("time_accounting",t)},i.prototype.setYear=function(t){return t.preventDefault(),this.year=$(t.target).data("type"),this.render()},i.prototype.setMonth=function(t){return t.preventDefault(),this.month=$(t.target).data("type"),this.render()},i}(App.ControllerSubContent),d=function(t){function e(){this.render=s(this.render,this),this.load=s(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return n(e,t),e.prototype.load=function(){return this.ajax({id:"by_ticket",type:"GET",url:this.apiPath+"/time_accounting/log/by_ticket/"+this.year+"/"+this.month,processData:!0,success:(e=this,function(t){return e.render(t)})});var e},e.prototype.render=function(t){return this.html(App.view("time_accounting/by_ticket")({rows:t}))},e}(App.Controller),u=function(t){function e(){this.render=s(this.render,this),this.load=s(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return n(e,t),e.prototype.load=function(){return this.ajax({id:"by_customer",type:"GET",url:this.apiPath+"/time_accounting/log/by_customer/"+this.year+"/"+this.month,processData:!0,success:(e=this,function(t){return e.render(t)})});var e},e.prototype.render=function(t){return this.html(App.view("time_accounting/by_customer")({rows:t}))},e}(App.Controller),h=function(t){function e(){this.render=s(this.render,this),this.load=s(this.load,this),e.__super__.constructor.apply(this,arguments),this.load()}return n(e,t),e.prototype.load=function(){return this.ajax({id:"by_organization",type:"GET",url:this.apiPath+"/time_accounting/log/by_organization/"+this.year+"/"+this.month,processData:!0,success:(e=this,function(t){return e.render(t)})});var e},e.prototype.render=function(t){return this.html(App.view("time_accounting/by_organization")({rows:t}))},e}(App.Controller),App.Config.set("TimeAccounting",{prio:8500,name:"Time Accounting",parent:"#manage",target:"#manage/time_accounting",controller:t,permission:["admin.time_accounting"]},"NavBarAdmin")}.call(this),function(){var t,a,l,s=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function i(){var t,e,n;this.getAttributes=s(this.getAttributes,this),this.updateOnServer=s(this.updateOnServer,this),this._syncChanges=s(this._syncChanges,this),this.syncChanges=s(this.syncChanges,this),this.resetChanges=s(this.resetChanges,this),this.pushChanges=s(this.pushChanges,this),this.toggleAction=s(this.toggleAction,this),this.hideAction=s(this.hideAction,this),this.showAction=s(this.showAction,this),this.rerender=s(this.rerender,this),this.release=s(this.release,this),this.hide=s(this.hide,this),this.show=s(this.show,this),this.load=s(this.load,this),this.render=s(this.render,this),i.__super__.constructor.apply(this,arguments),this.locale=App.i18n.get(),this.render(),this.bind("i18n:translation_update_todo",(t=this,function(){return t.load("i18n:translation_update_todo")})),this.bind("i18n:translation_update_list",(e=this,function(){return e.load("i18n:translation_update_list")})),this.bind("i18n:translation_update",(n=this,function(){return n.load()}))}return n(i,t),i.prototype.requiredPermission="admin.translation",i.prototype.header="Translations",i.prototype.events={"click .js-pushChanges":"pushChanges","click .js-resetChanges":"resetChanges","click .js-syncChanges":"syncChanges"},i.prototype.render=function(){var t,e,n,i,s;for(s=App.Locale.all(),t=this.locale,e=0,n=s.length;e<n;e++)(i=s[e]).locale===this.locale&&(t=i.name);return this.html(App.view("translation/index")({currentLanguage:t})),this.load("render")},i.prototype.load=function(r){return this.ajax({id:"translations_admin",type:"GET",url:this.apiPath+"/translations/admin/lang/"+this.locale,processData:!0,success:(o=this,function(t){var e,n,i,s;for(o.times=[],o.stringsNotTranslated=[],o.stringsTranslated=[],e=0,i=(s=t.list).length;e<i;e++)"time"===(n=s[e])[4]?o.times.push(n):""===n[2]?o.stringsNotTranslated.push(n):o.stringsTranslated.push(n);return o.translationToDo&&"render"!==r||(o.translationToDo=new l({el:o.$(".js-ToDo"),locale:o.locale,updateOnServer:o.updateOnServer,getAttributes:o.getAttributes})),r&&"i18n:translation_update_todo"!==r&&"render"!==r||o.translationToDo.update({stringsNotTranslated:o.stringsNotTranslated,stringsTranslated:o.stringsTranslated,times:o.times}),o.translationList&&"render"!==r||(o.translationList=new a({el:o.$(".js-List"),locale:o.locale,updateOnServer:o.updateOnServer,getAttributes:o.getAttributes})),r&&"i18n:translation_update_list"!==r&&"render"!==r||o.translationList.update({stringsNotTranslated:o.stringsNotTranslated,stringsTranslated:o.stringsTranslated,times:o.times}),o.toggleAction()})});var o},i.prototype.show=function(){if(this.untranslatedAtLastRender||(this.untranslatedAtLastRender=$.extend({},App.i18n.getNotTranslated(this.locale))),!_.isEqual(this.untranslatedAtLastRender,App.i18n.getNotTranslated(this.locale)))return this.untranslatedAtLastRender=$.extend({},App.i18n.getNotTranslated(this.locale)),App.Event.trigger("ui:rerender")},i.prototype.hide=function(){return this.rerender()},i.prototype.release=function(){return this.rerender()},i.prototype.rerender=function(){var t;if(t=function(){return App.Event.trigger("ui:rerender")},this.translationList&&this.translationList.changes())return App.Delay.set(t,400)},i.prototype.showAction=function(){return this.$(".js-changes").removeClass("hidden")},i.prototype.hideAction=function(){return this.el.closest(".content").find(".js-changes").addClass("hidden")},i.prototype.toggleAction=function(){return 0<this.$(".js-Reset:visible").length?this.showAction():this.hideAction()},i.prototype.pushChanges=function(){return this.loader=new App.ControllerModalLoading({head:"Push my changes",message:"Pushing translations to i18n.zammad.com",container:this.el.closest(".content")}),this.ajax({id:"translations",type:"PUT",url:this.apiPath+"/translations/push",data:JSON.stringify({locale:this.locale}),processData:!1,success:(e=this,function(){return e.loader.update("Thanks for contributing!"),e.loader.hideIcon(),e.loader.hide(2)}),error:(t=this,function(){return t.loader.hide()})});var t,e},i.prototype.resetChanges=function(){return this.loader=new App.ControllerModalLoading({head:"Reset changes",message:"Reseting changes...",container:this.el.closest(".content")}),this.ajax({id:"translations",type:"POST",url:this.apiPath+"/translations/reset",data:JSON.stringify({locale:this.locale}),processData:!1,success:(e=this,function(){return App.Event.trigger("i18n:translation_update"),e.hideAction(),e.loader.hide()}),error:(t=this,function(){return t.loader.hide()})});var t,e},i.prototype.syncChanges=function(){var t,e,n,i;return this.loader=new App.ControllerModalLoading({head:App.i18n.translateContent("Get latest translations"),message:App.i18n.translateContent("Getting latest translations from i18n.zammad.com"),container:this.el.closest(".content")}),i=this,t=function(){return App.Event.trigger("i18n:translation_update"),i.hideAction(),i.loader.hide(1)},e=(n=App.Locale.all()).shift(),this._syncChanges(e,n,this.loader,t)},i.prototype._syncChanges=function(t,e,n,i){return this.ajax({id:"translations",type:"GET",url:this.apiPath+"/translations/sync/"+t.locale,processData:!1,success:(s=this,function(){if(n.update(t.name,!1),t=e.shift())return s._syncChanges(t,e,n,i);i()}),error:function(){return i()}});var s},i.prototype.updateOnServer=function(t,e){var n,i,s;return App.i18n.get()===t.locale&&App.i18n.setMap(t.source,t.target,t.format),delete t.field,t.id?(n=""===t.target?"DELETE":"PUT",i=this.apiPath+"/translations/"+t.id):(n="POST",i=this.apiPath+"/translations"),this.ajax({id:"translations",type:n,url:i,data:JSON.stringify(t),processData:!1,success:(s=this,function(){return e&&App.Event.trigger(e),s.toggleAction()})})},i.prototype.getAttributes=function(t){var e;return{id:(e=$(t.target).closest("tr").find(".js-Item")).data("id"),source:e.data("source"),format:e.data("format")||"string",initial:e.data("initial")||"",target:e.val(),locale:this.locale,field:e}},i}(App.ControllerSubContent),l=function(t){function e(){this.same=s(this.same,this),this.create=s(this.create,this),this.render=s(this.render,this),this.update=s(this.update,this),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.events={"click .js-create":"create","click .js-theSame":"same"},e.prototype.update=function(t){var e,n;for(e in t)n=t[e],this[e]=n;return this.render()},e.prototype.render=function(){var t,e,n,i,s,r,o;if(App.i18n.getNotTranslated(this.locale)||!_.isEmpty(this.stringsNotTranslated)){if(App.i18n.getNotTranslated(this.locale))for(i in r=App.i18n.getNotTranslated(this.locale)){for(r[i],t=!1,e=0,s=(o=this.stringsNotTranslated).length;e<s;e++)i===o[e][1]&&(t=!0);t||(n=["",i,"",""],this.stringsNotTranslated.push(n))}return this.html(App.view("translation/todo")({list:this.stringsNotTranslated}))}this.html("")},e.prototype.create=function(t){var e;if(t.preventDefault(),(e=this.getAttributes(t)).target)return $(t.target).closest("tr").remove(),App.i18n.removeNotTranslated(e.locale,e.source),e.target_initial="",this.updateOnServer(e,"i18n:translation_update_list")},e.prototype.same=function(t){var e;return t.preventDefault(),this.hasChanges=!0,e=this.getAttributes(t),$(t.target).closest("tr").remove(),App.i18n.removeNotTranslated(e.locale,e.source),e.target_initial="",e.target=e.source,this.updateOnServer(e,"i18n:translation_update_list")},e}(App.Controller),a=function(t){function e(){this.updateRow=s(this.updateRow,this),this.changes=s(this.changes,this),this.render=s(this.render,this),this.update=s(this.update,this),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.hasChanges=!1,e.prototype.events={"blur .js-translated input":"updateItem","click .js-translated .js-Reset":"resetItem"},e.prototype.update=function(t){var e,n;for(e in t)n=t[e],this[e]=n;return this.render()},e.prototype.render=function(){if(!_.isEmpty(this.stringsTranslated)||!_.isEmpty(this.times))return this.html(App.view("translation/list")({times:this.times,strings:this.stringsTranslated,notSourceTranslation:App.i18n.notTranslatedFeatureEnabled(this.locale)}))},e.prototype.changes=function(){return this.hasChanges},e.prototype.resetItem=function(t){var e;return t.preventDefault(),this.hasChanges=!0,(e=this.getAttributes(t)).target=e.initial,this.updateOnServer(e,"i18n:translation_update")},e.prototype.updateItem=function(t){var e;if(t.preventDefault(),this.hasChanges=!0,(e=this.getAttributes(t)).target)return this.updateRow(e.id),this.updateOnServer(e)},e.prototype.updateRow=function(t){var e,n,i,s;return e=(n=this.$("[data-id="+t+"]")).val(),i=n.data("initial"),s=n.closest("tr").find(".js-Reset"),e!==i?(this.changesAvailable=!0,s.removeClass("hidden"),s.closest("tr").addClass("warning")):(s.addClass("hidden"),s.closest("tr").removeClass("warning"))},e}(App.Controller),App.Config.set("Translation",{prio:1800,parent:"#system",name:"Translations",target:"#system/translation",controller:t,permission:["admin.translation"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.genericController=new App.ControllerGenericIndex({el:this.el,id:this.id,genericObject:"Trigger",defaultSortBy:"name",pageData:{home:"triggers",object:"Trigger",objects:"Triggers",navupdate:"#triggers",notes:["Triggers are ..."],buttons:[{name:"New Trigger","data-type":"new","class":"btn--success"}]},container:this.el.closest(".content"),veryLarge:!0})}return n(e,t),e.prototype.requiredPermission="admin.trigger",e.prototype.header="Triggers",e}(App.ControllerSubContent),App.Config.set("Trigger",{prio:3300,name:"Trigger",parent:"#manage",target:"#manage/trigger",controller:t,permission:["admin.trigger"]},"NavBarAdmin")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UserHistory=function(t){function e(){return this.fetch=n(this.fetch,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.fetch=function(){return this.ajax({id:"user_history",type:"GET",url:this.apiPath+"/users/history/"+this.user_id,success:(e=this,function(t){return App.Collection.loadAssets(t.assets),e.items=t.history,e.render()})});var e},e}(App.GenericHistory)}.call(this),function(){var n,i,s,t,r,o=function(t,e){return function(){return t.apply(e,arguments)}},a=function(t,e){function n(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l={}.hasOwnProperty;App.UserProfile=function(t){function e(t){this.currentPosition=o(this.currentPosition,this),this.setPosition=o(this.setPosition,this),this.render=o(this.render,this),this.show=o(this.show,this),this.url=o(this.url,this),this.meta=o(this.meta,this),e.__super__.constructor.apply(this,arguments),this.authenticateCheckRedirect(),App.User.full(this.user_id,this.render)}return a(e,t),e.prototype.meta=function(){var t,e;return t={url:this.url(),id:this.user_id},App.User.exists(this.user_id)&&(e=App.User.find(this.user_id),t.head=e.displayName(),t.title=e.displayName(),t.iconClass=e.icon()),t},e.prototype.url=function(){return"#user/profile/"+this.user_id},e.prototype.show=function(){return App.OnlineNotification.seen("User",this.user_id),this.navupdate({url:"#",type:"menu"})},e.prototype.changed=function(){return!1},e.prototype.render=function(t){var e;return this.doNotLog||(this.doNotLog=1,this.recentView("User",this.user_id)),e=$(App.view("user_profile/index")({user:t})),new r({object_id:t.id,el:e.find(".js-profileName")}),new i({el:e.find(".js-object-container"),object_id:t.id,taskKey:this.taskKey}),new n({el:e.find(".js-action"),object_id:t.id}),new App.TicketStats({el:e.find(".js-ticket-stats"),user:t}),this.html(e),new App.UpdateTastbar({genericObject:t})},e.prototype.setPosition=function(t){return this.$(".profile").scrollTop(t)},e.prototype.currentPosition=function(){return this.$(".profile").scrollTop()},e}(App.Controller),n=function(t){function e(){return this.actions=o(this.actions,this),this.resendVerificationEmail=o(this.resendVerificationEmail,this),this.newTicket=o(this.newTicket,this),this.editUser=o(this.editUser,this),this.showHistory=o(this.showHistory,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model="User",e.prototype.observe={verified:!0,source:!0,organization_id:!0},e.prototype.showHistory=function(t){return new App.UserHistory({user_id:t.id,container:this.el.closest(".content")})},e.prototype.editUser=function(t){return new App.ControllerGenericEdit({id:t.id,genericObject:"User",screen:"edit",pageData:{title:"Users",object:"User",objects:"Users"},container:this.el.closest(".content")})},e.prototype.newTicket=function(t){return this.navigate("ticket/create/customer/"+t.id)},e.prototype.resendVerificationEmail=function(t){return this.ajax({id:"email_verify_send",type:"POST",url:this.apiPath+"/users/email_verify_send",data:JSON.stringify({email:t.email}),processData:!0,success:(n=this,function(){return n.notify({type:"success",msg:App.i18n.translateContent('Email sent to "%s". Please let the user verify his email address.',t.email),removeAll:!0})}),error:(e=this,function(){return e.notify({type:"error",msg:App.i18n.translateContent('Failed to sent Email "%s". Please contact an administrator.',t.email),removeAll:!0})})});var e,n},e.prototype.actions=function(t){var e;return e=[{name:"history",title:"History",callback:this.showHistory},{name:"ticket",title:"New Ticket",callback:this.newTicket}],t.isAccessibleBy(App.User.current(),"change")&&(e.unshift({name:"edit",title:"Edit",callback:this.editUser}),!0!==t.verified&&"signup"===t.source&&e.push({name:"resend_verification_email",title:"Resend verification email",callback:this.resendVerificationEmail})),e},e}(App.ObserverActionRow),i=function(t){function e(){return this.update=o(this.update,this),this.render=o(this.render,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model="User",e.prototype.observeNot={cid:!0,created_at:!0,created_by_id:!0,updated_at:!0,updated_by_id:!0,preferences:!0,password:!0,last_login:!0,login_failed:!0,source:!0,image_source:!0},e.prototype.events={"focusout [contenteditable]":"update"},e.prototype.render=function(t){var e,n,i,s,r,o;for(n in App.TaskManager.touch(this.taskKey),o=[],r=App.User.attributesGet("view"))e=r[n],(s=(i=n).substr(0,i.length-3))in t&&(i=s),(t[i]||"richtext"===e.tag)&&e.shown&&"firstname"!==i&&"lastname"!==i&&"organization"!==i&&o.push(e);return this.html(App.view("user_profile/object")({user:t,userData:o})),this.$("[contenteditable]").ce({mode:"textonly",multiline:!0,maxlength:250})},e.prototype.update=function(t){var e,n,i,s;if(n=$(t.target).attr("data-name"),s=$(t.target).html(),(i=App.User.find(this.object_id))[n]!==s)return this.lastAttributres[n]=s,(e={})[n]=s,i.updateAttributes(e),this.log("debug","update",n,s,i)},e}(App.ObserverController),s=function(t){function e(){return this.render=o(this.render,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model="Organization",e.prototype.observe={name:!0},e.prototype.render=function(t){return this.html(App.view("user_profile/organization")({organization:t}))},e}(App.ObserverController),r=function(t){function e(){return this.render=o(this.render,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model="User",e.prototype.observe={firstname:!0,lastname:!0,organization_id:!0,image:!0},e.prototype.render=function(t){return t.organization_id&&new s({object_id:t.organization_id,el:this.el.siblings(".js-organization")}),this.html(App.view("user_profile/name")({user:t}))},e}(App.ObserverController),t=function(t){function n(t){var e;n.__super__.constructor.apply(this,arguments),e={user_id:t.user_id},App.TaskManager.execute({key:"User-"+this.user_id,controller:"UserProfile",params:e,show:!0})}return a(n,t),n.prototype.requiredPermission="ticket.agent",n}(App.ControllerPermanent),App.Config.set("user/profile/:user_id",t,"Routes")}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.search=n(this.search,this),this.hide=n(this.hide,this),this.show=n(this.show,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.requiredPermission="admin.user",e.prototype.header="Users",e.prototype.elements={".js-search":"searchInput"},e.prototype.events={"click [data-type=new]":"new","click [data-type=import]":"import"},e.prototype.show=function(){if(e.__super__.show.apply(this,arguments),this.table)return this.table.show()},e.prototype.hide=function(){if(e.__super__.hide.apply(this,arguments),this.table)return this.table.hide()},e.prototype.render=function(){var n,e;return this.html(App.view("user")({head:"Users",buttons:[{name:"Import","data-type":"import","class":"btn"},{name:"New User","data-type":"new","class":"btn--success"}],roles:App.Role.findAllByAttribute("active",!0)})),this.$(".tab").on("click",(n=this,function(t){var e;return t.preventDefault(),$(t.target).toggleClass("active"),e=n.searchInput.val().trim(),n.query=e,n.delay(n.search,220,"search")})),this.searchInput.bind("keyup",(e=this,function(){var t;if((t=e.searchInput.val().trim())!==e.query)return e.query=t,e.delay(e.search,220,"search")})),this.search()},e.prototype.renderResult=function(s){var t,e,n,i,r,o,a,l,c,p,u;for(null==s&&(s=[]),this.stopLoading(),e=function(t){var e;return e={name:"switch_to",display:"Action",className:"actionCell",translation:!0,width:"250px",displayWidth:250,unresizable:!0},t.push(e),t},t=function(t,e,n){var i;return i=App.i18n.translateInline("View from user's perspective"),t=" ",n.raw=' <span class="btn btn--primary btn--small btn--slim switchView" title="'+i+'">'+App.Utils.icon("switchView")+"<span>"+i+"</span></span>",n["class"]="",n.parentClass="actionCell no-padding",n.link="",n.title=App.i18n.translateInline("Switch to"),t},o=function(t,e){return e.preventDefault(),e.stopPropagation(),p.disconnectClient(),$("#app").hide().attr("style","display: none!important"),p.delay(function(){return App.Auth._logout(!1),p.ajax({id:"user_switch",type:"GET",url:p.apiPath+"/sessions/switch/"+t,success:function(t){var e;return e=window.location.protocol+"//"+window.location.host+t.location,p.windowReload(void 0,e)}})},800)},u=p=this,n=function(t,e){var n,i;return e.preventDefault(),n=App.User.find(t),i=function(){return App.Group.fetch(),u.renderResult(s)},new App.ControllerGenericEdit({id:n.id,pageData:{title:"Users",home:"users",object:"User",objects:"Users",navupdate:"#users"},genericObject:"User",callback:i,container:u.el.closest(".content")})},c=[],i=0,r=s.length;i<r;i++)l=s[i],a=App.User.find(l),c.push(a);return this.$(".table-overview").html(""),
this.table=new App.ControllerTable({tableId:"users_admin_overview",el:this.$(".table-overview"),model:App.User,objects:c,"class":"user-list",callbackHeader:[e],callbackAttributes:{switch_to:[t]},bindCol:{switch_to:{events:{click:o}}},bindRow:{events:{click:n}}})},e.prototype.search=function(){var n,t,e;return n=[],this.$(".tab.active").each(function(t,e){return n.push($(e).data("id"))}),this.startLoading(this.$(".table-overview")),App.Ajax.request({id:"search",type:"GET",url:this.apiPath+"/users/search?sort_by=created_at",data:{query:this.query||"*",limit:50,role_ids:n,full:!0},processData:!0,success:(e=this,function(t){return App.Collection.loadAssets(t.assets),e.renderResult(t.user_ids),e.stopLoading()}),done:(t=this,function(){return t.stopLoading()})})},e.prototype["new"]=function(t){return t.preventDefault(),new App.ControllerGenericNew({pageData:{title:"Users",home:"users",object:"User",objects:"Users",navupdate:"#users"},genericObject:"User",container:this.el.closest(".content"),callback:this.search})},e.prototype["import"]=function(t){return t.preventDefault(),new App.Import({baseUrl:"/api/v1/users",container:this.el.closest(".content")})},e}(App.ControllerSubContent),App.Config.set("User",{prio:1e3,name:"Users",parent:"#manage",target:"#manage/users",controller:t,permission:["admin.user"]},"NavBarAdmin")}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.load()}return n(e,t),e.prototype.requiredPermission="admin.version",e.prototype.header="Version",e.prototype.load=function(){return this.startLoading(),this.ajax({id:"version",type:"GET",url:this.apiPath+"/version",success:(e=this,function(t){return e.stopLoading(),e.version=t.version,e.render()})});var e},e.prototype.render=function(){return this.html(App.view("version")({version:this.version}))},e}(App.ControllerSubContent),App.Config.set("Version",{prio:3800,name:"Version",parent:"#system",target:"#system/version",controller:t,permission:["admin.version"]},"NavBarAdmin")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.AnswerList=function(t){function e(){this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.extend(App.PopoverProvidable),e.registerPopovers("Organization","User"),e.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p,u;for(function(t){var e;return e=App.Ticket.findNative(t),u.navigate(e.uiUrl())},i=function(t,e,n){return n.title=e.title,"1111"},e=function(t,e,n){return n.link=e.uiUrl(),"22222"},s=function(t,e,n){var i;return e?(i=void 0,"customer_id"===n.name&&(i=e.customer_id),"owner_id"===n.name&&(i=e.owner_id),i&&(n["class"]="user-popover",n.data={id:i}),t):t},n=function(t,e,n){return e&&e.organization_id&&(n["class"]="organization-popover",n.data={id:e.organization_id}),t},t=function(t){var e;return e={name:"icon",display:"",translation:!1,width:"28px",displayWidth:28,unresizable:!0},t.unshift(0),t[0]=e,t},function(t,e,n){return t=" ",n["class"]=e.iconClass(),n.link="",n.title=e.iconTitle(),t},a=[],r=0,o=(l=(u=this).ticket_ids).length;r<o;r++)p=l[r],c=App.KnowledgeBaseAnswer.fullLocal(p),a.push(c);return this.el.html(""),new App.ControllerTable({tableId:this.tableId,el:this.el,overview:this.columns||["id","translation::title","customer","group","created_at"],model:App.KnowledgeBaseAnswer,objects:a,callbackHeader:[t],callbackAttributes:{organization_id:[n],owner_id:[s],title:[e,i],number:[e,i]},radio:this.radio}),this.renderPopovers()},e}(App.Controller)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),App.Event.bind("config_update",function(t){return App.Config.set(t.name,t.value),App.Event.trigger("config_update_local",t)})}return n(e,t),e}(App.Controller),App.Config.set("app_config_update",t,"Widgets")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetAvatar=function(t){function e(){return this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.extend(App.PopoverProvidable),e.registerPopovers("User"),e.prototype.model="User",e.prototype.observe={login:!0,firstname:!0,lastname:!0,email:!0,image:!0,vip:!0,out_of_office:!0,out_of_office_start_at:!0,out_of_office_end_at:!0,out_of_office_replacement_id:!0,active:!0},e.prototype.globalRerender=!1,e.prototype.render=function(t){return this.html(t.avatar(this.size,this.position,this.cssClass,!1,!1,this.type)),this.renderPopovers()},e}(App.ObserverController)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetButtonWithDropdown=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.render()}return n(e,t),e.prototype.elements={".dropdown-menu-accessories":"accessoriesContainer"},e.prototype.events={"click li":"clickedOption"},e.prototype.mainActionLabel="Submit",e.prototype.mainActionIdentifier="js-submit",e.prototype.accessoryActionsIdentifier="js-submit-action",e.prototype.render=function(){return this.el.addClass("buttonDropdown dropdown dropup"),this.html(App.view("widget/button_with_dropdown")({mainActionIdentifier:this.mainActionIdentifier,accessoryActionsIdentifier:this.accessoryActionsIdentifier,mainActionLabel:this.mainActionLabel,actions:this.actions||[]}))},e.prototype.clickedOption=function(t){if(!t.currentTarget.hasAttribute("disabled"))return this.accessoriesContainer.blur();this.preventDefaultAndStopPropagation(t)},e}(App.Controller)}.call(this),function(){var t,e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function i(){var t,n,e;i.__super__.constructor.apply(this,arguments),n=this,t=function(){var t,e;if((e=App.Session.get("preferences"))&&_.isEmpty(e.locale))return t=App.i18n.get(),n.ajax({id:"i18n-set-user-"+t,type:"PUT",url:App.Config.get("api_path")+"/users/preferences",data:JSON.stringify({locale:t}),processData:!0})},App.Event.bind("auth:login",(e=this,function(){return e.delay(t,3500,"default_locale")}))}return e(i,t),i}(App.Controller),App.Config.set("default_locale",t,"Widgets")}.call(this),function(){var t,e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function i(){var t,e,n;i.__super__.constructor.apply(this,arguments),e=this,t=function(){var t;if(t=App.i18n.detectBrowserTimezone())return _.isEmpty(e.Config("timezone_default"))&&e.permissionCheck("admin.system")?App.Setting.fetchFull(function(){return e.updateSetting(t)},{force:!1}):void 0},App.Event.bind("auth:login",(n=this,function(){return n.delay(t,8500,"default_timezone")}))}return e(i,t),i.prototype.updateSetting=function(t){return App.Setting.set("timezone_default",t)},i}(App.Controller),App.Config.set("default_timezone",t,"Widgets")}.call(this),function(){var t;t=function(){function t(){var t;App.Config.get("developer_mode")&&!1!==App.Log.config("banner")&&(t="|\n| Welcome Zammad Developer!\n| You can enable debugging with the following examples (value is a regex):\n|\n| App.Log.config('module', '(websocket|delay|interval)') // enable debugging for websocket, delay and interval class\n| App.Log.config('content', 'send')                      // enable debugging for messages which contain the string 'send'\n| App.Log.config('banner', false)                        // disable this banner\n|\n| App.Log.config()         // current settings\n| App.Log.config('banner') // current setting for banner\n|",console.log(t))}return t}(),App.Config.set("dev_banner",t,"Widgets")}.call(this),function(){var t;t=function(){function t(){var e,n,i,s,r,t,o,a,l,c;window.require&&(s=window.require("electron"))&&(o=s.remote,r=s.ipcRenderer,App.Event.bind("window-title-set",function(t){return r.send("window-title-set",t)}),App.Event.bind("online_notification_counter",function(t){return a(t)}),r.on("global-shortcut",function(t,e){return App.Event.trigger("global-shortcut",e)}),e=o.Menu,n=o.MenuItem,t=function(){var t;return(t=new e).append(new n({label:"Cut",role:"cut"})),t.append(new n({label:"Copy",role:"copy"})),t.append(new n({label:"Paste",role:"paste"})),t.append(new n({label:"Select All",role:"selectall"})),t}(),window.addEventListener("contextmenu",function(){return t.popup(o.getCurrentWindow()),!1}),i=function(t){var e,n,i,s;return s=16*(i=2),(e=document.createElement("canvas")).setAttribute("width",s),e.setAttribute("height",s),(n=e.getContext("2d")).fillStyle="#FF1744",n.beginPath(),n.arc(s/2,s/2,s/2,0,2*Math.PI),n.fill(),n.fillStyle="#ffffff",n.textAlign="center",n.textBaseline="middle",n.font=10*i+"px sans-serif",n.fillText(t,s/2,s/2,s),e.toDataURL()},c=function(n){var t;return t=function(t,e){return s.ipcRenderer.send("win32-overlay",{overlayDataURL:t,description:e,content:n})},""!==n?t(i(n.toString()),"You have unread messages ("+n+")"):t(null,"You have no unread messages")},l=function(t){return o.app.dock.setBadge(t)},a=function(t){return"win32"===process.platform?c(t):"darwin"===process.platform?l(t):void 0})}return t}(),App.Config.set("aaa_electron_events",t,"Navigations")}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.GlobalSearchWidget=function(t){function e(){var e,o;$("body").on("mousedown",(e=this,function(t){return e.shiftHeldToogle(t),!0})),App.Event.bind("global:search:set",(o=this,function(t){var e,n,i,s,r;return s=t[0],e=t[1],(s=s.replace('"',"")).match(/\W/)&&(s='"'+s+'"'),r=e?e+":"+s:""+s,n=$("#global-search").val(),o.shiftHeld&&n?(n+=" AND ",n+=r):n=r,$("#global-search").val(n),i=function(){return $("#global-search").focus()},App.Delay.set(i,20,"global-search-delay")}))}return n(e,t),!1,e.prototype.shiftHeldToogle=function(t){return this.shiftHeld=t.shiftKey},e.search=function(t,e){return App.Event.trigger("global:search:set",[t,e])},e}(Spine.Module),App.Config.set("global_navigation",App.GlobalSearchWidget,"Widgets")}.call(this),function(){var t;t=function(){function t(){var t;App.Config.get("developer_mode")||(t="|  _____                                    _\n| / _  / __ _ _ __ ___  _ __ ___   __ _  __| |\n| \\// / / _` | '_ ` _ \\| '_ ` _ \\ / _` |/ _` |\n|  / //\\ (_| | | | | | | | | | | | (_| | (_| |\n| /____/\\__,_|_| |_| |_|_| |_| |_|\\__,_|\\__,_|\n|\n| Hi there, nice to meet you!\n|\n| Visit %chttp://zammad.com/jobs%c to learn about our current job openings.\n|\n| Your Zammad Team\n|",console.log(t,"text-decoration: underline;","text-decoration: none;"))}return t}(),App.Config.set("hello_banner",t,"Widgets")}.call(this),function(){var o,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.HttpLog=function(t){function e(){this.show=n(this.show,this),this.render=n(this.render,this),this.fetch=n(this.fetch,this),e.__super__.constructor.apply(this,arguments),this.fetch(),this.records=[]}return i(e,t),e.prototype.events={"click .js-record":"show"},e.prototype.fetch=function(){return this.ajax({id:"http_logs",type:"GET",url:this.apiPath+"/http_logs/"+this.facility,data:{limit:this.limit||50},processData:!0,success:(e=this,function(t){return(!e.records[0]||t[0]&&e.records[0]&&t[0].updated_at!==e.records[0].updated_at)&&(e.records=t,e.render()),e.delay(e.fetch,2e4)})});var e},e.prototype.render=function(){return this.html(App.view("widget/http_log")({records:this.records,description:this.description}))},e.prototype.show=function(t){var e,n,i,s,r;for(t.preventDefault(),s=$(t.currentTarget).data("id"),e=0,n=(r=this.records).length;e<n;e++)if(i=r[e],s.toString()===i.id.toString())return void new o({record:i,container:this.el.closest(".content")})},e}(App.Controller),o=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.authenticateRequired=!0,e.prototype.large=!0,e.prototype.head="HTTP Log",e.prototype.buttonClose=!0,e.prototype.buttonCancel=!1,e.prototype.buttonSubmit=!1,e.prototype.content=function(){return App.view("widget/http_log_show")({record:this.record})},e}(App.ControllerModal)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.InviteUser=function(t){function e(){var t;this.submit=n(this.submit,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.container&&this.el.addClass("modal--local"),this.render(),this.el.modal({keyboard:!0,show:!0,backdrop:!0,container:this.container}).on({"hidden.bs.modal":(t=this,function(){return t.callback&&t.callback(),t.el.remove()})})}return i(e,t),e.prototype.events={"click  .js-close":"hide","submit .js-user":"submit","click  .js-goToSlide":"goToSlide"},e.prototype.render=function(){var t;return t=$(App.view("widget/invite_user")({head:this.head})),new App.ControllerForm({el:t.find(".js-form"),model:App.User,screen:this.screen,autofocus:!0}),this.initRenderingDone?this.$(".modal-dialog").replaceWith(t):(this.initRenderingDone=!0,this.html(t))},e.prototype.submit=function(n){var t,e,i,s,r;return n.preventDefault(),this.showSlide("js-waiting"),this.formDisable(n),this.params=this.formParam(n.target),this.params.invite=!0,this.role&&(e=App.Role.findByAttribute("name",this.role))&&(this.params.role_ids=e.id),(i=new App.User).load(this.params),(t=i.validate({screen:this.screen}))?(this.log("error new",t),this.formValidate({form:n.target,errors:t}),this.formEnable(n),this.showSlide("js-user"),!1):i.save({done:(r=this,function(){return r.showSlide("js-success"),r.el.modal("hide")}),fail:(s=this,function(t,e){return s.formEnable(n),s.showSlide("js-user"),s.showAlert("js-user",e.error_human||e.error)})})},e}(App.WizardModal)}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KeyboardShortcutModal=function(t){function e(){this.exists=n(this.exists,this),e.__super__.constructor.apply(this,arguments),this.bind("keyboard_shortcuts_close",this.close)}return i(e,t),e.prototype.authenticateRequired=!0,e.prototype.large=!0,e.prototype.head="Keyboard Shortcuts",e.prototype.buttonClose=!0,e.prototype.buttonCancel=!1,e.prototype.buttonSubmit=!1,e.prototype.content=function(){return App.view("keyboard_shortcuts")({areas:App.Config.get("keyboard_shortcuts"),magicKey:App.Browser.magicKey(),hotkeys:App.Browser.hotkeys().split("+").reverse()})},e.prototype.exists=function(){return 0<this.el.parents("html").length},e.prototype.onClosed=function(){if("#keyboard_shortcuts"===window.location.hash)return window.history.back()},e}(App.ControllerModal),App.KeyboardShortcutWidget=function(t){function e(){var e;this.observerKeys=n(this.observerKeys,this),this.observerKeys(),this.lastKey=void 0,$(document).keyup((e=this,function(t){if(27===t.keyCode)return e.lastKey=void 0}))}return i(e,t),e.include(App.LogInclude),e.prototype.observerKeys=function(){var r,i,t,e,o,n,s,a,l,c,p,u,h,d;for(p=App.Browser.hotkeys(),e=0,a=(i=App.Config.get("keyboard_shortcuts")).length;e<a;e++)for(n=0,l=(u=(r=i[e]).content).length;n<l;n++)for(h=(o=u[n]).shortcuts,t=function(i){return function(e){var n;if(n="",e.hotkeys&&(n+=p),e.key&&(""!==n&&(n+="+"),n+=e.key,e.callback))return i.log("debug","bind for",n),$(document).bind("keydown",n,function(t){return t.preventDefault(),i.lastKey&&i.lastKey.modifier===n&&i.lastKey.time+5500>(new Date).getTime()?(i.lastKey.count+=1,i.lastKey.time=(new Date).getTime()):i.lastKey={modifier:n,count:1,time:(new Date).getTime()},e.callback(e,i.lastKey,n)})}}(this),s=0,c=h.length;s<c;s++)t(d=h[s]);return App.Event.bind("global-shortcut",function(s){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)r=i[t],n.push(function(){var t,e,n,i;for(i=[],e=0,t=(n=r.content).length;e<t;e++)o=n[e],i.push(function(){var t,e,n,i;for(i=[],e=0,t=(n=o.shortcuts).length;e<t;e++)(d=n[e]).globalEvent===s?i.push(d.callback(d)):i.push(void 0);return i}());return i}());return n})},e}(Spine.Module),App.Config.set("keyboard_shortcuts",App.KeyboardShortcutWidget,"Widgets"),App.Config.set("keyboard_shortcuts",[{headline:"Navigation",location:"left",content:[{where:"Used anywhere",shortcuts:[{key:"d",hotkeys:!0,description:"Dashboard",globalEvent:"dashboard",callback:function(){return $("#global-search").blur(),App.Event.trigger("keyboard_shortcuts_close"),window.location.hash="#dashboard"}},{key:"o",hotkeys:!0,description:"Overviews",globalEvent:"overview",callback:function(){return $("#global-search").blur(),App.Event.trigger("keyboard_shortcuts_close"),window.location.hash="#ticket/view"}},{key:"s",hotkeys:!0,description:"Search",globalEvent:"search",callback:function(){return App.Event.trigger("keyboard_shortcuts_close"),$("#global-search").focus()}},{key:"a",hotkeys:!0,description:"Notifications",globalEvent:"notification",callback:function(){return $("#global-search").blur(),App.Event.trigger("keyboard_shortcuts_close"),$("#navigation .js-toggleNotifications").click()}},{key:"n",hotkeys:!0,description:"New Ticket",globalEvent:"new-ticket",callback:function(){return $("#global-search").blur(),App.Event.trigger("keyboard_shortcuts_close"),window.location.hash="#ticket/create"}},{key:"e",hotkeys:!0,description:"Logout",globalEvent:"logout",callback:function(){return App.Event.trigger("keyboard_shortcuts_close"),window.location.hash="#logout"}},{key:"h",hotkeys:!0,description:"List of shortcuts",globalEvent:"list-of-shortcuts",callback:(t=this,function(){if("#keyboard_shortcuts"!==window.location.hash)return t.dialog&&t.dialog.exists()?(t.dialog.close(),void(t.dialog=!1)):t.dialog=new App.KeyboardShortcutModal;App.Event.trigger("keyboard_shortcuts_close")})},{key:"w",hotkeys:!0,description:"Close current tab",globalEvent:"close-current-tab",callback:function(){return App.Event.trigger("keyboard_shortcuts_close"),$("#navigation .tasks .is-active .js-close").click()}},{key:"tab",hotkeys:!0,description:"Next in tab",globalEvent:"next-in-tab",callback:function(){var t,e,n,i;return App.Event.trigger("keyboard_shortcuts_close"),i=function(t){if(t&&t.get(0))return t.get(0).scrollIntoView(!1)},(t=$("#navigation .tasks .is-active")).get(0)&&(e=t.next()).get(0)?(e.find("div").first().click(),void i(e)):(n=$("#navigation .tasks .task").first()).get(0)?(n.find("div").first().click(),i(n)):void 0}},{key:"shift+tab",hotkeys:!0,description:"Previous tab",globalEvent:"previous-in-tab",callback:function(){var t,e,n,i;return App.Event.trigger("keyboard_shortcuts_close"),i=function(t){if(t&&t.get(0))return t.get(0).scrollIntoView(!0)},(t=$("#navigation .tasks .is-active")).get(0)&&(n=t.prev()).get(0)?(n.find("div").first().click(),void i(n)):(e=$("#navigation .tasks .task").last()).get(0)?(e.find("div").first().click(),i(e)):void 0}},{key:"return",hotkeys:!0,description:"Confirm/submit dialog",globalEvent:"submit",callback:function(){var t;App.Event.trigger("keyboard_shortcuts_close"),(t=$("body > div.modal")).get(0)?t.find(".js-submit").click():(t=$(".active.content > div.modal")).get(0)?t.find(".js-submit").click():(t=$(".active.content .js-attributeBar .js-submit")).get(0)?t.first().click():(t=$(".active.content .js-submit")).get(0)&&t.first().click()}}]},{where:"Used in lists (views and results)",shortcuts:[{key:["\u25b2","\u25bc"],description:"Move up and down"},{key:["\u25c0","\u25b6"],description:"Move left and right"},{key:"enter",description:"Select item"}]},{where:"Used in object views",shortcuts:[{key:".",hotkeys:!0,description:"Copy current object number (e. g. Ticket#) to clipboard",callback:function(t,e){var n,i,s;if(App.Event.trigger("keyboard_shortcuts_close"),n=$(".active.content .js-objectNumber").first().data("number")||"",!e||1!==e.count)return i=$(".active.content .js-objectTitle").first().text(),e&&2===e.count?(i&&(n+=": "+i),void clipboard.copy(n)):(s=window.location.toString(),e&&3===e.count?clipboard.copy({"text/plain":n+": "+i+"\n"+s,"text/html":'<a href="'+s+'">'+n+"</a>: "+i}):void 0);clipboard.copy(n)}},{keyPrefix:"2x",key:".",hotkeys:!0,description:"...add object title"},{keyPrefix:"3x",key:".",hotkeys:!0,description:"...add object link URL"}]}]},{headline:"Translations",location:"left",content:[{where:"Used anywhere (admin only)",shortcuts:[{admin:!0,key:"t",hotkeys:!0,description:"Enable/disable inline translations",globalEvent:"translation-mode"}]}]},{headline:"Tickets",location:"right",content:[{where:"Used when viewing a Ticket",shortcuts:[{key:"m",hotkeys:!0,description:"Open note box",globalEvent:"article-note-open",callback:function(){return App.Event.trigger("keyboard_shortcuts_close"),$('.active.content .editControls .js-articleTypes [data-value="note"]').click(),$(".active.content .article-new .articleNewEdit-body").first().focus()}},{key:"g",hotkeys:!0,description:"Reply to last article",globalEvent:"article-reply",callback:function(){var t,e;if(App.Event.trigger("keyboard_shortcuts_close"),!(e=(t=$(".active.content .ticket-article .icon-reply").last()).parent().find(".icon-reply-all")).get(0))return t.click();e.click()}},{key:"j",hotkeys:!0,description:"Set article to internal/public",globalEvent:"article-internal-public",callback:function(){return App.Event.trigger("keyboard_shortcuts_close"),$(".active.content .editControls .js-selectInternalPublic").click()}},{key:"c",hotkeys:!0,description:"Update as closed",globalEvent:"task-update-close",callback:function(){if(App.Event.trigger("keyboard_shortcuts_close"),$(".active.content .edit").get(0))return $('.active.content .edit [name="state_id"]').val(4),$(".active.content .js-attributeBar .js-submit").first().click()}},{key:["\u25c0","\u25b6"],hotkeys:!0,description:"Navigate through article"}]},{where:"Used when composing a Ticket article",shortcuts:[{key:"::",hotkeys:!1,description:"Inserts Text module",globalEvent:"richtext-insert-text-module"},{key:"??",hotkeys:!1,description:"Inserts Knowledge Base answer",globalEvent:"richtext-insert-kb-answer"}]}]},{headline:"Text editing",location:"right",content:[{where:"Used when composing a text",shortcuts:[{key:"u",magicKey:!0,description:"Format as _underlined_",globalEvent:"richtext-underline"},{key:"b",magicKey:!0,description:"Format as |bold|",globalEvent:"richtext-bold"},{key:"i",magicKey:!0,description:"Format as ||italic||",globalEvent:"richtext-italic"},{key:"s",magicKey:!0,description:"Format as //strikethrough//",globalEvent:"richtext-strikethrough"},{key:"f",hotkeys:!0,description:"Removes the formatting",globalEvent:"richtext-remove-formating"},{key:"y",hotkeys:!0,description:"...of whole textarea",globalEvent:"richtext-remove-formating-textarea"},{key:"z",hotkeys:!0,description:"Inserts a horizontal rule",globalEvent:"richtext-hr"},{key:"l",hotkeys:!0,description:"Format as unordered list",globalEvent:"richtext-ul"},{key:"k",hotkeys:!0,description:"Format as ordered list",globalEvent:"richtext-ol"},{key:"1",hotkeys:!0,description:"Format as h1 heading",globalEvent:"richtext-h1"},{key:"2",hotkeys:!0,description:"Format as h2 heading",globalEvent:"richtext-h2"},{key:"3",hotkeys:!0,description:"Format as h3 heading",globalEvent:"richtext-h3"},{key:"x",hotkeys:!0,description:"Removes any hyperlink",globalEvent:"richtext-remove-hyperlink"}]}]}])}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetLink=function(t){function e(){if(this["delete"]=n(this["delete"],this),this.reload=n(this.reload,this),this.fetch=n(this.fetch,this),e.__super__.constructor.apply(this,arguments),this.links)return this.localLinks=_.clone(this.links),void this.render();this.fetch()}return i(e,t),e.extend(App.PopoverProvidable),e.popoversDefaults={position:"left"},e.prototype.events={"click .js-add":"add","click .js-delete":"delete"},e.prototype.fetch=function(){return this.ajax({id:"links_"+this.object.id+"_"+this.object_type,type:"GET",url:this.apiPath+"/links",data:{link_object:this.object_type,link_object_value:this.object.id},processData:!0,success:(e=this,function(t){return e.localLinks=t.links,App.Collection.loadAssets(t.assets),e.render()})});var e},e.prototype.reload=function(t){return this.localLinks=_.clone(t),this.render()},e.prototype["delete"]=function(t){var e,n,i,s,r,o,a;return t.preventDefault(),r=$(t.currentTarget).data("link-type"),e=$(t.currentTarget).data("object"),n=$(t.currentTarget).data("object-id"),i=this.object_type,s=this.object.id,this.ajax({id:"links_remove_"+this.object.id+"_"+this.object_type,type:"GET",url:this.apiPath+"/links/remove",data:{link_type:r,link_object_source:e,link_object_source_value:n,link_object_target:i,link_object_target_value:s},processData:!0,success:(a=this,function(){return a.fetch()}),error:(o=this,function(t){var e;return o.notify({type:"error",msg:App.i18n.translateContent((null!=(e=t.responseJSON)?e.error:void 0)||"Couldn't save changes"),removeAll:!0})})})},e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetLinkKbAnswer=function(t){function e(){return this.didBlur=n(this.didBlur,this),this.didSubmit=n(this.didSubmit,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.registerPopovers("KnowledgeBaseAnswer"),e.prototype.elements={".js-add":"addButton",".searchableSelect":"searchableSelect",".js-shadow":"shadowField",".js-input":"inputField"},e.prototype.events={"change .js-shadow":"didSubmit","blur .js-input":"didBlur"},e.prototype.getAjaxAttributes=function(t,e){return this.apiPath=App.Config.get("api_path"),e.type="POST",e.url=this.apiPath+"/knowledge_bases/search",e.data.flavor="agent",e.data.include_locale=!0,e.data.index="KnowledgeBase::Answer::Translation",e.data.highlight_enabled=!1,e.data=JSON.stringify(e.data),e},e.prototype.linksForRendering=function(){return this.localLinks.map(function(t){var e;switch(t.link_object){case"KnowledgeBase::Answer::Translation":if(e=App.KnowledgeBaseAnswerTranslation.fullLocal(t.link_object_value))return{title:e.title,id:e.id,url:e.uiUrl()}}}).filter(function(t){return null!=t})},e.prototype.render=function(){return this.html(App.view("link/kb_answer")({list:this.linksForRendering()})),this.renderPopovers(),this.el.append(new App.SearchableAjaxSelect({delegate:this,useAjaxDetails:!0,attribute:{id:"link_kb_answer",name:"input",placeholder:App.i18n.translateInline("Search..."),limit:40,object:"KnowledgeBaseAnswerTranslation",ajax:!0}}).element()),this.refreshElements(),this.searchableSelect.addClass("hidden")},e.prototype.didSubmit=function(){return this.clearDelay("hideField"),this.inputField.attr("disabled",!0),this.saveToServer(this.shadowField.val())},e.prototype.didBlur=function(){return this.delay((t=this,function(){return t.setInputVisible(!1)}),200,"hideField");var t},e.prototype.add=function(){return this.shadowField.val(""),this.inputField.attr("disabled",!1).val(""),this.setInputVisible(!0),this.inputField.focus()},e.prototype.setInputVisible=function(t){return this.searchableSelect.toggleClass("hidden",!t),this.addButton.toggleClass("hidden",t)},e.prototype.saveToServer=function(t){return this.ajax({id:"links_add_"+this.object.id+"_"+this.object_type,type:"GET",url:this.apiPath+"/links/add",data:{link_type:"normal",link_object_target:"Ticket",link_object_target_value:this.object.id,link_object_source:"KnowledgeBase::Answer::Translation",link_object_source_number:t},processData:!0,success:(e=this,function(){return e.fetch(),e.setInputVisible(!1)}),error:(n=this,function(t){var e;return n.setInputVisible(!1),n.notify({type:"error",msg:App.i18n.translateContent((null!=(e=t.responseJSON)?e.error:void 0)||"Couldn't save changes"),removeAll:!0})})});var n,e},e}(App.WidgetLink)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetLink.Ticket=function(t){function e(){return this.add=n(this.add,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.registerPopovers("Ticket"),e.prototype.render=function(){var t,e,n,i,s,r,o;if(!this.lastLocalLinks||!_.isEqual(this.lastLocalLinks,this.localLinks)){for(this.lastLocalLinks=_.clone(this.localLinks),i={},t=0,n=(s=this.localLinks).length;t<n;t++)i[(e=s[t]).link_type]||(i[e.link_type]={tickets:[]}),"Ticket"===e.link_object&&("merged"===(r=App.Ticket.fullLocal(e.link_object_value)).state.name&&(r.css="merged"),i[e.link_type].tickets.push(r));for(o in i)0!==i[o].tickets.length&&(i[o].ticketList=App.view("generic/ticket_list")({tickets:i[o].tickets,object:"Ticket",linkType:o}));return this.html(App.view("link/ticket/list")({links:i})),this.renderPopovers()}},e.prototype.add=function(t){return t.preventDefault(),new App.TicketLinkAdd({link_object:this.object_type,link_object_id:this.object.id,link_types:[["normal","Normal"],["child","Child"],["parent","Parent"]],object:this.object,parent:this,container:this.el.closest(".content")})},e}(App.WidgetLink)}.call(this),function(){var t,i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function n(){var e;this.checkAvailability=i(this.checkAvailability,this),this.maintanaceAppVersion=i(this.maintanaceAppVersion,this),this.maintanaceConfigChanged=i(this.maintanaceConfigChanged,this),this.maintanaceRestartManual=i(this.maintanaceRestartManual,this),this.maintanaceRestartAuto=i(this.maintanaceRestartAuto,this),this.maintanaceMode=i(this.maintanaceMode,this),this.showMessage=i(this.showMessage,this),n.__super__.constructor.apply(this,arguments),App.Event.bind("maintenance",(e=this,function(t){if("message"===t.type&&e.showMessage(t),"mode"===t.type&&e.maintanaceMode(t),"app_version"===t.type&&e.maintanaceAppVersion(t),"config_changed"===t.type&&e.maintanaceConfigChanged(t),"restart_auto"===t.type&&e.maintanaceRestartAuto(t),"restart_manual"===t.type)return e.maintanaceRestartManual(t)}),"maintenance")}return e(n,t),n.prototype.serverRestarted=!1,n.prototype.showMessage=function(t){var e;return null==t&&(t={}),t.reload?(this.disconnectClient(),e="Continue session"):e="Close",new App.SessionMessage({head:t.head,contentInline:t.message,small:!0,keyboard:!0,backdrop:!0,buttonClose:!0,buttonSubmit:e,forceReload:t.reload})},n.prototype.maintanaceMode=function(t){if(null==t&&(t={}),!0===t.on&&this.authenticateCheck())return this.navigate("#logout")},n.prototype.maintanaceRestartAuto=function(){if(!this.messageRestartAuto)return this.messageRestartAuto=new App.SessionMessage({head:App.i18n.translateContent("Zammad is restarting..."),message:App.i18n.translateContent(
"Some system settings have changed, Zammad is restarting. Please wait until Zammad is back again."),keyboard:!1,backdrop:!1,buttonClose:!1,buttonSubmit:!1,small:!0,forceReload:!0}),this.disconnectClient(),this.checkAvailability()},n.prototype.maintanaceRestartManual=function(){if(!this.messageRestartManual)return this.messageRestartManual=new App.SessionMessage({head:App.i18n.translateContent("Zammad need a restart!"),message:App.i18n.translateContent('Some system settings have changed, please restart all Zammad processes! If you want to do this automatically, set environment variable APP___RESTART___CMD="/path/to/your___app___script.sh restart".'),keyboard:!1,backdrop:!1,buttonClose:!1,buttonSubmit:!1,small:!0,forceReload:!0}),this.disconnectClient(),this.checkAvailability()},n.prototype.maintanaceConfigChanged=function(){if(!this.messageConfigChanged)return this.messageConfigChanged=new App.SessionMessage({head:App.i18n.translateContent("Config has changed"),message:App.i18n.translateContent("The configuration of Zammad has changed, please reload your browser."),keyboard:!1,backdrop:!0,buttonClose:!1,buttonSubmit:"Continue session",forceReload:!0})},n.prototype.maintanaceAppVersion=function(t){var e,n;if(!this.messageAppVersion&&this.appVersion!==t.app_version)if(this.appVersion){if(this.appVersion=t.app_version,"true"===this.appVersion.split(":")[1])return e=function(){return n.messageAppVersion=new App.SessionMessage({head:App.i18n.translateContent("New Version"),message:App.i18n.translateContent("A new version of Zammad is available, please reload your browser."),keyboard:!1,backdrop:!0,buttonClose:!1,buttonSubmit:"Continue session",forceReload:!0})},(n=this).delay(e,2e3)}else this.appVersion=t.app_version},n.prototype.checkAvailability=function(t){var e,n;return e=function(){return n.ajax({id:"check_availability",type:"get",url:n.apiPath+"/available",success:function(){if(!n.serverRestarted)return n.checkAvailability();n.windowReload()},error:function(){return n.serverRestarted=!0,n.checkAvailability(2e3)}})},null==t&&(t=1e3),(n=this).delay(e,t)},n}(App.Controller),App.Config.set("maintenance",t,"Widgets")}.call(this),function(){var e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Notify=function(t){function n(){var e,t,s,r;n.__super__.constructor.apply(this,arguments),this.bind("notify",(e=this,function(t){return e.render(t)})),this.bind("notify:removeall",(t=this,function(){return t.log("notify:removeall",t),t.destroyAll()})),this.bind("notifyDesktop",(s=this,function(t){var e,n,i;if(window.Notification)return t.icon||(t.icon=s.logoUrl()),i=864e5,document.hasFocus()&&(i=4e3),s.desktopNotifyCounter+=1,e=s.desktopNotifyCounter,t.silent=!0,n=new window.Notification(t.title,t),s.desktopNotify[e]=n,s.log("debug","notifyDesktop",t,e),n.onclose=function(){return delete s.desktopNotify[e]},n.onclick=function(){if(window.focus(),s.log("debug","notifyDesktop.click",t),t.url&&s.locationExecuteOrNavigate(t.url),t.callback)return t.callback()},t.timeout||i?App.Delay.set(function(){return n.close()},t.timeout||i):void 0})),this.bind("auth",function(t){if(!_.isEmpty(t)){if(!window.Notification)return;return window.Notification.requestPermission()}}),$(window).focus((r=this,function(){var t,e,n,i;for(t in i=[],n=r.desktopNotify)e=n[t],i.push(e.close());return i}))}return e(n,t),n.prototype.desktopNotify={},n.prototype.desktopNotifyCounter=0,n.prototype.events={"click .alert":"destroy"},n.prototype.render=function(t){return"info"===t.type&&(t.type="information"),"warning"===t.type&&(t.type="alert"),t.removeAll&&$.noty.closeAll(),t.link&&(t.msg='<a href="'+t.link+'">'+t.msg+"</a>"),$("#notify").noty({text:t.msg,type:t.type,template:App.view("notify")({type:t.type}),animation:{open:"animated fadeInDown",close:"animated fadeOutDown"},timeout:t.timeout||3800,closeWith:["click"]})},n.prototype.destroy=function(t){return t.preventDefault()},n.prototype.destroyAll=function(){return $.noty.closeAll()},n}(App.ControllerWidgetPermanent),App.Config.set("notify",App.Notify,"Widgets")}.call(this),function(){var r=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.OnlineNotificationWidget=function(t){function s(){var t,e,n,i;this.remove=r(this.remove,this),this.hide=r(this.hide,this),this.show=r(this.show,this),this.createContainer=r(this.createContainer,this),this.toggle=r(this.toggle,this),this.fetch=r(this.fetch,this),this.counterGen=r(this.counterGen,this),this.counterUpdate=r(this.counterUpdate,this),this.listNavigate=r(this.listNavigate,this),s.__super__.constructor.apply(this,arguments),this.bind("OnlineNotification::changed",(t=this,function(){return t.delay(function(){return t.fetch()},2200,"online-notification-changed")})),this.ignoreInitLogin=!1,this.bind("ws:login",(e=this,function(){return e.ignoreInitLogin&&e.delay(function(){return e.fetch()},3200,"online-notification-changed"),e.ignoreInitLogin=!0})),this.bind("auth",(n=this,function(t){t&&n.access()||n.counterUpdate(0)})),$(window).on("click.notifications",this.hide),this.createContainer(),this.bind("ui:rerender",(i=this,function(){return i.createContainer(),"online_notification"}))}return n(s,t),s.prototype.alreadyShown={},s.prototype.shown=!1,s.prototype.className="popover popover--notifications right js-notificationsContainer",s.prototype.attributes={role:"tooltip"},s.prototype.events={"click .js-mark":"markAllAsRead",click:"stopPropagation"},s.prototype.elements={".js-mark":"mark",".js-noNotifications":"noNotifications",".js-item":"item",".js-content":"content",".js-header":"header"},s.prototype.release=function(){return $(window).off("click.notifications"),$(window).off("keydown.notifications"),s.__super__.release.apply(this,arguments)},s.prototype.access=function(){return!!this.Session.get()},s.prototype.listNavigate=function(t){if(27===t.keyCode)this.hide();else if(38===t.keyCode)t.preventDefault(),this.nudge(t,-1);else if(40===t.keyCode)t.preventDefault(),this.nudge(t,1);else if(13===t.keyCode)return this.$(".js-item").filter(".is-hover").find(".js-locationVerify").click()},s.prototype.nudge=function(t,e){var n,i,s,r;if((n=(i=this.$(".js-item")).filter(".is-hover")).size())return 1===e?(s=n.next(".js-item")).size()&&(n.removeClass("is-hover"),s.addClass("is-hover")):(r=n.prev(".js-item")).size()&&(n.removeClass("is-hover"),r.addClass("is-hover")),s&&this.scrollToIfNeeded(s,!0),r?this.scrollToIfNeeded(r,!1):void 0;i.first().addClass("is-hover")},s.prototype.counterUpdate=function(t,e){if(null==e&&(e=!1),0===t&&(t=""),e||this.count!==t)return this.count=t,$(".js-notificationsCounter").text(t),App.Event.trigger("online_notification_counter",t.toString()),t?this.mark.removeClass("hide"):this.mark.addClass("hide")},s.prototype.counterGen=function(t){var e,n,i,s;for(null==t&&(t=!1),n=e=0,s=(i=App.OnlineNotification.all()).length;n<s;n++)i[n].seen||e++;return this.counterUpdate(e,t),_.isEmpty(i)?(this.noNotifications.removeClass("hide"),this.el.addClass("is-empty")):(this.noNotifications.addClass("hide"),this.el.removeClass("is-empty"))},s.prototype.markAllAsRead=function(t){return t.preventDefault(),this.counterUpdate(0),this.ajax({id:"markAllAsRead",type:"POST",url:this.apiPath+"/online_notifications/mark_all_as_read",data:JSON.stringify(""),processData:!0,success:(e=this,function(){return e.fetch()})});var e},s.prototype.fetch=function(){var t,e;return e=this,t=function(){return e.fetchedData=!0},App.OnlineNotification.fetchFull(t,{clear:!0,force:!0})},s.prototype.toggle=function(){return this.shown?this.hide():this.show()},s.prototype.createContainer=function(){var t,e;if(this.Session.get()){if(t="",e=$(App.view("widget/online_notification")({count:t})),new App.OnlineNotificationContentWidget({el:e.find(".js-items"),container:this}),this.html(e),this.counterGen(!0),this.shown)return this.show()}else this.content.html("")},s.prototype.show=function(){if(this.access())return $(window).on("keydown.notifications",this.listNavigate),this.shown=!0,this.el.addClass("is-visible")},s.prototype.hide=function(){return $(window).off("keydown.notifications"),this.shown=!1,this.el.removeClass("is-visible")},s.prototype.stopPropagation=function(t){return t.stopPropagation()},s.prototype.remove=function(){return this.el.remove()},s}(App.Controller),App.OnlineNotificationContentWidget=function(t){function e(){return this.onClick=r(this.onClick,this),this.onRenderEnd=r(this.onRenderEnd,this),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.model="OnlineNotification",e.prototype.template="widget/online_notification_item",e.prototype.prepareForObjectListItemSupport=!0,e.prototype.observe={seen:!0},e.prototype.sortBy="created_at",e.prototype.order="DESC",e.prototype.alreadyShown={},e.prototype.insertPosition="before",e.prototype.globalRerender=!1,e.prototype.onRenderEnd=function(){var t,e,n,i,s,r;for(this.container.counterGen(),s=[],t=0,i=(n=App.OnlineNotification.search({sortBy:"created_at",order:"DESC"})).length;t<i;t++)e=n[t],this.alreadyShown[e.id]?s.push(void 0):(this.alreadyShown[e.id]=!0,e.seen?s.push(void 0):this.container.fetchedData?(r=(e=this.prepareForObjectListItem(e)).objectNative&&e.objectNative.activityMessage?e.objectNative.activityMessage(e):"Need objectNative in item "+e.object+".find("+e.o_id+")",r=App.Utils.html2text(r.replace(/<.+?>/g,'"')),this.notifyDesktop({url:e.link,title:r}),s.push(App.OnlineNotification.play())):s.push(void 0));return s},e.prototype.onClick=function(){return this.container.hide()},e}(App.CollectionController)}.call(this),function(){var h,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetOrganization=function(t){function e(){this.update=n(this.update,this),this.render=n(this.render,this),this.release=n(this.release,this),e.__super__.constructor.apply(this,arguments),this.subscribeId=App.Organization.full(this.organization_id,this.render,!1,!0)}return i(e,t),e.prototype.events={"focusout [contenteditable]":"update"},e.prototype.release=function(){return App.Organization.unsubscribe(this.subscribeId)},e.prototype.render=function(t){var e,n,i,s,r,o,a,l,c,p,u;for(n in t||(t=this.u),l=[],c=App.Organization.attributesGet("view"))e=c[n],(a=(o=n).substr(0,o.length-3))in t&&(o=a),"name"!==o&&e.shown&&(null!=t[o]&&""!==t[o]||"richtext"===e.tag)&&l.push(e);for(i=$(App.view("widget/organization")({organization:t,organizationData:l})),s=0,r=(p=t.members).length;s<r;s++)u=p[s],new h({object_id:u.id,el:i.find("div.userList-row[data-id="+u.id+"]")});return this.html(i),this.$("[contenteditable]").ce({mode:"textonly",multiline:!0,maxlength:250})},e.prototype.update=function(t){var e,n,i,s;if(n=$(t.target).attr("data-name"),s=$(t.target).html(),(i=App.Organization.find(this.organization_id))[n]!==s)return(e={})[n]=s,i.updateAttributes(e),this.log("notice","update",n,s,i)},e}(App.Controller),h=function(t){function e(){return this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments)}return i(e,t),e.extend(App.PopoverProvidable),e.registerPopovers("User"),e.prototype.model="User",e.prototype.observe={firstname:!0,lastname:!0,image:!0},e.prototype.render=function(t){return this.html(App.view("organization_profile/member")({user:t,el:this.el})),this.renderPopovers()},e}(App.ObserverController)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetPlaceholder=function(t){function e(){this.update=n(this.update,this),e.__super__.constructor.apply(this,arguments),this.data||(this.data={}),this.bindElements=[],this.selector?this.bindElements=this.$(this.selector).textmodule():this.el.attr("contenteditable")?this.bindElements=this.el.textmodule():this.bindElements=this.$("[contenteditable]").textmodule(),App.Setting.subscribe(this.update,{initFetch:!0})}return i(e,t),e.prototype.update=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T,A,S,C,x,j,P,I,E,D,O,N,R,M,L,U,z;for(t=[],o={password:!0,active:!0},a={password:!0,active:!0,created_at:!0,updated_at:!0},r=0,d=(C=this.objects).length;r<d;r++)if(l=C[r],w={},App[l.object]&&App[l.object].configure_attributes){for(c=0,f=(x=App[l.object].configure_attributes).length;c<f;c++)o[(e=x[c]).name]||"_ids"===e.name.substr(e.name.length-4,e.name.length)||(w[e.name]=e);for(p=0,m=(j=_.keys(w).sort()).length;p<m;p++)if(e=w[A=j[p]],A="#{"+l.prefix+"."+e.name+"}",n="#{"+l.prefix+"."+e.name+"}",e.relation){if(L={name:"Name"},App[e.relation]&&App[e.relation].configure_attributes){for(U={},L={},h=0,g=(P=App[e.relation].configure_attributes).length;h<g;h++)a[(M=P[h]).name]||"_id"===M.name.substr(M.name.length-3,M.name.length)||"_ids"===M.name.substr(M.name.length-4,M.name.length)||(U[M.name]=M);for(k=0,v=(I=_.keys(U).sort()).length;k<v;k++)L[z=I[k]]=U[z].display}for(u in O=l.prefix+"."+e.name.substr(0,e.name.length-3),L)i=L[u],n=A="#{"+O+"."+u+"}",t.push({id:A,keywords:A,name:App.i18n.translateInline(l.display)+" > "+App.i18n.translateInline(e.display)+" > "+App.i18n.translateInline(i),content:n})}else t.push({id:A,keywords:A,name:App.i18n.translateInline(l.display)+" > "+App.i18n.translateInline(e.display),content:n})}for(T=0,y=(E=App.Setting.all()).length;T<y;T++)(R=E[T]).frontend&&R.preferences&&R.preferences.placeholder&&(A=App.i18n.translateInline("Config")+" > "+App.i18n.translateInline(R.title),n="#{config."+R.name+"}",t.push({id:R.name,keywords:R.name,name:A,content:n}));if(this.bindElements[0]){for(N=[],S=0,b=(D=this.bindElements).length;S<b;S++)s=D[S],$(s).data().plugin_textmodule?N.push($(s).data().plugin_textmodule.collection=t):N.push(void 0);return N}},e}(App.Controller)}.call(this),function(){var t,e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function n(){var e;n.__super__.constructor.apply(this,arguments),App.Event.bind("remote_task",(e=this,function(t){return console.log("remote_task",t),App.TaskManager.execute(t),e.navigate(t.url)}),"remote_task")}return e(n,t),n.prototype.serverRestarted=!1,n}(App.Controller),App.Config.set("remote_task",t,"Widgets")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ScriptSnipped=function(t){function e(){this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.elements={".js-code":"code"},e.prototype.render=function(){return this.html(App.view("widget/script_snipped")({header:this.header||"Usage",description:this.description,style:this.style,content:this.content})),this.code.each(function(t,e){return hljs.highlightBlock(e)})},e}(App.Controller)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.bind()}return n(e,t),e.prototype.bind=function(){var t,e;return App.Event.bind("spool:sent",(t=this,function(){return t.spoolSent=!0,App.WebSocket.send({event:"broadcast",spool:!0,recipient:{user_id:[App.Session.get("id")]},data:{event:"session:takeover",data:{taskbar_id:App.TaskManager.TaskbarId()}}})}),"maintenance"),App.Event.bind("session:takeover",(e=this,function(t){if(e.spoolSent)return e.error||t.taskbar_id===App.TaskManager.TaskbarId()?void 0:(e.error=new App.SessionMessage({head:"Session",message:"A new session was created with your account. This session will be stopped to prevent a conflict.",keyboard:!1,backdrop:!0,buttonClose:!1,buttonSubmit:"Continue session",forceReload:!0}),e.disconnectClient())}),"maintenance")},e}(App.Controller),App.Config.set("session_taken_over",t,"Widgets")}.call(this),function(){var t,s=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function i(){var t,e,n;this.switchBack=s(this.switchBack,this),i.__super__.constructor.apply(this,arguments),this.bind("app:ready",(t=this,function(){return t.render()})),this.bind("ui:rerender",(e=this,function(){return e.render()})),this.bind("auth:logout",(n=this,function(){return App.Config.set("switch_back_to_possible",!1),n.render()}))}return e(i,t),i.prototype.className="switchBackToUser",i.prototype.render=function(){var e;{if(App.Config.get("switch_back_to_possible")&&App.Session.get())return this.html(App.view("widget/switch_back_to_user")()),this.element().on("click",".js-close",(e=this,function(t){return e.switchBack(t)}));this.element().remove()}},i.prototype.switchBack=function(t){return t.preventDefault(),this.disconnectClient(),$("#app").hide().attr("style","display: none!important"),this.delay((n=this,function(){return App.Auth._logout(!1),n.ajax({id:"user_switch_back",type:"GET",url:n.apiPath+"/sessions/switch_back",success:function(t){var e;return e=window.location.protocol+"//"+window.location.host+t.location,n.windowReload(void 0,e)}})}),800);var n},i}(App.ControllerWidgetOnDemand),App.Config.set("switch_back_to_user",t,"Widgets")}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetTag=function(t){function e(){if(this.remove=n(this.remove,this),this.onRemoveTag=n(this.onRemoveTag,this),this.addItem=n(this.addItem,this),this.add=n(this.add,this),this.onAddTag=n(this.onAddTag,this),this.hideAndAddInput=n(this.hideAndAddInput,this),this.showInput=n(this.showInput,this),this.render=n(this.render,this),this.reload=n(this.reload,this),this.fetch=n(this.fetch,this),this.addInput=n(this.addInput,this),e.__super__.constructor.apply(this,arguments),this.key="tags::"+this.object_type+"::"+this.object.id,this.tags)return this.localTags=_.clone(this.tags),void this.render();this.fetch()}return i(e,t),e.prototype.editMode=!1,e.prototype.pendingRefresh=!1,e.prototype.possibleTags={},e.prototype.elements={".js-newTagLabel":"newTagLabel",".js-newTagInput":"newTagInput"},e.prototype.events={"click .js-newTagLabel":"showInput","blur .js-newTagInput":"hideAndAddInput","keyup .js-newTagInput":"addInput","submit form":"onAddTag","click .js-delete":"onRemoveTag","click .js-tag":"searchTag"},e.prototype.addInput=function(t){if(9===t.keyCode)return this.hideAndAddInput()},e.prototype.fetch=function(){return this.pendingRefresh=!1,App[this.object_type].tagGet(this.object.id,this.key,(e=this,function(t){return e.localTags=t.tags,e.render()}));var e},e.prototype.reload=function(t){if(!this.editMode)return this.localTags=_.clone(t),this.render();this.pendingRefresh=!0},e.prototype.render=function(){var t,a;if(!this.lastLocalTags||!_.isEqual(this.lastLocalTags,this.localTags))return this.lastLocalTags=_.clone(this.localTags),this.html(App.view("widget/tag")({tags:this.localTags||[]})),t=App.Config.get("api_path")+"/tag_search",this.$(".js-newTagInput").autocomplete({source:t,minLength:0,response:(a=this,function(t,e){var n,i,s,r,o;if(e&&e.content){for(o=[],n=0,s=(r=e.content).length;n<s;n++)i=r[n],o.push(a.possibleTags[i.value]=!0);return o}})})},e.prototype.showInput=function(t){return t.preventDefault(),this.newTagLabel.addClass("hide"),this.newTagInput.removeClass("hide").focus(),this.newTagInput.trigger(jQuery.Event("keydown")),this.editMode=!0},e.prototype.hideAndAddInput=function(){return this.newTagLabel.removeClass("hide"),this.newTagInput.addClass("hide"),this.onAddTag(),this.editMode=!1},e.prototype.onAddTag=function(t){var e;if(t&&t.preventDefault(),e=this.$('[name="new_tag"]').val().trim())return this.add(e);this.pendingRefresh&&this.fetch()},e.prototype.add=function(t,e){var n,i,s,r,o;for(null==e&&(e=""),o=[],n=0,s=(r=t.split(",")).length;n<s;n++)i=(i=r[n]).trim(),o.push(this.addItem(i,e));return o},e.prototype.addItem=function(t,e){if(null==e&&(e=""),_.contains(this.localTags,t))this.render();else if("macro"===e||!1!==App.Config.get("tag_new")||this.possibleTags[t])return this.localTags.push(t),this.render(),App[this.object_type].tagAdd(this.object.id,t)},e.prototype.onRemoveTag=function(t){var e;if(t.preventDefault(),e=$(t.target).parents("li").find(".js-tag").text())return this.remove(e)},e.prototype.remove=function(e){return this.localTags=_.filter(this.localTags,function(t){if(t!==e)return t}),this.render(),App[this.object_type].tagRemove(this.object.id,e)},e.prototype.searchTag=function(t){var e;return t.preventDefault(),e=$(t.target).text(),App.GlobalSearchWidget.search(e,"tags")},e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetTemplate=function(t){function e(){this.create=n(this.create,this),this.select=n(this.select,this),this["delete"]=n(this["delete"],this),this.render=n(this.render,this),this.release=n(this.release,this),e.__super__.constructor.apply(this,arguments),this.subscribeId=App.Template.subscribe(this.render,{initFetch:!0}),this.render()}return i(e,t),e.prototype.events={"click .templates-manage .js-save":"create","click .templates-manage .js-apply":"select","click .templates-manage .js-delete":"delete","click .templates-welcome .js-create":"showManage"},e.prototype.release=function(){return App.Template.unsubscribe(this.subscribeId)},e.prototype.render=function(){var t;return this.configure_attributes=[{name:"id",display:"",tag:"select",multiple:!1,"null":!0,nulloption:!0,relation:"Template","default":this.id}],t={},this.id&&App.Template.exists(this.id)&&(t=App.Template.find(this.id)),this.html(App.view("widget/template")({template:t})),new App.ControllerForm({el:this.el.find("#form-template"),model:{configure_attributes:this.configure_attributes},autofocus:!1}),0===App.Template.all().length?this.showWelcome():this.showManage()},e.prototype.showManage=function(t){return t&&t.preventDefault(),this.el.find(".templates-manage").show(),this.el.find(".templates-welcome").hide()},e.prototype.showWelcome=function(t){return t&&t.preventDefault(),this.el.find(".templates-manage").hide(),this.el.find(".templates-welcome").show()},e.prototype["delete"]=function(t){var e,n;if(t.preventDefault(),(e=this.formParam(t.target)).id)return n=App.Template.find(e.id),confirm("Sure?")?(this.id=!1,n.destroy()):void 0},e.prototype.select=function(t){var e,n;if(t.preventDefault(),(e=this.formParam(t.target)).id)return this.id=e.id,n=App.Template.find(e.id),App.Event.trigger("ticket_create_rerender",n.attributes())},e.prototype.create=function(t){var e,n,i,s,r,o,a;if(t.preventDefault(),n=this.formParam($(t.target).closest(".content").find(".ticket-create")),i=(s=this.formParam(t.target)).name)return(r=App.Template.findByAttribute("name",i))||(r=new App.Template),r.load({name:s.name,options:n}),(e=r.validate())?this.log("error",e):(o=this,r.save({done:function(){return o.id=this.id},fail:(a=this,function(){return a.log("error","save failed!")})}))},e}(App.Controller)}.call(this),function(){var i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetTextModule=function(t){function n(){var e;this.update=i(this.update,this),this.currentCollection=i(this.currentCollection,this),this.reload=i(this.reload,this),this.release=i(this.release,this),n.__super__.constructor.apply(this,arguments),this.data||(this.data={}),this.bindElements=[],this.selector?this.bindElements=this.$(this.selector).textmodule():this.el.attr("contenteditable")?this.bindElements=this.el.textmodule():this.bindElements=this.$("[contenteditable]").textmodule(),this.update(),this.subscribeId=App.TextModule.subscribe(this.update,{initFetch:!0}),this.bind("TextModulePreconditionUpdate",(e=this,function(t){if(t.taskKey===e.taskKey)return e.searchCondition=t.params,e.update()}))}return e(n,t),n.prototype.searchCondition={},n.prototype.release=function(){return App.TextModule.unsubscribe(this.subscribeId)},n.prototype.reload=function(t){if(t)return this.data=t,this.update()},n.prototype.currentCollection=function(){return this.all},n.prototype.update=function(){var t,e,n,i,s,r,o,a,l,c;for(t=App.TextModule.all(),this.all=[],i=0,o=t.length;i<o;i++)!0===(s=t[i]).active&&(_.isEmpty(s.group_ids)||!this.searchCondition.group_id||_.includes(s.group_ids,parseInt(this.searchCondition.group_id)))&&((e=s.attributes()).content=App.Utils.replaceTags(e.content,this.data),this.all.push(e));if(this.bindElements[0]){for(c=[],r=0,a=(l=this.bindElements).length;r<a;r++)n=l[r],$(n).data().plugin_textmodule?c.push($(n).data().plugin_textmodule.collection=this.all):c.push(void 0);return c}},n}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketList=function(t){function e(){this.render=n(this.render,this),this.hide=n(this.hide,this),this.show=n(this.show,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.extend(App.PopoverProvidable),e.registerPopovers("Organization","User"),e.prototype.show=function(){if(this.table)return this.table.show()},e.prototype.hide=function(){if(this.table)return this.table.hide()},e.prototype.render=function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f;for(f=this,function(t){var e;return e=App.Ticket.findNative(t),f.navigate(e.uiUrl())},s=function(t){var e;return e={name:"icon_priority",display:"",translation:!1,width:"22px",displayWidth:22,unresizable:!0},t.unshift(0),t[0]=e,t},i=function(t,e,n){var i;return" ",i=App.TicketPriority.findNative(e.priority_id),n.title=App.i18n.translateInline(null!=i?i.name:void 0),e.priorityIcon()},e=[n=function(t){var e;return e={name:"icon",display:"",translation:!1,width:"28px",displayWidth:28,unresizable:!0},t.unshift(0),t[0]=e,t}],t={icon:[function(t,e,n){return t=" ",n["class"]=e.iconClass(),n.link="",n.title=e.iconTitle(),t}],customer_id:[a=function(t,e,n){var i;return e?(i=void 0,"customer_id"===n.name&&(i=e.customer_id),"owner_id"===n.name&&(i=e.owner_id),i&&(n["class"]="user-popover",n.data={id:i}),t):t}],organization_id:[function(t,e,n){return e&&e.organization_id&&(n["class"]="organization-popover",n.data={id:e.organization_id}),t}],owner_id:[a],title:[r=function(t,e,n){return n.link=e.uiUrl(),t},o=function(t,e,n){return n.title=e.title,t}],number:[r,o]},!0===App.Config.get("ui_ticket_overview_priority_icon")&&(e=[n,s],t.icon_priority=[i]),p=[],l=0,c=(u=this.ticket_ids).length;l<c;l++)d=u[l],h=App.Ticket.fullLocal(d),p.push(h);return this.el.html(""),this.table=new App.ControllerTable({tableId:this.tableId,el:this.el,overview:this.columns||["number","title","customer","group","created_at"],model:App.Ticket,objects:p,callbackHeader:e,callbackAttributes:t,radio:this.radio}),this.renderPopovers()},e}(App.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.TicketStats=function(t){function e(){var t;this.render=n(this.render,this),this.showUserTab=n(this.showUserTab,this),this.showOrgTab=n(this.showOrgTab,this),this.load=n(this.load,this),this.release=n(this.release,this),e.__super__.constructor.apply(this,arguments),this.user?this.subscribeIdUser=App.User.full(this.user.id,this.load,!1,!0):this.organization&&(this.subscribeIdOrganization=App.Organization.full(this.organization.id,this.load,!1,!0)),this.bind("ui:rerender",(t=this,function(){if(t.authenticateCheck())return t.render()}))}return i(e,t),e.prototype.elements={".js-userTab":"userTabButton",".js-orgTab":"orgTabButton",".js-user":"userTab",".js-org":"orgTab"},e.prototype.events={"click .js-userTab":"showUserTab","click .js-orgTab":"showOrgTab"},e.prototype.release=function(){if(this.subscribeIdUser&&App.User.unsubscribe(this.subscribeIdUser),this.subscribeIdOrganization)return App.Organization.unsubscribe(this.subscribeIdOrganization)},e.prototype.load=function(t,e){var n,i,s;if("change"!==e)return this.organization?(n="org_"+this.organization.id,i={organization_id:this.organization.id}):(n="user_"+this.user.id,i={user_id:this.user.id,organization_id:this.user.organization_id}),this.ajax({id:"ticket_stats_"+n,type:"GET",url:this.apiPath+"/ticket_stats",data:i,processData:!0,success:(s=this,function(t){return App.Collection.loadAssets(t.assets),s.data=t,s.render(t)})})},e.prototype.showOrgTab=function(){return this.userTabButton.removeClass("active"),this.orgTabButton.addClass("active"),this.userTab.addClass("hide"),this.orgTab.removeClass("hide")},e.prototype.showUserTab=function(){return this.userTabButton.addClass("active"),this.orgTabButton.removeClass("active"),this.userTab.removeClass("hide"),this.orgTab.addClass("hide")},e.prototype.render=function(t){var e,n,i,s;if(t||(t=this.data),t)return s=0,t.user.open_ids&&t.user.closed_ids&&(s=t.user.open_ids.length+t.user.closed_ids.length),i=0,t.organization.open_ids&&t.organization.closed_ids&&(i=t.organization.open_ids.length+t.organization.closed_ids.length),this.html(App.view("widget/ticket_stats")({user:this.user,user_total:s,organization:this.organization,organization_total:i})),n=5,_.isEmpty(t.user)||(e="",0===t.user.open_ids.length&&0<t.user.closed_ids.length&&(e="mood icon supergood-color"),new App.TicketStatsList({el:this.$(".js-user-open-tickets"),user:this.user,head:"Open Tickets",iconClass:e,ticket_ids:t.user.open_ids,limit:n}),new App.TicketStatsList({el:this.$(".js-user-closed-tickets"),user:this.user,head:"Closed Tickets",ticket_ids:t.user.closed_ids,limit:n}),new App.TicketStatsFrequency({el:this.$(".js-user-frequency"),user:this.user,ticket_volume_by_year:t.user.volume_by_year})),_.isEmpty(t.organization)?void 0:(e="",0===t.organization.open_ids.length&&0<t.organization.closed_ids.length&&(e="mood icon supergood-color"),new App.TicketStatsList({el:this.$(".js-org-open-tickets"),user:this.user,head:"Open Tickets",iconClass:e,ticket_ids:t.organization.open_ids,limit:n}),new App.TicketStatsList({el:this.$(".js-org-closed-tickets"),user:this.user,head:"Closed Tickets",ticket_ids:t.organization.closed_ids,limit:n}),new App.TicketStatsFrequency({el:this.$(".js-org-frequency"),user:this.user,ticket_volume_by_year:t.organization.volume_by_year}))},e}(App.Controller),App.TicketStatsList=function(t){function e(){this.showAll=n(this.showAll,this),this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.extend(App.PopoverProvidable),e.registerPopovers("Ticket"),e.prototype.events={"click .js-showAll":"showAll"},e.prototype.render=function(){var t,e,i,n,s,r,o,a;if(o=[],this.all)o=this.ticket_ids;else for(e=t=0,n=(s=this.ticket_ids).length;e<n;e++)r=s[e],(t+=1)<=this.limit&&o.push(r);return a=function(){var t,e,n;for(n=[],t=0,e=o.length;t<e;t++)i=o[t],n.push(App.Ticket.fullLocal(i));return n}(),this.html(App.view("widget/ticket_stats_list")({user:this.user,head:this.head,iconClass:this.iconClass,ticketList:App.view("generic/ticket_list")({tickets:a}),ticket_ids:this.ticket_ids,ticket_ids_show:o,limit:this.limit})),this.renderPopovers()},e.prototype.showAll=function(t){return t.preventDefault(),this.all=!0,this.render(
)},e}(App.Controller),App.TicketStatsFrequency=function(t){function e(){this.render=n(this.render,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.render=function(){var t,e,n,i,s,r,o,a;for(t=r=0,i=(o=this.ticket_volume_by_year).length;t<i;t++)(e=o[t]).closed>r&&(r=e.closed),e.created>r&&(r=e.created);for(n=0,s=(a=this.ticket_volume_by_year).length;n<s;n++)(e=a[n]).created_in_percent=100/r*e.created,e.closed_in_percent=100/r*e.closed;return this.html(App.view("widget/ticket_stats_frequency")({ticket_volume_by_year:this.ticket_volume_by_year.reverse()}))},e}(App.Controller)}.call(this),function(){var t,i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function n(){var t,e;this.toogle=i(this.toogle,this),this.rebind=i(this.rebind,this),n.__super__.constructor.apply(this,arguments),this.rebind(),App.Event.bind("auth",(t=this,function(){return t.rebind()})),App.Event.bind("i18n:inline_translation",(e=this,function(){return e.toogle()}))}return e(n,t),n.prototype.rebind=function(){var n,i;if($(document).off("keydown.translation"),this.permissionCheck("admin.translation"))return n=App.Browser.hotkeys(),$(document).on("keydown.translation",(i=this,function(t){var e;if(e=!1,"ctrl+shift"===n?!t.altKey&&t.ctrlKey&&!t.metaKey&&t.shiftKey&&(e=!0):t.altKey&&t.ctrlKey&&!t.metaKey&&(e=!0),e&&84===t.keyCode)return t.preventDefault(),i.toogle()}))},n.prototype.toogle=function(){return this.active?($(".translation:focus").trigger("blur"),this.disable(),void(this.active=!1)):(this.enable(),this.active=!0)},n.prototype.enable=function(){var t;return t=App.i18n.meta(),!this.mapLoaded&&t&&t.mapToLoad&&(this.mapLoaded=!0,App.Translation.refresh(t.mapToLoad,{clear:!0})),App.Config.set("translation_inline",!0),this.observer=new MutationObserver(function(t){return t.forEach(function(t){return t.addedNodes.forEach(function(t){return $(t).find("span.translation").on("click.translation",function(t){return t.stopPropagation(),!1}),$(t).find("span.translation").on("keydown.translation",function(t){return t.stopPropagation(),!0})}),t.removedNodes.forEach(function(t){return $(t).find("span.translation").off(".translation")})})}),this.observer.observe(document.body,{subtree:!0,childList:!0}),App.Event.trigger("ui:rerender"),$("body").on("focus.translation",".translation",function(t){var e;return(e=$(t.target)).data("before",e.text()),e}).on("blur.translation",".translation",function(t){var e,n,i,s,r;if((n=(e=$(t.target)).attr("title"))&&(r=e.text(),e.data("before")!==r))return App.Log.debug("translation_inline","translate update",r,"before",e.data),e.data("before",r),App.i18n.setMap(n,r),i=n.replace("'","\\'"),$(".translation[title='"+i+"']").text(r),(s=App.Translation.findByAttribute("source",n))?s.updateAttribute("target",r):((s=new App.Translation).load({locale:App.i18n.get(),source:n,target:r,target_initial:""}),s.save()),e})},n.prototype.disable=function(){return this.observer.disconnect(),$("body").off(".translation"),App.Config.set("translation_inline",!1),App.Event.trigger("ui:rerender")},n}(App.Controller),App.Config.set("translation_inline",t,"Widgets")}.call(this),function(){var r,t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty,i=function(t,e){return function(){return t.apply(e,arguments)}};t=function(t){function s(){var t,n,e,i;s.__super__.constructor.apply(this,arguments),t=function(){var t,e;if(n.Config.get("system_init_done")&&App.i18n.notTranslatedFeatureEnabled(App.i18n.get())&&n.permissionCheck("admin.translation")&&!(window.location.hash.toString().match(/getting/)||(t=App.i18n.meta(),95<(e=parseInt(t.translated/(t.total/100))))))return new r({percent:e})},(n=this).bind("i18n:language:change",(e=this,function(){return e.delay(t,2500,"translation_support")})),this.bind("auth:login",(i=this,function(){return i.delay(t,2500,"translation_support")}))}return n(s,t),s}(App.Controller),App.Config.set("translaton_support",t,"Widgets"),r=function(t){function e(){this.onSubmit=i(this.onSubmit,this),this.onCancel=i(this.onCancel,this),this.content=i(this.content,this),e.__super__.constructor.apply(this,arguments),App.LocalStorage.get("translation_support_no",this.Session.get("id"))||this.render()}return n(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel="No Thanks!",e.prototype.buttonSubmit="Complete translations",e.prototype.head="Help to improve Zammad!",e.prototype.shown=!1,e.prototype.content=function(){var t;return t=!1,80<this.percent&&(t=!0),App.view("translation/support")({percent:this.percent,better:t})},e.prototype.onCancel=function(){return App.LocalStorage.set("translation_support_no",!0,this.Session.get("id")),this.close()},e.prototype.onSubmit=function(){return this.navigate("#system/translation"),this.close()},e}(App.ControllerModal)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WidgetUser=function(t){function e(){this.update=n(this.update,this),this.render=n(this.render,this),this.release=n(this.release,this),e.__super__.constructor.apply(this,arguments),this.subscribeId=App.User.full(this.user_id,this.render,!1,!0)}return i(e,t),e.extend(App.PopoverProvidable),e.registerPopovers("UserTicket"),e.prototype.events={"focusout [contenteditable]":"update"},e.prototype.release=function(){return App.User.unsubscribe(this.subscribeId)},e.prototype.render=function(t){var e,n,i,s,r,o,a,l,c;for(n in this.callback&&this.callback(t),c=[],a=App.User.attributesGet("view"))e=a[n],(o=(r=n).substr(0,r.length-3))in t&&(r=o),"firstname"!==r&&"lastname"!==r&&"organization"!==r&&e.shown&&(null!=t[r]&&""!==t[r]||"richtext"===e.tag)&&c.push(e);return t.preferences&&(s=[],0<t.preferences.tickets_open&&(i={url:"",name:"open",count:t.preferences.tickets_open,title:"Open Tickets","class":"user-tickets",data:"open"},s.push(i)),0<t.preferences.tickets_closed&&(i={url:"",name:"closed",count:t.preferences.tickets_closed,title:"Closed Tickets","class":"user-tickets",data:"closed"},s.push(i)),s[0]&&(l={title:"Tickets",items:s},t.links=[],t.links.push(l))),this.html(App.view("widget/user")({header:"Customer",edit:!0,user:t,userData:c})),this.$("[contenteditable]").ce({mode:"textonly",multiline:!0,maxlength:250}),this.renderPopovers({selector:".user-tickets",user_id:t.id})},e.prototype.update=function(t){var e,n,i,s;if(n=$(t.target).attr("data-name"),s=$(t.target).html(),(i=App.User.find(this.user_id))[n]!==s)return(e={})[n]=s,i.updateAttributes(e),this.log("notice","update",n,s,i)},e}(App.Controller)}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/agent_ticket_create"]=function(t){t||(t={});var o=[],a=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r;if(o.push('<div class="tabsSidebar-holder flex">\n  <div class="main no-padding flex tabsSidebar-sidebarSpacer tabsSidebar-tabsSpacer">\n    <div class="newTicket">\n      <div class="box box--newTicket">\n        <div class="page-header">\n          <h1>'),o.push(this.T(this.head)),o.push('</h1>\n        </div>\n\n        <div class="page-content">\n          '),!_.isEmpty(this.availableTypes)&&1<this.availableTypes.length){for(o.push('\n            <ul class="tabs type-tabs">\n              '),t=0,e=(i=this.availableTypes).length;t<e;t++)r=i[t],o.push('\n                <li class="tab u-textTruncate" data-type="'),o.push(a(r)),o.push('">\n                  '),o.push(this.Icon(this.types[r].icon,"tab-icon")),o.push("\n                  "),o.push(this.T(this.types[r].label)),o.push("\n                </li>\n              ");o.push("\n            </ul>\n          ")}if(o.push("\n\n          "),!_.isEmpty(this.C("ui_ticket_create_notes"))){for(r in o.push("\n            "),s=this.C("ui_ticket_create_notes"))n=s[r],o.push('\n              <div class="alert alert--warning js-note" role="alert" data-type="'),o.push(a(r)),o.push('">'),o.push(this.T(n)),o.push("</div>\n            ");o.push("\n          ")}o.push('\n\n          <form role="form" class="ticket-create">\n            <input type="hidden" name="formSenderType"/>\n            <input type="hidden" name="form_id" value="'),o.push(a(this.form_id)),o.push('"/>\n            <div class="ticket-form-top"></div>\n            <div class="form-group js-securityOptions hide">\n              <div class="formGroup-label">\n                <label for="">'),o.push(this.T("Security")),o.push('</label>\n              </div>\n              <div class="horizontal">\n                <span class="js-securityEncryptComment">\n                  <div class="btn btn--action js-securityEncrypt js-active-toggle" disabled>'),o.push(this.Icon("lock-open","btn-inactive-icon")),o.push(this.Icon("lock","btn-active-icon")),o.push(this.T("Encrypt")),o.push('</div>\n                </span>\n                <span class="js-securitySignComment" style="margin-left: 10px;">\n                  <div class="btn btn--action js-securitySign js-active-toggle" disabled>'),o.push(this.Icon("not-signed","btn-inactive-icon")),o.push(this.Icon("signed","btn-active-icon")),o.push(this.T("Sign")),o.push('</div>\n                </span>\n              </div>\n            </div>\n            <div class="article-form-top"></div>\n            <div class="formset-inset">\n              <div class="ticket-form-middle horizontal two-columns"></div>\n              <div class="ticket-form-bottom"></div>\n            </div>\n\n            <div class="form-controls">\n              <a class="btn btn--text btn--subtle js-cancel" href="#/">'),o.push(this.T("Cancel & Go Back")),o.push('</a>\n              <button type="submit" class="btn btn--success js-submit align-right">'),o.push(this.T("Create")),o.push('</button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="tabsSidebar vertical"></div>\n</div>\n<!--\n<div class="sidebar">\n  <div class="widgets">\n    <div class="customer_info">\n      <div class="drox"><!-- Customer Info -/->\n        <div class="drox-header">\n          <h2>Customer Info</h2>\n        </div>\n        <div class="drox-body">\n          <p>\n            <span class="customer-name">Benjamin Wahlers</span>\n            <span class="customer-email u-highlight">benjamin@wahlers.de</span>\n          </p>\n          <div class="form-group">\n            <label for="customer-info-note">'),o.push(this.T("Note")),o.push('</label>\n            <textarea class="form-control" id="customer-info-note" rows="5">Not assigned</textarea>\n          </div>\n          <label>'),o.push(this.T("Tickets")),o.push('</label>\n          <ol class="tasks tasks--standalone"> <!-- vaguely based on task_widget_tasks.jst.eco -/->\n            <li class="task level-1">\n              <div class="icon-holder">\n                <div class="priority icon"></div>\n              </div>\n              <div class="task-text">\n                <div class="name">Micro-SIM doesn\'t work</div>\n                <div class="time">23 minutes ago</div>\n              </div>\n            <li class="task level-3">\n              <div class="icon-holder">\n                <div class="priority icon"></div>\n              </div>\n              <div class="task-text">\n                <div class="name">Superb Service!</div>\n                <div class="time">43 minutes ago</div>\n              </div>\n            <li class="task level-2">\n              <div class="icon-holder">\n                <div class="priority icon"></div>\n              </div>\n              <div class="task-text">\n                <div class="name">Print sheets strip off</div>\n                <div class="time">1 hour ago</div>\n              </div>\n            <li class="task level-3">\n              <div class="icon-holder">\n                <div class="priority icon"></div>\n              </div>\n              <div class="task-text">\n                <div class="name">Block not properly wrought</div>\n                <div class="time">2 hour ago</div>\n              </div>\n          </ol>\n        </div>\n      </div>\n    </div>\n    <div class="ticket_template">\n      <div class="drox hide"><!-- Template Wizard Step One -/->\n        <div class="drox-header">\n          <h2>'),o.push(this.T("Choose Template")),o.push('</h2>\n        </div>\n        <div class="drox-body">\n          <p>'),o.push(this.T("No template created yet.")),o.push("</p>\n          <p>"),o.push(this.T("With templates you can pre-fill ticket attributes.")),o.push("</p>\n          <p>"),o.push(this.T("Choose attributes and then save them as a new template.")),o.push('</p>\n          <p><a class="create u-clickable">'),o.push(this.T("Save new template")),o.push('</a></p>\n        </div>\n      </div>\n      <div class="drox hide"><!-- Template Wizard Step Two -/->\n        <div class="drox-header">\n          <h2>'),o.push(this.T("Create Template")),o.push('</h2>\n        </div>\n        <div class="drox-body">\n          <form>\n            <div class="form-group">\n              <label for="template-title">'),o.push(this.T("Template Title")),o.push(':</label>\n              <input class="form-control" id="template-title" placeholder="'),o.push(this.Ti("Enter Template Name")),o.push('">\n            </div>\n            <p>'),o.push(this.T("This template saves the following attributes")),o.push(':</p>\n            <ul class="template-attributes">\n              <li class="template-attribute horizontal">\n                <div class="key">'),o.push(this.T("Owner")),o.push('</div> | <div class="value flex u-textTruncate">Web-Dev</div>\n                <div class="delete u-clickable">&times;</div>\n              <li class="template-attribute horizontal">\n                <div class="key">'),o.push(this.T("Type")),o.push('</div> | <div class="value flex u-textTruncate">Question</div>\n                <div class="delete u-clickable">&times;</div>\n              <li class="template-attribute horizontal">\n                <div class="key">'),o.push(this.T("Status")),o.push('</div> | <div class="value flex u-textTruncate">open</div>\n                <div class="delete u-clickable">&times;</div>\n              <li class="template-attribute horizontal">\n                <div class="key">'),o.push(this.T("Priority")),o.push('</div> | <div class="value flex u-textTruncate">high</div>\n                <div class="delete u-clickable">&times;</div>\n              <li class="template-attribute horizontal">\n                <div class="key">'),o.push(this.T("Tag")),o.push('</div> | <div class="value flex u-textTruncate">New Website</div>\n                <div class="delete u-clickable">&times;</div>\n              <li class="template-attribute horizontal">\n                <div class="key">'),o.push(this.T("Tag")),o.push('</div> | <div class="value flex u-textTruncate">Feedback</div>\n                <div class="delete u-clickable">&times;</div>\n            </ul>\n            <div class="horizontal">\n              <button class="btn btn-primary" type="submit">'),o.push(this.T("Save Template")),o.push('</button>\n              <a class="btn btn--text btn--secondary js-cancel align-right u-clickable">'),o.push(this.T("Cancel")),o.push('</a>\n            </div>\n          </form>\n        </div>\n      </div>\n      <div class="drox hide"><!-- Template Chooser, shown instead of Template Wizard Step One when there are templates there -/->\n        <div class="drox-header">\n          <h2>'),o.push(this.T("Choose Template")),o.push('</h2>\n        </div>\n        <div class="drox-body">\n          <ul class="templates">\n            <li class="u-clickable u-highlight">Feedback New Website\n          </ul>\n          <p>'),o.push(this.T("Choose attributes and then save them as a new template.")),o.push('</p>\n          <p><a class="create u-clickable">'),o.push(this.T("Save new template")),o.push('</a></p>\n        </div>\n      </div>\n    </div>\n    <div class="text_module"></div>\n  </div>\n</div>\n-->\n')}).call(this)}.call(t),t.safe=e,t.escape=n,o.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/agent_ticket_merge"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push("<div>\n  <h4>"),e.push(this.T("Merge to Ticket#")),e.push('</h4>\n  <input type="text" name="master_ticket_number" class="form-control" value=""/>\n  <hr>\n  <h4>'),e.push(this.T("Recent Customer Tickets")),e.push('</h4>\n  <div id="ticket-merge-customer-tickets"></div>\n  <hr>\n  <h4>'),e.push(this.T("Recent viewed Tickets")),e.push('</h4>\n  <div id="ticket-merge-recent-tickets"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/agent_ticket_view/bulk"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form class="update-box bulkAction-form" role="form">\n  <div class="bulkAction-firstStep js-action-step">\n    <div id="form-ticket-bulk" class="form-inline form-inline--enclosed flex"></div>\n    <div class="btn btn--primary js-confirm">'),e.push(this.T("Confirm")),e.push('</div>\n  </div>\n  <div class="hide bulkAction-secondStep js-confirm-step">\n    <div id="form-ticket-bulk-comment" class="form-inline"></div>\n    <div class="horizontal">\n      <div id="form-ticket-bulk-typeVisibility" class="form-inline"></div>\n      <div class="bulkAction-controls">\n        <a class="btn btn--text btn--secondary js-cancel">'),e.push(this.T("Go Back")),e.push('</a>\n        <input type="submit" class="btn btn--primary js-submit" value="'),e.push(this.T("Update")),e.push('">\n      </div>\n    </div>\n  </div>\n</form>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/agent_ticket_view/content"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="page-header">\n  <div class="page-header-title">\n    <h2>'),s.push(this.T(this.overview.name)),s.push('</h2>\n  </div>\n  <div class="page-header-meta">\n    '),this.edit&&(s.push('\n      <div class="btn btn--action" data-type="settings">'),s.push(this.T("Options")),s.push("</div>\n    ")),s.push('\n    <!--\n    <ul class="pagination">\n    '),t=0,n=(i=this.view_modes).length;t<n;t++)e=i[t],s.push('\n      <li class="'),s.push(r(e["class"])),s.push('">\n        <a class="centered" href="#" data-type="viewmode" data-mode="'),s.push(r(e.type)),s.push('">'),s.push(r(e.name)),s.push("</a>\n      </li>\n    ");s.push('\n    </ul>\n    -->\n  </div>\n</div>\n\n<div class="page-content">\n  <div class="table-overview"></div>\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/agent_ticket_view/detail"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<table class="table table-striped table-hover">\n  <tr>\n    <th class="" style="width: 24px;">\n      <input type="checkbox" value="" name="bulk_all"/>\n    </th>\n    <th></th>\n  </tr>\n'),t=0,e=(n=this.objects).length;t<e;t++)i=n[t],s.push('\n  <tr data-id="'),s.push(r(i.id)),s.push('">\n    <td>\n      <input type="checkbox" value="'),s.push(r(i.id)),s.push('" name="bulk"/>\n    </td>\n    <td>\n      '),s.push(i.customer.avatar("50","","userInfo-avatar")),s.push('\n      <h2 style="margin-top: 0px;"><a href="'),s.push(i.uiUrl()),s.push('" data-type="edit">'),s.push(r(i.title||"-")),s.push('</a></h2>\n      <div class="horizontal">\n        <div class="vertical flex">\n          <table style="width: 100%;">\n            <tr>\n              <td style="width: 25%;"><label>'),s.push(this.T("Number")),s.push("</label></td><td> "),s.push(this.P(i,"number")),s.push("</td>\n            </tr>\n            <tr>\n              <td><label>"),s.push(this.T("State")),s.push("</label></td><td> "),s.push(this.P(i,"state")),s.push("</td>\n            </tr>\n            <tr>\n              <td><label>"),s.push(this.T("Group")),s.push("</label></td><td> "),s.push(this.P(i,"group")),s.push("</td>\n            </tr>\n            <tr>\n              <td><label>"),s.push(this.T("Customer")),s.push("</label></td><td> "),s.push(this.P(i,"customer")),s.push('</td>\n            </tr>\n          </table>\n        </div>\n        <div class="vertical flex">\n          <table style="width: 100%;">\n            <tr>\n              <td style="width: 25%;"><label>'),s.push(this.T("Erstellt")),s.push("</label></td><td> "),s.push(this.P(i,"created_at")),s.push("</td>\n            </tr>\n            <tr>\n              <td><label>"),s.push(this.T("Priority")),s.push("</label></td><td> "),s.push(this.P(i,"priority")),s.push("</td>\n            </tr>\n            <tr>\n              <td><label>"),s.push(this.T("Owner")),s.push("</label></td><td> "),s.push(this.P(i,"owner")),s.push("</td>\n            </tr>\n            <tr>\n              <td><label>"),s.push(this.T("Organization")),s.push("</label></td><td> "),s.push(this.P(i,"organization")),s.push("</td>\n            </tr>\n          </table>\n        </div>\n      </div>\n    </td>\n  </tr>\n");s.push("\n</table>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/agent_ticket_view/navbar"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<ul class="nav nav-pills nav-stacked">\n  '),this.items){for(s.push("\n    "),t=0,n=(i=this.items).length;t<n;t++)e=i[t],s.push("\n      <li "),e.active&&s.push('class="active"'),s.push('>\n        <a class="horizontal center" href="'),s.push(r(e.target)),s.push('">\n          <span class="local u-textTruncate">'),s.push(this.T(e.name)),s.push('</span>\n          <span class="badge badge--text">'),s.push(r(e.count)),s.push("</span>\n        </a>\n      </li>\n    ");s.push("\n  ")}s.push("\n</ul>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/agent_ticket_view/navbar_vertical"]=function(t){t||(t={});var p=[],u=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c;if(p.push('<div class="tabsHolder js-tabsHolder">\n  <div class="tabs tabs--inline tabs--big js-tabs">\n    '),this.items){for(p.push("\n      "),t=0,s=(a=this.items).length;t<s;t++)e=a[t],p.push('\n        <a class="tab js-tab'),e.active&&p.push(u(" active")),p.push('" href="'),p.push(u(e.target)),p.push('">\n          <span class="tab-name">'),p.push(this.T(e.name)),p.push('</span>\n          <span class="tab-badge">'),p.push(u(e.count)),p.push("</span>\n        </a>\n      ");for(p.push('\n      <div class="tab tab-dropdown js-toggle" data-toggle="dropdown">\n        '),p.push(this.Icon("dropdown-list")),p.push("\n        "),p.push(this.Icon("arrow-down","arrow")),p.push('\n      </div>\n      <ul class="dropdown dropdown--actions dropdown--wide dropdown-menu dropdown-menu-right js-dropdown" role="menu" aria-labelledby="userAction">\n        '),n=0,r=(l=this.items).length;n<r;n++)e=l[n],p.push('\n          <li class="js-dropdownItem hide'),e.active&&p.push(u(" active")),p.push('" role="presentation" data-target="'),p.push(u(e.target)),p.push('" role="menuitem" tabindex="-1">\n            <span class="flex u-textTruncate">'),p.push(this.T(e.name)),p.push('</span>\n            <span class="badge badge--text">'),p.push(u(e.count)),p.push("</span>\n        ");p.push("\n      </ul>\n    ")}if(p.push("\n  </div>\n</div>\n"),this.isAgent&&(p.push('\n<a class="btn btn--success btn--quad" href="#ticket/create">\n  '),p.push(this.Icon("plus")),p.push("\n</a>\n")),p.push("\n"),this.items){for(p.push('\n<div class="tabs tabs--inline tabs--big tabs-clone u-invisible js-tabsClone">\n  '),i=0,o=(c=this.items).length;i<o;i++)e=c[i],p.push('\n    <a class="tab js-tabClone'),e.active&&p.push(u(" active")),p.push('" href="'),p.push(u(e.target)),p.push('">\n      <span class="tab-name">'),p.push(this.T(e.name)),p.push('</span>\n      <span class="tab-badge">'),p.push(u(e.count)),p.push("</span>\n    </a>\n  ");p.push('\n  <div class="tab tab-dropdown js-toggle">\n    '),p.push(this.Icon("dropdown-list")),p.push("\n    "),p.push(this.Icon("arrow-down","arrow")),p.push("\n  </div>\n</div>\n")}p.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/agent_user_create"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form autocomplete="off">\n<div class="modal-dialog">\n  <div class="modal-content">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T(this.head)),e.push('</h1>\n    </div>\n    <div class="modal-body" id="form-user"></div>\n    <div class="modal-footer">\n      <a class="btn btn--text btn--subtle js-cancel" href="#/">'),e.push(this.T("Cancel & Go Back")),e.push('</a>\n      <button type="submit" class="btn btn--success js-submit align-right">'),e.push(this.T("Create")),e.push("</button>\n    </div>\n  </div>\n</div>\n</form>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/api"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header-title">\n  <h1>'),e.push(this.T("API")),e.push(" <small>"),e.push(this.T("Management")),e.push('</small></h1>\n</div>\n\n<div class="page-content">\n\n  <div class="page-header-title">\n    <div class="zammad-switch zammad-switch--small js-TokenAccess">\n       <input name="api_token_access" type="checkbox" id="api_token_access" '),App.Setting.get("api_token_access")&&e.push("checked"),e.push('>\n       <label for="api_token_access"></label>\n    </div>\n    <h2>'),e.push(this.T("Token Access")),e.push(" (HTTP Token Authentication)</h2>\n  </div>\n\n<p>"),e.push(this.T("Enable REST API using tokens (not username/email address and password). Each user needs to create own access tokens in user profile.")),e.push("</p>\n\n<p>"),e.push(this.T("Example")),e.push(':</p>\n\n<code>\ncurl -H "Authorization: Token token=YOUR_TOKEN" '),e.push(n(this.C("http_type"))),e.push("://"),e.push(n(this.C("fqdn"))),e.push('/api/v1/groups\n</code>\n\n<hr>\n\n  <div class="page-header-title">\n    <div class="zammad-switch zammad-switch--small js-PasswordAccess">\n       <input name="api_password_access" type="checkbox" id="api_password_access" '),App.Setting.get("api_password_access")&&e.push("checked"),e.push('>\n       <label for="api_password_access"></label>\n    </div>\n    <h2>'),e.push(this.T("Password Access")),e.push(" (HTTP Basic Authentication)</h2>\n  </div>\n\n<p>"),e.push(this.T("Enable REST API access using the username/email address and password for the authentication user.")),e.push("</p>\n\n<p>"),e.push(this.T("Example")),e.push(":</p>\n\n<code>\ncurl -u "),e.push(n(this.S("email"))),e.push(":some_password "),e.push(n(this.C("http_type"))),e.push("://"),e.push(n(this.C("fqdn"))),e.push('/api/v1/groups\n</code>\n\n<hr>\n\n  <div class="page-header-title">\n    <h2>'),e.push(this.T("Applications")),e.push(" (OAuth Authentication)</h2>\n    &nbsp;\n  </div>\n\n<p>"),e.push(this.T("Manage applications that can use Zammad as an OAuth provider and applications that you've authorized to use your account.")),e.push('</p>\n\n<div class="js-appList"></div>\n\n<button class="btn js-appNew">'),e.push(this.T("New Application")),e.push('</button>\n\n<br>\n<br>\n\n<div>\nOAuth URLs are:\n\n  <table class="settings-list" style="width: 100%;">\n    <thead>\n      <tr>\n        <th width="40%">'),e.push(this.T("Action")),e.push('\n        <th width="60%">'),e.push(this.T("URL")),e.push("\n    </thead>\n    <tbody>\n      <tr>\n        <td>"),e.push(this.T("Requesting the Grant")),e.push("\n        <td>"),e.push(n(this.C("http_type"))),e.push("://"),e.push(n(this.C("fqdn"))),e.push("/oauth/authorize\n      <tr>\n        <td>"),e.push(this.T("Getting an Access Token")),e.push("\n        <td>"),e.push(n(this.C("http_type"))),e.push("://"),e.push(n(this.C("fqdn"))),e.push("/oauth/token\n    </tbody>\n  </table>\n</div>\n\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/avatar"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<span class="avatar '),e.push(this.cssClass),e.push('" style="background-image: url('),e.push(this.url),e.push(')"'),e.push(this.placement),e.push(this.data),e.push(' data-initials="'),e.push(this.initials),e.push('">\n  '),this.vip&&e.push(this.Icon("crown")),e.push("\n</span>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/avatar_group"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<span class="avatar avatar--group '),e.push(this.cssClass),e.push('">\n  '),e.push(this.Icon("team")),e.push("\n</span>\n")}).call(this)}.call(
t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/avatar_system"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<span class="avatar '),e.push(this.cssClass),e.push('" style="background: white">\n  '),e.push(this.Icon("logo")),e.push("\n</span>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/avatar_unique"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<span class="avatar '),e.push(this.cssClass),e.push(' avatar--unique" style="background-position: -'),e.push(this.x),e.push("px -"),e.push(this.y),e.push('px;"'),e.push(this.placement),e.push(this.data),e.push(">\n  "),this.vip&&e.push(this.Icon("crown")),e.push("\n  "),e.push(n(this.initials)),e.push("\n</span>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/calendar/holiday_selector"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(t in i.push('<table class="settings-list">\n  <thead>\n    <tr>\n      <th>'),i.push(this.T("Active")),i.push("\n      <th>"),i.push(this.T("Date")),i.push('\n      <th style="width: 300px">'),i.push(this.T("Description")),i.push("\n      <th>"),i.push(this.T("Action")),i.push("\n  </thead>\n  <tbody>\n    "),n=this.days)e=n[t],i.push("\n    <tr "),e.active||i.push('class="is-inactive"'),i.push(' data-date="'),i.push(s(t)),i.push('">\n      <td class="u-positionOrigin">\n        <label class="checkbox-replacement checkbox-replacement--fullscreen">\n          <input type="checkbox" '),e.active&&i.push("checked"),i.push(' class="js-active js-boolean" name="public_holidays::'),i.push(s(t)),i.push('::active" value="true">\n          '),i.push(this.Icon("checkbox","icon-unchecked")),i.push("\n          "),i.push(this.Icon("checkbox-checked","icon-checked")),i.push("\n        </label>\n      <td>"),i.push(s(t)),i.push('\n      <td class="settings-list-control-cell"><input class="form-control form-control--small js-summary '),e.active||i.push("is-disabled"),i.push('" type="text" name="public_holidays::'),i.push(s(t)),i.push('::summary" value="'),i.push(s(e.summary)),i.push('" required/>\n      <td class="settings-list-row-control">\n        '),e.feed||(i.push('\n          <div class="btn btn--text js-remove">\n            '),i.push(this.Icon("trash")),i.push(" "),i.push(this.T("Remove")),i.push("\n          </div>\n        ")),i.push("\n    ");i.push('\n\n    <tr class="settings-list-controlRow">\n      <td>\n      <td class="settings-list-control-cell js-datePicker">\n        <!-- not supported right now by ff\n        <input class="form-control form-control--small" type="date" placeholder="'),i.push(this.T("Date")),i.push('"/>\n        -->\n      <td class="settings-list-control-cell">\n        <input class="form-control form-control--small js-summary" type="text" placeholder="'),i.push(this.T("Description")),i.push('"/>\n      <td class="settings-list-row-control">\n        <div class="btn btn--text btn--create js-add">\n          '),i.push(this.Icon("plus-small")),i.push(" "),i.push(this.T("Add")),i.push("\n        </div>\n  </tbody>\n</table>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/calendar/holiday_selector_placeholder"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<tr class="" data-date="'),e.push(n(this.placeholderDate)),e.push('">\n  <td>\n    <label class="checkbox-replacement">\n      <input type="checkbox" checked class="js-active js-boolean" name="'),e.push(n(this.nameActive)),e.push('" value="true">\n      '),e.push(this.Icon("checkbox","icon-unchecked")),e.push("\n      "),e.push(this.Icon("checkbox-checked","icon-checked")),e.push("\n    </label>\n  <td>"),e.push(this.Tdate(this.placeholderDate)),e.push('\n  <td class="settings-list-control-cell"><input class="form-control form-control--small js-summary" type="text" name="'),e.push(n(this.nameSummary)),e.push('" value="'),e.push(n(this.placeholderSummary)),e.push('" required/>\n  <td class="settings-list-row-control">\n    <div class="btn btn--text js-remove">\n      '),e.push(this.Icon("trash")),e.push(" "),e.push(this.T("Remove")),e.push("\n    </div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/calendar/index"]=function(t){t||(t={});var I=[],E=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T,A,S,C,x,j,P;for(I.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),I.push(this.T("Calendar")),I.push(" <small>"),I.push(this.T("Management")),I.push('</small></h1>\n  </div>\n\n  <div class="page-header-meta">\n    '),this.showDescription&&(I.push('\n      <a class="btn js-description">'),I.push(this.T("Description")),I.push("</a>\n    ")),I.push('\n    <a class="btn btn--success js-new">'),I.push(this.T("New Calendar")),I.push('</a>\n  </div>\n</div>\n<div class="page-content">\n  '),_.isEmpty(this.calendars)&&(I.push('\n  <div class="page-description">\n    '),I.push(this.description),I.push("\n  </div>\n  ")),I.push("\n\n  "),i=0,a=(w=this.calendars).length;i<a;i++){if(t=w[i],I.push('\n  <div class="action" data-id="'),I.push(t.id),I.push('">\n    <div class="action-flow action-flow--row">\n      <div class="action-row">\n        <div class="action-flow action-flow--noWrap">\n          <h2>'),_.isEmpty(t.ical_url)||(I.push('<span title="'),I.push(this.Ti("Last sync at")),I.push(": "),I.push(this.Ttimestamp(t.last_sync)),t.last_log&&(I.push(": "),I.push(E(t.last_log))),I.push('">\n            '),t.last_log?(I.push("\n              "),I.push(this.Icon("status","error inline"))):(I.push("\n              "),I.push(this.Icon("status","ok inline"))),I.push("\n            "),I.push("</span>")),I.push(" "),I.push(E(t.name)),I.push("</h2>\n          "),t["default"]&&(I.push('\n            <div class="action-label">'),I.push(this.T("Default")),I.push("</div>\n          ")),I.push("\n        </div>\n      </div>\n      "),t.last_log&&(I.push('<div class="action-row"><div class="alert alert--danger">'),I.push(E(t.last_log)),I.push("</div></div>")),I.push('\n      <div class="action-row">\n        <div class="label">'),I.push(this.T("Time zone")),I.push("</div> "),I.push(E(t.timezone)),I.push('\n      </div>\n      <div class="action-block action-block--flex">\n        <div class="label">'),I.push(this.T("Business Hours")),I.push('</div>\n        <table class="table table-fluid">\n          <tr>\n            <td>'),I.push(this.T("Monday")),I.push("</td><td>"),!t.business_hours.mon.active||_.isEmpty(t.business_hours.mon.timeframes))I.push("-");else for(s=0,l=(k=t.business_hours.mon.timeframes).length;s<l;s++)e=k[s],I.push(E(e[0])),I.push("-"),I.push(E(e[1])),I.push(" </td><td>");if(I.push("</td>\n          </tr>\n          <tr>\n            <td>"),I.push(this.T("Tuesday")),I.push("</td><td>"),!t.business_hours.tue.active||_.isEmpty(t.business_hours.tue.timeframes))I.push("-");else for(r=0,c=(T=t.business_hours.tue.timeframes).length;r<c;r++)e=T[r],I.push(E(e[0])),I.push("-"),I.push(E(e[1])),I.push(" </td><td>");if(I.push("</td>\n          </tr>\n          <tr>\n            <td>"),I.push(this.T("Wednesday")),I.push("</td><td>"),!t.business_hours.wed.active||_.isEmpty(t.business_hours.wed.timeframes))I.push("-");else for(o=0,p=(A=t.business_hours.wed.timeframes).length;o<p;o++)e=A[o],I.push(E(e[0])),I.push("-"),I.push(E(e[1])),I.push(" </td><td>");if(I.push("</td>\n          </tr>\n          <tr>\n            <td>"),I.push(this.T("Thursday")),I.push("</td><td>"),!t.business_hours.thu.active||_.isEmpty(t.business_hours.thu.timeframes))I.push("-");else for(m=0,u=(S=t.business_hours.thu.timeframes).length;m<u;m++)e=S[m],I.push(E(e[0])),I.push("-"),I.push(E(e[1])),I.push(" </td><td>");if(I.push("</td>\n          </tr>\n          <tr>\n            <td>"),I.push(this.T("Friday")),I.push("</td><td>"),!t.business_hours.fri.active||_.isEmpty(t.business_hours.fri.timeframes))I.push("-");else for(v=0,h=(C=t.business_hours.fri.timeframes).length;v<h;v++)e=C[v],I.push(E(e[0])),I.push("-"),I.push(E(e[1])),I.push(" </td><td>");if(I.push("</td>\n          </tr>\n          <tr>\n            <td>"),I.push(this.T("Saturday")),I.push("</td><td>"),!t.business_hours.sat.active||_.isEmpty(t.business_hours.sat.timeframes))I.push("-");else for(y=0,d=(x=t.business_hours.sat.timeframes).length;y<d;y++)e=x[y],I.push(E(e[0])),I.push("-"),I.push(E(e[1])),I.push(" </td><td>");if(I.push("</td>\n          </tr>\n          <tr>\n            <td>"),I.push(this.T("Sunday")),I.push("</td><td>"),!t.business_hours.sun.active||_.isEmpty(t.business_hours.sun.timeframes))I.push("-");else for(b=0,f=(j=t.business_hours.sun.timeframes).length;b<f;b++)e=j[b],I.push(E(e[0])),I.push("-"),I.push(E(e[1])),I.push(" </td><td>");for(n in I.push('</td>\n          </tr>\n        </table>\n      </div>\n      <div class="action-block action-block--flex">\n        <div class="label">'),I.push(this.T("Holidays")),I.push('</div>\n        <table class="table">\n          '),_.isEmpty(t.public_holidays_preview)&&I.push("-"),I.push("\n          "),P=t.public_holidays_preview)g=P[n],I.push("\n            <tr "),g.active||I.push('class="is-inactive"'),I.push('>\n              <td style="width: 96px">'),I.push(this.Tdate(n)),I.push("\n              <td>"),I.push(E(g.summary)),I.push("\n          ");I.push('\n        </table>\n      </div>\n    </div>\n    <div class="action-controls">\n      '),t["default"]?(I.push('\n        <div class="btn btn--danger btn--secondary is-disabled">'),I.push(this.T("Delete"))):(I.push('\n        <div class="btn btn--danger btn--secondary js-delete">'),I.push(this.T("Delete")),I.push('</div>\n        <div class="btn btn--secondary js-default">'),I.push(this.T("Set as Default"))),I.push("</div>\n      "),I.push('\n      <div class="btn js-edit">'),I.push(this.T("Edit")),I.push("</div>\n    </div>\n  </div>\n  ")}I.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,I.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/channel/_header"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n    '),this.params.hasSwitch&&e.push('\n      <div class="zammad-switch zammad-switch--small js-channelActive">\n         <input name="sms_channel_active" type="checkbox" id="sms_channel_active">\n         <label for="sms_channel_active"></label>\n      </div>\n    '),e.push("\n    <h1>"),e.push(this.T(this.params.header)),e.push(" <small></small></h1>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/channel/chat"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="page-header">\n  <div class="page-header-title">\n    <div class="zammad-switch zammad-switch--small js-chatSetting">\n       <input name="chat" type="checkbox" id="setting-chat" '),this.chatSetting&&s.push("checked"),s.push('>\n       <label for="setting-chat"></label>\n    </div>\n    <h1>'),s.push(this.T("Chat")),s.push('</h1>\n  </div>\n</div>\n<div class="page-content">\n  <p>'),s.push(this.T("You can create chat widgets for your web pages to allow visitors to chat with you.")),s.push('</p>\n\n  <h2>Chat-Bot</h2>\n  <p>Activate Chat-Bot for automatic chat handling</p>\n  <div class="zammad-switch zammad-switch--small js-chatBotSetting">\n     <input name="chatbot_status" type="checkbox" id="setting-chatbot" '),this.chatBotSetting&&s.push("checked"),s.push('>\n     <label for="setting-chatbot"></label>\n  </div>\n\n  <h2>'),s.push(this.T("Topics")),s.push("</h2>\n  <p>"),s.push(this.T("You can create multiple chat topics.")),s.push('</p>\n  <div class="js-topics"></div>\n\n  <h2>'),s.push(this.T("Designer")),s.push('</h2>\n\n  <div class="form-group">\n    <label class="formGroup-label">'),s.push(this.T("Preview Width")),s.push('</label>\n    <div class="control">\n      <div class="select-tabs js-selectBrowserWidth">\n        <div class="tab" data-value="375">iPhone 6</div>\n        <div class="tab" data-value="fit">1:1</div>\n        <div class="tab is-selected" data-value="1280">MacBook</div>\n      </div>\n    </div>\n  </div>\n\n  <label for="preview-iframe" class="formGroup-label">'),s.push(this.T("Preview")),s.push('</label>\n  <div class="browser chat-demo js-browser">\n    <form class="browser-head js-demo-head" novalidate>\n      <div class="browser-input">\n        <input type="url" class="js-testurl-input" id="preview-iframe" value="'),s.push(r(this.previewUrl)),s.push('" placeholder="www.zammad.org">\n        <div class="loading icon small muted"></div>\n      </div>\n      <input type="submit" class="btn" value="'),s.push(this.Ti("Load")),s.push('">\n    </form>\n    <div class="browser-body js-browserBody">\n      <div class="browser-website js-website">\n        <img class="js-screenshot">\n      </div>\n      <style>@import "/assets/chat/chat.css";</style>\n      <div class="chat-demo-animationHolder">\n        <div class="js-chat zammad-chat zammad-chat-is-open zammad-chat-is-loaded zammad-chat-is-shown is-open">\n          <div class="zammad-chat-header js-toggle-chat js-backgroundColor js-chatHeader">\n            <div class="zammad-chat-header-controls">\n              <span class="zammad-chat-agent-status" data-status="online">'),s.push(this.T("Online")),s.push('</span>\n              <span class="zammad-chat-header-icon">\n                <svg class="zammad-chat-header-icon-open" viewBox="0 0 13 7"><path d="M10.807 7l1.4-1.428-5-4.9L6.5-.02l-.7.7-4.9 4.9 1.414 1.413L6.5 2.886 10.807 7z" fill-rule="evenodd"></path></svg>\n                <svg class="zammad-chat-header-icon-close" viewBox="0 0 13 13"><path d="m2.241.12l-2.121 2.121 4.243 4.243-4.243 4.243 2.121 2.121 4.243-4.243 4.243 4.243 2.121-2.121-4.243-4.243 4.243-4.243-2.121-2.121-4.243 4.243-4.243-4.243" fill-rule="evenodd"></path></svg>\n              </span>\n            </div>\n            <div class="zammad-chat-agent">\n              <img class="zammad-chat-agent-avatar" src="/assets/images/chat-demo-avatar.png">\n              <span class="zammad-chat-agent-sentence">\n                <span class="zammad-chat-agent-name">'),s.push(this.T("John Smith")),s.push('</span>\n              </span>\n            </div>\n            <div class="zammad-chat-welcome zammad-chat-is-hidden">\n              <svg class="zammad-chat-icon" viewBox="0 0 24 24"><path d="M2 5C2 4 3 3 4 3h16c1 0 2 1 2 2v10C22 16 21 17 20 17H4C3 17 2 16 2 15V5zM12 17l6 4v-4h-6z" fill-rule="evenodd"></path></svg>\n              <span class="zammad-chat-welcome-text js-chat-welcome"><strong>Chat</strong> with us!</span>\n            </div>\n          </div>\n          <div class="zammad-chat-body">\n            <div class="zammad-chat-timestamp"><strong>'),s.push(this.T("today")),s.push('</strong> 14:45</div>\n            <div class="zammad-chat-message zammad-chat-message--customer">\n              <span class="zammad-chat-message-body js-backgroundColor">'),s.push(this.T("Hello! I need help with your product.")),s.push('</span>\n            </div>\n            <div class="zammad-chat-message zammad-chat-message--agent">\n              <span class="zammad-chat-message-body">'),s.push(this.T("Hi! Which one of our products?")),s.push('</span>\n            </div>\n          </div>\n          <form class="zammad-chat-controls">\n            <textarea class="zammad-chat-input" rows="1" placeholder="Ihre Nachricht..."></textarea>\n            <button type="submit" class="zammad-chat-button zammad-chat-send js-backgroundColor">'),s.push(this.T("Send")),s.push('</button>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <form class="js-params">\n    <fieldset>\n      <div class="input form-group formGroup--halfSize">\n        <div class="formGroup-label">\n          <label for="form-chat-title">'),s.push(this.T("Chat Title")),s.push('</label>\n        </div>\n        <div class="controls">\n          <input class="js-chatTitle" type="text" id="form-chat-title" name="title" placeholder="&lt;strong&gt;Chat&lt;/strong&gt; with us!">\n        </div>\n        <span class="help-block">'),s.push(this.T("Shown when the chat is closed.")),s.push('</span>\n      </div>\n      <div class="input form-group formGroup--halfSize">\n        <div class="formGroup-label">\n          <label for="form-chat-background">'),s.push(this.T("Background color")),s.push('</label>\n          <div class="align-right horizontal js-palette"></div>\n        </div>\n        <div class="controls controls--button">\n          <input class="js-color" type="text" id="form-chat-background" name="background">\n          <div class="controls-button js-eyedropper">\n            <div class="controls-button-inner u-clickable">\n              '),s.push(this.Icon("eyedropper")),s.push('\n            </div>\n          </div>\n        </div>\n        <span class="help-block">'),s.push(this.T("Can be in any CSS color format.")),s.push('</span>\n      </div>\n      <div class="input form-group formGroup--halfSize">\n        <div class="formGroup-label">\n          <label for="form-chat-fontsize">'),s.push(this.T("Font size")),s.push('</label>\n        </div>\n        <div class="controls">\n          <input type="text" id="form-chat-fontsize" name="fontSize" value="12px">\n        </div>\n        <span class="help-block">'),s.push(this.T("The default font size is 12px.")),s.push('</span>\n      </div>\n      <div class="switch form-group formGroup--halfSize">\n        <div class="formGroup-label">\n            <label for="form-chat-flat">'),s.push(this.T("Flat Design")),s.push('</label>\n          </div>\n        <div class="controls">\n          <div class="zammad-switch">\n             <input name="flat" type="checkbox" id="form-chat-flat">\n             <label for="form-chat-flat"></label>\n          </div>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n\n  <hr>\n\n  <h2>'),s.push(this.T("Usage")),s.push("</h2>\n\n  <p>"),s.push(marked(this.T("Insert the widget code into the source code of every page the chat shall be visible on. It should be placed at the end of the page's source code before the \xa7</body>\xa7 closing tag."))),s.push("</p>\n\n  <h3>"),s.push(this.T("Requirements")),s.push("</h3>\n  <p>"),s.push(this.T("Zammad Chat requires jQuery. If you don't already use it on your website include it like this:")),s.push('</p>\n  <pre><code class="language-html js-code">&lt;script src="https://code.jquery.com/jquery-2.1.4.min.js"&gt;&lt;/script&gt;</code></pre>\n\n  <h3>'),s.push(this.T("Automatically show chat")),s.push(" ("),s.push(this.T("default")),s.push(")</h3>\n  <p>"),s.push(this.T("The chat will show up once the connection to the server got established and if there is someone online to chat with.")),s.push('</p>\n\n  <pre><code class="language-html js-code">&lt;script src="'),s.push(r(this.baseurl)),s.push('/assets/chat/chat.min.js"&gt;&lt;/script&gt;\n&lt;script&gt;\n$(function() {\n  new ZammadChat({\n<span class="js-modal-params"></span>\n  });\n});\n&lt;/script&gt;</code></pre>\n\n  <h3>'),s.push(this.T("Manually open chat")),s.push("</h3>\n  <p>"),s.push(this.T("If you want to open the chat by the press of a button set the option \xa7show\xa7 to \xa7false\xa7 and add the class \xa7open-zammad-chat\xa7 to the button.")),s.push('</p>\n  <pre><code class="language-html js-code">&lt;button class="open-zammad-chat"&gt;Chat with us&lt;/button&gt;\n\n&lt;script src="'),s.push(r(this.baseurl)),s.push('/assets/chat/chat.min.js"&gt;&lt;/script&gt;\n&lt;script&gt;\n$(function() {\n  new ZammadChat({\n<span class="js-modal-params"></span>,\n    show: false\n  });\n});\n&lt;/script&gt;</code></pre>\n\n  <h3>'),s.push(this.T("Why doesn't the chat show up?")),s.push("</h3>\n  <p>\n    "),s.push(this.T("There can be several reasons for the chat to not show up:")),s.push("\n    <ol>\n      <li>"),s.push(this.T("The browser is outdated. It does not support WebSocket - the technology we use for the chat.")),s.push("\n      <li>"),s.push(this.T("There is no agent online.")),s.push("\n      <li>"),s.push(this.T("The chat is turned off.")),s.push("\n      <li>"),s.push(this.T("There are too many people in queue for the chat.")),s.push("\n    </ol>\n    "),s.push(this.T("When you turn on debugging by setting the option \xa7debug\xa7 to \xa7true\xa7 the reason gets printed to the javascript console.")),s.push("\n  </p>\n\n  <hr>\n\n  <h3>"),s.push(this.T("Options")),s.push('</h3>\n\n  <table class="settings-list">\n    <thead>\n      <tr>\n        <th>'),s.push(this.T("Options")),s.push("\n        <th>"),s.push(this.T("Default")),s.push("\n        <th>"),s.push(this.T("Type")),s.push("\n        <th>"),s.push(this.T("Description")),s.push("\n    </thead>\n    <tbody>\n    "),t=0,e=(i=this.apiOptions).length;t<e;t++)n=i[t],s.push("\n      <tr>\n        <td>"),s.push(r(n.name)),s.push('\n        <td style="white-space: nowrap;"><code class="language-javascript js-code">'),s.push(r(n["default"])),s.push('</code>\n        <td style="white-space: nowrap;"><code class="language-javascript js-code">'),s.push(r(n.type)),s.push("</code>\n        <td>"),s.push(this.T(n.description,n.descriptionSubstitute)),s.push("\n    ");s.push("\n    </tbody>\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/channel/color_swatch"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="color-swatch js-swatch" style="color: '),e.push(n(this.color)),e.push('" data-color="'),e.push(n(this.color)),e.push('"></div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/channel/email_account_overview"]=function(t){t||(t={});var T=[],A=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k;if(T.push("\n"),!_.isEmpty(this.accounts_fixed)){for(T.push("\n<h2>"),T.push(this.T("Fixed Email Accounts")),T.push('</h2>\n<div class="action">\n  <div class="action-flow">\n    <div class="action-block">\n      <ul>\n        '),a=0,u=(v=this.accounts_fixed).length;a<u;a++)r=v[a],T.push("\n          <li>"),T.push(A(r.realname)),T.push(" &lt;"),T.push(A(r.email)),T.push("&gt;\n        ");T.push("\n      </ul>\n    </div>\n  </div>\n</div>\n")}if(T.push("\n\n<h2>"),T.push(this.T("Email Accounts")),T.push("</h2>\n\n"),!_.isEmpty(this.not_used_email_addresses)){for(T.push('\n<div class="action">\n  <div class="action-flow">\n    <div class="action-block">\n      '),T.push(this.T("Notice")),T.push(": "),T.push(this.T("Unassigned email addresses, assign them to a channel or delete them.")),T.push('</h3>\n      <ul class="list">\n      '),l=0,h=(y=this.not_used_email_addresses).length;l<h;l++)r=y[l],T.push('\n        <li class="list-item" data-id="'),T.push(A(r.id)),T.push('">\n          <div class="list-item-name">\n            <a href="#" class="js-emailAddressEdit">'),T.push(A(r.realname)),T.push(" &lt;"),T.push(A(r.email)),T.push('&gt;</a>\n          </div>\n          <div class="list-item-delete js-emailAddressDelete">\n            '),T.push(this.Icon("diagonal-cross")),T.push("\n          </div>\n      ");T.push("\n      </ul>\n    </div>\n  </div>\n</div>\n")}if(T.push("\n\n"),_.isEmpty(this.account_channels))T.push("\n  <p>"),T.push(this.T("You have no configured account right now.")),T.push("</p>\n");else{for(T.push("\n  "),c=0,d=(b=this.account_channels).length;c<d;c++){if(t=b[c],T.push('\n  <div class="action '),!0!==t.active&&T.push("is-inactive"),T.push('" data-id="'),T.push(t.id),T.push('">\n    <!-- Google has postponed the authentication removal. No need to show the warning for now.\n     '),!0===t.active&&t.options.inbound&&t.options.inbound.options&&"imap.gmail.com"===t.options.inbound.options.host&&t.options.outbound&&t.options.outbound.options&&"smtp.gmail.com"===t.options.outbound.options.host&&(T.push('\n    <div class="action-alert alert alert--danger alert--square horizontal centered" role="alert">\n      '),n="2020-06-15",T.push("\n      "),i=App.i18n.translateDate(n,0),T.push("\n      "),e=new Date(n+"T00:00:00"),T.push("\n      "),s=new Date,T.push("\n      "),e<s?(T.push("\n        "),T.push(this.T("%s will only allow access via OAuth. Password-based access is no longer supported since %s.","G Suite",i))):(T.push("\n        "),T.push(this.T("%s will only allow access via OAuth. Password-based access will no longer be supported on %s.","G Suite",i))),T.push(' <div class="flex-spacer"></div><div class="double-spacer"></div><button class="btn js-migrateGoogleMail" type="button">'),T.push(this.T("Migrate now!")),T.push("</button>\n      "),T.push("\n    </div>\n    ")),T.push('\n    -->\n    <div class="action-flow" style="width: 100%;">\n      <div class="action-block action-block--flex">\n        <div class="horizontal">\n          <h3>'),T.push(this.Icon("status",t.status_in+" inline")),T.push(" "),T.push(this.T("Inbound")),T.push("</h3>\n          "),!1!==t.preferences.editable&&(T.push('\n            <div class="js-editInbound btn btn--text space-left">'),T.push(this.T("Edit")),T.push("</div>\n          ")),T.push('\n        </div>\n        <table class="key-value">\n          <tr>\n            <td>'),T.push(this.T("User")),T.push("\n            <td>"),T.push(A(t.options.inbound.options.user)),T.push("\n            "),t.options.inbound.options.folder&&(T.push("\n              ("),T.push(this.T("Folder")),T.push(": "),T.push(A(t.options.inbound.options.folder)),T.push(")\n            ")),T.push("\n          <tr>\n            <td>"),T.push(this.T("Host")),T.push("\n            <td>"),T.push(A(t.options.inbound.options.host)),T.push("\n          <tr>\n            <td>"),T.push(this.T("Protocol")),T.push("\n            <td>"),T.push(A(t.options.inbound.adapter)),T.push("\n        </table>\n\n        "),_.isEmpty(t.last_log_in)||(T.push('\n        <div class="alert alert--danger">\n          '),T.push(A(t.last_log_in)),T.push("\n        </div>\n        ")),T.push("\n\n        <hr>\n\n        <h3>"),T.push(this.T("Destination Group")),T.push('</h3>\n        <a href="#" class="js-channelGroupChange '),!1===t.group.active&&T.push("alert alert--danger"),T.push('">\n          '),o="",T.push("\n          "),t.group.displayName?(T.push("\n            "),o=t.group.displayName()):(T.push("\n            "),o=t.group),T.push("\n          "),T.push("\n          "),!1===t.group.active?(T.push("\n            "),T.push(this.T("%s is inactive, please select a active one.",o))):(T.push("\n            "),T.push(A(o))),T.push("\n          "),T.push('\n        </a>\n      </div>\n      <div class="action-block action-block--flex">\n        <div class="horizontal">\n          <h3>'),T.push(this.Icon("status",t.status_out+" inline")),T.push(" "),T.push(this.T("Outbound")),T.push("</h3>\n          "),!1!==t.preferences.editable&&(T.push('\n            <div class="js-editOutbound btn btn--text space-left">'),T.push(this.T("Edit")),T.push("</div>\n          ")),T.push('\n        </div>\n        <table class="key-value">\n        '),t.options.outbound&&t.options.outbound.options&&(T.push("\n          <tr>\n            <td>"),T.push(this.T("User")),T.push("\n            <td>"),T.push(A(t.options.outbound.options.user)),T.push("\n          <tr>\n            <td>"),T.push(this.T("Host")),T.push("\n            <td>"),T.push(A(t.options.outbound.options.host)),T.push("\n        ")),T.push("\n          <tr>\n            <td>"),T.push(this.T("Protocol")),T.push("\n            <td>"),T.push(A(t.options.outbound.adapter)),T.push("\n        </table>\n\n        "),_.isEmpty(t.last_log_out)||(T.push('\n        <div class="alert alert--danger">\n          '),T.push(A(t.last_log_out)),T.push("\n        </div>\n        ")),T.push("\n\n        <hr>\n\n        <h3>"),T.push(this.T("Email Address")),T.push('</h3>\n        <ul class="list">\n        '),_.isEmpty(t.email_addresses))T.push('\n          <li class="list-item">'),T.push(this.T("none")),T.push("\n        ");else{for(T.push("\n          "),p=0,f=(w=t.email_addresses).length;p<f;p++)r=w[p],T.push('\n            <li class="list-item" data-id="'),T.push(A(r.id)),T.push('">\n              <div class="list-item-name">'),T.push(A(r.email)),T.push('</div>\n              <div class="btn btn--text js-emailAddressEdit space-left space-right">'),T.push(this.T("Edit")),T.push("</div>\n              "),1<t.email_addresses.length&&(T.push('\n              <div class="list-item-delete js-emailAddressDelete">\n                '),T.push(this.Icon("diagonal-cross")),T.push("\n              </div>\n              ")),T.push("\n          ");T.push("\n        ")}T.push('\n        </ul>\n        <a class="text-muted js-emailAddressNew" href="#">+ '),T.push(this.T("Add")),T.push('</a>\n\n      </div>\n    </div>\n    <div class="action-controls">\n      '),!0===t.active?(T.push('\n        <div class="btn js-channelDisable">'),T.push(this.T("Disable"))):(T.push('\n        <div class="btn btn--secondary js-channelEnable">'),T.push(this.T("Enable"))),T.push("</div>\n      "),T.push('\n      <div class="btn btn--danger btn--secondary js-channelDelete">'),T.push(this.T("Delete")),T.push("</div>\n    </div>\n  </div>\n  ")}T.push("\n")}if(T.push('\n\n<a class="btn btn--success js-channelNew">'),T.push(this.T("New")),T.push("</a>\n\n"),!_.isEmpty(this.notification_channels)&&!App.Config.get("system_online_service")){for(T.push("\n  <h2>"),T.push(this.T("Email Notification")),T.push("</h2>\n  "),g=0,m=(k=this.notification_channels).length;g<m;g++)t=k[g],T.push(
'\n    <div class="action" data-id="'),T.push(t.id),T.push('">\n      <div class="action-flow action-flow--row">\n        <div class="action-block action-block--flex">\n          <div class="horizontal">\n            <h3>'),T.push(this.Icon("status",t.status_out+" inline")),T.push(" "),T.push(this.T("Outbound")),T.push('</h3>\n            <div class="btn btn--text js-editNotificationOutbound space-left">'),T.push(this.T("Edit")),T.push('</div>\n          </div>\n\n          <table class="key-value">\n          '),t.options.outbound&&t.options.outbound.options&&(T.push("\n            <tr>\n              <td>"),T.push(this.T("User")),T.push("\n              <td>"),T.push(A(t.options.outbound.options.user)),T.push("\n            <tr>\n              <td>"),T.push(this.T("Host")),T.push("\n              <td>"),T.push(A(t.options.outbound.options.host)),T.push("\n          ")),T.push("\n            <tr>\n              <td>"),T.push(this.T("Protocol")),T.push("\n              <td>"),T.push(A(t.options.outbound.adapter)),T.push("\n          </table>\n\n          "),"error"===t.status_in&&(T.push('\n            <div class="alert alert--danger">'),T.push(A(t.last_log_in)),T.push("</div>\n          ")),T.push("\n          "),"error"===t.status_out&&(T.push('\n            <div class="alert alert--danger">'),T.push(A(t.last_log_out)),T.push("</div>\n          ")),T.push('\n        </div>\n        <div class="action-block action-block--flex">\n          <h3>'),T.push(this.T("Email Address")),T.push('</h3>\n          <ul class="list">\n            <li class="list-item">'),T.push(A(this.config.notification_sender)),T.push("\n          </ul>\n        </div>\n      </div>\n    </div>\n  ");T.push("\n")}T.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,T.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/channel/email_account_wizard"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="modal-dialog wizard">\n\n  <form class="modal-content setup wizard js-intro">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Email Account")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <div class="base-settings"></div>\n      </div>\n    </div>\n    <div class="modal-footer">\n        <div class="modal-leftFooter">\n          <button class="btn btn--text btn--secondary align-left js-expert">'),e.push(this.T("Experts")),e.push('</button>\n        </div>\n        <div class="modal-rightFooter">\n          <button class="btn btn--primary align-right js-submit">'),e.push(this.T("Connect")),e.push('</button>\n        </div>\n    </div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-probe">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Email Account")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Testing")),e.push(' <span class="js-email"></span>\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-test">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Email Account")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Verifying...")),e.push('\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-verify">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Email Account")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Verify sending and receiving")),e.push('\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-inbound">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Email Inbound")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <div class="base-inbound-settings"></div>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n      <a class="btn btn--text btn--secondary js-goToSlide align-left" data-slide="js-intro">'),e.push(this.T("Go Back")),e.push('</a>\n      </div>\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submit">'),e.push(this.T("Continue")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-inbound-acknowledge">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Email Inbound")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <p class="js-message">'),e.push(this.T("We have already found %s email(s) in your mailbox. Zammad will move it all from your mailbox into Zammad.","x")),e.push('</p>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n      <a class="btn btn--text btn--secondary js-goToSlide js-back align-left" data-slide="js-inbound">'),e.push(this.T("Go Back")),e.push('</a>\n      </div>\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary js-goToSlide js-next align-right js-submit" data-slide="js-outbound">'),e.push(this.T("Continue")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-outbound">\n    <div class="modal-header">\n        <div class="modal-close js-close">\n          '),e.push(this.Icon("diagonal-cross")),e.push('\n        </div>\n        <h1 class="modal-title">'),e.push(this.T("Email Outbound")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <div class="base-outbound-type"></div>\n        <div class="base-outbound-settings"></div>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n      <a class="btn btn--text btn--secondary js-goToSlide align-left" data-slide="js-inbound">'),e.push(this.T("Go Back")),e.push('</a>\n      </div>\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submit">'),e.push(this.T("Continue")),e.push("</button>\n      </div>\n    </div>\n  </form>\n\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/channel/email_notification_wizard"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="modal-dialog wizard">\n\n  <form class="modal-content setup wizard hide js-probe">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Email Notification")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Testing")),e.push(' <span class="js-email"></span>\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-test">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Email Notification")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Verifying...")),e.push('\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <form class="modal-content setup wizard js-outbound">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Email Notification")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <div class="base-outbound-type"></div>\n        <div class="base-outbound-settings"></div>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right">'),e.push(this.T("Continue")),e.push("</button>\n      </div>\n    </div>\n  </form>\n\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/channel/form"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n    <div class="zammad-switch zammad-switch--small js-formSetting">\n       <input name="form_ticket_create" type="checkbox" id="setting-form" '),this.formSetting&&e.push("checked"),e.push('>\n       <label for="setting-form"></label>\n    </div>\n    <h1>'),e.push(this.T("Form")),e.push(' <small></small></h1>\n  </div>\n</div>\n<div class="page-content">\n  <p>'),e.push(this.T("With form you can add a form to your web page which directly generates a ticket for you.")),e.push("</p>\n\n  <h2>"),e.push(this.T("Settings")),e.push('</h2>\n  <form class="js-paramsSetting">\n    <fieldset>\n      <div class="input form-group formGroup--halfSize">\n        <div class="formGroup-label">\n          <label for="form-group">'),e.push(this.T("Group selection for Ticket creation")),e.push('</label>\n        </div>\n        <div class="controls js-groupSelector" id="from-group"></div>\n      </div>\n    </fieldset>\n  </form>\n\n  <h2>'),e.push(this.T("Designer")),e.push('</h2>\n  <form class="js-paramsDesigner">\n\n    <fieldset>\n      <div class="input form-group formGroup--halfSize">\n        <div class="formGroup-label">\n          <label for="form-message-title">'),e.push(this.T("Title of the form")),e.push('</label>\n        </div>\n        <div class="controls">\n          <input type="text" id="form-message-title" name="messageTitle" value="'),e.push(this.Ti("Feedback Form")),e.push('">\n        </div>\n      </div>\n      <div class="input form-group formGroup--halfSize">\n        <div class="formGroup-label">\n          <label for="form-message-submit">'),e.push(this.T("Name of form submit button")),e.push('</label>\n        </div>\n        <div class="controls">\n          <input type="text" id="form-message-submit" name="messageSubmit" value="'),e.push(this.Ti("Submit")),e.push('">\n        </div>\n      </div>\n      <div class="input form-group">\n        <div class="formGroup-label">\n          <label for="form-message-thank-you">'),e.push(this.T("Message after sending form")),e.push('</label>\n        </div>\n        <div class="controls">\n          <textarea type="text" id="form-message-thank-you" name="messageThankYou" rows="3">'),e.push(this.Ti("Thank you for your inquiry (#%s)! We'll contact you as soon as possible.")),e.push('</textarea>\n        </div>\n      </div>\n    </fieldset>\n\n    <br>\n\n    <table class="settings-list">\n      <thead>\n        <tr>\n          <th style="white-space: nowrap;">'),e.push(this.T("Options")),e.push('</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td>\n            <label class="inline-label">\n              <span class="checkbox-replacement checkbox-replacement--inline">\n                <input type="checkbox" name="debug" value="true">\n                '),e.push(this.Icon("checkbox","icon-unchecked")),e.push("\n                "),e.push(this.Icon("checkbox-checked","icon-checked")),e.push("\n              </span>\n              "),e.push(this.T("Enable debugging for implementation.")),e.push('\n            </label>\n        <tr>\n          <td>\n            <label class="inline-label">\n              <span class="checkbox-replacement checkbox-replacement--inline">\n                <input type="checkbox" name="showTitle" value="true">\n                '),e.push(this.Icon("checkbox","icon-unchecked")),e.push("\n                "),e.push(this.Icon("checkbox-checked","icon-checked")),e.push("\n              </span>\n              "),e.push(this.T("Show title in form.")),e.push('\n            </label>\n        <tr>\n          <td>\n            <label class="inline-label">\n              <span class="checkbox-replacement checkbox-replacement--inline">\n                <input type="checkbox" name="modal" value="true" checked>\n                '),e.push(this.Icon("checkbox","icon-unchecked")),e.push("\n                "),e.push(this.Icon("checkbox-checked","icon-checked")),e.push("\n              </span>\n              "),e.push(this.T("Start modal dialog for form.")),e.push('\n            </label>\n        <tr>\n          <td>\n            <label class="inline-label">\n              <span class="checkbox-replacement checkbox-replacement--inline">\n                <input type="checkbox" name="noCSS" value="true">\n                '),e.push(this.Icon("checkbox","icon-unchecked")),e.push("\n                "),e.push(this.Icon("checkbox-checked","icon-checked")),e.push("\n              </span>\n              "),e.push(this.T("Don't load CSS for form. You need to generate your own CSS for the form.")),e.push('\n            </label>\n        <tr>\n          <td>\n            <label class="inline-label">\n              <span class="checkbox-replacement checkbox-replacement--inline">\n                <input type="checkbox" name="attachmentSupport" value="true">\n                '),e.push(this.Icon("checkbox","icon-unchecked")),e.push("\n                "),e.push(this.Icon("checkbox-checked","icon-checked")),e.push("\n              </span>\n              "),e.push(this.T("Add attachment option to upload.")),e.push('\n            </label>\n      </tbody>\n    </table>\n  </form>\n\n  <label class="formGroup-label">'),e.push(this.T("Preview")),e.push('</label>\n\n  <div class="browser form-demo js-browser">\n    <div class="browser-body js-browserBody">\n      <div class="browser-website centered vertical fit">\n        <div class="btn js-formBtn">'),e.push(this.T("Feedback")),e.push('</div>\n        <div class="js-formInline" style="width: 300px;"></div>\n        <script id="zammad_form_script" src="/assets/form/form.js"></script>\n      </div>\n    </div>\n  </div>\n  <h3>'),e.push(this.T("Requirements")),e.push("</h3>\n  <p>"),e.push(this.T("Zammad Forms requires jQuery. If you don't already use it on your website include it like this:")),e.push('</p>\n  <pre><code class="language-html js-code">&lt;script src="https://code.jquery.com/jquery-2.1.4.min.js"&gt;&lt;/script&gt;</code></pre>\n\n  <p>'),e.push(this.T("You need to add the following Javascript code snippet to your web page")),e.push(':</p>\n\n  <pre class="js-modal"><code class="language-html js-code js-paramsBlock">&lt;button id="feedback-form"&gt;Feedback&lt;/button&gt;\n\n&lt;script id="zammad_form_script" src="'),e.push(n(this.baseurl)),e.push('/assets/form/form.js"&gt;&lt;/script&gt;\n\n&lt;script&gt;\n$(function() {\n  $(\'#feedback-form\').ZammadForm({\n<span class="js-modal-params"></span>\n  });\n});\n&lt;/script&gt;</code></pre>\n</div>\n\n  <pre class="js-inlineForm"><code class="language-html js-code js-paramsBlock">&lt;div id="feedback-form"&gt;form will be placed in here&lt;/div&gt;\n\n&lt;script id="zammad_form_script" src="'),e.push(n(this.baseurl)),e.push('/assets/form/form.js"&gt;&lt;/script&gt;\n\n&lt;script&gt;\n$(function() {\n  $(\'#feedback-form\').ZammadForm({\n<span class="js-modal-params"></span>\n  });\n});\n&lt;/script&gt;</code></pre>\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/channel/sms_account_overview"]=function(t){t||(t={});var c=[],p=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l;if(c.push("<h2>"),c.push(this.T("SMS Accounts")),c.push("</h2>\n\n"),_.isEmpty(this.account_channels))c.push("\n  <p>"),c.push(this.T("You have no configured account right now.")),c.push("</p>\n");else{for(c.push("\n  "),n=0,s=(o=this.account_channels).length;n<s;n++)t=o[n],c.push('\n  <div class="action '),!0!==t.active&&c.push("is-inactive"),c.push('" data-id="'),c.push(t.id),c.push('">\n    <div class="action-flow" style="width: 100%;">\n      <div class="action-block action-block--flex">\n        <div class="horizontal">\n          <h3>'),c.push(this.Icon("status",t.status_in+" inline")),c.push(" "),c.push(this.T("Inbound")),c.push("</h3>\n        </div>\n        "),_.isEmpty(t.last_log_in)||(c.push('\n        <div class="alert alert--danger">\n          '),c.push(p(t.last_log_in)),c.push("\n        </div>\n        ")),c.push('\n      </div>\n\n      <div class="action-block action-block--flex">\n        <div class="horizontal">\n          <h3>'),c.push(this.Icon("status",t.status_out+" inline")),c.push(" "),c.push(this.T("Outbound")),c.push("</h3>\n        </div>\n        "),_.isEmpty(t.last_log_out)||(c.push('\n        <div class="alert alert--danger">\n          '),c.push(p(t.last_log_out)),c.push("\n        </div>\n        ")),c.push('\n\n      </div>\n    </div>\n\n    <div class="action-flow" style="width: 100%;">\n      <div class="action-block action-block--flex">\n        <table class="key-value">\n          <tr>\n            <td>'),c.push(this.T("Adapter")),c.push("\n            <td>"),c.push(p(t.options.adapter)),c.push("\n          <tr>\n            <td>"),c.push(this.T("Webhook")),c.push("\n            <td>"),c.push(p(this.C("http_type"))),c.push("://"),c.push(p(this.C("fqdn"))),c.push("/api/v1/sms_webhook/"),c.push(p((null!=(a=t.options)?a.webhook_token:void 0)||"?")),c.push("\n          <tr>\n            <td>"),c.push(this.T("Account")),c.push("\n            <td>"),c.push(p(t.options.account_id)),c.push("\n          <tr>\n            <td>"),c.push(this.T("Token")),c.push("\n            <td>"),c.push(p(this.M(t.options.token,1,2))),c.push("\n          <tr>\n            <td>"),c.push(this.T("Sender")),c.push("\n            <td>"),c.push(p(t.options.sender)),c.push("\n          <tr>\n            <td>"),c.push(this.T("Group")),c.push('\n            <td>\n              <div href="#" class="js-channelEdit '),!1===t.group.active&&c.push("alert alert--danger"),c.push('">\n                '),e="",c.push("\n                "),t.group.displayName?(c.push("\n                  "),e=t.group.displayName()):(c.push("\n                  "),e=t.group),c.push("\n                "),c.push("\n                "),!1===t.group.active?(c.push("\n                  "),c.push(this.T("%s is inactive, please select a active one.",e))):(c.push("\n                  "),c.push(p(e))),c.push("\n                "),c.push('\n              </div>\n        </table>\n      </div>\n    </div>\n\n    <div class="action-controls">\n      <div class="btn btn--secondary js-channelEdit">'),c.push(this.T("Edit")),c.push("</div>\n      "),!0===t.active?(c.push('\n        <div class="btn btn--secondary js-channelDisable">'),c.push(this.T("Disable"))):(c.push('\n        <div class="btn btn--secondary js-channelEnable">'),c.push(this.T("Enable"))),c.push("</div>\n      "),c.push('\n      <div class="btn btn--danger btn--secondary js-channelDelete">'),c.push(this.T("Delete")),c.push("</div>\n    </div>\n  </div>\n  ");c.push("\n")}if(c.push('\n\n<a class="btn btn--success js-channelEdit">'),c.push(this.T("New")),c.push("</a>\n\n<h2>"),c.push(this.T("SMS Notification")),c.push("</h2>\n"),_.isEmpty(this.notification_channels))c.push("\n  <p>"),c.push(this.T("You have no configured account right now.")),c.push('</p>\n  <a class="btn btn--success js-editNotification">'),c.push(this.T("New")),c.push("</a>\n");else{for(c.push("\n  "),i=0,r=(l=this.notification_channels).length;i<r;i++)t=l[i],c.push('\n    <div class="action '),!0!==t.active&&c.push("is-inactive"),c.push('" data-id="'),c.push(t.id),c.push('">\n      <div class="action-flow action-flow--row">\n        <div class="action-block action-block--flex">\n          <div class="horizontal">\n            <h3>'),c.push(this.Icon("status",t.status_out+" inline")),c.push(" "),c.push(this.T("Outbound")),c.push("</h3>\n          </div>\n          "),"error"===t.status_in&&(c.push('\n            <div class="alert alert--danger">'),c.push(p(t.last_log_in)),c.push("</div>\n          ")),c.push("\n          "),"error"===t.status_out&&(c.push('\n            <div class="alert alert--danger">'),c.push(p(t.last_log_out)),c.push("</div>\n          ")),c.push('\n          <table class="key-value">\n          '),t.options&&(c.push("\n            <tr>\n              <td>"),c.push(this.T("Adapter")),c.push("\n              <td>"),c.push(p(t.options.adapter)),c.push("\n            <tr>\n              <td>"),c.push(this.T("Token")),c.push("\n              <td>"),c.push(p(this.M(t.options.token,1,2))),c.push("\n          ")),c.push("\n            <tr>\n              <td>"),c.push(this.T("Sender")),c.push("\n              <td>"),c.push(p(t.options.sender)),c.push('\n          </table>\n        </div>\n      </div>\n      <div class="action-controls">\n        <div class="btn btn--secondary js-editNotification">'),c.push(this.T("Edit")),c.push("</div>\n        "),!0===t.active?(c.push('\n          <div class="btn btn--secondary js-channelDisable">'),c.push(this.T("Disable"))):(c.push('\n          <div class="btn btn--secondary js-channelEnable">'),c.push(this.T("Enable"))),c.push("</div>\n        "),c.push('\n        <div class="btn btn--danger btn--secondary js-channelDelete">'),c.push(this.T("Delete")),c.push("</div>\n      </div>\n    </div>\n  ");c.push("\n")}c.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,c.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/channel/topics"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<table class="settings-list">\n  <thead>\n    <tr>\n      <th style="white-space: nowrap;">'),s.push(this.T("chatId")),s.push('</th>\n      <th style="white-space: nowrap;">'),s.push(this.T("Name")),s.push('</th>\n      <th style="white-space: nowrap;">'),s.push(this.T("Note")),s.push('</th>\n      <th style="white-space: nowrap;">'),s.push(this.T("Max. clients in waitlist")),s.push('</th>\n      <th style="white-space: nowrap;">'),s.push(this.T("Delete")),s.push("</th>\n    </tr>\n  </thead>\n  <tbody>\n"),e=0,n=(i=this.chats).length;e<n;e++)t=i[e],s.push('\n    <tr data-id="'),s.push(r(t.id)),s.push('">\n      <td>\n        <label class="inline-label">\n          '),s.push(r(t.id)),s.push('\n        </label>\n      <td>\n        <label class="inline-label">\n          <a class="js-edit is-clickable">'),s.push(r(t.name)),s.push('</a>\n        </label>\n      <td>\n        <label class="inline-label">\n          '),s.push(r(t.note)),s.push('\n        </label>\n      <td>\n        <label class="inline-label">\n          '),s.push(r(t.max_queue)),s.push('\n        </label>\n      <td class="settings-list-row-control">\n        <div class="btn btn--text js-remove">\n          '),s.push(this.Icon("trash")),s.push(" "),s.push(this.T("Remove")),s.push("\n        </div>\n");s.push('\n    <tr>\n      <td colspan="5" class="settings-list-action-cell js-add">\n        '),s.push(this.Icon("plus-small")),s.push(" "),s.push(this.T("Add")),s.push("\n  </tbody>\n</table>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/chat_message"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="chat-message chat-message--'),e.push(n(this.sender)),this.isNew&&e.push(n(" chat-message--new")),this.whispered&&e.push(n(" chat-message--whispered")),this.sneakPeekMessage&&e.push(n(" chat-message--sneak-peek")),e.push('">'),e.push(this.message),e.push("</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/chat_window"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="chat-header js-chat-header">\n  <div class="chat-status js-status" data-status="online">\n    <div class="chat-status-holder">\n      '),s.push(this.Icon("status")),s.push("\n      "),s.push(this.Icon("status-modified-outer-circle")),s.push("\n      "),s.push(this.Icon("small-dot","icon-status-modified-inner-circle")),s.push('\n    </div>\n  </div>\n  <div class="chat-name">\n    <span class="js-name js-info u-clickable">'),s.push(r(this.name)),s.push("<span> #"),s.push(r(this.session.id)),s.push('\n  </div>\n  <div class="chat-disconnect js-disconnect">\n    <div class="btn btn--action btn--small">'),s.push(this.T("disconnect")),s.push('</div>\n  </div>\n  <div class="chat-close js-close is-hidden">\n    <div class="btn btn--action btn--small">'),s.push(this.T("close")),s.push('</div>\n  </div>\n</div>\n<div class="js-chat-agent-panel">\n  <svg class="icon icon-eye js-chat-btn peek-customer"><use xlink:href="assets/images/icons.svg#icon-eye"></use></svg>\n  <svg class="icon icon-eye js-chat-btn peek-agent hidden"><use xlink:href="assets/images/icons.svg#icon-eye"></use></svg>\n  <svg class="icon icon-eye js-chat-btn raise-flag"><use xlink:href="assets/images/icons.svg#icon-important"></use></svg>\n</div>\n<div class="chat-scroll-hint js-scrollHint is-hidden">\n  '),s.push(this.Icon("chat")),s.push("\n  "),s.push(this.T("Scroll down to see new messages")),s.push('\n</div>\n<div class="chat-body-holder js-scrollHolder">\n  <div class="chat-body js-body"></div>\n  <div class="chat-body js-meta hidden">\n    '),this.session){for(s.push("\n    "),s.push(this.T("Transfer conversation to another chat:")),s.push("\n    <ul>\n      "),e=0,n=(i=this.chats).length;e<n;e++)t=i[e],s.push("\n        "),this.session.chat_id!==t.id&&(s.push('\n          <li><a data-chat-id="'),s.push(r(t.id)),s.push('" class="js-transferChat" href="#">'),s.push(t.name),s.push("</a>\n        ")),s.push("\n      ");s.push("\n    </ul>\n    <hr>\n    <ul>\n      <li>"),s.push(this.T("Created at")),s.push(": "),s.push(this.Ttimestamp(this.session.created_at)),s.push("</li>\n      "),this.session&&this.session.preferences&&(s.push("\n        "),this.session.preferences.geo_ip&&(s.push("\n          <li>GeoIP: "),s.push(r(this.session.preferences.geo_ip.country_name)),s.push(" "),s.push(r(this.session.preferences.geo_ip.city_name)),s.push("</li>\n        ")),s.push("\n        "),this.session.preferences.remote_ip&&(s.push("\n          <li>IP: "),s.push(r(this.session.preferences.remote_ip)),s.push("</li>\n        ")),s.push("\n        "),this.session.preferences.dns_name&&(s.push("\n          <li>DNS: "),s.push(r(this.session.preferences.dns_name)),s.push("</li>\n        ")),s.push("\n      ")),s.push("\n    </ul>\n    ")}s.push('\n    <form class="js-metaForm" style="max-width: 200px; width: 100%;"></form>\n  </div>\n</div>\n<div class="chat-controls">\n  <svg class="icon icon-message js-chat-btn whisper"><use xlink:href="assets/images/icons.svg#icon-message"></use></svg>\n  <div class="chat-input">\n    <div class="form-control form-control--small form-control--multiline js-customerChatInput" contenteditable="true"></div>\n  </div>\n  <div class="btn btn--primary btn--slim btn--small js-send">'),s.push(this.T("Send")),s.push("</div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/cti/caller_log"]=function(t){t||(t={});var h=[],d=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u;for(h.push('<table class="table table-striped table-hover">\n  <thead>\n    <tr>\n      <th style="width: 40px;">\n        <label class="checkbox-replacement checkbox-replacement--fullscreen">\n          <input type="checkbox" class="js-checkAll">\n          '),h.push(this.Icon("checkbox","icon-unchecked")),h.push("\n          "),h.push(this.Icon("checkbox-checked","icon-checked")),h.push("\n        </label>\n      </th>\n      <th>"),h.push(this.T("From")),h.push("</th>\n      <th>"),h.push(this.T("To")),h.push('</th>\n      <!--<th style="width: 100px;">'),h.push(this.T("Queue")),h.push('</th>-->\n      <th style="width: 130px;">'),h.push(this.T("Status")),h.push('</th>\n      <th style="width: 80px;">'),h.push(this.T("Waiting")),h.push('</th>\n      <th style="width: 80px;">'),h.push(this.T("Duration")),h.push('</th>\n      <th style="width: 170px;">'),h.push(this.T("Time")),h.push("</th>\n    </tr>\n  </thead>\n  <tbody>\n    "),e=0,r=(l=this.list
).length;e<r;e++){if(n=l[e],h.push('\n    <tr class="u-center js-callerLog '),n.done&&h.push(" is-grayed-out"),h.push('" data-id="'),h.push(n.id),h.push('">\n      <td class="table-checkbox u-positionOrigin">\n        <label class="checkbox-replacement checkbox-replacement--fullscreen'),!0===n.disabled&&h.push(" is-disabled"),h.push('">\n          <input type="checkbox" class="js-check"'),n.done&&h.push(" checked"),!0===n.disabled&&h.push(" disabled"),h.push(">\n          "),h.push(this.Icon("checkbox","icon-unchecked")),h.push("\n          "),h.push(this.Icon("checkbox-checked","icon-checked")),h.push("\n        </label>\n      </td>\n      <td>\n        "),u=!1,h.push("\n        "),n.preferences.from&&!_.isEmpty(n.preferences.from)){for(h.push("\n          "),i=0,o=(c=n.preferences.from).length;i<o;i++)t=c[i],h.push("\n            "),t.user_id&&App.User.exists(t.user_id)?(h.push("\n              "),u&&h.push('<div class="spacer"></div>'),h.push('\n              <div class="user-card">\n                <div class="js-avatar" data-id="'),h.push(t.user_id),h.push('" data-level="'),h.push(d(t.level)),h.push('"></div>\n                <a class="text-muted" href="'),h.push(App.Utils.phoneify(n.from_pretty)),h.push('">'),h.push(d(n.from_pretty)),h.push("</a>\n              </div>\n              "),u=!0,h.push("\n            ")):_.isEmpty(t.comment)||(h.push("\n              "),u=!0,h.push('\n              <div class="user-card">\n                '),h.push(this.unique_avatar(t.comment,t.comment.split(" ").map(function(t){return t[0]}).join(""))),h.push("\n                "),h.push(this.T("maybe")),h.push(": "),h.push(d(t.comment)),h.push('<br>\n                <a class="text-muted" href="'),h.push(App.Utils.phoneify(n.from_pretty)),h.push('">'),h.push(d(n.from_pretty)),h.push("</a>\n              </div>\n            ")),h.push("\n          ");h.push("\n        ")}if(h.push("\n        "),u||_.isEmpty(n.from_comment)||(h.push("\n          "),u=!0,h.push('\n          <div class="user-card">\n            '),h.push(this.unique_avatar(n.from_comment,n.from_comment.split(" ").map(function(t){return t[0]}).join(""))),h.push("\n            "),h.push(d(n.from_comment)),h.push('<br>\n            <a class="text-muted" href="'),h.push(App.Utils.phoneify(n.from_pretty)),h.push('">'),h.push(d(n.from_pretty)),h.push("</a>\n          </div>\n        ")),h.push("\n        "),u||(h.push('\n          <div class="user-card">\n            '),h.push(this.unique_avatar(n.from_pretty||n.from,"??")),h.push("\n          "),_.isEmpty(n.from_pretty)?(h.push('\n            <a class="inherit-color" href="'),h.push(App.Utils.phoneify(n.from)),h.push('">'),h.push(d(n.from)),h.push("</a>\n          ")):(h.push('\n            <a class="inherit-color" href="'),h.push(App.Utils.phoneify(n.from_pretty)),h.push('">'),h.push(d(n.from_pretty)),h.push("</a>\n            "),"in"===n.direction&&(h.push('\n            <div class="btn btn--text btn--create no-padding js-newUser" href="#" data-phone="'),h.push(d(n.from_pretty)),h.push('">'),h.push(this.Icon("plus-small")),h.push(" <span>"),h.push(this.T("New User")),h.push("</div>\n            ")),h.push("\n          ")),h.push("\n          </div>\n        ")),h.push("\n      </td>\n      <td>\n        "),u=!1,h.push("\n        "),n.preferences.to&&!_.isEmpty(n.preferences.to)){for(h.push("\n          "),s=0,a=(p=n.preferences.to).length;s<a;s++)t=p[s],h.push("\n            "),t.user_id&&App.User.exists(t.user_id)?(h.push("\n              "),u=!0,h.push('\n              <div class="user-card">\n                <div class="js-avatar" data-id="'),h.push(t.user_id),h.push('" data-level="'),h.push(d(t.level)),h.push('"></div>\n                <a class="text-muted" href="'),h.push(App.Utils.phoneify(n.to_pretty)),h.push('">'),h.push(d(n.to_pretty)),h.push("</a>\n              </div>\n            ")):_.isEmpty(t.comment)||(h.push("\n              "),u=!0,h.push('\n              <div class="user-card">\n                '),h.push(this.unique_avatar(t.comment,t.comment.split(" ").map(function(t){return t[0]}).join(""))),h.push("\n                "),h.push(this.T("maybe")),h.push(": "),h.push(d(t.comment)),h.push('<br>\n                <a class="text-muted" href="'),h.push(App.Utils.phoneify(n.to_pretty)),h.push('">'),h.push(d(n.to_pretty)),h.push("</a>\n              </div>\n            ")),h.push("\n          ");h.push("\n        ")}h.push("\n        "),u||_.isEmpty(n.to_comment)||(h.push("\n          "),u=!0,h.push('\n          <div class="user-card">\n            '),h.push(this.unique_avatar(n.to_comment,n.to_comment.split(" ").map(function(t){return t[0]}).join(""))),h.push("\n            "),h.push(d(n.to_comment)),h.push('<br>\n            <a class="text-muted" href="'),h.push(App.Utils.phoneify(n.to_pretty)),h.push('">'),h.push(d(n.to_pretty)),h.push("</a>\n          </div>\n        ")),h.push("\n        "),u||(h.push('\n          <div class="user-card">\n            '),"in"!==n.direction&&(h.push("\n              "),h.push(this.unique_avatar(n.to_pretty||n.to,"??")),h.push("\n            ")),h.push("\n          "),_.isEmpty(n.to_pretty)?(h.push('\n            <a class="inherit-color" href="'),h.push(App.Utils.phoneify(n.to)),h.push('">'),h.push(d(n.to)),h.push("</a>\n          ")):(h.push('\n            <a class="inherit-color" href="'),h.push(App.Utils.phoneify(n.to_pretty)),h.push('">'),h.push(d(n.to_pretty)),h.push("</a>\n            "),"out"===n.direction&&(h.push('\n            <div class="btn btn--text btn--create no-padding js-newUser" href="#" data-phone="'),h.push(d(n.to_pretty)),h.push('">'),h.push(this.Icon("plus-small")),h.push(" <span>"),h.push(this.T("New User")),h.push("</div>\n            ")),h.push("\n          ")),h.push("\n          </div>\n        ")),h.push('\n      </td>\n      <!--<td style="vertical-align: middle">'),h.push(d(n.queue)),h.push("</td>-->\n      <td>\n        "),n.state_human&&(h.push("\n        "),h.push(this.Icon("status",n.status_class+" inline")),h.push(" "),h.push(this.T(n.state_human)),h.push("\n        ")),h.push("\n      </td>\n      <td>"),h.push(d(this.time_duration(n.duration_waiting_time))),h.push("</td>\n      <td>"),h.push(d(this.time_duration(n.duration_talking_time))),h.push("</td>\n      <td>"),h.push(this.humanTime(n.created_at)),h.push("</td>\n    </tr>\n    ")}h.push("\n  </tbody>\n</table>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,h.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/cti/caller_log_avatar"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push(this.user.avatar()),e.push('\n<div class="'),e.push(n(this.classes.join(" "))),e.push('" data-id="'),e.push(this.user.id),e.push('">'),"known"!==this.level&&(e.push(this.T("maybe")),e.push(": ")),e.push(n(this.user.displayNameLong())),e.push("</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/cti/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex">\n  <h1>'),e.push(this.T("Caller log")),e.push('</h1>\n  <div class="page-content js-callerLog"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/cti/not_configured"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="main flex fullscreenMessage">\n  <div>\n    <h1>'),s.push(this.T("Not configured")),s.push("</h1>\n    <p>"),s.push(this.T("Sorry, there is currently no CTI backend enabled.")),s.push("</p>\n    <p>"),s.push(this.T("We support")),s.push(':</p>\n    <div class="btn-group-vertical" role="group">\n    '),e=0,n=(i=this.backends).length;e<n;e++)t=i[e],s.push("\n      "),this.isAdmin&&(s.push('<a class="btn" href="'),s.push(t.url),s.push('">')),s.push(r(t.name)),this.isAdmin&&s.push("</a>"),s.push("\n    ");s.push("\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/chat_footer"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="chat-footer">\n  <div class="btn btn--primary js-createTicket">'),e.push(this.T("Turn chat into ticket")),e.push("</div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/chat_header"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="status-fields">\n  '),1<this.chats.length){for(s.push('\n  <div class="buttonDropdown dropdown">\n    <div class="status-field status-field--spacer js-acceptChat">\n      <span class="badge js-badgeWaitingCustomers"></span> '),s.push(this.T("Waiting Customers")),s.push(' \n    </div>\n    <div class="status-field status-field--arrow" data-toggle="dropdown">\n      '),s.push(this.Icon("arrow-down")),s.push('\n    </div>\n    <ul class="dropdown-menu" role="menu">\n      '),e=0,n=(i=this.chats).length;e<n;e++)t=i[e],s.push('\n      <li class="js-waitingCustomers js-acceptChat" disabled data-chat-id="'),s.push(r(t.id)),s.push('" role="menuitem">\n        <span class="badge js-badgeWaitingCustomers"></span> '),s.push(this.T("Waiting in %s",t.name)),s.push(' <span class="flex-spacer"></span>\n        <div class="status-badge js-info">\n          <div class="info-badge">'),s.push(this.Icon("info")),s.push("</div>\n        </div>\n      ");s.push("\n    </ul>\n  </div>\n  ")}else s.push('\n    <div class="status-field js-acceptChat js-waitingCustomers">\n      <span class="badge js-badgeWaitingCustomers"></span> '),s.push(this.T("Waiting Customers")),s.push(' \n      <div class="status-badge js-totalInfo">\n        <div class="info-badge">'),s.push(this.Icon("info")),s.push("</div>\n      </div>\n    </div>\n  ");s.push('\n  <div class="status-field js-chattingCustomers">\n    <span class="badge js-badgeChattingCustomers"></span> '),s.push(this.T("Chatting Customers")),s.push(' \n    <div class="status-badge js-info">\n      <div class="info-badge">'),s.push(this.Icon("info")),s.push('</div>\n    </div>\n  </div>\n  <div class="status-field js-activeAgents">\n    <span class="badge js-badgeActiveAgents"></span> '),s.push(this.T("Active Agents")),s.push(' \n    <div class="status-badge js-info">\n      <div class="info-badge">'),s.push(this.Icon("info")),s.push("</div>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/chat_list"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push("<hr>\n"),_.isEmpty(this.chat_sessions))s.push("\n"),s.push(this.T("none")),s.push("\n");else{for(s.push("\n<ul>\n"),e=0,n=(i=this.chat_sessions).length;e<n;e++)t=i[e],s.push("\n  <li>"),s.push(r(t.name)),s.push(" "),t.geo_data&&(s.push("- "),s.push(r(t.geo_data))),s.push(" - "),t.user_id&&(s.push(r(t.user.displayName())),s.push(" -")),s.push(' <small class="">'),s.push(this.humanTime(t.created_at)),s.push("</small>\n");s.push("\n</ul>\n")}s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/chat_loader"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="chat-message chat-message--customer chat-message--loader js-loader">\n  <div class="chat-loader">\n    '),e.push(this.Icon("loading")),e.push("\n    "),e.push(this.Icon("loading")),e.push("\n    "),e.push(this.Icon("loading")),e.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/chat_message"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="chat-message chat-message--'),e.push(n(this.sender)),this.isNew&&e.push(n(" chat-message--new")),e.push('">'),e.push(this.message),e.push("</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/chat_notice_message"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="chat-notice-message">'),e.push(n(this.message)),e.push("</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/chat_status_message"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="chat-status-message">'),e.push(this.message),e.push("</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/chat_timestamp"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="chat-timestamp js-timestamp"><span class="chat-timestamp-label">'),e.push(n(this.label)),e.push("</span> "),e.push(n(this.time)),e.push("</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/chat_window"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="chat-header">\n  <div class="chat-status js-status" data-status="online">\n    <div class="chat-status-holder">\n      '),s.push(this.Icon("status")),s.push("\n      "),s.push(this.Icon("status-modified-outer-circle")),s.push("\n      "),s.push(this.Icon("small-dot","icon-status-modified-inner-circle")),s.push('\n    </div>\n  </div>\n  <div class="chat-name">\n    <span class="js-name js-info u-clickable">'),s.push(r(this.name)),s.push("<span> #"),s.push(r(this.session.id)),s.push('\n  </div>\n  <div class="chat-disconnect js-disconnect">\n    <div class="btn btn--action btn--small">'),s.push(this.T("disconnect")),s.push('</div>\n  </div>\n  <div class="chat-close js-close is-hidden">\n    <div class="btn btn--action btn--small">'),s.push(this.T("close")),s.push('</div>\n  </div>\n</div>\n<div class="chat-scroll-hint js-scrollHint is-hidden">\n  '),s.push(this.Icon("chat")),s.push("\n  "),s.push(this.T("Scroll down to see new messages")),s.push('\n</div>\n<div class="chat-body-holder js-scrollHolder">\n  <div class="chat-body js-body"></div>\n  <div class="chat-body js-meta hidden">\n    '),this.session){for(s.push("\n    "),s.push(this.T("Transfer conversation to another chat:")),s.push("\n    <ul>\n      "),e=0,n=(i=this.chats).length;e<n;e++)t=i[e],s.push("\n        "),this.session.chat_id!==t.id&&(s.push('\n          <li><a data-chat-id="'),s.push(r(t.id)),s.push('" class="js-transferChat" href="#">'),s.push(t.name),s.push("</a>\n        ")),s.push("\n      ");s.push("\n    </ul>\n    <hr>\n    <ul>\n      <li>"),s.push(this.T("Created at")),s.push(": "),s.push(this.Ttimestamp(this.session.created_at)),s.push("</li>\n      "),this.session&&this.session.preferences&&(s.push("\n        "),this.session.preferences.geo_ip&&(s.push("\n          <li>GeoIP: "),s.push(r(this.session.preferences.geo_ip.country_name)),s.push(" "),s.push(r(this.session.preferences.geo_ip.city_name)),s.push("</li>\n        ")),s.push("\n        "),this.session.preferences.remote_ip&&(s.push("\n          <li>IP: "),s.push(r(this.session.preferences.remote_ip)),s.push("</li>\n        ")),s.push("\n        "),this.session.preferences.dns_name&&(s.push("\n          <li>DNS: "),s.push(r(this.session.preferences.dns_name)),s.push("</li>\n        ")),s.push("\n      ")),s.push("\n    </ul>\n    ")}s.push('\n    <form class="js-metaForm" style="max-width: 200px; width: 100%;"></form>\n  </div>\n</div>\n<div class="chat-controls">\n  <div class="chat-input">\n    <div class="form-control form-control--small form-control--multiline js-customerChatInput" contenteditable="true"></div>\n  </div>\n  <div class="btn btn--primary btn--slim btn--small js-send">'),s.push(this.T("Send")),s.push("</div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="chat main">\n  <div class="page-header">\n      <div class="page-header-title">\n        <h1>'),e.push(this.T("Customer Chat")),e.push('</h1>\n      </div>\n      <div class="page-header-center js-header"></div>\n      <div class="page-header-meta">\n        <div class="btn btn--action js-settings">'),e.push(this.T("Settings")),e.push('</div>\n      </div>\n    </div>\n  <div class="chat-workspace"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/setting"]=function(t){t||(t={});var p=[],u=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c;for(this.errors.settings&&(p.push('\n  <div class="alert alert--danger">'),p.push(this.T(this.errors.settings)),p.push("</div>\n")),p.push('\n<div class="select form-group">\n  <label for="chat_max_windows">'),p.push(this.T("Max. concurrent chats")),p.push('</label>\n  <div class="u-positionOrigin">\n    <select id="chat_max_windows" class="form-control" name="chat::max_windows">\n      '),e=n=1;n<=20;e=++n)p.push('\n        <option value="'),p.push(e),p.push('" '),parseInt(this.preferences.chat.max_windows)===e&&p.push("selected"),p.push(">"),p.push(e),p.push("</option>\n      ");for(p.push("\n    </select>\n    "),p.push(this.Icon("arrow-down","dropdown-arrow")),p.push('\n  </div>\n</div>\n<div class="select form-group">\n  <label for="chat_alternative_name">'),p.push(this.T("Alternative name")),p.push('</label>\n  <div class="u-positionOrigin">\n    <input id="chat_alternative_name" class="form-control" name="chat::alternative_name" value="'),p.push(u(this.preferences.chat.alternative_name)),p.push('"/>\n  </div>\n</div>\n<div class="select form-group">\n  <label for="chat_avatar_state">'),p.push(this.T("Avatar")),p.push('</label>\n  <div class="u-positionOrigin">\n    <select id="chat_avatar_state" class="form-control" name="chat::avatar_state">\n      '),i=0,r=(a=["enabled","disabled"]).length;i<r;i++)c=a[i],p.push('\n        <option value="'),p.push(c),p.push('" '),this.preferences.chat.avatar_state===c&&p.push("selected"),p.push(">"),p.push(this.T(c)),p.push("</option>\n      ");for(p.push("\n    </select>\n    "),p.push(this.Icon("arrow-down","dropdown-arrow")),p.push('\n  </div>\n</div>\n<table class="settings-list settings-list--stretch">\n  <thead>\n    <tr>\n      <th>'),p.push(this.T("Topic")),p.push("\n      <th>"),p.push(this.T("Greeting")),p.push(" ("),p.push(this.T("Separate multiple values by ;")),p.push(")\n      <th>"),p.push(this.T("Enabled")),p.push("\n    </th></tr>\n  </thead>\n  <tbody>\n"),s=0,o=(l=this.chats).length;s<o;s++)t=l[s],p.push("\n    <tr>\n      <td>"),p.push(u(t.name)),p.push('\n      <td class="settings-list-control-cell"><label class="inline-label"><input name="chat::phrase::'),p.push(t.id),p.push('" value="'),p.push(u(this.preferences.chat.phrase[t.id])),p.push('" class="form-control form-control--small" placeholder="'),p.push(this.T("Hello, my name is %s, what can I do for you?",App.Session.get("firstname"))),p.push('"/></label>\n      <td class="u-positionOrigin">\n        <label class="checkbox-replacement checkbox-replacement--fullscreen">\n            <input type="checkbox" name="chat::active::'),p.push(t.id),p.push('" '),this.preferences.chat.active[t.id]&&p.push("checked"),p.push(">\n            "),p.push(this.Icon("checkbox","icon-unchecked")),p.push("\n            "),p.push(this.Icon("checkbox-checked","icon-checked")),p.push("\n        </label>\n");p.push("\n  </tbody>\n</table>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_chat/user_list"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push("<hr>\n"),_.isEmpty(this.users))s.push("\n"),s.push(this.T("none")),s.push("\n");else{for(s.push('\n<div class="userList">\n'),t=0,e=(n=this.users).length;t<e;t++)i=n[t],s.push('\n  <div class="userList-entry">\n    '),s.push(i.avatar("30")),s.push('\n    <span class="userList-name">\n      '),s.push(r(i.displayName())),s.push("\n    </span>\n  </div>\n");s.push("\n</div>\n")}s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_not_ticket_exists"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="">\n  <h1>'),e.push(this.T("Welcome!")),e.push('<small></small></h1>\n  <div class="container">\n    <div class="row">\n      <div class="span12">\n        <p>'),e.push(this.T("You have not created a ticket yet.")),e.push("</p>\n        <p>"),e.push(this.T('The way to communicate with us is this thing called "ticket".')),e.push("</p>\n        <p>"),e.push(this.T("Please click the button below to create your first one.")),e.push('</p>\n\n        <p><a class="btn btn--primary" href="#customer_ticket_new">'),e.push(this.T("Create your first ticket")),e.push("</a></p>\n      </div>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/customer_ticket_create"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="horizontal flex">\n  <div class="main no-padding flex">\n    <div class="newTicket">\n      <div class="box box--newTicket">\n        <div class="page-header">\n          <h1>'),e.push(this.T("New Ticket")),e.push('</h1>\n        </div>\n\n        <div class="page-content">\n          <form role="form" class="ticket-create" autocomplete="off">\n            <input type="hidden" name="form_id" value="'),e.push(n(this.form_id)),e.push('"/>\n\n            <div class="ticket-form-top"></div>\n            <div class="article-form-top"></div>\n\n            <div class="formset-inset">\n              <div class="ticket-form-middle horizontal two-columns"></div>\n              <div class="ticket-form-bottom"></div>\n            </div>\n\n            <div class="form-controls">\n              <a class="btn btn--text btn--subtle js-cancel" href="#/">'),e.push(this.T("Cancel & Go Back")),e.push('</a>\n              <button type="submit" class="btn btn--success js-submit align-right">'),e.push(this.T("Create")),e.push('</button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class="sidebar"></div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="dashboard main flex center">\n  <div class="tabs tabs--big">\n    <div class="tab active" data-area="stat-widgets">'),e.push(this.T("My Stats")),e.push('</div>\n    <div class="tab" data-area="first-steps-widgets">'),e.push(this.T("First Steps")),e.push('</div>\n  </div>\n  <div class="tab-content first-steps-widgets hidden"></div>\n  <div class="tab-content stat-widgets three-columns horizontal"></div>\n</div>\n<div class="sidebar optional">\n  <h2>'),e.push(this.T("Activity Stream")),e.push('</h2>\n  <div class="activity-description">\n    <p>'),e.push(this.T("Here you will find the latest activities of your system.")),e.push("</p>\n    <p>"),e.push(this.T("E. g. recent changed tickets, users or organizations.")),e.push('</p>\n  </div>\n  <div class="activity-entries js-activityContent">\n    <p>'),e.push(this.T("Here you will find the latest activities of your system.")),e.push("</p>\n    <p>"),e.push(this.T("E. g. recent changed tickets, users or organizations.")),e.push("</p>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/activity_stream_item"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="js-item activity-entry">\n  <div class="activity-avatar js-avatar"></div>\n  <a href="'),e.push(this.item.link),e.push('" class="activity-body">\n    <span class="activity-message">\n      <span class="activity-text">\n        '),this.item.objectNative&&this.item.objectNative.activityMessage?(e.push("\n          "),e.push(this.item.objectNative.activityMessage(this.item)),e.push("\n        ")):(e.push("\n            Need objectNative in item "),e.push(n(item.object)),e.push(".find("),e.push(n(item.o_id)),e.push(")\n        ")),e.push("\n      </span>\n      "),e.push(this.humanTime(this.item.created_at,!1,"activity-time")),e.push('\n    </span>\n    <span class="activity-icon">\n      '),this.item.cssIcon&&(e.push("\n      "),e.push(this.Icon(this.item.cssIcon)),e.push("\n      ")),e.push("\n    </span>\n  </a>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/first_steps"]=function(t){t||(t={});var l=[],e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(l.push('<div class="box box--paper">\n  '),e=0,s=(o=this.data).length;e<s;e++){for(t=o[e],l.push("\n  <h3>"),l.push(this.T(t.name)),l.push("</h3>\n    "),i=0,r=(a=t.items).length;i<r;i++)n=a[i],l.push('\n    <a class="todo '),n.checked&&l.push("is-done"),l.push(" "),n["class"]&&l.push(n["class"]),l.push('" href="'),l.push(n.location),l.push('">\n      '),n.checked?(l.push("\n        "),l.push(this.Icon("checkmark"))):(l.push("\n        "),l.push(this.Icon("small-dot"))),l.push("\n      "),l.push("\n      "),l.push(this.T(n.name)),l.push("\n    </a>\n    ");l.push("\n  ")}l.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/first_steps_clues"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="modal-backdrop js-backdrop"></div>\n<div class="modal-spacer js-positionOrigin"></div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/first_steps_clues_content"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="")
;var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="modal-content">\n  <div class="modal-arrow js-arrow"></div>\n  <div class="modal-close js-close">\n    '),e.push(this.Icon("diagonal-cross")),e.push('\n  </div>\n  <div class="modal-header">'),e.push(this.T(this.headline)),e.push('</div>\n  <div class="modal-body">'),e.push(this.T(this.text)),e.push('</div>\n  <div class="modal-controls">\n    <div class="modal-control">\n      <div class="'),0===this.position&&e.push("is-disabled "),e.push('btn btn--text js-previous">'),e.push(this.T("Previous")),e.push('</div>\n    </div>\n    <div class="modal-control clue-count">'),e.push(n(this.position+1)),e.push("/"),e.push(n(this.max)),e.push('</div>\n    <div class="modal-control">\n      '),this.position+1===this.max?(e.push('\n        <div class="btn btn--text js-next">'),e.push(this.T("Finish"))):(e.push('\n        <div class="btn btn--text js-next">'),e.push(this.T("Next"))),e.push("</div>\n      "),e.push("\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/first_steps_test_ticket_finish"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push("<p>"),e.push(this.T('A test ticket has been created, you can find it in your overview "%s" %l.',this.overviewName,this.overviewUrl)),e.push('</p>\n<div class="centered">\n  <a class="btn btn--success flex" href="'),e.push(this.ticketUrl),e.push('">'),e.push(this.T("Open Ticket# %s",this.ticketNumber)),e.push("</a>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/first_steps_test_ticket_loading"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="wizard-body vertical justified">\n  <p class="wizard-loadingText">\n    <span class="loading icon"></span>\n  </p>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/stats/ticket_channel_distribution"]=function(t){t||(t={});var i=[],e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(e in i.push('<div class="column ticket_channel_distribution">\n  <div class="stat-widget vertical">\n    <div class="stat-title">\n      '),i.push(this.T("Channel Distribution")),i.push('\n      <div class="stat-icon-help js-stat-help" title="'),i.push(this.Ti(this.StatsTicketChannelDistribution.description)),i.push('" data-placement="left">\n        '),i.push(this.Icon("help")),i.push('\n      </div>\n    </div>\n    <div class="stat-graphic" data-columns="'),i.push(_.size(this.StatsTicketChannelDistribution.channels)),i.push('">\n      '),n=this.StatsTicketChannelDistribution.channels)t=n[e],i.push('\n      <div class="stats-row">\n        <div title="'),i.push(t.sender),i.push('">\n          '),i.push(this.Icon(t.icon,"stat-channel-icon")),i.push('\n        </div>\n        <div class="stat-bars">\n          <div class="stat-bar stat-bar--inbound" style="height: '),i.push(t.inbound_in_percent),i.push('%" title="'),i.push(this.Ti("Inbound")),i.push(": "),i.push(t.inbound_in_percent),i.push("% ("),i.push(t.inbound),i.push(')"></div>\n          <div class="stat-bar stat-bar--outbound" style="height: '),i.push(t.outbound_in_percent),i.push('%" title="'),i.push(this.Ti("Outbound")),i.push(": "),i.push(t.outbound_in_percent),i.push("% ("),i.push(t.outbound),i.push(')"></div>\n        </div>\n        <div class="stat-detail">'),i.push(t.overal_percentage),i.push("%</div>\n      </div>\n      ");i.push("\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/stats/ticket_escalation"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="column ticket_escalation">\n  <div class="stat-widget vertical">\n    <div class="stat-title">\n      '),e.push(this.T("Mood")),e.push('\n      <div class="stat-icon-help js-stat-help" title="'),e.push(this.Ti(this.StatsTicketEscalation.description)),e.push('" data-placement="bottom">\n        '),e.push(this.Icon("help")),e.push('\n      </div>\n    </div>\n    <div class="stat-graphic">\n      '),e.push(this.Icon("mood-"+this.StatsTicketEscalation.state,"stat-icon mood-icon")),e.push('\n    </div>\n    <div class="stat-label">'),e.push(this.T("%s of my tickets escalated.",this.StatsTicketEscalation.own)),e.push('</div>\n    <div class="stat-detail">'),e.push(this.T("Total: %s",this.StatsTicketEscalation.total)),e.push("</div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/stats/ticket_in_process"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="column ticket_in_process">\n  <div class="stat-widget vertical">\n    <div class="stat-title">\n      '),e.push(this.T("Your tickets in process")),e.push('\n      <div class="stat-icon-help js-stat-help" title="'),e.push(this.Ti(this.StatsTicketInProcess.description)),e.push('" data-placement="bottom">\n        '),e.push(this.Icon("help")),e.push('\n      </div>\n    </div>\n    <div class="stat-graphic">\n      '),e.push(this.Icon("in-process","in-process-icon "+this.StatsTicketInProcess.state+"-color")),e.push('\n    </div>\n    <div class="stat-label" title="'),e.push(this.T("%s of your tickets are currently in process.",this.StatsTicketInProcess.in_process)),e.push('">'),e.push(this.T("%s% are currently in process",this.StatsTicketInProcess.percent)),e.push('</div>\n    <div class="stat-detail">'),e.push(this.T("Average: %s%",this.StatsTicketInProcess.average_per_agent)),e.push("</div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/stats/ticket_load_measure"]=function(t){t||(t={});var i=[],e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(i.push('<div class="column ticket_load_measure">\n  <div class="stat-widget vertical">\n    <div class="stat-title">\n      '),i.push(this.T("Assigned")),i.push('\n      <div class="stat-icon-help js-stat-help" title="'),i.push(this.Ti(this.StatsTicketLoadMeasure.description)),i.push('" data-placement="bottom">\n        '),i.push(this.Icon("help")),i.push('\n      </div>\n    </div>\n    <div class="stat-graphic">\n      <div class="stat-tickets vertical reverse end">\n        '),n=parseInt(.16*this.StatsTicketLoadMeasure.percent),i.push("\n        "),t=1,e=n;1<=e?t<=e:e<=t;1<=e?++t:--t)i.push("\n          "),i.push(this.Icon("one-ticket","one-ticket "+this.StatsTicketLoadMeasure.state+"-color")),i.push("\n        ");i.push("\n      </div>\n      "),i.push(this.Icon("total-tickets","total-tickets")),i.push('\n    </div>\n    <div class="stat-label">'),i.push(this.T("Tickets assigned to me: %s of %s",this.StatsTicketLoadMeasure.own,this.StatsTicketLoadMeasure.total)),i.push('</div>\n    <div class="stat-detail">'),i.push(this.T("Average: %s",this.StatsTicketLoadMeasure.average_per_agent)),i.push("</div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/stats/ticket_reopen"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="column ticket_reopen">\n  <div class="stat-widget vertical">\n    <div class="stat-title">\n      '),e.push(this.T("Reopening rate")),e.push('\n      <div class="stat-icon-help js-stat-help" title="'),e.push(this.Ti(this.StatsTicketReopen.description)),e.push('" data-placement="left">\n        '),e.push(this.Icon("help")),e.push('\n      </div>\n    </div>\n    <div class="stat-graphic">\n      '),e.push(this.Icon("reopening","reopening-icon "+this.StatsTicketReopen.state+"-color")),e.push('\n    </div>\n    <div class="stat-label">'),e.push(this.T("%s% have been reopened",this.StatsTicketReopen.percent)),e.push('</div>\n    <div class="stat-detail">'),e.push(this.T("Average: %s%",this.StatsTicketReopen.average_per_agent)),e.push("</div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/dashboard/stats/ticket_waiting_time"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="column ticket_waiting_time">\n  <div class="time stat-widget vertical">\n    <div class="stat-title">\n      '),e.push(this.T("\u2205 Waiting time today")),e.push('\n      <div class="stat-icon-help js-stat-help" title="'),e.push(this.Ti(this.StatsTicketWaitingTime.description)),e.push('" data-placement="bottom">\n        '),e.push(this.Icon("help")),e.push('\n      </div>\n    </div>\n    <div class="stat-graphic">\n      <div class="stat-stopwatch centered">\n        '),e.push(this.Icon("stopwatch","stat-icon stopwatch-icon")),e.push('\n        <canvas class="stat-dial"></canvas>\n        <div class="stat-amount"></div>\n      </div>\n    </div>\n    <div class="stat-label">'),e.push(this.T("My handling time: %s minutes",this.StatsTicketWaitingTime.handling_time)),e.push('</div>\n    <div class="stat-detail">'),e.push(this.T("Average: %s minutes",this.StatsTicketWaitingTime.average_per_agent)),e.push("</div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/facebook/account_edit"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="alert alert--danger hidden" role="alert"></div>\n<fieldset>\n\n  <h1>'),s.push(this.T("Wall")),s.push('</h1>\n  <p class="description">'),s.push(this.T("Choose the group in which wall postings will get added to.")),s.push('</p>\n  <div class="js-wall">\n    <h2>'),s.push(r(this.channel.options.user.name)),s.push('</h2>\n    <div data-page-id="'),s.push(r(this.channel.options.user.id)),s.push('" class="js-groups"></div>\n  </div>\n\n  <hr>\n\n  <h1>'),s.push(this.T("Pages")),s.push('</h1>\n  <p class="description">'),s.push(this.T("Choose the group in which page postings will get added to.")),s.push('</p>\n  <div class="js-pages">\n    '),this.channel.options.pages){for(s.push("\n      "),t=0,e=(i=this.channel.options.pages).length;t<e;t++)n=i[t],s.push("\n        <h2>"),s.push(r(n.name)),s.push('</h2>\n        <div data-page-id="'),s.push(r(n.id)),s.push('" class="js-groups"></div>\n      ');s.push("\n    ")}s.push("\n  </div>\n\n</fieldset>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/facebook/app_config"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="alert alert--danger hidden" role="alert"></div>\n<p>\n  '),e.push(this.T("The tutorial on how to manage a %s is hosted on our online documentation %l.","Facebook App","https://admin-docs.zammad.org/en/latest/channels/facebook.html")),e.push("\n</p>\n<fieldset>\n  <h2>"),e.push(this.T("Enter your %s App Keys","Facebook")),e.push('</h2>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="application_id">Facebook APP ID <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="application_id" type="text" name="application_id" value="'),this.external_credential&&this.external_credential.credentials&&e.push(n(this.external_credential.credentials.application_id)),e.push('" class="form-control" required autocomplete="off">\n    </div>\n  </div>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="application_secret">Facebook App Secret <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="application_secret" type="text" name="application_secret" value="'),this.external_credential&&this.external_credential.credentials&&e.push(n(this.external_credential.credentials.application_secret)),e.push('" class="form-control" required autocomplete="off">\n    </div>\n  </div>\n  <h2>'),e.push(this.T("Your callback URL")),e.push('</h2>\n  <div class="input form-group">\n    <div class="controls">\n      <input class="form-control js-select" readonly value="'),e.push(n(this.callbackUrl)),e.push('">\n    </div>\n  </div>\n</fieldset>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/facebook/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),e.push(this.T("Facebook")),e.push(" <small>"),e.push(this.T("Accounts")),e.push('</small></h1>\n  </div>\n</div>\n\n<div class="page-content">\n  <div class="page-description">\n    <p>'),e.push(this.T("You can connect %s with Zammad. You need to connect your Zammad with %s first.","Facebook Accounts","Facebook")),e.push('</p>\n    <div class="btn btn--success js-configApp">'),e.push(this.T("Connect Facebook App")),e.push("</div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/facebook/list"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(l.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),l.push(this.T("Facebook")),l.push(" <small>"),l.push(this.T("Accounts")),l.push('</small></h1>\n  </div>\n\n  <div class="page-header-meta">\n    <a class="btn js-configApp">'),l.push(this.T("Configure App")),l.push('</a>\n    <a class="btn btn--success js-new">'),l.push(this.T("Add Account")),l.push('</a>\n  </div>\n</div>\n\n<div class="page-content">\n'),e=0,i=(o=this.channels).length;e<i;e++){if(t=o[e],l.push('\n  <div class="action '),!0!==t.active&&l.push("is-inactive"),l.push('" data-id="'),l.push(c(t.id)),l.push('">\n    <div class="action-block action-row">\n      <h2>'),l.push(this.Icon("status","supergood-color inline")),l.push(" "),l.push(c(t.options.user.name)),l.push(' <span class="text-muted">'),l.push(c(t.options.user.id)),l.push('</span></h2>\n    </div>\n    <div class="action-flow action-flow--row">\n      <div class="action-block">\n        <h3>'),l.push(this.T("Wall")),l.push("</h3>\n        "),l.push(c(t.options.user.name)),l.push(" ->  "),l.push(c(t.options.sync.wall.groupName)),l.push('\n      </div>\n    </div>\n    <div class="action-flow action-flow--row">\n      <div class="action-block">\n        <h3>'),l.push(this.T("Pages")),l.push("</h3>\n        "),t.options.pages){for(l.push("\n          "),n=0,s=(a=t.options.pages).length;n<s;n++)r=a[n],l.push("\n            "),l.push(c(r.name)),l.push(" -> "),l.push(c(r.groupName)),l.push("<br>\n            ("),l.push(c(r.perms)),l.push(")<br>\n          ");l.push("\n        ")}l.push('\n      </div>\n    </div>\n    <div class="action-controls">\n      <div class="btn btn--danger btn--secondary js-delete">'),l.push(this.T("Delete")),l.push("</div>\n      "),!0===t.active?(l.push('\n        <div class="btn btn--secondary js-disable">'),l.push(this.T("Disable"))):(l.push('\n        <div class="btn btn--secondary js-enable">'),l.push(this.T("Enable"))),l.push("</div>\n      "),l.push('\n      <div class="btn js-edit">'),l.push(this.T("Edit")),l.push("</div>\n    </div>\n  </div>\n")}l.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/actions"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="dropdown dropdown--actions">\n  <div class="dropdown-toggle" id="userAction" data-toggle="dropdown">\n    '),"small"!==this.type&&(s.push("\n      "),s.push(this.Icon("cog","dropdown-icon")),s.push("\n      <label>"),s.push(this.T("Action")),s.push("</label>\n    ")),s.push("\n    "),s.push(this.Icon("arrow-down")),s.push('\n  </div>\n  <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="userAction">\n    '),t=0,n=(i=this.items).length;t<n;t++)e=i[t],s.push('\n      <li role="presentation" data-type="'),s.push(r(e.name)),s.push('"><a role="menuitem" tabindex="-1" href="#">'),s.push(this.T(e.title)),s.push("</a>\n    ");s.push("\n  </ul>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/admin/empty"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push("<p>"),e.push(this.T(this.explanation)),e.push('</p>\n\n<table class="table table--placeholder">\n  <thead><tr><th>'),e.push(this.T("No Entries")),e.push("\n</table>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/admin/index"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),s.push(this.T(this.head)),s.push(" <small>"),s.push(this.T("Management")),s.push('</small></h1>\n  </div>\n  <div class="page-header-meta">\n    '),this.showDescription&&(s.push('\n      <a class="btn js-description">'),s.push(this.T("Description")),s.push("</a>\n    ")),s.push("\n    "),this.buttons){for(s.push("\n      "),e=0,n=(i=this.buttons).length;e<n;e++)t=i[e],s.push('\n        <a data-type="'),s.push(r(t["data-type"])),s.push('" class="btn '),s.push(r(t["class"])),s.push('" href="'),s.push(r(t.href)),s.push('">'),s.push(this.T(t.name)),s.push("</a>\n      ");s.push("\n    ")}s.push('\n  </div>\n</div>\n\n<div class="page-content">\n  <div class="table-overview"></div>\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/admin_level2/index"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="sidebar">\n\n  <ul class="nav nav-pills nav-stacked">\n  '),this.menus){for(s.push("\n    "),t=0,e=(i=this.menus).length;t<e;t++)n=i[t],s.push('\n      <li class="'),s.push(r(n["class"])),s.push('"><a href="'),s.push(r(this.page.nav)),s.push("/"),s.push(r(n.target)),s.push('" data-toggle="tabnav" data-target="'),s.push(r(n.target)),s.push('" >'),s.push(this.T(n.name)),s.push("</a></li>\n    ");s.push("\n  ")}s.push('\n  </ul>\n\n</div>\n<div class="main flex">\n\n  <div class="page-header">\n    <div class="page-header-title">\n      <h1>'),s.push(this.T(this.page.head)),s.push(" <small>"),s.push(this.T(this.page.sub_head)),s.push('</small></h1>\n    </div>\n  </div>\n  <div class="page-content">\n    <div class="nav-tab-content"></div>\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/attachment"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t;e.push('<div class="attachments"></div>\n<div class="article-attachment">\n  <div class="attachmentPlaceholder">\n    <span class="attachmentPlaceholder-inputHolder fileUpload">\n      '),t=_.uniqueId("fileUpload_"),e.push('\n      <input multiple="multiple" type="file" name="file" id="'),e.push(t),e.push('">\n      <label class="attachmentPlaceholder-label" for="'),e.push(t),e.push('">\n        '),e.push(this.T("select attachment...")),e.push('\n      </label>\n    </span>\n  </div>\n  <div class="attachmentUpload hide">\n    <div class="horizontal">\n      <div class="u-highlight">\n        '),e.push(this.T("Uploading")),e.push(' (<span class="js-percentage">0</span>%) ...\n      </div>\n      <div class="attachmentUpload-cancel js-cancel">\n        '),e.push(this.Icon("diagonal-cross")),e.push("</div>"),e.push(this.T("Cancel Upload")),e.push('\n      </div>\n    </div>\n    <div class="attachmentUpload-progressBar" style="width: 0%"></div>\n  </div>\n</div>\n<div class="fit dropArea">\n  <div class="dropArea-inner">\n    '),e.push(this.T("Drop files here")),e.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/attachment_item"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="attachment attachment--row">\n  <div class="attachment-name">'),e.push(n(this.filename)),e.push('</div>\n  <div class="attachment-size">'),e.push(n(this.humanFileSize(this.size))),e.push('</div>\n  <div class="attachment-delete js-delete" data-id="'),e.push(n(this.id)),e.push('">\n    '),e.push(this.Icon("diagonal-cross")),e.push(this.T("Delete File")),e.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/attachments"]=function(t){t||(t={});var r=[],o=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s;if(!_.isEmpty(this.attachments)){for(r.push('\n  <div class="attachments attachments--list">\n    '),r.push(this.Icon("paperclip")),r.push('\n    <div class="attachments-title">'),r.push(this.attachments.length),r.push(" "),r.push(this.T("Attached Files")),r.push("</div>\n    "),n=0,i=(s=this.attachments).length;n<i;n++)t=s[n],r.push("\n      "),this.C("ui_ticket_zoom_attachments_preview")?(r.push("\n        "),e=t.preferences["Content-Type"]||t.preferences.content_type,r.push('\n        <a class="attachment attachment--preview" href="'),r.push(o(t.url)),r.push('" data-type="attachment"'),this.canDownload(e)?r.push(" download"):r.push('target="_blank"'),r.push('>\n          <div class="attachment-icon">\n          '),t.preferences&&e&&this.ContentTypeIcon(e)?(r.push("\n            "),this.canPreview(e)?(r.push('\n              <img src="'),r.push(o(t.preview_url)),r.push('">\n            ')):(r.push("\n              "),r.push(this.Icon(this.ContentTypeIcon(e))),r.push("\n            "))):(r.push("\n            "),r.push(this.Icon("file-unknown"))),r.push("\n          "),r.push('\n          </div>\n          <span class="attachment-name u-highlight">'),r.push(o(t.filename)),r.push('</span>\n          <div class="attachment-size">'),r.push(this.humanFileSize(t.size)),r.push("</div>\n        </a>\n      ")):(r.push('\n        <div class="attachment attachment--row">\n          <a class="attachment-name u-highlight" href="'),r.push(o(t.url)),r.push('" data-type="attachment" '),this.canDownload(e)?r.push("download"):r.push('target="_blank"'),r.push(">"),r.push(o(t.filename)),r.push('</a>\n          <div class="attachment-size">'),r.push(this.humanFileSize(t.size)),r.push("</div>\n        </div>\n      ")),r.push("\n    ");r.push("\n  </div>\n")}r.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,r.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/attribute"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div data-attribute-name="'),e.push(n(this.attribute.name)),e.push('" class="'),e.push(n(this.attribute.tag)),e.push(" form-group"),"block"===this.attribute.style&&e.push(n(" form-group--block")),this.attribute.item_class&&e.push(n(" "+this.attribute.item_class)),e.push('"'),this.attribute.grid_width&&e.push(n(" data-width="+this.attribute.grid_width)),e.push(">\n  "),"block"===this.attribute.style&&e.push("\n  <h2>\n  "),e.push('\n  <div class="formGroup-label">\n    <label for="'),e.push(n(this.attribute.id)),e.push('"'),this.attribute.label_class&&(e.push(' class="'),e.push(n(this.attribute.label_class)),e.push('"')),e.push(">"),e.push(this.T(this.attribute.display)),e.push(" <span>"),this.attribute["null"]||e.push("*"),e.push("</span></label>\n    "),e.push(this.item),e.push("\n    "),this.bookmarkable&&e.push('\n    <div class="align-right js-bookmark formGroup-bookmark">\n      <div class="filled bookmark icon"></div>\n    </div>\n    '),e.push("\n    "),this.attribute.note&&(e.push('\n    <div class="help-message js-helpMessage" title="'),e.push(this.Ti(this.attribute.note)),e.push('">\n      '),e.push(this.Icon("help")),e.push("\n    </div>\n    ")),e.push("\n  </div>\n  "),"block"===this.attribute.style&&(e.push('\n  </h2>\n  <p class="help-text">'),this.attribute.help&&e.push(this.T(this.attribute.help)),e.push(this.attribute.helpLink),e.push("</p>\n  ")),e.push('\n  <div class="controls '),_.isEmpty(this.attribute.linktemplate)||_.isEmpty(this.placeholderObjects)||e.push("controls--button"),e.push('">\n    '),_.isEmpty(this.attribute.linktemplate)||_.isEmpty(this.placeholderObjects)||(e.push('\n    <a href="'),e.push(this.replacePlaceholder(this.attribute.linktemplate,this.placeholderObjects,!0)),e.push('" class="controls-button" target="_blank" rel="nofollow">\n      <span class="controls-button-inner">'),e.push(this.Icon("external")),e.push("</span>\n    </a>\n    ")),e.push('\n    <span class="help-inline"></span>\n    '),"block"!==this.attribute.style&&(e.push('\n    <span class="help-block">'),this.attribute.help&&e.push(this.T(this.attribute.help)),e.push(this.attribute.helpLink),e.push("</span>\n    ")),e.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/autocompletion"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<input id="'),e.push(n(this.attribute.id)),e.push('" type="hidden" name="'),e.push(n(this.attribute.name)),e.push('" value="'),e.push(n(this.attribute.value)),e.push('" '),e.push(n(this.attribute.required)),e.push(' />\n<input id="'),e.push(n(this.attribute.id)),e.push('_autocompletion" type="text" name="'),e.push(n(this.attribute.name)),e.push('_autocompletion" value="'),e.push(n(this.attribute.valueShown)),e.push('" class="form-control '),e.push(n(this.attribute["class"])),e.push('" '),e.push(n(this.attribute.required)),e.push(" "),e.push(n(this.attribute.autofocus)),e.push(" "),e.push(this.attribute.autocapitalize),e.push(" "),this.attribute.placeholder&&(e.push('placeholder="'),e.push(this.Ti(this.attribute.placeholder)),e.push('"')),e.push(' autocomplete="off"/>\n<input id="'),e.push(n(this.attribute.id)),e.push('_autocompletion_value_shown" type="hidden" name="'),e.push(n(this.attribute.name)),e.push('_autocompletion_value_shown" value="'),e.push(n(this.attribute.valueShown)),e.push('"/>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),
this.JST["app/views/generic/business_hours"]=function(t){t||(t={});var c=[],p=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l;for(n in c.push("<thead>\n  <tr>\n    "),i=this.days)t=i[n],c.push('\n    <th style="text-align: center">\n      <label class="day-name u-textTruncate">\n        <span class="checkbox-replacement checkbox-replacement--inline">\n          <input class="js-toggle-day" name="'),c.push(p(this.attribute.name)),c.push("::"),c.push(n),c.push('::active" value="true" data-target="'),c.push(n),c.push('" type="checkbox"'),this.hours[n].active&&c.push(" checked"),c.push(">\n          "),c.push(this.Icon("checkbox","icon-unchecked")),c.push("\n          "),c.push(this.Icon("checkbox-checked","icon-checked")),c.push('\n        </span>\n        <span class="label-text">'),c.push(t),c.push("</span>\n      </label>\n    ");for(c.push("\n</thead>\n<tbody>\n  "),l=e=0,s=this.maxTimeframes-1;0<=s?e<=s:s<=e;l=0<=s?++e:--e){for(n in c.push("\n  <tr>\n    "),r=this.days)t=r[n],c.push("\n      "),this.hours[n].timeframes[l]?(c.push('\n      <td data-day="'),c.push(n),c.push('" data-slot="'),c.push(l),c.push('" class="form-group day-time'),this.hours[n].active&&c.push(" is-active"),c.push('">\n        <label for="'),c.push(n),c.push('_start_time">from</label>\n        <input type="text" id="'),c.push(n),c.push('_start_time" name="'),c.push(p(this.attribute.name)),c.push("::"),c.push(n),c.push('::start" value="'),c.push(this.hours[n].timeframes[l][0]),c.push('" data-day="'),c.push(n),c.push('" data-slot="'),c.push(l),c.push('" data-i="0" class="form-control form-control--small time js-time">\n        <label for="monday_end_time">till</label>\n        <input type="text" id="monday_end_time" name="'),c.push(p(this.attribute.name)),c.push("::"),c.push(n),c.push('::end" value="'),c.push(this.hours[n].timeframes[l][1]),c.push('" data-day="'),c.push(n),c.push('" data-slot="'),c.push(l),c.push('" data-i="1" class="form-control form-control--small time js-time">\n      ')):c.push('\n      <td class="empty-cell">\n      '),c.push("\n    ");c.push("\n  ")}if(c.push("\n\n  "),1<this.maxTimeframes){for(n in c.push("\n  <tr>\n    "),o=this.days)t=o[n],c.push("\n      "),1<this.hours[n].timeframes.length?(c.push('\n      <td data-day="'),c.push(n),c.push('" class="settings-list-action-cell js-remove-time'),this.hours[n].active&&c.push(" is-active"),c.push('">\n        '),c.push(this.Icon("minus-small")),c.push("\n      ")):c.push('\n      <td class="empty-cell">\n      '),c.push("\n    ");c.push("\n  ")}for(n in c.push("\n\n  <tr>\n    "),a=this.days)t=a[n],c.push('\n    <td data-day="'),c.push(n),c.push('" class="settings-list-action-cell js-add-time'),this.hours[n].active&&c.push(" is-active"),c.push('">\n      '),c.push(this.Icon("plus-small")),c.push("\n    ");c.push("\n</tbody>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,c.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/checkbox"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="'),s.push(r(this.attribute["class"])),s.push(' checkbox checkbox--list">\n'),t=0,e=(n=this.attribute.options).length;t<e;t++)i=n[t],s.push('\n  <label class="checkbox-replacement'),i.disabled&&s.push(r(" is-disabled")),s.push('">\n    <input type="checkbox" value="'),s.push(r(i.value)),s.push('" name="'),s.push(r(this.attribute.name)),s.push('" '),s.push(r(i.checked)),s.push(" "),s.push(r(i.disabled)),s.push(">\n    "),s.push(this.Icon("checkbox","icon-unchecked")),s.push("\n    "),s.push(this.Icon("checkbox-checked","icon-checked")),s.push('\n    <span class="label-text">'),s.push(r(i.name)),s.push("</span>\n    "),i.note&&(s.push('<span class="help-text">'),s.push(this.T(i.note)),s.push("</span>")),s.push("\n  </label>\n");s.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/color"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="color controls controls--button dropdown-toggle" data-toggle="dropdown">\n  <input id="'),e.push(n(this.attribute.id)),e.push('" name="'),e.push(n(this.attribute.name)),e.push('" type="text" value="'),e.push(n(this.attribute.value)),e.push('" class="'),e.push(n(this.attribute["class"])),e.push(' js-input" '),this.attribute.placeholder&&(e.push('placeholder="'),e.push(this.Ti(this.attribute.placeholder)),e.push('"')),e.push(" "),e.push(n(this.attribute.required)),e.push(" "),e.push(n(this.attribute.autofocus)),e.push(" "),e.push(this.attribute.autocapitalize),e.push(" "),e.push(this.attribute.autocomplete),e.push(" "),void 0!==this.attribute.min&&(e.push(' min="'),e.push(n(this.attribute.min)),e.push('"')),void 0!==this.attribute.max&&(e.push(' max="'),e.push(n(this.attribute.max)),e.push('"')),this.attribute.step&&(e.push(' step="'),e.push(n(this.attribute.step)),e.push('"')),this.attribute.disabled&&e.push(" disabled"),e.push('>\n  <div class="controls-button">\n   <div class="controls-button-inner">\n     <div class="color-field js-swatch" style="background-color: '),e.push(n(this.attribute.value)),e.push('"></div>\n   </div>\n  </div>\n</div>\n<div class="dropdown-menu dropdown-menu-left js-dropdown colorpicker">\n  <div class="colorpicker-hue-saturation js-colorpicker-hue-saturation">\n    <div class="colorpicker-saturation-gradient js-colorpicker-saturation-gradient" style="background-image: linear-gradient(transparent, hsl(0,0%,'),e.push(n(100*this.hsl[2])),e.push('%)"></div>\n    <div class="colorpicker-lightness-plane js-colorpicker-lightness-plane" style="background-color: hsla(0,0%,'),e.push(n(.5<this.hsl[2]?100:0)),e.push("%,"),e.push(n(2*Math.abs(this.hsl[2]-.5))),e.push(')"></div>\n    <div class="colorpicker-circle js-colorpicker-circle" style="left: '),e.push(n(100*this.hsl[0])),e.push("%; top: "),e.push(n(100-100*this.hsl[1])),e.push("%; border-color: "),e.push(n(.5<this.hsl[2]?"black":"white")),e.push('"></div>\n  </div>\n  <div class="colorpicker-lightness js-colorpicker-lightness">\n    <div class="colorpicker-hue-plane js-colorpicker-hue-plane" style="background-color: hsl('),e.push(n(360*this.hsl[0])),e.push(',100%,50%)">\n     <div class="colorpicker-hue-gradient"></div>\n    </div>\n    <div class="colorpicker-slider js-colorpicker-slider" style="top: '),e.push(n(100-100*this.hsl[2])),e.push('%">\n     <div class="colorpicker-slider-arrow colorpicker-slider-arrow--left"></div>\n     <div class="colorpicker-slider-arrow colorpicker-slider-arrow--right"></div>\n    </div>\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/column_select"]=function(t){t||(t={});var f=[],m=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d;if(this.attribute.seperator)f.push('\n<input class="js-shadow hide" id="'),f.push(m(this.attribute.id)),f.push('" name="'),f.push(m(this.attribute.name)),f.push('" value="'),f.push(m(this.attribute.value)),f.push('">\n');else{for(f.push('\n<select\n  class="columnSelect-shadow js-shadow"\n  id="'),f.push(m(this.attribute.id)),f.push('"\n  name="'),f.push(m(this.attribute.name)),f.push('"\n  '),f.push(m(this.attribute.required)),f.push("\n  "),f.push(m(this.attribute.autofocus)),f.push('\n  value="'),f.push(m(this.attribute.value)),f.push('"\n  multiple\n>\n  '),t=0,s=(p=this.allOptions).length;t<s;t++)c=p[t],f.push('\n  <option value="'),f.push(m(c.value)),f.push('" '),c.selected&&f.push(m(" selected")),f.push(">"),f.push(m(c.name)),f.push("</option>\n  ");f.push("\n</select>\n")}for(f.push('\n<div class="columnSelect-column columnSelect-column--selected js-selected" data-name="'),f.push(m(this.attribute.name)),f.push('">\n  <div class="u-placeholder u-unselectable js-placeholder'),this.values.length&&f.push(m(" is-hidden")),f.push('">'),f.push(this.T("Nothing selected")),f.push("</div>\n  "),e=0,r=(u=this.allOptions).length;e<r;e++)c=u[e],f.push('\n  <div class="columnSelect-option js-remove js-option'),c.selected||f.push(m(" is-hidden")),f.push('" data-value="'),f.push(m(c.value)),f.push('">'),f.push(m(c.name)),f.push("</div>\n  ");for(f.push('\n</div>\n<div class="columnSelect-column columnSelect-column--sidebar" data-name="'),f.push(m(this.attribute.name)),f.push('">\n  '),10<this.allOptions.length&&(f.push('\n  <div class="columnSelect-search">\n    '),f.push(this.Icon("magnifier")),f.push('\n    <input class="js-search" autocomplete="off">\n    <div class="columnSelect-search-clear js-clear is-hidden">\n      '),f.push(this.Icon("diagonal-cross")),f.push("\n    </div>\n  </div>\n  ")),f.push('\n  <div class="columnSelect-pool js-pool">\n    '),n=0,o=(h=this.attribute.options).length;n<o;n++){if(c=h[n],f.push("\n      "),void 0!==c.group){for(f.push('\n        <div class="columnSelect-group-label" title="'),f.push(m(this.T(c.label))),f.push('">'),f.push(m(this.T(c.label))),f.push("</div>\n        "),i=0,a=(d=c.group).length;i<a;i++)l=d[i],f.push('\n        <div class="columnSelect-option js-select js-option'),l.selected&&f.push(m(" is-hidden")),f.push('" data-value="'),f.push(m(l.value)),f.push('" title="'),f.push(m(l.title)),f.push('">'),f.push(m(l.name)),f.push("</div>\n        ");f.push("\n      ")}else f.push('\n        <div class="columnSelect-option js-select js-option'),c.selected&&f.push(m(" is-hidden")),f.push('" data-value="'),f.push(m(c.value)),f.push('" title="'),f.push(m(c.title)),f.push('">'),f.push(m(c.name)),f.push("</div>\n      ");f.push("\n    ")}f.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,f.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/content_one"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex"></div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/content_two"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="sidebar"></div>\n<div class="main flex"></div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/content_two_title"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="sidebar">\n</div>\n<div class="main flex">\n  <div class="page-header">\n    <div class="page-header-title">\n      <h1>'),e.push(this.T(this.head)),e.push(" <small>"),e.push(this.T(this.sub_head)),e.push('</small></h1>\n    </div>\n  </div>\n  <div class="page-content"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/date"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="control controls--date" data-name="'),e.push(n(this.attribute.nameRaw)),e.push('">\n  <input type="hidden" value="'),e.push(n(this.attribute.value)),e.push('" name="'),e.push(n(this.attribute.name)),e.push('">\n  <input type="text" value="" class="form-control js-datepicker '),e.push(n(this.attribute["class"])),e.push('" data-item="date">\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/datepicker"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="datepicker">\n    <div class="datepicker-days">\n        <table class=" table-condensed">\n            <thead>\n                <tr>\n                    <th colspan="7" class="datepicker-title"></th>\n                </tr>\n                <tr>\n                    <th class="prev">'),e.push(this.Icon("arrow-{start}")),e.push('</th>\n                    <th colspan="5" class="datepicker-switch"></th>\n                    <th class="next">'),e.push(this.Icon("arrow-{end}")),e.push('</th>\n                </tr>\n            </thead>\n        <tbody></tbody>\n        <tfoot>\n        <tr>\n            <th colspan="7" class="today"></th>\n        </tr>\n        <tr>\n            <th colspan="7" class="clear"></th>\n        </tr>\n        </tfoot>\n    </table>\n  </div>\n  <div class="datepicker-months">\n      <table class="table-condensed">\n          <thead>\n              <tr>\n                  <th colspan="7" class="datepicker-title"></th>\n              </tr>\n              <tr>\n                  <th class="prev">'),e.push(this.Icon("arrow-{start}")),e.push('</th>\n                  <th colspan="5" class="datepicker-switch"></th>\n                  <th class="next">'),e.push(this.Icon("arrow-{end}")),e.push('</th>\n              </tr>\n          </thead>\n          <tbody><tr><td colspan="7"></td></tr></tbody>\n          <tfoot>\n          <tr>\n              <th colspan="7" class="today"></th>\n          </tr>\n          <tr>\n              <th colspan="7" class="clear"></th>\n          </tr>\n          </tfoot>\n      </table>\n  </div>\n  <div class="datepicker-years">\n      <table class="table-condensed">\n          <thead>\n              <tr>\n                  <th colspan="7" class="datepicker-title"></th>\n              </tr>\n              <tr>\n                  <th class="prev">'),e.push(this.Icon("arrow-{start}")),e.push('</th>\n                  <th colspan="5" class="datepicker-switch"></th>\n                  <th class="next">'),e.push(this.Icon("arrow-{end}")),e.push('</th>\n              </tr>\n          </thead>\n          <tbody><tr><td colspan="7"></td></tr></tbody>\n          <tfoot>\n          <tr>\n              <th colspan="7" class="today"></th>\n          </tr>\n          <tr>\n              <th colspan="7" class="clear"></th>\n          </tr>\n          </tfoot>\n      </table>\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/datetime"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="controls controls--datetime" data-name="'),e.push(n(this.attribute.nameRaw)),e.push('">\n  <input type="hidden" value="'),e.push(n(this.attribute.value)),e.push('" name="'),e.push(n(this.attribute.name)),e.push('">\n  <input type="text" value="" class="form-control flex-shrink-horizontal js-datepicker '),e.push(n(this.attribute["class"])),e.push('" data-item="date">\n  <div class="controls-label">'),e.push(this.T("at")),e.push('</div>\n  <input type="text" value="" class="form-control time js-timepicker '),e.push(n(this.attribute["class"])),e.push('" data-item="time">\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/drox"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="drox">\n  <div class="drox-header">\n    <h2>\n      '),e.push(this.T(this.header)),e.push("\n      "),this.edit&&(e.push('\n      <a href="" data-type="edit" class="pull-right glyphicon glyphicon-edit" title="'),e.push(this.Ti("edit")),e.push('"></a>\n      ')),e.push('\n    </h2>\n  </div>\n  <div class="drox-body">\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/error/generic"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="fullscreenMessage">\n  '),e.push(this.Icon("diagonal-cross","icon-error")),e.push("\n  <h2>"),void 0!==this.status&&(e.push(this.T("Status Code")),e.push(": "),e.push(n(this.status)),e.push(". ")),e.push(this.T(this.detail)),e.push("</h2>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/error/not_found"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="flex fullscreenMessage">\n  '),e.push(this.Icon("diagonal-cross","icon-error")),e.push("\n  <h2>"),e.push(this.T("Opps.. I'm sorry, but I can't find this %s.",this.objectName)),e.push("</h2>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/error/placeholder"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="fullscreenMessage fullscreenMessage--placeholder">\n  '),e.push(this.icon),e.push("\n  <h2>"),void 0!==this.status&&(e.push(this.T("Status Code")),e.push(": "),e.push(n(this.status)),e.push(". ")),e.push(this.T(this.detail)),e.push("</h2>\n  "),this.action&&(e.push('\n  <div class="btn btn--action js-action">'),e.push(this.T(this.action)),e.push("</div>\n  ")),e.push("\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/error/success"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="fullscreenMessage">\n  '),e.push(this.Icon("checkmark")),e.push("\n  <h2>"),e.push(this.T(this.detail)),e.push("</h2>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/error/unauthorized"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="flex fullscreenMessage">\n  '),e.push(this.Icon("diagonal-cross","icon-error")),e.push("\n  <h2>"),e.push(this.T("Opps.. I'm sorry, but you have insufficient rights to open this %s.",this.objectName)),e.push("</h2>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/history"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(l.push('<div>\n<a href="#" data-type="sortorder">'),l.push(this.T("Change order")),l.push("</a>\n\n<hr>\n\n"),e=0,s=(o=this.items).length;e<s;e++){for(n=o[e],l.push('\n  <span class="user-popover" data-id="'),l.push(c(n.created_by.id)),l.push('">'),l.push(c(n.created_by.displayName())),l.push("</span> -\n  "),l.push(this.humanTime(n.created_at)),l.push("\n  <ul>\n    "),i=0,r=(a=n.records).length;i<r;i++)t=a[i],l.push("\n    <li>"),l.push(t),l.push("</li>\n    ");l.push("\n  </ul>\n  <hr>\n")}l.push("\n\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/ical_feed"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(n in i.push('<div class="settings-row">\n  <label class="inline-label">\n    <span class="radio-replacement radio-replacement--inline">\n      <input type="radio" name="holiday-radio" value="list" class="js-check js-checkList">\n      '),i.push(this.Icon("radio","icon-unchecked")),i.push("\n      "),i.push(this.Icon("radio-checked","icon-checked")),i.push("\n    </span>\n    "),i.push(this.T("Subscribe to public holidays in")),i.push('\n  </label>\n  <div class="u-inlineBlock u-positionOrigin">\n    <select class="form-control form-control--small js-list">\n      <option value="">-</option>\n      '),e=this.icalFeeds)t=e[n],i.push('\n        <option value="'),i.push(s(n)),i.push('" '),this.attribute.value===n&&i.push("selected"),i.push(">"),i.push(this.T(t)),i.push("</option>\n      ");i.push("\n    </select>\n    "),i.push(this.Icon("arrow-down")),i.push('\n  </div>\n  <span class="text-small text-muted">('),i.push(this.T("iCalendar links from Google will get fetched once a day")),i.push(')</span>\n</div>\n\n<div class="settings-row">\n  <label class="inline-label">\n    <span class="radio-replacement radio-replacement--inline">\n      <input type="radio" name="holiday-radio" value="manual" class="js-check js-checkManual">\n      '),i.push(this.Icon("radio","icon-unchecked")),i.push("\n      "),i.push(this.Icon("radio-checked","icon-checked")),i.push("\n    </span>\n    "),i.push(this.T("Subscribe to iCalendar feed")),i.push('\n  </label>\n  <input class="form-control form-control--small form-control--inline js-manual" type="url" placeholder="'),i.push(s(this.attribute.placeholder)),i.push('">\n  <input type="hidden" class="js-shadow" name="'),i.push(s(this.attribute.name)),i.push('" value="'),i.push(s(this.attribute.value)),i.push('">\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/icon_picker"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="dropdown-toggle" data-toggle="dropdown">\n  <input id="'),e.push(n(this.attribute.id)),e.push('" class="form-control icon_picker-shadow js-shadow" name="'),e.push(n(this.attribute.name)),e.push('" value="'),e.push(n(this.value)),e.push('" '),e.push(n(this.attribute.required)),e.push('>\n  <div class="form-control icon js-input" data-font="'),e.push(n(this.attribute.iconset)),e.push('" tabindex="0">\n    '),e.push(n(this.value?String.fromCharCode("0x"+this.value):"")),e.push("\n  </div>\n  "),e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n</div>\n<div class="dropdown-menu dropdown-menu-left js-dropdown">\n  <input type="search" class="dropdown-filter js-filter-icons" placeholder="'),e.push(this.T("Search...")),e.push('">\n  <ul class="js-iconGrid dropdown-grid" role="menu"></ul>\n  <div class="dropdown-filter-placeholder">\n    <span class="js-noMatch">\xaf\\_(\u30c4)_/\xaf</span>\n    <span class="js-noMatch">(\u256f\xb0\u25a1\xb0\uff09\u256f \ufe35 \u253b\u2501\u253b</span>\n    <span class="js-noMatch">(\\/) (;,,;) (\\/)</span>\n    <span class="js-noMatch">(\u0ca0_\u0ca0)</span>\n    <span class="js-noMatch">\u03b5(\xb4\ufb41\ufe35\ufb41`)\u0437</span>\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/iconset_picker"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(t in i.push('<input type="text" name="'),i.push(s(this.attribute.name)),i.push('" value="'),i.push(s(this.attribute.value)),i.push('">\n<div class="icon-sets">\n\t'),e=this.sets)n=e[t],i.push('\n\t<div class="icon-set js-set'),i.push(s(this.attribute.value===t?" is-active":void 0)),i.push('" data-family="'),i.push(s(t)),i.push('">\n\t\t<div class="icon-set-preview js-preview">\n\t\t\t<div class="loading icon small"></div>\n\t\t</div>\n\t\t<div class="icon-set-meta">\n\t\t\t<span class="icon-set-name">'),i.push(s(n.name)),i.push('</span>\n\t\t\t<span class="icon-set-version">'),i.push(s(n.version)),i.push('</span>\n\t\t\t<a href="'),i.push(s(n.website)),i.push('" target="_blank" class="icon-set-website">'),i.push(this.T("Website")),i.push("</a>\n\t\t</div>\n\t</div>\n\t");i.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/input"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<input id="'),e.push(n(this.attribute.id)),e.push('" type="'),e.push(n(this.attribute.type)),e.push('" name="'),e.push(n(this.attribute.name)),e.push('" value="'),e.push(n(this.attribute.value)),e.push('" class="form-control '),e.push(n(this.attribute["class"])),e.push('" '),this.attribute.placeholder&&(e.push('placeholder="'),e.push(this.Ti(this.attribute.placeholder)),e.push('"')),e.push(" "),e.push(n(this.attribute.required)),e.push(" "),e.push(n(this.attribute.autofocus)),e.push(" "),e.push(this.attribute.autocapitalize),e.push(" "),e.push(this.attribute.autocomplete),e.push(" "),void 0!==this.attribute.min&&(e.push(' min="'),e.push(n(this.attribute.min)),e.push('"')),void 0!==this.attribute.max&&(e.push(' max="'),e.push(n(this.attribute.max)),e.push('"')),this.attribute.step&&(e.push(' step="'),e.push(n(this.attribute.step)),e.push('"')),this.attribute.disabled&&e.push(" disabled"),e.push("/>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/login_preview"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="login branding centered darkBackground vertical">\n  '),this.maintananceChange&&(e.push("\n    "),this.C("maintenance_mode")&&(e.push('\n      <div class="hero-unit alert alert--danger">'),e.push(this.T("Zammad is currently in maintenance mode. Only administrators can login. Please wait until the maintenance window is over.")),e.push("</div>\n    ")),e.push("\n\n    "),this.logoChange&&!this.C("maintenance_login")||(e.push('\n    <form>\n      <div contenteditable id="maintenance-message" data-name="message" class="hero-unit alert alert--success js-textarea js-Login" '),this.C("maintenance_login")||e.push('style="opacity: 0.5;"'),e.push(">"),e.push(this.C("maintenance_login_message")),e.push("</div>\n    </form>\n    ")),e.push("\n  ")),e.push('\n\n  <div class="hero-unit">\n\n    '),this.logoChange?(e.push('\n      <img class="logo-preview" src="'),e.push(n(this.logoUrl)),e.push('">\n      <div class="logo-preview-placeholder">'),e.push(this.T("Your Logo")),e.push('</div>\n      <div class="centered">\n        <div class="btn btn--success fileUpload">'),e.push(this.T("Change")),e.push('<input type="file" class="js-upload" name="logo" accept="image/*"></div>\n      </div>\n    ')):(e.push('\n      <img class="company-logo" src="'),e.push(n(this.logoUrl)),e.push('">\n    ')),e.push('\n\n    <div class="form-group">\n      <label for="username">'),e.push(this.Ti("Username / email")),e.push('</label>\n      <input id="username" name="username" type="text" class="form-control" value="'),e.push(n(this.S("login"))),e.push('" autocapitalize="off" disabled="disabled"/>\n    </div>\n\n    <div class="form-group">\n      <label for="password">'),e.push(this.Ti("Password")),e.push('</label>\n      <input id="password" name="password" type="password" class="form-control" value="some_pass" disabled="disabled"/>\n    </div>\n\n    <div class="form-group">\n      <label><input name="remember_me" value="1" type="checkbox" disabled="disabled"/> '),e.push(this.T("Remember me")),e.push(
'</label>\n    </div>\n\n    <div class="form-controls">\n      <button class="btn btn--primary" type="submit" disabled="disabled">'),e.push(this.T("Sign in")),e.push("</button>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/modal_loader"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="modal-dialog wizard">\n\n  <form class="modal-content setup wizard">\n    <div class="modal-header">\n      <h1 class="modal-title">'),e.push(this.T(this.head)),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon js-loadingIcon"></span> <span class="js-loading">'),e.push(this.message),e.push(' </span>\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/multi_locales"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<table class="settings-list js-localeTable">\n  <thead>\n    <tr>\n      <th width="85%">'),e.push(this.T("Language")),e.push('\n      <th width="5%">'),e.push(this.T("Default")),e.push('\n      <th width="10%">'),e.push(this.T("Delete")),e.push("\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/multi_locales_row"]=function(t){t||(t={});var n=[],i=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},e=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e;n.push('<td class="settings-list-control-cell">\n  <div class="js-selectorContainer"></div>\n<td class="u-positionOrigin">\n  <span class="js-primary radio-replacement radio-replacement--fullscreen">\n    <input type="radio" value="'),n.push(i(null!=(t=this.kb_locale)&&null!=(e=t.systemLocale())?e.id:void 0)),n.push('" name="'),n.push(i(this.attribute.name)),n.push('_primary_locale_id">\n    '),n.push(this.Icon("radio","icon-unchecked")),n.push("\n    "),n.push(this.Icon("radio-checked","icon-checked")),n.push('\n  </span>\n<td class="u-positionOrigin">\n  <span class="checkbox-replacement checkbox-replacement--fullscreen js-remove">\n    <input type="checkbox" name="showTitle" value="true">\n    '),n.push(this.Icon("checkbox","icon-unchecked")),n.push("\n    "),n.push(this.Icon("checkbox-checked","icon-checked")),n.push("\n  </span>\n")}).call(this)}.call(t),t.safe=e,t.escape=s,n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/navbar_level2/index"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="sidebar '),e.push(n(this.className)),e.push('"></div>\n<div class="main flex"></div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/navbar_level2/navbar"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;if(this.groups){for(l.push("\n  "),e=0,s=(o=this.groups).length;e<s;e++){if(t=o[e],l.push("\n    "),!_.isEmpty(t.items)){if(l.push("\n      <h2>"),l.push(this.T(t.name)),l.push('</h2>\n      <ul class="nav nav-pills nav-stacked">\n      '),t.items){for(l.push("\n        "),i=0,r=(a=t.items).length;i<r;i++)n=a[i],l.push("\n          <li "),n.active&&l.push('class="active js-item"'),l.push('><a href="'),l.push(c(n.target)),l.push('">'),l.push(this.T(n.name)),l.push("</a></li>\n        ");l.push("\n      ")}l.push("\n      </ul>\n    ")}l.push("\n  ")}l.push("\n")}l.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/object_import/import_try"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\n<p class="alert alert--danger js-error hide"></p>\n\n<p>\n'),this.result.stats&&(e.push("\n  "),e.push(this.T("The test run was successful.")),e.push("\n  "),e.push(this.T("The following changes are made:")),e.push("\n  <ul>\n  "),void 0!==this.result.stats.deleted&&(e.push("\n    <li>"),e.push(this.T("%s Object(s) are deleted.",this.result.stats.deleted)),e.push("</li>\n  ")),e.push("\n  "),void 0!==this.result.stats.created&&(e.push("\n    <li>"),e.push(this.T("%s Object(s) are created.",this.result.stats.created)),e.push("</li>\n  ")),e.push("\n  "),void 0!==this.result.stats.updated&&(e.push("\n    <li>"),e.push(this.T("%s Object(s) are updated.",this.result.stats.updated)),e.push("</li>\n  ")),e.push("\n")),e.push("\n</p>\n\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/object_import/imported"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push("<div>\n"),this.errors){for(s.push("\n  <ul>\n  "),e=0,n=(i=this.errors).length;e<n;e++)t=i[e],s.push("\n    <li>"),s.push(r(t)),s.push("\n  ");s.push("\n")}s.push('\n</div>\n\n<div>\n<p class="alert alert--danger js-error hide"></p>\n<p>\n'),this.result.stats&&(s.push("\n  "),s.push(this.T("The import was successful.")),s.push("\n  "),s.push(this.T("The following changes have been made:")),s.push("\n  <ul>\n  "),void 0!==this.result.stats.deleted&&(s.push("\n    <li>"),s.push(this.T("%s Object(s) were deleted.",this.result.stats.deleted)),s.push("</li>\n  ")),s.push("\n  "),void 0!==this.result.stats.created&&(s.push("\n    <li>"),s.push(this.T("%s Object(s) have been created.",this.result.stats.created)),s.push("</li>\n  ")),s.push("\n  "),void 0!==this.result.stats.updated&&(s.push("\n    <li>"),s.push(this.T("%s Object(s) have been updated.",this.result.stats.updated)),s.push("</li>\n  ")),s.push("\n")),s.push("\n</p>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/object_import/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\n<p class="alert alert--danger js-error hide"></p>\n\n<p>\n  '),e.push(this.T("Bulk import allows you to create and update many records at once.")),e.push("\n  "),e.push(this.T("The data must be in the comma separated values (CSV) format and saved as UTF-8. You can import a CSV file or paste the data directly into the text area.")),e.push("\n</p>\n\n<p>"),e.push(this.T("Alternatively, you can use the Zammad API to import data.")),e.push('</p>\n\n<h2><input checked="checked" disabled="disabled" type="checkbox" name="create" value="true"> '),e.push(this.T("Create new records")),e.push("</h2>\n"),e.push(this.T("Records that exist in the import data (but not in Zammad) will always be created.")),e.push('\n\n<h2><input checked="checked" disabled="disabled" type="checkbox" name="update" value="true"> '),e.push(this.T("Update existing records")),e.push("</h2>\n"),e.push(this.T("Update existing records with the attributes specified in the import data.")),e.push("\n\n"),!0===this.deleteOption&&(e.push('\n<h2><input type="checkbox" name="delete" value="true"> '),e.push(this.T("Delete records")),e.push("</h2>\n"),e.push(this.T("Delete all existing records first.")),e.push("\n")),e.push("\n\n<h2>"),e.push(this.T("Select CSV file")),e.push('</h2>\n<input name="file" type="file">\n\n<h2>'),e.push(this.T("Paste in CSV data")),e.push('</h2>\n<textarea cols="25" rows="6" name="data"></textarea>\n\n<p>'),e.push(this.T("Note")),e.push(': <a href="'),e.push(this.import_example_url),e.push('" target="_blank">'),e.push(this.T("Example CSV file for download.")),e.push("</a></p>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/object_import/result"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push("<div>\n"),s.push(this.T("Result")),s.push(": "),s.push(r(this.result)),s.push("\n"),this.errors){for(s.push("\n  <ul>\n  "),e=0,n=(i=this.errors).length;e<n;e++)t=i[e],s.push("\n    <li>"),s.push(r(t)),s.push("\n  ");s.push("\n")}s.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/object_search/input"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="tokenfield form-control u-positionOrigin">\n  <input class="js-objectId" type="hidden" value="'),e.push(n(this.value)),e.push('" name="'),e.push(this.attribute.name),e.push('" tabindex="-1">\n  '),this.attribute.multiple&&(e.push("\n    "),e.push(this.tokens),e.push("\n  ")),e.push('\n  <input name="'),e.push(this.attribute.name),e.push('_completion" class="user-select token-input js-objectSelect" autocapitalize="off" placeholder="'),e.push(this.Ti(this.attribute.placeholder)),e.push('" autocomplete="off" '),e.push(n(this.attribute.autofocus)),e.push(' role="textbox" aria-autocomplete="list" value="'),e.push(n(this.name)),e.push('" aria-haspopup="true">\n  '),!0!==this.attribute.disableCreateObject&&e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n</div>\n\n<div class="dropdown-menu" aria-labelledby="customer_id">\n  <ul class="recipientList" role="menu"></ul>\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/object_search/item_object"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<li class="recipientList-entry js-object" data-object-id="'),e.push(n(this.object.id)),e.push('">\n  <div class="recipientList-iconSpacer">\n    '),e.push(this.Icon(this.icon,"recipientList-icon")),e.push('\n  </div>\n  <div class="recipientList-name">\n    '),this.realname?(e.push("\n      "),e.push(n(this.realname))):(e.push("\n      "),e.push(n(this.object.displayName()))),e.push("\n    "),e.push("\n    "),this.object.organization&&(e.push('\n      <span class="recipientList-detail">- '),e.push(n(this.object.organization.displayName())),e.push("</span>\n    ")),e.push("\n  </div>\n  "),!1===this.object.active&&(e.push('\n    <div class="recipientList-status">'),e.push(this.Ti("inactive")),e.push("</div>\n  ")),e.push("\n</li>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/object_search/item_organization"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<li class="recipientList-entry js-organization" data-organization-id="'),e.push(this.organization.id),e.push('">\n  <div class="recipientList-iconSpacer">\n    '),!1===this.organization.active?(e.push("\n    "),e.push(this.Icon("inactive-organization","recipientList-icon"))):(e.push("\n    "),e.push(this.Icon("organization","recipientList-icon"))),e.push("\n    "),e.push('\n  </div>\n  <div class="recipientList-name">\n    '),e.push(n(this.organization.displayName())),e.push('\n    <span class="recipientList-detail">- '),e.push(n(this.objectCount)),e.push(" "),e.push(this.T(this.objectSingels)),e.push("</span>\n  </div>\n  "),!1===this.organization.active&&(e.push('\n    <div class="recipientList-status">'),e.push(this.Ti("inactive")),e.push("</div>\n  ")),e.push("\n  "),e.push(this.Icon("arrow-right","recipientList-arrow")),e.push("\n</li>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/object_search/item_organization_members"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<ul class="recipientList-organizationMembers hide" organization-id="'),e.push(this.organization.id),e.push('">\n  <li class="recipientList-controls js-back">\n    <div class="btn btn--action btn--onDark">\n      '),e.push(this.Icon("arrow-left")),e.push('\n      <span class="btn-label">'),e.push(this.T("Back")),e.push("</span>\n    </div>\n</ul>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/object_search/new_object"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<li class="recipientList-entry recipientList--new js-objectNew" data-object-id="new">\n  <div class="recipientList-iconSpacer">\n    '),e.push(this.Icon("plus","recipientList-icon")),e.push('\n  </div>\n  <div class="recipientList-name">\n    '),e.push(this.T(this.objectCreate)),e.push("\n  </div>\n</li>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/page_loading"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-loading">\n  <div class="small loading icon"></div>\n  <div class="page-loading-label">'),e.push(this.T("Loading...")),e.push("</div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/permission"]=function(t){t||(t={});var d=[],f=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u,h;for(d.push('<div class="checkbox '),d.push(f(this.attribute["class"])),d.push('">\n'),n=0,r=(l=this.permissions).length;n<r;n++){if(a=l[n],d.push("\n  "),a.name.match(/\./)){if(d.push('\n    <div class="checkbox-child js-subPermissionList">\n      <label class="inline-label checkbox-replacement">\n        <input type="checkbox" value="'),d.push(f(a.id)),d.push('" name="permission_ids" '),_.contains(this.params.permission_ids,a.id)&&d.push("checked"),d.push(" "),a.preferences.disabled&&d.push("disabled"),d.push(' data-permission-name="'),d.push(f(a.name)),d.push('"/>\n        '),d.push(this.Icon("checkbox","icon-unchecked")),d.push("\n        "),d.push(this.Icon("checkbox-checked","icon-checked")),d.push('\n        <span class="label-text">'),d.push(f(a.displayName().replace(/^.+?\./,""))),d.push('</span>\n        <span class="help-text">'),d.push(this.T.apply(this,[a.note].concat(a.preferences.translations))),d.push("</span>\n      </label>\n  "),_.contains(a.preferences.plugin,"groups")){for(s in d.push('\n    <div style="padding-left: 18px; padding-top: 10px;" class="js-groupList '),this.hideGroups&&d.push("js-groupListHide hidden"),d.push('">\n      <table class="settings-list">\n        <thead>\n          <th>'),d.push(this.T("Group")),d.push("\n          "),c=this.groupAccesses)h=c[s],d.push("\n            <th>"),d.push(this.T(h)),d.push("\n          ");for(d.push("\n        <tbody>\n      "),i=0,o=(p=this.groups).length;i<o;i++){for(s in e=p[i],d.push("\n      "),t=[],d.push("\n      "),this.params.group_ids&&this.params.group_ids[e.id]&&(d.push("\n      "),t=this.params.group_ids[e.id],d.push("\n      ")),d.push("\n        <tr>\n          <td>\n            "),d.push(f(e.displayName())),d.push("\n          "),u=this.groupAccesses)h=u[s],d.push('\n            <td>\n            <label class="inline-label checkbox-replacement">\n              <input type="checkbox" value="'),d.push(f(s)),d.push('" name="group_ids::'),d.push(f(e.id)),d.push('" '),_.contains(t,s)&&d.push("checked"),d.push("/>\n              "),d.push(this.Icon("checkbox","icon-unchecked")),d.push("\n              "),d.push(this.Icon("checkbox-checked","icon-checked")),d.push("\n            </label>\n          ");d.push("\n        </tr>\n      ")}d.push("\n      </table>\n    </div>\n  ")}d.push("\n    </div>\n  ")}else d.push('\n  <label class="inline-label checkbox-replacement">\n    <input type="checkbox" value="'),d.push(f(a.id)),d.push('" name="permission_ids" '),_.contains(this.params.permission_ids,a.id)&&d.push("checked"),d.push(" "),a.preferences.disabled&&d.push("disabled"),d.push(' data-permission-name="'),d.push(f(a.name)),d.push('"/>\n    '),d.push(this.Icon("checkbox","icon-unchecked")),d.push("\n    "),d.push(this.Icon("checkbox-checked","icon-checked")),d.push('\n    <span class="label-text">'),d.push(f(a.displayName())),d.push('</span>\n    <span class="help-text">'),d.push(this.T.apply(this,[a.note].concat(a.preferences.translations))),d.push("</span>\n  </label>\n  ");d.push("\n")}d.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,d.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/postmaster_match"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="horizontal-filters">\n  <div class="horizontal-filter js-filterElement">\n    <div class="horizontal-filter-body">\n      <div class="controls">\n        <div class="u-positionOrigin js-attributeSelector">\n          '),e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n        </div>\n      </div>\n      <div class="controls">\n        <div class="u-positionOrigin js-operator">\n          <select></select>\n          '),e.push(this.Icon("arrow-down")),e.push('\n        </div>\n      </div>\n      <div class="controls js-value"></div>\n    </div>\n    <div class="filter-controls">\n      <div class="filter-control filter-control-remove js-remove" title="'),e.push(this.T("Remote")),e.push('">\n        '),e.push(this.Icon("minus-small")),e.push('\n      </div>\n      <div class="filter-control filter-control-add js-add" title="'),e.push(this.T("Add")),e.push('">\n        '),e.push(this.Icon("plus-small")),e.push("\n      </div>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/postmaster_set"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="horizontal-filters"></div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/postmaster_set_row"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="horizontal-filter js-filterElement">\n  <div class="horizontal-filter-body">\n    <div class="controls">\n      <div class="u-positionOrigin js-attributeSelector">\n        '),e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n      </div>\n    </div>\n    <div class="controls">\n      <div class="u-positionOrigin js-operator">\n        <select></select>\n        '),e.push(this.Icon("arrow-down")),e.push('\n      </div>\n    </div>\n    <div class="controls js-value"></div>\n  </div>\n  <div class="filter-controls">\n    <div class="filter-control filter-control-remove js-remove" title="'),e.push(this.T("Remote")),e.push('">\n      '),e.push(this.Icon("minus-small")),e.push('\n    </div>\n    <div class="filter-control filter-control-add js-add" title="'),e.push(this.T("Add")),e.push('">\n      '),e.push(this.Icon("plus-small")),e.push("\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/radio"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="'),s.push(r(this.attribute["class"])),s.push(' radio radio--list">\n'),t=0,e=(n=this.attribute.options).length;t<e;t++)i=n[t],s.push('\n  <label class="inline-label radio-replacement'),i.disabled&&s.push(r(" is-disabled")),s.push('">\n    <input type="radio" value="'),s.push(r(i.value)),s.push('" name="'),s.push(r(this.attribute.name)),s.push('" '),s.push(r(i.checked)),s.push(" "),s.push(r(i.disabled)),s.push(">\n    "),s.push(this.Icon("radio","icon-unchecked")),s.push("\n    "),s.push(this.Icon("radio-checked","icon-checked")),s.push('\n    <span class="label-text">'),s.push(this.T(i.name)),s.push("</span>\n    "),i.note&&(s.push('<span class="help-text">'),s.push(this.T(i.note)),s.push("</span>")),s.push("\n  </label>\n");s.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/radio_graphic"]=function(t){t||(t={});var i,o=[],a=function(t){var e,n=o;return o=[],t.call(this),e=o.join(""),o=n,i(e)},l=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return i=t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r;for(r=this,e=function(t){return a(function(){return o.push("\n  "),o.push(r.Icon("radio","icon-unchecked")),o.push("\n  "),o.push(r.Icon("radio-checked","icon-checked")),o.push('\n  <span class="label-text">'),o.push(r.T(t.name)),o.push(" "),t.note&&(o.push('- <span class="help-text">'),o.push(r.T(t.note)),o.push("</span>")),o.push("</span>\n")})},o.push('\n\n<div class="'),o.push(l(this.attribute["class"])),o.push(' radio selections-container">\n  '),t=0,n=(i=this.attribute.options).length;t<n;t++)s=i[t],o.push('\n    <label class="inline-label radio-replacement">\n      <input type="radio" value="'),o.push(l(s.value)),o.push('" name="'),o.push(l(this.attribute.name)),o.push('" '),o.push(l(s.checked)),o.push('>\n      <span class="label-box">\n        <span class="radio-illustration"'),s.aspect_ratio&&(o.push(' style="padding-bottom: '),o.push(l(100/s.aspect_ratio)),o.push('%"')),o.push('>\n          <img src="/assets/images/graphics/'),o.push(l(s.graphic)),o.push('">\n        </span>\n        <span class="label-row">'),o.push(l(e(s))),o.push("</span>\n      </span>\n    </label>\n  ");o.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,o.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/richtext"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="richtext form-control">\n\t'),this.attribute.buttons){for(s.push('\n    <div class="richtext-controls btn-group">\n      '),e=0,n=(i=this.attribute.buttons).length;e<n;e++)t=i[e],s.push('\n        <a class="btn btn--action btn--small" data-action="'),s.push(r(t)),s.push('">\n          '),s.push(this.Icon(this.toolButtons[t].icon)),s.push("\n          "),this.toolButtons[t].text&&(s.push("\n          <span>"),s.push(r(this.toolButtons[t].text)),s.push("</span>\n          ")),s.push("\n        </a>\n      ");s.push("\n    </div>\n\t")}s.push('\n  <div contenteditable="true" id="'),s.push(r(this.attribute.id)),s.push('" data-name="'),s.push(r(this.attribute.name)),s.push('" class="richtext-content '),s.push(r(this.attribute["class"])),s.push('">'),s.push(this.attribute.value),s.push("</div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/searchable_select"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="dropdown-toggle" data-toggle="dropdown">\n  <input\n    class="searchableSelect-shadow form-control js-shadow"\n    '),this.attribute.id&&(e.push('id="'),e.push(n(this.attribute.id)),e.push('"')),e.push('\n    name="'),e.push(n(this.attribute.name)),e.push('"\n    '),e.push(n(this.attribute.required)),e.push("\n    "),e.push(n(this.attribute.autofocus)),e.push('\n    value="'),e.push(n(this.attribute.value)),e.push('"\n    tabindex="-1"\n  >\n  <input\n    class="searchableSelect-main form-control js-input'),this.attribute["class"]&&e.push(n(" "+this.attribute["class"])),e.push('"\n    placeholder="'),e.push(n(this.attribute.placeholder)),e.push('"\n    value="'),e.push(n(this.attribute.valueName)),e.push('"\n    autocomplete="off"\n    '),e.push(n(this.attribute.required)),e.push('\n   >\n  <div class="searchableSelect-autocomplete">\n    <span class="searchableSelect-autocomplete-invisible js-autocomplete-invisible"></span>\n    <span class="searchableSelect-autocomplete-visible js-autocomplete-visible"></span>\n  </div>\n  '),this.attribute.ajax||e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n  <div class="small loading icon"></div>\n</div>\n<div class="dropdown-menu dropdown-menu-left dropdown-menu--has-submenu js-dropdown">\n  <ul class="js-optionsList" role="menu">\n    '),e.push(this.options),e.push("\n  </ul>\n  "),e.push(this.submenus),e.push("\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/searchable_select_option"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<li role="presentation" class="'),e.push(n(this["class"])),e.push('" data-value="'),e.push(n(this.option.value)),e.push('" title="'),e.push(n(this.option.name)),this.detail&&e.push(n(this.detail)),e.push('">\n  <span class="searchableSelect-option-text">\n    '),e.push(n(this.option.name)),this.detail&&(e.push('<span class="dropdown-detail">'),e.push(n(this.detail)),e.push("</span>")),e.push("\n  </span>\n  "),this.option.children&&(e.push("\n    "),e.push(this.Icon("arrow-right","recipientList-arrow")),e.push("\n  ")),e.push("\n</li>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/searchable_select_submenu"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<ul class="dropdown-submenu js-optionsSubmenu" role="menu" data-parent-value="'),e.push(this.parentValue),e.push('" hidden>\n  '),this.title&&(e.push('\n  <li class="dropdown-controls js-back">\n    '),e.push(this.Icon("arrow-left")),e.push('\n    <div class="dropdown-title">\n      '),e.push(this.title),e.push("\n    </div>\n  </li>\n  ")),e.push("\n  "),e.push(this.options),e.push("\n</ul>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}
}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/select"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="controls controls--select">\n  <select '),this.attribute.id&&(s.push('id="'),s.push(r(this.attribute.id)),s.push('"')),s.push(' class="form-control'),this.attribute["class"]&&s.push(r(" "+this.attribute["class"])),s.push('" name="'),s.push(r(this.attribute.name)),s.push('" '),s.push(r(this.attribute.multiple)),s.push(" "),s.push(r(this.attribute.required)),s.push(" "),s.push(r(this.attribute.autofocus)),s.push(" "),this.attribute.disabled&&s.push(" disabled"),s.push(">\n"),this.attribute.options){for(s.push("\n"),t=0,e=(n=this.attribute.options).length;t<e;t++)i=n[t],s.push('\n    <option value="'),s.push(r(i.value)),s.push('" '),s.push(r(i.selected)),s.push(" "),s.push(r(i.disabled)),s.push(">"),s.push(r(i.name)),s.push("</option>\n");s.push("\n")}s.push("\n  </select>\n  "),this.attribute.multiple||(s.push("\n    "),s.push(this.Icon("arrow-down")),s.push("\n  ")),s.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/sidebar_tabs"]=function(t){t||(t={});var a=[],l=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o;for(t=0,i=(r=this.items).length;t<i;t++)e=r[t],a.push('\n<div class="sidebar bottom-form-shadow flex hide" data-tab="'),a.push(l(e.name)),a.push('">\n  <div class="sidebar-header">\n    <h2 class="sidebar-header-headline js-headline">'),a.push(this.T(e.sidebarHead)),a.push('</h2>\n    <div class="sidebar-header-actions js-actions"></div>\n    <div class="tabsSidebar-close">\n      '),a.push(this.Icon("long-arrow-right")),a.push('\n    </div>\n  </div>\n  <hr>\n  <div class="sidebar-content"></div>\n</div>\n');for(a.push('\n<div class="tabsSidebar-tabs" style="'),a.push("rtl"===this.dir?"margin-right":"margin-left"),a.push(": -"),a.push(this.scrollbarWidth),a.push('px">\n'),n=0,s=(o=this.items).length;n<s;n++)e=o[n],a.push('\n  <div class="tabsSidebar-tab" data-tab="'),a.push(l(e.name)),a.push('"></div>\n');a.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,a.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/sidebar_tabs_item"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){!0===this.counterPossible&&(e.push('\n  <div class="tabsSidebar-tab-count js-tabCounter '),this.counter&&0!==this.counter||e.push("hide"),this.cssClass&&e.push(n(this.cssClass)),e.push('">'),e.push(n(this.counter)),e.push("</div>\n")),e.push("\n"),e.push(this.Icon(this.icon)),e.push("\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/sla_times"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<table class="settings-list settings-list--toggleRow">\n  <thead>\n    <tr>\n      <th>'),e.push(this.T("Active")),e.push("\n      <th>"),e.push(this.T("Type")),e.push("\n      <th>"),e.push(this.T("Time")),e.push(' <span class="text-muted">'),e.push(this.T("in hours")),e.push('</span>\n  </thead>\n  <tbody>\n    <tr class="form-group">\n      <td class="u-positionOrigin">\n        <label class="checkbox-replacement checkbox-replacement--fullscreen dont-grey-out">\n          <input type="checkbox" class="js-activateRow" id="first_response_time" name="first_response_time_enabled">\n          '),e.push(this.Icon("checkbox","icon-unchecked")),e.push("\n          "),e.push(this.Icon("checkbox-checked","icon-checked")),e.push('\n        </label>\n      <td class="u-clickable js-forward-click">\n        <div>'),e.push(this.T("First Response Time")),e.push('</div>\n        <p class="subtle">'),e.push(this.T("Timeframe for the first response.")),e.push('</p>\n      <td class="u-clickable js-focus-input">\n        <input type="hidden" name="first_response_time" value="'),e.push(n(this.first_response_time)),e.push('" class="js-timeConvertTo">\n        <input type="text" value="'),e.push(n(this.first_response_time_in_text)),e.push('" class="form-control form-control--small timeframe js-timeConvertFrom"  placeholder="hh:mm" name="first_response_time_in_text" data-name="first_response_time">\n\n    <tr class="form-group">\n      <td class="u-positionOrigin">\n        <label class="checkbox-replacement checkbox-replacement--fullscreen dont-grey-out">\n          <input type="checkbox" class="js-activateRow" id="update_time" name="update_time_enabled">\n          '),e.push(this.Icon("checkbox","icon-unchecked")),e.push("\n          "),e.push(this.Icon("checkbox-checked","icon-checked")),e.push('\n        </label>\n      <td class="u-clickable js-forward-click">\n        <div>'),e.push(this.T("Update Time")),e.push('</div>\n        <p class="subtle">'),e.push(this.T("Timeframe for every following response.")),e.push('</p>\n      <td>\n        <input type="hidden" name="update_time" value="'),e.push(n(this.update_time)),e.push('" class="js-timeConvertTo">\n        <input type="text" value="'),e.push(n(this.update_time_in_text)),e.push('" class="form-control form-control--small timeframe js-timeConvertFrom" placeholder="hh:mm" name="update_time_in_text" data-name="update_time">\n\n    <tr class="form-group">\n      <td class="u-positionOrigin">\n        <label class="checkbox-replacement checkbox-replacement--fullscreen dont-grey-out">\n          <input type="checkbox" id="solution_time" class="js-activateRow" name="solution_time_enabled">\n          '),e.push(this.Icon("checkbox","icon-unchecked")),e.push("\n          "),e.push(this.Icon("checkbox-checked","icon-checked")),e.push('\n        </label>\n      <td class="u-clickable js-forward-click">\n        <div>'),e.push(this.T("Solution Time")),e.push('</div>\n        <p class="subtle">'),e.push(this.T("Timeframe for solving the problem.")),e.push('</p>\n      <td>\n        <input type="hidden" name="solution_time" value="'),e.push(n(this.solution_time)),e.push('" class="js-timeConvertTo">\n        <input type="text" value="'),e.push(n(this.solution_time_in_text)),e.push('" class="form-control form-control--small timeframe js-timeConvertFrom" placeholder="hh:mm" name="solution_time_in_text" data-name="solution_time">\n\n    </tr>\n  </tbody>\n</table>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/table"]=function(t){t||(t={});var r=[],o=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s;for(r.push('<div class="js-pager"></div>\n<table class="table table-hover'),this["class"]&&(r.push(" "),r.push(o(this["class"]))),r.push('">\n  <thead>\n    <tr>\n    '),this.sortable&&r.push('\n      <th style="width: 36px" class="table-draggable"></th>\n    '),r.push("\n    "),this.checkbox&&(r.push('\n      <th style="width: 30px" class="table-checkbox">\n        <label class="checkbox-replacement">\n          <input type="checkbox" value="" name="bulk_all">\n          '),r.push(this.Icon("checkbox","icon-unchecked")),r.push("\n          "),r.push(this.Icon("checkbox-checked","icon-checked")),r.push("\n          "),r.push(this.Icon("checkbox-indeterminate","icon-indeterminate")),r.push("\n        </label>\n      </th>\n    ")),r.push("\n    "),this.radio&&r.push('\n      <th style="width: 30px" class="table-radio"></th>\n    '),r.push("\n    "),e=n=0,i=(s=this.headers).length;n<i;e=++n)t=s[e],r.push('\n      <th class="js-tableHead'),t.className&&(r.push(" "),r.push(o(t.className))),t.align&&(r.push(" align-"),r.push(o(t.align))),r.push('" style="'),t.displayWidth&&(r.push("width:"),r.push(o(t.displayWidth)),r.push("px")),r.push('" data-column-key="'),r.push(o(t.name)),r.push('">\n        <div class="table-column-head'),this.sortable&&r.push(o(" table-column-head-unclickable")),this.tableId&&!this.sortable&&r.push(o(" js-sort")),r.push('">\n          <div class="table-column-title">'),r.push(this.T(t.display)),r.push("</div>\n          "),this.sortable||(r.push('\n            <div class="table-column-sortIcon">'),t.sortOrderIcon&&r.push(this.Icon(t.sortOrderIcon[0],t.sortOrderIcon[1])),r.push("</div>\n          ")),r.push("\n        </div>\n        "),this.tableId&&!t.unresizable&&e<this.headers.length-1&&this.headers.length-1!==e&&this.headers[e+1]&&!this.headers[e+1].unresizable&&r.push('\n          <div class="table-col-resize js-col-resize"></div>\n        '),r.push("\n      </th>\n    ");r.push('\n    </tr>\n  </thead>\n  <tbody class="js-tableBody">'),r.push(this.tableBody),r.push('</tbody>\n</table>\n<div class="js-pager"></div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,r.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/table_pager"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(i.push('<div class="btn-group btn-group--full" role="group" aria-label="" style="margin-bottom: 5px;">\n  '),e=t=0,n=this.pages;0<=n?t<=n:n<=t;e=0<=n?++t:--t)i.push('\n    <div class="btn btn--text btn--large js-page'),this.page!==e&&this.page!==e.toString()||i.push(" is-selected"),i.push('" data-page="'),i.push(s(e)),i.push('">'),i.push(s(e+1)),i.push("</div>\n  ");i.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/table_row"]=function(t){t||(t={});var y=[],b=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v;for(y.push('<tr class="item'),!1===this.object.active&&y.push(b(" is-inactive")),this.object.rowClass&&y.push(b(" "+this.object.rowClass())),y.push('" data-id="'),y.push(b(this.object.id)),y.push('">\n'),this.sortable&&(y.push('\n  <td class="table-draggable">'),y.push(this.Icon("draggable")),y.push("</td>\n")),y.push("\n"),this.checkbox&&(y.push('\n  <td class="table-checkbox js-checkbox-field">\n    <label class="checkbox-replacement">\n      <input type="checkbox" value="'),y.push(b(this.object.id)),y.push('" name="bulk">\n      '),y.push(this.Icon("checkbox","icon-unchecked")),y.push("\n      "),y.push(this.Icon("checkbox-checked","icon-checked")),y.push("\n    </label>\n  </td>\n")),y.push("\n"),this.radio&&(y.push('\n  <td class="table-radio">\n    <label class="radio-replacement">\n      <input type="radio" value="'),y.push(b(this.object.id)),y.push('" name="radio">\n      '),y.push(this.Icon("radio","icon-unchecked")),y.push("\n      "),y.push(this.Icon("radio-checked","icon-checked")),y.push("\n    </label>\n  </td>\n")),y.push("\n"),a=0,p=(d=this.headers).length;a<p;a++){if(o=d[a],y.push("\n  "),v=this.P(this.object,o.name,this.attributes,!0),y.push("\n  "),this.callbacks){for(e in y.push("\n  "),f=this.callbacks){if(i=f[e],y.push("\n  "),e===o.name){for(y.push("\n  "),l=0,u=i.length;l<u;l++)n=i[l],y.push("\n  "),v=n(v,this.object,o,this.headers),y.push("\n  ");y.push("\n  ")}y.push("\n  ")}y.push("\n  ")}if(y.push("\n  <td"),o.parentClass&&(y.push(' class="'),y.push(b(o.parentClass)),y.push('"')),o.title&&(y.push(' title="'),y.push(b(o.title)),y.push('"')),o.align&&(y.push(' style="text-align:'),y.push(b(o.align)),y.push('"')),y.push(">\n    "),"icon"===o.name)y.push("\n      "),y.push(this.Icon("task-state",o["class"])),y.push("\n    ");else if(o.icon)y.push("\n      "),y.push(this.Icon(o.icon)),y.push("\n    ");else if("action"===o.name){if(y.push("\n      "),1<this.actions.length){for(y.push('\n        <div class="dropdown dropdown--actions">\n          <div class="btn btn--table btn--text btn--secondary js-action" data-toggle="dropdown">\n            '),y.push(this.Icon("overflow-button")),y.push('\n          </div>\n          <ul class="dropdown-menu dropdown-menu-right js-table-action-menu" role="menu">\n            '),c=0,h=(m=this.actions).length;c<h;c++)t=m[c],y.push('\n            <li role="presentation" class="'),y.push(b(t["class"])),y.push('" data-table-action="'),y.push(b(t.name)),y.push('">\n              <a role="menuitem" tabindex="-1">\n                <span class="dropdown-iconSpacer">\n                  '),y.push(this.Icon(t.icon)),y.push("\n                </span>\n                "),y.push(this.T(t.display)),y.push("\n              </a>\n            ");y.push("\n          </ul>\n        </div>\n      ")}else y.push('\n        <div class="btn btn--text btn--secondary '),y.push(b(this.actions[0]["class"])),y.push('" title="'),y.push(b(this.actions[0].display)),y.push('" data-table-action="'),y.push(b(this.actions[0].name)),y.push('">\n          '),y.push(this.Icon(this.actions[0].icon)),y.push("\n        </div>\n      ");y.push("\n    ")}else{if(y.push("\n      "),o.link&&(y.push('\n        <a href="'),y.push(o.link),y.push('" '),o.target&&(y.push('target="'),y.push(b(o.target)),y.push('"')),y.push(">\n      ")),y.push("\n      "),o.raw)y.push("\n        "),y.push(o.raw),y.push("\n      ");else{if(y.push("\n        "),o["class"]||o.data){if(y.push("\n        <span "),o["class"]&&(y.push('class="'),y.push(b(o["class"])),y.push('"')),y.push(" "),o.data)for(r in g=o.data)s=g[r],y.push("data-"),y.push(r),y.push('="'),y.push(b(s)),y.push('" ');y.push(">\n        ")}y.push("\n        "),y.push(v),y.push("\n        "),(o["class"]||o.data)&&y.push("</span>"),y.push("\n      ")}y.push("\n      "),o.link&&y.push("</a>"),y.push("\n    ")}y.push("\n  </td>\n")}y.push("\n</tr>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,y.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/table_row_group_by"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<tr>\n  <td colspan="'),e.push(n(this.columnsLength)),e.push('"><b>'),e.push(this.groupByName),this.groupByCount&&(e.push(" ("),e.push(n(this.groupByCount)),e.push(")")),e.push("</b></td>\n</tr>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/tabs"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="page-header page-header--tabs">\n  <div class="page-header-title">\n    '),this.headerSwitchName&&(s.push('\n      <div class="zammad-switch zammad-switch--small js-header-switch" data-name="'),s.push(r(this.headerSwitchName)),s.push('">\n         <input name="'),s.push(r(this.headerSwitchName)),s.push('" type="checkbox" id="setting-'),s.push(r(this.headerSwitchName)),s.push('" '),this.headerSwitchChecked&&s.push("checked"),s.push('>\n         <label for="setting-'),s.push(r(this.headerSwitchName)),s.push('"></label>\n      </div>\n    ')),s.push("\n    <h1>"),s.push(this.T(this.header)),s.push(" <small>"),s.push(this.T(this.subHeader)),s.push("</small></h1>\n  </div>\n  "),this.addTab&&(s.push('\n  <div class="page-header-meta">\n    <div class="btn btn--success btn--quad">\n      '),s.push(this.Icon("plus")),s.push("\n    </div>\n  </div>\n  ")),s.push('\n</div>\n<div class="page-content">\n  '),1<this.tabs.length){for(s.push('\n    <ul class="nav nav-tabs" role="tablist">\n    '),t=0,e=(n=this.tabs).length;t<e;t++)i=n[t],s.push('\n      <li><a href="#'),s.push(r(i.target)),s.push('" role="tab" data-toggle="tab">'),s.push(this.T(i.name)),s.push("</a></li>\n    ");s.push("\n    </ul>\n  ")}s.push('\n  <div class="tab-content"></div>\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/textarea"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<textarea id="'),e.push(n(this.attribute.id)),e.push('" name="'),e.push(n(this.attribute.name)),e.push('" class="form-control '),e.push(n(this.attribute["class"])),e.push('" rows="'),e.push(n(this.attribute.rows)),e.push('" '),e.push(n(this.attribute.required)),e.push(" "),e.push(n(this.attribute.autofocus)),e.push(">"),e.push(n(this.attribute.value)),e.push("</textarea>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/ticket_list"]=function(t){t||(t={});var o=[],a=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r;for(o.push('<div class="tasks tasks--standalone">\n  '),t=n=0,i=(s=this.tickets).length;n<i;t=++n)r=s[t],o.push("\n  "),t===this.show_max&&(o.push("\n  "),e=_.uniqueId("show_all_"),o.push('\n  <div class="collapse" id="'),o.push(a(e)),o.push('">\n  ')),o.push('\n  <div class="task">\n    <div class="icon-holder" title="'),o.push(r.iconTitle()),o.push('">\n      '),o.push(this.Icon("task-state",r.iconClass())),o.push('\n    </div>\n    <div class="task-text">\n      <a class="name ticket-popover" data-id="'),o.push(r.id),o.push('" href="'),o.push(r.uiUrl()),o.push('">\n        '),this.show_id&&(o.push('\n          <span class="task-id">#'),o.push(a(r.number)),o.push("</span>\n        ")),o.push("\n        "),o.push(a(r.title||"-")),o.push("\n      </a>\n      "),o.push(this.humanTime(r.created_at,!1,"time")),o.push("\n    </div>\n    "),this.object&&(o.push('\n    <a class="list-item-delete js-delete" data-object="'),o.push(a(this.object)),o.push('" data-object-id="'),o.push(a(r.id)),o.push('" data-link-type="'),o.push(a(this.linkType||"normal")),o.push('" data-type="remove">\n      '),o.push(this.Icon("diagonal-cross")),o.push("\n    </a>\n    ")),o.push("\n  </div>\n  ");o.push("\n  "),this.tickets.length>this.show_max&&(o.push('\n  </div>\n  <div class="btn btn--text btn-show-all" role="button" data-toggle="collapse" data-target="#'),o.push(a(e)),o.push('" aria-expanded="false" aria-controls="'),o.push(a(e)),o.push('">\n    <div data-show="open">'),o.push(this.Icon("arrow-down")),o.push(" <span>"),o.push(this.T("Show all...")),o.push('</span></div>\n    <div data-show="collapsed">'),o.push(this.Icon("arrow-up")),o.push(" <span>"),o.push(this.T("Show less")),o.push("</span></div>\n  </div>\n  ")),o.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,o.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/ticket_perform_action/article"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="form-group">\n  <div class="formGroup-label">\n    <label>'),e.push(this.T("Visibility")),e.push('</label>\n  </div>\n  <div class="js-internal"></div>\n</div>\n<div class="form-group">\n  <div class="formGroup-label">\n    <label>'),e.push(this.T("Subject")),e.push('</label>\n  </div>\n  <div class="controls js-subject">\n    <input type="text" name="'),e.push(n(this.name)),e.push('::subject" value="'),e.push(n(this.meta.subject)),e.push('" style="width: 100%;" placeholder="'),e.push(this.T("Subject")),e.push('">\n  </div>\n</div>\n<div class="form-group">\n  <div class="formGroup-label">\n    <label>'),e.push(this.T("Body")),e.push('</label>\n  </div>\n  <div class="controls js-body js-body-'),e.push(this.articleType),e.push('">\n    <div class="richtext form-control"><div contenteditable="true" data-name="'),e.push(n(this.name)),e.push('::body">'),e.push(this.meta.body),e.push("</div></div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/ticket_perform_action/attribute_selector"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="flex horizontal">\n  <div class="controls">\n    <div class="u-positionOrigin js-operator">\n      <select></select>\n      '),e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n    </div>\n  </div>\n  <div class="controls">\n    <div class="u-positionOrigin js-preCondition">\n      <select></select>\n      '),e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n    </div>\n  </div>\n  <div class="controls js-value"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/ticket_perform_action/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="horizontal-filters"></div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/ticket_perform_action/notification"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="form-group">\n  <div class="formGroup-label">\n    <label>'),e.push(this.T("Visibility")),e.push('</label>\n  </div>\n  <div class="js-internal"></div>\n</div>\n<div class="form-group">\n  <div class="formGroup-label">\n    <label>'),e.push(this.T("Recipient")),e.push('</label>\n  </div>\n  <div class="controls js-recipient u-positionOrigin">\n    <select></select>\n  </div>\n</div>\n'),"email"===this.notificationType&&(e.push('\n<div class="form-group">\n  <div class="formGroup-label">\n    <label>'),e.push(this.T("Subject")),e.push('</label>\n  </div>\n  <div class="controls js-subject"><input type="text" name="'),e.push(n(this.name)),e.push('::subject" value="'),e.push(n(this.meta.subject)),e.push('" style="width: 100%;" placeholder="'),e.push(this.T("Subject")),e.push('"></div>\n</div>\n')),e.push('\n<div class="form-group">\n  <div class="formGroup-label">\n    <label>'),e.push(this.T("Body")),e.push('</label>\n  </div>\n  <div class="controls js-body js-body-'),e.push(this.notificationType),e.push('">\n    <div class="richtext form-control">\n      <div contenteditable="true" data-name="'),e.push(n(this.name)),e.push('::body">'),e.push(this.meta.body),e.push('</div>\n    </div>\n  </div>\n  <div class="controls js-sign">\n  </div>\n  <div class="controls js-encryption">\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/ticket_perform_action/row"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="horizontal-filter js-filterElement">\n  <div class="horizontal-filter-body">\n    <div class="controls">\n      <div class="u-positionOrigin js-attributeSelector">\n        '),e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n      </div>\n    </div>\n    <div class="js-setAttribute"></div>\n    <div class="horizontal-filter-group js-setNotification flex"></div>\n    <div class="horizontal-filter-group js-setArticle flex"></div>\n  </div>\n  <div class="filter-controls js-rowActions">\n    <div class="filter-control filter-control-remove js-remove" title="'),e.push(this.Ti("Remote")),e.push('">\n      '),e.push(this.Icon("minus-small")),e.push('\n    </div>\n    <div class="filter-control filter-control-add js-add" title="'),e.push(this.Ti("Add")),e.push('">\n      '),e.push(this.Icon("plus-small")),e.push("\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/ticket_selector"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="horizontal-filters js-filter">\n</div>\n<div class="js-preview '),!1===this.attribute.preview&&e.push("hide"),e.push('">\n  <h3>'),e.push(this.T("Preview")),e.push('<span class="subtitle js-previewCounterContainer hide"> <span class="u-highlight js-previewCounter">?</span> '),e.push(this.T("matches")),e.push('</span> <span class="tiny loading icon js-previewLoader hide" style="margin-left: 3px;"></span></h3>\n  <div class="js-previewTable"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/ticket_selector_row"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="horizontal-filter js-filterElement">\n  <div class="horizontal-filter-body">\n    <div class="controls">\n      <div class="u-positionOrigin js-attributeSelector">\n        '),e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n      </div>\n    </div>\n    <div class="controls">\n      <div class="u-positionOrigin js-operator">\n        <select></select>\n        '),e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n      </div>\n    </div>\n    <div class="controls">\n      <div class="u-positionOrigin js-preCondition">\n        <select></select>\n        '),e.push(this.Icon("arrow-down","dropdown-arrow")),e.push('\n      </div>\n    </div>\n    <div class="controls js-value horizontal horizontal-filter-value"></div>\n  </div>\n  <div class="filter-controls">\n    <div class="filter-control filter-control-remove js-remove" title="'),e.push(this.Ti("Remove")),e.push('">\n      '),e.push(this.Icon("minus-small")),e.push('\n    </div>\n    <div class="filter-control filter-control-add js-add" title="'),e.push(this.Ti("Add")),e.push('">\n      '),e.push(this.Icon("plus-small")),e.push("\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/time_range"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(t in i.push('<div class="controls u-positionOrigin js-valueRangeSelector"></div>\n<div class="controls u-positionOrigin">\n  <select class="form-control js-range" name="'),i.push(s(this.attribute.name)),i.push('::range">\n    '),e=this.ranges)n=e[t],i.push('\n      <option value="'),i.push(s(t)),i.push('" '),this.attribute.value&&this.attribute.value.range===t&&i.push("selected"),i.push(">"),i.push(n),i.push("</option>\n    ");i.push("\n  </select>\n  "),i.push(this.Icon("arrow-down","dropdown-arrow")),i.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/time_range_value_selector"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(t in i.push('<select class="form-control js-value" name="'),i.push(s(this.attribute.name)),i.push('::value">\n  '),e=this.values)n=e[t],i.push('\n    <option value="'),i.push(s(t)),i.push('" '),this.attribute.value&&this.attribute.value.value.toString()===t.toString()&&i.push("selected"),i.push(">"),i.push(n),i.push("</option>\n  ");i.push("\n</select>\n"),i.push(this.Icon("arrow-down","dropdown-arrow")),i.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/timeplan"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")
}),function(){(function(){e.push("<div>\n  <label>"),e.push(this.T("Days")),e.push('\n    <div class="days"></div>\n  </label>\n  <label>'),e.push(this.T("Hours")),e.push('\n    <div class="hours"></div>\n  </label>\n  <label>'),e.push(this.T("Minutes")),e.push('\n    <div class="minutes"></div>\n  </label>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/timer"]=function(t){t||(t={});var c=[],p=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l;for(t in c.push('<p>\n  <output class="timer-output js-timerResult"></output>\n</p>\n<div class="select-boxes">\n  <div class="select-box select-box--vertical js-day">\n    <div class="select-box-header">'),c.push(this.T("Day")),c.push("</div>\n    "),o=this.days)e=o[t],c.push('\n      <div data-type="day" class="select-value '),this.attribute.value.days[t]&&c.push("is-selected"),c.push('" data-value="'),c.push(t),c.push('">'),c.push(this.T(e)),c.push('</div>\n      <input type="hidden" class="js-boolean" name="'),c.push(p(this.attribute.name)),c.push("::days::"),c.push(t),c.push('" value="'),this.attribute.value.days[t]?c.push("true"):c.push("false"),c.push('">\n    ');for(n in c.push('\n  </div>\n  <div class="select-box select-box--four js-hour">\n    <div data-type="hour" class="select-box-header">'),c.push(this.T("Hour")),c.push("</div>\n    "),a=this.hours)i=a[n],c.push('\n      <div data-type="hour" class="select-value '),this.attribute.value.hours[n]&&c.push("is-selected"),c.push('" data-value="'),c.push(n),c.push('">'),c.push(i),c.push('</div>\n      <input type="hidden" class="js-boolean" name="'),c.push(p(this.attribute.name)),c.push("::hours::"),c.push(n),c.push('" value="'),this.attribute.value.hours[n]?c.push("true"):c.push("false"),c.push('">\n    ');for(s in c.push('\n  </div>\n  <div class="select-box select-box--vertical js-minute">\n    <div data-type="minute" class="select-box-header">'),c.push(this.T("Minute")),c.push("</div>\n    "),l=this.minutes)r=l[s],c.push('\n      <div data-type="minute" class="select-value '),this.attribute.value.minutes[s]&&c.push("is-selected"),c.push('" data-value="'),c.push(s),c.push('">'),c.push(r),c.push('</div>\n      <input type="hidden" class="js-boolean" name="'),c.push(p(this.attribute.name)),c.push("::minutes::"),c.push(s),c.push('" value="'),this.attribute.value.minutes[s]?c.push("true"):c.push("false"),c.push('">\n    ');c.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,c.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/token"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="token" data-value="'),e.push(n(this.value)),e.push('">\n  <span class="token-label">'),e.push(n(this.name)),e.push('</span>\n  <span class="token-close js-remove">\xd7</span>\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/user_permission"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="checkbox '),s.push(r(this.attribute["class"])),s.push(' checkbox">\n'),t=0,e=(n=this.roles).length;t<e;t++)i=n[t],s.push('\n  <label class="inline-label checkbox-replacement">\n    <input type="checkbox" value="'),s.push(r(i.id)),s.push('" name="role_ids" '),this.rolesSelected[i.id]&&s.push("checked"),s.push("/>\n    "),s.push(this.Icon("checkbox","icon-unchecked")),s.push("\n    "),s.push(this.Icon("checkbox-checked","icon-checked")),s.push('\n    <span class="label-text">'),s.push(this.T(i.displayName())),s.push("</span>\n    "),i.note&&(s.push('<span class="help-text">'),s.push(this.T(i.note)),s.push("</span>")),s.push("\n  </label>\n");s.push('\n  <div class="js-groups"></div>\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/generic/user_permission_group"]=function(t){t||(t={});var c=[],p=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l;for(n in c.push('<div style="padding-left: 18px; padding-top: 10px; width: 95%;" class="js-groupList '),this.hideGroups&&c.push("js-groupListHide hidden"),c.push('">\n  <hr>\n  <table class="settings-list" style="width: 100%;">\n    <thead>\n      <th>'),c.push(this.T("Group")),c.push("\n      "),r=this.groupAccesses)l=r[n],c.push("\n        <th>"),c.push(this.T(l)),c.push("\n      ");for(c.push("\n    <tbody>\n  "),e=0,i=(o=this.groups).length;e<i;e++){for(n in t=o[e],c.push("\n  "),s=[],c.push("\n  "),this.params.group_ids&&this.params.group_ids[t.id]&&(c.push("\n  "),s=this.params.group_ids[t.id],c.push("\n  ")),c.push("\n    <tr>\n      <td>\n        "),c.push(p(t.displayName())),c.push("\n      "),a=this.groupAccesses)l=a[n],c.push('\n        <td>\n        <label class="inline-label checkbox-replacement">\n          <input class="js-groupListItem" type="checkbox" value="'),c.push(p(n)),c.push('" name="group_ids::'),c.push(p(t.id)),c.push('" '),_.contains(s,n)&&c.push("checked"),c.push("/>\n          "),c.push(this.Icon("checkbox","icon-unchecked")),c.push("\n          "),c.push(this.Icon("checkbox-checked","icon-checked")),c.push("\n        </label>\n      ");c.push("\n    </tr>\n  ")}c.push("\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,c.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/admin"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n  <form class="setup wizard js-admin">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Administrator Account")),e.push('</h2>\n      <div class="wizard-body vertical justified js-admin-form"></div>\n      <div class="wizard-controls center">\n        <a class="btn btn--text btn--secondary" href="#getting_started">'),e.push(this.T("Go Back")),e.push('</a>\n        <button class="btn btn--success align-right">'),e.push(this.T("Create")),e.push("</button>\n      </div>\n    </div>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/agent"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n  <form class="setup wizard js-agent">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Invite Colleagues")),e.push('</h2>\n      <div class="wizard-body vertical justified js-agent-form"></div>\n      <div class="wizard-controls center">\n        <a class="btn btn--primary align-left" href="#getting_started/finish">'),e.push(this.T("Continue")),e.push('</a>\n        <button class="btn btn--success align-right">'),e.push(this.T("Invite")),e.push("</button>\n      </div>\n    </div>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/auto_wizard_enabled"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n  <div class="setup wizard">\n    <div class="wizard-slide">\n      <div class="wizard-body vertical centered">\n        '),e.push(this.T("The auto wizard is enabled, please use the prodvided auto wizard url.")),e.push("\n      </div>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/auto_wizard_failed"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n  <div class="setup wizard">\n    <div class="wizard-slide">\n      <div class="wizard-body vertical centered">\n        '),e.push(this.T(this.message)),e.push("\n      </div>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/auto_wizard_splash"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push("\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/base"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n  <form class="setup wizard js-base">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Organization")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <fieldset>\n          <div class="form-group">\n            <label>'),e.push(this.T("Organization Name")),e.push('</label>\n            <div class="alert alert--danger hide" role="alert"></div>\n            <input class="form-control" name="organization" placeholder="'),e.push(this.Ti("Company Inc.")),e.push('" value="'),e.push(n(this.organization)),e.push('" required>\n          </div>\n          <div class="form-group">\n            <label>'),e.push(this.T("Logo")),e.push('</label>\n            <div class="alert alert--danger hide" role="alert"></div>\n            <img class="logo-preview" src="'),e.push(n(this.logoUrl)),e.push('">\n            <div class="logo-preview-placeholder">'),e.push(this.T("Your Logo")),e.push('</div>\n            <div class="btn btn--success fileUpload">'),e.push(this.T("Upload")),e.push('<input type="file" class="js-upload" name="logo" accept="image/*"></div>\n          </div>\n          '),this.C("system_online_service")||(e.push('\n          <div class="form-group">\n            <label>'),e.push(this.T("System URL")),e.push('</label>\n            <div class="alert alert--danger hide" role="alert"></div>\n            <input type="text" class="form-control" name="url" value="'),e.push(n(this.url)),e.push('" placeholder="http://zammad.example.com" required>\n            <p class="help-block">'),e.push(this.T("The URL to this installation of Zammad.")),e.push("</p>\n          </div>\n          ")),e.push('\n        </fieldset>\n      </div>\n      <div class="wizard-controls center">\n        <button class="btn btn--primary align-right">'),e.push(this.T("Next")),e.push("</button>\n      </div>\n    </div>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/channel"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="main flex vertical centered darkBackground">\n  '),s.push(this.Icon("full-logo","wizard-logo")),s.push('\n  <form class="setup wizard js-channel">\n    <div class="wizard-slide">\n      <h2>'),s.push(this.T("Connect Channels")),s.push('</h2>\n      <div class="wizard-body vertical center">\n        <p class="text-center">'),s.push(this.T("Set up the communication channels you want to use with your Zammad.")),s.push('</p>\n        <div class="wizard-buttonList vertical">\n\n          '),e=0,n=(i=this.adapters).length;e<n;e++)t=i[e],s.push('\n            <a href="'),s.push(r(t.link)),s.push('" class="btn auth_provider auth_provider--wide '),s.push(r(t["class"])),s.push('">\n              <div class="'),s.push(r(t["class"])),s.push(' provider_icon"></div>\n              <div class="provider_name">'),s.push(this.T(t.name)),s.push("</div>\n            </a>\n          ");s.push('\n\n        </div>\n      </div>\n      <div class="wizard-controls center">\n        <a class="btn btn--text btn--secondary" href="#getting_started/email_notification">'),s.push(this.T("Go Back")),s.push('</a>\n        <a class="btn align-right" href="#getting_started/finish">'),s.push(this.T("Skip")),s.push("</a>\n      </div>\n    </div>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/email"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n\n  <form class="setup wizard js-intro">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Email Account")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <fieldset>\n          <div class="form-group">\n            <label>'),e.push(this.T("Full Name")),e.push('</label>\n            <input type="text" class="form-control" value="" name="realname" placeholder="'),e.push(this.Ti("Organization Support")),e.push('" required autocomplete="off">\n          </div>\n          <div class="form-group">\n            <label>'),e.push(this.T("Email")),e.push('</label>\n            <input type="email" class="form-control" value="" name="email" placeholder="'),e.push(this.Ti("support@example.com")),e.push('" required autocomplete="off">\n          </div>\n          <div class="form-group">\n            <label>'),e.push(this.T("Password")),e.push('</label>\n            <input type="password" class="form-control" name="password" value="" required autocomplete="off">\n          </div>\n        </fieldset>\n      </div>\n      <div class="wizard-controls center">\n        <a class="btn btn--text btn--secondary" href="#getting_started/channel">'),e.push(this.T("Go Back")),e.push('</a>\n        <button class="btn btn--primary align-right">'),e.push(this.T("Connect")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="setup wizard hide js-probe">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Email Account")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Testing")),e.push(' <span class="js-email"></span>\n        </p>\n      </div>\n    </div>\n  </form>\n\n  <form class="setup wizard hide js-test">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Email Account")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Verifying...")),e.push('\n        </p>\n      </div>\n    </div>\n  </form>\n\n  <form class="setup wizard hide js-verify">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Email Account")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Verify sending and receiving")),e.push('\n        </p>\n      </div>\n    </div>\n  </form>\n\n  <form class="setup wizard hide js-inbound">\n    <div class="wizard-slide wizard-slide--large">\n      <h2>'),e.push(this.T("Email Inbound")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <div class="base-inbound-settings"></div>\n      </div>\n      <div class="wizard-controls center">\n        <a class="btn btn--text btn--secondary js-goToSlide" data-slide="js-intro">'),e.push(this.T("Go Back")),e.push('</a>\n        <button class="btn btn--primary align-right">'),e.push(this.T("Continue")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="setup wizard hide js-inbound-acknowledge">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Email Inbound")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <p class="js-message">'),e.push(this.T("We have already found %s email(s) in your mailbox. Zammad will move it all from your mailbox into Zammad.","x")),e.push('</p>\n      </div>\n      <div class="wizard-controls center">\n        <a class="btn btn--text btn--secondary js-goToSlide js-back" data-slide="js-intro">'),e.push(this.T("Go Back")),e.push('</a>\n        <button class="btn btn--primary js-goToSlide js-next align-right" data-slide="js-outbound">'),e.push(this.T("Continue")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="setup wizard hide js-outbound">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Email Outbound")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <div class="base-outbound-type"></div>\n        <div class="base-outbound-settings"></div>\n      </div>\n      <div class="wizard-controls center">\n        <a class="btn btn--text btn--secondary js-goToSlide" data-slide="js-inbound">'),e.push(this.T("Go Back")),e.push('</a>\n        <button class="btn btn--primary align-right">'),e.push(this.T("Continue")),e.push("</button>\n      </div>\n    </div>\n  </form>\n\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/email_notification"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n\n  <form class="setup wizard js-outbound">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Email Notification")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <div class="base-outbound-type"></div>\n        <div class="base-outbound-settings"></div>\n      </div>\n      <div class="wizard-controls center">\n        <a class="btn btn--text btn--secondary" href="#getting_started/base">'),e.push(this.T("Go Back")),e.push('</a>\n        <button class="btn btn--primary align-right">'),e.push(this.T("Continue")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="setup wizard hide js-test">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Email Notification")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Verifying...")),e.push("\n        </p>\n      </div>\n    </div>\n  </form>\n\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/email_pre_configured"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="main flex vertical centered darkBackground">\n  '),s.push(this.Icon("full-logo","wizard-logo")),s.push('\n  <form class="setup wizard js-channel">\n    <div class="wizard-slide">\n      <h2>'),s.push(this.T("Connect Channels")),s.push('</h2>\n      <div class="wizard-body vertical center">\n        <p class="text-center">'),s.push(this.T("Your Zammad as the following email address.")),s.push("</p>\n        "),this.addresses){for(s.push("\n          "),e=0,n=(i=this.addresses).length;e<n;e++)t=i[e],s.push("\n          <p>"),s.push(r(t.realname)),s.push(" &lt;"),s.push(r(t.email)),s.push("&gt;</p>\n          ");s.push("\n        ")}s.push('\n        <p class="text-center">'),s.push(this.T("If you want to use more email adresses, you can configure them later.")),s.push('</p>\n      </div>\n      <div class="wizard-controls center">\n        <a class="btn btn--text btn--secondary" href="#getting_started/base">'),s.push(this.T("Go Back")),s.push('</a>\n        <a class="btn align-right" href="#getting_started/finish">'),s.push(this.T("Finish")),s.push("</a>\n      </div>\n    </div>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/finish"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n  <form class="setup wizard">\n    <div class="wizard-slide">\n      <h2>'),e.push(this.T("Setup Finished")),e.push('</h2>\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span>'),e.push(this.T("Starting Zammad")),e.push("\n        </p>\n      </div>\n    </div>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/getting_started/intro"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n  <div class="setup wizard js-start">\n    <div class="wizard-slide">\n      <div class="wizard-body vertical centered">\n        <a class="btn btn--primary" href="#getting_started/admin">'),e.push(this.T("Setup new System")),e.push('</a>\n      </div>\n      <div class="wizard-aside">\n        '),e.push(this.T("Or")),e.push(' <span class="u-clickable u-highlight"><a href="#import">'),e.push(this.T("migrate from another system")),e.push("</a></span>.\n      </div>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/google/app_config"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="alert alert--danger hidden" role="alert"></div>\n<p>\n  '),e.push(this.T("The tutorial on how to manage a %s is hosted on our online documentation %l.","Google App","https://admin-docs.zammad.org/en/latest/channels/google.html")),e.push("\n</p>\n<fieldset>\n  <h2>"),e.push(this.T("Enter your %s App Keys","Google")),e.push('</h2>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="client_id">Google Client ID <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="client_id" type="text" name="client_id" value="'),this.external_credential&&this.external_credential.credentials&&e.push(n(this.external_credential.credentials.client_id)),e.push('" class="form-control" required autocomplete="off" >\n    </div>\n  </div>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="client_secret">Google Client Secret <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="client_secret" type="text" name="client_secret" value="'),this.external_credential&&this.external_credential.credentials&&e.push(n(this.external_credential.credentials.client_secret)),e.push('" class="form-control" required autocomplete="off" >\n    </div>\n  </div>\n  <h2>'),e.push(this.T("Your callback URL")),e.push('</h2>\n  <div class="input form-group">\n    <div class="controls">\n      <input class="form-control js-select" readonly value="'),e.push(n(this.callbackUrl)),e.push('">\n    </div>\n  </div>\n</fieldset>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/google/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),e.push(this.T("Gmail")),e.push(" <small>"),e.push(this.T("Accounts")),e.push('</small></h1>\n  </div>\n</div>\n\n<div class="page-content">\n  <div class="page-description">\n    <p>'),e.push(this.T("You can connect %s with Zammad. You need to connect your Zammad with %s first.","Google Accounts","Google")),e.push('</p>\n    <div class="btn btn--success js-configApp">'),e.push(this.T("Connect Google App")),e.push("</div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/google/list"]=function(t){t||(t={});var h=[],d=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u;if(h.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),h.push(this.T("Gmail")),h.push(" <small>"),h.push(this.T("Accounts")),h.push('</small></h1>\n  </div>\n\n  <div class="page-header-meta">\n    <a class="btn js-configApp">'),h.push(this.T("Configure App")),h.push('</a>\n    <a class="btn btn--success js-new">'),h.push(this.T("Add Account")),h.push("</a>\n  </div>\n</div>\n\n"),!_.isEmpty(this.not_used_email_addresses)){for(h.push('\n<div class="action">\n  <div class="action-flow">\n    <div class="action-block">\n      '),h.push(this.T("Notice")),h.push(": "),h.push(this.T("Unassigned email addresses, assign them to a channel or delete them.")),h.push('</h3>\n      <ul class="list">\n      '),i=0,o=(c=this.not_used_email_addresses).length;i<o;i++)e=c[i],h.push('\n        <li class="list-item" data-id="'),h.push(d(e.id)),h.push('">\n          <div class="list-item-name">\n            <a href="#" class="js-emailAddressEdit">'),h.push(d(e.realname)),h.push(" &lt;"),h.push(d(e.email)),h.push('&gt;</a>\n          </div>\n          <div class="list-item-delete js-emailAddressDelete">\n            '),h.push(this.Icon("diagonal-cross")),h.push("\n          </div>\n      ");h.push("\n      </ul>\n    </div>\n  </div>\n</div>\n")}for(h.push('\n\n<div class="page-content">\n'),s=0,a=(p=this.channels).length;s<a;s++){if(t=p[s],h.push('\n  <div class="action '),!0!==t.active&&h.push("is-inactive"),h.push('" data-id="'),h.push(d(t.id)),h.push('">\n    <div class="action-flow" style="width: 100%;">\n      <div class="action-block action-block--flex">\n        <div class="horizontal">\n          <h3>'),h.push(this.Icon("status",t.status_in+" inline")),h.push(" "),h.push(this.T("Inbound")),h.push("</h3>\n          "),!1!==t.preferences.editable&&(h.push('\n            <div class="js-editInbound btn btn--text space-left">'),h.push(this.T("Edit")),h.push("</div>\n          ")),h.push("\n        </div>\n\n        "),_.isEmpty(t.last_log_in)||(h.push('\n        <div class="alert alert--danger">\n          '),h.push(d(t.last_log_in)),h.push("\n        </div>\n        ")),h.push("\n\n        <hr>\n\n        <h3>"),h.push(this.T("Destination Group")),h.push('</h3>\n        <a href="#" class="js-channelGroupChange '),!1===t.group.active&&h.push("alert alert--danger"),h.push('">\n          '),n="",h.push("\n          "),t.group.displayName?(h.push("\n            "),n=t.group.displayName()):(h.push("\n            "),n=t.group),h.push("\n          "),h.push("\n          "),!1===t.group.active?(h.push("\n            "),h.push(this.T("%s is inactive, please select a active one.",n))):(h.push("\n            "),h.push(d(n))),h.push("\n          "),h.push(
'\n        </a>\n      </div>\n\n      <div class="action-block action-block--flex">\n        <div class="horizontal">\n          <h3>'),h.push(this.Icon("status",t.status_out+" inline")),h.push(" "),h.push(this.T("Outbound")),h.push("</h3>\n        </div>\n\n        "),_.isEmpty(t.last_log_out)||(h.push('\n        <div class="alert alert--danger">\n          '),h.push(d(t.last_log_out)),h.push("\n        </div>\n        ")),h.push("\n\n        <hr>\n\n        <h3>"),h.push(this.T("Email Address")),h.push('</h3>\n        <ul class="list">\n        '),_.isEmpty(t.email_addresses))h.push('\n          <li class="list-item">'),h.push(this.T("none")),h.push("\n        ");else{for(h.push("\n          "),r=0,l=(u=t.email_addresses).length;r<l;r++)e=u[r],h.push('\n            <li class="list-item" data-id="'),h.push(d(e.id)),h.push('">\n              <div class="list-item-name">'),h.push(d(e.email)),h.push('</div>\n              <div class="btn btn--text js-emailAddressEdit space-left space-right">'),h.push(this.T("Edit")),h.push("</div>\n              "),1<t.email_addresses.length&&(h.push('\n              <div class="list-item-delete js-emailAddressDelete">\n                '),h.push(this.Icon("diagonal-cross")),h.push("\n              </div>\n              ")),h.push("\n          ");h.push("\n        ")}h.push('\n        </ul>\n        <a class="text-muted js-emailAddressNew" href="#">+ '),h.push(this.T("Add")),h.push('</a>\n      </div>\n    </div>\n\n    <div class="action-controls">\n      '),t.options.backup_imap_classic&&(h.push('\n        <div class="btn js-rollbackMigration">'),h.push(this.T("Rollback migration")),h.push("</div>\n      ")),h.push("\n      "),!0===t.active?(h.push('\n        <div class="btn js-disable">'),h.push(this.T("Disable"))):(h.push('\n        <div class="btn btn--secondary js-enable">'),h.push(this.T("Enable"))),h.push("</div>\n      "),h.push('\n      <div class="btn btn--danger btn--secondary js-delete">'),h.push(this.T("Delete")),h.push("</div>\n    </div>\n  </div>\n")}h.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,h.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/import/index"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(e in i.push('<div class="main flex vertical centered darkBackground">\n  '),i.push(this.Icon("full-logo","wizard-logo")),i.push('\n  <div class="import wizard">\n    <div class="wizard-slide vertical">\n      <h2>'),i.push(this.T("Import from")),i.push('</h2>\n      <div class="wizard-body flex vertical justified">\n          '),n=this.items)t=n[e],i.push('\n            <a href="'),i.push(s(t.url)),i.push('" class="import-source centered '),i.push(s(t["class"])),i.push('">\n              '),t.image?(i.push('\n                <img class="logo" src="'),i.push(s(this.C("image_path")+"/"+t.image)),i.push('" alt="'),i.push(s(t.name)),i.push('" height="37">\n              ')):(i.push("\n                "),i.push(s(t.name)),i.push(" (Beta)\n              ")),i.push("\n            </a>\n          ");i.push('\n      </div>\n      <div class="wizard-controls horizontal center">\n        <a class="btn btn--text btn--secondary" href="#getting_started">'),i.push(this.T("Go Back")),i.push("</a>\n      </div>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/import/otrs"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n  <div class="import wizard">\n    <div class="wizard-slide vertical" data-slide="otrs-plugin">\n      <h2>'),e.push(this.T("Download %s Migration Plugin","OTRS")),e.push('</h2>\n      <div class="wizard-body flex vertical justified">\n        <p>\n          '),e.push(this.T("Download and install the %s Migration Plugin on your %s instance.","OTRS","OTRS")),e.push(':\n        </p>\n        <a class="btn btn--primary btn--download js-download" target=_blank href="https://addons.znuny.com/api/addon_repos/public/1085/latest" download>'),e.push(this.Icon("download")),e.push(" "),e.push(this.T("Migration Plugin for %s","OTRS 6")),e.push('</a>\n        <a class="btn btn--primary btn--download js-download" target=_blank href="https://addons.znuny.com/api/addon_repos/public/617/latest" download>'),e.push(this.Icon("download")),e.push(" "),e.push(this.T("Migration Plugin for %s","OTRS 5")),e.push('</a>\n        <a class="btn btn--primary btn--download js-download" target=_blank href="https://addons.znuny.com/api/addon_repos/public/383/latest" download>'),e.push(this.Icon("download")),e.push(" "),e.push(this.T("Migration Plugin for %s","OTRS 4")),e.push('</a>\n        <a class="btn btn--primary btn--download js-download" target=_blank href="https://addons.znuny.com/api/addon_repos/public/287/latest" download>'),e.push(this.Icon("download")),e.push(" "),e.push(this.T("Migration Plugin for %s","OTRS 3.3-3.1")),e.push('</a>\n      </div>\n      <div class="wizard-controls horizontal center">\n        <a class="btn btn--text btn--secondary" href="#import">'),e.push(this.T("Go Back")),e.push('</a>\n        <div class="btn btn--primary align-right hide js-otrs-link">'),e.push(this.T("Next")),e.push('</div>\n      </div>\n    </div>\n    <div class="wizard-slide vertical hide" data-slide="otrs-link">\n      <h2>'),e.push(this.T("Link %s","OTRS")),e.push('</h2>\n      <div class="wizard-body flex vertical justified">\n        <p>\n          '),e.push(this.T("Enter the link provided by the plugin at the end of the installation to link the two systems")),e.push(':\n        </p>\n        <div class="form-group">\n          <label for="otrs-link">'),e.push(this.T("Link %s","OTRS")),e.push('</label>\n          <div class="u-positionOrigin">\n            <input type="url" id="otrs-link" class="form-control" placeholder="http://example.com/otrs/public.pl?Action=ZammadMigrator;Key=31337" name="url">\n            <div class="input-feedback centered">\n              <div class="small loading icon"></div>\n              '),e.push(this.Icon("diagonal-cross","icon-error")),e.push("\n              "),e.push(this.Icon("checkmark")),e.push('\n            </div>\n          </div>\n          <div class="error otrs-link-error"></div>\n        </div>\n      </div>\n      <div class="wizard-controls horizontal center">\n        <a class="btn btn--text btn--secondary" href="#import">'),e.push(this.T("Go Back")),e.push('</a>\n        <div class="btn btn--primary align-right hide js-migration-check">'),e.push(this.T("Migrate %s Data","OTRS")),e.push('</div>\n      </div>\n    </div>\n\n    <div class="wizard-slide vertical hide" data-slide="otrs-import">\n      <h2>'),e.push(this.T("%s Migration","OTRS")),e.push('</h2>\n      <div class="alert alert--danger hide js-error" role="alert"></div>\n      <div class="wizard-body flex vertical justified">\n        <table class="progressTable">\n          <tr class="js-config">\n            <td>\n            <td><span>'),e.push(this.T("Configuration")),e.push('</span>\n            <td class="progressTable-progressCell">\n              <div class="horizontal center">\n                <div class="flex"><progress value="1"></progress></div>\n                '),e.push(this.Icon("checkmark")),e.push('\n              </div>\n          </tr>\n          <tr class="js-base">\n            <td><span class="js-done">-</span>/<span class="js-total">-</span>\n            <td><span>'),e.push(this.T("Base Objects")),e.push('</span>\n            <td class="progressTable-progressCell">\n              <div class="horizontal center">\n                <div class="flex"><progress max="42" value="42"></progress></div>\n                '),e.push(this.Icon("checkmark")),e.push('\n              </div>\n          </tr>\n          <tr class="js-user">\n            <td><span class="js-done">-</span>/<span class="js-total">-</span>\n            <td><span>'),e.push(this.T("Users")),e.push('</span>\n            <td class="progressTable-progressCell">\n              <div class="horizontal center">\n                <div class="flex"><progress max="42" value="42"></progress></div>\n                '),e.push(this.Icon("checkmark")),e.push('\n              </div>\n          </tr>\n          <tr class="js-ticket">\n            <td><span class="js-done">-</span>/<span class="js-total">-</span>\n            <td><span>'),e.push(this.T("Tickets")),e.push('</span>\n            <td class="progressTable-progressCell">\n              <div class="horizontal center">\n                <div class="flex"><progress max="134318" value="134318"></progress></div>\n                '),e.push(this.Icon("checkmark")),e.push('\n              </div>\n          </tr>\n        </table>\n      </div>\n      <div class="wizard-controls horizontal center">\n        <a href="#" class="btn btn--primary align-right hide js-finished">'),e.push(this.T("done")),e.push('</a>\n      </div>\n    </div>\n\n    <div class="wizard-slide vertical hide" data-slide="otrs-import-notice">\n      <h2>'),e.push(this.T("Notice")),e.push('</h2>\n      <div class="wizard-body flex vertical justified">\n        <p class="js-otrsProcesses hide">'),e.push(this.T("We detected OTRS BPM processes which can't get imported into Zammad, since we currently don't support these kind of workflows.")),e.push('</p>\n        <p class="js-otrsDynamicFields hide">'),e.push(this.T("We found a lot of dynamic fields which are not common in Zammad, as we follow a different approach to ticket attributes. Zammad uses also tags in addition to custom fields to classify tickets. This difference can create a new philosophy of your ticket attributes / tags compared to your current use of dynamic fields in OTRS.")),e.push('</p>\n      </div>\n      <div class="wizard-controls horizontal center">\n        <a class="btn btn--text btn--secondary" href="#import">'),e.push(this.T("Go Back")),e.push('</a>\n        <a href="#" class="btn btn--primary align-right js-migration-start">'),e.push(this.T("Continue anyway")),e.push("</a>\n      </div>\n    </div>\n\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/import/zendesk"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex vertical centered darkBackground">\n  '),e.push(this.Icon("full-logo","wizard-logo")),e.push('\n  <div class="import wizard">\n    <div class="wizard-slide vertical" data-slide="zendesk-url">\n      <h2>'),e.push(this.T("%s URL","Zendesk")),e.push('</h2>\n      <div class="wizard-body flex vertical justified">\n        <p>\n          '),e.push(this.T("Enter the URL of your %s system","Zendesk")),e.push(':\n        </p>\n        <div class="form-group">\n          <label for="zendesk-url">'),e.push(this.T("%s URL","Zendesk")),e.push('</label>\n          <div class="u-positionOrigin">\n            <input type="url" id="zendesk-url" class="form-control" placeholder="https://example.zendesk.com/" name="zendesk-url">\n            <div class="input-feedback centered">\n              <div class="small loading icon"></div>\n              '),e.push(this.Icon("diagonal-cross","icon-error")),e.push("\n              "),e.push(this.Icon("checkmark")),e.push('\n            </div>\n          </div>\n          <div class="error zendesk-url-error"></div>\n        </div>\n      </div>\n      <div class="wizard-controls horizontal center">\n        <a class="btn btn--text btn--secondary" href="#import">'),e.push(this.T("Go Back")),e.push('</a>\n        <div class="btn btn--primary align-right hide js-zendesk-credentials" data-target="zendesk-credentials">'),e.push(this.T("Enter credentials")),e.push('</div>\n      </div>\n    </div>\n\n    <div class="wizard-slide vertical hide" data-slide="zendesk-credentials">\n      <h2>'),e.push(this.T("%s credentials","Zendesk")),e.push('</h2>\n      <div class="wizard-body flex vertical justified">\n        <p>\n          <a class="js-zendeskUrlApiToken" href="#" target="_blank">'),e.push(this.T("Enter your email address and the %s API token gained from your admin interface.","Zendesk")),e.push("</a>\n        </p>\n        <p>\n          "),e.push(this.T("Attention: These will be your login password after the import is completed.")),e.push('\n        </p>\n        <div class="form-group">\n          <label for="zendesk-email">'),e.push(this.T("Email")),e.push('</label>\n          <div class="u-positionOrigin">\n            <input type="email" id="zendesk-email" class="form-control" placeholder="admin@example.com" name="zendesk-email">\n          </div>\n          <label for="zendesk-api-token">'),e.push(this.T("API token")),e.push('</label>\n          <div class="u-positionOrigin">\n            <input type="email" id="zendesk-api-token" class="form-control" placeholder="XYZ3133723421111" name="zendesk-api-token">\n            <div class="input-feedback centered">\n              <div class="small loading icon"></div>\n              '),e.push(this.Icon("diagonal-cross","icon-error")),e.push("\n              "),e.push(this.Icon("checkmark")),e.push('\n            </div>\n          </div>\n          <div class="error zendesk-api-token-error"></div>\n        </div>\n      </div>\n      <div class="wizard-controls horizontal center">\n        <a class="btn btn--text btn--secondary" href="#import">'),e.push(this.T("Go Back")),e.push('</a>\n        <div class="btn btn--primary align-right hide js-migration-start" data-target="zendesk-start-migration">'),e.push(this.T("Migrate %s Data","Zendesk")),e.push('</div>\n      </div>\n    </div>\n\n    <div class="wizard-slide vertical hide" data-slide="zendesk-import">\n      <h2>'),e.push(this.T("%s Migration","Zendesk")),e.push('</h2>\n      <div class="alert alert--danger hide js-error" role="alert"></div>\n      <div class="alert alert--info hide js-ticket-count-info" role="alert">'),e.push(this.T("There are more than 1000 tickets in the Zendesk system. Due to API rate limit restrictions we can't get the exact number of tickets yet and have to fetch them in batches of 1000. This might take some time, better grab a cup of coffee. The total number of tickets gets updated as soon as the currently known number is surpassed.")),e.push('</div>\n      <div class="wizard-body flex vertical justified">\n        <table class="progressTable">\n          <tr class="js-groups">\n            <td><span class="js-done">-</span>/<span class="js-total">-</span>\n            <td><span>'),e.push(this.T("Groups")),e.push('</span>\n            <td class="progressTable-progressCell">\n              <div class="horizontal center">\n                <div class="flex"><progress max="42" value="42"></progress></div>\n                '),e.push(this.Icon("checkmark")),e.push('\n              </div>\n          </tr>\n          <tr class="js-organizations">\n            <td><span class="js-done">-</span>/<span class="js-total">-</span>\n            <td><span>'),e.push(this.T("Organizations")),e.push('</span>\n            <td class="progressTable-progressCell">\n              <div class="horizontal center">\n                <div class="flex"><progress max="42" value="42"></progress></div>\n                '),e.push(this.Icon("checkmark")),e.push('\n              </div>\n          </tr>\n          <tr class="js-users">\n            <td><span class="js-done">-</span>/<span class="js-total">-</span>\n            <td><span>'),e.push(this.T("Users")),e.push('</span>\n            <td class="progressTable-progressCell">\n              <div class="horizontal center">\n                <div class="flex"><progress max="42" value="42"></progress></div>\n                '),e.push(this.Icon("checkmark")),e.push('\n              </div>\n          </tr>\n          <tr class="js-tickets">\n            <td><span class="js-done">-</span>/<span class="js-total">-</span>\n            <td><span>'),e.push(this.T("Tickets")),e.push('</span>\n            <td class="progressTable-progressCell">\n              <div class="horizontal center">\n                <div class="flex"><progress max="42" value="42"></progress></div>\n                '),e.push(this.Icon("checkmark")),e.push('\n              </div>\n          </tr>\n        </table>\n      </div>\n      <div class="wizard-controls horizontal center">\n        <a href="#" class="btn btn--primary align-right hide js-finished">'),e.push(this.T("done")),e.push("</a>\n      </div>\n    </div>\n\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/base"]=function(t){t||(t={});var s=[],e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="page-header">\n  <div class="page-header-title">\n    <div class="zammad-switch zammad-switch--small js-switch">\n       <input name="'),s.push(this.feature),s.push('" type="checkbox" id="setting-switch" '),this.featureEnabled&&s.push("checked"),s.push('>\n       <label for="setting-switch"></label>\n    </div>\n    <h1>'),s.push(this.T(this.header)),s.push('</h1>\n  </div>\n</div>\n<div class="page-content">\n  '),this.description){for(s.push("\n    "),t=0,n=(i=this.description).length;t<n;t++)e=i[t],s.push("\n      <p>"),s.push(this.T.apply(this,e)),s.push("</p>\n    ");s.push("\n  ")}s.push('\n  <div class="js-form"></div>\n  <div class="js-scriptSnippedPre"></div>\n  <div class="js-scriptSnipped"></div>\n  <div class="js-scriptSnippedExtended"></div>\n  <div class="js-scriptSnippedPost"></div>\n  <div class="js-log"></div>\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/clearbit"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(l.push('<form>\n\n  <div class="settings-entry">\n    <table class="settings-list js-baseSync" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="15%">'),l.push(this.T("Title")),l.push('\n          <th width="50%">'),l.push(this.T("Value")),l.push('\n          <th width="35%">'),l.push(this.T("Description")),l.push("\n      </thead>\n      <tbody>\n"),e=0,n=(i=this.settings).length;e<n;e++)o=i[e],l.push("\n        <tr>\n          <td>"),l.push(this.T(o.display)),l.push('\n          <td data-name="'),l.push(o.name),l.push('">\n          <td><p class="help-text">'),l.push(this.RichText(o.note)),l.push("</p>\n");for(a in l.push("\n      </tbody>\n    </table>\n  </div>\n\n  <h2>"),l.push(this.T("Mapping")),l.push("</h2>\n\n  <p>"),l.push(this.T("What values of %s should be synced to users.","Clearbit")),l.push('</p>\n\n  <div class="settings-entry">\n    <table class="settings-list js-userSync" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="45%">'),l.push(this.T("Clearbit")),l.push('\n          <th width="45%">'),l.push(this.T("Zammad")),l.push('\n          <th width="10%">'),l.push(this.T("Action")),l.push("\n      </thead>\n      <tbody>\n"),s=this.config.user_sync)t=s[a],l.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="source" value="'),l.push(c(a)),l.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="destination" value="'),l.push(c(t)),l.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text js-remove">'),l.push(this.Icon("trash")),l.push(" "),l.push(this.T("Remove")),l.push("</div>\n");for(a in l.push('\n        <tr class="js-new">\n          <td class="settings-list-control-cell"><input name="source" value="" placeholder="person.attribute" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="destination" value="" placeholder="user.attribute" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-add">'),l.push(this.Icon("plus-small")),l.push(" "),l.push(this.T("Add")),l.push("</div>\n      </tbody>\n    </table>\n  </div>\n\n  <p>"),l.push(this.T("What values of %s should be synced to organization.","Clearbit")),l.push('</p>\n\n  <div class="settings-entry">\n    <table class="settings-list js-organizationSync" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="45%">'),l.push(this.T("Clearbit")),l.push('\n          <th width="45%">'),l.push(this.T("Zammad")),l.push('\n          <th width="10%">'),l.push(this.T("Action")),l.push("\n      </thead>\n      <tbody>\n"),r=this.config.organization_sync)t=r[a],l.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="source" value="'),l.push(c(a)),l.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="destination" value="'),l.push(c(t)),l.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text js-remove">'),l.push(this.Icon("trash")),l.push(" "),l.push(this.T("Remove")),l.push("</div>\n");l.push('\n        <tr class="js-new">\n          <td class="settings-list-control-cell"><input name="source" value="" placeholder="company.attribute" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="destination" value="" placeholder="organization.attribute" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-add">'),l.push(this.Icon("plus-small")),l.push(" "),l.push(this.T("Add")),l.push('</div>\n      </tbody>\n    </table>\n  </div>\n  <button type="submit" class="btn btn--primary js-submit">'),l.push(this.T("Save")),l.push("</button>\n</form>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/cti"]=function(t){t||(t={});var p=[],u=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c;for(p.push("<form>\n\n  <h2>"),p.push(this.T("Settings")),p.push("</h2>\n\n  <p>"),p.push(this.T("You need to configure the Zammad endpoints in the %s","PBX")),p.push(':<p>\n\n  <div class="settings-entry">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="20%">'),p.push(this.T("Type")),p.push('\n          <th width="80%">'),p.push(this.T("URL")),p.push('\n      </thead>\n      <tbody>\n        <tr>\n          <td class="settings-list-row-control">'),p.push(this.T("Endpoint")),p.push('\n          <td class="settings-list-control-cell"><input type="url" class="form-control form-control--small js-select" readonly value="'),p.push(this.C("http_type")),p.push("://"),p.push(this.C("fqdn")),p.push("/api/v1/cti/"),p.push(u(this.cti_token)),p.push('">\n      </tbody>\n    </table>\n  </div>\n\n  <h2>'),p.push(this.T("Inbound")),p.push("</h2>\n\n  <p>"),p.push(this.T("Blocked caller ids based on sender caller id.")),p.push('\n\n  <div class="settings-entry">\n    <table class="settings-list js-inboundBlockCallerId" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="50%">'),p.push(this.T("Caller id to block")),p.push('\n          <th width="40%">'),p.push(this.T("Note")),p.push('\n          <th width="10%">'),p.push(this.T("Action")),p.push("\n      </thead>\n      <tbody>\n"),t=0,i=(o=this.config.inbound.block_caller_ids).length;t<i;t++)c=o[t],p.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="caller_id" value="'),p.push(u(c.caller_id)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="'),p.push(u(c.note)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text js-remove">'),p.push(this.Icon("trash")),p.push(" "),p.push(this.T("Remove")),p.push("</div>\n");for(p.push('\n        <tr>\n          <td class="settings-list-control-cell"><input name="caller_id" value="" placeholder="4930609854189" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="" placeholder="'),p.push(this.Ti("my own note")),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-add">'),p.push(this.Icon("plus-small")),p.push(" "),p.push(this.T("Add")),p.push("</div>\n      </tbody>\n    </table>\n  </div>\n\n  <h2>"),p.push(this.T("Outbound")),p.push("</h2>\n\n  <p>"),p.push(this.T("Set caller id of outbound calls based on destination caller id.")),p.push('\n\n  <div class="settings-entry js-outboundRouting">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="30%">'),p.push(this.T("Destination caller id")),p.push('\n          <th width="30%">'),p.push(this.T("Set outbound caller id")),p.push('\n          <th width="30%">'),p.push(this.T("Note")),p.push('\n          <th width="10%">'),p.push(this.T("Action")),p.push("\n      </thead>\n      <tbody>\n"),e=0,s=(a=this.config.outbound.routing_table).length;e<s;e++)c=a[e],p.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="dest" value="'),p.push(u(c.dest)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="caller_id" value="'),p.push(u(c.caller_id)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="'),p.push(u(c.note)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text js-remove">'),p.push(this.Icon("trash")),p.push(" "),p.push(this.T("Remove")),p.push("</div>\n");for(p.push('\n        <tr>\n          <td class="settings-list-control-cell"><input name="dest" value="" placeholder="49* or 3230123456789" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="caller_id" value="" placeholder="4930609854189" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="" placeholder="'),p.push(this.Ti("my own note")),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-add">'),p.push(this.Icon("plus-small")),p.push(" "),p.push(this.T("Add")),p.push("</div>\n      </tbody>\n    </table>\n  </div>\n\n  <p>"),p.push(this.T("Default caller id.")),p.push('\n\n  <div class="settings-entry">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="50%">'),p.push(this.T("Default caller id")),p.push('\n          <th width="50%">'),p.push(this.T("Note")),p.push('\n      </thead>\n      <tbody>\n        <tr>\n          <td class="settings-list-control-cell"><input name="default_caller_id" value="'),p.push(u(this.config.outbound.default_caller_id)),p.push('" placeholder="4930609854189" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control">'),p.push(this.T("Default caller id for outbound calls.")),p.push("\n      </tbody>\n    </table>\n  </div>\n\n  <h2>"),p.push(this.T("Notify Map")),p.push("</h2>\n\n  <p>"),p.push(this.T("Notify certain users by matching caller id.")),p.push(this.T("If no mapping is defined, all user get notified about any event.")),p.push('\n\n  <div class="settings-entry">\n    <table class="settings-list js-notifyMap" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="30%">'),p.push(this.T("Destination caller id or queue")),p.push('\n          <th width="60%">'),p.push(this.T("Agents")),p.push('\n          <th width="10%">'),p.push(this.T("Action")),p.push("\n      </thead>\n      <tbody>\n"),n=0,r=(l=this.config.notify_map).length;n<r;n++)c=l[n],p.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="queue" value="'),p.push(u(c.queue)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell js-userSelector">\n          <td class="settings-list-row-control"><div class="btn btn--text js-removeMap">'),p.push(this.Icon("trash")),p.push(" "),p.push(this.T("Remove")),p.push("</div>\n");p.push('\n        <tr>\n          <td class="settings-list-control-cell"><input name="queue" value="" placeholder="4930609854189" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell js-userSelectorBlank">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-addMap">'),p.push(this.Icon("plus-small")),p.push(" "),p.push(this.T("Add")),p.push('</div>\n      </tbody>\n    </table>\n  </div>\n\n  <button type="submit" class="btn btn--primary js-submit">'),p.push(this.T("Save")),p.push("</button>\n</form>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/exchange"]=function(t){t||(t={});var a=[],l=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o;if(a.push('<div class="js-lastImport"></div>\n<div class="js-notConfigured">\n  <p>'),a.push(this.T("No %s configured.","Exchange")),a.push('</p>\n  <button type="submit" class="btn btn--primary js-wizard">'),a.push(this.T("Configure")),a.push('</button>\n</div>\n<div class="js-summary hide">\n  <h2>'),a.push(this.T("Settings")),a.push('</h2>\n  <table class="settings-list" style="width: 100%;">\n    <thead>\n      <tr>\n        <th width="30%">'),a.push(this.T("Name")),a.push('\n        <th width="70%">'),a.push(this.T("Value")),a.push('\n    </thead>\n    <tbody>\n      <tr>\n        <td class="settings-list-row-control">'),a.push(this.T("Endpoint")),a.push('\n        <td class="settings-list-row-control">'),a.push(l(this.config.endpoint)),a.push('\n      <tbody>\n        <tr>\n          <td class="settings-list-row-control">'),a.push(this.T("User")),a.push('\n          <td class="settings-list-row-control">'),a.push(l(this.config.user)),a.push(
'\n        <tr>\n          <td class="settings-list-row-control">'),a.push(this.T("Password")),a.push('\n          <td class="settings-list-row-control">'),a.push(l(this.M(this.config.password))),a.push("\n    </tbody>\n  </table>\n\n  <h2>"),a.push(this.T("Mapping")),a.push("</h2>\n\n  <h3>"),a.push(this.T("Folders")),a.push("</h3>\n  "),_.isEmpty(this.folders))a.push('\n    <table class="settings-list settings-list--stretch settings-list--placeholder">\n      <thead><tr><th>'),a.push(this.T("No Entries")),a.push("\n    </table>\n  ");else{for(a.push('\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th>'),a.push(this.T("Folder")),a.push("\n        "),e=0,i=(s=this.folders).length;e<i;e++)t=s[e],a.push('\n          <tr>\n            <td class="settings-list-row-control">'),a.push(l(t)),a.push("\n        ");a.push("\n      </thead>\n      <tbody>\n    </table>\n  ")}if(a.push("\n\n  <h3>"),a.push(this.T("User")),a.push("</h3>\n  "),_.isEmpty(this.config.attributes))a.push('\n    <table class="settings-list settings-list--stretch settings-list--placeholder">\n      <thead><tr><th>'),a.push(this.T("No Entries")),a.push("\n    </table>\n  ");else{for(n in a.push('\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="40%">'),a.push(this.T("Exchange")),a.push('\n          <th width="60%">'),a.push(this.T("Zammad")),a.push("\n        "),r=this.config.attributes)o=r[n],a.push('\n          <tr>\n            <td class="settings-list-row-control">'),a.push(l(n)),a.push('\n            <td class="settings-list-row-control">'),a.push(l(o)),a.push("\n        ");a.push("\n      </thead>\n      <tbody>\n    </table>\n  ")}a.push('\n\n  <button type="submit" class="btn btn--primary js-wizard">'),a.push(this.T("Change")),a.push("</button>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,a.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/exchange_certificate_issue"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form class="modal-content setup wizard hide '),e.push(n(this.wizardClass)),e.push('">\n  <input type="hidden" name="disable_ssl_verify" value="1">\n  <input type="hidden" name="endpoint" value="'),e.push(n(this.endpoint)),e.push('">\n  <input type="hidden" name="user" value="'),e.push(n(this.user)),e.push('">\n  <input type="hidden" name="password" value="'),e.push(n(this.password)),e.push('">\n  <div class="modal-header">\n    <div class="modal-close js-close">\n      '),e.push(this.Icon("diagonal-cross")),e.push('\n    </div>\n    <h1 class="modal-title">'),e.push(this.T("Your connection is not private")),e.push('</h1>\n  </div>\n  <div class="modal-body">\n    <div class="wizard-body vertical">\n      <p>'),e.push(this.T('The certificate of the domain |%s| could not be verified. This may allow hackers to steal your credentials. If you are sure that you are using a self-signed certificate, you can press "Proceed". Otherwise, please "Cancel".',this.domain)),e.push('</p>\n    </div>\n  </div>\n  <div class="modal-footer">\n    <div class="modal-leftFooter">\n      <button class="btn btn--text btn--danger btn--secondary js-submit">'),e.push(this.T("Proceed")),e.push('</button>\n    </div>\n    <div class="modal-rightFooter">\n      <a class="btn btn--primary align-right js-cancelSsl">'),e.push(this.T("Cancel")),e.push("</a>\n    </div>\n  </div>\n</form>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/exchange_last_import"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;if(i.push('<div class="box box--message">\n  <h2>'),i.push(this.T("Last sync")),i.push("</h2>\n  "),_.isEmpty(this.job.started_at))i.push("\n    "),this.job.result&&this.job.result.error?(i.push('\n        <div class="alert alert--danger" role="alert">'),i.push(this.T("An error occurred: %s",this.job.result.error)),i.push("</div>\n    ")):this.job.result&&this.job.result.info?(i.push('\n        <div class="alert alert--info" role="alert">'),i.push(this.T("Info: %s",this.job.result.info)),i.push("</div>\n    ")):(i.push("\n      <p>"),i.push(this.T("Job is waiting to get started...")),i.push("</p>\n    ")),i.push("\n  ");else{if(i.push("\n    "),this.job.finished_at?(i.push("\n      <p>"),i.push(this.Ttimestamp(this.job.started_at)),i.push(" - "),i.push(this.Ttimestamp(this.job.finished_at)),i.push("</p>\n      "),this.job.result&&this.job.result.error?(i.push('\n        <div class="alert alert--danger" role="alert">'),i.push(this.T("An error occurred: %s",this.job.result.error)),i.push("</div>\n      ")):this.job.result&&this.job.result.info&&(i.push('\n        <div class="alert alert--info" role="alert">'),i.push(this.T("Info: %s",this.job.result.info)),i.push("</div>\n      "))):(i.push("\n      "),this.job.result&&this.job.result.error?(i.push("\n        <p>"),i.push(this.Ttimestamp(this.job.started_at)),i.push('</p>\n        <div class="alert alert--danger" role="alert">'),i.push(this.T("An error occurred: %s",this.job.result.error)),i.push("</div>\n      ")):this.job.result&&!this.job.result.sum?(i.push("\n        <p>"),i.push(this.Ttimestamp(this.job.started_at)),i.push(" - "),i.push(this.T("Counting entries. This may take a while.")),i.push("</p>\n      ")):(i.push("\n        <p>"),i.push(this.Ttimestamp(this.job.started_at)),i.push(" - "),i.push(this.T("Running...")),i.push('</p>\n        <div class="flex">\n          <progress max="'),i.push(s(this.job.result.total)),i.push('" value="'),i.push(s(this.job.result.sum)),i.push('"></progress>\n        </div>\n      '))),i.push("\n    "),i.push("\n    "),!_.isEmpty(this.job.result)&&this.job.result.sum){if(i.push("\n      <ul>\n        <li>"),i.push(this.T("%s user to %s user","Exchange","Zammad")),i.push(" ("),i.push(s(this.job.result.sum)),i.push("/"),i.push(s(this.job.result.total)),i.push("):\n          <ul>\n            <li>"),i.push(this.T("Users")),i.push(": "),i.push(s(this.job.result.created)),i.push(" "),i.push(this.T("created")),i.push(", "),i.push(s(this.job.result.updated)),i.push(" "),i.push(this.T("updated")),i.push(", "),i.push(s(this.job.result.unchanged)),i.push(" "),i.push(this.T("untouched")),i.push(", "),i.push(s(this.job.result.skipped)),i.push(" "),i.push(this.T("skipped")),i.push(", "),i.push(s(this.job.result.failed)),i.push(" "),i.push(this.T("failed")),i.push("\n          </ul>\n          </li>\n          "),!_.isEmpty(this.job.result.folders)){for(t in i.push("\n            <li>"),i.push(this.T("%s folders","Exchange")),i.push(":\n              <ul>\n                "),e=this.job.result.folders)n=e[t],i.push("\n                  <li>"),i.push(t),i.push(": "),i.push(s(n.created)),i.push(" "),i.push(this.T("created")),i.push(", "),i.push(s(n.updated)),i.push(" "),i.push(this.T("updated")),i.push(", "),i.push(s(n.unchanged)),i.push(" "),i.push(this.T("untouched")),i.push(", "),i.push(s(n.failed)),i.push(" "),i.push(this.T("failed")),i.push("\n                ");i.push("\n              </ul>\n            </li>\n          ")}i.push("\n      </ul>\n    ")}i.push("\n    "),this.job.finished_at&&(i.push('\n      <button type="submit" class="btn btn--primary js-start-sync">'),i.push(this.T("Start new")),i.push("</button>\n    ")),i.push("\n  ")}i.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/exchange_summary"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;if(i.push("<ul>\n  <li>"),i.push(this.T("%s user to %s user","Exchange","Zammad")),i.push(" ("),i.push(s(this.job.result.total)),i.push("):\n    <ul>\n      <li>"),i.push(this.T("Users")),i.push(": "),i.push(s(this.job.result.created)),i.push(" "),i.push(this.T("created")),i.push(", "),i.push(s(this.job.result.updated)),i.push(" "),i.push(this.T("updated")),i.push(", "),i.push(s(this.job.result.unchanged)),i.push(" "),i.push(this.T("untouched")),i.push(", "),i.push(s(this.job.result.skipped)),i.push(" "),i.push(this.T("skipped")),i.push(", "),i.push(s(this.job.result.failed)),i.push(" "),i.push(this.T("failed")),i.push("\n    </ul>\n  </li>\n  "),!_.isEmpty(this.job.result.folders)){for(t in i.push("\n    <li>"),i.push(this.T("%s folders","Exchange")),i.push(":\n      <ul>\n        "),e=this.job.result.folders)n=e[t],i.push("\n          <li>"),i.push(t),i.push(": "),i.push(s(n.created)),i.push(" "),i.push(this.T("created")),i.push(", "),i.push(s(n.updated)),i.push(" "),i.push(this.T("updated")),i.push(", "),i.push(s(n.unchanged)),i.push(" "),i.push(this.T("untouched")),i.push(", "),i.push(s(n.failed)),i.push(" "),i.push(this.T("failed")),i.push("\n        ");i.push("\n      </ul>\n    </li>\n  ")}i.push("\n</ul>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/exchange_user_attribute_row"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<tr class="js-entry">\n  <td style="max-width: 240px" class="settings-list-control-cell js-exchangeAttribute">\n  <td class="settings-list-control-cell js-userAttribute">\n  <td class="settings-list-row-control">\n    <div class="btn btn--text js-remove">\n      '),e.push(this.Icon("trash")),e.push(" "),e.push(this.T("Remove")),e.push("\n    </div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/exchange_wizard"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="modal-dialog">\n\n  <form class="modal-content setup wizard js-discover">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Exchange")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <table class="settings-list" style="width: 100%;">\n          <thead>\n            <tr>\n              <th width="30%">'),e.push(this.T("Name")),e.push('\n              <th width="70%">'),e.push(this.T("Value")),e.push('\n          </thead>\n          <tbody>\n            <tr>\n              <td class="settings-list-row-control">'),e.push(this.T("User")),e.push('\n              <td class="settings-list-control-cell"><input type="text" name="user" class="form-control form-control--small js-user" value="" placeholder="user@your-exchange.tld" autocomplete="off" required>\n            <tr>\n              <td class="settings-list-row-control">'),e.push(this.T("Password")),e.push('\n              <td class="settings-list-control-cell"><input type="password" name="password" class="form-control form-control--small js-password" value="" placeholder="" autocomplete="new-password" required>\n          </tbody>\n        </table>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submit">'),e.push(this.T("Connect")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <div class="js-certificateIssuePlaceholder"></div>\n\n  <form class="modal-content setup wizard hide js-connect">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Exchange")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Connecting ...")),e.push('\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-bind">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Exchange")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <table class="settings-list" style="width: 100%;">\n          <thead>\n            <tr>\n              <th width="30%">'),e.push(this.T("Name")),e.push('\n              <th width="70%">'),e.push(this.T("Value")),e.push('\n          </thead>\n          <tbody>\n            <tr>\n              <td class="settings-list-row-control">'),e.push(this.T("Endpoint")),e.push('\n              <td class="settings-list-control-cell"><input type="text" name="endpoint" class="form-control form-control--small" value="" placeholder="https://outlook.office365.com/EWS/Exchange.asmx" autocomplete="off" required>\n\n            <tr>\n              <td class="settings-list-row-control">'),e.push(this.T("User")),e.push('\n              <td class="settings-list-control-cell"><input type="text" name="user" class="form-control form-control--small js-user" value="" placeholder="" autocomplete="off" required>\n            <tr>\n              <td class="settings-list-row-control">'),e.push(this.T("Password")),e.push('\n              <td class="settings-list-control-cell"><input type="password" name="password" class="form-control form-control--small js-password" value="" placeholder="" autocomplete="new-password" required>\n          </tbody>\n        </table>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submit">'),e.push(this.T("Connect")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-folders">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Exchange")),e.push(" "),e.push(this.T("Folders")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n\n        <div class="column_select form-group">\n            <div class="formGroup-label">\n                <label for="folders">'),e.push(this.T("Import %s","Folders")),e.push('</label>\n            </div>\n            <div class="controls js-foldersSelect">\n            </div>\n        </div>\n\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <a class="btn btn--text btn--secondary js-goToSlide align-left" data-slide="js-bind">'),e.push(this.T("Go Back")),e.push('</a>\n      </div>\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submitTry is-disabled">'),e.push(this.T("Continue")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-analyze">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Exchange")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Analyzing structure...")),e.push('\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <div class="modal-content setup wizard hide js-mapping">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Exchange")),e.push(" "),e.push(this.T("Mapping")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n\n        <h2>'),e.push(this.T("User")),e.push('</h2>\n        <form class="js-userMappingForm">\n          <table class="settings-list js-userAttributeMap" style="width: 100%;">\n            <colgroup>\n              <col width="240">\n              <col>\n              <col>\n            </colgroup>\n            <thead>\n              <tr>\n                <th>'),e.push(this.T("%s Attribute","Exchange")),e.push("\n                <th>"),e.push(this.T("%s Attribute","Zammad")),e.push("\n                <th>"),e.push(this.T("Action")),e.push('\n            </thead>\n            <tbody>\n              <tr>\n                <td class="settings-list-row-control" colspan="3">\n                  <div class="btn btn--text btn--create js-add">\n                    '),e.push(this.Icon("plus-small")),e.push(" "),e.push(this.T("Add")),e.push('\n                  </div>\n            </tbody>\n          </table>\n        </form>\n\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <a class="btn btn--text btn--secondary js-goToSlide align-left" data-slide="js-bind">'),e.push(this.T("Go Back")),e.push('</a>\n      </div>\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submitTry">'),e.push(this.T("Continue")),e.push('</button>\n      </div>\n    </div>\n  </div>\n\n  <form class="modal-content setup wizard hide js-dry">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Exchange")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="js-preprogress">\n          <p class="wizard-loadingText">\n            <span class="loading icon"></span>\n            '),e.push(this.T("Counting entries. This may take a while.")),e.push('\n          </p>\n        </div>\n        <div class="js-analyzing hide">\n          <p class="wizard-loadingText">\n            '),e.push(this.T("Analyzing entries with given configuration...")),e.push('\n          </p>\n          <div class="centered js-progress">\n            <progress max="" value=""></progress>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <div class="modal-content setup wizard hide js-try">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Exchange")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <p>'),e.push(this.T("With your current configuration the following will happen")),e.push(':</p>\n        <div class="js-summary"></div>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <a class="btn btn--text btn--secondary js-goToSlide align-left" data-slide="js-mapping">'),e.push(this.T("Go Back")),e.push('</a>\n      </div>\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submitSave">'),e.push(this.T("Save configuration")),e.push('</button>\n      </div>\n    </div>\n  </div>\n\n  <form class="modal-content setup wizard hide js-error">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("Exchange")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right">'),e.push(this.T("Cancel")),e.push("</button>\n      </div>\n    </div>\n  </form>\n\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/idoit"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push("<form>\n  <h2>"),e.push(this.T("Settings")),e.push('</h2>\n  <div class="settings-entry">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="20%">'),e.push(this.T("Name")),e.push('\n          <th width="80%">'),e.push(this.T("Value")),e.push('\n      </thead>\n      <tbody>\n        <tr>\n          <td class="settings-list-row-control">'),e.push(this.T("API token")),e.push(' *\n          <td class="settings-list-control-cell"><input type="text" class="form-control form-control--small" value="'),e.push(n(this.config.api_token)),e.push('" name="api_token">\n        <tr>\n          <td class="settings-list-row-control">'),e.push(this.T("Endpoint")),e.push(' *\n          <td class="settings-list-control-cell"><input type="text" class="form-control form-control--small" value="'),e.push(n(this.config.endpoint)),e.push('" placeholder="https://idoit.example.com/i-doit/" name="endpoint">\n        <tr>\n          <td class="settings-list-row-control">'),e.push(this.T("Client ID")),e.push('\n          <td class="settings-list-control-cell"><input type="text" class="form-control form-control--small" value="'),e.push(n(this.config.client_id)),e.push('" name="client_id">\n      </tbody>\n    </table>\n  </div>\n\n  <button type="submit" class="btn btn--primary js-submit">'),e.push(this.T("Save")),e.push("</button>\n</form>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/idoit_object_result"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push("<hr>\n"),_.isEmpty(this.items))s.push("\n  "),s.push(this.T("none")),s.push("\n");else{for(s.push('\n<table class="table">\n  <thead>\n    <th style="width: 30px"></th>\n    <th style="width: 100px">'),s.push(this.T("ID")),s.push("</th>\n    <th>"),s.push(this.T("Name")),s.push('</th>\n    <th style="width: 100px;">'),s.push(this.T("Status")),s.push("</th>\n  </thead>\n  <tbody>\n  "),t=0,n=(i=this.items).length;t<n;t++)e=i[t],s.push('\n    <tr>\n      <td><input type="checkbox" name="object_id" value="'),s.push(r(e.id)),s.push('"/></td>\n      <td title="'),s.push(r(e.id)),s.push('">'),s.push(r(e.id)),s.push('</td>\n      <td title="'),s.push(r(e.title)),s.push('"><a href="'),s.push(e.link),s.push('" target="_blank">'),s.push(r(e.title)),s.push("</a></td>\n      <td>"),s.push(r(e.cmdb_status_title)),s.push("</td>\n    </tr>\n  ");s.push("\n  </tbody>\n</table>\n")}s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/idoit_object_selector"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form class="js-search flex horizontal">\n  <div class="controls controls--select js-typeSelect"></div>\n  <input type="text" name="title" value="" autocomplete="off" placeholder="'),e.push(this.Ti("Search")),e.push('" class="form-control js-searchField"/>\n</form>\n<form class="js-result"></form>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/index"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="page-header-title">\n  <h1>'),s.push(this.T(this.head)),s.push('</h1>\n</div>\n<div class="page-content">\n  <table class="table table-striped table-hover">\n    <thead>\n      <tr>\n        <th style="width: 30px;"></th>\n        <th style="width: 30%;">'),s.push(this.T("Service")),s.push("</th>\n        <th>"),s.push(this.T("Description")),s.push("</th>\n      </tr>\n    </thead>\n    <tbody>\n    "),t=0,n=(i=this.integrations).length;t<n;t++)e=i[t],s.push('\n      <tr data-key="'),s.push(r(e.key)),s.push('">\n        <td>\n          '),e.state.current()?(s.push("\n            "),s.push(this.Icon("status","ok inline"))):(s.push("\n            "),s.push(this.Icon("status","inactive inline"))),s.push("\n          "),s.push('\n        </td>\n        <td><a href="'),s.push(e.target),s.push('">'),s.push(r(e.name)),s.push("</a></td>\n        <td>"),s.push(this.T(e.description)),s.push("</td>\n      </tr>\n    ");s.push("\n    </tbody>\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/ldap"]=function(t){t||(t={});var o=[],a=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r;if(o.push('<div class="js-lastImport"></div>\n<div class="js-notConfigured">\n  <p>'),o.push(this.T("No %s configured.","LDAP")),o.push('</p>\n  <button type="submit" class="btn btn--primary js-wizard">'),o.push(this.T("Configure")),o.push('</button>\n</div>\n<div class="js-summary hide">\n  <h2>'),o.push(this.T("Settings")),o.push('</h2>\n  <table class="settings-list" style="width: 100%;">\n    <thead>\n      <tr>\n        <th width="30%">'),o.push(this.T("Name")),o.push('\n        <th width="70%">'),o.push(this.T("Value")),o.push('\n    </thead>\n    <tbody>\n      <tr>\n        <td class="settings-list-row-control">'),o.push(this.T("LDAP Host")),o.push('\n        <td class="settings-list-row-control">'),o.push(a(this.config.host_url)),o.push('\n      <tbody>\n        <tr>\n          <td class="settings-list-row-control">'),o.push(this.T("Base DN")),o.push('\n          <td class="settings-list-row-control">'),o.push(a(this.config.base_dn)),o.push('\n        <tr>\n          <td class="settings-list-row-control">'),o.push(this.T("Bind User")),o.push('\n          <td class="settings-list-row-control">'),o.push(a(this.config.bind_user)),o.push('\n        <tr>\n          <td class="settings-list-row-control">'),o.push(this.T("Bind Password")),o.push('\n          <td class="settings-list-row-control">'),o.push(a(this.M(this.config.bind_pw))),o.push('\n        <tr>\n          <td class="settings-list-row-control">'),o.push(this.T("UID")),o.push('\n          <td class="settings-list-row-control">'),o.push(a(this.config.user_uid)),o.push('\n        <tr>\n          <td class="settings-list-row-control">'),o.push(this.T("User Filter")),o.push('\n          <td class="settings-list-row-control">'),o.push(a(this.config.user_filter)),o.push('\n        <tr>\n          <td class="settings-list-row-control">'),o.push(this.T("GID")),o.push('\n          <td class="settings-list-row-control">'),o.push(a(this.config.group_uid)),o.push('\n        <tr>\n          <td class="settings-list-row-control">'),o.push(this.T("Group Filter")),o.push('\n          <td class="settings-list-row-control">'),o.push(a(this.config.group_filter)),o.push("\n    </tbody>\n  </table>\n\n  <h2>"),o.push(this.T("Mapping")),o.push("</h2>\n\n  <h3>"),o.push(this.T("User")),o.push("</h3>\n  "),_.isEmpty(this.config.user_attributes))o.push('\n    <table class="settings-list settings-list--stretch settings-list--placeholder">\n      <thead><tr><th>'),o.push(this.T("No Entries")),o.push("\n    </table>\n  ");else{for(e in o.push('\n    <table class="settings-list settings-list--stretch">\n      <thead>\n        <tr>\n          <th width="40%">'),o.push(this.T("LDAP")),o.push('\n          <th width="60%">'),o.push(this.T("Zammad")),o.push("\n        "),n=this.config.user_attributes)r=n[e],o.push('\n          <tr>\n            <td class="settings-list-row-control">'),o.push(a(e)),o.push('\n            <td class="settings-list-row-control">'),o.push(a(r)),o.push("\n        ");o.push("\n      </thead>\n      <tbody>\n    </table>\n  ")}if(o.push("\n\n  <h3>"),o.push(this.T("Role")),o.push("</h3>\n  "),_.isEmpty(this.group_role_map))o.push('\n    <table class="settings-list settings-list--stretch settings-list--placeholder">\n      <thead><tr><th>'),o.push(this.T("No Entries")),o.push("\n    </table>\n  ");else{for(s in o.push('\n    <table class="settings-list settings-list--stretch">\n      <thead>\n        <tr>\n          <th width="40%">'),o.push(this.T("LDAP")),o.push('\n          <th width="60%">'),o.push(this.T("Zammad")),o.push("\n      <tbody>\n        "),i=this.group_role_map)t=i[s],o.push('\n          <tr>\n            <td class="settings-list-row-control">'),o.push(a(s)),o.push('\n            <td class="settings-list-row-control">'),o.push(a(t)),o.push("\n        ");o.push("\n  ")}o.push('\n    </table>\n\n  <button type="submit" class="btn btn--primary js-wizard">'),o.push(this.T("Change")),o.push("</button>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,o.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/ldap_group_role_row"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(
/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<tr class="js-entry">\n  <td style="width: 60%" class="settings-list-control-cell js-ldapList">\n  <td style="width: 35%" class="settings-list-control-cell js-roleList">\n  <td class="settings-list-row-control">\n    <div class="btn btn--text js-remove">\n      '),e.push(this.Icon("trash")),e.push(" "),e.push(this.T("Remove")),e.push("\n    </div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/ldap_last_import"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;if(i.push('<div class="box box--message">\n  <h2>'),i.push(this.T("Last sync")),i.push("</h2>\n  "),_.isEmpty(this.job.started_at))i.push("\n    "),this.job.result&&this.job.result.error?(i.push('\n        <div class="alert alert--danger" role="alert">'),i.push(this.T("An error occurred: %s",this.job.result.error)),i.push("</div>\n    ")):this.job.result&&this.job.result.info?(i.push('\n        <div class="alert alert--info" role="alert">'),i.push(this.T("Info: %s",this.job.result.info)),i.push("</div>\n    ")):(i.push("\n      <p>"),i.push(this.T("Job is waiting to get started...")),i.push("</p>\n    ")),i.push("\n  ");else{if(i.push("\n    "),this.job.finished_at?(i.push("\n      <p>"),i.push(this.Ttimestamp(this.job.started_at)),i.push(" - "),i.push(this.Ttimestamp(this.job.finished_at)),i.push("</p>\n      "),this.job.result&&this.job.result.error?(i.push('\n        <div class="alert alert--danger" role="alert">'),i.push(this.T("An error occurred: %s",this.job.result.error)),i.push("</div>\n      ")):this.job.result&&this.job.result.info&&(i.push('\n        <div class="alert alert--info" role="alert">'),i.push(this.T("Info: %s",this.job.result.info)),i.push("</div>\n      "))):(i.push("\n      "),this.job.result&&this.job.result.error?(i.push("\n        <p>"),i.push(this.Ttimestamp(this.job.started_at)),i.push('</p>\n        <div class="alert alert--danger" role="alert">'),i.push(this.T("An error occurred: %s",this.job.result.error)),i.push("</div>\n      ")):this.job.result.sum?(i.push("\n        <p>"),i.push(this.Ttimestamp(this.job.started_at)),i.push(" - "),i.push(this.T("Running...")),i.push('</p>\n        <div class="flex">\n          <progress max="'),i.push(s(this.job.result.total)),i.push('" value="'),i.push(s(this.job.result.sum)),i.push('"></progress>\n        </div>\n      ')):(i.push("\n        <p>"),i.push(this.Ttimestamp(this.job.started_at)),i.push(" - "),i.push(this.T("Counting entries. This may take a while.")),i.push("</p>\n      "))),i.push("\n    "),i.push("\n    "),!_.isEmpty(this.job.result)&&this.job.result.sum){if(i.push("\n      <ul>\n        <li>"),i.push(this.T("%s user to %s user","LDAP","Zammad")),i.push(" ("),i.push(s(this.job.result.sum)),i.push("/"),i.push(s(this.job.result.total)),i.push("):\n          <ul>\n            <li>"),i.push(this.T("Users")),i.push(": "),i.push(s(this.job.result.created)),i.push(" "),i.push(this.T("created")),i.push(", "),i.push(s(this.job.result.updated)),i.push(" "),i.push(this.T("updated")),i.push(", "),i.push(s(this.job.result.unchanged)),i.push(" "),i.push(this.T("untouched")),i.push(", "),i.push(s(this.job.result.skipped)),i.push(" "),i.push(this.T("skipped")),i.push(", "),i.push(s(this.job.result.failed)),i.push(" "),i.push(this.T("failed")),i.push(", "),i.push(s(this.job.result.deactivated)),i.push(" "),i.push(this.T("deactivated")),i.push("\n          </ul>\n        "),!_.isEmpty(this.job.result.roles)){for(n in i.push("\n          <li>"),i.push(this.T("%s groups to %s roles assignments","LDAP","Zammad")),i.push(":\n            <ul>\n              "),t=this.job.result.roles)e=t[n],i.push("\n                <li> "),i.push(this.T(n)),i.push(": "),i.push(s(e.created)),i.push(" "),i.push(this.T("created")),i.push(", "),i.push(s(e.updated)),i.push(" "),i.push(this.T("updated")),i.push(", "),i.push(s(e.unchanged)),i.push(" "),i.push(this.T("untouched")),i.push(", "),i.push(s(e.failed)),i.push(" "),i.push(this.T("failed")),i.push(", "),i.push(s(e.deactivated)),i.push(" "),i.push(this.T("deactivated")),i.push("\n              ");i.push("\n            </ul>\n        ")}i.push("\n      </ul>\n    ")}i.push("\n    "),this.job.finished_at&&(i.push('\n      <button type="submit" class="btn btn--primary js-start-sync">'),i.push(this.T("Start new")),i.push("</button>\n    ")),i.push("\n  ")}i.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/ldap_ssl_verify_row"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<tr>\n  <td class="settings-list-row-control">'),e.push(this.T("SSL verification")),e.push('\n  <td class="settings-list-control-cell js-sslVerify">\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/ldap_summary"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;if(i.push("<ul>\n  <li>"),i.push(this.T("%s user to %s user","LDAP","Zammad")),i.push(" ("),i.push(s(this.job.result.sum)),i.push("):\n    <ul>\n      <li>"),i.push(this.T("Users")),i.push(": "),i.push(s(this.job.result.created)),i.push(" "),i.push(this.T("created")),i.push(", "),i.push(s(this.job.result.updated)),i.push(" "),i.push(this.T("updated")),i.push(", "),i.push(s(this.job.result.unchanged)),i.push(" "),i.push(this.T("untouched")),i.push(", "),i.push(s(this.job.result.skipped)),i.push(" "),i.push(this.T("skipped")),i.push(", "),i.push(s(this.job.result.failed)),i.push(" "),i.push(this.T("failed")),i.push(", "),i.push(s(this.job.result.deactivated)),i.push(" "),i.push(this.T("deactivated")),i.push("\n    </ul>\n  </li>\n  "),!_.isEmpty(this.job.result.roles)){for(n in i.push("\n    <li>"),i.push(this.T("%s groups to %s roles assignments","LDAP","Zammad")),i.push(":\n      <ul>\n        "),t=this.job.result.roles)e=t[n],i.push("\n          <li>"),i.push(this.T(n)),i.push(": "),i.push(s(e.created)),i.push(" "),i.push(this.T("created")),i.push(", "),i.push(s(e.updated)),i.push(" "),i.push(this.T("updated")),i.push(", "),i.push(s(e.unchanged)),i.push(" "),i.push(this.T("untouched")),i.push(", "),i.push(s(e.failed)),i.push(" "),i.push(this.T("failed")),i.push(", "),i.push(s(e.deactivated)),i.push(" "),i.push(this.T("deactivated")),i.push("\n        ");i.push("\n      </ul>\n    </li>\n  ")}i.push("\n</ul>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/ldap_user_attribute_row"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<tr class="js-entry">\n  <td style="width: 60%" class="settings-list-control-cell js-ldapAttribute">\n  <td style="width: 35%" class="settings-list-control-cell js-userAttribute">\n  <td class="settings-list-row-control">\n    <div class="btn btn--text js-remove">\n      '),e.push(this.Icon("trash")),e.push(" "),e.push(this.T("Remove")),e.push("\n    </div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/ldap_wizard"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="modal-dialog">\n\n  <form class="modal-content setup wizard js-discover">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("LDAP")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <table class="settings-list" style="width: 100%;">\n          <thead>\n            <tr>\n              <th width="30%">'),e.push(this.T("Name")),e.push('\n              <th width="70%">'),e.push(this.T("Value")),e.push('\n          </thead>\n          <tbody>\n            <tr>\n              <td class="settings-list-row-control">'),e.push(this.T("Host")),e.push('\n              <td class="settings-list-control-cell"><input type="text" name="host_url" class="form-control form-control--small js-hostUrl" value="" placeholder="ldaps://ldap.example.com" autocomplete="off">\n          </tbody>\n        </table>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submit">'),e.push(this.T("Connect")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-connect">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("LDAP")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Connecting ...")),e.push(' <span class="js-host"></span>\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-bind">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("LDAP")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <table class="settings-list" style="width: 100%;">\n          <thead>\n            <tr>\n              <th width="30%">'),e.push(this.T("Name")),e.push('\n              <th width="70%">'),e.push(this.T("Value")),e.push('\n          </thead>\n          <tbody>\n            <tr>\n              <td class="settings-list-row-control">'),e.push(this.T("Base DN")),e.push('\n              <td class="settings-list-control-cell js-baseDn">\n            <tr>\n              <td class="settings-list-row-control">'),e.push(this.T("Bind User")),e.push('\n              <td class="settings-list-control-cell"><input type="text" name="bind_user" class="form-control form-control--small" value="" placeholder="" autocomplete="off">\n            <tr>\n              <td class="settings-list-row-control">'),e.push(this.T("Bind Password")),e.push('\n              <td class="settings-list-control-cell"><input type="password" name="bind_pw" class="form-control form-control--small" value=""  autocomplete="new-password">\n          </tbody>\n        </table>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <a class="btn btn--text btn--secondary js-goToSlide align-left" data-slide="js-discover">'),e.push(this.T("Go Back")),e.push('</a>\n      </div>\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submit">'),e.push(this.T("Continue")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-analyze">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("LDAP")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Analyzing structure...")),e.push('\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-dry">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("LDAP")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="js-preprogress">\n          <p class="wizard-loadingText">\n            <span class="loading icon"></span>\n            '),e.push(this.T("Counting entries. This may take a while.")),e.push('\n          </p>\n        </div>\n        <div class="js-analyzing hide">\n          <p class="wizard-loadingText">\n            '),e.push(this.T("Analyzing entries with given configuration...")),e.push('\n          </p>\n          <div class="centered js-progress">\n            <progress max="" value=""></progress>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <div class="modal-content setup wizard hide js-mapping">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("LDAP")),e.push(" "),e.push(this.T("Mapping")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n\n        <h2>'),e.push(this.T("User")),e.push('</h2>\n        <form class="js-userMappingForm">\n          <table class="settings-list js-userAttributeMap" style="width: 100%;">\n            <colgroup>\n              <col width="240">\n              <col>\n              <col>\n            </colgroup>\n            <thead>\n              <tr>\n                <th>'),e.push(this.T("%s Attribute","LDAP")),e.push("\n                <th>"),e.push(this.T("%s Attribute","Zammad")),e.push("\n                <th>"),e.push(this.T("Action")),e.push('\n            </thead>\n            <tbody>\n              <tr>\n                <td class="settings-list-row-control" colspan="3">\n                  <div class="btn btn--text btn--create js-add">\n                    '),e.push(this.Icon("plus-small")),e.push(" "),e.push(this.T("Add")),e.push("\n                  </div>\n            </tbody>\n          </table>\n        </form>\n\n        <h2>"),e.push(this.T("Roles")),e.push('</h2>\n        <form class="js-groupRoleForm">\n          <table class="settings-list js-groupRoleMap" style="width: 100%;">\n            <colgroup>\n              <col width="240">\n              <col>\n              <col>\n            </colgroup>\n            <thead>\n              <tr>\n                <th>'),e.push(this.T("%s Group","LDAP")),e.push("\n                <th>"),e.push(this.T("%s Role","Zammad")),e.push("\n                <th>"),e.push(this.T("Action")),e.push('\n            </thead>\n            <tbody>\n              <tr>\n                <td class="settings-list-row-control" colspan="3">\n                  <div class="btn btn--text btn--create js-add">\n                    '),e.push(this.Icon("plus-small")),e.push(" "),e.push(this.T("Add")),e.push("\n                  </div>\n            </tbody>\n          </table>\n        </form>\n\n        <h2>"),e.push(this.T("Expert")),e.push('</h2>\n        <form class="js-expertForm">\n          <table class="settings-list js-expert" style="width: 100%;">\n            <thead>\n              <tr>\n                <th width="30%">'),e.push(this.T("Name")),e.push('\n                <th width="70%">'),e.push(this.T("Value")),e.push('\n            </thead>\n            <tbody>\n              <tr>\n                <td class="settings-list-row-control">'),e.push(this.T("User filter")),e.push('\n                <td class="settings-list-control-cell"><input type="text" name="user_filter" class="form-control form-control--small" value="" placeholder="" autocomplete="off">\n              <tr>\n                <td class="settings-list-row-control">'),e.push(this.T("Users without assigned LDAP groups")),e.push('\n                <td class="settings-list-control-cell js-unassignedUsers">\n            </tbody>\n          </table>\n        </form>\n\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <a class="btn btn--text btn--secondary js-goToSlide align-left" data-slide="js-bind">'),e.push(this.T("Go Back")),e.push('</a>\n      </div>\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submitTry">'),e.push(this.T("Continue")),e.push('</button>\n      </div>\n    </div>\n  </div>\n\n  <div class="modal-content setup wizard hide js-try">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("LDAP")),e.push(" "),e.push(this.T("Configuration")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n        <p>'),e.push(this.T("With your current configuration the following will happen")),e.push(':</p>\n        <div class="js-summary"></div>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <a class="btn btn--text btn--secondary js-goToSlide align-left" data-slide="js-mapping">'),e.push(this.T("Go Back")),e.push('</a>\n      </div>\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right js-submitSave">'),e.push(this.T("Save configuration")),e.push('</button>\n      </div>\n    </div>\n  </div>\n\n  <form class="modal-content setup wizard hide js-error">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T("LDAP")),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="alert alert--danger hide" role="alert"></div>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right">'),e.push(this.T("Cancel")),e.push("</button>\n      </div>\n    </div>\n  </form>\n\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/placetel"]=function(t){t||(t={});var p=[],u=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c;for(p.push("<form>\n\n  <h2>Placetel "),p.push(this.T("Settings")),p.push("</h2>\n\n  <p>"),p.push(this.T("You need to configure the Zammad endpoints in the %s web interface","Placetel")),p.push(':<p>\n\n  <div class="settings-entry">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="20%">'),p.push(this.T("Type")),p.push('\n          <th width="80%">'),p.push(this.T("URL")),p.push('\n      </thead>\n      <tbody>\n        <tr>\n          <td class="settings-list-row-control">'),p.push(this.T("Endpoint")),p.push('\n          <td class="settings-list-control-cell"><input type="url" class="form-control form-control--small js-select" readonly value="'),p.push(this.C("http_type")),p.push("://"),p.push(this.C("fqdn")),p.push("/api/v1/placetel/"),p.push(u(this.placetel_token)),p.push('">\n      </tbody>\n    </table>\n  </div>\n\n  <p>'),p.push(this.T("In order for Zammad to access %s, the %s API token must be stored here","Placetel","Placetel")),p.push(':<p>\n  <div class="settings-entry">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="20%">'),p.push(this.T("Type")),p.push('\n          <th width="80%">'),p.push(this.T("Content")),p.push('\n      </thead>\n      <tbody>\n        <tr>\n          <td class="settings-list-row-control">'),p.push(this.T("API Token")),p.push('\n          <td class="settings-list-control-cell"><input type="input" class="form-control form-control--small js-select" value="'),p.push(u(this.config.api_token)),p.push('" name="api_token" placeholder="">\n      </tbody>\n    </table>\n  </div>\n\n  <h2>'),p.push(this.T("Inbound")),p.push("</h2>\n\n  <p>"),p.push(this.T("Blocked caller ids based on sender caller id.")),p.push('\n\n  <div class="settings-entry">\n    <table class="settings-list js-inboundBlockCallerId" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="50%">'),p.push(this.T("Caller id to block")),p.push('\n          <th width="40%">'),p.push(this.T("Note")),p.push('\n          <th width="10%">'),p.push(this.T("Action")),p.push("\n      </thead>\n      <tbody>\n"),t=0,i=(o=this.config.inbound.block_caller_ids).length;t<i;t++)c=o[t],p.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="caller_id" value="'),p.push(u(c.caller_id)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="'),p.push(u(c.note)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text js-remove">'),p.push(this.Icon("trash")),p.push(" "),p.push(this.T("Remove")),p.push("</div>\n");for(p.push('\n        <tr>\n          <td class="settings-list-control-cell"><input name="caller_id" value="" placeholder="4930609854189" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="" placeholder="'),p.push(this.Ti("my own note")),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-add">'),p.push(this.Icon("plus-small")),p.push(" "),p.push(this.T("Add")),p.push("</div>\n      </tbody>\n    </table>\n  </div>\n<!-- disabled until api is supporting it\n  <h2>"),p.push(this.T("Outbound")),p.push("</h2>\n\n  <p>"),p.push(this.T("Set caller id of outbound calls based on destination caller id.")),p.push('\n\n  <div class="settings-entry js-outboundRouting">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="30%">'),p.push(this.T("Destination caller id")),p.push('\n          <th width="30%">'),p.push(this.T("Set outbound caller id")),p.push('\n          <th width="30%">'),p.push(this.T("Note")),p.push('\n          <th width="10%">'),p.push(this.T("Action")),p.push("\n      </thead>\n      <tbody>\n"),e=0,s=(a=this.config.outbound.routing_table).length;e<s;e++)c=a[e],p.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="dest" value="'),p.push(u(c.dest)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="caller_id" value="'),p.push(u(c.caller_id)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="'),p.push(u(c.note)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text js-remove">'),p.push(this.Icon("trash")),p.push(" "),p.push(this.T("Remove")),p.push("</div>\n");for(p.push('\n        <tr>\n          <td class="settings-list-control-cell"><input name="dest" value="" placeholder="49* or 3230123456789" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="caller_id" value="" placeholder="4930609854189" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="" placeholder="'),p.push(this.Ti("my own note")),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-add">'),p.push(this.Icon("plus-small")),p.push(" "),p.push(this.T("Add")),p.push("</div>\n      </tbody>\n    </table>\n  </div>\n\n  <p>"),p.push(this.T("Default caller id.")),p.push('\n\n  <div class="settings-entry">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="50%">'),p.push(this.T("Default caller id")),p.push('\n          <th width="50%">'),p.push(this.T("Note")),p.push('\n      </thead>\n      <tbody>\n        <tr>\n          <td class="settings-list-control-cell"><input name="default_caller_id" value="'),p.push(u(this.config.outbound.default_caller_id)),p.push('" placeholder="4930609854189" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control">'),p.push(this.T("Default caller id for outbound calls.")),p.push("\n      </tbody>\n    </table>\n  </div>\n-->\n  <h2>"),p.push(this.T("User assignment to telephones")),p.push("</h2>\n\n  <p>"),p.push(this.T("User assignment to telephones to be able to offer extended like open new ticket screen on answering a call.")),p.push('\n\n  <div class="settings-entry">\n    <table class="settings-list js-userDeviceMap" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="45%">'),p.push(this.T("Placetel")),p.push("/"),p.push(this.T("Device")),p.push('\n          <th width="45%">'),p.push(this.T("Zammad")),p.push("/"),p.push(this.T("User")),p.push('\n          <th width="10%">'),p.push(this.T("Action")),p.push("\n      </thead>\n      <tbody>\n"),n=0,r=(l=this.config.user_device_map).length;n<r;n++)c=l[n],p.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="device_id" value="'),p.push(u(c.device_id)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="user_id" value="'),p.push(u(c.user_id)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text js-remove">'),p.push(this.Icon("trash")),p.push(" "),p.push(this.T("Remove")),p.push("</div>\n");p.push('\n        <tr>\n          <td class="settings-list-control-cell"><input name="device_id" value="" placeholder="e. g. 777042617425@fpbx.de" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="user_id" value="" placeholder="'),p.push(this.Ti("e. g. user@example.com")),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-add">'),p.push(this.Icon("plus-small")),p.push(" "),p.push(this.T("Add")),p.push('</div>\n      </tbody>\n    </table>\n  </div>\n\n  <button type="submit" class="btn btn--primary js-submit">'),p.push(this.T("Save")),p.push("</button>\n</form>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/sipgate"]=function(t){t||(t={});var p=[],u=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c;for(p.push("<form>\n\n  <h2>sipgate.io "),p.push(this.T("Settings")),p.push("</h2>\n\n  <p>"),p.push(this.T("You need to configure the Zammad endpoints in the %s web interface","Sipgate")),p.push(':<p>\n\n  <div class="settings-entry">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="20%">'),p.push(this.T("Type")),p.push('\n          <th width="80%">'),p.push(this.T("URL")),p.push('\n      </thead>\n      <tbody>\n        <tr>\n          <td class="settings-list-row-control">'),p.push(this.T("Inbound")),p.push('\n          <td class="settings-list-control-cell"><input type="url" class="form-control form-control--small js-select" readonly value="'),p.push(this.C("http_type")),p.push("://"),p.push(this.C("fqdn")),p.push('/api/v1/sipgate/in">\n        <tr>\n          <td class="settings-list-row-control">'),p.push(this.T("Outbound")),p.push('\n          <td class="settings-list-control-cell"><input type="url" class="form-control form-control--small js-select" readonly value="'),p.push(this.C("http_type")),p.push("://"),p.push(this.C("fqdn")),p.push('/api/v1/sipgate/out">\n      </tbody>\n    </table>\n  </div>\n\n  <h2>'),p.push(this.T("Inbound")),p.push("</h2>\n\n  <p>"),p.push(this.T("Blocked caller ids based on sender caller id.")),p.push('\n\n  <div class="settings-entry">\n    <table class="settings-list js-inboundBlockCallerId" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="50%">'),p.push(this.T("Caller id to block")),p.push('\n          <th width="40%">'),p.push(this.T("Note")),p.push('\n          <th width="10%">'),p.push(this.T("Action")),p.push("\n      </thead>\n      <tbody>\n"),t=0,i=(o=this.config.inbound.block_caller_ids).length;t<i;t++)c=o[t],p.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="caller_id" value="'),p.push(u(c.caller_id)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="'),p.push(u(c.note)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text js-remove">'),p.push(this.Icon("trash")),p.push(" "),p.push(this.T("Remove")),p.push("</div>\n");for(p.push('\n        <tr>\n          <td class="settings-list-control-cell"><input name="caller_id" value="" placeholder="4930609854189" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="" placeholder="'),p.push(this.Ti("my own note")),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-add">'),p.push(this.Icon("plus-small")),p.push(" "),p.push(this.T("Add")),p.push("</div>\n      </tbody>\n    </table>\n  </div>\n\n  <h2>"),p.push(this.T("Outbound")),p.push("</h2>\n\n  <p>"),p.push(this.T("Set caller id of outbound calls based on destination caller id.")),p.push('\n\n  <div class="settings-entry js-outboundRouting">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="30%">'),p.push(this.T("Destination caller id")),p.push('\n          <th width="30%">'),p.push(this.T("Set outbound caller id")),p.push(
'\n          <th width="30%">'),p.push(this.T("Note")),p.push('\n          <th width="10%">'),p.push(this.T("Action")),p.push("\n      </thead>\n      <tbody>\n"),e=0,s=(a=this.config.outbound.routing_table).length;e<s;e++)c=a[e],p.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="dest" value="'),p.push(u(c.dest)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="caller_id" value="'),p.push(u(c.caller_id)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="'),p.push(u(c.note)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text js-remove">'),p.push(this.Icon("trash")),p.push(" "),p.push(this.T("Remove")),p.push("</div>\n");for(p.push('\n        <tr>\n          <td class="settings-list-control-cell"><input name="dest" value="" placeholder="49* or 3230123456789" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="caller_id" value="" placeholder="4930609854189" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="note" value="" placeholder="'),p.push(this.Ti("my own note")),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-add">'),p.push(this.Icon("plus-small")),p.push(" "),p.push(this.T("Add")),p.push("</div>\n      </tbody>\n    </table>\n  </div>\n\n  <p>"),p.push(this.T("Default caller id.")),p.push('\n\n  <div class="settings-entry">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="50%">'),p.push(this.T("Default caller id")),p.push('\n          <th width="50%">'),p.push(this.T("Note")),p.push('\n      </thead>\n      <tbody>\n        <tr>\n          <td class="settings-list-control-cell"><input name="default_caller_id" value="'),p.push(u(this.config.outbound.default_caller_id)),p.push('" placeholder="4930609854189" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control">'),p.push(this.T("Default caller id for outbound calls.")),p.push("\n      </tbody>\n    </table>\n  </div>\n\n  <p>"),p.push(this.T("In order for Zammad to access %s, a %s API user and password must be stored here","Sipgate","Sipgate")),p.push(':<p>\n  <div class="settings-entry">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="20%">'),p.push(this.T("Type")),p.push('\n          <th width="80%">'),p.push(this.T("Content")),p.push('\n      </thead>\n      <tbody>\n        <tr>\n          <td class="settings-list-row-control">'),p.push(this.T("API User")),p.push('\n          <td class="settings-list-control-cell"><input type="input" class="form-control form-control--small js-select" value="'),p.push(u(this.config.api_user)),p.push('" name="api_user" placeholder="someuser@example.com">\n        <tr>\n          <td class="settings-list-row-control">'),p.push(this.T("API Password")),p.push('\n          <td class="settings-list-control-cell"><input type="password" class="form-control form-control--small js-select" value="'),p.push(u(this.config.api_password)),p.push('" name="api_password" placeholder="">\n      </tbody>\n    </table>\n  </div>\n\n  <h2>'),p.push(this.T("User assignment to Sipgate users")),p.push("</h2>\n\n  <p>"),p.push(this.T("User assignment to Sipgate users to be able to offer extended like open new ticket screen on answering a call.")),p.push('\n\n  <div class="settings-entry">\n    <table class="settings-list js-userRemoteMap" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="45%">'),p.push(this.T("Sipgate")),p.push("/"),p.push(this.T("User")),p.push('\n          <th width="45%">'),p.push(this.T("Zammad")),p.push("/"),p.push(this.T("User")),p.push('\n          <th width="10%">'),p.push(this.T("Action")),p.push("\n      </thead>\n      <tbody>\n"),n=0,r=(l=this.config.user_remote_map).length;n<r;n++)c=l[n],p.push('\n        <tr class="js-row">\n          <td class="settings-list-control-cell"><input name="remote_user_id" value="'),p.push(u(c.remote_user_id)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="user_id" value="'),p.push(u(c.user_id)),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text js-remove">'),p.push(this.Icon("trash")),p.push(" "),p.push(this.T("Remove")),p.push("</div>\n");p.push('\n        <tr>\n          <td class="settings-list-control-cell"><input name="remote_user_id" value="" placeholder="e. g. W123" class="form-control form-control--small js-summary">\n          <td class="settings-list-control-cell"><input name="user_id" value="" placeholder="'),p.push(this.Ti("e. g. user@example.com")),p.push('" class="form-control form-control--small js-summary">\n          <td class="settings-list-row-control"><div class="btn btn--text btn--create js-add">'),p.push(this.Icon("plus-small")),p.push(" "),p.push(this.T("Add")),p.push('</div>\n      </tbody>\n    </table>\n  </div>\n\n  <button type="submit" class="btn btn--primary js-submit">'),p.push(this.T("Save")),p.push("</button>\n</form>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/smime"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push("<form>\n  <h2>"),e.push(this.T("Certificates & Private Keys")),e.push('</h2>\n  <div class="settings-entry settings-entry--stretched js-certList"></div>\n\n  <div class="btn btn--primary js-addCertificate">'),e.push(this.T("Add Certificate")),e.push('</div>\n  <div class="btn js-addPrivateKey">'),e.push(this.T("Add Private Key")),e.push("</div>\n\n  <hr>\n\n  <h2>"),e.push(this.T("Default Behavior")),e.push('</h2>\n  <p>Choose the default behavior of the S/MIME integration on per group basis. If signing or encrypting is not possible, the setting has no effect. Agents call always manually alter the behavior for each article.</p>\n  <div class="settings-entry settings-entry--stretched js-groupList"></div>\n  <div class="btn btn--primary js-updateGroup">'),e.push(this.T("Update")),e.push("</div>\n</form>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/smime_certificate_add"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\n<p class="alert alert--danger js-error hide"></p>\n\n<div class="form-group">\n  <div class="formGroup-label">\n    <label for="certificate-upload">'),e.push(this.T("Upload Certificate")),e.push('</label>\n  </div>\n  <div class="controls">\n    <input name="file" type="file" id="certificate-upload">\n  </div>\n</div>\n\n<div class="or-divider">\n  <span>'),e.push(this.T("or")),e.push('</span>\n</div>\n\n<div class="form-group">\n  <div class="formGroup-label">\n    <label for="certificate-paste">'),e.push(this.T("Paste Certificate")),e.push('</label>\n  </div>\n  <div class="controls">\n    <textarea cols="25" rows="20" name="data" style="height: 200px;" id="certificate-paste"></textarea>\n  </div>\n</div>\n\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/smime_group"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<table class="settings-list">\n  <thead>\n    <tr>\n      <th width="55%">'),s.push(this.T("Group")),s.push("\n      <th>"),s.push(this.T("Sign")),s.push("\n      <th>"),s.push(this.T("Encryption")),s.push("\n  </thead>\n  <tbody>\n  "),_.isEmpty(this.groups))s.push('\n  <tr>\n    <td colspan="6">\n      '),s.push(this.T("No Entries")),s.push("\n    </td>\n  </tr>\n  ");else{for(s.push("\n    "),e=0,n=(i=this.groups).length;e<n;e++)t=i[e],s.push('\n      <tr data-id="'),s.push(r(t.id)),s.push('">\n        <td>'),s.push(r(t.name)),s.push('\n        <td class="js-signDefault">\n        <td class="js-encryptionDefault">\n    ');s.push("\n  ")}s.push("\n  </tbody>\n</table>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/smime_list"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<table class="settings-list settings-list--stretch">\n  <thead>\n    <tr>\n      <th width="55%">'),s.push(this.T("Subject")),s.push('\n      <th width="10%">'),s.push(this.T("Hash")),s.push('\n      <th width="10%">'),s.push(this.T("Fingerprint")),s.push('\n      <th width="10%">'),s.push(this.T("Created")),s.push('\n      <th width="10%">'),s.push(this.T("Expires")),s.push('\n      <th width="5%">'),s.push(this.T("Actions")),s.push("\n  </thead>\n  <tbody>\n  "),_.isEmpty(this.certs))s.push('\n  <tr>\n    <td colspan="6">\n      '),s.push(this.T("No Entries")),s.push("\n    </td>\n  </tr>\n  ");else{for(s.push("\n    "),e=0,n=(i=this.certs).length;e<n;e++)t=i[e],s.push('\n      <tr data-id="'),s.push(r(t.id)),s.push('">\n        <td>'),s.push(r(t.subject)),s.push("\n          "),t.private_key&&(s.push("<br><i>"),s.push(this.T("Including private key.")),s.push("</i>")),s.push("\n        <td>"),s.push(r(t.doc_hash)),s.push('\n        <td title="'),s.push(r(t.fingerprint)),s.push('">'),s.push(r(t.fingerprint.substr(1,10))),s.push("...\n        <td>"),s.push(this.datetime(t.not_before_at)),s.push("\n        <td>"),s.push(this.datetime(t.not_after_at)),s.push('\n        <td>\n          <div class="dropdown dropdown--actions">\n            <div class="btn btn--table btn--text btn--secondary js-action" data-toggle="dropdown">\n              '),s.push(this.Icon("overflow-button")),s.push('\n            </div>\n            <ul class="dropdown-menu dropdown-menu-right js-table-action-menu" role="menu">\n            '),t.private_key&&(s.push('\n              <li role="presentation" data-table-action="download-private">\n                <a href="'),s.push(r(this.C("http_type"))),s.push("://"),s.push(r(this.C("fqdn"))),s.push("/api/v1/integration/smime/private_key_download/"),s.push(r(t.id)),s.push('" download>'),s.push(this.Icon("download")),s.push(" "),s.push(this.T("Download Private Key")),s.push("</a>\n              </li>\n            ")),s.push('\n              <li role="presentation" data-table-action="download-public">\n                <a href="'),s.push(r(this.C("http_type"))),s.push("://"),s.push(r(this.C("fqdn"))),s.push("/api/v1/integration/smime/certificate_download/"),s.push(r(t.id)),s.push('" download>'),s.push(this.Icon("download")),s.push(" "),s.push(this.T("Download Certificate")),s.push('</a>\n              </li>\n              <li role="presentation" class="danger js-remove" data-table-action="remove">\n                '),s.push(this.Icon("trash")),s.push(" "),s.push(this.T("Delete")),s.push("\n              </li>\n            </ul>\n          </div>\n        </td>\n    ");s.push("\n  ")}s.push("\n  </tbody>\n</table>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/integration/smime_private_key_add"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\n<p class="alert alert--danger js-error hide"></p>\n\n<div class="form-field-group">\n  <div class="form-group">\n    <div class="formGroup-label">\n      <label for="key-upload">'),e.push(this.T("Upload Private Key")),e.push('</label>\n    </div>\n    <div class="controls">\n      <input name="file" type="file" id="key-upload">\n    </div>\n  </div>\n\n  <div class="or-divider">\n    <span>'),e.push(this.T("or")),e.push('</span>\n  </div>\n\n  <div class="form-group">\n    <div class="formGroup-label">\n      <label for="key-paste">'),e.push(this.T("Paste Private Key")),e.push('</label>\n    </div>\n    <div class="controls">\n      <textarea cols="25" rows="20" name="data" style="height: 200px;" id="key-paste"></textarea>\n    </div>\n  </div>\n</div>\n\n<div class="form-group">\n  <div class="formGroup-label">\n    <label for="key-secret">'),e.push(this.T("Enter Private Key secret")),e.push('</label>\n  </div>\n  <div class="controls">\n    <input class="form-control" name="secret" type="password" id="key-secret">\n  </div>\n</div>\n\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/karma/index"]=function(t){t||(t={});var h=[],d=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u;for(h.push("<div>\n\n"),h.push(this.T("Zammad Karma is a powerful tool that tracks and visualizes your productivity.")),h.push("\n\n<hr>\n\n<h2>"),h.push(this.T("Karma Level")),h.push("</h2>\n\n"),h.push(this.T("You are an |%s|.",App.i18n.translatePlain(this.user.level))),h.push(" "),h.push(this.T("Your karma is |%s|.",this.user.score)),h.push('\n\n<table class="table">\n'),e=0,s=(c=this.levels).length;e<s;e++)a=c[e],h.push('\n  <tr>\n    <td style="width: 60px;">'),h.push(d(a.start)),h.push('</td>\n    <td style="width: 40px;">\u2192 </td>\n    <td style="width: 100px;">'),null===a.end?h.push("\u221e"):h.push(d(a.end)),h.push("</td>\n    <td>"),h.push(this.T(a.name)),h.push("</td>\n    <td>"),this.user.level===a.name&&(h.push("("),h.push(this.T("Your current level")),h.push(")")),h.push("</td>\n  </tr>\n");for(h.push("\n</table>\n\n<hr>\n\n<h2>"),h.push(this.T("Latest updates")),h.push('</h2>\n\n<table class="table">\n'),n=0,r=(p=this.logs).length;n<r;n++){for(l=p[n],h.push('\n  <tr>\n    <td style="width: 180px;">'),h.push(this.humanTime(l.created_at)),h.push('</td>\n    <td style="width: 80px;">'),h.push(l.score_total),h.push("</td>\n    <td>\n      "),i=0,o=(u=l.comments).length;i<o;i++)t=u[i],h.push("\n        "),0<=t.score&&h.push("+"),h.push(t.score),h.push(" "),h.push(this.T(t.description)),h.push("\n      ");h.push("\n    </td>\n  </tr>\n")}h.push("\n</table>\n\n<hr>\n\n<h2>"),h.push(this.T("What affects your Zammad Karma?")),h.push("</h2>\n\n<p>"),h.push(this.T("You |accumulate positive Karma| when you regularly answer and close tickets on time and when you use advanced features such as text modules, ticket reminders or tagging tickets. Zammad |Karma will decrease| when you have re-opend tickets, escalated tickets or tickets that are two or more days overdue.")),h.push("</p>\n\n<!--\n<p>"),h.push(this.T('You\u2019re able to set goals regarding the number of tickets you want to answer or close you want to complete either daily or weekly. Reaching these self-set goals will result in bonus Karma. Zammad also tracks how many days/weeks you have attained your goals, and achieving ongoing "streaks" will similarly result in positive Karma.')),h.push("</p>\n\n\n<h2>"),h.push(this.T("Karma Trends")),h.push("</h2>\n\n\n<h2>"),h.push(this.T("last week")),h.push("</h2>\n\n\n<h2>"),h.push(this.T("last month")),h.push("</h2>\n-->\n\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,h.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/keyboard_shortcuts"]=function(t){t||(t={});var P=[],I=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T,A,S,C,x,j;for(P.push('<div class="horizontal">\n  <div class="flex">\n'),e=0,a=(b=this.areas).length;e<a;e++){if(t=b[e],P.push("\n  "),"left"===t.location){for(P.push("\n    <h2>"),P.push(this.T(t.headline)),P.push("</h2>\n    "),i=0,l=(w=t.content).length;i<l;i++){for(n=w[i],P.push("\n      "),n.where&&(P.push("<p><i>"),P.push(this.T(n.where)),P.push("</i></p>")),P.push("\n      "),s=0,c=(k=n.shortcuts).length;s<c;s++){if(j=k[s],P.push("\n        "),j.hotkeys&&(P.push("\n          <kbd>"),P.push(this.hotkeys.join("</kbd> <kbd>")),P.push("</kbd>\n        ")),P.push("\n        "),j.keyPrefix&&(P.push("\n          "),P.push(I(j.keyPrefix)),P.push("\n        ")),P.push("\n        "),_.isArray(j.key)){for(P.push("\n          "),o=0,p=(T=j.key).length;o<p;o++)r=T[o],P.push("\n            <kbd>"),P.push(r),P.push("</kbd>\n          ");P.push("\n        ")}else P.push("\n          <kbd>"),P.push(j.key),P.push("</kbd>\n        ");P.push("\n        "),P.push(this.T(j.description)),P.push("<br>\n      ")}P.push("\n    ")}P.push("\n  ")}P.push("\n")}for(P.push('\n  </div>\n  <div class="flex">\n'),m=0,u=(A=this.areas).length;m<u;m++){if(t=A[m],P.push("\n  "),"right"===t.location){for(P.push("\n    <h2>"),P.push(this.T(t.headline)),P.push("</h2>\n    "),g=0,h=(S=t.content).length;g<h;g++){for(n=S[g],P.push("\n      "),n.where&&(P.push("<p><i>"),P.push(this.T(n.where)),P.push("</i></p>")),P.push("\n      "),v=0,d=(C=n.shortcuts).length;v<d;v++){if(j=C[v],P.push("\n        "),j.hotkeys?(P.push("\n          <kbd>"),P.push(this.hotkeys.join("</kbd> <kbd>")),P.push("</kbd>\n        ")):j.magicKey&&(P.push("\n          <kbd>"),P.push(I(this.magicKey)),P.push("</kbd>\n        ")),P.push("\n        "),j.keyPrefix&&(P.push("\n          "),P.push(I(j.keyPrefix)),P.push("\n        ")),P.push("\n        "),_.isArray(j.key)){for(P.push("\n          "),y=0,f=(x=j.key).length;y<f;y++)r=x[y],P.push("\n            <kbd>"),P.push(r),P.push("</kbd>\n          ");P.push("\n        ")}else P.push("\n          <kbd>"),P.push(j.key),P.push("</kbd>\n        ");P.push("\n        "),P.push(this.T(j.description)),P.push("<br>\n      ")}P.push("\n    ")}P.push("\n  ")}P.push("\n")}P.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,P.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/_answer_attachments"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(this.attachments){for(s.push('\n<div class="knowledge-base-article-attachments">\n\t<h2>'),s.push(this.Ti("Attachments")),s.push('</h2>\n\t<ul class="knowledge-base-article-attachments-list">\n\t'),e=0,n=(i=this.attachments).length;e<n;e++)t=i[e],s.push('\n\t<li>\n\t\t<a class="btn" href="'),s.push(r(t.url)),s.push('" download>\n\t\t\t'),s.push(this.Icon("download")),s.push("\n\t\t\t<span>"),s.push(r(t.filename)),s.push("</span>\n\t\t</a>\n\t</li>\n\t");s.push("\n\t</ul>\n</div>\n")}s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/_icon_with_modifier"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<span class="modified-icon '),e.push(n(this.className)),e.push('">\n  '),this.item.iconFont?(e.push("\n    "),e.push(this.fontIcon(this.item.icon,this.iconset,"section-inner-icon"))):(e.push("\n    "),e.push(this.Icon(this.item.icon,"section-inner-icon"))),e.push("\n  "),e.push("\n  "),e.push(this.Icon(this.item.state+"-modifier","modified-icon-modifier")),e.push("\n</span>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/_reader_answer_meta"]=function(t){t||(t={});var n=[],i=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},e=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e;n.push(this.T(this.answer.can_be_published_state())),n.push("\n\n"),(e=this.answer.can_be_published_by())&&(n.push("\n  "),n.push(this.T("by")),n.push("\n  "),n.push(i(e.displayName())),n.push("\n")),n.push("\n\n"),(t=this.answer.can_be_published_at())&&(n.push("\n  "),n.push(this.humanTime(t)),n.push("\n")),n.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=s,n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/_reader_linked_tickets"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t;(null!=(t=this.tickets)?t.length:void 0)&&(e.push('\n  <div class="attachments attachments--list">\n    '),e.push(this.Icon("overviews")),e.push('\n    <div class="attachments-title">\n      '),e.push(this.T("Linked Tickets")),e.push(' <span class="badge">'),e.push(this.tickets.length),e.push("</span>\n    </div>\n    "),e.push(this.V("generic/ticket_list",{show_max:5,tickets:this.tickets})),e.push("\n  </div>\n")),e.push("\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/_reader_list_item"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<a href="'),e.push(this.item.url),e.push('">\n  <span class="section-inner">\n    '),e.push(this.iconWithModifier(this.item,{className:"section-inner-icon-holder",iconset:this.iconset,addStateClass:!0})),e.push("\n    <span>"),e.push(n(this.item.title)),e.push("</span>\n  </span>\n</a>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/_reader_pagination"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){this.previousAnswer&&(e.push('\n  <a href="'),e.push(this.previousAnswer.url),e.push('" class="knowledge-base-article-nav-link knowledge-base-article-nav-link--prev">\n    '),e.push(this.Icon("arrow-left")),e.push('\n    <div class="spacer"></div>\n    <span class="knowledge-base-article-nav-link-title">'),e.push(n(this.previousAnswer.title)),e.push("</span>\n  </a>\n")),e.push("\n\n"),this.nextAnswer&&(e.push('\n  <a href="'),e.push(this.nextAnswer.url),e.push('" class="knowledge-base-article-nav-link knowledge-base-article-nav-link--next">\n    <span class="knowledge-base-article-nav-link-title">'),e.push(n(this.nextAnswer.title)),e.push('</span>\n    <div class="spacer"></div>\n    '),e.push(this.Icon("arrow-right")),e.push("\n  </a>\n")),e.push("\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/agent"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="knowledge-base-navigation js-navigation"></div>\n\n<div class="knowledge-base-body horizontal flex js-body">\n  <div class="js-sidebar sidebar knowledge-base-sidebar">\n  </div>\n\n  <div class="flex vertical page-content knowledge-base-main">\n  </div>\n\n  <div class="js-content">\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseForm=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.render()}return n(e,t),e.prototype.events={"submit form":"submit","hidden.bs.tab":"didHide"},e.prototype.additionalButtons=[],e.prototype.didHide=function(){var t;return null!=(t=this.formControllers)?t.forEach(function(t){return t.hideAlert()}):void 0},e.prototype.className="page-content",e.prototype.split=!1,e.prototype.buildFormController=function(t){var e;return e=this.split&&_.values(App.Model.attributesGet(t,App.KnowledgeBase.configure_attributes))[0].horizontal,new App.ControllerForm({screen:t,params:this.object().attributes(),model:App.KnowledgeBase,formClass:"settings-entry",fullForm:!e,fullFormSubmitAdditionalClasses:"btn--primary",fullFormButtonsContainerClass:"justify-end",fullFormAdditionalButtons:this.additionalButtons,parentController:this})},e.prototype.wrapFormElement=function(t){return t.fullForm?t.form:new App.KnowledgeBaseVerticalForm({form:t}).el},e.prototype.render=function(){var e,t,n,i;return e="admin_"+this.screen,t=this.split?_.flatten(App.KnowledgeBase.configure_attributes.map(function(t){return Object.keys(t.screen)})).filter(function(t){return t.match(e)}):[e],this.formControllers=t.map((n=this,function(t){return n.buildFormController(t)})),this.html(this.formControllers.map((i=this,function(t){return i.wrapFormElement(t)})))},e.prototype.object=function(){return App.KnowledgeBase.find(this.knowledge_base_id)},e.prototype.scrollTop=function(){return this.el.closest(".main").animate({scrollTop:0})},e.prototype.prepareParams=function(t,e){var n,i,s,r,o,a;for(r in a=[],o=App.KnowledgeBase.attributesGet(e))n=o[r],s=this.$("."+n.tag+"[data-attribute-name="+n.name+"]"),a.push("function"==typeof(i=App.UiElement[n.tag]).prepareParams?i.prepareParams(n,s,t):void 0);return a},e.prototype.submit=function(e){var n,t,i,s;return this.preventDefaultAndStopPropagation(e),n=this.formControllers.filter(function(t){return t.form[0]===e.currentTarget||e.currentTarget.contains(t.form[0])})[0],t=this.formParam(n.form),this.prepareParams(t,n.screen),this.formDisable(this.el),n.hideAlert(),this.ajax({type:"PATCH",data:JSON.stringify(t),url:this.object().manageUrl()+"?full=true",success:(s=this,function(t){return App.Collection.loadAssets(t.assets),s.formEnable(s.el),s.scrollTop()}),error:(i=this,function(t){var e;return i.formEnable(i.el),n.showAlert((null!=(e=t.responseJSON)?e.error:void 0)||"Unable to  save changes"),i.scrollTop()})})},e}(App.Controller),App.KnowledgeBaseCustomAddressForm=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.events={"click .js-snippets":"openSnippetsModal"},e.prototype.elements={".js-snippets":"snippetsModalButton"},e.prototype.additionalButtons=[{className:"js-snippets",text:"Web Server Configuration"}],e.prototype.formEnable=function(t){return e.__super__.formEnable.apply(this,arguments),this.updateSnippetsModalButton()},e.prototype.render=function(){return e.__super__.render.apply(this,arguments),this.updateSnippetsModalButton()},e.prototype.updateSnippetsModalButton=function(){var t,e;return e=0<(null!=(t=this.object().attributes().custom_address)?t.length:void 0),this.snippetsModalButton.attr("disabled",!e)},e.prototype.openSnippetsModal=function(t){var e,n,i;return this.preventDefaultAndStopPropagation(t),(e=t.currentTarget).disabled=!0,this.ajax({id:"knowledge_bases_init_admin",type:"GET",url:this.object().manageUrl("server_snippets"),processData:!0,success:(i=this,function(t){return e.disabled=!1,new App.KnowledgeBaseServerSnippet({container:i.el.closest(".main"),snippets:t.snippets,address:t.address,address_type:t.address_type})}),error:(n=this,function(t){if(e.disabled=!1,422===t.status)return new App.ControllerErrorModal({message:t.responseJSON.error,container:n.el.closest(".main")})})})},e}(App.KnowledgeBaseForm)}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/content"]=function(t){t||(t={});var n=[],e=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e;this.missingTranslation()&&(n.push('\n  <div class="js-alert alert alert--warning alert--square">'),n.push(this.T("No translation for this locale available")),n.push("</div>\n")),n.push('\n\n<div class="main flex vertical end">\n  <div class="page-header">\n    <div class="page-header-title">\n      <h2>'),n.push(this.T(this.object.objectActionName())),n.push("</h2>\n      "),("function"==typeof(t=this.object.constructor).canBePublished?t.canBePublished():void 0)&&(n.push("\n        "),n.push(this.V("knowledge_base/content_can_be_published_header_suffix",{object:this.object})),n.push("\n      ")),n.push('\n    </div>\n  </div>\n  <form class="form--grid js-form"></form>\n\n  <div class="horizontal">\n    <a class="btn btn js-discard hide">\n      '),n.push(this.T("Discard your unsaved changes.")),n.push("\n    </a>\n\n    "),("function"==typeof(e=this.object.constructor).canBePublished?e.canBePublished():void 0)?n.push('\n      <div class="js-submitContainer"></div>\n    '):(n.push('\n      <a class="btn btn--primary js-submit">\n        '),n.push(this.T("Update")),n.push("\n      </a>\n    ")),n.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=i,n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/content_can_be_published_header_suffix"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t
).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<span class="suffix js-published-header-suffix">\n  <span class="'),e.push(n(this.object.can_be_published_state_css())),e.push('"><span class="label-text">'),e.push(this.T(this.object.can_be_published_state())),e.push("</span></span>\n\n  "),this.object.can_be_published_internal_in_future()&&(e.push('\n    <span class="label-warning"><span class="label-text">'),e.push(this.T("Will be internal")),e.push(" "),e.push(this.humanTime(this.object.internal_at)),e.push("</span></span>\n  ")),e.push("\n\n  "),this.object.can_be_published_publish_in_future()&&(e.push('\n    <span class="label-warning"><span class="label-text">'),e.push(this.T("Will be published")),e.push(" "),e.push(this.humanTime(this.object.published_at)),e.push("</span></span>\n  ")),e.push("\n\n  "),this.object.can_be_published_archive_in_future()&&(e.push('\n    <span class="label-warning"><span class="label-text">'),e.push(this.T("Will be archived")),e.push(" "),e.push(this.humanTime(this.object.archived_at)),e.push("</span></span>\n  ")),e.push("\n</span>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseDelete=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.isTitleMatching=function(){var t;return t=this.object().guaranteedTitle(),this.formParam(this.el).title===t},e.prototype.submit=function(t){var n,i,s,e;{if(this.preventDefaultAndStopPropagation(t),n=this.formControllers[0],this.isTitleMatching())return n.hideAlert(),i=new App.ControllerModalLoading({container:this.parentVC.el}),this.ajax({id:"knowledge_bases",type:"DELETE",url:this.object().manageUrl(),processData:!0,success:(e=this,function(){return i.hide(),e.parentVC.clear()}),error:(s=this,function(t){var e;return n.showAlert((null!=(e=t.responseJSON)?e.error:void 0)||s.T("Unable to proccess request")),i.hide()})});n.showAlert(App.i18n.translateInline("Confirmation failed."))}},e.prototype.buildFormController=function(){return new App.ControllerForm({fullForm:!0,formClass:"settings-entry",fullFormButtonsContainerClass:"justify-end",fullFormSubmitLabel:"Delete Knowledge Base",fullFormSubmitAdditionalClasses:"btn--danger",model:{configure_attributes:[{name:"title",model:"translation",style:"block","null":!0,display:"Permanently Delete Knowledge Base",help:'Deleting your knowledge base requires an additional verification step. To proceed, enter its name below ("'+this.object().guaranteedTitle()+'"). THIS ACTION CANNOT BE UNDONE.',tag:"input"}]}})},e}(App.KnowledgeBaseForm)}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/navigation"]=function(t){t||(t={});var c=[],p=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l;for(c.push('<nav class="breadcrumbs">\n  '),t=0,i=(o=this.crumbs).length;t<i;t++)e=o[t],c.push('\n    <a class="breadcrumb" '),e.url&&(c.push('href="'),c.push(p(e.url))),c.push('">\n      '),e.icon&&(c.push("\n        "),c.push(this.iconWithModifier(e,{iconset:this.iconset})),c.push("\n      ")),c.push("\n\n      "),c.push(p(e.title)),c.push("\n    </a>\n  ");for(c.push('\n</nav>\n\n<div class="breadcrumbs-menu">\n  <a href="'),c.push(p(this.search.url)),c.push('"\n     class="btn btn--action js-search '),this.search.enabled&&c.push("btn--active"),c.push('"\n     >\n    '),c.push(this.Icon("magnifier")),c.push('\n  </a>\n  <a href="'),c.push(p(this.externalUrl)),c.push('"\n     target=_blank\n     '),this.externalUrl||c.push("disabled"),c.push('\n     class="btn btn--action"\n     >\n    '),c.push(this.Icon("external")),c.push("\n  </a>\n  "),this.edit.available&&(c.push('\n    <a href="'),c.push(p(this.edit.url)),c.push('"\n      class="btn btn--action js-edit '),this.edit.enabled&&c.push("btn--active"),c.push('"\n      '),this.search.enabled&&c.push("disabled"),c.push("\n      >\n      "),c.push(this.T("Edit")),c.push("\n    </a>\n  ")),c.push('\n  <div class="btn btn--action btn--split--first js-pickedLanguage">'),c.push(p(null!=(a=this.kbLocales.selected)?a.systemLocale().locale:void 0)),c.push('</div>\n  <div class="dropdown dropdown--actions">\n    <div class="btn btn--action btn--split--last btn--slim centered" data-toggle="dropdown" aria-expanded="false">\n      '),c.push(this.Icon("arrow-down")),c.push('\n    </div>\n    <ul class="dropdown-menu dropdown-menu-'),c.push(p(this.dir("right","left"))),c.push(' dropdown-menu-full-height" role="menu">\n      '),n=0,s=(l=this.kbLocales.collection).length;n<s;n++)r=l[n],c.push('\n        <li role="presentation">\n          <a href="'),c.push(p(r.url)),c.push('" role="menuitem" tabindex="-1">\n            '),c.push(p(r.title)),c.push("\n\n            "),r.id===this.kbLocales.selected.id&&(c.push('\n              <span class="dropdown-selectedSpacer is-selected">\n                '),c.push(this.Icon("checkmark")),c.push("\n              </span>\n            ")),c.push("\n          </a>\n        </li>\n      ");c.push("\n    </ul>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,c.join("")}}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseNewModal=function(t){function e(){this.formController=new App.ControllerForm({model:App.KnowledgeBase,params:this.item,screen:this.screen,autofocus:!1}),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.head="Create Knowledge Base",e.prototype.screen="admin_create",e.prototype.buttonClose=!1,e.prototype.buttonCancel=!1,e.prototype.backdrop="static",e.prototype.keyboard=!1,e.prototype.content=function(){return this.formController.form},e.prototype.prepareParams=function(t){var e,n,i,s,r,o;for(s in o=[],r=App.KnowledgeBase.attributesGet(this.screen))e=r[s],i=this.$("."+e.tag+"[data-attribute-name="+e.name+"]"),o.push("function"==typeof(n=App.UiElement[e.tag]).prepareParams?n.prepareParams(e,i,t):void 0);return o},e.prototype.applyDefaults=function(t){return t.iconset="FontAwesome",t.color_highlight="#38ae6a",t.color_header="#f9fafb",t.homepage_layout="grid",t.category_layout="grid"},e.prototype.onSubmit=function(){var t,n,e;return t=this.formParams(this.el),this.prepareParams(t),this.applyDefaults(t),this.formDisable(this.el),this.ajax({type:"POST",data:JSON.stringify(t),url:App.KnowledgeBase.manageUrl,success:(e=this,function(){return e.parentVC.fetchAndRender(),e.parentVC.modal=void 0,e.close()}),error:(n=this,function(t){var e;return n.formEnable(n.el),n.formController.showAlert((null!=(e=t.responseJSON)?e.error:void 0)||"Couldn't create Knowledge Base")})})},e}(App.ControllerModal)}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/public_menu_form_item"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div data-kb-locale-id="'),s.push(r(this.kb_locale_id)),s.push('" class="settings-entry">\n  <h2>'),s.push(r(this.title)),s.push('</h2>\n\n  <div class="js-alert alert alert--danger hidden"></div>\n\n  <div class="form-group">\n    <table class="settings-list settings-list--stretch">\n      <thead>\n        <tr>\n          <th style="width: 36px" class="table-draggable">\n          <th style="width: 200px">\n            '),s.push(this.T("Title")),s.push("\n          <th>\n            "),s.push(this.T("URL")),s.push("\n          <th>\n            "),s.push(this.T("Target")),s.push('\n          <th style="width: 44px">\n            '),s.push(this.T("Delete")),s.push("\n      <tbody>\n        "),t=0,n=(i=this.rows).length;t<n;t++)e=i[t],s.push("\n          "),s.push(this.V("knowledge_base/public_menu_form_item_row",{item:e})),s.push("\n        ");s.push('\n        <tr>\n          <td>\n          <td class="settings-list-control-cell" colspan="4">\n            <a class="btn btn--text btn--create js-add">\n              '),s.push(this.Icon("plus-small")),s.push(" "),s.push(this.T("Add")),s.push("\n            </a>\n    </table>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/public_menu_form_item_row"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;i.push('<tr class="sortable" '),this.item&&(i.push('data-id="'),i.push(s(this.item.id)),i.push('"')),i.push('>\n  <td class="table-draggable">'),i.push(this.Icon("draggable")),i.push('</td>\n  <td class="settings-list-control-cell">\n    <input class="form-control form-control--small" type="text" data-name="title" placeholder="Title" value="'),i.push(s(null!=(t=this.item)?t.title:void 0)),i.push('">\n  <td class="settings-list-control-cell">\n    <input class="form-control form-control--small" type="text" data-name="url" placeholder="http://url" value="'),i.push(s(null!=(e=this.item)?e.url:void 0)),i.push('">\n  <td class="settings-list-control-cell settings-list-checkbox-cell">\n    <label class="inline-label checkbox-replacement js-new-tab">\n      <input type="checkbox" value="1" data-name="new_tab" '),(null!=(n=this.item)?n.new_tab:void 0)&&i.push("checked"),i.push('>\n      <svg class="icon icon-checkbox icon-unchecked"><use xlink:href="assets/images/icons.svg#icon-checkbox"></use></svg>\n      <svg class="icon icon-checkbox-checked icon-checked"><use xlink:href="assets/images/icons.svg#icon-checkbox-checked"></use></svg>\n      <span class="label-text">'),i.push(this.T("New tab")),i.push('</span>\n    </label>\n\n  <td class="settings-list-controls u-positionOrigin">\n    <span class="checkbox-replacement checkbox-replacement--fullscreen js-remove">\n      <input type="checkbox" name="showTitle" value="true">\n      '),i.push(this.Icon("checkbox","icon-unchecked")),i.push("\n      "),i.push(this.Icon("checkbox-checked","icon-checked")),i.push("\n    </span>\n</tr>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/public_menu_manager"]=function(t){t||(t={});var h=[],d=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u;for(h.push("<h2>\n  "),h.push(this.T("Public Menu")),h.push('\n</h2>\n\n<p class="help-text">\n  '),h.push(this.T("Here you can add further links to your public FAQ page, which will be displayed either in the header or footer.")),h.push("\n</p>\n\n"),t=0,r=(p=this.locations).length;t<r;t++){for(l=p[t],h.push('\n  <div class="settings-entry kb-menu-settings-entry">\n    <h3>'),h.push(d(this.T(l.headline))),h.push("</h3>\n\n    "),n=0,o=(u=this.locales).length;n<o;n++){if(s=u[n],h.push('\n      <div class="kb-menu-preview">\n        <div class="label">'),h.push(d(s.systemLocale().name)),h.push('</div>\n\n        <div class="kb-menu-preview-container kb-menu-preview-container--'),h.push(d(l.identifier)),h.push('" style="background-color: '),h.push(d(l.color)),h.push('">\n          '),c=App.KnowledgeBaseMenuItem.using_kb_locale_location(s,l.identifier),h.push("\n\n          "),0===c.length)h.push('\n            <span class="text-muted">'),h.push(d(this.T("Empty"))),h.push("</span>\n          ");else{for(h.push("\n            "),i=0,a=c.length;i<a;i++)e=c[i],h.push('\n              <a href="'),h.push(d(e.url)),h.push('" target="_blank">'),h.push(d(e.title)),h.push("</a>\n            ");h.push("\n          ")}h.push("\n        </div>\n      </div>\n    ")}h.push('\n\n    <a\n      class="btn btn--primary js-edit btn-manage-public-menu-edit"\n      href="#"\n      data-target-location="'),h.push(d(l.identifier)),h.push('"\n      data-target-locale="'),h.push(d(s.id)),h.push('">\n\n      '),h.push(d(this.T("Edit"))),h.push("\n    </a>\n  </div>\n")}h.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,h.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/reader"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="container">\n  <div class="knowledge-base-article">\n    '),this.search_return_url&&(e.push('\n      <a href="'),e.push(n(this.search_return_url)),e.push('" class="knowledge-base-article-nav-link knowledge-base-article-nav-link--prev">\n        '),e.push(this.Icon("arrow-left")),e.push('\n        <div class="spacer"></div>\n        <span class="knowledge-base-article-nav-link-title">'),e.push(this.T("Back to search results")),e.push("</span>\n      </a>\n    ")),e.push('\n\n    <h1 class="knowledge-base-article-header js-answer-title"></h1>\n\n    <small class="knowledge-base-article-meta js-answer-meta"></small>\n\n    <div class="knowledge-base-article-body">\n      <div class="knowledge-base-article-content richtext-content js-answer-body"></div>\n      <div class="knowledge-base-article-attachments js-answer-attachments"></div>\n      <div class="knowledge-base-article-linked-tickets js-answer-linked-tickets"></div>\n    </div>\n\n    <div class="js-answer-pagination"></div>\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/reader_list"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="container">\n  <div class="js-searchFieldContainer"></div>\n  <div class="js-readerListContainer"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/scheduled_widget"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push(this.Icon("clock")),e.push('\n<div class="scheduled-widget-label">'),e.push(this.T("Scheduled for")),e.push(" "),e.push(this.timestamp),e.push('</div>\n<a class="btn btn--action btn--small scheduled-widget-delete js-delete">\n  '),e.push(this.Icon("diagonal-cross")),e.push("<span>"),e.push(this.T("Cancel")),e.push("\n</a>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/search"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="container">\n  <div class="js-searchFieldContainer"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/search_field_panel"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="searchfield"></div>\n\n<div class="js-placeholderEmpty help-block help-block--center hide">\n  '),e.push(this.Icon("mood-ok")),e.push("\n  <div class='help-block--inner'>"),e.push(this.T("Empty")),e.push('</div>\n</div>\n\n<div class="js-placeholderError help-block help-block--center hide">\n  '),e.push(this.Icon("mood-superbad")),e.push("\n  <div class='help-block--inner'></div>\n</div>\n\n<ul class=\"js-results sections sections--list\"></ul>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/search_field_widget"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<input class="js-searchField form-control" name="query" placeholder="'),e.push(this.Ti("Search")),e.push(" "),e.push(n(this.placeholder_suffix)),e.push('" type="search" autocomplete="off">\n'),e.push(this.Icon("magnifier")),e.push('\n<div class="search-loader">'),e.push(this.Icon("spinner-small")),e.push('</div>\n<a class="empty-search js-emptySearchButton">\n  '),e.push(this.Icon("diagonal-cross")),e.push("\n</a>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/search_item"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<a href="'),e.push(n(this.data.url)),e.push('">\n  <span class="section-inner">\n    '),e.push(this.iconWithModifier(this.data,{className:"section-inner-icon-holder",iconset:this.iconset,addStateClass:!0})),e.push('\n    <span class="section-inner-text">\n      <span class="section-inner-title">'),e.push(this.data.title),e.push('</span>\n      <span class="section-inner-detail">\n        <span class="section-inner-date">'),e.push(this.humanTime(this.data.date)),e.push("</span> "),this.data.body&&(e.push('<span class="section-inner-body">'),e.push(this.data.body),e.push("</span>")),e.push("\n      </span>\n    </span>\n  </span>\n</a>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseServerSnippet=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.head="Web Server Configuration",e.prototype.className="modal modal-knowledge-base-server-snippet",e.prototype.buttonSubmit=!1,e.prototype.initalFormParamsIgnore=!0,e.prototype.servers=[{id:"nginx",name:"Nginx",active:!0},{id:"apache",name:"Apache"}],e.prototype.content=function(){var t,e,n,i;for(t=0,e=(n=this.servers).length;t<e;t++)(i=n[t]).snippet=this.snippets[i.id];return $(App.view("knowledge_base/server_snippet")({address_type:this.address_type,address:this.address,servers:this.servers}))},e}(App.ControllerModal)}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/server_snippet"]=function(t){t||(t={});var a=[],l=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o;for(a.push('<div class="server-snippet">\n  <p>'),a.push(this.T("Configuration for %s",this.address_type)),a.push(" <strong>"),a.push(l(this.address)),a.push('</strong>:</p>\n  <ul class="nav nav-tabs" role="tablist">\n  '),t=0,n=(s=this.servers).length;t<n;t++)o=s[t],a.push("\n    <li"),o.active&&a.push(' class="active"'),a.push('><a href="#'),a.push(l(o.id)),a.push('" role="tab" data-toggle="tab">'),a.push(l(o.name)),a.push("</a>\n  ");for(a.push('\n  </ul>\n  <div class="tab-content">\n    '),e=0,i=(r=this.servers).length;e<i;e++)o=r[e],a.push('\n    <div class="tab-pane'),o.active&&a.push(l(" active")),a.push('" role="tabpanel" id="'),a.push(l(o.id)),a.push('">\n      <textarea class="form-control" rows="11" readonly>'),a.push(l(o.snippet)),a.push("</textarea>\n    </div>\n    ");a.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,a.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/sidebar/actions"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(l.push('<div class="btn-list js-content-actions-container vertical start">\n  '),e=0,i=(o=this.actions).length;e<i;e++){if(t=o[e],l.push('\n    <a class="btn btn--text" data-action="'),l.push(c(t.action)),l.push('" '),l.push(c(t.disabled?"disabled":void 0)),l.push(">\n      "),t.iconName&&(l.push(" "),l.push(this.Icon(t.iconName)),l.push(" ")),l.push("\n      "),t.name instanceof Object){for(l.push("\n        "),n=0,s=(a=t.name).length;n<s;n++)r=a[n],l.push("\n          "),l.push(this.T(r)),l.push("\n        ");l.push("\n      ")}else l.push("\n        "),l.push(this.T(t.name)),l.push("\n      ");l.push("\n    </a>\n  ")}l.push("\n</div>\n\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/sidebar/attachments"]=function(t){t||(t={});var r=[],o=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s;if(r.push('<div class="sidebar-block-header">\n  <h2>'),r.push(this.T("Attachments")),r.push('</h2>\n</div>\n\n<div class="dropContainer">\n  '),0<this.attachments.length){for(r.push('\n    <ol class="tasks tasks--standalone">\n      '),e=0,n=(i=this.attachments).length;e<n;e++)t=i[e],r.push('\n        <li class="task">\n          <div class="task-text">\n            <a class="name" target=_blank href="'),r.push(o(t.url)),r.push('">\n              '),r.push(o(t.filename)),r.push('\n            </a>\n          </div>\n\n          <a class="list-item-delete js-delete" data-object-id="'),r.push(o(t.id)),r.push('" href="#">\n            '),r.push(this.Icon("diagonal-cross")),r.push("\n          </a>\n        </li>\n      ");r.push("\n    </ol>\n  ")}r.push('\n\n  <div class="attachmentUpload attachmentUpload--standalone hide">\n    <div class="horizontal">\n      <div class="u-highlight flex-space-after">\n        '),r.push(this.T("Uploading")),r.push(' (<span class="js-percentage">0</span>%) ...\n      </div>\n      <div class="attachmentUpload-cancel js-cancel">\n        '),r.push(this.Icon("diagonal-cross")),r.push('\n      </div>\n    </div>\n    <div class="attachmentUpload-progressBar" style="width: 0%"></div>\n  </div>\n\n  <div class="fileUpload btn btn--action btn--small">\n    '),r.push(this.Icon("plus-small")),r.push(" \n    "),s=_.uniqueId("fileUpload_"),r.push('\n    <input multiple="multiple" type="file" name="file" id="'),r.push(s),r.push('">\n    <label class="attachmentPlaceholder-label" for="'),r.push(s),r.push('">\n      <span>'),r.push(this.T("Add")),r.push('</span>\n    </label>\n  </div>\n\n  <div class="dropArea dropArea--small">\n    <div class="dropArea-inner">\n      '),r.push(this.T("Drop files here")),r.push("\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,r.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/sidebar/generic_list"]=function(t){t||(t={});var o=[],a=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r;if(o.push('<div class="sidebar-block-header">\n  <h2>'),o.push(this.T(this.title)),o.push('</h2>\n</div>\n\n<div class="btn-list horizontal">\n  <a href="#" class="btn btn--action btn--small btn--create js-add" '),this.enabled||o.push("disabled"),o.push(" >\n    "),o.push(this.Icon("plus-small")),o.push(" <span>"),o.push(this.T("Add")),o.push('</span>\n  </a>\n  <a href="#" class="js-reorder btn btn--action btn--small" '),this.enabled||o.push("disabled"),o.push(">\n    "),o.push(this.Icon("rearange")),o.push(" <span>"),o.push(this.T("Change order")),o.push('</span>\n  </a>\n</div>\n\n<ul class="kb-sidebar-block-content nav nav-pills nav-stacked">\n  '),0<this.items.length){for(o.push("\n    "),e=0,i=(s=this.items).length;e<i;e++){if(t=s[e],o.push('\n      <li>\n        <a href="'),o.push(a(t.url)),o.push('" class="'),o.push(a(t.className)),o.push('">\n          '),o.push(this.iconWithModifier(t,{className:"section-inner-icon-holder",iconset:this.iconset,addStateClass:!0})),o.push('\n          <span class="u-textTruncate">'),o.push(a(t.title)),o.push("</span>\n\n          "),t.icons){for(n in o.push('\n          <span class="flex-spacer"></span>\n            '),r=t.icons)r[n],o.push("\n              "),o.push(this.Icon(n)),o.push("\n            ");o.push("\n          ")}o.push("\n\n          "),null!==t.count&&(o.push('\n            <span class="badge badge--text">'),o.push(a(t.count)),o.push("</span>\n          ")),o.push("\n        </a>\n      </li>\n    ")}o.push("\n  ")}else o.push('\n    <li>\n      <span class="nav-pills-placeholder">'),o.push(this.T(this.emptyNote)),o.push("</span>\n    </li>\n  ");o.push("\n</ul>\n\n")}).call(this)}.call(t),t.safe=e,t.escape=n,o.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/sidebar/linked_tickets"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="sidebar-block-header">\n  <h2>'),e.push(this.T("Linked Tickets")),e.push("</h2>\n</div>\n\n"),e.push(this.V("generic/ticket_list",{show_max:5,tickets:this.tickets,object:"Ticket"})),e.push('\n\n<a class="btn btn--action btn--small js-add" href="#">\n  '),e.push(this.Icon("plus-small")),e.push(" <span>"),e.push(this.T("Add")),e.push("</span>\n</a>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/knowledge_base/vertical_form"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form class="settings-entry" id="'),e.push(n(this.attribute.name)),e.push('">\n  <h2>'),e.push(this.T(this.attribute.display)),e.push('</h2>\n  <p class="help-text">'),e.push(this.T(this.attribute.help)),e.push('</p>\n  <div class="horizontal end">\n    <div class="form-item flex '),e.push(n(this.attribute.tag)),e.push('"></div>\n    <button type="submit" class="btn btn--primary">'),e.push(this.T("Submit")),e.push("</button>\n  </div>\n</form>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/link/kb_answer"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push("<label>"),s.push(this.T("Related Answers")),s.push('</label>\n<ol class="tasks tasks--standalone">\n  '),t=0,n=(i=this.list).length;t<n;t++)e=i[t],s.push('\n    <li class="task">\n      <div class="icon-holder">\n      \t'),s.push(this.Icon("knowledge-base")),s.push('\n      </div>\n      <div class="task-text">\n        <a class="name kb-answer-popover" data-id="'),s.push(e.id),s.push('" href="'),s.push(e.url),s.push('">'),s.push(r(e.title)),s.push('</a>\n      </div>\n      <a class="list-item-delete js-delete" data-object="KnowledgeBase::Answer::Translation" data-object-id="'),s.push(r(e.id)),s.push('" data-link-type="normal">\n        '),s.push(this.Icon("diagonal-cross")),s.push("\n      </a>\n  ");s.push('\n</ol>\n<div class="text-muted js-add u-clickable">+ '),s.push(this.T("Link Related Answer")),s.push("</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/link/ticket/add"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push("<fieldset>\n  "),1<this.link_types.length&&(s.push("\n    "),s.push(this.T("Link")),s.push("\n    "),s.push(this.T(this.link_object)),s.push("\n  ")),s.push('\n  <input type="text" name="ticket_number" value="" class="span2" required/>\n\n  '),1<this.link_types.length){for(s.push("\n    "),s.push(this.T("as")),s.push('\n    <select name="link_type" class="span2" required>\n      '),t=0,e=(i=this.link_types).length;t<e;t++)n=i[t],s.push('\n        <option value="'),s.push(r(n[0])),s.push('">'),s.push(this.T(n[1])),s.push("</option>\n      ");s.push("\n    </select>\n    "),s.push(this.T("of")),s.push("\n    Ticket#\n    "),s.push(r(this.object.number)),s.push(".\n  ")}else s.push('\n    <input type="hidden" name="link_type" value="'),s.push(r(this.link_types[0][0])),s.push('"/>\n  ');s.push("\n\n  "),this.hasByCustomer&&(s.push("\n    <hr>\n    <h4>"),s.push(this.T("Recent Customer Tickets")),s.push(
'</h4>\n    <div id="ticket-merge-customer-tickets"></div>\n  ')),s.push("\n\n  "),this.hasRecentViewed&&(s.push("\n    <hr>\n    <h4>"),s.push(this.T("Recent viewed Tickets")),s.push('</h4>\n    <div id="ticket-merge-recent-tickets"></div>\n  ')),s.push("\n</fieldset>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/link/ticket/list"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t;for(t in e.push("<label>"),e.push(this.T("Links")),e.push("</label>\n"),this.links)e.push('\n<div class="ticketLinks">\n  <div class="list-title">'),e.push(this.T(t)),e.push("</div>\n  "),e.push(this.links[t].ticketList),e.push("\n</div>\n");e.push('\n<div class="text-muted u-clickable js-add">+ '),e.push(this.T("Add Link")),e.push("</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/login"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="login fullscreen">\n  <div class="fullscreen-center">\n    <div class="fullscreen-body">\n      <p>'),s.push(this.T("Login with %s",this.C("fqdn"))),s.push("</p>\n\n      "),this.C("maintenance_mode")&&(s.push('\n        <div class="hero-unit alert alert--danger js-maintenanceMode">'),s.push(this.T("Zammad is currently in maintenance mode. Only administrators can login. Please wait until the maintenance window is over.")),s.push("</div>\n      ")),s.push("\n      "),this.C("maintenance_login")&&this.C("maintenance_login_message")&&(s.push('\n        <div class="hero-unit alert alert--success js-maintenanceLogin">'),s.push(this.C("maintenance_login_message")),s.push("</div>\n      ")),s.push('\n\n      <div class="hero-unit">\n        <img class="company-logo" src="'),s.push(r(this.logoUrl)),s.push('" alt="'),s.push(r(this.C("product_name"))),s.push('">\n        <form id="login">\n          <div class="form-group">\n            <div class="formGroup-label">\n              <label for="username">'),s.push(this.Ti("Username / email")),s.push('</label>\n            </div>\n            <input id="username" name="username" type="text" class="form-control" value="'),s.push(r(this.item.username)),s.push('" autocapitalize="off" />\n          </div>\n\n          <div class="form-group">\n            <div class="formGroup-label">\n              <label for="password">'),s.push(this.Ti("Password")),s.push('</label>\n            </div>\n            <input id="password" name="password" type="password" class="form-control" autocomplete="off"/>\n          </div>\n\n          <div class="form-group">\n    <!--\n            <label for="remember_me">'),s.push(this.Ti("Remember me")),s.push('</label>\n            <input id="remember_me" name="remember_me" value="1" type="checkbox"/>\n    -->\n            <label class="inline-label checkbox-replacement">\n              <input name="remember_me" value="1" type="checkbox">\n              '),s.push(this.Icon("checkbox","icon-unchecked")),s.push("\n              "),s.push(this.Icon("checkbox-checked","icon-checked")),s.push('\n              <span class="label-text">'),s.push(this.T("Remember me")),s.push('</span>\n            </label>\n          </div>\n\n          <div class="form-controls">\n            <button class="btn btn--primary" type="submit">'),s.push(this.T("Sign in")),s.push("</button>\n\n            "),this.C("user_lost_password")&&(s.push('\n              <a href="#password_reset" class="btn btn--text btn--secondary align-right">'),s.push(this.T("Forgot password?")),s.push("</a>\n            ")),s.push("\n          </div>\n\n        </form>\n        "),!_.isEmpty(this.auth_providers)){for(s.push('\n          <div class="separator">\n            <span class="separator-text">'),s.push(this.T("or sign in using")),s.push('</span>\n          </div>\n\n          <div class="auth-providers">\n            '),e=0,n=(i=this.auth_providers).length;e<n;e++)t=i[e],s.push('\n              <form method="post" action="'),s.push(r(t.url)),s.push('">\n                <input type="hidden" name="authenticity_token" value="'),s.push(r(Spine.Ajax.defaults.headers["X-CSRF-Token"])),s.push('">\n                <button type="submit" class="auth-provider auth-provider--'),s.push(r(t["class"])),s.push('">\n                  '),s.push(this.Icon(t["class"]+"-button","provider-icon")),s.push('\n                  <span class="provider-name">'),s.push(this.T(t.name)),s.push("</span>\n                </button>\n              </form>\n            ");s.push("\n          </div>\n        ")}s.push("\n      </div>\n\n      <p>\n        "),s.push(this.T("You're already registered with your email address if you've been in touch with our support team.")),s.push("<br>\n        "),this.C("user_lost_password")&&(s.push("\n          "),s.push(this.T("You can request your password")),s.push(' <a href="#password_reset">'),s.push(this.T("here")),s.push("</a>.\n        ")),s.push("\n      </p>\n\n    "),this.C("user_create_account")&&(s.push('\n      <hr>\n      <p>\n        <a href="#signup">'),s.push(this.T("Register as a new customer")),s.push("</a>\n      </p>\n    ")),s.push('\n    </div>\n  </div>\n  <div class="poweredBy">\n    <a href="https://zammad.org" target="_blank">'),s.push(this.Icon("logo")),s.push("</a>\n    "),s.push(this.T("Powered by")),s.push('\n    <a href="https://zammad.org" target="_blank">'),s.push(this.Icon("logotype","logotype")),s.push("</a>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/maintenance"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),e.push(this.T("Maintenance")),e.push('<small></small></h1>\n  </div>\n</div>\n<div class="page-content">\n\n  <div class="settings-entry">\n    <div class="page-header-title">\n      <div class="zammad-switch zammad-switch--small js-modeSetting">\n         <input name="chat" type="checkbox" id="setting-mode" '),this.C("maintenance_mode")&&e.push("checked"),e.push('>\n         <label for="setting-mode"></label>\n      </div>\n      <h2>'),e.push(this.T("Mode")),e.push("</h2>\n    </div>\n    <p>\u26a0 "),e.push(this.T("Enable or disable the maintenance mode of Zammad. If enabled, _all non-administrators get logged out_ and _only administrators can start a new session_.")),e.push('</p>\n  </div>\n\n  <div class="settings-entry">\n    <div class="page-header-title">\n      <div class="zammad-switch zammad-switch--small js-loginSetting">\n         <input name="chat" type="checkbox" id="setting-login" '),this.C("maintenance_login")&&e.push("checked"),e.push('>\n         <label for="setting-login"></label>\n      </div>\n      <h2>@'),e.push(this.T("Login")),e.push("</h2>\n    </div>\n    <p>"),e.push(this.T("Put a message on the login page. To change it, click on the text area below and change it in-line.")),e.push('</p>\n    <div class="js-loginPreview"></div>\n  </div>\n\n  <div class="settings-entry">\n    <h2>'),e.push(this.T("Message")),e.push("</h2>\n    <p>"),e.push(this.T("Send a message to all logged in users.")),e.push('</p>\n    <form class="js-Message">\n      <div class="form-group">\n        <label for="maintenance-title">'),e.push(this.T("Title")),e.push('</label>\n        <div class="controls">\n          <input type="text" id="maintenance-title" name="head" class="form-control" required>\n        </div>\n      </div>\n      <div class="form-group">\n        <label for="maintenance-message">'),e.push(this.T("Message")),e.push('</label>\n        <div class="controls">\n          <div contenteditable id="maintenance-message" data-name="message" class="form-control form-control--multiline js-textarea richtext-content"></div>\n        </div>\n      </div>\n      <div class="form-group">\n        <label class="inline-label checkbox-replacement">\n          <input name="reload" type="checkbox" value="1">\n          '),e.push(this.Icon("checkbox","icon-unchecked")),e.push("\n          "),e.push(this.Icon("checkbox-checked","icon-checked")),e.push('\n          <span class="label-text">'),e.push(this.T("Reload application")),e.push('</span>\n        </label>\n      </div>\n      <button class="btn btn--primary js-submit">'),e.push(this.T("Send to clients")),e.push("</button>\n    </form>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/modal"]=function(t){t||(t={});var a=[],l=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o;if(a.push('<div class="modal-dialog">\n  '),this.includeForm&&a.push('\n    <form autocomplete="off">\n  '),a.push('\n    <div class="modal-content">\n      <div class="modal-header">\n  '),this.buttonClose&&(a.push('\n        <div class="modal-close js-close">\n          '),a.push(this.Icon("diagonal-cross")),a.push("\n        </div>\n  ")),a.push("\n  "),this.head&&(a.push('\n        <h1 class="modal-title">'),this.headPrefix&&(a.push(this.T(this.headPrefix)),a.push(": ")),a.push(this.T(this.head)),a.push("</h1>\n  ")),a.push('\n      </div>\n      <div class="modal-alerts-container"></div>\n      <div class="modal-body">\n      '),a.push(this.content),a.push('\n      </div>\n      <div class="modal-loader js-loading hide">\n        <div class="loading icon"></div>\n      </div>\n      <div class="modal-footer">\n  '),this.buttonCancel)a.push('\n        <div class="modal-leftFooter">\n          <a class="btn '),a.push(l(this.buttonCancelClass)),a.push(' js-cancel align-left" href="#">'),a.push(this.T(this.buttonCancel)),a.push("</a>\n        </div>\n  ");else if(this.leftButtons){for(a.push("\n    "),e=0,i=(r=this.leftButtons).length;e<i;e++)t=r[e],a.push('\n        <div class="modal-leftFooter">\n          <div class="btn '),a.push(l(t.className)),a.push(' align-left" href="#">'),a.push(this.T(t.text)),a.push("</div>\n        </div>\n    ");a.push("\n  ")}for(a.push("\n  "),n=0,s=(o=this.centerButtons).length;n<s;n++)t=o[n],a.push('\n        <div class="modal-centerFooter">\n          <div class="btn '),a.push(l(t.className)),a.push(' align-center">'),a.push(this.T(t.text)),a.push("</div>\n        </div>\n  ");a.push("\n  "),this.buttonSubmit&&(a.push('\n        <div class="modal-rightFooter">\n          <button type="submit" class="btn '),a.push(l(this.buttonClass)),a.push(' js-submit align-right">'),a.push(this.T(this.buttonSubmit)),a.push("</button>\n        </div>\n  ")),a.push("\n      </div>\n    </div>\n  "),this.includeForm&&a.push("\n    </form>\n  "),a.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,a.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/monitoring"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),s.push(this.T("Monitoring")),s.push('<small></small></h1>\n  </div>\n</div>\n<div class="page-content">\n\n  <div class="settings-entry">\n    <div class="page-header-title">\n      <h2>'),s.push(this.T("Current Token")),s.push('</h2>\n    </div>\n    <p><input class="js-select js-token" type="text" value="'),s.push(r(this.data.token)),s.push('" readonly></p>\n    <button class="btn btn--primary js-resetToken">'),s.push(this.T("Reset")),s.push('</button>\n  </div>\n\n  <div class="settings-entry">\n    <div class="page-header-title">\n      <h2>'),s.push(this.T("Health Check")),s.push("</h2>\n    </div>\n    <p>"),s.push(this.T("Health information can be retrieved as JSON using")),s.push(':</p>\n    <input class="js-select js-url" type="text" value="'),s.push(this.C("http_type")),s.push("://"),s.push(this.C("fqdn")),s.push("/"),s.push(this.C("api_path")),s.push("/monitoring/health_check?token="),s.push(r(this.data.token)),s.push('" readonly></p>\n  </div>\n\n  <div class="settings-entry">\n    <div class="page-header-title">\n      <h2>'),_.isEmpty(this.data.issues)?s.push(this.Icon("status","ok inline")):s.push(this.Icon("status","error inline")),s.push(" "),s.push(this.T("Current Status")),s.push("</h2>\n    </div>\n    <ul>\n      "),_.isEmpty(this.data.issues))s.push("\n        <li>"),s.push(this.T("no issues")),s.push("\n      ");else{for(s.push("\n        "),t=0,n=(i=this.data.issues).length;t<n;t++)e=i[t],s.push("\n          <li>"),s.push(r(e)),s.push("\n        ");s.push("\n      ")}s.push("\n    </ul>\n    "),_.contains(this.data.actions,"restart_failed_jobs")&&(s.push('\n      <button class="btn btn--primary js-restartFailedJobs">'),s.push(this.T("Restart failed jobs")),s.push("</button>\n    ")),s.push("\n  </div>\n\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/navigation"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="search">\n  <form class="search-holder">\n    <input id="global-search" type="search" autocomplete="off">\n    '),e.push(this.Icon("magnifier")),e.push('\n    <div class="search-loader">'),e.push(this.Icon("spinner-small")),e.push('</div>\n    <div class="empty-search js-emptySearch">\n      '),e.push(this.Icon("diagonal-cross")),e.push('\n    </div>\n  </form>\n  <div class="logo js-toggleNotifications">\n    '),e.push(this.Icon("logo")),e.push('\n    <div class="activity-counter js-notificationsCounter"></div>\n  </div>\n  <div class="global-search-menu">\n    <a href="#search" class="global-search-detail-link nav-tab nav-tab--search js-details-link">\n      <div class="nav-tab-icon">\n        '),e.push(this.Icon("searchdetail")),e.push('\n      </div>\n      <div class="nav-tab-name flex u-textTruncate">\n        '),e.push(this.T("Show Search Details")),e.push("\n        "),e.push(this.Icon("long-arrow-right")),e.push('\n      </div>\n    </a>\n    <ul class="global-search-result js-global-search-result" role="menu"></ul>\n  </div>\n</div>\n<div class="menu js-menu"></div>\n<div class="tasks tasks-navigation"></div>\n'),_.isEmpty(this.user)||e.push('\n  <ul class="user-menu navbar-items-personal"></ul>\n'),e.push("\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/navigation/menu"]=function(t){t||(t={});var a=[],l=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o;for(t=0,i=(r=this.items).length;t<i;t++){if(e=r[t],a.push("\n  "),e.child){for(a.push('\n  <div class="dropdown'),this.openTab[e.target]&&a.push(" open"),a.push('">\n    <a href="'),a.push(l(e.target)),a.push('" class="menu-item js-'),a.push(e["class"]),a.push('MenuItem dropdown-toggle" data-toggle="dropdown">\n        '),a.push(this.Icon(e["class"],"menu-item-icon")),a.push('\n        <span class="menu-item-name flex">\n          '),a.push(this.T(e.name)),a.push("\n        </span>\n        "),a.push(this.Icon("arrow-down","dropdown-icon")),a.push('\n    </a>\n    <ul class="dropdown-menu dropdown-menu--light">\n      '),n=0,s=(o=e.child).length;n<s;n++)e=o[n],a.push("\n        "),e.divider&&a.push('\n          <li class="divider"></li>\n        '),a.push("\n        "),e.navheader&&(a.push('\n          <li class="dropdown-header">'),a.push(this.T(e.navheader)),a.push("</li>\n        ")),a.push('\n        <li><a href="'),a.push(l(e.target)),a.push('">'),a.push(this.T(e.name)),void 0!==e.count&&(a.push('<span class="badge badge--text count">'),a.push(l(e.count)),a.push("</span>")),a.push("</a></li>\n      ");a.push("\n    </ul>\n  </div>\n  ")}else a.push('\n  <a class="menu-item js-'),a.push(e["class"]),a.push("MenuItem "),this.activeTab[e.target]&&a.push("is-active"),a.push(" "),e.onclick&&a.push("js-onclick"),a.push('" href="'),a.push(l(e.target)),a.push('" data-key="'),a.push(e.key),a.push('">\n    '),a.push(this.Icon(e["class"],"menu-item-icon")),a.push('\n    <span class="menu-item-name">\n      '),a.push(this.T(e.name)),a.push("\n    </span>\n    "),void 0!==e.counter&&0!==e.counter&&(a.push('\n      <span class="counter badge badge--big">'),a.push(l(e.counter)),a.push("</span>\n    ")),a.push("\n    "),void 0!==e["switch"]&&(a.push('\n      <span class="zammad-switch zammad-switch--dark zammad-switch--small zammad-switch--green js-switch">\n         <input type="checkbox" id="'),a.push(e["class"]),a.push('-switch" '),e["switch"]&&a.push("checked"),a.push('>\n         <label for="'),a.push(e["class"]),a.push('-switch"></label>\n      </span>\n    ')),a.push("\n\n    "),e.accessoryIcon&&(a.push("\n      "),a.push(this.Icon(e.accessoryIcon,"accessory-icon")),a.push("\n    ")),a.push("\n  </a>\n  ");a.push("\n")}a.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,a.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/navigation/menu_cti_ringing"]=function(t){t||(t={});var a=[],l=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o;if(a.push('<div class="call-widget">\n  <div class="call-widget-header">\n    '),a.push(this.Icon("status","neutral")),a.push('\n    <div class="label">'),a.push(this.T("Inbound Call")),a.push('</div>\n    <!--\n    <div class="flex-spacer"></div>\n    <div class="btn btn--text js-remove" title="'),a.push(this.Ti("Remove")),a.push('">'),a.push(this.Icon("diagonal-cross")),a.push('</div>\n    -->\n  </div>\n  <div class="horizontal center">\n    '),o=void 0,a.push("\n    "),r=!1,a.push("\n    "),this.item.preferences.from&&!_.isEmpty(this.item.preferences.from)){for(a.push("\n      "),n=0,i=(s=this.item.preferences.from).length;n<i;n++)t=s[n],a.push("\n        "),t.user_id&&App.User.exists(t.user_id)?(a.push("\n          "),o=App.User.fullLocal(t.user_id),a.push("\n          "),e=["user-popover","u-textTruncate"],a.push("\n          "),o.active||e.push("is-inactive"),a.push("\n          "),r&&a.push('<div class="spacer"></div>'),a.push('\n          <div class="user-card">\n            <a href="'),a.push(o.uiUrl()),a.push('">'),a.push(o.avatar()),a.push('</a>\n            <div class="'),a.push(l(e.join(" "))),a.push('" data-id="'),a.push(o.id),a.push('">'),"known"!==t.level&&(a.push(this.T("maybe")),a.push(": ")),a.push(l(o.displayNameLong())),a.push('</div>\n            <span class="text-muted">'),a.push(l(this.item.from_pretty)),a.push("</span>\n          </div>\n          "),r=!0,a.push("\n        ")):_.isEmpty(t.comment)||(a.push("\n          "),r=!0,a.push('\n          <div class="user-card">\n            '),a.push(this.unique_avatar(t.comment,t.comment.split(" ").map(function(t){return t[0]}).join(""))),a.push("\n            "),a.push(this.T("maybe")),a.push(": "),a.push(l(t.comment)),a.push('<br>\n            <span class="text-muted">'),a.push(l(this.item.from_pretty)),a.push("</span>\n          </div>\n        ")),a.push("\n      ");a.push("\n    ")}a.push("\n    "),r||_.isEmpty(this.item.from_comment)||(a.push("\n      "),r=!0,a.push('\n      <div class="user-card">\n        '),a.push(this.unique_avatar(this.item.from_comment,this.item.from_comment.split(" ").map(function(t){return t[0]}).join(""))),a.push("\n        "),a.push(l(this.item.from_comment)),a.push('<br>\n        <span class="text-muted">'),a.push(l(this.item.from_pretty)),a.push("</span>\n      </div>\n    ")),a.push("\n    "),r||(a.push('\n      <div class="user-card">\n        '),a.push(this.unique_avatar(this.item.from_pretty||this.item.from,"??")),a.push("\n      "),_.isEmpty(this.item.from_pretty)?(a.push('\n        <a class="inherit-color" href="'),a.push(App.Utils.phoneify(this.item.from)),a.push('">'),a.push(l(this.item.from)),a.push("</a>\n      ")):(a.push('\n        <a class="inherit-color" href="'),a.push(App.Utils.phoneify(this.item.from_pretty)),a.push('">'),a.push(l(this.item.from_pretty)),a.push("</a>\n        "),"in"===this.item.direction&&(a.push('\n        <div class="btn btn--text btn--create no-padding js-newUser" href="#" data-phone="'),a.push(l(this.item.from_pretty)),a.push('">'),a.push(this.Icon("plus-small")),a.push(" <span>"),a.push(this.T("New User")),a.push("</div>\n        ")),a.push("\n      ")),a.push("\n      </div>\n    ")),a.push('\n    <div class="flex-spacer"></div>\n    <div class="btn btn--small btn--quad btn--create space-left js-newTicket" title="'),a.push(this.Ti("New Ticket")),a.push('" data-user-id="'),o&&a.push(o.id),a.push('">'),a.push(this.Icon("plus")),a.push("</div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,a.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/navigation/no_result"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<li class="global-search-detail-no-result alert alert--warning horizontal" role="alert">\n  '),e.push(this.Icon("mood-sad")),e.push("\n  <span>"),e.push(this.T("There is no match for your search.")),e.push("</span>\n</li>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/navigation/personal"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(t=0,s=(o=this.items).length;t<s;t++){if(n=o[t],l.push("\n  "),_.isEmpty(n.child))l.push('\n    <li class="settings">\n      <a class="list-button fit horizontal centered" href="'),l.push(c(n.target)),l.push('" title="'),l.push(this.Ti(n.name)),l.push('">\n        '),l.push(this.Icon(n.icon,"user-menu-icon")),l.push("\n      </a>\n    </li>\n  ");else{for(l.push('\n    <li class="'),n["class"]&&l.push(n["class"]),l.push(" dropup "),this.openTab[n.target]&&l.push("open"),l.push('">\n      <a class="list-button dropdown-toggle js-action" data-toggle="dropdown" href="'),l.push(c(n.target)),l.push('" title="'),n.translate?l.push(this.Ti(n.name)):l.push(c(n.name)),l.push('">\n        <span class="dropdown-nose"></span>\n        '),"user"===n["class"]?l.push('\n          <span class="js-avatar"></span>\n        '):(l.push("\n          "),l.push(this.Icon(n.icon,"user-menu-icon")),l.push("\n        ")),l.push('\n      </a>\n      <ul class="dropdown-menu dropdown-menu--light" role="menu">\n        '),e=i=0,r=(a=n.child).length;i<r;e=++i)n=a[e],l.push("\n          "),n.divider&&0<e&&l.push('\n            <li class="divider"></li>\n          '),l.push("\n          "),n.navheader&&(l.push('\n            <li class="dropdown-header">'),l.push(this.T(n.navheader)),l.push("</li>\n          ")),l.push('\n          <li>\n            <a href="'),l.push(c(n.target)),l.push('" class="horizontal center">\n              <span class="flex u-textTruncate">'),n.translate?l.push(this.T(n.name)):l.push(c(n.name)),l.push("</span>\n              "),void 0!==n.count&&(l.push('<span class="badge badge--text count">'),l.push(c(n.count)),l.push("</span>")),l.push("\n              "),n.iconClass&&l.push(this.Icon(n.iconClass)),l.push("\n            </a>\n          </li>\n        ");l.push("\n      </ul>\n    </li>\n  ")}l.push("\n")}l.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/navigation/result"]=function(t){t||(t={});var a=[],l=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o;for(t in o=this.result){for(s=o[t],a.push("\n  "),e&&0<s.length&&a.push(' <li class="divider"></li> '),a.push("\n  "),e=!0,a.push("\n  "),n=0,r=s.length;n<r;n++)i=s[n],a.push('\n    <li>\n      <a href="'),a.push(i.url),a.push('" class="nav-tab nav-tab--search '),a.push(l(i["class"])),a.push('" data-id="'),a.push(l(i.id)),a.push('">\n        <div class="nav-tab-icon">\n          '),a.push(this.Icon(i.icon,i.iconClass)),a.push('\n        </div>\n        <span class="nav-tab-name flex u-textTruncate">'),a.push(l(i.display)),a.push("</span>\n      </a>\n    </li>\n  ");a.push("\n")}a.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,a.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/notify"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="noty_message">\n  '),"error"===this.type&&(e.push("\n    "),e.push(this.Icon("diagonal-cross","icon-error")),e.push("\n  ")),e.push("\n  "),"success"===this.type&&(e.push("\n    "),e.push(this.Icon("checkmark")),e.push("\n  ")),e.push('\n  <span class="noty_text"></span>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/attribute"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="js-data">\n  <div class="js-dataType"></div>\n  <div class="js-dataMap" style="padding: 30px 0 0 30px;"></div>\n  <div class="" style="padding-bottom: 10px">'),e.push(this.T("Here you define which authorization has access to the attribute.")),e.push('</div>\n  <div class="js-dataScreens"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/attribute/autocompletion"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\nAuto-Vervollst\xe4ndigung\n  <div class="js-autocompletionDefault"></div>\n  <div class="js-autocompletionUrl"></div>\n  <div class="js-autocompletionMethod"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/attribute/boolean"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\n  <table class="settings-list" style="width: 100%;">\n    <thead>\n      <tr>\n        <th>'),e.push(this.T("Key")),e.push("\n        <th>"),e.push(this.T("Display")),e.push('\n        <th style="width: 30px">'),e.push(this.T("Default")),e.push('\n    </thead>\n    <tbody>\n      <tr>\n        <td class="settings-list-control-cell">\n          true\n        <td class="settings-list-control-cell">\n          <input class="form-control form-control--small js-valueTrue" type="text" value="'),this.params.data_option&&this.params.data_option.options&&e.push(n(this.params.data_option.options[!0])),e.push('" name="data_option::options::true" placeholder="'),e.push(this.T("yes")),e.push('" required/>\n        <td class="settings-list-row-control">\n          <input class="js-selected js-boolean" type="radio" name="data_option::default" value="true" '),this.params.data_option&&"true"===this.params.data_option["default"]&&e.push("checked"),e.push('/>\n      <tr>\n        <td class="settings-list-control-cell">\n          false\n        <td class="settings-list-control-cell">\n          <input class="form-control form-control--small js-valueFalse" type="text" value="'),this.params.data_option&&this.params.data_option.options&&e.push(n(this.params.data_option.options[!1])),e.push('" name="data_option::options::false" placeholder="'),e.push(this.T("no")),e.push('" required/>\n        <td class="settings-list-row-control">\n          <input class="js-selected js-boolean" type="radio" name="data_option::default" value="false" '),this.params.data_option&&"false"===this.params.data_option["default"]&&e.push("checked"),e.push("/>\n    </tbody>\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/attribute/date"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\n  <div class="js-dateFuture"></div>\n  <div class="js-datePast"></div>\n  <div class="js-dateDiff"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/attribute/datetime"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push(
'<div>\n  <div class="js-datetimeFuture"></div>\n  <div class="js-datetimePast"></div>\n  <div class="js-datetimeDiff"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/attribute/input"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\n  <div class="js-inputDefault"></div>\n  <div class="js-inputType"></div>\n  <div class="js-inputMaxlength"></div>\n  <div class="js-inputLinkTemplate"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/attribute/integer"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\n  <div class="js-integerDefault"></div>\n  <div class="js-integerMin"></div>\n  <div class="js-integerMax"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/attribute/select"]=function(t){t||(t={});var o=[],a=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r;if(o.push('<div>\n  <table class="settings-list js-Table" style="width: 100%;">\n    <thead>\n      <tr>\n        <th>'),o.push(this.T("Key")),o.push("\n        <th>"),o.push(this.T("Display")),o.push('\n        <th style="width: 30px">'),o.push(this.T("Default")),o.push('\n        <th style="width: 30px">'),o.push(this.T("Action")),o.push("\n    </thead>\n    <tbody>\n      "),this.params.data_option&&this.params.data_option.sorted){for(o.push("\n        "),e=0,i=(s=this.params.data_option.sorted).length;e<i;e++)n=(r=s[e])[0],t=r[1],o.push('\n        <tr>\n          <td class="settings-list-control-cell">\n            <input class="form-control form-control--small js-key" type="text" value="'),o.push(a(n)),o.push('" required/>\n          <td class="settings-list-control-cell">\n            <input class="form-control form-control--small js-value" type="text" value="'),o.push(a(t)),o.push('" name="data_option::options::'),o.push(a(n)),o.push('" required/>\n          <td class="settings-list-row-control">\n            <input class="js-selected" type="radio" name="data_option::default" value="'),o.push(a(n)),o.push('" '),this.params.data_option["default"]===n&&o.push("checked"),o.push('/>\n          <td class="settings-list-row-control">\n            <div class="btn btn--text js-remove">\n              '),o.push(this.Icon("trash")),o.push(" "),o.push(this.T("Remove")),o.push("\n            </div>\n        ");o.push("\n      ")}o.push('\n      <tr>\n        <td class="settings-list-control-cell">\n          <input class="form-control form-control--small js-key" type="text" placeholder="'),o.push(this.T("Key")),o.push('"/>\n        <td class="settings-list-control-cell">\n          <input class="form-control form-control--small js-value" type="text" placeholder="'),o.push(this.T("Display")),o.push('"/>\n        <td class="settings-list-row-control">\n          <input class="js-selected" type="radio"/>\n        <td class="settings-list-row-control">\n          <div class="btn btn--text btn--create js-add">\n            '),o.push(this.Icon("plus-small")),o.push(" "),o.push(this.T("Add")),o.push('\n          </div>\n    </tbody>\n  </table>\n  <table class="hidden">\n    <tbody>\n      <tr class="js-template">\n        <td class="settings-list-control-cell">\n          <input class="form-control form-control--small js-key" type="text" value="" required/>\n        <td class="settings-list-control-cell">\n          <input class="form-control form-control--small js-value" type="text" value="" required/>\n        <td class="settings-list-row-control">\n          <input class="js-selected" type="radio" name="data_option::default"/>\n        <td class="settings-list-row-control">\n          <div class="btn btn--text js-remove">\n            '),o.push(this.Icon("trash")),o.push(" "),o.push(this.T("Remove")),o.push('\n          </div>\n  </table>\n  <div class="js-inputLinkTemplate"></div>\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,o.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/attribute/tree_select"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\n  <table class="settings-list js-Table" style="width: 100%;">\n    <thead>\n      <tr>\n        <th>'),e.push(this.T("Key")),e.push('\n        <th style="width: 180px">'),e.push(this.T("Action")),e.push('\n      </tr>\n    </thead>\n    <tbody class="js-treeTable"></tbody>\n  </table>\n  <table class="hidden">\n    <tbody>\n      <tr class="js-template">\n        <td class="settings-list-control-cell">\n          <input class="form-control form-control--small js-key" type="text" value="" data-level="" required/>\n        <td class="settings-list-row-control">\n          <div class="btn btn--text js-remove" style="margin-left: -10px;">\n            '),e.push(this.Icon("trash")),e.push('\n          </div>\n          <div class="btn btn--text btn--create js-addChild" style="margin-left: -10px;">\n            '),e.push(this.Icon("plus-small")),e.push(" "),e.push(this.T("children")),e.push('\n          </div>\n          <div class="btn btn--text btn--create js-addRow" style="margin-left: -10px;">\n            '),e.push(this.Icon("plus-small")),e.push(" "),e.push(this.T("row")),e.push("\n          </div>\n      </tr>\n    </tbody>\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/index"]=function(t){t||(t={});var a=[],l=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o;if(a.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),a.push(this.T(this.head)),a.push(" <small>"),a.push(this.T("Object Manager")),a.push('</small></h1>\n  </div>\n  <div class="page-header-meta">\n  <!--\n    <a class="btn js-restore">'),a.push(this.T("Restore Defaults")),a.push('</a>\n  -->\n    <a class="btn btn--success js-new">'),a.push(this.T("New Attribute")),a.push('</a>\n  </div>\n</div>\n<div class="page-content">\n  '),!_.isEmpty(this.itemsToChange)){for(a.push('\n  <div class="box box--message">\n    <h2>'),a.push(this.T("Database Update required")),a.push("</h2>\n    <p>\n      "),a.push(this.T("Changes were made that require a database update.")),a.push("\n      "),a.push(this.T("This might take some time where the system can't be used.")),a.push("\n      "),a.push(this.T("Please execute database changes only in a maintenance time-slot.")),a.push("\n    </p>\n    <p>\n      "),a.push(this.T("Changes")),a.push(":\n      <ul>\n      "),t=0,i=(r=this.itemsToChange).length;t<i;t++)e=r[t],a.push("\n        <li>\n          "),!0===e.to_create?(a.push("\n            "),a.push(this.T("Create")),a.push(": "),a.push(l(e.object)),a.push("."),a.push(l(e.name)),a.push(" ("),a.push(l(e.data_type)),a.push(")\n          ")):!0===e.to_delete?(a.push("\n            "),a.push(this.T("Delete")),a.push(": "),a.push(l(e.object)),a.push("."),a.push(l(e.name)),a.push(" ("),a.push(l(e.data_type)),a.push(")\n          ")):(e.to_migrate||!0===e.to_config)&&(a.push("\n            "),a.push(this.T("Changed")),a.push(": "),a.push(l(e.object)),a.push("."),a.push(l(e.name)),a.push(" ("),a.push(l(e.data_type)),a.push(")\n          ")),a.push("\n      ");a.push('\n      </ul>\n    </p>\n    <div class="box-controls">\n      <div class="btn btn--text btn--secondary js-discard">'),a.push(this.T("Discard Changes")),a.push('</div>\n      <div class="btn btn--primary js-execute align-right">'),a.push(this.T("Update Database")),a.push("</div>\n    </div>\n  </div>\n  ")}for(a.push('\n<!--\n  <div class="box box--message">\n    <div class="box-progress">\n      <div class="box-progress-title">'),a.push(this.T("Updating Database")),a.push('</div>\n      <div class="box-progress-body">\n        <progress max="100" value="50"></progress>\n      </div>\n    </div>\n  </div>\n-->\n  <table class="table table-striped table-hover is-disabled">\n    <thead>\n      <tr>\n        <th class="">'),a.push(this.T("Display")),a.push('</th>\n        <th class="">'),a.push(this.T("Name")),a.push('</th>\n        <th class="" style="width: 200px;">'),a.push(this.T("Type")),a.push('</th>\n        <th class="" style="width: 140px;">'),a.push(this.T("Action")),a.push("</th>\n      </tr>\n    </thead>\n    <tbody>\n      "),n=0,s=(o=this.items).length;n<s;n++)e=o[n],a.push('\n      <tr class="'),!1===e.editable?a.push("is-grayed-out u-notAllowed"):(!1===e.active&&a.push("is-inactive"),a.push(" js-edit u-clickable")),a.push('" data-id="'),a.push(e.id),a.push('">\n        <td>'),a.push(l(e.display)),a.push("</td>\n        <td>"),a.push(l(e.name)),a.push("</td>\n        <td>"),a.push(l(e.data_type)),a.push("</td>\n        <td>\n          "),!0===e.to_create?(a.push("\n            "),a.push(this.T("will be created")),a.push("\n          ")):!0===e.to_delete?(a.push("\n            "),a.push(this.T("will be deleted")),a.push("\n          ")):!0===e.to_migrate||!0===e.to_config?(a.push("\n            "),a.push(this.T("has changed")),a.push("\n          ")):e.editable&&(a.push("\n            "),e.deletable?(a.push('\n              <a href="#" class="js-delete" title="'),a.push(this.Ti("Delete")),a.push('">'),a.push(this.Icon("trash")),a.push("</a>\n            ")):(a.push('\n              <span class="is-disabled" title="'),a.push(l(e.not_deletable_reason)),a.push('">'),a.push(this.Icon("trash")),a.push("</span>\n            ")),a.push("\n          ")),a.push("\n        </td>\n      </tr>\n      ");a.push("\n    </tbody>\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,a.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/object_manager/screens"]=function(t){t||(t={});var o=[],a=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r;for(i in o.push('<div>\n  <table class="settings-list" style="width: 100%;">\n    <thead>\n      <tr>\n        <th>'),o.push(this.T("Permissions")),o.push("\n        <th>"),o.push(this.T("Screen")),o.push('\n        <th style="width: 50%;">'),o.push(this.T("Options")),o.push("\n    </thead>\n    <tbody>\n      "),n=this.data){for(s in r=n[i],o.push('\n        <tr>\n          <td class="settings-list-control-cell">\n            '),o.push(a(i)),o.push('\n          <td class="settings-list-control-cell">\n          <td class="settings-list-row-control">\n        '),r){for(t in e=r[s],o.push('\n        <tr>\n          <td class="settings-list-control-cell">\n          <td class="settings-list-control-cell">\n            '),o.push(a(s)),o.push('\n          <td class="settings-list-row-control">\n            '),e)e[t],o.push("\n              "),o.push(this.T(t)),o.push(': <input class="js-boolean" name="screens::'),o.push(a(s)),o.push("::"),o.push(a(i)),o.push("::"),o.push(a(t)),o.push('" type="checkbox" '),this.params&&this.params.screens&&this.params.screens[s]&&this.params.screens[s][i]&&!0===this.params.screens[s][i][t]&&o.push("checked"),o.push(' value="true">\n            ');o.push("\n        ")}o.push("\n      ")}o.push("\n    </tbody>\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,o.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/organization_profile/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="profile">\n  <div class="profile-window">\n    <div class="profile-section vertical centered">\n      <div class="align-right profile-action js-action"></div>\n      <div class="profile-organizationIcon">\n        '),e.push(this.Icon("organization")),e.push('\n      </div>\n      <h1 class="js-name"></h1>\n    </div>\n    <div class="js-object-container"></div>\n    <div class="profile-section js-ticket-stats"></div>\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/organization_profile/member"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="userList-entry">\n  '),e.push(this.user.avatar("40")),e.push('\n  <a href="'),e.push(this.user.uiUrl()),e.push('" class="userList-name user-popover" data-id="'),e.push(this.user.id),e.push('">'),e.push(n(this.user.displayName())),e.push("</a>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/organization_profile/object"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="profile-section">\n  <div class="profile-details horizontal wrap">\n    '),t=0,e=(n=this.organizationData).length;t<e;t++)i=n[t],s.push("\n      "),"richtext"===i.tag?(s.push('\n        <div class="profile-detailsEntry" style="width: 100%;">\n          <label>'),s.push(this.T(i.display)),s.push('</label>\n          <div contenteditable="true" data-name="'),s.push(r(i.name)),s.push('" data-type="update" data-placeholder="'),s.push(this.Ti("Add a Note")),s.push('">'),s.push(this.organization[i.name]),s.push("</div>\n        </div>\n      ")):(s.push("\n        "),this.organization[i.name]&&(s.push('\n          <div class="profile-detailsEntry">\n            <label>'),s.push(this.T(i.display)),s.push("</label>\n            "),s.push(this.P(this.organization,i.name)),s.push("\n          </div>\n        ")),s.push("\n      ")),s.push("\n    ");s.push("\n  </div>\n</div>\n"),this.organization.members&&(s.push('\n<div class="profile-section profile-memberSection">\n  <label>'),s.push(this.T("Members")),s.push('</label>\n  <div class="userList js-userList"></div>\n</div>\n')),s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/package"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(l.push('<div class="page-header-title">\n  <h1>'),l.push(this.T("Package")),l.push(" <small>"),l.push(this.T("Management")),l.push('</small></h1>\n</div>\n\n<div class="page-content">\n  <!--\n  <ul class="nav nav-tabs nav-stacked">\n    <li class=""><a data-type="" >'),l.push(this.T("Installed")),l.push('</a></li>\n    <li class=""><a data-type="" >'),l.push(this.T("Store")),l.push('</a></li>\n  </ul>\n  -->\n  <p>\n    <form action="'),l.push(c(App.Config.get("api_path"))),l.push('/packages" method="post" enctype="multipart/form-data" class="horizontal center">\n      <input type="hidden" name="authenticity_token" value="'),l.push(c(App.Ajax.token())),l.push('"/>\n      <input type="file" name="file_upload"/>\n      <button class="align-right btn btn--primary" type="submit">'),l.push(this.T("Install Package")),l.push('</button>\n    </form>\n  </p>\n\n  <table class="table table-striped table-hover">\n    <thead>\n      <tr>\n        <th>'),l.push(this.T("Name")),l.push("</th>\n        <th>"),l.push(this.T("Version")),l.push("</th>\n        <th>"),l.push(this.T("Vendor")),l.push("</th>\n        <th>"),l.push(this.T("State")),l.push("</th>\n        <th>"),l.push(this.T("Action")),l.push("</th>\n      </tr>\n    </thead>\n    <tbody>\n    "),e=0,s=(o=this.packages).length;e<s;e++){for(n=o[e],l.push('\n      <tr data-id="'),l.push(c(n.id)),l.push('">\n        <td>'),l.push(c(n.name)),l.push("</td>\n        <td>"),l.push(c(n.version)),l.push('</td>\n        <td><a href="'),l.push(n.url),l.push('" target="_blank">'),l.push(c(n.vendor)),l.push("</a></td>\n        <td>"),l.push(this.T(n.state)),l.push("</td>\n        <td>"),i=0,r=(a=n.action).length;i<r;i++)t=a[i],l.push('<a href="#" class="action" data-type="'),l.push(c(t)),l.push('">'),l.push(this.T(t)),l.push("</a><br/>");l.push("</td>\n      </tr>\n    ")}l.push("\n    </tbody>\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/password/reset"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="reset_password fullscreen">\n  <div class="fullscreen-center">\n    <div class="hero-unit fullscreen-body">\n      '),this.sent?(e.push("\n        <h2>"),e.push(this.T("We've sent password reset instructions to your email address.")),e.push("<small></small></h2>\n        <p>"),e.push(this.T("If you don't receive instructions within a minute or two, check your email's spam and junk filters, or try resending your request.")),e.push('</p>\n        <div class="form-controls">\n          <a class="btn btn--text btn--subtle js-cancel" href="#login">'),e.push(this.T("Cancel & Go Back")),e.push('</a>\n          <button class="btn btn--primary retry align-right">'),e.push(this.T("again")),e.push("</button>\n        </div>\n      ")):(e.push("\n        <h2>"),e.push(this.T("Forgot your password?")),e.push('<small></small></h2>\n        <form class="form-password">\n          <div class="form-password-item"></div>\n          <div class="form-controls">\n            <a class="btn btn--text btn--subtle js-cancel" href="#login">'),e.push(this.T("Cancel & Go Back")),e.push('</a>\n            <button class="btn btn--primary js-submit align-right">'),e.push(this.T("Submit")),e.push("</button>\n          </div>\n        </form>\n      ")),e.push("\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/password/reset_change"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="fullHeight vertical center justified reset_password fit">\n  <div class="hero-unit">\n    <h2>'),e.push(this.T("Choose your new password.")),e.push('<small></small></h2>\n    <form>\n      <div class="form-password-change"></div>\n      <div class="form-controls">\n        <a class="btn btn--text btn--subtle js-cancel" href="#/">'),e.push(this.T("Cancel & Go Back")),e.push('</a>\n        <button class="btn btn--primary js-submit align-right">'),e.push(this.T("Submit")),e.push("</button>\n      </div>\n    </form>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/password/reset_failed"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="reset_password fullscreen">\n  <div class="fullscreen-center">\n    <div class="hero-unit fullscreen-body">\n      <h2>'),e.push(this.T(this.head)),e.push("<small></small></h2>\n      <p>"),e.push(this.message),e.push('</p>\n      <a href="#password_reset" class="btn btn--text btn--secondary retry">&raquo; '),e.push(this.T("try again")),e.push(" &laquo;</a>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/popover/kb_generic"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;i.push(this.V("popover/single_object_generic",{object:this.object,attributes:this.attributes})),i.push("\n"),("function"==typeof(t=this.object).parent&&"function"==typeof(e=t.parent()).canBePublished?e.canBePublished():void 0)&&(i.push('\n  <div class="state-badge">\n    '),i.push(this.Icon("task-state",this.object.parent().can_be_published_state())),i.push('\n    <span class="'),i.push(s(this.object.parent().can_be_published_state_css())),i.push('">\n      '),i.push(this.T(this.object.parent().can_be_published_state())),i.push('\n    </span>\n  </div>\n\n  <hr>\n\n  <div class="popover-block">\n    <div class="horizontal two-columns">\n      <div class="column">\n        <label>'),i.push(this.T("Published at")),i.push("</label>\n        "),(n=this.object.parent().published_at)?(i.push("\n          "),i.push(this.humanTime(n,!1,"time","absolute")),i.push("\n        ")):i.push("\n          -\n        "),i.push('\n      </div>\n      <div class="column">\n        <label>'),i.push(this.T("Archived at")),i.push("</label>\n        "),(n=this.object.parent().archived_at)?(i.push("\n          "),i.push(this.humanTime(n,!1,"time","absolute")),i.push("\n        ")):i.push("\n          -\n        "),i.push('\n      </div>\n      <div class="column">\n        <label>'),i.push(this.T("Language")),i.push("</label>\n        "),i.push(s(App.KnowledgeBaseLocale.localeFor(this.object).systemLocale().name)),i.push("\n      </div>\n    </div>\n  </div>\n")),i.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/popover/organization"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push(this.V("popover/single_object_generic",{object:this.object,attributes:this.attributes})),s.push("\n\n"),this.object.members){for(s.push('\n  <hr>\n  <div class="popover-block">\n    <label>'),s.push(this.T("Members")),s.push("</label>\n    "),t=0,e=(n=this.object.members).length;t<e;t++)i=n[t],s.push('\n      <div class="person">'),s.push(r(i.displayName())),s.push("</div>\n    ");s.push("\n  </div>\n")}s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/popover/single_object_generic"]=function(t){t||(t={});var s=[],e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(_.isEmpty(this.attributes)||s.push("\n  <hr>\n"),s.push("\n\n"),t=0,e=(n=this.attributes).length;t<e;t++)i=n[t],s.push("\n  "),this.object[i.name]&&(s.push('\n    <div class="popover-block">\n      <label>'),s.push(this.T(i.display)),s.push("</label>\n      "),s.push(this.P(this.object,i.name)),s.push("\n    </div>\n  ")),s.push("\n");s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/popover/ticket"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="state-badge">\n  '),e.push(this.Icon(this.object.icon(),this.object.iconClass())),e.push(' <span class="'),e.push(this.T(this.object.iconTextClass())),e.push('">'),e.push(this.object.iconTitle()),e.push('</span>\n</div>\n<hr>\n<div class="popover-block">\n  <label>'),e.push(this.T("Agent")),e.push('</label>\n  <div class="person">\n    '),e.push(n(this.object.owner.displayName())),e.push("\n    "),this.object.owner.organization&&(e.push('\n      <span class="organization">'),e.push(n(this.object.owner.organization.displayName())),e.push("</span>\n    ")),e.push('\n  </div>\n</div>\n<div class="popover-block">\n  <label>'),e.push(this.T("Customer")),e.push('</label>\n  <div class="person">\n    '),e.push(n(this.object.customer.displayName())),e.push("\n    "),this.object.customer.organization&&(e.push('\n      <span class="organization">'),e.push(n(this.object.customer.organization.displayName())),e.push("</span>\n    ")),e.push('\n  </div>\n</div>\n<hr>\n<div class="horizontal two-columns">\n  <div class="column">\n    <label>#</label>\n    <div class="u-textTruncate">'),e.push(this.P(this.object,"number")),e.push('</div>\n  </div>\n  <div class="column">\n    <label>'),e.push(this.T("Priority")),e.push('</label>\n    <div class="u-textTruncate">'),e.push(this.P(this.object,"priority")),e.push('</div>\n  </div>\n  <div class="column">\n    <label>'),e.push(this.T("Created")),e.push('</label>\n    <div class="u-textTruncate">'),e.push(this.P(this.object,"created_at")),e.push('</div>\n  </div>\n  <div class="column">\n    <label>'),e.push(this.T("Group")),e.push('</label>\n    <div class="u-textTruncate">'),e.push(this.P(this.object,"group")),e.push("</div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/popover/user"]=function(t){t||(t={});var c=[],p=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l;if(this.object.organization&&(c.push('\n<div class="user-organization"><a href="'),c.push(this.object.organization.uiUrl()),c.push('">'),c.push(p(this.object.organization.displayName())),c.push("</a></div>\n")),c.push("\n\n"),c.push(this.V("popover/single_object_generic",{object:this.object,attributes:this.attributes})),c.push("\n"),!_.isEmpty(this.object.accounts)){for(t in c.push('\n  <hr>\n  <div class="popover-block">\n    <label>'),c.push(this.T("Linked Accounts")),c.push("</label>\n    "),this.object.accounts)c.push('\n      <a href="'),c.push(p(this.object.accounts[t].link)),c.push('" target="_blank">'),c.push(p(t)),c.push("</a>\n    ");c.push("\n  </div>\n")}if(c.push("\n"),!_.isEmpty(this.object.links)){for(c.push("\n  <hr>\n  "),e=0,s=(a=this.object.links).length;e<s;e++){for(o=a[e],c.push('\n    <div class="popover-block">\n      <label>'),c.push(this.T(o.title)),c.push("</label>\n      "),i=0,r=(l=o.items).length;i<r;i++)n=l[i],c.push("\n        "),n.url?(c.push('\n          <a href="'),c.push(p(n.url)),c.push('" title="'),c.push(this.Ti(n.title)),c.push('" style="'),c.push(p(n.style)),c.push('" data-type="'),c.push(p(n.data)),c.push('" class="'),c.push(p(n["class"])),c.push('" '),o.new_window&&c.push('target="_blank"'),c.push(">\n        ")):(c.push('\n          <span title="'),c.push(this.Ti(n.title)),c.push('" style="'),c.push(p(n.style)),c.push('" data-type="'),c.push(p(n.data)),c.push('" class="'),c.push(p(n["class"])),c.push('">\n        ')),c.push("\n          "),c.push(this.T(n.name)),c.push(" "),void 0!==n.count&&(c.push('<span class="count">('),c.push(p(n.count)),c.push(")</span>")),c.push("\n        "),n.url?c.push("\n          </a>\n        "):c.push("\n          </span>\n        "),c.push("\n      ");c.push("\n    </div>\n  ")}c.push("\n")}c.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,c.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/popover/user_ticket_list"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push(this.ticketList),e.push("\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/avatar-holder"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="avatar-holder">\n  <span class="avatar size-80" data-avatar-id="'),e.push(this.avatar.id),e.push('" style="background-image: url('),e.push(this.src),e.push(')"></span>\n  <div class="avatar-delete">\n    '),e.push(this.Icon("diagonal-cross")),e.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/avatar"]=function(t){t||(t={});var r=[],e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s;for(r.push(
'<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),r.push(this.T("Avatar")),r.push('</h1>\n  </div>\n  <div class="page-header-meta">\n  '),this.webcamSupport&&(r.push('\n    <div class="btn btn--success js-openCamera">'),r.push(this.T("Camera")),r.push("</div>\n  ")),r.push('\n    <div class="btn btn--success fileUpload">'),r.push(this.T("Upload")),r.push('<input type="file" class="js-upload" accept="image/*"></div>\n  </div>\n</div>\n<div class="page-content avatar-gallery">\n  '),n=0,i=(s=this.avatars).length;n<i;n++)t=s[n],r.push('\n  <div class="avatar-holder">\n    '),t.initial?(r.push("\n      "),e="",r.push("\n      "),t["default"]&&(r.push("\n      "),e="is-active",r.push("\n      ")),r.push("\n      "),r.push(App.Session.get().avatar("80","",e,!0,t))):(r.push('\n      <span class="avatar size-80 '),t["default"]&&r.push("is-active"),r.push('" data-avatar-id="'),r.push(t.id),r.push('" style="background-image: url('),r.push(t.content),r.push(')"></span>\n      '),t.deletable&&(r.push('\n        <div class="avatar-delete">\n          '),r.push(this.Icon("diagonal-cross")),r.push("\n        </div>\n      "))),r.push("\n    "),r.push("\n  </div>\n  ");r.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,r.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/calendar_subscriptions"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(n in i.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),i.push(this.T("Calendar")),i.push('</h1>\n  </div>\n</div>\n<div class="page-content">\n  <h2>'),i.push(this.T("Ticket Subscriptions")),i.push("</h2>\n\n  <p>"),i.push(this.T("See your tickets from within your favorite calendar by adding the following URL to your calendar app.")),i.push('</p>\n\n  <label for="calendar-subscription-url">'),i.push(this.T("URL")),i.push('</label>\n  <form class="form--flexibleWidth">\n    <div class="form-group">\n      <div class="controls">\n        <input type="url" class="form-control js-select" readonly value="'),i.push(s(this.baseurl)),i.push('/ical/tickets" id="calendar-subscription-url">\n      </div>\n    </div>\n  </form>\n\n  <h3>'),i.push(this.T("Subscription Settings")),i.push('</h3>\n  <div class="form-group">\n    <div class="formGroup-label">\n      <label for="notification-sound">'),i.push(this.T("Alarm")),i.push('</label>\n    </div>\n    <div class="controls">\n      <label class="checkbox-replacement inline-label">\n        <input type="checkbox" name="alarm" value="true" '),this.preferences.alarm&&i.push("checked"),i.push("/>\n        "),i.push(this.Icon("checkbox","icon-unchecked")),i.push("\n        "),i.push(this.Icon("checkbox-checked","icon-checked")),i.push('\n        <span class="label-text">'),i.push(this.T("Add alarm to pending reminder and escalated tickets.")),i.push('</span>\n      </label>\n    </div>\n  </div>\n  <table class="settings-list">\n    <thead>\n      <tr>\n        <th style="white-space: nowrap;">'),i.push(this.T("Status Type")),i.push('\n        <th colspan="2">'),i.push(this.T("Options")),i.push('\n        <th width="100%">'),i.push(this.T("Direct URL")),i.push("\n      </tr>\n    </thead>\n    <tbody>\n      "),e=this.preferences)t=e[n],i.push("\n        "),_.isObject(t)&&(i.push('\n          <tr>\n            <td style="text-transform: capitalize">\n              '),i.push(s(this.translationTable[n])),i.push('\n            <td>\n              <label class="inline-label checkbox-replacement">\n                <input type="checkbox" name="'),i.push(s(n)),i.push('/own"'),i.push(s(t.own?" checked":void 0)),i.push(">\n                "),i.push(this.Icon("checkbox","icon-unchecked")),i.push("\n                "),i.push(this.Icon("checkbox-checked","icon-checked")),i.push('\n                <span class="label-text">'),i.push(this.T("My Tickets")),i.push('</span>\n              </label>\n            <td>\n              <label class="inline-label checkbox-replacement">\n                <input type="checkbox" name="'),i.push(s(n)),i.push('/not_assigned"'),i.push(s(t.not_assigned?" checked":void 0)),i.push(">\n                "),i.push(this.Icon("checkbox","icon-unchecked")),i.push("\n                "),i.push(this.Icon("checkbox-checked","icon-checked")),i.push('\n                <span class="label-text">'),i.push(this.T("Not Assigned")),i.push('</span>\n              </label>\n            <td class="settings-list-control-cell">\n              <div class="btn btn--text js-showLink">'),i.push(this.T("Show")),i.push('</div>\n              <input class="form-control form-control--small js-select is-hidden" readonly value="'),i.push(this.baseurl),i.push("/ical/tickets/"),i.push(s(n)),i.push('">\n          </tr>\n        ')),i.push("\n      ");i.push("\n    </tbody>\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/camera"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="camera">\n  <canvas class="camera-preview" height="256" width="256"></canvas>\n  <video></video>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/devices"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="page-header">\n  <div class="page-header-title"><h1>'),s.push(this.T("Devices")),s.push('</h1></div>\n</div>\n\n<form class="page-content">\n\n  <p>'),s.push(this.T("All computers and browsers that have access to your Zammad appear here.")),s.push('</p>\n\n  <table class="settings-list">\n    <thead>\n      <tr>\n        <th>'),s.push(this.T("Name")),s.push("</th>\n        <th>"),s.push(this.T("Location")),s.push("</th>\n        <th>"),s.push(this.T("Most recent activity")),s.push("</th>\n        <th>"),s.push(this.T("Remove")),s.push("</th>\n      </tr>\n    </thead>\n    <tbody>\n    "),e=0,n=(i=this.devices).length;e<n;e++)t=i[e],s.push("\n      <tr>\n        <td>"),s.push(r(t.name)),s.push("</td>\n        <td>"),s.push(r(t.location)),s.push("</td>\n        <td>"),s.push(this.humanTime(t.updated_at)),s.push('</td>\n        <td class="settings-list-controls">\n          <div class="settings-list-control" href="#" data-device-id="'),s.push(t.id),s.push('" data-type="delete" title="'),s.push(this.Ti("Delete")),s.push('"'),t.current&&s.push("disabled"),s.push(">"),s.push(this.Icon("trash")),s.push("</div>\n          </div>\n      </tr>\n    ");s.push("\n    </tbody>\n  </table>\n\n</form>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/imageCropper"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="imageCropper vertical center">\n  <div class="horizontal justified center">\n    <p>'),e.push(this.T("Avatar")),e.push('</p>\n    <div class="imageCropper-preview"></div>\n    <p>'),e.push(this.T("Preview")),e.push('</p>\n  </div>\n  <div class="imageCropper-holder">\n    <img class="imageCropper-image">\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/language"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),e.push(this.T("Language")),e.push('</h1>\n  </div>\n</div>\n<div class="page-content">\n  <p>'),e.push(this.T("Change your language.")),e.push('</p>\n  <form class="settings-entry horizontal end">\n    <div class="form-item language_item flex"></div>\n    <button type="submit" class="btn btn--primary">'),e.push(this.T("Submit")),e.push("</button>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/linked_accounts"]=function(t){t||(t={});var i=[],s=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n;for(t in i.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),i.push(this.T("Link Accounts")),i.push('</h1>\n  </div>\n</div>\n<div class="page-content">\n  <ul>\n    '),n=this.auth_providers)e=n[t],i.push("\n      <li> "),i.push(this.T(e.name)),i.push("\n        "),this.user.accounts&&this.user.accounts[t]?(i.push('\n          "'),i.push(s(this.user.accounts[t].username)),i.push('" <a href="#" data-uid="'),i.push(s(this.user.accounts[t].uid)),i.push('" data-provider="'),i.push(s(t)),i.push('" class="js-remove">'),i.push(this.T("remove"))):(i.push('\n          <form method="post" class="hidden js-addForm-'),i.push(s(t)),i.push('" action="'),i.push(s(e.url)),i.push('">\n            <input type="hidden" name="authenticity_token" value="'),i.push(s(Spine.Ajax.defaults.headers["X-CSRF-Token"])),i.push('">\n          </form>\n\n          <a href="#" data-key="'),i.push(s(t)),i.push('" class="js-add">'),i.push(this.T("Add"))),i.push("</a>\n        "),i.push("\n      </li>\n    ");i.push("\n  </ul>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/notification"]=function(t){t||(t={});var u=[],h=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p;if(u.push('<div class="page-header">\n  <div class="page-header-title"><h1>'),u.push(this.T("Notifications")),u.push('</h1></div>\n</div>\n\n<form class="page-content form--flexibleWidth">\n\n  <div class="settings-entry">\n    <table class="settings-list">\n      <thead>\n        <tr>\n          <th>\n          <th width="18%" style="text-align: center;">'),u.push(this.T("My Tickets")),u.push('\n          <th width="18%" style="text-align: center;">'),u.push(this.T("Not Assigned")),u.push('*\n          <th width="18%" style="text-align: center;">'),u.push(this.T("All Tickets")),u.push('*\n          <th width="120px" class="settings-list-separator" style="text-align: center;">'),u.push(this.T("Also notify via email")),u.push("\n      </thead>\n      <tbody>\n      "),this.config.matrix){for(i in u.push("\n        "),o=this.config.matrix)p=o[i],u.push("\n        <tr>\n          <td>\n            "),u.push(this.T(p.name)),u.push('\n          <td class="u-positionOrigin">\n            <label class="checkbox-replacement checkbox-replacement--fullscreen">\n              <input type="checkbox" name="matrix.'),u.push(h(i)),u.push('.criteria.owned_by_me" value="true" '),p.criteria&&p.criteria.owned_by_me&&u.push("checked"),u.push("/>\n              "),u.push(this.Icon("checkbox","icon-unchecked")),u.push("\n              "),u.push(this.Icon("checkbox-checked","icon-checked")),u.push('\n            </label>\n          <td class="u-positionOrigin">\n            <label class="checkbox-replacement checkbox-replacement--fullscreen">\n              <input type="checkbox" name="matrix.'),u.push(h(i)),u.push('.criteria.owned_by_nobody" value="true"  '),p.criteria&&p.criteria.owned_by_nobody&&u.push("checked"),u.push("/>\n              "),u.push(this.Icon("checkbox","icon-unchecked")),u.push("\n              "),u.push(this.Icon("checkbox-checked","icon-checked")),u.push('\n            </label>\n          <td class="u-positionOrigin">\n            <label class="checkbox-replacement checkbox-replacement--fullscreen">\n              <input type="checkbox" name="matrix.'),u.push(h(i)),u.push('.criteria.no" value="true"  '),p.criteria&&p.criteria.no&&u.push("checked"),u.push("/>\n              "),u.push(this.Icon("checkbox","icon-unchecked")),u.push("\n              "),u.push(this.Icon("checkbox-checked","icon-checked")),u.push('\n            </label>\n          <td class="u-positionOrigin settings-list-separator">\n            <label class="checkbox-replacement checkbox-replacement--fullscreen">\n              <input type="checkbox" name="matrix.'),u.push(h(i)),u.push('.channel" value="email" '),p.channel&&p.channel.email&&u.push("checked"),u.push("/>\n              "),u.push(this.Icon("checkbox","icon-unchecked")),u.push("\n              "),u.push(this.Icon("checkbox-checked","icon-checked")),u.push("\n            </label>\n        ");u.push("\n      ")}if(u.push("\n      </tbody>\n    </table>\n  </div>\n\n  "),this.groups){for(u.push("\n  <h2>* "),u.push(this.T("Limit Groups")),u.push('</h2>\n  <div class="settings-entry">\n    <table class="settings-list">\n      <thead>\n        <tr>\n          <th>'),u.push(this.T("Group")),u.push("\n          <th>"),u.push(this.T("Not Assigned")),u.push(" & "),u.push(this.T("All Tickets")),u.push("\n      </thead>\n      <tbody>\n      "),e=0,s=(a=this.groups).length;e<s;e++)t=a[e],u.push("\n        <tr>\n          <td>"),u.push(h(t.displayName())),u.push('\n          <td class="u-positionOrigin">\n            <label class="checkbox-replacement checkbox-replacement--fullscreen">\n              <input type="checkbox" name="group_ids" value="'),u.push(h(t.id)),u.push('" '),_.include(this.config.group_ids,t.id.toString())&&u.push("checked"),u.push("/>\n              "),u.push(this.Icon("checkbox","icon-unchecked")),u.push("\n              "),u.push(this.Icon("checkbox-checked","icon-checked")),u.push("\n            </label>\n      ");u.push("\n      </tbody>\n    </table>\n  </div>\n  ")}for(u.push("\n\n  <h2>"),u.push(this.T("Sounds")),u.push('</h2>\n  <div class="form-group">\n    <div class="formGroup-label">\n      <label for="notification-sound">'),u.push(this.T("Notification Sound")),u.push('</label>\n    </div>\n    <div class="controls controls--select">\n      <select class="form-control js-notificationSound" id="notification-sound" name="notification_sound::file">\n        '),n=0,r=(l=this.sounds).length;n<r;n++)c=l[n],u.push('\n        <option value="'),u.push(h(c.file)),u.push('"'),c.selected&&u.push(h(" selected")),u.push(">"),u.push(h(c.name)),u.push("</option>\n        ");u.push("\n      </select>\n      "),u.push(this.Icon("arrow-down")),u.push('\n    </div>\n  </div>\n  <div class="form-group">\n    <label class="inline-label">\n      <span class="checkbox-replacement checkbox-replacement--inline">\n        <input type="checkbox" name="notification_sound::enabled" value="true" '),this.notificationSoundEnabled&&u.push(" checked"),u.push(' class="js-SoundEnableDisable">\n        '),u.push(this.Icon("checkbox","icon-unchecked")),u.push("\n        "),u.push(this.Icon("checkbox-checked","icon-checked")),u.push("\n      </span>\n      "),u.push(this.T("Play user interface sound effects")),u.push('\n    </label>\n  </div>\n\n  <button type="submit" class="btn btn--primary">'),u.push(this.T("Submit")),u.push("</button>\n</form>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,u.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/out_of_office"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title"><h1>'),e.push(this.T("Out of Office")),e.push('</h1></div>\n</div>\n\n<form class="action">\n  <div class="action-flow action-flow--row">\n    <div class="action-row">\n      <div class="action-flow action-flow--noWrap">\n        <h2><span class="action-form-status">\n            '),!0===this.localData.out_of_office?(e.push("\n              "),e.push(this.Icon("status","ok inline"))):(e.push("\n              "),e.push(this.Icon("status","error inline"))),e.push("\n            "),e.push('</span> <input id="out_of_office_reason" name="out_of_office_text" class="form-control form-control--inline" type="text" placeholder="'),e.push(this.Ti("e.g.")),e.push(" "),e.push(this.Ti(this.placeholder)),e.push('" value="'),_.isEmpty(this.localData.out_of_office_text)||e.push(n(this.localData.out_of_office_text)),e.push('"></h2>\n      </div>\n    </div>\n    <div class="action-block action-block--flex">\n      <div class="label">'),e.push(this.T("From")),e.push('</div>\n      <div class="form-group js-startDate"></div>\n    </div>\n    <div class="action-block action-block--flex">\n      <div class="label">'),e.push(this.T("Till")),e.push('</div>\n      <div class="form-group js-endDate"></div>\n    </div>\n    <div class="action-row">\n      <label for="out_of_office_replacement">'),e.push(this.T("Replacement")),e.push('</label>\n      <div class="dropdown js-recipientDropdown"></div>\n    </div>\n    <div class="action-controls">\n      <div class="btn btn--danger js-disabled">'),e.push(this.Ti("Disable")),e.push('</div>\n      <div class="btn btn--create js-enable">'),e.push(this.Ti("Enable")),e.push("</div>\n    </div>\n  </div>\n</form>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/password"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),e.push(this.T("Change your password")),e.push('</h1>\n  </div>\n</div>\n<div class="page-content">\n  <form class="settings-entry form--flexibleWidth">\n    <div class="password_item"></div>\n    <button type="submit" class="btn btn--primary">'),e.push(this.T("Submit")),e.push("</button>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/token_access"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="page-header">\n  <div class="page-header-title"><h1>'),s.push(this.T("Token Access")),s.push("</h1></div>\n</div>\n<p>"),s.push(this.T("You can generate a personal access token for each application you use that needs access to the Zammad API.")),s.push("</p>\n\n<h2>"),s.push(this.T("Add a Personal Access Token")),s.push("</h2>\n<p>"),s.push(this.T("Pick a name for the application, and we'll give you a unique token.")),s.push('</p>\n<a class="btn btn--primary js-create">'),s.push(this.T("Create")),s.push("</a>\n\n<hr>\n\n<h2>"),s.push(this.T("Personal Access Tokens")),s.push('</h2>\n<table class="settings-list js-tokenList">\n  <thead>\n    <tr>\n      <th>'),s.push(this.T("Name")),s.push("</th>\n      <th>"),s.push(this.T("Permissions")),s.push("</th>\n      <th>"),s.push(this.T("Created")),s.push("</th>\n      <th>"),s.push(this.T("Expires")),s.push("</th>\n      <th>"),s.push(this.T("Last used")),s.push("</th>\n      <th>"),s.push(this.T("Delete")),s.push("</th>\n    </tr>\n  </thead>\n  <tbody>\n  "),_.isEmpty(this.tokens))s.push('\n    <tr>\n      <td colspan="6">'),s.push(this.T("none")),s.push("\n  ");else{for(s.push("\n    "),t=0,e=(n=this.tokens).length;t<e;t++)i=n[t],s.push("\n      <tr>\n        <td>"),s.push(r(i.label)),s.push("</td>\n        <td>"),i.preferences&&i.preferences.permission&&s.push(r(i.preferences.permission.join(", "))),s.push("</td>\n        <td>"),s.push(this.humanTime(i.created_at)),s.push("</td>\n        <td>"),s.push(this.Tdate(i.expires_at)),s.push("</td>\n        <td>"),s.push(this.humanTime(i.last_used_at)),s.push('</td>\n        <td class="settings-list-controls">\n          <div class="settings-list-control js-delete" data-token-id="'),s.push(i.id),s.push('" title="'),s.push(this.Ti("Delete")),s.push('">'),s.push(this.Icon("trash")),s.push("</div>\n      </tr>\n    ");s.push("\n  ")}s.push("\n  </tbody>\n</table>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/token_access_create"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="input form-group">\n  <div class="formGroup-label">\n    <label for="token-label">'),s.push(this.T("Name")),s.push(' *</label>\n  </div>\n  <div class="controls"><input id="token-label" type="text" name="label" value="" class="form-control js-input" required></div>\n</div>\n\n<div class="input form-group">\n  <div class="formGroup-label">\n    <label for="token-label">'),s.push(this.T("Expires")),s.push('</label>\n  </div>\n  <div class="controls js-date"></div>\n</div>\n\n<div class="permission form-group checkbox">\n  <div class="checkbox">\n  '),t=0,e=(i=this.permissions).length;t<e;t++)n=i[t],s.push("\n    "),n.name.match(/\./)?(s.push('\n      <div class="checkbox-child js-subPermissionList">\n        <label class="inline-label checkbox-replacement">\n          <input type="checkbox" value="'),s.push(r(n.name)),s.push('" name="permission" '),this.params&&_.contains(this.params.permissions,n.id)&&s.push("checked"),s.push(" "),n.preferences.disabled&&s.push("disabled"),s.push("/>\n          "),s.push(this.Icon("checkbox","icon-unchecked")),s.push("\n          "),s.push(this.Icon("checkbox-checked","icon-checked")),s.push('\n          <span class="label-text">'),s.push(r(n.name.replace(/^.+?\./,""))),s.push('</span>\n          <span class="help-text">'),s.push(this.T.apply(this,[n.note].concat(n.preferences.translations))),s.push("</span>\n        </label>\n      </div>\n    ")):(s.push('\n    <label class="inline-label checkbox-replacement">\n      <input type="checkbox" value="'),s.push(r(n.name)),s.push('" name="permission" '),this.params&&_.contains(this.params.permissions,n.id)&&s.push("checked"),s.push(" "),n.preferences.disabled&&s.push("disabled"),s.push("/>\n      "),s.push(this.Icon("checkbox","icon-unchecked")),s.push("\n      "),s.push(this.Icon("checkbox-checked","icon-checked")),s.push('\n      <span class="label-text">'),s.push(r(n.name)),s.push('</span>\n      <span class="help-text">'),s.push(this.T.apply(this,[n.note].concat(n.preferences.translations))),s.push("</span>\n    </label>\n    ")),s.push("\n  ");s.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/profile/token_access_created"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push("<p>"),e.push(this.T("For security reasons, the API token is shown only once. You'll need to copy it somewhere safe before continuing.")),e.push('</p>\n\n<form>\n  <div class="input form-group">\n    <div class="controls"><input type="text" value="'),e.push(n(this.name)),e.push('" class="form-control input js-select" readonly></div>\n  </div>\n</form>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/reorder_modal"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push("<div>\n  <div class='alert alert--danger hidden'></div>\n  <div class='js-table-container'></div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/report/download_button"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<a class="btn btn--action" href="'),e.push(this.downloadUrl),e.push('" target="_blank" data-type="attachment">'),e.push(this.Icon("download")),e.push("<span>"),e.push(this.T("Download %s record(s)",this.count)),e.push("</span></a>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/report/download_content"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div>\n  <div class="js-dataDownloadHeader"></div>\n  <div class="js-dataDownloadButton"></div>\n  <div class="spacer"></div>\n  <div class="js-dataDownloadTable"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/report/download_header"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(l.push('<ul class="nav nav-tabs">\n  '),e=0,i=(o=this.profiles).length;e<i;e++){for(r=o[e],l.push("\n    "),n=0,s=(a=this.metric.backend).length;n<s;n++)t=a[n],l.push("\n      "),t.dataDownload&&(l.push("\n      <li "),t.name===this.downloadBackendSelected&&l.push('class="is-active active"'),l.push('><a href="#" class="js-dataDownloadBackendSelector" data-toggle="tab" data-profile-id="'),l.push(c(r.id)),l.push('" data-backend="'),l.push(c(t.name)),l.push('">'),l.push(this.T(t.display)),l.push("</a></li>\n      ")),l.push("\n    ");l.push("\n  ")}l.push("\n</ul>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/report/main"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="main flex">\n\n  <div class="page-header">\n    <div class="page-header-title">\n      <h1>'),e.push(this.T("Reporting")),e.push(' <small></small></h1>\n    </div>\n  </div>\n\n  <div class="page-body page-body--two-column">\n    <div class="page-aside js-aside"></div>\n\n    <div class="page-main">\n      <div class="js-timeRangePicker"></div>\n      <div class="well">\n\n        <div id="placeholder" class="" style="height:350px;"></div>\n        <span class=" muted" id="download-chart" style="font-size: 8px;"></span>\n\n        <div class="js-timePicker"></div>\n        <div class="js-dataDownload"></div>\n      </div>\n    </div>\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/report/sidebar"]=function(t){t||(t={});var u=[],h=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p;for(i in u.push('<div class="panel-group" id="accordion">\n  '),l=this.metrics){for(o=l[i],u.push('\n    <div class="panel panel-default" data-metric="'),u.push(h(o.name)),u.push('">\n      <a class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse-'),u.push(h(o.name)),u.push('">\n        <span class="panel-title">\n          '),u.push(this.T(o.display)),u.push('\n        </span>\n      </a>\n      <div id="collapse-'),u.push(h(o.name)),u.push('" class="panel-collapse collapse '),o.name===this.params.metric&&u.push("in"),u.push('">\n        <div class="panel-body">\n          <ul class="type area_select">\n            '),e=0,s=(c=o.backend).length;e<s;e++)t=c[e],u.push('\n              <li>\n                <label class="inline-label checkbox-replacement">\n                  <input class="js-backendSelector" type="checkbox" value="'),u.push(h(t.name)),u.push('"'),this.params.backendSelected[t.name]&&u.push(" checked"),u.push(">\n                  "),u.push(this.Icon("checkbox","icon-unchecked")),u.push("\n                  "),u.push(this.Icon("checkbox-checked","icon-checked")),u.push('\n                  <span class="label-text">'),u.push(this.T(t.display)),u.push("</span>\n                </label>\n              </li>\n            ");u.push("\n          </ul>\n        </div>\n      </div>\n    </div>\n  ")}for(u.push("\n</div>\n\n<h3>"),u.push(this.T("Profiles")),u.push('</h3>\n<ul class="checkbox-list">\n  '),n=0,r=(p=this.profiles).length;n<r;n++)a=p[n],u.push('\n    <li>\n      <label class="inline-label radio-replacement">\n        <input class="js-profileSelector" type="radio" name="profile_id" value="'),u.push(h(a.id)),u.push('"'),this.params.profileSelected[a.id]&&u.push(" checked"),u.push(">\n        "),u.push(this.Icon("radio","icon-unchecked")),u.push("\n        "),u.push(this.Icon("radio-checked","icon-checked")),u.push('\n        <span class="label-text">'),u.push(h(a.name)),u.push("</span>\n      </label>\n    </li>\n  ");u.push("\n</ul>\n")}).call(this)
}.call(t),t.safe=e,t.escape=n,u.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/report/time_picker"]=function(t){t||(t={});var d=[],f=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u,h;if(d.push('<div class="">\n  '),"day"===this.params.timeRange){for(d.push('\n    <div class="btn-group btn-group--full" role="group" aria-label="">\n      '),t=0,r=(c=this.timeRangeDay).length;t<r;t++)e=c[t],d.push('\n        <div class="btn btn--text btn--large js-timePickerDay'),this.params.day===e.value&&d.push(" is-selected"),d.push('" data-id="'),d.push(f(this.params.timeRange)),d.push('" data-type="'),d.push(f(e.value)),d.push('">'),d.push(f(e.display)),d.push("</div>\n      ");d.push("\n    </div>\n  ")}if(d.push("\n\n  "),"day"===this.params.timeRange||"month"===this.params.timeRange){for(d.push('\n    <div class="btn-group btn-group--full" role="group" aria-label="">\n      '),n=0,o=(p=this.timeRangeMonth).length;n<o;n++)e=p[n],d.push('\n        <div class="btn btn--text btn--large js-timePickerMonth'),this.params.month===e.value&&d.push(" is-selected"),d.push('" data-id="'),d.push(f(this.params.timeRange)),d.push('" data-type="'),d.push(f(e.value)),d.push('">'),d.push(f(e.display)),d.push("</div>\n      ");d.push("\n    </div>\n  ")}if(d.push("\n\n  "),"week"===this.params.timeRange){for(d.push('\n    <div class="btn-group btn-group--full" role="group" aria-label="">\n      '),i=0,a=(u=this.timeRangeWeek).length;i<a;i++)e=u[i],d.push('\n        <div class="btn btn--text btn--large js-timePickerWeek'),this.params.week===e.value&&d.push(" is-selected"),d.push('" data-id="'),d.push(f(this.params.timeRange)),d.push('" data-type="'),d.push(f(e.value)),d.push('">'),d.push(f(e.display)),d.push("</div>\n      ");d.push("\n    </div>\n  ")}if(d.push("\n\n  "),"realtime"!==this.params.timeRange){for(d.push('\n    <div class="btn-group btn-group--full" role="group" aria-label="">\n      '),s=0,l=(h=this.timeRangeYear).length;s<l;s++)e=h[s],d.push('\n        <div class="btn btn--text btn--large js-timePickerYear'),this.params.year===e.value&&d.push(" is-selected"),d.push('" data-id="'),d.push(f(this.params.timeRange)),d.push('" data-type="'),d.push(f(e.value)),d.push('">'),d.push(f(e.display)),d.push("</div>\n      ");d.push("\n    </div>\n  ")}d.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,d.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/report/time_range_picker"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="tabs">\n  <div class="tab js-timeRange active" data-type="year">'),e.push(this.T("Year")),e.push('</div>\n  <div class="tab js-timeRange" data-type="month">'),e.push(this.T("Month")),e.push('</div>\n  <div class="tab js-timeRange" data-type="week">'),e.push(this.T("Week")),e.push('</div>\n  <div class="tab js-timeRange" data-type="day">'),e.push(this.T("Day")),e.push('</div>\n  <div class="tab js-timeRange" data-type="realtime">'),e.push(this.T("Realtime")),e.push("</div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/search/index"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="flex main vertical">\n\n  <div class="detail-search">\n    <div class="detail-search-header">\n      <div class="searchfield">\n        <input class="js-search form-control'),s.push(r(this.query?void 0:" is-empty")),s.push('" name="query" placeholder="'),s.push(this.Ti('Find what you search. E. g. "search phrase"')),s.push('" value="'),s.push(r(this.query)),s.push('" type="search" autocomplete="off">\n        '),s.push(this.Icon("magnifier")),s.push('\n        <div class="empty-search js-emptySearch">\n          '),s.push(this.Icon("diagonal-cross")),s.push('\n        </div>\n      </div>\n\n      <div class="tabs tabs-wide">\n        '),t=0,e=(n=this.tabs).length;t<e;t++)i=n[t],s.push('\n          <div data-tab-content="'),s.push(i.model),s.push('" class="tab js-tab js-tab'),s.push(i.model),i.active&&s.push(" active"),s.push('">\n            <span class="tab-name">'),s.push(this.T(i.name)),s.push('</span>\n            <span class="tab-badge js-counter">'),s.push(i.count),s.push("</span>\n          </div>\n        ");s.push('\n      </div>\n    </div>\n\n    <div class="js-content"></div>\n  </div>\n\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/session"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="page-header-title">\n  <h1>'),s.push(this.T("Sessions")),s.push('<small></small></h1>\n</div>\n<div class="page-content">\n  <table class="table table-striped table-hover">\n    <thead>\n      <tr>\n        <th>'),s.push(this.T("User")),s.push("</th>\n        <th>"),s.push(this.T("Browser")),s.push("</th>\n        <th>"),s.push(this.T("Location")),s.push("</th>\n        <th>"),s.push(this.T("Age")),s.push("</th>\n        <th>"),s.push(this.T("Update")),s.push("</th>\n        <th>"),s.push(this.T("Action")),s.push("</th>\n      </tr>\n    </thead>\n    <tbody>\n      "),t=0,e=(n=this.sessions).length;t<e;t++)i=n[t],s.push("\n      <tr>\n        <td>"),i.data.user&&s.push(r(i.data.user.displayName())),s.push('</td>\n        <td title="'),s.push(r(i.data.user_agent)),s.push('">'),s.push(r(i.data.user_agent)),s.push('</td>\n        <td title="'),s.push(r(i.data.remote_ip)),s.push('">'),i.data.geo&&i.data.geo.country_name?(s.push(r(i.data.geo.country_name)),s.push(" "),s.push(r(i.data.geo.city_name))):s.push(r(i.data.remote_ip)),s.push("</td>\n        <td>"),s.push(this.humanTime(i.created_at)),s.push("</td>\n        <td>"),s.push(this.humanTime(i.updated_at)),s.push('</td>\n        <td><a href="#" data-session-id="'),s.push(i.id),s.push('" class="js-delete" title="'),s.push(this.Ti("Delete")),s.push('">'),s.push(this.Icon("trash")),s.push("</a></td>\n      </tr>\n      ");s.push("\n    </tbody>\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/form"]=function(t){t||(t={});var s=[],e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<form>\n  <div class="settings-entry">\n    <table class="settings-list" style="width: 100%;">\n      <thead>\n        <tr>\n          <th width="15%">'),s.push(this.T("Title")),s.push('\n          <th width="50%">'),s.push(this.T("Value")),s.push('\n          <th width="35%">'),s.push(this.T("Description")),s.push("\n      </thead>\n      <tbody>\n"),t=0,e=(n=this.settings).length;t<e;t++)i=n[t],s.push("\n        <tr>\n          <td>"),s.push(this.T(i.title)),s.push('\n          <td data-name="'),s.push(i.name),s.push('">\n          <td><p class="help-text">'),s.push(this.RichText(i.description)),s.push("</p>\n");s.push('\n      </tbody>\n    </table>\n  </div>\n  <button type="submit" class="btn btn--primary js-submit">'),s.push(this.T("Submit")),s.push("</button>\n</form>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/item"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form class="settings-entry" id="'),e.push(n(this.setting.name)),e.push('">\n  <h2>'),e.push(this.T(this.setting.title)),e.push('</h2>\n  <p class="help-text">'),e.push(this.T(this.setting.description)),e.push('</p>\n  <div class="horizontal end">\n    <div class="form-item flex"></div>\n    <button type="submit" class="btn btn--primary">'),e.push(this.T("Submit")),e.push("</button>\n  </div>\n</form>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/logo"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form class="settings-entry" id="'),e.push(n(this.setting.name)),e.push('">\n  <h2>'),e.push(this.T(this.setting.title)),e.push("</h2>\n  <p>"),e.push(this.T(this.setting.description)),e.push('</p>\n  <div class="js-loginPreview"></div>\n  <div class="setting-controls">\n    <button type="submit" class="btn btn--primary">'),e.push(this.T("Submit")),e.push("</button>\n  </div>\n</form>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/proxy"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form class="settings-entry" id="'),e.push(n(this.setting.name)),e.push('">\n  <h2>'),e.push(this.T(this.setting.title)),e.push('</h2>\n  <p class="help-text">'),e.push(this.T("Proxy address.")),e.push('</p>\n  <div class="horizontal end">\n    <div class="form-item flex">\n      <input type="text" name="proxy" value="'),e.push(n(this.proxy)),e.push('" placeholder="proxy.example.com:3128" class="form-control">\n    </div>\n  </div>\n  <p class="help-text">'),e.push(this.T("Username for proxy connection.")),e.push('</p>\n  <div class="horizontal end">\n    <div class="form-item flex">\n      <input type="text" name="proxy_username" value="'),e.push(n(this.proxy_username)),e.push('" class="form-control">\n    </div>\n  </div>\n  <p class="help-text">'),e.push(this.T("Password for proxy connection.")),e.push('</p>\n  <div class="horizontal end">\n    <div class="form-item flex">\n      <input type="text" name="proxy_password" value="'),e.push(n(this.proxy_password)),e.push('" class="form-control">\n    </div>\n  </div>\n  <p class="help-text">'),e.push(this.T("No proxy for the following hosts.")),e.push('</p>\n  <div class="horizontal end">\n    <div class="form-item flex">\n      <input type="text" name="proxy_no" value="'),e.push(n(this.proxy_no)),e.push('" placeholder="localhost,127.0.0.1" class="form-control">\n    </div>\n  </div>\n  <div class="horizontal justify-end form-controls">\n    <button class="btn btn js-test">'),e.push(this.T("Test Connection")),e.push('</button>\n    <button class="btn btn--primary js-submit hide">'),e.push(this.T("Submit")),e.push("</button>\n  <div>\n</form>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/storage_provider"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form class="settings-entry" id="'),e.push(n(this.setting.name)),e.push('">\n  <h2>'),e.push(this.T(this.setting.title)),e.push('</h2>\n  <p class="help-text">'),e.push(this.T("You can switch between the backend for new attachments even on a system that is already in production without any loss of data.")),e.push('</p>\n  <p class="help-text">'),e.push(this.T("If you want to move already stored attachments from one backend to another, you need to execute the following via console.")),e.push('</p>\n  </p>\n  <p class="help-text">'),e.push(this.T('Move all from "%s" to "%s"',"filesystem","database")),e.push(":</p>\n  </p>\n  <code>\n  rails&gt; Store::File.move('File', 'DB')\n  </code>\n  <p class=\"help-text\">"),e.push(this.T('Move all from "%s" to "%s"',"database","filesystem")),e.push(':</p>\n  </p>\n  <code>\n  rails&gt; Store::File.move(\'DB\', \'File\')\n  </code>\n  <br>\n  <br>\n  <div class="horizontal end">\n    <div class="form-item flex"></div>\n    <button type="submit" class="btn btn--primary">'),e.push(this.T("Submit")),e.push("</button>\n  </div>\n</form>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/switch"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="page-header">\n  <div class="page-header-title">\n    <div class="zammad-switch zammad-switch--small js-setting" data-name="'),s.push(r(this.setting.name)),s.push('">\n       <input name="'),s.push(r(this.setting.name)),s.push('" type="checkbox" id="setting-'),s.push(r(this.setting.name)),s.push('" '),this.checked&&s.push("checked"),s.push('>\n       <label for="setting-'),s.push(r(this.setting.name)),s.push('"></label>\n    </div>\n    <h1>'),s.push(this.T.apply(this,[this.setting.title].concat(this.setting.preferences.title_i18n))),s.push('</h1>\n  </div>\n</div>\n<div class="page-content">\n  <p class="help-text">'),s.push(this.T.apply(this,[this.setting.description].concat(this.setting.preferences.description_i18n))),s.push("</p>\n  "),t=0,e=(i=this.subSetting).length;t<e;t++)n=i[t],s.push('\n  <form class="settings-entry" data-name="'),s.push(r(n.name)),s.push('">\n    <div class="horizontal end">\n      <div class="form-item flex"></div>\n      <button type="submit" class="btn btn--primary">'),s.push(this.T("Submit")),s.push("</button>\n    </div>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/ticket_auto_assignment"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n      <div class="zammad-switch zammad-switch--small js-ticketAutoAssignment">\n         <input name="ticket_auto_assignment" type="checkbox" id="ticket_auto_assignment" '),this.C("ticket_auto_assignment")&&e.push("checked"),e.push('>\n         <label for="ticket_auto_assignment"></label>\n      </div>\n    <h1>'),e.push(this.T("Auto Assignment")),e.push('<small></small></h1>\n  </div>\n</div>\n<div class="page-content">\n  <form class="settings-entry">\n    <p>'),e.push(this.T("Enable automatic assignment the first time an agent opens a ticket.")),e.push("</p>\n    <p>"),e.push(this.T("Tickets are only assigned automatically if they do not already have an owner.")),e.push('</p>\n    <div class="js-selector"></div>\n    <p>'),e.push(this.T('Define an exception of "automatic assignment" for certain users (e.g. executives).')),e.push('</p>\n    <div class="js-users"></div>\n    <button type="submit" class="btn btn--primary js-timeAccountingFilter">'),e.push(this.T("Save")),e.push('</button>\n    <button type="submit" class="btn btn--danger js-timeAccountingFilterReset">'),e.push(this.T("Reset")),e.push("</button>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/ticket_hook_position"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form class="settings-entry" id="'),e.push(n(this.setting.name)),e.push('">\n  <h2>'),e.push(this.T(this.setting.title)),e.push('</h2>\n  <p class="help-text">'),e.push(this.T("The format of the subject.")),e.push("</p>\n  <ul>\n    <li>"),e.push(this.T("|Right| means |Some Subject [Ticket#12345]|")),e.push("\n    <li>"),e.push(this.T("|Left| means |[Ticket#12345] Some Subject|")),e.push("\n    <li>"),e.push(this.T('|None| means |Some Subject| (without ticket number). In the last case you should enable "postmaster___follow___up___search___in" to recognize followups based on email headers and/or body.')),e.push('\n  </ul>\n  <div class="horizontal end">\n    <div class="js-form form-item flex"></div>\n    <button type="submit" class="btn btn--primary">'),e.push(this.T("Submit")),e.push("</button>\n  </div>\n</form>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/ticket_number"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="settings-entry" id="'),e.push(n(this.setting.name)),e.push('">\n  <h2>'),e.push(this.T(this.setting.title)),e.push('</h2>\n  <p class="help-text">\n  '),e.push(this.T("Selects the ticket number generator module.")),e.push("\n  <ul>\n    <li>"),e.push(this.T('|Increment| increments the ticket number, the SystemID and the counter are used with "SystemID.Counter" format (e.g. 1010138, 1010139).')),e.push("\n    <li>"),e.push(this.T('With |Date| the ticket numbers will be generated by the current date, the SystemID and the counter. The format looks like "Year.Month.Day.SystemID.Counter" (e.g. 201206231010138, 201206231010139).')),e.push('\n  </ul>\n  <form class="js-form"></form>\n  <br>\n  <div class="js-formPreferences"></div>\n  <br>\n  <label class="formGroup-label">'),e.push(this.T("Preview")),e.push('</label>\n  <div class="js-preview"></div>\n  <br>\n  <form class="horizontal end">\n    <button type="submit" class="btn btn--primary">'),e.push(this.T("Submit")),e.push("</button>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/ticket_number_date"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="js-date js-formPreferencesItem hidden" data-backend="Ticket::Number::Date">\n  <label class="formGroup-label">'),e.push(this.T("Options")),e.push("</label>\n  <div>"),e.push(this.T('With Checksum, a checksum will be appended to the counter. The format looks like "%s" (e. g. %s).',"Year.Month.Day.SystemID.Counter.CheckSum","2012070110101520, 2012070110101535")),e.push('</div>\n  <br>\n  <form class="js-formItem"></form>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/settings/ticket_number_increment"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="js-increment js-formPreferencesItem hidden" data-backend="Ticket::Number::Increment">\n  <label class="formGroup-label">'),e.push(this.T("Options")),e.push("</label>\n  <div>"),e.push(this.T('With Checksum, a checksum will be appended to the counter. The format looks like "%s" (e. g. %s).',"SystemID.Counter.CheckSum","10101384, 10101392")),e.push('</div>\n  <br>\n  <form class="js-formItem"></form>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/signup"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="signup fullscreen">\n  <div class="fullscreen-center">\n    <div class="hero-unit fullscreen-body">\n      <h1>'),e.push(this.T("Join %s",this.C("product_name"))),e.push('</h1>\n      <form>\n        <div class="form-controls">\n          <a class="btn btn--text btn--subtle js-cancel" href="#login">'),e.push(this.T("Cancel & Go Back")),e.push('</a>\n          <button class="btn btn--primary js-submit align-right">'),e.push(this.T("Create my account")),e.push("</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/signup/verify"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="signup fullscreen">\n  <div class="fullscreen-center">\n    <div class="hero-unit fullscreen-body">\n      <h1>'),e.push(this.T("Registration successful!")),e.push("</h1>\n      <p>"),e.push(this.T('Thanks for joining. Email sent to "%s".',this.email)),e.push("</p>\n      <p>"),e.push(this.T("Please click the link in the verification email.")),e.push(" "),e.push(this.T("If you don't see the email, check other places it might be, like your junk, spam, social, or other folders.")),e.push('</p>\n      <form>\n        <input type="hidden" name="email" value="'),e.push(n(this.email)),e.push('">\n        <div class="form-controls">\n          <a class="btn btn--text btn--subtle js-cancel" href="#login">'),e.push(this.T("Go Back")),e.push('</a>\n          <button class="btn btn--primary js-submitResend align-right">'),e.push(this.T("Resend verification email")),e.push("</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/sla/index"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(l.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),l.push(this.T("SLA")),l.push(" <small>"),l.push(this.T("Management")),l.push('</small></h1>\n  </div>\n\n  <div class="page-header-meta">\n    '),this.showDescription&&(l.push('\n      <a class="btn js-description">'),l.push(this.T("Description")),l.push("</a>\n    ")),l.push('\n    <a class="btn btn--success js-new">'),l.push(this.T("New SLA")),l.push('</a>\n  </div>\n</div>\n\n<div class="page-content">\n  '),_.isEmpty(this.slas)&&(l.push('\n  <div class="page-description">\n    '),l.push(this.description),l.push("\n  </div>\n  ")),l.push("\n\n  "),t=0,n=(s=this.slas).length;t<n;t++){for(a=s[t],l.push('\n  <div class="action" data-id="'),l.push(a.id),l.push('">\n    <div class="action-flow action-flow--row">\n      <div class="action-row">\n        <h2>'),l.push(c(a.name)),l.push('</h2>\n      </div>\n      <div class="action-block action-block--flex">\n        <div class="label">'),l.push(this.T("Filter")),l.push("</div>\n        "),e=0,i=(r=a.rules).length;e<i;e++)o=r[e],l.push("\n          "),l.push(o),l.push("<br>\n        ");l.push("\n      </div>\n      "),l.push(this.Icon("arrow-right","action-flow-icon")),l.push('\n      <div class="action-block action-block--flex">\n        <div class="label">'),l.push(this.T("Escalation Times")),l.push("</div>\n        "),a.first_response_time&&(l.push("\n          "),l.push(a.first_response_time_in_text),l.push(" "),l.push(this.T("hours")),l.push(" - "),l.push(this.T("First Response Time")),l.push("\n        ")),l.push("\n        "),a.update_time&&(l.push("\n          <br>\n          "),l.push(a.update_time_in_text),l.push(" "),l.push(this.T("hours")),l.push(" - "),l.push(this.T("Update Time")),l.push("\n        ")),l.push("\n        "),a.solution_time&&(l.push("\n          <br>\n          "),l.push(a.solution_time_in_text),l.push(" "),l.push(this.T("hours")),l.push(" - "),l.push(this.T("Solution Time")),l.push("\n        ")),l.push('\n        <br>\n      </div>\n    </div>\n    <div class="action-block">\n      <div class="label">'),l.push(this.T("Calendar")),l.push("</div>\n      "),l.push(c(a.calendar.displayName())),l.push('\n    </div>\n    <div class="action-controls">\n      <div class="sla-toggle btn btn--danger btn--secondary js-delete">'),l.push(this.T("Delete")),l.push('</div>\n      <div class="sla-edit btn js-edit">'),l.push(this.T("Edit")),l.push("</div>\n    </div>\n  </div>\n  ")}l.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/tag/edit"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form>\n  <div class="form-item">\n    <input type="text" name="name" class="" value="'),e.push(n(this.name)),e.push('" autocomplete="off">\n  </div>\n</form>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/tag/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),e.push(this.T("Tags")),e.push('<small></small></h1>\n  </div>\n</div>\n<div class="page-content">\n\n  <div class="settings-entry">\n    <div class="page-header-title">\n      <div class="zammad-switch zammad-switch--small js-newTagSetting">\n         <input name="tag-new" type="checkbox" id="tag-new" '),this.C("tag_new")&&e.push("checked"),e.push('>\n         <label for="tag-new"></label>\n      </div>\n      <h2>'),e.push(this.T("New Tags")),e.push("</h2>\n    </div>\n    <p>\u26a0 "),e.push(this.T("Allow users to add new tags.")),e.push('</p>\n  </div>\n\n  <div class="settings-entry vertical">\n    <h2>'),e.push(this.T("Manage Tags")),e.push('</h2>\n    <form class="horizontal form-group formGroup--halfSize js-create">\n      <div class="form-item">\n        <input type="text" name="name" class="" autocomplete="off">\n      </div>\n      <button type="submit" class="btn btn--primary js-submit">'),e.push(this.T("Add")),e.push('</button>\n    </form>\n    <div class="js-Table"></div>\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/tag/table"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<table class="table table-striped table-hover">\n  <thead>\n    <tr>\n      <th>'),s.push(this.T("Name")),s.push("</th>\n      <th>"),s.push(this.T("Count")),s.push("</th>\n      <th>"),s.push(this.T("Action")),s.push("</th>\n    </tr>\n  </thead>\n  <tbody>\n    "),t=0,n=(i=this.list).length;t<n;t++)e=i[t],s.push('\n    <tr data-id="'),s.push(r(e.id)),s.push('" class="js-edit u-clickable">\n      <td class="js-name">'),s.push(r(e.name)),s.push('</td>\n      <td class="js-search"><a href="#">'),s.push(r(e.count)),s.push('</a></td>\n      <td class="js-delete"><a href="#" title="'),s.push(this.Ti("Delete")),s.push('">'),s.push(this.Icon("trash")),s.push("</a></td>\n    </tr>\n    ");s.push("\n  </tbody>\n</table>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/telegram/bot_add"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="alert alert--danger hidden" role="alert"></div>\n<p>\n  '),e.push(this.T("The tutorial on how to manage a %s is hosted on our online documentation %l.","Telegram Bot","https://admin-docs.zammad.org/en/latest/channels/telegram.html")),e.push("\n</p>\n<fieldset>\n  <h2>"),e.push(this.T("Enter your %s App Keys","Telegram")),e.push('</h2>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="api_token">'),e.push(this.T("%s Api Token","Telegram")),e.push(' <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="api_token" type="text" name="api_token" value="" class="form-control" required autocomplete="off">\n    </div>\n  </div>\n  <h2>'),e.push(this.T("Settings")),e.push(
'</h2>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="welcome">'),e.push(this.T("Welcome message")),e.push(' <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="welcome" type="text" name="welcome" value="" placeholder="'),e.push(this.Ti("You are welcome! Just ask me something!")),e.push('" class="form-control" required autocomplete="off">\n    </div>\n  </div>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="goodbye">'),e.push(this.T("Goodbye message")),e.push(' <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="goodbye" type="text" name="goodbye" value="" placeholder="'),e.push(this.Ti("Have a nice day.")),e.push('" class="form-control" required autocomplete="off">\n    </div>\n  </div>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="">'),e.push(this.T("Choose the group in which messages will get added to.")),e.push(' <span>*</span></label>\n    </div>\n    <div class="controls">\n      <div class="js-messagesGroup"></div>\n    </div>\n  </div>\n</fieldset>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/telegram/bot_edit"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="alert alert--danger hidden" role="alert"></div>\n<fieldset>\n  <h2>'),e.push(this.T("Enter your %s App Keys","Telegram")),e.push('</h2>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="api_token">'),e.push(this.T("%s Api Token","Telegram")),e.push(' <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="api_token" type="text" name="api_token" value="'),e.push(n(this.channel.options.api_token)),e.push('" class="form-control" required autocomplete="off">\n    </div>\n  </div>\n  <h2>'),e.push(this.T("Settings")),e.push('</h2>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="welcome">'),e.push(this.T("welcome message")),e.push(' <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="welcome" type="text" name="welcome" value="'),e.push(n(this.channel.options.welcome)),e.push('" placeholder="'),e.push(this.Ti("You are welcome! Just ask me something!")),e.push('" class="form-control" required autocomplete="off">\n    </div>\n  </div>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="goodbye">'),e.push(this.T("Goodbye message")),e.push(' <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="goodbye" type="text" name="goodbye" value="'),e.push(n(this.channel.options.goodbye)),e.push('" placeholder="'),e.push(this.Ti("Have a nice day.")),e.push('" class="form-control" required autocomplete="off">\n    </div>\n  </div>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="">'),e.push(this.T("Choose the group in which messages will get added to.")),e.push(' <span>*</span></label>\n    </div>\n    <div class="controls">\n      <div class="js-messagesGroup"></div>\n    </div>\n  </div>\n</fieldset>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/telegram/index"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),s.push(this.T("Telegram")),s.push(" <small>"),s.push(this.T("Bots")),s.push('</small></h1>\n  </div>\n\n  <div class="page-header-meta">\n    <a class="btn btn--success js-new">'),s.push(this.T("Add Bot")),s.push('</a>\n  </div>\n</div>\n\n<div class="page-content">\n\n'),_.isEmpty(this.channels))s.push('\n  <div class="page-description">\n    <p>'),s.push(this.T("You have no configured %s right now.","Telegram Bot")),s.push("</p>\n  </div>\n");else{for(s.push("\n\n"),e=0,n=(i=this.channels).length;e<n;e++)t=i[e],s.push('\n  <div class="action '),!0!==t.active&&s.push("is-inactive"),s.push('" data-id="'),s.push(r(t.id)),s.push('">\n    <div class="action-block action-row">\n      <h2>'),s.push(this.Icon("status","supergood-color inline")),s.push(" "),s.push(r(t.options.bot.first_name)),s.push(' <span class="text-muted">@'),s.push(r(t.options.bot.username)),s.push('</span></h2>\n    </div>\n    <div class="action-flow action-flow--row">\n      <div class="action-block">\n        <h3>'),s.push(this.T("Messages")),s.push("</h3>\n        @"),s.push(r(t.options.bot.username)),s.push("\n      </div>\n      "),s.push(this.Icon("arrow-right","action-flow-icon")),s.push('\n      <div class="action-block">\n        <h3>'),s.push(this.T("Group")),s.push("</h3>\n        "),t.options&&(s.push("\n          "),s.push(r(t.options.groupName)),s.push("\n        ")),s.push('\n      </div>\n    </div>\n    <div class="action-controls">\n      <div class="btn btn--danger btn--secondary js-delete">'),s.push(this.T("Delete")),s.push("</div>\n      "),!0===t.active?(s.push('\n        <div class="btn btn--secondary js-disable">'),s.push(this.T("Disable"))):(s.push('\n        <div class="btn btn--secondary js-enable">'),s.push(this.T("Enable"))),s.push("</div>\n      "),s.push('\n      <div class="btn js-edit">'),s.push(this.T("Edit")),s.push("</div>\n    </div>\n  </div>\n");s.push("\n</div>\n")}}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_overview/batch_dragger"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="batch-dragger">\n\t<div class="batch-dragger-counter js-batch-dragger-count"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_overview/batch_overlay"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="batch-overlay-backdrop js-batch-overlay-backdrop"></div>\n<div class="batch-overlay-cancel js-batch-cancel">\n  '),e.push(this.T("drag here to cancel")),e.push('\n</div>\n<div class="batch-overlay-circle batch-overlay-circle--top js-batch-macro-circle">\n  <div class="batch-overlay-circle-label">'),e.push(this.T("run macro").split(" ").join("<br>")),e.push("</div>\n  "),e.push(this.Icon("arrow-up")),e.push('\n</div>\n<div class="batch-overlay-circle batch-overlay-circle--bottom js-batch-assign-circle">\n  '),e.push(this.Icon("arrow-down")),e.push('\n  <div class="batch-overlay-circle-label">'),e.push(this.T("assign tickets").split(" ").join("<br>")),e.push('</div>\n</div>\n<div class="batch-overlay-assign batch-overlay-box js-batch-assign">\n  <div class="batch-overlay-box-inner js-batch-assign-inner"></div>\n</div>\n<div class="batch-overlay-macro batch-overlay-box js-batch-macro"></div>\n<div class="batch-overlay-assign batch-overlay-assign-group batch-overlay-box js-batch-assign-group">\n  <div class="batch-overlay-assign-group-name js-batch-assign-group-name"></div>\n  <div class="batch-overlay-box-inner js-batch-assign-group-inner"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_overview/batch_overlay_macro"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="batch-overlay-box-inner">\n'),t=0,e=(i=this.macros).length;t<e;t++)n=i[t],s.push('\n  <div class="batch-overlay-macro-entry js-batch-overlay-entry js-batch-hover-target" data-action="macro" data-id="'),s.push(r(n.id)),s.push('">\n    <div class="batch-overlay-macro-entry-name">'),s.push(r(n.name)),s.push("</div>\n  </div>\n");s.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_overview/batch_overlay_user_group"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(e=0,i=(r=this.users).length;e<i;e++)a=r[e],l.push('\n<div class="batch-overlay-assign-entry js-batch-overlay-entry" data-action="user_assign" data-id="'),l.push(c(a.id)),l.push('" data-group-id="'),l.push(c(this.groupId)),l.push('">\n  <div class="js-batch-hover-target">'),l.push(a.avatar(80)),l.push('</div>\n  <div class="batch-overlay-assign-entry-name">'),l.push(a.displayName()),l.push("</div>\n</div>\n");for(l.push("\n"),n=0,s=(o=this.groups).length;n<s;n++)t=o[n],l.push('\n<div class="batch-overlay-assign-entry js-batch-overlay-entry" data-action="group_assign" data-id="'),l.push(c(t.id)),l.push('">\n\t<div class="js-batch-hover-target">'),l.push(t.avatar(80)),l.push('</div>\n  <div class="batch-overlay-assign-entry-name">'),l.push(t.displayName()),l.push('</div>\n  <div class="batch-overlay-assign-entry-detail">'),l.push(this.T("%s people",t.valid_users_count)),l.push("</div>\n</div>\n");l.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_overview/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="js-error hide fullscreenMessage"></div>\n<div class="sidebar"></div>\n<div class="main flex">\n  <div class="overview-header"></div>\n  <div class="overview-table"></div>\n</div>\n<div class="batch-overlay js-batch-overlay"></div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="tabsSidebar-holder">\n  <div class="scrollPageHeader tabsSidebar-sidebarSpacer" style="'),e.push("rtl"===this.dir?"left":"right"),e.push(": "),e.push(this.scrollbarWidth),e.push('px">\n    <small>'),e.push(this.C("ticket_hook")),e.push(' <span class="ticket-number">'),e.push(this.ticket.number),e.push('</span></small>\n    <div class="js-ticketTitleContainer ticket-title"></div>\n    <div class="js-highlighterContainer highlighter"></div>\n    <div class="js-overviewNavigatorContainer overview-navigator"></div>\n  </div>\n  <div class="main no-padding flex tabsSidebar-sidebarSpacer tabsSidebar-tabsSpacer">\n    <div class="ticketZoom">\n      <div class="ticketZoom-controls">\n        <div class="js-settingContainer"></div>\n        <div class="spacer"></div>\n        <div class="js-highlighterContainer highlighter"></div>\n        <div class="js-overviewNavigatorContainer overview-navigator"></div>\n      </div>\n      <div class="ticketZoom-header">\n        <div class="flex vertical center">\n          <div class="js-avatar"></div>\n          <div class="js-ticketTitleContainer ticket-title"></div>\n          <div class="js-ticketMetaContainer"></div>\n        </div>\n      </div>\n      <div class="ticket-article"></div>\n      <div class="article-new"></div>\n    </div>\n  </div>\n\n  <div class="tabsSidebar tabsSidebar--attributeBarSpacer vertical"></div>\n\n  <div class="attributeBar js-attributeBar"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/article_new"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(l.push('<form class="article-add '),this.article.internal?l.push("is-internal"):l.push("is-public"),l.push('" data-type="'),l.push(c(this.article.type)),l.push('">\n  <input type="hidden" name="type" value="'),l.push(c(this.article.type)),l.push('">\n  <input type="hidden" name="internal" value="'),l.push(c(this.article.internal)),l.push('">\n  <input type="hidden" name="form_id" value="'),l.push(c(this.form_id)),l.push('">\n  <input type="hidden" name="subtype" value="'),l.push(c(this.article.subtype)),l.push('">\n  <input type="hidden" name="in_reply_to" value="'),l.push(c(this.article.in_reply_to)),l.push('">\n  <div class="editControls">\n    <div class="js-avatar"></div>\n    <div class="editControls-item is-hidden pop-select">\n      <div class="editControls-iconHolder centered js-selectedArticleType">\n        '),e=0,i=(r=this.articleTypes).length;e<i;e++)t=r[e],l.push('\n        <div class="editControls-icon js-selectableTypes'),t.icon!==this.article.icon&&l.push(" hide"),l.push('" data-type="'),l.push(t.name),l.push('">\n        '),l.push(this.Icon(t.icon)),l.push("\n        </div>\n        ");for(l.push('\n      </div>\n      <div class="pop-selector is-hidden js-articleTypes">\n        '),n=0,s=(o=this.articleTypes).length;n<s;n++)t=o[n],l.push('\n        <div class="editControls-icon pop-selectable js-articleTypeItem" data-value="'),l.push(c(t.name)),l.push('">\n          '),l.push(this.Icon(t.icon,"pop-selectable-icon")),l.push("\n        </div>\n        ");l.push("\n      </div>\n    </div>\n    "),this.internalSelector&&(l.push('\n    <div class="editControls-item is-hidden js-toggleVisibility js-selectInternalPublic">\n      <div class="editControls-iconHolder">\n        <div class="editControls-icon icon-internal" title="'),l.push(this.Ti("set to public")),l.push('">\n          '),l.push(this.Icon("lock")),l.push('\n        </div>\n        <div class="editControls-icon icon-public" title="'),l.push(this.Ti("set to internal")),l.push('">\n          '),l.push(this.Icon("lock-open")),l.push("\n        </div>\n      </div>\n    </div>\n    ")),l.push('\n  </div>\n  <div class="article-content bubble-gap">\n    <div class="internal-border">\n\n      <div class="input form-group">\n        <div class="formGroup-label">\n          <label for="">'),l.push(this.T("To")),l.push('</label>\n        </div>\n        <div class="controls"><input type="text" name="to" value="'),l.push(c(this.article.to)),l.push('" class="form-control js-mail-inputs js-to" required="required"></div>\n      </div>\n      <div class="input form-group">\n        <div class="formGroup-label">\n          <label for="">'),l.push(this.T("Cc")),l.push('</label>\n        </div>\n        <div class="controls"><input type="text" name="cc" value="'),l.push(c(this.article.cc)),l.push('" class="form-control js-mail-inputs js-cc"></div>\n      </div>\n      <div class="input form-group">\n        <div class="formGroup-label">\n          <label for="">'),l.push(this.T("Subject")),l.push('</label>\n        </div>\n        <div class="controls"><input type="text" name="subject" value="'),l.push(c(this.article.subject)),l.push('" class="form-control js-mail-inputs2 js-subject"></div>\n      </div>\n      <div class="form-group js-securityOptions">\n        <div class="formGroup-label">\n          <label for="">'),l.push(this.T("Security")),l.push('</label>\n        </div>\n        <div class="horizontal">\n          <span class="js-securityEncryptComment">\n            <div class="btn btn--action js-securityEncrypt js-active-toggle" disabled>'),l.push(this.Icon("lock-open","btn-inactive-icon")),l.push(this.Icon("lock","btn-active-icon")),l.push(this.T("Encrypt")),l.push('</div>\n          </span>\n          <span class="js-securitySignComment" style="margin-left: 10px;">\n            <div class="btn btn--action js-securitySign js-active-toggle" disabled>'),l.push(this.Icon("not-signed","btn-inactive-icon")),l.push(this.Icon("signed","btn-active-icon")),l.push(this.T("Sign")),l.push('</div>\n          </span>\n        </div>\n      </div>\n\n      <div class="textBubble js-writeArea">\n        <div class="bubble-arrow"></div>\n        <div class="js-textarea richtext-content articleNewEdit-body" contenteditable="true" data-name="body">'),l.push(this.article.body),l.push('</div>\n        <!-- .textBubble grows with textarea (and expanding clone) -->\n        <div class="textBubble-footer js-textSizeLimit">\n          <div class="textBubble-signatur"><span class="js-signature"></span></div>\n          <div class="textBubble-letterCount js-letterCount"></div>\n        </div>\n        <div class="attachments"></div>\n        <div class="article-attachment">\n          <div class="attachmentPlaceholder">\n            <span class="attachmentPlaceholder-hint">'),l.push(this.T("Enter Note or")),l.push('</span>\n            <span class="attachmentPlaceholder-inputHolder fileUpload">\n              '),a=_.uniqueId("fileUpload_"),l.push('\n              <input multiple="multiple" type="file" name="file" id="'),l.push(a),l.push('">\n              <label class="attachmentPlaceholder-label" for="'),l.push(a),l.push('">\n                '),l.push(this.T("select attachment...")),l.push('\n              </label>\n            </span>\n          </div>\n          <div class="attachmentUpload hide">\n            <div class="horizontal">\n              <div class="u-highlight">\n                '),l.push(this.T("Uploading")),l.push(' (<span class="js-percentage">0</span>%) ...\n              </div>\n              <div class="attachmentUpload-cancel js-cancel">\n                '),l.push(this.Icon("diagonal-cross")),l.push(this.T("Cancel Upload")),l.push('\n              </div>\n            </div>\n            <div class="attachmentUpload-progressBar" style="width: 0%"></div>\n          </div>\n        </div>\n        <div class="dropArea">\n          <div class="dropArea-inner">\n            '),l.push(this.T("Drop files here")),l.push("\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</form>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/article_view"]=function(t){t||(t={});var tt=[],et=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u,h,d,f,m,g,v,y,b,_,w,k,T,A,S,C,x,j,P,I,E,D,O,N,R,M,$,L,U,z,B,F,q,J,H,W,G,K,V,Y,X,Z,Q;if(tt.push('<div class="article-meta-clip top">\n  <div class="article-content-meta top hide">\n    <div class="article-meta top">\n    '),this.article.from&&(tt.push('\n      <div class="horizontal article-meta-row">\n        <div class="article-meta-key u-textTruncate">'),tt.push(this.T("From")),tt.push('</div>\n        <div class="article-meta-value flex contain-text">'),tt.push(this.AddressLine(this.article.from)),tt.push("</div>\n      </div>\n    ")),tt.push("\n    "),this.article.reply_to&&(tt.push('\n      <div class="horizontal article-meta-row">\n        <div class="article-meta-key u-textTruncate">'),tt.push(this.T("Reply-To")),tt.push('</div>\n        <div class="article-meta-value flex contain-text">'),tt.push(this.AddressLine(this.article.reply_to)),tt.push("</div>\n      </div>\n    ")),tt.push("\n    "),this.article.to&&(tt.push('\n      <div class="horizontal article-meta-row">\n        <div class="article-meta-key u-textTruncate">'),tt.push(this.T("To")),tt.push('</div>\n        <div class="article-meta-value flex contain-text">'),tt.push(this.AddressLine(this.article.to)),tt.push("</div>\n      </div>\n    ")),tt.push("\n    "),this.article.cc&&(tt.push('\n      <div class="horizontal article-meta-row">\n        <div class="article-meta-key u-textTruncate">'),tt.push(this.T("Cc")),tt.push('</div>\n        <div class="article-meta-value flex contain-text">'),tt.push(this.AddressLine(this.article.cc)),tt.push("</div>\n      </div>\n    ")),tt.push("\n    "),this.article.subject&&(tt.push('\n      <div class="horizontal article-meta-row">\n        <div class="article-meta-key u-textTruncate">'),tt.push(this.T("Subject")),tt.push('</div>\n        <div class="article-meta-value flex contain-text">'),tt.push(et(this.article.subject)),tt.push("</div>\n      </div>\n    ")),tt.push("\n    "),((null!=(r=this.article.preferences.security)&&null!=(o=r.encryption)?o.success:void 0)||(null!=(v=this.article.preferences.security)&&null!=(j=v.sign)?j.success:void 0))&&(tt.push('\n      <div class="horizontal article-meta-row">\n        <div class="article-meta-key u-textTruncate">'),tt.push(this.T("Security")),tt.push('</div>\n        <div class="article-meta-value flex contain-text">\n          '),(null!=(U=this.article.preferences.security)&&null!=(V=U.encryption)?V.success:void 0)&&(tt.push('\n            <span title="'),tt.push(this.Ti(null!=(Y=this.article.preferences.security)&&null!=(X=Y.encryption)?X.comment:void 0)),tt.push('">'),tt.push(this.Icon("lock","article-meta-icon")),tt.push(" "),tt.push(this.T("Encrypted")),tt.push("</span>\n          ")),tt.push("\n          "),(null!=(Z=this.article.preferences.security)&&null!=(Q=Z.encryption)?Q.success:void 0)&&(null!=(a=this.article.preferences.security)&&null!=(l=a.sign)?l.success:void 0)&&tt.push("\n          ,\n          "),tt.push("\n          "),!0===(null!=(c=this.article.preferences.security)&&null!=(p=c.sign)?p.success:void 0)&&(tt.push('\n            <span title="'),tt.push(this.Ti(null!=(u=this.article.preferences.security)&&null!=(h=u.sign)?h.comment:void 0)),tt.push('">'),tt.push(this.Icon(!0===(null!=(d=this.article.preferences.security)&&null!=(f=d.sign)?f.success:void 0)?"signed":"not-signed","article-meta-icon")),tt.push(" "),tt.push(this.T(!0===(null!=(m=this.article.preferences.security)&&null!=(g=m.sign)?g.success:void 0)?"Signed":"Unsigned")),tt.push("</span>\n          ")),tt.push("\n        </div>\n      </div>\n    ")),tt.push('\n    </div>\n  </div>\n</div>\n<div class="article-meta-permanent">\n'),!1===(null!=(y=this.article.preferences.security)&&null!=(b=y.sign)?b.success:void 0)&&(null!=(_=this.article.preferences.security)&&null!=(w=_.sign)?w.comment:void 0)||!1===(null!=(k=this.article.preferences.security)&&null!=(T=k.encryption)?T.success:void 0)&&(null!=(A=this.article.preferences.security)&&null!=(S=A.encryption)?S.comment:void 0)?(tt.push('\n  <div class="alert alert--warning">\n    '),tt.push(this.Icon("not-signed")),tt.push(" "),tt.push(this.T("Security Error")),tt.push("\n    "),!1===(null!=(C=this.article.preferences.security)&&null!=(x=C.sign)?x.success:void 0)&&(null!=(P=this.article.preferences.security)&&null!=(I=P.sign)?I.comment:void 0)&&(tt.push("\n      <br>\n      "),tt.push(this.T("Sign")),tt.push(": "),tt.push(this.T(null!=(E=this.article.preferences.security)&&null!=(D=E.sign)?D.comment:void 0)),tt.push("\n    ")),tt.push("\n    "),!1===(null!=(O=this.article.preferences.security)&&null!=(N=O.encryption)?N.success:void 0)&&(null!=(R=this.article.preferences.security)&&null!=(M=R.encryption)?M.comment:void 0)&&(tt.push("\n      <br>\n      "),tt.push(this.T("Encryption")),tt.push(": "),tt.push(this.T(null!=($=this.article.preferences.security)&&null!=(L=$.encryption)?L.comment:void 0)),tt.push("\n    ")),tt.push('\n    <div class="flex-spacer"></div>\n    <div class="btn btn--action btn--small js-securityRetryProcess">'),tt.push(this.T("Retry security process")),tt.push("</div>\n  </div>\n")):!0!==(null!=(z=this.article.preferences.security)&&null!=(B=z.encryption)?B.success:void 0)&&!0!==(null!=(F=this.article.preferences.security)&&null!=(q=F.sign)?q.success:void 0)||(tt.push('\n  <div class="alert alert--blank horizontal">\n  '),!0===(null!=(J=this.article.preferences.security)&&null!=(H=J.encryption)?H.success:void 0)&&(tt.push('\n    <span title="'),tt.push(this.T("Encrypted")),tt.push('">'),tt.push(this.Icon("lock")),tt.push("</span>\n  ")),tt.push("\n  "),!0===(null!=(W=this.article.preferences.security)&&null!=(G=W.sign)?G.success:void 0)&&(tt.push('\n    <span title="'),tt.push(this.T("Signed")),tt.push('">'),tt.push(this.Icon("signed")),tt.push("</span>\n  ")),tt.push("\n  </div>\n")),tt.push('\n</div>\n<div class="article-content">\n  '),"Agent"!==this.article.sender.name?(tt.push("\n  "),"left"):(tt.push("\n  "),"right"),tt.push("\n  "),tt.push('\n  <div class="js-avatar"></div>\n  <div class="bubble-gap">\n    <div class="internal-border">\n      <div class="textBubble">\n        <div class="bubble-arrow"></div>\n        <div class="textBubble-content" id="article-content-'),tt.push(et(this.article.id)),tt.push('" data-id="'),tt.push(et(this.article.id)),tt.push('">\n          <div class="richtext-content">'),tt.push(this.article.html),tt.push('</div>\n          <div class="textBubble-overflowContainer hide">\n            <div class="btn btn--text js-toggleFold">'),tt.push(this.T("See more")),tt.push("</div>\n          </div>\n        </div>\n        "),tt.push(this.attachments),tt.push('\n      </div>\n    </div>\n  </div>\n</div>\n<div class="article-meta-clip bottom">\n  <div class="article-content-meta bottom hide">\n    <div class="article-meta bottom">\n      <div class="horizontal article-meta-row">\n        <div class="article-meta-key">'),tt.push(this.T("Channel")),tt.push('</div>\n        <div class="article-meta-value">\n          '),n=this.article.type.name.split(" "),tt.push("\n          "),tt.push(this.Icon(n[0],"article-meta-icon")),tt.push("\n          "),tt.push(this.T(this.article.type.name)),tt.push('\n          <div class="article-meta-links">\n          '),this.links){for(tt.push("\n            "),t=0,tt.push("\n            "),e=0,i=(K=this.links).length;e<i;e++)s=K[e],tt.push("\n              "),0<t&&tt.push("|"),tt.push('\n              <a class="text-muted" href="'),tt.push(s.url),tt.push('" target="'),tt.push(s.target),tt.push('">'),tt.push(this.T(s.name)),tt.push("</a>\n              "),t=1,tt.push("\n            ");tt.push("\n          ")}tt.push('\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class="js-article-actions"></div>\n\n<small class="task-subline">'),tt.push(this.humanTime(this.article.created_at)),tt.push("</small>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,tt.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/article_view_actions"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="article-content article-actions horizontal stretch">\n  '),e=0,n=(i=this.actions).length;e<n;e++)t=i[e],s.push('\n    <a href="'),s.push(r(t.href)),s.push('" data-type="'),s.push(r(t.type)),s.push('" class="article-action js-ArticleAction u-clickable'),t["class"]&&(s.push(" "),s.push(r(t["class"]))),s.push('">\n      '),s.push(this.Icon(t.icon,"article-action-icon")),s.push('<span class="article-action-name">'),s.push(this.T(t.name)),s.push("</span>\n    </a>\n  ");s.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/article_view_delivery_failed"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="article-meta-clip"></div>\n<div class="article-content">\n  <div class="small task-subline alert alert--warning">\n    '),e.push(this.T("Delivery failed")),e.push(': "'),e.push(n(this.article.body)),e.push('"\n  </div>\n</div>\n<div class="article-meta-clip"></div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/article_view_system"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="small task-subline">\n"'),e.push(n(this.article.subject)),e.push('" -&gt; "'),e.push(n(this.article.to)),e.push('"\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/attribute_bar"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push('<div class="flex horizontal js-avatars"></div>\n<div class="buttonDropdown btn js-reset '),this.resetButtonShown||s.push("hide"),s.push('">'),s.push(this.T("Discard your unsaved changes.")),s.push('</div>\n<div class="buttonDropdown dropdown dropdown--actions dropup">\n  <div class="btn btn--text btn--icon--last" data-toggle="dropdown">\n    <span class="js-secondaryActionButtonLabel"></span> '),s.push(this.Icon("arrow-up")),s.push('\n  </div>\n  <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="secondaryAction">\n    <li class="js-secondaryAction" role="menuitem">\n      <span class="js-secondaryActionLabel" data-type="closeTab">'),s.push(this.T("Close tab")),s.push('</span>\n      <span class="dropdown-selectedSpacer js-selectedIcon">\n        '),s.push(this.Icon("checkmark")),s.push("\n      </span>\n    "),this.overview_id&&(s.push('\n    <li class="js-secondaryAction" role="menuitem">\n      <span class="js-secondaryActionLabel" data-type="closeNextInOverview">'),s.push(this.T("Next in overview")),s.push(
'</span>\n      <span class="dropdown-selectedSpacer js-selectedIcon">\n        '),s.push(this.Icon("checkmark")),s.push("\n      </span>\n    ")),s.push('\n    <li class="js-secondaryAction" role="menuitem">\n      <span class="js-secondaryActionLabel" data-type="stayOnTab">'),s.push(this.T("Stay on tab")),s.push('</span>\n      <span class="dropdown-selectedSpacer js-selectedIcon">\n        '),s.push(this.Icon("checkmark")),s.push('\n      </span>\n  </ul>\n</div>\n<form class="buttonDropdown">\n'),this.macroDisabled)s.push('\n  <button class="btn btn--primary js-submit">'),s.push(this.T("Update")),s.push("</button>\n");else{for(s.push('\n  <div class="buttonDropdown dropdown dropup js-submitDropdown">\n    <button class="btn btn--primary btn--split--first js-submit">'),s.push(this.T("Update")),s.push('</button>\n    <button class="btn btn--primary btn--slim btn--split--last js-openDropdownMacro">'),s.push(this.Icon("arrow-up")),s.push('</button>\n    <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="userAction">\n      '),t=0,e=(i=this.macros).length;t<e;t++)n=i[t],s.push('\n        <li class="js-dropdownActionMacro" role="menuitem" data-id="'),s.push(r(n.id)),s.push('">'),s.push(this.T(n.displayName())),s.push("\n      ");s.push("\n    </ul>\n  </div>\n")}s.push("\n</form>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/highlighter"]=function(t){t||(t={});var r=[],o=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s;for(r.push('<div class="btn btn--action btn--split--first js-highlight centered">\n  '),r.push(this.Icon("marker","js-highlight-icon")),r.push('\n</div>\n<div class="dropdown dropdown--actions">\n  <div class="btn btn--action btn--split--last btn--slim centered" data-toggle="dropdown" aria-expanded="true">\n    '),r.push(this.Icon("arrow-down")),r.push('\n  </div>\n  <ul class="dropdown-menu dropdown-menu-right" role="menu">\n    '),e=n=0,i=(s=this.colors).length;n<i;e=++n)t=s[e],r.push('\n    <li role="presentation">\n      <a role="menuitem" tabindex="-1" class="js-highlightColor" data-key="'),r.push(o(e)),r.push('">\n        <span class="dropdown-iconSpacer">\n          <span class="color-swatch icon" style="color: '),r.push(o(t.color)),r.push('"></span>\n        </span>\n        '),r.push(this.Ti(t.name)),r.push('\n        <span class="dropdown-selectedSpacer js-selectedIcon'),e===this.activeColorIndex&&r.push(o(" is-selected")),r.push('">\n          '),r.push(this.Icon("checkmark")),r.push("\n        </span>\n      </a>\n    ");r.push("\n  </ul>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,r.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/meta"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<small class="task-subline">\n  '),e.push(this.C("ticket_hook")),e.push(' <span class="ticket-number js-objectNumber" data-number="'),e.push(this.C("ticket_hook")),e.push(n(this.ticket.number)),e.push('">'),e.push(n(this.ticket.number)),e.push("</span> - "),e.push(this.T("created")),e.push(" "),e.push(this.humanTime(this.ticket.created_at)),e.push(" "),!this.isCustomer&&this.ticket.escalation_at&&(e.push(" - "),e.push(this.T("escalation")),e.push(" "),e.push(this.humanTime(this.ticket.escalation_at,!0))),e.push("\n</small>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/overview_navigator"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="pagination-counter" title="'),e.push(this.Ti(this.title)),e.push('">\n  <span class="pagination-item-current">'),e.push(n(this.current_position)),e.push('</span>/<span class="pagination-total-items">'),e.push(n(this.total_count)),e.push('</span>\n</div>\n<ul class="pagination">\n  <li '),this.previous||e.push('class="disabled"'),e.push(' title="'),e.push(this.Ti("Previous in overview")),e.push('">\n    <a class="centered previous" href="'),this.previous&&e.push(this.previous.uiUrl()),e.push('" data-id="'),this.previous&&e.push(this.previous.id),e.push('">\n      '),this.previous?(e.push("\n        "),e.push(this.Icon("arrow-left"))):(e.push("\n        "),e.push(this.Icon("arrow-left","arrow--disabled"))),e.push("\n      "),e.push("\n    </a>\n  <li "),this.next||e.push('class="disabled"'),e.push(' title="'),e.push(this.Ti("Next in overview")),e.push('">\n    <a class="centered next" href="'),this.next&&e.push(this.next.uiUrl()),e.push('" data-id="'),this.next&&e.push(this.next.id),e.push('">\n      '),this.next?(e.push("\n        "),e.push(this.Icon("arrow-right"))):(e.push("\n        "),e.push(this.Icon("arrow-right","arrow--disabled"))),e.push("\n      "),e.push("\n    </a>\n</ul>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/setting"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="btn btn--action js-setting centered">\n  '),e.push(this.Icon("cog","dropdown-icon")),e.push("\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/sidebar_article_attachment"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="attachments-block js-attachments">\n  <div class="attachments-block-headline">'),s.push(this.humanTime(this.article.created_at)),s.push("</div>\n  "),e=0,n=(i=this.article.attachments).length;e<n;e++)t=i[e],s.push('\n    <a class="attachment attachment--preview" title="'),s.push(t.preferences["Content-Type"]),s.push('" target="_blank" href="'),s.push(r(App.Config.get("api_path"))),s.push("/ticket_attachment/"),s.push(r(this.article.ticket_id)),s.push("/"),s.push(r(this.article.id)),s.push("/"),s.push(r(t.id)),s.push('?disposition=attachment" data-type="attachment"'),this.canDownload(t.preferences["Content-Type"])&&s.push(" download"),s.push('>\n      <div class="attachment-icon">\n      '),t.preferences&&t.preferences["Content-Type"]&&this.ContentTypeIcon(t.preferences["Content-Type"])?(s.push("\n        "),this.canPreview(t.preferences["Content-Type"])?(s.push('\n          <img src="'),s.push(r(App.Config.get("api_path"))),s.push("/ticket_attachment/"),s.push(r(this.article.ticket_id)),s.push("/"),s.push(r(this.article.id)),s.push("/"),s.push(r(t.id)),s.push('?view=preview">\n        ')):(s.push("\n          "),s.push(this.Icon(this.ContentTypeIcon(t.preferences["Content-Type"]))),s.push("\n        "))):(s.push("\n        "),s.push(this.Icon("file-unknown"))),s.push("\n      "),s.push('\n      </div>\n      <span class="attachment-name u-highlight">'),s.push(r(t.filename)),s.push('</span>\n      <div class="attachment-size">'),s.push(this.humanFileSize(t.size)),s.push("</div>\n    </a>\n  ");s.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/sidebar_idoit"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(t=0,e=(i=this.objects).length;t<e;t++)n=i[t],s.push('\n  <div class="sidebar-block">\n    <label class="horizontal">\n      '),s.push(this.T("ID")),s.push(": "),s.push(this.T(n.id)),s.push('\n      <div class="list-item-delete js-delete" data-object-id="'),s.push(r(n.id)),s.push('" data-type="remove">\n        '),s.push(this.Icon("diagonal-cross")),s.push('\n      </div>\n    </label>\n    <a href="'),s.push(n.link),s.push('" target="_blank">'),s.push(r(n.title)),s.push("<br></a>\n    "),s.push(this.T("Status")),s.push(": "),s.push(r(n.cmdb_status_title)),s.push("<br>\n    "),s.push(this.T("Type")),s.push(": "),s.push(r(n.type_title)),s.push("<br>\n  </div>\n");s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/sidebar_ticket"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form>\n  <fieldset class="edit"></fieldset>\n</form>\n<div class="tags"></div>\n<div class="links"></div>\n<div class="link_kb_answers"></div>\n<div class="js-timeUnit"></div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/time_accounting"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<form>\n  <input type="text" name="time_unit" placeholder="'),e.push(this.T("Please enter your time which you want to account.")),e.push('"/>\n</form>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/time_unit"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push("<div>\n  <label>"),e.push(this.T("Accounted Time")),e.push("</label>\n  <div>"),e.push(n(this.ticket.time_unit)),e.push("</div>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/ticket_zoom/title"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div contenteditable="true" class="ticket-title-update js-objectTitle" data-placeholder="'),e.push(this.Ti("Enter Title...")),e.push('">'),e.push(n(this.object.title||"-")),e.push("</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/time_accounting/by_customer"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(this.rows.length){for(s.push('\n<table class="table table-striped table-hover">\n  <thead>\n  <tr>\n    <th>'),s.push(this.T("Customer")),s.push("\n    <th>"),s.push(this.T("Organization")),s.push("\n    <th>"),s.push(this.T("Time Units")),s.push("\n  </thead>\n  <tbody>\n  "),t=0,e=(n=this.rows).length;t<e;t++)i=n[t],s.push('\n  <tr>\n    <td><a href="#user/profile/'),s.push(i.customer.id),s.push('">'),s.push(r(i.customer.email)),s.push("</a>\n    <td>"),i.organization&&s.push(r(i.organization.name)),s.push("\n    <td>"),s.push(r(i.time_unit)),s.push("\n  ");s.push("\n  </tbody>\n</table>\n</div>\n")}else s.push('\n  <table class="settings-list settings-list--stretch settings-list--placeholder">\n    <thead><tr><th>'),s.push(this.T("No Entries")),s.push("\n  </table>\n");s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/time_accounting/by_organization"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(this.rows.length){for(s.push('\n<table class="table table-striped table-hover">\n  <thead>\n  <tr>\n    <th>'),s.push(this.T("Organization")),s.push("\n    <th>"),s.push(this.T("Time Units")),s.push("\n  </thead>\n  <tbody>\n  "),t=0,e=(n=this.rows).length;t<e;t++)i=n[t],s.push('\n  <tr>\n    <td><a href="#organization/profile/'),s.push(i.organization.id),s.push('">'),s.push(r(i.organization.name)),s.push("</a>\n    <td>"),s.push(r(i.time_unit)),s.push("\n  ");s.push("\n  </tbody>\n</table>\n</div>\n")}else s.push('\n  <table class="settings-list settings-list--stretch settings-list--placeholder">\n    <thead><tr><th>'),s.push(this.T("No Entries")),s.push("\n  </table>\n");s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/time_accounting/by_ticket"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(this.rows.length){for(s.push('\n<table class="table table-striped table-hover">\n  <thead>\n  <tr>\n    <th>'),s.push(this.T("Ticket#")),s.push("\n    <th>"),s.push(this.T("Title")),s.push("\n    <th>"),s.push(this.T("Customer")),s.push("\n    <th>"),s.push(this.T("Organization")),s.push("\n    <th>"),s.push(this.T("Agent")),s.push("\n    <th>"),s.push(this.T("Time Units")),s.push("\n    <th>"),s.push(this.T("Time Units Total")),s.push("\n    <th>"),s.push(this.T("Created at")),s.push("\n    <th>"),s.push(this.T("Closed at")),s.push("\n  </thead>\n  <tbody>\n  "),t=0,e=(n=this.rows).length;t<e;t++)i=n[t],s.push('\n  <tr>\n    <td><a href="#ticket/zoom/'),s.push(i.ticket.id),s.push('">'),s.push(r(i.ticket.number)),s.push('</a>\n    <td title="'),s.push(r(i.ticket.title)),s.push('">'),s.push(r(i.ticket.title||"-")),s.push("\n    <td>"),s.push(r(i.customer)),s.push("\n    <td>"),s.push(r(i.organization)),s.push("\n    <td>"),s.push(r(i.agent)),s.push("\n    <td>"),s.push(r(i.time_unit)),s.push("\n    <td>"),s.push(r(i.ticket.time_unit)),s.push("\n    <td>"),s.push(this.humanTime(i.ticket.created_at)),s.push("\n    <td>"),s.push(this.humanTime(i.ticket.close_at)),s.push("\n  ");s.push("\n  </tbody>\n</table>\n</div>\n")}else s.push('\n  <table class="settings-list settings-list--stretch settings-list--placeholder">\n    <thead><tr><th>'),s.push(this.T("No Entries")),s.push("\n  </table>\n");s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/time_accounting/index"]=function(t){t||(t={});var a=[],l=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o;for(a.push('<div class="page-header">\n  <div class="page-header-title">\n      <div class="zammad-switch zammad-switch--small js-timeAccountingSetting">\n         <input name="chat" type="checkbox" id="time-accounting" '),this.C("time_accounting")&&a.push("checked"),a.push('>\n         <label for="time-accounting"></label>\n      </div>\n    <h1>'),a.push(this.T("Time Accounting")),a.push('<small></small></h1>\n  </div>\n</div>\n<div class="page-content">\n\n  <div class="settings-entry">\n    <div class="page-header-title">\n      <h2>'),a.push(this.T("Selector")),a.push("</h2>\n    </div>\n    <p>"),a.push(this.T("Enable time accounting for following matching tickets.")),a.push('</p>\n    <div class="js-selector"></div>\n    <button type="submit" class="btn btn--primary js-timeAccountingFilter">'),a.push(this.T("Save")),a.push('</button>\n    <button type="submit" class="btn btn--danger js-timeAccountingFilterReset">'),a.push(this.T("Reset")),a.push('</button>\n  </div>\n\n  <div class="settings-entry">\n\n    <h2>'),a.push(this.T("Overviews")),a.push('</h2>\n    <div class="well">\n      <div class="btn-group btn-group--full" role="group" aria-label="">\n        '),t=0,i=(r=this.timeRangeYear).length;t<i;t++)e=r[t],a.push('\n          <div class="btn btn--text btn--large js-timePickerYear'),this.year===e.value&&a.push(" is-selected"),a.push('" data-id="'),a.push(l(this.timeRange)),a.push('" data-type="'),a.push(l(e.value)),a.push('">'),a.push(l(e.display)),a.push("</div>\n        ");for(a.push('\n      </div>\n\n      <div class="btn-group btn-group--full" role="group" aria-label="">\n        '),n=0,s=(o=this.timeRangeMonth).length;n<s;n++)e=o[n],a.push('\n          <div class="btn btn--text btn--large js-timePickerMonth'),this.month===e.value&&a.push(" is-selected"),a.push('" data-id="'),a.push(l(this.timeRange)),a.push('" data-type="'),a.push(l(e.value)),a.push('">'),a.push(l(e.display)),a.push("</div>\n        ");a.push("\n      </div>\n    </div>\n    <h3>"),a.push(this.T("Ticket")),a.push(' <a href="'),a.push(this.apiPath),a.push("/time_accounting/log/by_ticket/"),a.push(l(this.year)),a.push("/"),a.push(l(this.month)),a.push('?download=true" class="js-downloadByTicket" data-type="attachment">'),a.push(this.Icon("download")),a.push('</a></h3>\n    <div class="js-tableTicket"></div>\n    <br>\n    <h3>'),a.push(this.T("Customer")),a.push(' <a href="'),a.push(this.apiPath),a.push("/time_accounting/log/by_customer/"),a.push(l(this.year)),a.push("/"),a.push(l(this.month)),a.push('?download=true" class="js-downloadByCustomer" data-type="attachment">'),a.push(this.Icon("download")),a.push('</a></h3>\n    <div class="js-tableCustomer"></div>\n    <br>\n    <h3>'),a.push(this.T("Organization")),a.push(' <a href="'),a.push(this.apiPath),a.push("/time_accounting/log/by_organization/"),a.push(l(this.year)),a.push("/"),a.push(l(this.month)),a.push('?download=true" class="js-downloadByOrganization" data-type="attachment">'),a.push(this.Icon("download")),a.push('</a></h3>\n    <div class="js-tableOrganization"></div>\n  </div>\n\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,a.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/translation/index"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),e.push(this.T("Translations")),e.push(" <small>"),e.push(n(this.currentLanguage)),e.push('</small></h1>\n  </div>\n  <div class="page-header-meta">\n    <a class="btn btn--success js-syncChanges">'),e.push(this.T("Get latest translations")),e.push('</a>\n    <a class="btn btn--danger hidden js-changes js-resetChanges">'),e.push(this.T("Reset changes")),e.push('</a>\n    <a class="btn btn--primary hidden js-changes js-pushChanges">'),e.push(this.T("Push my changes")),e.push('</a>\n  </div>\n</div>\n<div class="page-content">\n\n  <div class="box box--message">\n    <h2>'),e.push(this.T("Inline translation")),e.push("</h2>\n    <p>"),e.push(this.T('To make translations easier you can enable and disable the inline translation feature by pressing "%s".',"ctrl+alt+t")),e.push("</p>\n    <p>"),e.push(this.T("Text with disabled inline translations looks like")),e.push('\u2002<button class="btn btn-primary">'),e.push(this.Ti("Some Text")),e.push("</button></p>\n    <p>"),e.push(this.T("Text with enabled inline translations looks like")),e.push('\u2002<button class="btn btn-primary"><span class="translation" contenteditable="true">'),e.push(this.Ti("Some Text")),e.push("</button></span></p>\n    <p>"),e.push(this.T("Just click into the marker and update the words just in place. Enjoy!")),e.push("</p>\n    <p>"),e.push(this.T("If you want to translate it via the translation table, just go ahead below.")),e.push('</p>\n  </div>\n\n  <div class="js-ToDo"></div>\n  <div class="js-List"></div>\n</div>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/translation/list"]=function(t){t||(t={});var c=[],p=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l;for(c.push("<h2>"),c.push(this.T("Date & Time")),c.push('</h2>\n<table class="translationOverview js-translated table table-striped table-hover">\n  <thead>\n    <tr>\n      <th class="translationOverview-source">'),c.push(this.T("Type")),c.push('</th>\n      <th class="translationOverview-target">'),c.push(this.T("Target")),c.push('</th>\n      <th class="translationOverview-initial">'),c.push(this.T("Original")),c.push('</th>\n      <th class="translationOverview-action">'),c.push(this.T("Action")),c.push("</th>\n    </tr>\n  </thead>\n  <tbody>\n  "),e=0,s=(o=this.times).length;e<s;e++)l=o[e],c.push("\n    "),t=!1,c.push("\n    "),l[2]!==l[3]&&(t=!0),c.push("\n    <tr "),t&&c.push('class="warning"'),c.push('>\n      <td title="'),c.push(p(l[1])),c.push('">'),c.push(p(l[1])),c.push('\n      <td class="translationOverview-itemContainer"><input class="js-Item translationOverview-item form-control" value="'),c.push(p(l[2])),c.push('" data-source="'),c.push(p(l[1])),c.push('" data-initial="'),c.push(p(l[3])),c.push('" data-id="'),c.push(p(l[0])),c.push('" data-format="'),c.push(p(l[4])),c.push('">\n      <td title="'),c.push(p(l[3])),c.push('">'),c.push(p(l[3])),c.push('\n      <td><a href="#" class="js-Reset btn btn--text'),t||c.push(" hidden"),c.push('">'),c.push(this.T("Reset")),c.push("</a>\n  ");if(c.push("\n  </tbody>\n</table>\n\n<h2>"),c.push(this.T("Words")),c.push("</h2>\n"),_.isEmpty(this.strings)&&!this.notSourceTranslation)c.push("\n<div>"),c.push(this.T("English is the source language, so we have nothing to translate.")),c.push("</div>\n");else{for(c.push('\n<table class="translationOverview js-translated table table-striped table-hover">\n  <thead>\n    <tr>\n      <th class="translationOverview-source">'),c.push(this.T("Source")),c.push('</th>\n      <th class="translationOverview-target">'),c.push(this.T("Target")),c.push('</th>\n      <th class="translationOverview-initial">'),c.push(this.T("Original")),c.push('</th>\n      <th class="translationOverview-action">'),c.push(this.T("Action")),c.push("</th>\n    </tr>\n  </thead>\n  <tbody>\n    "),i=0,r=(a=this.strings).length;i<r;i++)n=a[i],c.push("\n    "),t=!1,c.push("\n    "),n[2]!==n[3]&&(t=!0),c.push("\n    <tr "),t&&c.push('class="warning"'),c.push('>\n      <td class="noTruncate" title="'),c.push(p(n[1])),c.push('">'),c.push(p(n[1])),c.push('\n      <td class="translationOverview-itemContainer"><input class="js-Item translationOverview-item form-control" value="'),c.push(p(n[2])),c.push('" data-source="'),c.push(p(n[1])),c.push('" data-initial="'),c.push(p(n[3])),c.push('" data-id="'),c.push(p(n[0])),c.push('" data-format="'),c.push(p(n[4])),c.push('">\n      <td class="noTruncate" title="'),c.push(p(n[3])),c.push('">'),c.push(p(n[3])),c.push('\n      <td><a href="#" class="js-Reset btn btn--text'),t||c.push(" hidden"),c.push('">'),c.push(this.T("Reset")),c.push("</a>\n    ");c.push("\n  </tbody>\n</table>\n")}c.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,c.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/translation/support"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push("<p "),!1===this.better&&e.push('class="hidden"'),e.push(">\n"),e.push(this.T("Only %s% of this language is translated, help to improve Zammad and complete the translation.",this.percent)),e.push("\n</p>\n<p "),!0===this.better&&e.push('class="hidden"'),e.push(">\n"),e.push(this.T("Up to %s% of this language is translated, help to make Zammad even better and complete the translation.",this.percent)),e.push("\n</p>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/translation/todo"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push("<h2>"),s.push(this.T("Words")),s.push(": "),s.push(this.T("not translated")),s.push('</h2>\n<table class="translationOverview table table-striped table-hover">\n  <thead>\n    <tr>\n      <th class="translationOverview-source">'),s.push(this.T("Source")),s.push('</th>\n      <th class="translationOverview-target">'),s.push(this.T("Target")),s.push('</th>\n      <th class="translationOverview-action">'),s.push(this.T("Action")),s.push("</th>\n    </tr>\n  </thead>\n  <tbody>\n    "),t=0,n=(i=this.list).length;t<n;t++)e=i[t],s.push('\n    <tr>\n      <td title="'),s.push(r(e[1])),s.push('">'),s.push(r(e[1])),s.push('\n      <td class="translationOverview-itemContainer"><input class="js-Item translationOverview-item form-control" value="'),s.push(r(e[2])),s.push('" data-source="'),s.push(r(e[1])),s.push('" data-id="'),s.push(r(e[0])),s.push('">\n      <td><a href="#" class="js-create btn btn--text">'),s.push(this.T("Create")),s.push('</a> / <a href="#" class="js-theSame btn btn--text">'),s.push(this.T("is the same")),s.push("</a>\n    ");s.push("\n  </tbody>\n</table>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/twitter/account_edit"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="alert alert--danger hidden" role="alert"></div>\n<fieldset>\n\n  <h3>'),e.push(this.T("Search Terms")),e.push('</h3>\n  <p class="description">'),e.push(this.T("Tweets containing search terms are automatically turned into tickets.")),e.push('</p>\n\n  <table class="settings-list">\n    <thead>\n      <tr>\n        <th>'),e.push(this.T("Search Term")),e.push("\n        <th>"),e.push(this.T("Group")),e.push("\n        <th>"),e.push(this.T("Action")),e.push('\n    </thead>\n    <tbody class="js-searchTermList">\n      <tr>\n        <td colspan="3">\n          '),e.push(this.T("Empty")),e.push('\n    </tbody>\n    <tfoot>\n      <tr>\n        <td colspan="3" class="settings-list-action-cell js-searchTermAdd">\n          '),e.push(this.Icon("plus-small")),e.push("\n    </tfoot>\n  </table>\n\n  <h3>"),e.push(this.T("Mentions Group")),e.push('</h3>\n  <p class="description">'),e.push(this.T("Choose the group in which mentions will get added to.")),e.push('</p>\n  <div class="js-mentionsGroup"></div>\n\n  <h3>'),e.push(this.T("Direct Messages Group")),e.push('</h3>\n  <p class="description">'),e.push(this.T("Choose the group in which direct messages will get added to.")),e.push('</p>\n  <div class="js-directMessagesGroup"></div>\n\n  <h3>'),e.push(this.T("Retweets")),e.push('</h3>\n  <p class="description">'),e.push(this.T("Choose if retweets should also be converted to tickets.")),e.push('</p>\n  <input name="track_retweets" type="checkbox" id="setting-chat" value="true" '),this.channel.options.sync.track_retweets&&e.push("checked"),e.push("> "),e.push(this.T("Track retweets")),e.push('\n  <input name="webhook_id" type="hidden" value="'),e.push(this.channel.options.sync.webhook_id),e.push('">\n</fieldset>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/twitter/app_config"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="alert alert--danger hidden" role="alert"></div>\n<p>\n  '),e.push(this.T("The tutorial on how to manage a %s is hosted on our online documentation %l.","Twitter App","https://admin-docs.zammad.org/en/latest/channels/twitter.html")),e.push("\n</p>\n<fieldset>\n  <h2>"),e.push(this.T("Enter your %s App Keys","Twitter")),e.push('</h2>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="consumer_key">Twitter Consumer Key <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="consumer_key" type="text" name="consumer_key" value="'),this.external_credential&&this.external_credential.credentials&&e.push(n(this.external_credential.credentials.consumer_key)),e.push('" class="form-control" required autocomplete="off" >\n    </div>\n  </div>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="consumer_secret">Twitter Consumer Secret <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="consumer_secret" type="text" name="consumer_secret" value="'),
this.external_credential&&this.external_credential.credentials&&e.push(n(this.external_credential.credentials.consumer_secret)),e.push('" class="form-control" required autocomplete="off" >\n    </div>\n  </div>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="oauth_token">Twitter Access Token <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="oauth_token" type="text" name="oauth_token" value="'),this.external_credential&&this.external_credential.credentials&&e.push(n(this.external_credential.credentials.oauth_token)),e.push('" class="form-control" required autocomplete="off" >\n    </div>\n  </div>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="oauth_token_secret">Twitter Access Token Secret <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="oauth_token_secret" type="text" name="oauth_token_secret" value="'),this.external_credential&&this.external_credential.credentials&&e.push(n(this.external_credential.credentials.oauth_token_secret)),e.push('" class="form-control" required autocomplete="off" >\n    </div>\n  </div>\n  <div class="input form-group">\n    <div class="formGroup-label">\n      <label for="env">Twitter Dev environment label <span>*</span></label>\n    </div>\n    <div class="controls">\n      <input id="env" type="text" name="env" value="'),this.external_credential&&this.external_credential.credentials&&e.push(n(this.external_credential.credentials.env)),e.push('" class="form-control" required autocomplete="off" >\n    </div>\n  </div>\n  <h2>'),e.push(this.T("Your callback URL")),e.push('</h2>\n  <div class="input form-group">\n    <div class="controls">\n      <input class="form-control js-select" readonly value="'),e.push(n(this.callbackUrl)),e.push('">\n    </div>\n  </div>\n</fieldset>\n')}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/twitter/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),e.push(this.T("Twitter")),e.push(" <small>"),e.push(this.T("Accounts")),e.push('</small></h1>\n  </div>\n</div>\n\n<div class="page-content">\n  <div class="page-description">\n    <p>'),e.push(this.T("You can connect %s with Zammad. You need to connect your Zammad with %s first.","Twitter Accounts","Twitter")),e.push('</p>\n    <div class="btn btn--success js-configApp">'),e.push(this.T("Connect Twitter App")),e.push("</div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/twitter/list"]=function(t){t||(t={});var u=[],h=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p;for(u.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),u.push(this.T("Twitter")),u.push(" <small>"),u.push(this.T("Accounts")),u.push('</small></h1>\n  </div>\n\n  <div class="page-header-meta">\n    <a class="btn js-configApp">'),u.push(this.T("Configure App")),u.push('</a>\n    <a class="btn btn--success js-new">'),u.push(this.T("Add Account")),u.push("</a>\n  </div>\n</div>\n\n"),this.external_credential&&this.external_credential.credentials&&!this.external_credential.credentials.webhook_id&&(u.push('\n  <div class="alert alert--warning" role="alert">'),u.push(this.T("Your Twitter-App is not using the Twitter Account Activity API yet and is therefore limited to search terms only. Please refer to the documentation %l on how to update your account.","https://zammad-admin-documentation.readthedocs.io/en/latest/channels-twitter.html")),u.push("</div>\n")),u.push('\n\n<div class="page-content">\n'),e=0,s=(a=this.channels).length;e<s;e++){if(t=a[e],u.push('\n  <div class="action '),!0!==t.active&&u.push("is-inactive"),u.push('" data-id="'),u.push(h(t.id)),u.push('">\n    <div class="action-block action-row">\n      <h2>'),u.push(this.Icon("status","supergood-color inline")),u.push(" "),u.push(h(t.options.user.name)),u.push(' <span class="text-muted">@'),u.push(h(t.options.user.screen_name)),u.push("</span></h2>\n    </div>\n\n    "),this.external_credential&&this.external_credential.credentials&&this.external_credential.credentials.webhook_id&&t.options&&t.options.subscribed_to_webhook_id!==this.external_credential.credentials.webhook_id&&(u.push('\n      <div class="alert alert--warning" role="alert">'),u.push(this.T('Your Twitter-Account is not using the Twitter Account Activity API yet and is therefore limited to search terms only. Please add/update the account again via "add account".')),u.push("</div>\n    ")),u.push('\n\n    <div class="action-flow action-flow--row">\n      <div class="action-block">\n        <h3>'),u.push(this.T("Search Terms")),u.push("</h3>\n        "),t.options.sync.search){for(u.push("\n          "),n=0,r=(l=t.options.sync.search).length;n<r;n++)p=l[n],u.push("\n            "),u.push(h(p.term)),u.push("<br>\n          ");u.push("\n        ")}if(u.push("\n      </div>\n      "),u.push(this.Icon("arrow-right","action-flow-icon")),u.push('\n      <div class="action-block">\n        <h3>'),u.push(this.T("Group")),u.push("</h3>\n        "),t.options.sync.search){for(u.push("\n          "),i=0,o=(c=t.options.sync.search).length;i<o;i++)p=c[i],u.push("\n            "),u.push(h(p.groupName)),u.push("<br>\n          ");u.push("\n        ")}u.push('\n      </div>\n    </div>\n    <div class="action-flow action-flow--row">\n      <div class="action-block">\n        <h3>'),u.push(this.T("Mentions")),u.push("</h3>\n        @"),u.push(h(t.options.user.screen_name)),u.push("\n      </div>\n      "),u.push(this.Icon("arrow-right","action-flow-icon")),u.push('\n      <div class="action-block">\n        <h3>'),u.push(this.T("Group")),u.push("</h3>\n        "),t.options.sync.mentions&&(u.push("\n          "),u.push(h(t.options.sync.mentions.groupName)),u.push("\n        ")),u.push('\n      </div>\n    </div>\n    <div class="action-flow action-flow--row">\n      <div class="action-block">\n        <h3>'),u.push(this.T("Direct Messages")),u.push("</h3>\n        @"),u.push(h(t.options.user.screen_name)),u.push("\n      </div>\n      "),u.push(this.Icon("arrow-right","action-flow-icon")),u.push('\n      <div class="action-block">\n        <h3>'),u.push(this.T("Group")),u.push("</h3>\n        "),t.options.sync.direct_messages&&(u.push("\n          "),u.push(h(t.options.sync.direct_messages.groupName)),u.push("\n        ")),u.push('\n      </div>\n    </div>\n    <div class="action-flow action-flow--row">\n      <div class="action-block">\n        <h3>'),u.push(this.T("Retweets")),u.push("</h3>\n        "),t.options.sync.track_retweets?(u.push("\n          "),u.push(this.T("Retweets are converted to Tickets"))):(u.push("\n          "),u.push(this.T("Conversion of retweets to tickets is turned off"))),u.push(".\n        "),u.push('\n      </div>\n    </div>\n    <div class="action-controls">\n      <div class="btn btn--danger btn--secondary js-delete">'),u.push(this.T("Delete")),u.push("</div>\n      "),!0===t.active?(u.push('\n        <div class="btn btn--secondary js-disable">'),u.push(this.T("Disable"))):(u.push('\n        <div class="btn btn--secondary js-enable">'),u.push(this.T("Enable"))),u.push("</div>\n      "),u.push('\n      <div class="btn js-edit">'),u.push(this.T("Edit")),u.push("</div>\n    </div>\n  </div>\n")}u.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,u.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/twitter/search_term"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<tr>\n  <td class="settings-list-control-cell"><input name="search::term" value="'),e.push(n(this.term)),e.push('" class="form-control form-control--small">\n  <td class="settings-list-control-cell"><div class="js-termGroup" data-index="'),e.push(n(this.index)),e.push('"></div>\n  <td class="settings-list-row-control">\n    <div class="btn btn--text js-searchTermRemove" data-index="'),e.push(n(this.index)),e.push('">\n      '),e.push(this.Icon("trash")),e.push(" "),e.push(this.T("Remove")),e.push("\n    </div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/user"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;if(l.push('<div class="page-header">\n  <div class="page-header-title">\n    <h1>'),l.push(this.T(this.head)),l.push(" <small>"),l.push(this.T("Management")),l.push('</small></h1>\n  </div>\n  <div class="page-header-meta">\n    '),this.buttons){for(l.push("\n    "),e=0,i=(r=this.buttons).length;e<i;e++)t=r[e],l.push('\n      <a data-type="'),l.push(c(t["data-type"])),l.push('" class="btn '),l.push(c(t["class"])),l.push('">'),l.push(this.T(t.name)),l.push("</a>\n    ");l.push("\n    ")}for(l.push('\n  </div>\n</div>\n<div class="page-content">\n  <div class="searchfield">\n    <input class="js-search form-control" name="search" placeholder="'),l.push(this.Ti("Search for users")),l.push('" type="search">\n    '),l.push(this.Icon("magnifier")),l.push('\n  </div>\n\n  <div class="userSearch horizontal">\n    <div class="userSearch-label">'),l.push(this.T("Roles")),l.push(':</div>\n    <div class="tabs tabs-wide">\n      '),n=0,s=(o=this.roles).length;n<s;n++)a=o[n],l.push('\n        <div class="tab" data-id="'),l.push(c(a.id)),l.push('">'),l.push(this.T(a.displayName())),l.push("</div>\n      ");l.push('\n    </div>\n  </div>\n\n  <div class="table-overview"></div>\n</div>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/user_profile/index"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="profile">\n  <div class="profile-window">\n    <div class="profile-section vertical centered">\n      <div class="align-right profile-action js-action"></div>\n      <div class="profile-name js-profileName text-center"></div>\n      '),this.user.organization&&e.push('\n        <div class="profile-organization js-organization"></div>\n      '),e.push('\n    </div>\n    <div class="profile-section js-object-container"></div>\n    <div class="profile-section js-ticket-stats"></div>\n  </div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/user_profile/name"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push(this.user.avatar("80")),e.push("\n<h1>"),e.push(n(this.user.displayName())),e.push("</h1>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/user_profile/object"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="profile-details horizontal wrap">\n  '),t=0,e=(n=this.userData).length;t<e;t++)i=n[t],s.push("\n    "),"richtext"===i.tag?(s.push('\n      <div class="profile-detailsEntry" style="width: 100%;">\n        <label>'),s.push(this.T(i.display)),s.push('</label>\n        <div contenteditable="true" data-name="'),s.push(r(i.name)),s.push('" data-type="update" data-placeholder="'),s.push(this.Ti("Add a Note")),s.push('">'),s.push(this.user[i.name]),s.push("</div>\n      </div>\n    ")):(s.push("\n      "),this.user[i.name]&&(s.push('\n        <div class="profile-detailsEntry">\n          <label>'),s.push(this.T(i.display)),s.push("</label>\n          "),s.push(this.P(this.user,i.name)),s.push("\n        </div>\n      ")),s.push("\n    ")),s.push("\n  ");s.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/user_profile/organization"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<a href="'),e.push(this.organization.uiUrl()),e.push('">'),e.push(n(this.organization.displayName())),e.push("</a>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/version"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="page-header-title">\n  <h1>'),e.push(this.T("Version")),e.push('<small></small></h1>\n</div>\n<div class="page-content">\n  <p>\n    '),e.push(this.T("This is Zammad version %s",this.version)),e.push("\n  </p>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KnowledgeBaseVerticalForm=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.form.form.addClass("controls"),this.render()}return n(e,t),e.prototype.elements={".form-item":"container"},e.prototype.render=function(){var t,e;return e=this.form.attributes[0].name,t=_.find(App.Model.attributesGet(!1,this.form.model.configure_attributes),function(t){return t.name===e}),this.html(App.view("knowledge_base/vertical_form")({attribute:t})),this.container.html(this.form.form)},e}(App.Controller)}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/button_with_dropdown"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<button class="btn btn--primary btn--split--first '),s.push(r(this.mainActionIdentifier)),s.push('">'),s.push(this.T(this.mainActionLabel)),s.push('</button>\n<span class="dropdown-menu-accessories" tabindex="1">\n  <button class="btn btn--primary btn--slim btn--split--last">'),s.push(this.Icon("arrow-up")),s.push('</button>\n  <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="userAction">\n    '),e=0,n=(i=this.actions).length;e<n;e++)t=i[e],s.push('\n      <li\n        class="'),s.push(r(this.accessoryActionsIdentifier)),s.push('"\n        role="menuitem"\n        data-id="'),s.push(r(t.id)),s.push('"\n        '),t.disabled&&s.push("disabled"),s.push(">\n\n        "),s.push(this.T(t.name)),s.push("\n    ");s.push("\n  </ul>\n</span>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/http_log"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;if(l.push("<hr>\n<h2>"),l.push(this.T("Recent logs")),l.push("</h2>\n"),this.description){for(l.push("\n  "),t=0,i=(o=this.description).length;t<i;t++)e=o[t],l.push("\n    <p>"),l.push(this.T.apply(this,e)),l.push("</p>\n  ");l.push("\n")}if(l.push('\n<div class="settings-entry">\n'),this.records.length){for(l.push('\n  <table class="settings-list settings-list--stretch">\n    <thead>\n      <tr>\n        <th width="10%">'),l.push(this.T("Direction")),l.push("\n        <th>"),l.push(this.T("Request")),l.push('\n        <th width="25%">'),l.push(this.T("Created at")),l.push("\n    </thead>\n    <tbody>\n"),n=0,s=(a=this.records).length;n<s;n++)r=a[n],l.push('\n      <tr data-id="'),l.push(c(r.id)),l.push('" class="js-record">\n        <td>'),l.push(this.T(r.direction)),l.push('\n        <td><a href="#">'),l.push(c(r.status)),l.push(" "),l.push(c(r.method)),l.push(" "),l.push(c(r.url)),l.push("</a>\n        <td>"),l.push(this.humanTime(r.created_at)),l.push("\n");l.push("\n    </tbody>\n  </table>\n")}else l.push('\n<table class="settings-list settings-list--stretch settings-list--placeholder">\n  <thead><tr><th>'),l.push(this.T("No Entries")),l.push("\n</table>\n");l.push("\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/http_log_show"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="settings-entry">\n  <table class="settings-list" style="width: 100%;">\n    <tbody>\n      <tr>\n        <td width="20%">'),e.push(this.T("Direction")),e.push("\n        <td>"),e.push(this.T(this.record.direction)),e.push("\n      <tr>\n        <td>"),e.push(this.T("URL")),e.push("\n        <td>"),e.push(n(this.record.url)),e.push("\n      <tr>\n        <td>"),e.push(this.T("Method")),e.push("\n        <td>"),e.push(n(this.record.method)),e.push("\n      <tr>\n        <td>"),e.push(this.T("Status")),e.push("\n        <td>"),e.push(n(this.record.status)),e.push("\n      <tr>\n        <td>"),e.push(this.T("Request")),e.push("\n        <td>"),e.push(App.Utils.text2html(this.record.request.content)),e.push("\n      <tr>\n        <td>"),e.push(this.T("Response")),e.push("\n        <td>"),e.push(App.Utils.text2html(this.record.response.content)),e.push("\n      <tr>\n        <td>"),e.push(this.T("Created at")),e.push("\n        <td>"),e.push(this.datetime(this.record.created_at)),e.push("\n    </tbody>\n  </table>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/invite_user"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="modal-dialog wizard">\n\n  <form class="modal-content setup wizard js-user">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T(this.head)),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <div class="js-form"></div>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <div class="modal-rightFooter">\n      <a class="btn btn--text btn--secondary js-close" data-slide="js-inbound">'),e.push(this.T("Cancel")),e.push('</a>\n      </div>\n      <div class="modal-rightFooter">\n        <button class="btn btn--primary align-right">'),e.push(this.T("Invite")),e.push('</button>\n      </div>\n    </div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-waiting">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T(this.head)),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("Sending...")),e.push('\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n  <form class="modal-content setup wizard hide js-success">\n    <div class="modal-header">\n      <div class="modal-close js-close">\n        '),e.push(this.Icon("diagonal-cross")),e.push('\n      </div>\n      <h1 class="modal-title">'),e.push(this.T(this.head)),e.push('</h1>\n    </div>\n    <div class="modal-body">\n      <div class="wizard-body vertical justified">\n        <p class="wizard-loadingText">\n          <span class="loading icon"></span> '),e.push(this.T("done")),e.push('\n        </p>\n      </div>\n    </div>\n    <div class="modal-footer"></div>\n  </form>\n\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/online_notification"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="arrow js-arrow"></div>\n<div class="popover-notificationsHeader js-header">\n  <div class="popover-title">'),e.push(this.T("Notifications")),e.push(" <span class='popover-notificationsCounter js-notificationsCounter'>"),e.push(this.count),e.push('</span></div>\n  <a class="btn btn--text btn--subtle js-mark'),this.count||e.push(" hide"),e.push('">'),e.push(this.T("Mark all as read")),e.push('</a>\n</div>\n<div class="popover-content js-content">\n  <div class="activity-placeholder js-noNotifications">\n    '),e.push(this.T("No unread notifications for you. :)")),e.push('\n  </div>\n  <div class="js-items"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/online_notification_item"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="js-item activity-entry activity-entry--removeable'),this.item.seen&&e.push(" is-inactive"),e.push('" data-id="'),e.push(this.item.id),e.push('">\n  <a class="activity-avatar user-popover" data-id="'),e.push(n(this.item.created_by_id)),e.push('" '),1!==this.item.created_by_id&&(e.push('href="'),e.push(this.item.created_by.uiUrl()),e.push('"')),e.push(">\n    "),e.push(this.item.created_by.avatar()),e.push('\n  </a>\n  <div class="activity-body">\n    <a class="activity-message js-locationVerify" href="'),e.push(this.item.link),e.push('">\n      <span class="activity-text">\n        '),this.item.objectNative&&this.item.objectNative.activityMessage?(e.push("\n          "),e.push(this.item.objectNative.activityMessage(this.item)),e.push("\n        ")):(e.push("\n          Need objectNative in item "),e.push(n(this.item.object)),e.push(".find("),e.push(n(this.item.o_id)),e.push(")\n        ")),e.push("\n      </span>\n      "),e.push(this.humanTime(this.item.created_at,!1,"activity-time")),e.push('\n    </a>\n    <div class="activity-remove js-remove">\n      <div class="activity-remove-icon-holder">\n        '),e.push(this.Icon("diagonal-cross")),e.push("\n      </div>\n    </div>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/organization"]=function(t){t||(t={});var l=[],c=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a;for(l.push('<div class="sidebar-block">\n    <div class="avatar organizationInfo-avatar size-50">\n      <a href="'),l.push(this.organization.uiUrl()),l.push('">\n        '),l.push(this.Icon("organization")),l.push('\n      </a>\n    </div>\n    <h3 title="'),l.push(this.Ti("Name")),l.push('">'),l.push(c(this.organization.displayName())),l.push("</h3>\n</div>\n\n"),t=0,n=(s=this.organizationData).length;t<n;t++)o=s[t],l.push("\n  "),null==this.organization[o.name]&&"note"!==o.name||(l.push('\n    <div class="sidebar-block">\n    '),"richtext"!==o.tag?(l.push("\n      <label>"),l.push(this.T(o.display)),l.push("</label>\n      "),l.push(this.P(this.organization,o.name)),l.push("\n    ")):(l.push("\n      <label>"),l.push(this.T(o.display)),l.push('</label>\n      <div contenteditable="true" data-name="'),l.push(c(o.name)),l.push('" data-type="update-org" data-placeholder="'),l.push(this.Ti("Add a Note")),l.push('">'),l.push(this.organization[o.name]),l.push("</div>\n    ")),l.push("\n    </div>\n  ")),l.push("\n");if(l.push("\n\n"),this.organization.members){for(l.push('\n<hr>\n<div class="sidebar-block">\n  <label>'),l.push(this.T("Members")),l.push('</label>\n  <div class="userList">\n'),e=0,i=(r=this.organization.members).length;e<i;e++)a=r[e],l.push('\n    <div class="userList-row" data-id="'),l.push(a.id),l.push('"></div>\n');l.push("\n  </div>\n</div>\n")}l.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,l.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/script_snipped"]=function(t){t||(t={});var s=[],e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;if(s.push("<hr>\n<h2>"),s.push(this.T(this.header)),s.push("</h2>\n"),this.description){for(s.push("\n  "),t=0,n=(i=this.description).length;t<n;t++)e=i[t],s.push("\n    <p>"),s.push(this.T.apply(this,e)),s.push("</p>\n  ");s.push("\n")}s.push("\n"),this.content&&(s.push('\n  <pre><code class="language-'),s.push(this.style),s.push(' js-code">'),s.push(this.content),s.push("</code></pre>\n")),s.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/switch_back_to_user"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push(this.Icon("switchView","switchBackToUser-icon")),e.push('\n<div class="switchBackToUser-text">'),e.push(this.T('Zammad looks like this for "%s"',this.S("firstname")+" "+this.S("lastname"))),e.push('</div>\n<div class="align-right horizontal center js-close u-clickable">\n  '),e.push(this.T("Back to my view")),e.push('\n  <div class="switchBackToUser-close">\n    '),e.push(this.Icon("diagonal-cross")),e.push("\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/tag"]=function(t){t||(t={});var s=[],r=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push("<label>"),s.push(this.T("Tags")),s.push('</label>\n<ul class="list list--sidebar">\n  '),t=0,e=(n=this.tags).length;t<e;t++)i=n[t],s.push('\n  <li class="list-item">\n    <a href="#" class="list-item-name js-tag">'),s.push(r(i)),s.push('</a>\n    <div class="list-item-delete js-delete">\n      '),s.push(this.Icon("diagonal-cross")),s.push("\n    </div>\n  ");s.push('\n</ul>\n<div class="text-muted js-newTagLabel u-clickable">+ '),s.push(this.T("Add Tag")),s.push('</div>\n<form class="ui-front">\n  <input type="text" name="new_tag" class="hide js-newTagInput" autocomplete="off">\n</form>\n')}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/task_item"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<a href="'),e.push(this.item.meta.url),e.push('" title="'),e.push(n(this.item.meta.title)),e.push('" class="nav-tab task js-item js-locationVerify '),e.push(n(this.item.meta["class"])),this.item.active&&e.push(" is-active"),this.item.notify&&e.push(" is-modified"),e.push('" data-key="'),e.push(this.item.key),e.push('">\n  <div class="nav-tab-icon" title="'),e.push(this.Ti(this.item.meta.iconTitle)),e.push('">\n    '),"task"===this.item.meta.type?(e.push("\n      "),this.item.notify?(e.push("\n        "),e.push(this.Icon("small-dot","icon-status-modified-inner-circle icon-task-state "+this.item.meta.iconClass)),e.push("\n        "),e.push(this.Icon("status-modified-outer-circle","icon-task-state "+this.item.meta.iconClass))):(e.push("\n        "),e.push(this.Icon("task-state",this.item.meta.iconClass))),e.push("\n      ")):(e.push("\n      "),e.push(this.Icon(this.item.meta.iconClass))),e.push("\n    "),e.push('\n  </div>\n  <div class="nav-tab-name u-textTruncate flex">'),e.push(n(this.item.meta.head)),e.push('</div>\n  <div class="nav-tab-close js-close" title="'),e.push(this.Ti("close")),e.push('">\n    <div class="nav-tab-close-inner">\n      '),e.push(this.Icon("diagonal-cross")),e.push("\n    </div>\n  </div>\n</a>\n")}).call(this)}.call(t),t.safe=i,
t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/template"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="templates-manage">\n  <form>\n    <div class="form-group">\n      <label class="" for="template_name">'),e.push(this.T("Select Template")),e.push('</label>\n      <div id="form-template"></div>\n    </div>\n    <div class="horizontal">\n      <button type="submit" class="btn btn--action js-delete">'),e.push(this.T("Delete")),e.push('</button>\n      <button type="submit" class="btn btn--action align-right js-apply">'),e.push(this.T("Apply")),e.push('</button>\n    </div>\n  </form>\n  <hr>\n  <form>\n    <div class="form-group">\n      <label class="" for="template_name">'),e.push(this.T("Save as template")),e.push('</label>\n      <input type="text" name="name" id="template_name" class="form-control js-name" value="'),e.push(n(this.template.name)),e.push('"/>\n    </div>\n    <div class="horizontal">\n      <button type="submit" class="btn btn--action align-right js-save">'),e.push(this.T("Save")),e.push('</button>\n    </div>\n  </form>\n</div>\n\n<div class="templates-welcome">\n  <p>'),e.push(this.T("No template created yet.")),e.push("</p>\n  <p>"),e.push(this.T("With templates you can pre-fill ticket attributes.")),e.push("</p>\n  <p>"),e.push(this.T("Choose attributes and then save them as a new template.")),e.push('</p>\n  <p><a class="js-create u-clickable">'),e.push(this.T("Save new template")),e.push("</a></p>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/text_module"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push('<div class="well hide">\n<!--\n  <h3>'),e.push(this.T("Text Modules")),e.push("</h3>\n  "),e.push(this.T("Search")),e.push('\n  <br>\n-->\n  <input type="text" name="" id="text-module-search" class="span2" value="'),e.push(n(this.search)),e.push('" autocomplete="off"/>\n  <a href="#" class="close">&times;</a>\n  <br>\n  <div id="form-text-module" class="max-size-scroll"></div>\n  <!--<button type="submit" class="btn" data-type="text_module_edit">'),e.push(this.T("Edit")),e.push('</button>-->\n<!--\n  <button type="submit" class="btn" data-type="text_module_delete">'),e.push(this.T("Delete")),e.push("</button>\n-->\n<!--\n  "),e.push(this.T("Preview ")),e.push('\n  <br>\n  <textarea id="text-module-preview-content" class="span2"></textarea>\n-->\n  <hr>\n  <form>\n    <label class="" for="text_module_name">'),e.push(this.T("Save as")),e.push('</label>\n    <input type="text" name="name" id="text_module_name" class="span2" value=""/>\n    <button type="submit" class="btn" data-type="save">'),e.push(this.T("Save")),e.push("</button>\n  </form>\n</div>\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/ticket_stats"]=function(t){t||(t={});var e=[],n=t.safe,i=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},i||(i=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){this.user&&this.user.organization&&(e.push('\n  <div class="tabs tabs--big">\n    <div class="tab js-userTab active">'),e.push(this.T("Tickets of User")),e.push(" "),e.push("("+this.user_total+")"),e.push('</div>\n    <div class="tab js-orgTab">'),e.push(this.T("Tickets of Organization")),e.push(" "),e.push("("+this.organization_total+")"),e.push("</div>\n  </div>\n")),e.push('\n\n<div class="js-user '),!this.user&&this.organization&&e.push("hide"),e.push('">\n  <div class="profile-ticketLists">\n    <div class="profile-ticketList js-user-open-tickets"></div>\n    <div class="profile-ticketList js-user-closed-tickets"></div>\n  </div>\n\n  <div class="frequency stat-widget vertical js-user-frequency"></div>\n</div>\n\n<div class="js-org '),this.user&&e.push("hide"),e.push('">\n  <div class="profile-ticketLists">\n    <div class="profile-ticketList js-org-open-tickets"></div>\n    <div class="profile-ticketList js-org-closed-tickets"></div>\n  </div>\n\n  <div class="frequency stat-widget vertical js-org-frequency"></div>\n</div>\n')}).call(this)}.call(t),t.safe=n,t.escape=i,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/ticket_stats_frequency"]=function(t){t||(t={});var s=[],e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i;for(s.push('<div class="stat-title">'),s.push(this.T("Frequency")),s.push('</div>\n<div class="stat-graphic">\n  '),t=0,n=(i=this.ticket_volume_by_year).length;t<n;t++)e=i[t],s.push('\n    <div class="stats-row">\n      <div class="stat-bars">\n        <div class="stat-bar primary" style="height: '),s.push(e.closed_in_percent),s.push('%"></div>\n        <div class="stat-bar secondary" style="height: '),s.push(e.created_in_percent),s.push('%"></div>\n      </div>\n      <div class="stat-label">'),s.push(this.T(e.text.substr(0,3))),s.push("</div>\n    </div>\n  ");s.push('\n</div>\n<div class="stat-legend">\n  <div class="stat-legendEntry primary">\n    <span class="primary stat-circle"></span>\n    <span class="stat-legend-label">'),s.push(this.T("Closed")),s.push('</span>\n  </div>\n  <div class="stat-legendEntry secondary">\n    <span class="secondary stat-circle"></span>\n    <span class="stat-legend-label">'),s.push(this.T("Created")),s.push("</span>\n  </div>\n</div>\n")}).call(this)}.call(t),t.safe=e,t.escape=n,s.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/ticket_stats_list"]=function(t){t||(t={});var e=[],n=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?s(t):""},i=t.safe,s=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){e.push("<label>"),e.push(this.T(this.head)),e.push(" ("),e.push(n(this.ticket_ids.length)),e.push(")</label>\n"),this.ticket_ids.length?(e.push("\n  "),e.push(this.ticketList),e.push("\n")):(e.push('\n<div class="profile-ticketsPlaceholder vertical centered">\n  <div class="'),e.push(this.iconClass),e.push('"></div>\n  '),e.push(this.T("none")),e.push("\n</div>\n")),e.push("\n"),this.ticket_ids.length>this.ticket_ids_show.length&&(e.push('\n  <a href="#" class="js-showAll">'),e.push(this.T("Show all...")),e.push("</a>\n")),e.push("\n")}).call(this)}.call(t),t.safe=i,t.escape=s,e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["app/views/widget/user"]=function(t){t||(t={});var d=[],f=function(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?n(t):""},e=t.safe,n=t.escape;return t.safe=function(t){if(t&&t.ecoSafe)return t;void 0!==t&&null!=t||(t="");var e=new String(t);return e.ecoSafe=!0,e},n||(n=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,n,i,s,r,o,a,l,c,p,u,h;for(d.push('<div class="sidebar-block">\n  '),d.push(this.user.avatar("50","","userInfo-avatar")),d.push('\n  <h3 title="'),d.push(this.Ti("Name")),d.push('">'),d.push(f(this.user.displayName())),d.push("</h3>\n</div>\n"),e=0,r=(c=this.userData).length;e<r;e++)h=c[e],d.push("\n  "),null==this.user[h.name]&&"note"!==h.name||(d.push('\n    <div class="sidebar-block">\n    <label>'),d.push(this.T(h.display)),d.push("</label>\n    "),"richtext"!==h.tag?(d.push("\n      "),h.link?(d.push('<a href="'),d.push(h.link),d.push(f(this.user[h.name])),d.push('" target="_blank">'),d.push(this.P(this.user,h.name)),d.push("</a>\n    ")):(d.push("\n      "),d.push(this.P(this.user,h.name)),d.push("\n    ")),d.push("\n    ")):(d.push('\n      <div contenteditable="true" data-name="'),d.push(f(h.name)),d.push('" data-type="update" data-placeholder="'),d.push(this.Ti("Add a Note")),d.push('">'),d.push(this.user[h.name]),d.push("</div>\n    ")),d.push("\n    </div>\n  ")),d.push("\n");if(d.push("\n"),!_.isEmpty(this.user.accounts)){for(t in d.push('\n  <div class="sidebar-block">\n    <label>'),d.push(this.T("Linked Accounts")),d.push("</label>\n  "),this.user.accounts)d.push('\n    <a href="'),d.push(f(this.user.accounts[t].link)),d.push('" target="_blank">'),d.push(f(t)),d.push("</a>\n  ");d.push("\n  </div>\n")}if(d.push("\n"),!_.isEmpty(this.user.links)){for(d.push("\n  "),i=0,o=(p=this.user.links).length;i<o;i++){for(l=p[i],d.push('\n  <div class="sidebar-block">\n    <label>'),d.push(this.T(l.title)),d.push("</label>\n"),s=0,a=(u=l.items).length;s<a;s++)n=u[s],d.push("\n  "),n.url?(d.push('\n    <a href="'),d.push(f(n.url)),d.push('" title="'),d.push(this.Ti(n.title)),d.push('" style="'),d.push(f(n.style)),d.push('" data-type="'),d.push(f(n.data)),d.push('" class="'),d.push(f(n["class"])),d.push('" '),l.new_window&&d.push('target="_blank"'),d.push(">\n  ")):(d.push('\n    <span title="'),d.push(this.Ti(n.title)),d.push('" style="'),d.push(f(n.style)),d.push('" data-type="'),d.push(f(n.data)),d.push('" class="'),d.push(f(n["class"])),d.push('">\n  ')),d.push("\n    "),d.push(this.T(n.name)),d.push(" "),void 0!==n.count&&(d.push('<span class="count">('),d.push(f(n.count)),d.push(")</span>")),d.push("\n  "),n.url?d.push("\n    </a>\n  "):d.push("\n    </span>\n  "),d.push("\n  </div>\n");d.push("\n  ")}d.push("\n")}d.push("\n")}).call(this)}.call(t),t.safe=e,t.escape=n,d.join("")}}.call(this),function(){var i=function(t,e){return function(){return t.apply(e,arguments)}};App._CollectionSingletonBase=function(){function t(){var t,e,n;this.clear=i(this.clear,this),this.callback=i(this.callback,this),this.trigger=i(this.trigger,this),this.fetch=i(this.fetch,this),this.unbindById=i(this.unbindById,this),this.unbind=i(this.unbind,this),this.bind=i(this.bind,this),this.set=i(this.set,this),this.get=i(this.get,this),this.callbacks={},this.counter=0,this.key="collection-"+this.event,(t=App.SessionStorage.get(this.key))&&this.set(t),App.Event.bind(this.event,(e=this,function(t){return e.set(t),e.callback(t)})),App.Event.bind("auth:logout",(n=this,function(t){return n.clear(t)}))}return t.prototype.event="to_be_defined",t.prototype.restEndpoint="/to_be_defined",t.prototype.get=function(){return this.collectionData},t.prototype.set=function(t){return App.SessionStorage.set("collection-"+this.event,t),this.collectionData=t},t.prototype.bind=function(t,e,n){var i;if(null==e&&(e=!0),null==n&&(n=!1),this.counter+=1,i=this.counter,e)if(void 0===this.collectionData)this.fetch();else if(t(this.collectionData),n)return;return this.callbacks[i]={callback:t,one:n},i},t.prototype.unbind=function(t){var e,n,i;for(e in i=[],n=this.callbacks)t===n[e].callback?i.push(delete this.callbacks[e]):i.push(void 0);return i},t.prototype.unbindById=function(t){return delete this.callbacks[t]},t.prototype.fetch=function(){var t,e;if(!this.fetchActive)return this.fetchActive=!0,App.Ajax.request({id:"collection-"+this.event,type:"GET",url:App.Config.get("api_path")+this.restEndpoint,processData:!0,success:(e=this,function(t){return e.fetchActive=!1,e.set(t),e.callback(t)}),error:(t=this,function(){return t.fetchActive=!1})})},t.prototype.trigger=function(){return this.callback(this.get())},t.prototype.callback=function(e){var n,t,i,s,r;for(i in r=[],s=this.callbacks)n=s[i],t=function(t){return function(){if(n.callback(e),n.one)return delete t.callbacks[i]}}(this),App.QueueManager.add(this.key,t),r.push(App.QueueManager.run(this.key));return r},t.prototype.clear=function(){return this.collectionData=void 0},t}()}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.ObjectOrganizationAutocompletion=function(t){function e(t){this.hideOrganizationMembers=n(this.hideOrganizationMembers,this),this.showOrganizationMembers=n(this.showOrganizationMembers,this),this.emptyResultList=n(this.emptyResultList,this),this.searchObject=n(this.searchObject,this),this.onKeyUp=n(this.onKeyUp,this),this.build=n(this.build,this),this.buildObjectNew=n(this.buildObjectNew,this),this.buildObjectItem=n(this.buildObjectItem,this),this.buildOrganizationMembers=n(this.buildOrganizationMembers,this),this.navigateByKeyboard=n(this.navigateByKeyboard,this),this.removeToken=n(this.removeToken,this),this.removeThisToken=n(this.removeThisToken,this),this.createToken=n(this.createToken,this),this.executeCallback=n(this.executeCallback,this),this.selectObject=n(this.selectObject,this),this.onObjectClick=n(this.onObjectClick,this),this.resetObjectSelection=n(this.resetObjectSelection,this),this.onBlur=n(this.onBlur,this),this.focusInput=n(this.focusInput,this),this.onFocus=n(this.onFocus,this),this.close=n(this.close,this),this.open=n(this.open,this),this.element=n(this.element,this),e.__super__.constructor.apply(this,arguments),this.lazySearch=_.debounce(this.searchObject,200),this.key=Math.floor(999999*Math.random()).toString(),this.attribute.source||(this.attribute.source=this.apiPath+"/search/user-organization"),this.build(),this.attribute.value&&this.callback&&this.callback(this.attribute.value)}return i(e,t),e.prototype.className="dropdown js-recipientDropdown",e.prototype.events={"hide.bs.dropdown .js-recipientDropdown":"hideOrganizationMembers","click .js-organization":"showOrganizationMembers","click .js-back":"hideOrganizationMembers","click .js-object":"onObjectClick","click .js-objectNew":"newObject","focus .js-objectSelect":"onFocus","click .js-objectSelect":"stopPropagation","blur .js-objectSelect":"onBlur","click .form-control":"focusInput",click:"stopPropagation","change .js-objectId":"executeCallback","click .js-remove":"removeThisToken"},e.prototype.elements={".recipientList":"recipientList",".js-objectSelect":"objectSelect",".js-objectId":"objectId",".form-control":"formControl"},e.prototype.templateObjectItem="generic/object_search/item_object",e.prototype.templateObjectNew="generic/object_search/new_object",e.prototype.templateOrganizationItem="generic/object_search/item_organization",e.prototype.templateOrganizationItemMembers="generic/object_search/item_organization_members",e.prototype.objectSingle="User",e.prototype.objectIcon="user",e.prototype.inactiveObjectIcon="inactive-user",e.prototype.objectSingels="People",e.prototype.objectCreate="Create new object",e.prototype.referenceAttribute="member_ids",e.prototype.element=function(){return this.el},e.prototype.release=function(){return $(window).off("click.ObjectOrganizationAutocompletion")},e.prototype.open=function(){if(!this.el.hasClass("open"))return this.el.addClass("open"),$(window).on("click.ObjectOrganizationAutocompletion",this.close),$(window).on("keydown.ObjectOrganizationAutocompletion",this.navigateByKeyboard)},e.prototype.close=function(){return $(window).off("keydown.ObjectOrganizationAutocompletion"),this.el.removeClass("open"),$(window).off("click.ObjectOrganizationAutocompletion")},e.prototype.onFocus=function(){return this.formControl.addClass("focus"),this.open()},e.prototype.focusInput=function(){if(!this.formControl.hasClass("focus"))return this.objectSelect.focus()},e.prototype.onBlur=function(){var t,e;if(e=this.objectSelect.val(),!_.isEmpty(e))return!0===this.attribute.guess&&(t=this.objectId.val(),(_.isEmpty(t)||t.match(/^guess:/))&&(_.isEmpty(e)||this.objectId.val("guess:"+e))),this.formControl.removeClass("focus");this.objectId.val("")},e.prototype.resetObjectSelection=function(){return this.objectId.val("").trigger("change")},e.prototype.onObjectClick=function(t){var e;return e=$(t.currentTarget).data("object-id"),this.selectObject(e),this.close()},e.prototype.selectObject=function(t){return this.attribute.multiple&&this.objectId.val()&&(t=_.chain(this.objectId.val().split(",")).push(t).join(",").value()),this.objectSelect.val(""),this.objectId.val(t).trigger("change")},e.prototype.executeCallback=function(){var t,e,n;if((n=this.objectId.val().split(",").pop())&&App[this.objectSingle].exists(n)&&(t=(e=App[this.objectSingle].find(n)).displayName(),this.attribute.multiple?this.createToken(t,n):(e.email&&(t.match(/\@|,|;|\^|\+|#|\xa7|\$|%|&|\/|\(|\)|=|\?|!|\*|\[|\]/)&&(t='"'+t+'"'),t+=" <"+e.email+">"),this.objectSelect.val(t))),this.callback)return this.callback(n)},e.prototype.createToken=function(t,e){return this.objectSelect.before(App.view("generic/token")({name:t,value:e}))},e.prototype.removeThisToken=function(t){return this.removeToken($(t.currentTarget).parents(".token"))},e.prototype.removeToken=function(t){var e,n,i;switch(t){case"last":if(!(i=this.$(".token").last()).size())return;break;default:i=t}return n=this.$(".token").index(i),(e=this.objectId.val().split(",")).splice(n,1),this.objectId.val(e.join(",")),i.remove()},e.prototype.navigateByKeyboard=function(t){var e,n,i;switch(t.keyCode){case 27:return this.recipientList.hasClass("is-shown")?this.objectSelect.val("").trigger("change"):void this.hideOrganizationMembers();case 8:if(""===this.objectSelect.val())return this.removeToken("last");break;case 9:return this.close();case 37:case 39:break;case 38:if(t.preventDefault(),this.recipientList.hasClass("is-shown"))return void(0===this.recipientList.find("li.is-active").length?this.recipientList.find("li").last().addClass("is-active"):0!==this.recipientList.find("li.is-active").prev().length&&this.recipientList.find("li.is-active").removeClass("is-active").prev().addClass("is-active"));0===(n=this.$(".recipientList-organizationMembers").not(".hide")).not(".hide").find("li.is-active").length?n.not(".hide").find("li").last().addClass("is-active"):0!==n.not(".hide").find("li.is-active").prev().length&&n.not(".hide").find("li.is-active").removeClass("is-active").prev().addClass("is-active");break;case 40:if(t.preventDefault(),this.recipientList.hasClass("is-shown"))return void(0===this.recipientList.find("li.is-active").length?this.recipientList.find("li").first().addClass("is-active"):0!==this.recipientList.find("li.is-active").next().length&&this.recipientList.find("li.is-active").removeClass("is-active").next().addClass("is-active"));0===(n=this.$(".recipientList-organizationMembers").not(".hide")).not(".hide").find("li.is-active").length?n.find("li").first().addClass("is-active"):0!==n.not(".hide").find("li.is-active").next().length&&n.not(".hide").find("li.is-active").removeClass("is-active").next().addClass("is-active");break;case 13:if(t.preventDefault(),t.stopPropagation(),!this.recipientList.hasClass("is-shown")){if((i=this.$(".recipientList-organizationMembers").not(".hide")).find(".js-back.is-active").get(0))return void this.hideOrganizationMembers();if(!(e=i.find("li.is-active").data("object-id")))return;return this.selectObject(e),void(this.attribute.multiple||this.close())}if(e=this.recipientList.find("li.is-active").data("object-id"))return void("new"===e?this.newObject():(this.selectObject(e),this.attribute.multiple||this.close()));if(!this.recipientList.find("li.is-active").data("organization-id"))return;return this.showOrganizationMembers(void 0,this.recipientList.find("li.is-active"))}},e.prototype.buildOrganizationItem=function(t){var e;return e=0,t[this.referenceAttribute]&&(e=t[this.referenceAttribute].length),App.view(this.templateOrganizationItem)({organization:t,objectSingels:this.objectSingels,objectCount:e})},e.prototype.buildOrganizationMembers=function(t){var e,n,i,s,r,o,a;if(r=$(App.view(this.templateOrganizationItemMembers)({organization:t})),t[this.referenceAttribute]){for(a=[],e=0,n=(o=t[this.referenceAttribute]).length;e<n;e++)s=o[e],i=App[this.objectSingle].fullLocal(s),a.push(r.append(this.buildObjectItem(i)));return a}},e.prototype.buildObjectItem=function(t){var e;return e=this.objectIcon,!1===t.active&&this.inactiveObjectIcon&&(e=this.inactiveObjectIcon),App.view(this.templateObjectItem)({object:t,icon:e})},e.prototype.buildObjectNew=function(){return App.view(this.templateObjectNew)({objectCreate:this.objectCreate})},e.prototype.build=function(){var t,e,n,i,s,r,o,a;if(a=n=o="",this.attribute.multiple&&this.attribute.value)for("object"!=typeof this.attribute.value&&(this.attribute.value=[this.attribute.value]),a=this.attribute.value.join(","),t=0,e=(r=this.attribute.value).length;t<e;t++)s=r[t],App[this.objectSingle].exists(s)?o+=App.view("generic/token")({name:App[this.objectSingle].find(s).displayName(),value:s}):this.log("objectId doesn't exist",s);else(a=this.attribute.value)&&(App[this.objectSingle].exists(a)?(n=(i=App[this.objectSingle].find(a)).displayName(),i.email&&(n+=" <"+i.email+">")):this.params&&this.params[this.attribute.name+"_completion"]?n=this.params[this.attribute.name+"_completion"]:this.log("objectId doesn't exist",a));return this.html(App.view("generic/object_search/input")({attribute:this.attribute,value:a,tokens:o,name:n})),this.attribute.disableCreateObject||this.recipientList.append(this.buildObjectNew()),this.searchTerm="",this.objectSelect.on("keyup",this.onKeyUp)},e.prototype.onKeyUp=function(t){var e;if(e=$(t.target).val().trim(),this.searchTerm!==e)return this.searchTerm=e,this.hideOrganizationMembers(),_.isEmpty(e)?(this.emptyResultList(),this.attribute.disableCreateObject||this.recipientList.append(this.buildObjectNew()),void this.resetObjectSelection()):e&&(!this.attribute.minLengt||this.attribute.minLengt<=e.length)?this.lazySearch(e):void 0},e.prototype.searchObject=function(t){return this.ajax({id:"searchObject"+this.key,type:"GET",url:this.attribute.source,data:{query:t},processData:!0,success:(a=this,function(t){var e,n,i,s,r,o;for(a.emptyResultList(),App.Collection.loadAssets(t.assets),e=0,i=(o=t.result).length;e<i;e++)"Organization"===(n=o[e]).type&&(r=App.Organization.fullLocal(n.id),a.recipientList.append(a.buildOrganizationItem(r)),r[a.referenceAttribute]&&a.$(".dropdown-menu").append(a.buildOrganizationMembers(r))),n.type===a.objectSingle&&(s=App[a.objectSingle].fullLocal(n.id),a.recipientList.append(a.buildObjectItem(s)));return a.attribute.disableCreateObject||a.recipientList.append(a.buildObjectNew()),a.recipientList.find(".js-object").first().addClass("is-active")})});var a},e.prototype.emptyResultList=function(){return this.recipientList.empty(),this.$(".recipientList-organizationMembers").remove()},e.prototype.showOrganizationMembers=function(t,e){var n,i;if(t&&(t.stopPropagation(),e=$(t.currentTarget)),n=e.data("organization-id"),this.organizationList=this.$("[organization-id="+n+"]"),this.organizationList.get(0))return this.recipientList.removeClass("is-shown"),this.$(".recipientList-organizationMembers").addClass("is-shown"),$.Velocity.hook(this.organizationList,"translateX","100%"),this.organizationList.removeClass("hide"),this.organizationList.velocity({properties:{translateX:0},options:{duration:240}}),this.recipientList.velocity({properties:{translateX:"-100%"},options:{duration:240,complete:(i=this,function(){return i.recipientList.height(i.organizationList.height())})}})},e.prototype.hideOrganizationMembers=function(t){var e;if(t&&t.stopPropagation(),this.recipientList.addClass("is-shown"),this.$(".recipientList-organizationMembers").removeClass("is-shown"),this.organizationList)return this.recipientList.velocity({properties:{translateX:0},options:{duration:240}}),this.recipientList.height(""),this.organizationList.velocity({properties:{translateX:"100%"},options:{duration:240,complete:(e=this,function(){return e.organizationList.addClass("hide")})}})},e.prototype.newObject=function(t){if(t)return t.preventDefault()},e}(App.Controller)}.call(this),function(){var n,s=function(t,e){return function(){return t.apply(e,arguments)}};App.Ajax=function(){function t(){}var e;return e=void 0,t.request=function(t){return void 0===e&&null==e&&(e=new n),e.request(t)},t.abort=function(t){return void 0===e&&null==e&&(e=new n),e.abort(t)},t.abortAll=function(){return void 0===e&&null==e&&(e=new n),e.abortAll()},t.queue=function(){return void 0===e&&null==e&&(e=new n),e.queue()},t.current=function(){return void 0===e&&null==e&&(e=new n),e.current()},t.token=function(){return void 0===e&&null==e&&(e=new n),e.token()},t}(),n=function(){function t(t){var i,e;this.args=t,this._hide_spinner=s(this._hide_spinner,this),this._show_spinner=s(this._show_spinner,this),this.token=s(this.token,this),this.current=s(this.current,this),this.queue=s(this.queue,this),this.runNextInQueue=s(this.runNextInQueue,this),this.abortAll=s(this.abortAll,this),this.abort=s(this.abort,this),this.removeCurrentRequest=s(this.removeCurrentRequest,this),this.addCurrentRequest=s(this.addCurrentRequest,this),this.runNextInQueue(),$(document).bind("ajaxSend",(e=this,function(){return e._show_spinner()})).bind("ajaxComplete",(i=this,function(t,e){var n;if(i._hide_spinner(),n=e.getResponseHeader("CSRF-TOKEN"))return i.currentToken=n,i.defaults.headers["X-CSRF-Token"]=n,Spine.Ajax.defaults.headers["X-CSRF-Token"]=n})),$(document).bind("ajaxError",function(t,e){var n,i;if(i=e.status,n=e.responseText,i||n||(n="General communication error, maybe internet is not available!"),0!==i&&200!==i&&401!==i&&404!==i&&422!==i&&502!==i)return new App.ControllerModal({head:"StatusCode: "+i,contentInline:"<pre>"+App.Utils.htmlEscape(n)+"</pre>",buttonClose:!0,buttonSubmit:!1})})}return t.prototype.defaults={contentType:"application/json",dataType:"json",processData:!1,headers:{"X-Requested-With":"XMLHttpRequest"},cache:!1,async:!0},t.prototype.currentToken=null,t.prototype.currentRequest={},t.prototype.queueList=[],t.prototype.queueRunning=!1,t.prototype.count=0,t.prototype.request=function(t){var e;return(e=$.extend({},this.defaults,t)).id?(this.abort(e.id),this.addCurrentRequest(e.id,e)):(e.id="rand-"+(new Date).getTime()+"-"+Math.floor(99999*Math.random()),e.queue?(this.queueList.push(e),this.queueRunning||this.runNextInQueue()):this.addCurrentRequest(e.id,e)),e.id},t.prototype.addCurrentRequest=function(t,e,n){var i;if(e.complete=(i=this,function(){if(n&&(i.queueRunning=!1),i.removeCurrentRequest(t),n)return i.runNextInQueue()}),this.currentRequest[t]=$.ajax(e),!0!==e.async)return this.removeCurrentRequest(t)},t.prototype.removeCurrentRequest=function(t){return this.currentRequest[t]=void 0,delete this.currentRequest[t]},t.prototype.abort=function(e){return this.currentRequest[e]&&(this.currentRequest[e].abort(),this.currentRequest[e]=void 0,delete this.currentRequest[e]),this.queueList=_.filter(this.queueList,function(t){if(t.id!==e)return t})},t.prototype.abortAll=function(){var t,e,n;for(e in t=[],n=this.currentRequest)n[e],this.abort(e),t.push(e);return t},t.prototype.runNextInQueue=function(){var t;if(this.queueList&&this.queueList[0])return this.queueRunning=!0,t=this.queueList.shift(),this.addCurrentRequest(t.id,t,!0)},t.prototype.queue=function(){return this.queueList},t.prototype.current=function(){return this.currentRequest},t.prototype.token=function(){return this.currentToken},t.prototype._show_spinner=function(){return this.count++,$(".spinner").show()},t.prototype._hide_spinner=function(){return this.count--,0===this.count?$(".spinner").hide():"ajax"===App.WebSocket.channel()&&1===this.count?$(".spinner").hide():void 0},t}()}.call(this),function(){App.Audio=function(){function t(){}return t.play=function(t,e){var n,i;if(null==e&&(e=.1),window.Audio&&(n=new window.Audio).canPlayType&&("maybe"===(i=n.canPlayType("audio/mp3"))||"probably"===i))return $(n).prop("src",t),n.load(),n.preload="auto",n.volume=e,n.play()},t}()}.call(this),function(){App.Auth=function(){function t(){}return t.login=function(i){return App.Log.debug("Auth","login",i),i.data.fingerprint=App.Browser.fingerprint(),App.Ajax.request({id:"login",type:"POST",url:App.Config.get("api_path")+"/signin",data:JSON.stringify(i.data),success:(r=this,function(t,e,n){return r._login(t),i.success(t,e,n)}),error:(s=this,function(t,e,n){return s._loginError(),i.error(t,e,n)})});var s,r},t.loginCheck=function(e){var t,n,i;return t={fingerprint:App.Browser.fingerprint()},App.Log.debug("Auth","loginCheck"),App.Ajax.request({id:"login_check",async:!1,type:"POST",url:App.Config.get("api_path")+"/signshow",data:JSON.stringify(t),success:(i=this,function(t){if(i._login(t,"check"),e)return e()}),error:(n=this,function(){return n._loginError()})})},t.logout=function(){var t,e;return App.Log.debug("Auth","logout"),App.Ajax.abortAll(),e=this,t=function(){return Spine.Ajax.clearQueue(),App.Ajax.request({id:"logout",type:"DELETE",url:App.Config.get("api_path")+"/signout",success:function(){return e._logout()},error:function(){return e._loginError()}})},Spine.Ajax.queue(t)},t._login=function(t,e){var n,i,s,r,o,a;if(App.Log.debug("Auth","_login:success",t),t.error){for(n in r=t.config)a=r[n],App.Config.set(n,a);return t.collections&&App.Collection.resetCollections(t.collections),App.Session.init(),this._updateModelAttributes(t.models),App.i18n.set(App.i18n.detectBrowserLocale()),App.Event.trigger("auth"),App.Event.trigger("auth:logout"),App.Event.trigger("ui:rerender"),App.TaskManager.tasksInitial(),!1}for(n in"check"!==e&&App.Event.trigger("clearStore"),this._updateModelAttributes(t.models),o=t.config)a=o[n],App.Config.set(n,a);return t.collections&&App.Collection.resetCollections(t.collections),t.assets&&App.Collection.loadAssets(t.assets),App.Session.set(t.session.id),App.Event.trigger("auth",t.session),(s=App.Session.get("preferences"))&&s.locale&&(i=s.locale),i||(i=App.i18n.detectBrowserLocale()),App.i18n.set(i),App.Event.trigger("auth:login",t.session),App.Event.trigger("ui:rerender"),App.TaskManager.tasksInitial()},t._updateModelAttributes=function(t){var e,n,i;if(!_.isEmpty(t)){for(n in i=[],t)e=t[n],App[n]&&_.isFunction(App[n].updateAttributes)?i.push(App[n].updateAttributes(e)):i.push(void 0);return i}},t._logout=function(t){var e,n;for(e in null==t&&(t=!0),App.Log.debug("Auth","_logout"),App.TaskManager.reset(),App.Session.init(),App.Ajax.abortAll(),App)n=App[e],_.isFunction(n.clearInMemory)&&n.clearInMemory();return App.Event.trigger("auth"),App.Event.trigger("auth:logout"),t&&this.loginCheck(function(){return window.location.href="#login",App.Event.trigger("ui:rerender")}),App.Event.trigger("clearStore")},t._loginError=function(){return App.Log.debug("Auth","_loginError:error"),App.Session.init(),App.Event.trigger("auth"),App.Event.trigger("auth:logout"),App.Event.trigger("ui:rerender"),App.Event.trigger("clearStore")},t}()}.call(this),function(){var n,i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Browser=function(){function t(){}return t.detection=function(){var t;return{browser:(t=new UAParser).getBrowser(),device:t.getDevice(),os:t.getOS()}},t.check=function(){var t,e;return e={Chrome:37,Firefox:36,Explorer:10,Safari:6,Opera:22},!((t=this.detection()).browser&&e[t.browser.name]&&t.browser.major<e[t.browser.name])||(new n({data:t,version:e[t.browser.name]}),App.Log.error("Browser","Browser not supported"),!1)},t.fingerprint=function(){var t,e,n,i,s;return(n=window.localStorage)&&(e=n.getItem("fingerprint")),e||(t=this.detection(),i=window.screen.availWidth+"x"+window.screen.availHeight+"/"+window.screen.pixelDepth,s=(new Date).toString().match(/\s\(.+?\)$/),e=function(t){return t.split("").reduce(function(t,e){return(t=(t<<5)-t+e.charCodeAt(0))&t},0)}(""+t.browser.name+t.browser.major+t.os+i+s),n&&n.setItem("fingerprint",e),e)},t.magicKey=function(){var t,e;return e="ctrl",(t=this.detection())&&t.os&&t.os.name.toString().match(/mac/i)&&(e="cmd"),e},t.hotkeys=function(){var t,e;return e="ctrl+shift",(
t=this.detection())&&t.os&&t.os.name.toString().match(/mac/i)&&(e="alt+ctrl"),e},t}(),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.buttonClose=!1,e.prototype.buttonCancel=!1,e.prototype.buttonSubmit=!1,e.prototype.backdrop=!1,e.prototype.keyboard=!1,e.prototype.head="Browser too old!",e.prototype.content=function(){return"Your Browser is not supported ("+this.data.browser.name+" "+this.data.browser.major+" on "+this.data.os.name+"). Please use a newer one (e. g. "+this.data.browser.name+" "+this.version+" or higher)."},e}(App.ControllerModal)}.call(this),function(){var s=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;App.BusinessHours=function(t){function i(){var t,e,n;for(t in this.validate=s(this.validate,this),this.toggleDay=s(this.toggleDay,this),this.removeTime=s(this.removeTime,this),this.addTime=s(this.addTime,this),this.onTimeChange=s(this.onTimeChange,this),this.updateMaxTimeframes=s(this.updateMaxTimeframes,this),this.render=s(this.render,this),i.__super__.constructor.apply(this,arguments),this.days={mon:App.i18n.translateInline("Monday"),tue:App.i18n.translateInline("Tuesday"),wed:App.i18n.translateInline("Wednesday"),thu:App.i18n.translateInline("Thursday"),fri:App.i18n.translateInline("Friday"),sat:App.i18n.translateInline("Saturday"),sun:App.i18n.translateInline("Sunday")},this.days)this.hours[t]||(this.hours[t]={});for(t in n=this.hours)(e=n[t]).active||(e.active=!1),e.timeframes||(e.timeframes=[])}return e(i,t),i.prototype.className="settings-list settings-list--fixed settings-list--stretch settings-list--toggleColumn",i.prototype.tag="table",i.prototype.events={"click .js-toggle-day":"toggleDay","click .js-add-time":"addTime","click .js-remove-time":"removeTime"},i.prototype.render=function(){var t;return this.updateMaxTimeframes(),t=App.view("generic/business_hours")({attribute:this.attribute,days:this.days,hours:this.options.hours,maxTimeframes:this.maxTimeframes}),this.html(t),this.$(".js-time").timepicker({showMeridian:!1}).on("changeTime.timepicker",this.onTimeChange),this.el.toggleClass("is-invalid",!this.validate())},i.prototype.updateMaxTimeframes=function(){var t;return t=_.max(this.hours,function(t){return t.timeframes.length}),this.maxTimeframes=t.timeframes.length},i.prototype.onTimeChange=function(t){var e,n,i,s;return e=(i=this.$(t.currentTarget)).attr("data-day"),s=i.attr("data-slot"),n=i.attr("data-i"),this.options.hours[e].timeframes[s][n]=t.time.hoursAndMinutes,this.el.toggleClass("is-invalid",!this.validate())},i.prototype.addTime=function(t){var e;return e=this.$(t.currentTarget).attr("data-day"),this.options.hours[e].timeframes.push(["13:00","17:00"]),this.render()},i.prototype.removeTime=function(t){var e;return e=this.$(t.currentTarget).attr("data-day"),this.options.hours[e].timeframes.pop(),this.render()},i.prototype.toggleDay=function(t){var e,n;return n=(e=this.$(t.currentTarget)).attr("data-target"),this.options.hours[n].active=e.prop("checked"),this.$("[data-day="+n+"]").toggleClass("is-active",e.prop("checked")),this.el.toggleClass("is-invalid",!this.validate())},i.prototype.validate=function(){var t,e,n,i,s,r;for(t in i=this.options.hours){if(!(e=i[t]).active)break;if("00:00"===e.timeframes[0][0]&&"00:00"===e.timeframes[e.timeframes.length-1][1])return!0;for(r=n=0,s=e.timeframes.length-1;0<=s?n<=s:s<=n;r=0<=s?++n:--n){if(!this.earlier(e.timeframes[r][0],e.timeframes[r][1]))return!1;if(0<r&&!this.later(e.timeframes[r][0],e.timeframes[r-1][1]))return!1}}return!0},i.prototype.later=function(t,e){var n,i,s,r,o,a;return n=(o=t.split(":").map(function(t){return parseInt(t,10)}))[0],s=o[1],i=(a=e.split(":").map(function(t){return parseInt(t,10)}))[0],r=a[1],i<n||n===i&&r<s},i.prototype.earlier=function(t,e){var n,i,s,r,o,a;return n=(o=t.split(":").map(function(t){return parseInt(t,10)}))[0],s=o[1],i=(a=e.split(":").map(function(t){return parseInt(t,10)}))[0],r=a[1],n<i||n===i&&s<r},i}(Spine.Controller)}.call(this),function(){var i,e=function(t,e){return function(){return t.apply(e,arguments)}};App.ClipBoard=function(){function t(){}var n;return n=void 0,t.bind=function(t){return void 0===n&&null==n&&(n=new i),n.bind(t)},t.getSelected=function(t){return void 0===n&&null==n&&(n=new i),n.getSelected(t)},t.getSelectedLast=function(t){return void 0===n&&null==n&&(n=new i),n.getSelectedLast(t)},t.getPosition=function(t){return void 0===n&&null==n&&(n=new i),n.getPosition(t)},t.setPosition=function(t,e){return void 0===n&&null==n&&(n=new i),n.setPosition(t,e)},t.keycode=function(t){return void 0===n&&null==n&&(n=new i),n.keycode(t)},t}(),i=function(){function t(){this._updateSelection=e(this._updateSelection,this),this.selection={html:"",text:""},this.selectionLast={html:"",text:""}}return t.prototype.bind=function(t){var e,n;return $(t).bind("mouseup",(e=this,function(){return e._updateSelection()})),$(t).bind("keyup",(n=this,function(t){if(91===t.keyCode&&n._updateSelection(),37===t.keyCode||38===t.keyCode||39===t.keyCode||40===t.keyCode)return n._updateSelection()}))},t.prototype._updateSelection=function(){var t,e,n,i,s;for(s=[],t=0,n=(i=["html","text"]).length;t<n;t++)e=i[t],this.selection[e]=this._getSelected(e),this.selection[e]?s.push(this.selectionLast[e]=this.selection[e]):s.push(void 0);return s},t.prototype._getSelected=function(t){var e,n,i,s,r,o,a;if(n=a="",window.getSelection?a=(o=window.getSelection()).toString():document.getSelection?a=(o=document.getSelection()).toString():document.selection&&(a=(o=document.selection.createRange()).text),"text"===t)return a?$.trim(a.toString()):"";if(o&&o.rangeCount){for(e=document.createElement("div"),i=s=1,r=o.rangeCount;1<=r?s<=r:r<=s;i=1<=r?++s:--s)e.appendChild(o.getRangeAt(i-1).cloneContents());n=e.innerHTML}return n},t.prototype.getSelected=function(t){return this.selection[t]},t.prototype.getSelectedLast=function(t){return this.selectionLast[t]},t.prototype.getPosition=function(t){var e,n;return n=0,t=document.getElementById(t),document.selection?(t.focus(),(e=document.selection.createRange()).moveStart("character",-t.value.length),n=e.text.length):(t.selectionStart||"0"===t.selectionStart)&&(n=t.selectionStart),n},t.prototype.setPosition=function(t,e){var n;return(t=document.getElementById(t)).setSelectionRange?(t.focus(),t.setSelectionRange(e,e)):t.createTextRange?((n=t.createTextRange()).collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select()):void 0},t.prototype.keycode=function(t){var e,n;for(e in n=this.keycodesTable())if(n[e].toString()===t.toString())return e},t.prototype.keycodesTable=function(){return{backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,space:32,pause_break:"19",caps_lock:"20",escape:"27",page_up:"33","page down":"34",end:"35",home:"36",left_arrow:"37",up_arrow:"38",right_arrow:"39",down_arrow:"40",insert:"45","delete":"46",0:"48",1:"49",2:"50",3:"51",4:"52",5:"53",6:"54",7:"55",8:"56",9:"57",a:"65",b:"66",c:"67",d:"68",e:"69",f:"70",g:"71",h:"72",i:"73",j:"74",k:"75",l:"76",m:"77",n:"78",o:"79",p:"80",q:"81",r:"82",s:"83",t:"84",u:"85",v:"86",w:"87",x:"88",y:"89",z:"90","left_window key":"91","right_window key":"92",select_key:"93","numpad 0":"96","numpad 1":"97","numpad 2":"98","numpad 3":"99","numpad 4":"100","numpad 5":"101","numpad 6":"102","numpad 7":"103","numpad 8":"104","numpad 9":"105",multiply:"106",add:"107",subtract:"109","decimal point":"110",divide:"111",f1:"112",f2:"113",f3:"114",f4:"115",f5:"116",f6:"117",f7:"118",f8:"119",f9:"120",f10:"121",f11:"122",f12:"123",num_lock:"144",scroll_lock:"145",semi_colon:"186",equal_sign:"187",comma:"188",dash:"189",period:"190",forward_slash:"191",grave_accent:"192",open_bracket:"219",backslash:"220",closebracket:"221",single_quote:"222"}},t}()}.call(this),function(){var i,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Collection=function(){function t(){}var n;return n=void 0,t.init=function(){return n=new i},t.load=function(t){return void 0===n&&null==n&&(n=new i),n.load(t)},t.loadAssets=function(t,e){return void 0===n&&null==n&&(n=new i),n.loadAssets(t,e)},t.reset=function(t){return void 0===n&&null==n&&(n=new i),n.reset(t)},t.resetCollections=function(t){return void 0===n&&null==n&&(n=new i),n.resetCollections(t)},t}(),i=function(t){function e(t){var e,n;this.args=t,App.Event.bind("loadAssets",(e=this,function(t){if(t)return e.loadAssets(t);e.log("error","loadAssets:trigger, got no data, cant load assets")})),App.Event.bind("resetCollection",(n=this,function(t){if(t)return n.resetCollections(t);n.log("error","resetCollection:trigger, got no data, cant for collections")}))}return n(e,t),e.include(App.LogInclude),e.prototype.resetCollections=function(t){var e,n,i;for(i in n=[],t)e=t[i],this.log("debug","resetCollection:trigger",i,e),n.push(this.reset({type:i,data:e}));return n},e.prototype.reset=function(t){var e;if(e=App[t.type])return e.refresh(t.data,{clear:!0});this.log("error","reset","no such collection "+t.type,t)},e.prototype.loadAssets=function(t,e){var n,i,s,r,o;if(null==e&&(e={}),!_.isEmpty(t)){for(o in s={},t)n=t[o],e.targetModel&&e.targetModel===o||(i=this.load({type:o,data:n,later:!0}),_.isEmpty(i)||(s[o]=i));for(o in s)n=s[o],App[o].refresh(n);if(e.targetModel){for(o in r=[],t)n=t[o],e.targetModel===o?r.push(this.load({type:o,data:n})):r.push(void 0);return r}}},e.prototype.load=function(t){var e,n,i,s,r,o,a;if(!_.isEmpty(t.data)){if(e=App[t.type]){if(_.isArray(t.data))return this.log("debug","refresh",t.data),void e.refresh(t.data);for(i in s=[],r=[],a=t.data)o=a[i],!t.refresh&&e&&(this.log("debug","refresh try",t.type,i),o.updated_at?(n=e.updatedAt(i))?n<o.updated_at&&(t.later?(r.push(o),this.log("debug","refresh newer later",t.type,i)):(s.push(o),this.log("debug","refresh newer",t.type,i))):(s.push(o),this.log("debug","refresh new no current updated_at",t.type,i)):(s.push(o),this.log("debug","refresh new",t.type,i)));return _.isEmpty(s)||e.refresh(s),r}this.log("error","reset","no such collection "+t.type,t)}},e}(Spine.Module)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Color=function(t){function e(){this.onLightnessMousemove=n(this.onLightnessMousemove,this),this.onHueSaturationMousemove=n(this.onHueSaturationMousemove,this),this.element=n(this.element,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.color=void 0,e.prototype.moving=void 0,e.prototype.elements={".js-input":"input",".js-swatch":"swatch",".js-colorpicker-hue-saturation":"hueSaturation",".js-colorpicker-lightness-plane":"lightnessPlane",".js-colorpicker-saturation-gradient":"saturationGradient",".js-colorpicker-circle":"circle",".js-colorpicker-lightness":"lightness",".js-colorpicker-hue-plane":"huePlane",".js-colorpicker-slider":"slider"},e.prototype.events={"input .js-input":"onInput","mousedown .js-colorpicker-hue-saturation":"onHueSaturationMousedown","mousedown .js-colorpicker-lightness":"onLightnessMousedown","click .js-dropdown":"stopPropagation"},e.prototype.stopPropagation=function(t){return t.stopPropagation()},e.prototype.element=function(){return this.el},e.prototype.render=function(){return this.color=new App.ColorObject(this.attribute.value),this.html(App.view("generic/color")({attribute:this.attribute,hsl:this.color.asHslArray()}))},e.prototype.onInput=function(){return this.color.updateWithString(this.input.val()),this.renderPicker(),this.updateSwatch(this.color.asString())},e.prototype.updateSwatch=function(t){return this.swatch.css("background-color",""),this.swatch.css("background-color",t)},e.prototype.onHueSaturationMousedown=function(t){return $(document).on("mousemove.colorpicker",this.onHueSaturationMousemove),$(document).on("mouseup.colorpicker",this.onMouseup),this.onHueSaturationMousemove(t)},e.prototype.onHueSaturationMousemove=function(t){var e;return e=this.hueSaturation.offset(),this.color.updateWithHslComponent(Math.max(0,Math.min(1,(t.pageX-e.left)/this.hueSaturation.width())),0),this.color.updateWithHslComponent(Math.max(0,Math.min(1,1-(t.pageY-e.top)/this.hueSaturation.height())),1),this.renderPicker(),this.renderPickerOutput()},e.prototype.onLightnessMousedown=function(t){return $(document).on("mousemove.colorpicker",this.onLightnessMousemove),$(document).on("mouseup.colorpicker",this.onMouseup),this.onLightnessMousemove(t)},e.prototype.onLightnessMousemove=function(t){var e;return e=this.lightness.offset(),this.color.updateWithHslComponent(Math.max(0,Math.min(1,1-(t.pageY-e.top)/this.lightness.height())),2),this.renderPicker(),this.renderPickerOutput()},e.prototype.onMouseup=function(){return $(document).off("mousemove.colorpicker"),$(document).off("mouseup.colorpicker")},e.prototype.renderPickerOutput=function(){var t;return t=this.color.asString(),this.updateSwatch(t),this.input.val(t)},e.prototype.renderPicker=function(){var t;return t=this.color.asHslArray(),this.lightnessPlane.css({"background-color":"hsla(0,0%,"+(.5<t[2]?100:0)+"%,"+2*Math.abs(t[2]-.5)+")"}),this.saturationGradient.css({"background-image":"linear-gradient(transparent, hsl(0, 0%, "+100*t[2]+"%))"}),this.circle.css({left:100*t[0]+"%",top:100-100*t[1]+"%",borderColor:.5<t[2]?"black":"white"}),this.huePlane.css({"background-color":"hsl("+360*t[0]+", 100%, 50%)"}),this.slider.css({top:100-100*t[2]+"%"})},e}(Spine.Controller)}.call(this),function(){App.ColorObject=function(){function t(t){this.original=t}return t.prototype.original=void 0,t.prototype.asHslArray=function(){return _.isArray(this.original)?this.original:this.constructor.anyToHslArray(this.original)},t.prototype.asString=function(){return _.isArray(this.original)?this.constructor.hslArrayToHslString(this.original):this.original},t.prototype.updateWithString=function(t){return this.original=t},t.prototype.updateWithHslComponent=function(t,e){return _.isArray(this.original)||(this.original=this.constructor.anyToHslArray(this.original)),this.original[e]=t},t.anyToRgb=function(t){var e,n;return(e=document.createElement("canvas")).width=e.height=1,(n=e.getContext("2d")).clearRect(0,0,1,1),n.fillStyle=t,n.fillRect(0,0,1,1),n.getImageData(0,0,1,1).data},t.anyToHslArray=function(t){return this.rgbToHslArray(this.anyToRgb(t))},t.anyToHslString=function(t){return this.hslArrayToHslString(this.rgbToHslArray(this.anyToRgb(t)))},t.rgbToHslArray=function(t){var e,n,i,s,r,o,a,l,c;return t?(l=t[0]/255,i=t[1]/255,e=t[2]/255,o=Math.max(l,i,e),a=Math.min(l,i,e),r=(o+a)/2,o===a?s=c=0:(n=o-a,c=.5<r?n/(2-o-a):n/(o+a),s=function(){var t;switch(!1){case l!==o:return(i-e)/n+(null!=(t=i<e)?t:{6:0});case i!==o:return(e-l)/n+2;case e!==o:return(l-i)/n+4}}(),s/=6),[s,c,r]):[0,0,0]},t.hslArrayToHslString=function(t){return"hsl("+Math.round(360*t[0])+","+Math.round(100*t[1])+"%,"+Math.round(100*t[2])+"%)"},t}()}.call(this),function(){var s=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;App.ColumnSelect=function(t){function i(){var t,e,n;this.element=s(this.element,this),i.__super__.constructor.apply(this,arguments),this.render(),this.throttledRemove=_.throttle((t=this,function(){return t.remove(t.pickedValue)}),300,{trailing:!1}),this.throttledSelect=_.throttle((e=this,function(){return e.select(e.pickedValue)}),300,{trailing:!1}),this.attribute.onChange&&this.shadow.on("change",(n=this,function(){return n.attribute.onChange(n.shadow.val())}))}return e(i,t),i.prototype.elements={".js-pool":"pool",".js-selected":"selected",".js-shadow":"shadow",".js-placeholder":"placeholder",".js-pool .js-option":"poolOptions",".js-selected .js-option":"selectedOptions",".js-search":"search",".js-clear":"clearButton"},i.prototype.events={"click .js-select":"onSelect","click .js-remove":"onRemove","input .js-search":"filter","click .js-clear":"clear","keydown .js-search":"onFilterKeydown"},i.prototype.className="form-control columnSelect",i.prototype.element=function(){return this.el},i.prototype.render=function(){var r,t,e,n,i,s,o,a,l,c,p,u,h,d;if(!_.isEmpty(this.attribute.seperator))for(h=[],this.attribute.value?h=this.attribute.value.split(this.attribute.seperator):this.attribute["default"]&&(h=this.attribute["default"].split(this.attribute.seperator)),t=0,i=h.length;t<i;t++)for(u=h[t],e=0,s=(c=this.options.attribute.options).length;e<s;e++)if(!0===(l=c[e]).group)for(n=0,o=(p=l.group).length;n<o;n++)(a=p[n]).value===u&&(a.selected=!0);else l.value===u&&(l.selected=!0);return this.values=[],r=[],_.each(this.options.attribute.options,(d=this,function(t){var e,n,i,s;if(void 0!==t.group){for(s=[],n=0,e=(i=t.group).length;n<e;n++)a=i[n],r.push(a),a.selected?s.push(d.values.push(a.value.toString())):s.push(void 0);return s}if(r.push(t),t.selected)return d.values.push(t.value.toString())})),this.html(App.view("generic/column_select")({attribute:this.options.attribute,allOptions:r,values:this.values}))},i.prototype.onSelect=function(t){return this.pickedValue=$(t.currentTarget).attr("data-value"),this.throttledSelect()},i.prototype.select=function(t){if(this.selected.find("[data-value='"+t+"']").removeClass("is-hidden"),this.pool.find("[data-value='"+t+"']").addClass("is-hidden"),this.values.push(t),_.isEmpty(this.attribute.seperator)?(this.shadow.val(this.values),this.shadow.trigger("change")):this.shadow.val(this.values.join(";")),this.placeholder.addClass("is-hidden"),this.search.val()&&0===this.poolOptions.not(".is-filtered").not(".is-hidden").size())return this.clear()},i.prototype.onRemove=function(t){return this.pickedValue=$(t.currentTarget).attr("data-value"),this.throttledRemove()},i.prototype.remove=function(t){if(this.pool.find("[data-value='"+t+"']").removeClass("is-hidden"),this.selected.find("[data-value='"+t+"']").addClass("is-hidden"),this.values.splice(this.values.indexOf(t),1),_.isEmpty(this.attribute.seperator)?(this.shadow.val(this.values),this.shadow.trigger("change")):this.shadow.val(this.values.join(";")),!this.values.length)return this.placeholder.removeClass("is-hidden")},i.prototype.filter=function(t){var n;return n=$(t.currentTarget).val(),this.poolOptions.each(function(t,e){if(!$(e).hasClass("is-hidden"))return-1<$(e).text().toLowerCase().indexOf(n.toLowerCase())?$(e).removeClass("is-filtered"):$(e).addClass("is-filtered")}),this.clearButton.toggleClass("is-hidden",0===n.length),this.pool.toggleClass("filter-active",0!==n.length)},i.prototype.clear=function(){return this.search.val(""),this.poolOptions.removeClass("is-filtered"),this.clearButton.addClass("is-hidden")},i.prototype.onFilterKeydown=function(t){var e;if(13===t.keyCode)return t.stopPropagation(),t.preventDefault(),(e=this.poolOptions.not(".is-filtered").not(".is-hidden").first())?this.select(e.attr("data-value")):void 0},i}(Spine.Controller)}.call(this),function(){var o,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Delay=function(){function t(){}var r;return r=void 0,t.set=function(t,e,n,i,s){return void 0===r&&null==r&&(r=new o),r.set(t,e,n,i,s)},t.clear=function(t,e){return void 0===r&&null==r&&(r=new o),r.clear(t,e)},t.clearLevel=function(t){return void 0===r&&null==r&&(r=new o),r.clearLevel(t)},t.reset=function(){return void 0===r&&null==r&&(r=new o),r.reset()},t.count=function(){return void 0===r&&null==r&&(r=new _intervalSingleton),r.count()},t._all=function(){return void 0===r&&null==r&&(r=new o),r._all()},t}(),o=function(t){function e(){this._all=n(this._all,this),this.count=n(this.count,this),this.reset=n(this.reset,this),this.clearLevel=n(this.clearLevel,this),this.clear=n(this.clear,this),this.set=n(this.set,this),this.levelStack={}}return i(e,t),e.include(App.LogInclude),e.prototype.set=function(t,e,n,i,s){var r,o;return i||(i="_all"),n&&this.clear(n,i),n||(n=Math.floor(99999*Math.random())),this.log("debug","set",n,e,i,t,s),o=this,r=setTimeout(function(){return o.clear(n,i),s?(App.QueueManager.add("delay",t),App.QueueManager.run("delay")):t()},e),this.levelStack[i]||(this.levelStack[i]={}),this.levelStack[i][n.toString()]={delay_id:r,timeout:e,level:i},n.toString()},e.prototype.clear=function(t,e){var n;if(e||(e="_all"),this.levelStack[e]&&(n=this.levelStack[e][t.toString()]))return this.log("debug","clear",n),clearTimeout(n.delay_id),delete this.levelStack[e][t.toString()],_.isEmpty(this.levelStack[e])?delete this.levelStack[e]:void 0},e.prototype.clearLevel=function(t){var e,n;if(this.levelStack[t]){for(e in n=this.levelStack[t])n[e],this.clear(e,t);return delete this.levelStack[t]}},e.prototype.reset=function(){var t,e,n,i;for(n in i=this.levelStack){for(e in t=i[n])t[e],this.clear(e,n);this.levelStack[n]={}}return!0},e.prototype.count=function(){var t,e,n,i;if(!this.levelStack)return 0;for(e in t=0,i=this.levelStack)n=i[e],t+=Object.keys(n).length;return t},e.prototype._all=function(){return this.levelStack},e}(Spine.Module)}.call(this),function(){var s,n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;App.Event=function(){function t(){}var i;return i=void 0,t.init=function(){return i=new s},t.bind=function(t,e,n){return void 0===i&&null==i&&(i=new s),i.bind(t,e,n,!1)},t.prototype.one=function(t,e,n){return this.bind(t,e,n,!0),i.bind(t,e,n,!0)},t.unbind=function(t,e,n){return void 0===i&&null==i&&(i=new s),i.unbind(t,e,n)},t.trigger=function(t,e){return void 0===i&&null==i&&(i=new s),i.trigger(t,e)},t.unbindLevel=function(t){return void 0===i&&null==i&&(i=new s),i.unbindLevel(t)},t.count=function(){return void 0===i&&null==i&&(i=new s),i.count()},t._allBindings=function(){return void 0===i&&null==i&&(i=new s),i._allBindings()},t}(),s=function(t){function e(){this.eventCurrent={}}return n(e,t),e.include(App.LogInclude),e.prototype.unbindLevel=function(t){var e,n,i,s;if(this.eventCurrent[t]){for(e=0,i=(s=this.eventCurrent[t]).length;e<i;e++)n=s[e],this.unbind(n.event,n.callback,t);return delete this.eventCurrent[t]}},e.prototype.bind=function(t,e,n,i){var s,r,o,a,l;for(null==i&&(i=!1),n||(n="_all"),this.eventCurrent[n]||(this.eventCurrent[n]=[]),l=[],o=0,a=(r=t.split(" ")).length;o<a;o++)s=r[o],this.eventCurrent[n].push({event:s,callback:e,one:!1}),i?l.push(this.log("debug","one",s,e)):l.push(this.log("debug","bind",s,e));return l},e.prototype.unbind=function(t,e,n){var i,s,r,o,a;for(n||(n="_all"),this.eventCurrent[n]||(this.eventCurrent[n]=[]),a=[],r=0,o=(s=t.split(" ")).length;r<o;r++)i=s[r],this.eventCurrent[n]=_.filter(this.eventCurrent[n],function(t){if(e){if(t.event!==i&&t.callback!==e)return t}else if(t.event!==i)return t}),a.push(this.log("debug","unbind",i,e));return a},e.prototype.trigger=function(t,i){var e,s,r,o,n,a,l,c;for(a in o=t.split(" "),c=[],l=this.eventCurrent)e=l[a],c.push(function(){var t;for(n in t=[],e)s=e[n],t.push(function(){var t,e,n;for(n=[],t=0,e=o.length;t<e;t++)r=o[t],s.event===r?(s.callback(i),!0===s.one?n.push(this.unbind(r,s.callback,a)):n.push(void 0)):n.push(void 0);return n}.call(this));return t}.call(this));return c},e.prototype.count=function(){var t,e,n,i;if(!this.eventCurrent)return 0;for(e in t=0,i=this.eventCurrent)n=i[e],t+=Object.keys(n).length;return t},e.prototype._allBindings=function(){return this.eventCurrent},e}(Spine.Module)}.call(this),function(){App.FullQuoteHeader=function(){function i(){}return i.fullQuoteHeaderForward=function(t){var e,n,i,s;if(!App.Config.get("ui_ticket_zoom_article_email_full_quote_header"))return"";for(n in i=document.createElement("div"),e={Subject:t.subject,Date:App.i18n.translateTimestamp(t.created_at),From:this.fullQuoteHeaderForwardFrom(t),To:this.fullQuoteHeaderForwardTo(t),CC:this.fullQuoteHeaderForwardCC(t)})(s=e[n])&&i.append(App.i18n.translateContent(n),": ",s,document.createElement("br"));return i.append(document.createElement("br")),i.outerHTML},i.fullQuoteHeaderForwardFrom=function(t){var e;return e=t.origin_by_id||t.created_by_id,this.fullQuoteHeaderEnsurePrivacy(e)||this.fullQuoteHeaderEnsurePrivacy(t.from)||t.from},i.fullQuoteHeaderForwardTo=function(t){var e,n,i;return"email"===t.type.name||"web"===t.type.name?this.fullQuoteHeaderEnsurePrivacy(t.to)||t.to:"Customer"===t.sender.name&&"phone"===t.type.name?(e=null!=(n=App.Group.findByAttribute("name",t.to))?n.email_address_id:void 0)?App.EmailAddress.find(e).displayName():t.to:"Agent"===t.sender.name&&"phone"===t.type.name?(i=App.Ticket.find(t.ticket_id),this.fullQuoteHeaderEnsurePrivacy(i.customer_id)||this.fullQuoteHeaderEnsurePrivacy(t.to)||t.to):t.to},i.fullQuoteHeaderForwardCC=function(t){var e;if(t.cc)return t.cc.split(",").map(function(t){return t.trim()}).map((e=this,function(t){return e.fullQuoteHeaderEnsurePrivacy(t)||t})).join(", ")},i.fullQuoteHeaderEnsurePrivacyParseInput=function(t){var e;switch(typeof t){case"number":return App.User.find(t);case"string":if(e=this.fullQuoteHeaderExtractEmail(t))return App.User.findByAttribute("email",e);break;case"object":return t}},i.fullQuoteHeaderEnsurePrivacy=function(t){var e,n;if(n=i.fullQuoteHeaderEnsurePrivacyParseInput(t))return e=""+n.displayName(),!n.permission("ticket.agent")&&n.email&&(e+=" <"+n.email+">"),e},i.fullQuoteHeaderExtractEmail=function(t){var e;if(e=t.match(/<?(\S+@\S[^>]+)(>?)/))return e[1]},i}()}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.GlobalSearch=function(t){function e(){this.close=n(this.close,this),this.renderTry=n(this.renderTry,this),this.ajaxStop=n(this.ajaxStop,this),this.ajaxStart=n(this.ajaxStart,this),this.search=n(this.search,this),e.__super__.constructor.apply(this,arguments),this.searchResultCache={},this.lastQuery=void 0,this.apiPath=App.Config.get("api_path"),this.ajaxId="search-"+Math.floor(999999*Math.random())}return i(e,t),e.prototype.ajaxCount=0,e.prototype.search=function(l){var t,e,c,n,p;return c=l.query,t=new Date,this.searchResultCache[c]&&this.searchResultCache[c].time>t.setSeconds(t.getSeconds()-20)?(this.ajaxRequestId&&App.Ajax.abort(this.ajaxRequestId),this.ajaxStart(l),this.renderTry(this.searchResultCache[c].result,c,l),e=function(){return n.ajaxStop(l)},void(n=this).delay(e,700)):(e=function(){return p.ajaxStart(l),e=function(){if(l.callbackLongerAsExpected)return l.callbackLongerAsExpected()},p.delay(e,1e4,"global-search-ajax-longer-as-expected"),p.ajaxRequestId=App.Ajax.request({id:p.ajaxId,type:"GET",url:p.apiPath+"/search",data:{query:c,limit:p.limit||10},processData:!0,success:function(t){var e,n,i,s,r,o,a;for(p.clearDelay("global-search-ajax-longer-as-expected"),App.Collection.loadAssets(t.assets),a={},e=0,r=(o=t.result).length;e<r;e++)n=o[e],App[n.type]&&App[n.type].find?(a[n.type]||(a[n.type]=[]),(i=App[n.type].find(n.id)).searchResultAttributes?(s=i.searchResultAttributes(),a[n.type].push(s)):App.Log.error("_globalSearchSingleton","No such model "+n.type.toLocaleLowerCase()+".searchResultAttributes()")):App.Log.error("_globalSearchSingleton","No such model App."+n.type);return p.ajaxStop(l),p.renderTry(a,c,l)},error:function(){return p.clearDelay("global-search-ajax-longer-as-expected"),p.ajaxStop(l)}})},(p=this).delay(e,l.delay||1,"global-search-ajax"))},e.prototype.ajaxStart=function(t){if(this.ajaxCount++,t.callbackStart)return t.callbackStart()},e.prototype.ajaxStop=function(t){if(this.ajaxCount--,0===this.ajaxCount&&t.callbackStop)return t.callbackStop()},e.prototype.renderTry=function(t,e,n){var i;if(e){if(_.isEmpty(t)?n.callbackNoMatch&&n.callbackNoMatch():n.callbackMatch&&n.callbackMatch(),this.lastQuery===e&&this.searchResultCache[e]&&(i=difference(this.searchResultCache[e].result,t),_.isEmpty(i)))return;this.lastQuery=e,this.searchResultCache[e]={result:t,time:new Date}}return this.render(t)},e.prototype.close=function(){return this.lastQuery=void 0},e}(App.Controller)}.call(this),function(){var s,r=[].slice,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;App.i18n=function(){function t(){}var i;return i=void 0,t.init=function(t){return null!=i?i:i=new s(t)},t.translateDeep=function(t){var e,n;return n=t,e=2<=arguments.length?r.call(arguments,1):[],void 0===i&&null==i&&(i=new s),i.translateDeep(n,e)},t.translateContent=function(t){var e,n;return n=t,e=2<=arguments.length?r.call(arguments,1):[],void 0===i&&null==i&&(i=new s),i.translateContent(n,e)},t.translatePlain=function(t){var e,n;return n=t,e=2<=arguments.length?r.call(arguments,1):[],void 0===i&&null==i&&(i=new s),i.translatePlain(n,e)},t.translateInline=function(t){var e,n;return n=t,e=2<=arguments.length?r.call(arguments,1):[],void 0===i&&null==i&&(i=new s),i.translateInline(n,e)},t.translateTimestamp=function(t,e){return null==e&&(e=0),void 0===i&&null==i&&(i=new s),i.timestamp(t,e)},t.translateDate=function(t,e){return null==e&&(e=0),void 0===i&&null==i&&(i=new s),i.date(t,e)},t.dir=function(){return void 0===i&&null==i&&(i=new s),i.dir()},t.get=function(){return void 0===i&&null==i&&(i=new s),i.get()},t.set=function(t){return void 0===i&&null==i&&(i=new s),i.set(t)},t.setMap=function(t,e,n){return void 0===i&&null==i&&(i=new s),i.setMap(t,e,n)},t.meta=function(){return void 0===i&&null==i&&(i=new s),i.meta()},t.notTranslatedFeatureEnabled=function(t){return void 0===i&&null==i&&(i=new s),i.notTranslatedFeatureEnabled(t)},t.getNotTranslated=function(t){return void 0===i&&null==i&&(i=new s),i.getNotTranslated(t)},t.removeNotTranslated=function(t,e){return void 0===i&&null==i&&(i=new s),i.removeNotTranslated(t,e)},t.setNotTranslated=function(t,e){return void 0===i&&null==i&&(i=new s),i.setNotTranslated(t,e)},t.timeFormat=function(){return void 0===i&&null==i&&(i=new s),i.mapTime},t.detectBrowserLocale=function(){var t,e,n,i,s;if(window.navigator.languages)for(e=0,n=(s=window.navigator.languages).length;e<n;e++)if(t=s[e],i=this.findLocalLocale(t))return i;return window.navigator.language&&(i=this.findLocalLocale(window.navigator.language))?i:window.navigator.userLanguage&&(i=this.findLocalLocale(window.navigator.userLanguage))?i:"en-us"},t.findLocalLocale=function(t){var e,n,i,s,r,o,a,l,c;for(n=t.toLowerCase(),i=0,r=(l=App.Locale.all()).length;i<r;i++)if(n===(a=l[i]).locale.toLowerCase())return a.locale.toLowerCase();for(e=t.substr(0,2).toLowerCase(),s=0,o=(c=App.Locale.all()).length;s<o;s++)if(e===(a=c[s]).alias.toLowerCase())return a.locale.toLowerCase()},t.detectBrowserTimezone=function(){var t,e;if(window.Intl&&window.Intl.DateTimeFormat&&(t=Intl.DateTimeFormat())&&t.resolvedOptions&&(e=t.resolvedOptions())&&e.timeZone)return e.timeZone},t}(),s=function(t){function e(){this.timestamp=n(this.timestamp,this),this.date=n(this.date,this),this.setNotTranslated=n(this.setNotTranslated,this),this.removeNotTranslated=n(this.removeNotTranslated,this),this.getNotTranslated=n(this.getNotTranslated,this),this.setMap=n(this.setMap,this),this.meta=n(this.meta,this),this.translate=n(this.translate,this),this.translatePlain=n(this.translatePlain,this),this.translateContent=n(this.translateContent,this),this.translateDeep=n(this.translateDeep,this),this.translateInline=n(this.translateInline,this),this.mapTime={},this.mapString={},this.mapMeta={total:0,translated:0},this._notTranslatedLog=!1,this._notTranslated={},this.dateFormat="yyyy-mm-dd",this.timestampFormat="yyyy-mm-dd HH:MM",this.dirToSet="ltr"}return i(e,t),e.include(App.LogInclude),e.prototype.dir=function(){return this.dirToSet},e.prototype.get=function(){return this.locale},e.prototype.set=function(t){var e,n,i,s,r,o,a,l,c,p;for(t=t.toLowerCase(),l=!(this.dirToSet="ltr"),e=0,s=(c=App.Locale.all()).length;e<s;e++)(a=c[e]).locale===t&&(t=a.locale,this.dirToSet=a.dir,l=!0);if(!l)for(n=0,r=c.length;n<r;n++)(a=c[n]).alias===t&&(t=a.locale,this.dirToSet=a.dir
,l=!0);if(!l)for(t=t.substr(0,2),i=0,o=c.length;i<o;i++)(a=c[i]).alias===t&&(t=a.locale,this.dirToSet=a.dir,l=!0);if(t!==this.locale)return this.locale=t,this._notTranslatedLog=this.notTranslatedFeatureEnabled(this.locale),$("html").prop("lang",t.substr(0,2)),$("html").prop("dir",this.dirToSet),this.mapString={},App.Ajax.request({id:"i18n-set-"+this.locale,type:"GET",url:App.Config.get("api_path")+"/translations/lang/"+this.locale,async:!1,success:(p=this,function(t){var e,n,i,s,r,o;for(p.mapMeta.total=t.total,s=[],n=0,i=(o=t.list).length;n<i;n++)"time"===(r=o[n])[3]?p.mapTime[r[1]]=r[2]:(p.mapString[r[1]]=r[2],e={id:r[0],source:r[1],target:r[2],locale:p.locale},s.push(e));return p.mapMeta.translated=s.length,p.mapMeta.mapToLoad=s,App.Event.trigger("i18n:language:change")})})},e.prototype.translateInline=function(t,e){return t?this.translate(t,e,!0):t},e.prototype.translateDeep=function(n,e){return _.isArray(n)?_.map(n,(s=this,function(t){return s.translateDeep(t,e)})):_.isObject(n)?_.reduce(_.keys(n),(i=this,function(t,e){return t[e]=i.translateDeep(n[e]),t}),{}):this.translateInline(n,e);var i,s},e.prototype.translateContent=function(t,e){return t?App.Config.get("translation_inline")?'<span class="translation" contenteditable="true" title="'+App.Utils.htmlEscape(t)+'">'+App.Utils.htmlEscape(this.translate(t))+"</span>":this.translate(t,e,!0,!0):t},e.prototype.translatePlain=function(t,e){return this.translate(t,e)},e.prototype.translate=function(t,e,n,i){var s,r,o,a;if("string"!=typeof t&&t&&t.toString&&(t=t.toString()),void 0===t)return"";if(""===t)return"";if(void 0!==this.mapString[t]?(this._translated=!0,a=this.mapString[t]):(this._translated=!1,a=t,this._notTranslatedLog&&!0===App.Config.get("developer_mode")&&(this._notTranslated[this.locale]||(this._notTranslated[this.locale]={}),this._notTranslated[this.locale][t]||this.log("notice","translation for '"+t+"' in '"+this.locale+"' is missing"),this._notTranslated[this.locale][t]=!0)),n&&(a=App.Utils.htmlEscape(a)),i&&(a=a.replace(/\|\|(.+?)\|\|/gm,"<i>$1</i>").replace(/\|(.+?)\|/gm,"<b>$1</b>").replace(/_(.+?)_/gm,"<u>$1</u>").replace(/\/\/(.+?)\/\//gm,"<del>$1</del>").replace(/\xa7(.+?)\xa7/gm,"<kbd>$1</kbd>")),e)for(r=0,o=e.length;r<o;r++)s=e[r],a=a.replace(/%(s|l)/,function(t){return"%s"===t?n?App.Utils.htmlEscape(s):s:'<a href="'+s+'">\ud83d\udd17</a>'});return i&&(a=a.replace(/\[(.+?)\]\((.+?)\)/gm,'<a href="$2" target="_blank">$1</a>')),this.log("debug","translate",t,e,a),a},e.prototype.meta=function(){return this.mapMeta},e.prototype.setMap=function(t,e,n){return null==n&&(n="string"),"time"===n?""===e?delete this.mapTime[t]:this.mapTime[t]=e:""===e?delete this.mapString[t]:this.mapString[t]=e},e.prototype.notTranslatedFeatureEnabled=function(t){return"en"!==t.substr(0,2)},e.prototype.getNotTranslated=function(t){var e,n;if(n=this._notTranslated[t||this.locale],t&&t!==this.locale)return n;for(e in n)n[e],this.mapString[e]&&""!==this.mapString[e]&&delete n[e];return n},e.prototype.removeNotTranslated=function(t,e){if(this._notTranslated[t])return delete this._notTranslated[t][e]},e.prototype.setNotTranslated=function(t,e){return this._notTranslated[t]||(this._notTranslated[t]={}),this._notTranslated[t][e]=!0},e.prototype.date=function(t,e){return t?this.convert(t,e,this.mapTime.date||this.dateFormat):t},e.prototype.timestamp=function(t,e){return t?this.convert(t,e,this.mapTime.timestamp||this.timestampFormat):t},e.prototype.formatNumber=function(t,e){for(;t.toString().length<e;)t="0"+t;return t},e.prototype.convert=function(t,e,n){var i,s,r,o,a,l,c,p;return l=new Date(t),e&&(l=new Date(l.getTime()+6e4*l.getTimezoneOffset())),o=l.getDate(),a=l.getMonth()+1,c=l.getFullYear(),p=l.getYear()-100,r=l.getSeconds(),s=l.getMinutes(),i=l.getHours(),n=n.replace(/dd/,this.formatNumber(o,2)).replace(/d/,o).replace(/mm/,this.formatNumber(a,2)).replace(/m/,a).replace(/yyyy/,c).replace(/yy/,p).replace(/SS/,this.formatNumber(r,2)).replace(/MM/,this.formatNumber(s,2)).replace(/HH/,this.formatNumber(i,2))},e}(Spine.Module)}.call(this),function(){var i=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.IconPicker=function(t){function n(){var e;this.highlightItem=i(this.highlightItem,this),this.navigate=i(this.navigate,this),this.filterIcons=i(this.filterIcons,this),this.renderIcons=i(this.renderIcons,this),this.element=i(this.element,this),n.__super__.constructor.apply(this,arguments),this.throttledRenderIcons=_.throttle(this.renderIcons,300),this.render(),App.Utils.loadIconFont(this.attribute.iconset),App.Utils.loadIconFontInfo(this.attribute.iconset,(e=this,function(t){return e.library=t,e.renderIcons()}))}return e(n,t),n.prototype.library=null,n.prototype.empty=!1,n.prototype.columns=8,n.prototype.currentItem=null,n.prototype.events={"focus .js-input":"onFocus","input .js-filter-icons":"filterIcons","click .js-filter-icons":"stopPropagation","click .js-pick":"onIconClick","mouseenter .js-pick":"highlightItem","shown.bs.dropdown":"onPickerOpen","hidden.bs.dropdown":"onPickerClose","focus .js-shadow":"onShadowFocus"},n.prototype.elements={".js-iconGrid":"iconGrid",".js-noMatch":"noMatch",".js-shadow":"shadow",".js-input":"input",".js-filter-icons":"filter",".js-pick":"icons"},n.prototype.stopPropagation=function(t){return t.stopPropagation()},n.prototype.element=function(){return this.el},n.prototype.render=function(){return this.attribute.value,this.html(App.view("generic/icon_picker")({attribute:this.attribute,value:this.attribute.value}))},n.prototype.renderIcons=function(e){var n,i,t,s,r;return i=document.createDocumentFragment(),e&&(s=new RegExp(e,"i")),n=0,_.each(this.library,(r=this,function(t){if(!e||e&&(s.test(t.name)||t.filter&&_.some(t.filter,function(t){return s.test(t)})))return n++,i.appendChild($('<li class="icon js-pick" data-font="'+r.attribute.iconset+'" data-unicode="'+t.unicode+'">'+String.fromCharCode("0x"+t.unicode)+"</li>").get(0))})),n?(this.iconGrid.html(i),this.empty=!1,this.refreshElements()):(this.empty||((t=Math.floor(Math.random()*this.noMatch.length))===this.noMatch.filter(".is-active").index()&&(t=(t+1)%this.noMatch.length),this.noMatch.removeClass("is-active").eq(t).addClass("is-active")),this.empty=!0,this.iconGrid.empty())},n.prototype.filterIcons=function(t){return this.throttledRenderIcons(t.currentTarget.value)},n.prototype.onIconClick=function(t){return this.pick(t.currentTarget.getAttribute("data-unicode"))},n.prototype.pick=function(t){return this.shadow.val(t),this.input.text(String.fromCharCode("0x"+t)),this.el.closest("form").trigger("input")},n.prototype.onShadowFocus=function(){return this.input.focus()},n.prototype.onPickerOpen=function(){return this.filter.focus(),this.isOpen=!0},n.prototype.onPickerClose=function(){return this.isOpen=!1,this.filter.val(""),this.renderIcons(),$(document).off("keydown.icon_picker")},n.prototype.onFocus=function(){return $(document).on("keydown.icon_picker",this.navigate)},n.prototype.navigate=function(t){switch(t.keyCode){case 40:return this.nudge(t,0,1);case 38:return this.nudge(t,0,-1);case 39:return this.nudge(t,1);case 37:return this.nudge(t,-1);case 13:return this.onEnter(t);case 27:return this.onEscape()}},n.prototype.onEscape=function(){if(this.currentItem=null,this.isOpen)return this.toggle()},n.prototype.onEnter=function(){return this.isOpen?this.currentItem?(this.pick(this.currentItem.attr("data-unicode")),this.toggle()):void 0:this.toggle()},n.prototype.toggle=function(){return this.$('[data-toggle="dropdown"]').dropdown("toggle")},n.prototype.nudge=function(t,e,n){var i,s;if(t.preventDefault(),this.currentItem){if((s=this.currentItem.index())+(i=function(){switch(!1){case!(0<e):return 1;case!(e<0):return-1;case!(0<n):return this.columns;case!(n<0):return-this.columns}}.call(this))>=this.icons.length||s+i<0)return;s+=i,this.unhighlightCurrentItem()}else s=0;return this.currentItem=this.icons.eq(s),this.currentItem.addClass("is-active").get(0).scrollIntoView({behavior:"instant"})},n.prototype.highlightItem=function(t){return this.unhighlightCurrentItem(),this.currentItem=$(t.currentTarget),this.currentItem.addClass("is-active")},n.prototype.unhighlightCurrentItem=function(){if(this.currentItem)return this.currentItem.removeClass("is-active"),this.currentItem=null},n}(Spine.Controller)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.IconsetPicker=function(t){function e(){this.element=n(this.element,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.sets={FontAwesome:{name:"Font Awesome",version:"4.7",website:"https://fontawesome.com/v4.7.0/"},anticon:{name:"Anticon",version:"2.10",website:"https://2x.ant.design/components/icon/"},material:{name:"Material",version:"2.2.0",website:"https://material.io/icons/"},ionicons:{name:"Ionicons",version:"2.0.1",website:"https://ionicons.com/v2/"},"Simple-Line-Icons":{name:"Simple Line Icons",version:"0.0.1",website:"https://simplelineicons.github.io/"}},e.prototype.elements={".js-set":"setElements",input:"input"},e.prototype.events={"click .js-set":"pick"},e.prototype.element=function(){return this.el},e.prototype.render=function(){var t,e,n;for(t in this.html(App.view("generic/iconset_picker")({attribute:this.attribute,sets:this.sets})),n=[],e=this.sets)e[t],App.Utils.loadIconFont(t),n.push(App.Utils.loadIconFontInfo(t,this.initializePreview.bind(this,t)));return n},e.prototype.initializePreview=function(t,e){return this.sets[t].icons=e,this.renderPreview(t,e)},e.prototype.renderPreview=function(t){var e,n,i,s,r;for(e=document.createDocumentFragment(),i=_.shuffle(this.sets[t].icons),n=s=0,r=54;0<=r?s<=r:r<=s;n=0<=r?++s:--s)e.appendChild($('<i class="icon" data-font="'+t+'">'+String.fromCharCode("0x"+i[n].unicode)+"</i>").get(0));return this.el.find('[data-family="'+t+'"] .js-preview').html(e)},e.prototype.pick=function(t){var e;return e=$(t.currentTarget).attr("data-family"),this.input.val(e),this.setElements.removeClass("is-active"),t.currentTarget.classList.add("is-active")},e.prototype.flip=function(t){var e,n;return n=(e=$(t.currentTarget)).closest(".js-set").attr("data-family"),e.hasClass("do-flash")&&(e.removeClass("do-flash"),e.get(0).offsetWidth),e.text(String.fromCharCode("0x"+_.sample(this.sets[n].icons).unicode)),e.addClass("do-flash")},e}(Spine.Controller)}.call(this),function(){App.ImageService=function(){function r(){}return r.supported_types=["image/jpeg","image/png"],r.resizeForAvatar=function(t,e,n,i,s){return null==i&&(i=r.supported_types[0]),r.checkUrl(t)?s(t):r.resize(t,e,n,2,i,.7,s)},r.resizeForApp=function(t,e,n,i){return r.checkUrl(t)?i(t):r.resize(t,e,n,2,"image/png",.7,i)},r.resize=function(t,r,o,a,l,c,p,e){var u,h;return null==r&&(r="auto"),null==o&&(o="auto"),null==a&&(a=1),null==e&&(e=!0),(u=new Image).onload=(h=this,function(){var t,e,n,i,s;return n=u.width,e=u.height,console.log("ImageService","current size",n,e),console.log("ImageService","sizeFactor",a),"auto"===o&&"auto"===r&&(r=n,o=e),"auto"!==r&&n<r&&(r=n),"auto"!==o&&e<o&&(o=e),"auto"===o&&(o=e/(n/r)),"auto"===r&&(r=e/(n/o)),t=document.createElement("canvas"),s=!1,r<n&&r*a<n||o<e&&o*a<e?(s=!0,r*=a,o*=a,t.width=r,t.height=o,t.getContext("2d").drawImage(u,0,0,r,o)):(t.width=n,t.height=e,t.getContext("2d").drawImage(u,0,0,n,e)),"auto"===c&&(c=r<200&&o<200?1:r<400&&o<400?.9:r<600&&o<600?.8:r<900&&o<900?.7:.6),i=t.toDataURL(h.validateType(l),c),s?(console.log("ImageService","resize",r/a,o/a,c,.75*i.length/1024/1024,"in mb"),void p(i,r/a,o/a,!0)):(console.log("ImageService","no resize",r,o,c,.75*i.length/1024/1024,"in mb"),p(i,r,o,!1))}),u.src=t},r.checkUrl=function(t){return/\.svg$/i.test(t)},r.validateType=function(t){return-1===r.supported_types.indexOf(t)?r.supported_types[0]:t},r}()}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Run=function(t){function e(){this.start=n(this.start,this),e.__super__.constructor.apply(this,arguments),this.el=$("#app"),App.Event.trigger("app:init"),App.Browser.check()&&($(".splash").hide(),App.Collection.init(),App.Auth.loginCheck(this.start))}return i(e,t),e.prototype.start=function(){return App.WebSocket.connect(),this.frontendTimeUpdate(),this.setupWidget("Navigations","nav",this.el),this.setupWidget("Widgets","widget",this.el),App.ClipBoard.bind(this.el),App.Event.trigger("app:ready")},e.prototype.setupWidget=function(t,e,n){var i,s,r,o,a,l,c;if(App.Event.trigger(e+":init"),c=App.Config.get(t))for(s=0,o=(a=Object.keys(c).sort()).length;s<o;s++){l=c[r=a[s]];try{new l({el:n,key:r})}catch(p){i=p,this.log("error","widget "+r+":",i)}}return App.Event.trigger(e+":ready")},e}(App.Controller),App.Content=function(t){function s(){var t,e,n,i;for(n in s.__super__.constructor.apply(this,arguments),t=this.Config.get("Routes"),i=this,e=function(s,r){return i.route(s,function(t){var e,i;return this.log("debug","execute page controller",s,t),App.Event.unbindLevel("page"),App.Delay.clearLevel("page"),App.Interval.clearLevel("page"),this.el.unbind(),this.el.undelegate(),(e=App.Config.get("History"))[10]&&e.shift(),e.push("#"+t.match.input),i=this,function(t){var e;t.el=i.el;try{return new r(t)}catch(n){return e=n,i.log("error","route "+s+":",e)}}(t)})},t)e(n,t[n]);Spine.Route.setup()}return i(s,t),s.prototype.className="content flex horizontal",s}(App.ControllerWidgetPermanent),App.Config.set("content",App.Content,"Widgets")}.call(this),function(){var o,n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.Interval=function(){function t(){}var r;return r=void 0,t.set=function(t,e,n,i,s){return void 0===r&&null==r&&(r=new o),r.set(t,e,n,i,s)},t.clear=function(t,e){return void 0===r&&null==r&&(r=new o),r.clear(t,e)},t.clearLevel=function(t){return void 0===r&&null==r&&(r=new o),r.clearLevel(t)},t.reset=function(){return void 0===r&&null==r&&(r=new o),r.reset()},t.count=function(){return void 0===r&&null==r&&(r=new o),r.count()},t._all=function(){return void 0===r&&null==r&&(r=new o),r._all()},t}(),o=function(t){function e(){this._all=n(this._all,this),this.count=n(this.count,this),this.reset=n(this.reset,this),this.clearLevel=n(this.clearLevel,this),this.clear=n(this.clear,this),this.set=n(this.set,this),this.levelStack={}}return i(e,t),e.include(App.LogInclude),e.prototype.set=function(t,e,n,i,s){var r,o;return i||(i="_all"),n&&this.clear(n,i),n||(n=Math.floor(99999*Math.random())),this.log("debug","set",n,e,i,t,s),(o=function(){return s?(App.QueueManager.add("interval",t),App.QueueManager.run("interval")):t()})(),r=setInterval(o,e),this.levelStack[i]||(this.levelStack[i]={}),this.levelStack[i][n.toString()]={interval_id:r,timeout:e,level:i},n.toString()},e.prototype.clear=function(t,e){var n;if(e||(e="_all"),this.levelStack[e]&&(n=this.levelStack[e][t.toString()]))return this.log("debug","clear",n),clearInterval(n.interval_id),delete this.levelStack[e][t.toString()],_.isEmpty(this.levelStack[e])?delete this.levelStack[e]:void 0},e.prototype.clearLevel=function(t){var e,n;if(this.levelStack[t]){for(e in n=this.levelStack[t])n[e],this.clear(e,t);return delete this.levelStack[t]}},e.prototype.reset=function(){var t,e,n,i;for(n in i=this.levelStack){for(e in t=i[n])t[e],this.clear(e,n);this.levelStack[n]={}}return!0},e.prototype.count=function(){var t,e,n,i;if(!this.levelStack)return 0;for(e in t=0,i=this.levelStack)n=i[e],t+=Object.keys(n).length;return t},e.prototype._all=function(){return this.levelStack},e}(Spine.Module)}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.MultiLocales=function(t){function e(){this.parentObjectUpdated=n(this.parentObjectUpdated,this),e.__super__.constructor.apply(this,arguments),this.multiple_rows_supported=App.Config.get("kb_multi_lingual_support"),this.rows=[],this.render(),this.object&&this.listenTo(this.object,"refresh",this.parentObjectUpdated)}return i(e,t),e.prototype.events={"click .js-remove":"remove","click .js-primary":"primary","change .js-shadow":"changeOnRow"},e.prototype.parentObjectUpdated=function(){return App.Delay.set((t=this,function(){return t.attribute.value=t.object.attributes()[t.attribute.name],t.render()}));var t},e.prototype.render=function(){var t,e,n,i;if(this.html(App.view("generic/multi_locales")({attribute:this.attribute,vc:this})),Array.isArray(this.attribute.value))for(t=0,e=(i=this.attribute.value).length;t<e;t++)n=i[t],this.appendRow(this.renderRow(n,1===this.attribute.value.length));if(this.multiple_rows_supported||!Array.isArray(this.attribute.value)||0===this.attribute.value.length)return this.appendRow(this.renderRow())},e.prototype.renderRow=function(t,e){var n,i;return null==e&&(e=!1),n=App.KnowledgeBaseLocale.find(null!=t?t.id:void 0),new App.MultiLocalesRow({attribute:this.attribute,kb_locale:n,available_locales:this.selectableLocales(null!=n&&null!=(i=n.systemLocale())?i.id:void 0),solo:e})},e.prototype.selectableLocales=function(e){var n;return n=this.$(".js-shadow").toArray().map(function(t){return $(t).val()}).filter(function(t){return t&&t!==e}),App.Locale.all().filter(function(t){return!_.includes(n,String(t.id))})},e.prototype.remove=function(t){var e,n,i;if(e=$(t.currentTarget).closest("tr")[0],null==(i=_.find(this.rows,function(t){return t.el[0]===e}))||!i.primaryCheckbox.prop("checked"))return(null!=i&&null!=(n=i.kb_locale)?n.id:void 0)?i.toggleDelete():(i.el.remove(),this.rows.splice(this.rows.indexOf(i),1)),this.changeOnRow()},e.prototype.primary=function(t){var e;if(!(e=$(t.currentTarget).find("input")).attr("disabled"))return e.prop("checked",!0),this.changeOnRow()},e.prototype.changeOnRow=function(){var t,e,n,i,s,r,o,a;if(!this.hasEmptyRow()&&this.multiple_rows_supported&&this.appendRow(this.renderRow()),1===(s=this.rows.filter(function(t){return t.selector.shadowInput.val()})).length)s[0].updateButtons(!0,!0);else for(t=0,n=s.length;t<n;t++)(a=s[t]).updateButtons(!1);for(o=[],e=0,i=(r=this.rows).length;e<i;e++)a=r[e],o.push(a.updateOptions(this.selectableLocales(a.selector.shadowInput.val())));return o},e.prototype.hasEmptyRow=function(){return this.$(".js-shadow").is(function(t,e){return!$(e).val()})},e.prototype.appendRow=function(t){return this.rows.push(t),this.$("tbody").append(t.el)},e}(App.Controller)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.MultiLocalesRow=function(t){function e(){var t;e.__super__.constructor.apply(this,arguments),this.el.data("kbLocaleId",null!=(t=this.kb_locale)?t.id:void 0),this.render()}return n(e,t),e.prototype.tag="tr",e.prototype.elements={".js-primary input":"primaryCheckbox",".js-remove input":"removeButton",".js-selectorContainer":"selectorContainer"},e.prototype.events={"change .js-shadow":"change"},e.prototype.render=function(){var t,e,n,i;return this.html(App.view("generic/multi_locales_row")({attribute:this.attribute,kb_locale:this.kb_locale})),i=null!=(t=this.kb_locale)&&null!=(e=t.systemLocale())?e.id:void 0,this._updateButtons(i,this.solo,null!=(n=this.kb_locale)?n.primary:void 0),this.selector=this.localesSelectBuild(this.attribute.name,i,this.selectorContainer),this.updateOptions(this.available_locales)},e.prototype.localesSelectBuild=function(t,e,n){return new App.SearchableSelect({el:n,attribute:{name:t,value:e,"null":!1,placeholder:"Select locale...",options:[],"class":"form-control--small"}})},e.prototype.updateOptions=function(t){var e,n;return n=this.selector.shadowInput.val(),(e=t.map(function(t){return{name:t.name,value:t.id,selected:t.id+""===n}})).sort(function(t,e){return t.name.localeCompare(e.name)}),this.selector.attribute.options=e,this.selector.render()},e.prototype.updateButtons=function(t,e){return null==e&&(e=void 0),void 0===e&&(e=this.primaryCheckbox[0].checked),this._updateButtons(this.selector.shadowInput.val(),t,e)},e.prototype._updateButtons=function(t,e,n){var i;return i=this.el.hasClass("settings-list--deleted"),this.removeButton.attr("disabled",e||!t||n),this.primaryCheckbox.attr("disabled",e||!t||i),this.primaryCheckbox.prop("checked",n)},e.prototype.change=function(){return this.primaryCheckbox.attr("value",this.selector.shadowInput.val())},e.prototype.toggleDelete=function(){return this.el.toggleClass("settings-list--deleted"),this.removeButton.prop("checked",this.el.hasClass("settings-list--deleted")),this.selector.el.toggleClass("u-unclickable")},e}(App.Controller)}.call(this),function(){var e,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.event="ticket_overview_index",e.prototype.restEndpoint="/ticket_overviews",e}(App._CollectionSingletonBase),App.OverviewIndexCollection=function(){function t(){}var n;return n=new e,t.get=function(){return n.get()},t.one=function(t,e){return null==e&&(e=!0),n.bind(t,e,!0)},t.bind=function(t,e){return null==e&&(e=!0),n.bind(t,e,!1)},t.unbind=function(t){return n.unbind(t)},t.unbindById=function(t){return n.unbindById(t)},t.trigger=function(){return n.trigger()},t.fetch=function(){return n.fetch()},t}()}.call(this),function(){var s,i=function(t,e){return function(){return t.apply(e,arguments)}};s=function(){function t(){var e,n;this.clear=i(this.clear,this),this.callback=i(this.callback,this),this.trigger=i(this.trigger,this),this.fetch=i(this.fetch,this),this.overview={},this.callbacks={},this.fetchActive={},this.counter=0,App.Event.bind("ticket_overview_list",(e=this,function(t){return t.assets&&(App.Collection.loadAssets(t.assets),delete t.assets),e.overview[t.overview.view]||(e.overview[t.overview.view]={}),e.overview[t.overview.view]=t,e.callback(t.overview.view,t)})),App.Event.bind("auth:logout",(n=this,function(t){return n.clear(t)}))}return t.prototype.get=function(t){return this.overview[t]},t.prototype.bind=function(t,e,n){return null==n&&(n=!0),this.counter+=1,this.callbacks[this.counter]={view:t,callback:e},n&&(void 0===this.overview[t]?this.fetch(t):this.callback(t,this.overview[t])),this.counter},t.prototype.unbind=function(t){return delete this.callbacks[t]},t.prototype.fetch=function(e){if(!e)throw"No view to fetch list!";var t,n;if(App.OverviewIndexCollection.fetch(),!this.fetchActive[e])return this.fetchActive[e]=!0,App.Ajax.request({id:"ticket_overview_"+e,type:"GET",url:App.Config.get("api_path")+"/ticket_overviews",data:{view:e},processData:!0,success:(n=this,function(t){return n.fetchActive[e]=!1,t.assets&&(App.Collection.loadAssets(t.assets),delete t.assets),t.index&&t.index.overview&&(n.overview[t.index.overview.view]=t.index),n.callback(e,t.index)}),error:(t=this,function(){return t.fetchActive[e]=!1})})},t.prototype.trigger=function(t){return this.callback(t,this.get(t))},t.prototype.callback=function(t,e){var n,i,s,r,o;for(i in o=[],r=this.callbacks)(s=r[i]).view===t?(n=function(){return s.callback(e)},App.QueueManager.add("ticket_overviews",n),o.push(App.QueueManager.run("ticket_overviews"))):o.push(void 0);return o},t.prototype.clear=function(){return this.overview={},this.callbacks={},this.fetchActive={},this.counter=0},t}(),App.OverviewListCollection=function(){function t(){}var i;return i=new s,t.get=function(t){return void 0===i&&null==i&&(i=new s),i.get(t)},t.bind=function(t,e,n){return void 0===i&&null==i&&(i=new s),i.bind(t,e,n)},t.unbind=function(t){return void 0===i&&null==i&&(i=new s),i.unbind(t)},t.fetch=function(t){return void 0===i&&null==i&&(i=new s),i.fetch(t)},t.trigger=function(t){return void 0===i&&null==i&&(i=new s),i.trigger(t)},t}()}.call(this),function(){App.PopoverProvider=function(){function t(t){if(null===t.parentController)throw"Parent controller needs to be set";this.params=_.extend({},this.constructor.defaults,t)}return t.selectorCssClassPrefix=null,t.templateName=null,t.permission="ticket.agent",t.providersConfigKey="PopoverProviders",t.registerProvider=function(t,e){return this.providers||(this.providers={}),this.providers[t]=e,App.Config.set(t,e,this.providersConfigKey)},t.defaults={position:"right",parentController:null},null,t.prototype.build=function(){if(this.checkPermissions())return this.clear(this.popovers),this.bind(),this.popovers=this.buildPopovers()},t.prototype.checkPermissions=function(){return this.params.parentController.permissionCheck(this.constructor.permission)},t.prototype.cssClass=function(){return this.constructor.selectorCssClassPrefix+"-popover"},t.prototype.bind=function(){},t.prototype.buildPopovers=function(t){var e,n;return null==t&&(t={}),e=this,n=t.selector||"."+this.cssClass(),this.params.parentController.el.find(n).popover({trigger:"hover",container:"body",html:!0,animation:!1,delay:100,placement:"auto "+this.params.position,title:function(){return e.buildTitleFor(this,t)},content:function(){return e.buildContentFor(this,t)}})},t.prototype.clear=function(){if(this.popovers)return this.popovers.popover("destroy")},t.prototype.buildTitleFor=function(){return"title"},t.prototype.buildContentFor=function(){return"content"},t.prototype.buildHtmlContent=function(t){var e,n;return(e=$(App.view("popover/"+this.constructor.templateName)(t))).find(".humanTimeFromNow").each((n=this,function(){return n.params.parentController.frontendTimeUpdateItem($(n))})),e},t.prototype.displayTitleUsing=function(){throw"please override"},t}()}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SingleObjectPopoverProvider=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.klass=null,e.ignoredAttributes=[],e.includeData=!0,e.templateName="single_object_generic",e.prototype.fullCssSelector=function(){return"div."+this.cssClass()+", span."+this.cssClass()},e.prototype.bind=function(){return this.params.parentController.$(this.fullCssSelector()).bind("click",(i=this,function(t){var e,n;if(e=i.objectIdFor(t.target))return n=i.constructor.klass.find(e),i.params.parentController.navigate(n.uiUrl())}));var i},e.prototype.objectIdFor=function(t){return $(t).data("id")},e.prototype.buildTitleFor=function(t){var e;return e=this.constructor.klass.find(this.objectIdFor(t)),App.Utils.htmlEscape(this.displayTitleUsing(e))},e.prototype.buildContentFor=function(t){var e,n,i;return n=this.objectIdFor(t),i=this.constructor.klass.fullLocal(n),e=_.values(this.constructor.klass.attributesGet("view")).filter(function(t){var e,n;return(n=(e=t.name).substr(0,e.length-3))in i&&(e=n),i[e]&&t.shown&&!_.include(this.constructor.ignoredAttributes,e)}),this.buildHtmlContent({object:i,attributes:e})},e}(App.PopoverProvider)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.KbPopoverProvider=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.templateName="kb_generic",e.includeData=!1,e.prototype.displayTitleUsing=function(t){return t.title},e}(App.SingleObjectPopoverProvider)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.klass=App.KnowledgeBaseAnswerTranslation,e.selectorCssClassPrefix="kb-answer",e}(App.KbPopoverProvider),App.PopoverProvider.registerProvider("KnowledgeBaseAnswer",t)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.klass=App.KnowledgeBaseCategoryTranslation,e.selectorCssClassPrefix="kb-category",e}(App.KbPopoverProvider),App.PopoverProvider.registerProvider("KnowledgeBaseCategory",t)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.klass=App.KnowledgeBaseTranslation,e.selectorCssClassPrefix="kb",e}(App.KbPopoverProvider),App.PopoverProvider.registerProvider("KnowledgeBase",t)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.klass=App.Organization,e.selectorCssClassPrefix="organization",e.templateName="organization",e.ignoredAttributes=["name"],e.prototype.displayTitleUsing=function(t){return t.name},e}(App.SingleObjectPopoverProvider),App.PopoverProvider.registerProvider("Organization",t)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.klass=App.Ticket,e.selectorCssClassPrefix="ticket",e.templateName="ticket",e.includeData=!1,e.prototype.displayTitleUsing=function(t){return t.title},e}(App.SingleObjectPopoverProvider),App.PopoverProvider.registerProvider("Ticket",t)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.klass=App.User,e.selectorCssClassPrefix="user",e.templateName="user",e.ignoredAttributes=["firstname","lastname","organization"],e.prototype.displayTitleUsing=function(t){var e;return e=t.displayName(),t.isOutOfOffice()&&(e+=" ("+t.outOfOfficeText()+")"),e},e}(App.SingleObjectPopoverProvider),App.PopoverProvider.registerProvider("User",t)}.call(this),function(){var n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.UserTicketPopoverProvider=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.templateName="user_ticket_list",e.prototype.fetch=function(n){return this.params.parentController.ajax({type:"GET",url:App.Config.get("api_path")+"/ticket_customer",data:{customer_id:n.user_id},processData:!0,success:(i=this,function(t){var e;return App.Collection.loadAssets(t.assets),e={open:t.ticket_ids_open,closed:t.ticket_ids_closed},i.callback({ticketsList:e,selector:n.selector})})});var i},e.prototype.build=function(t){if(this.checkPermissions())return this.fetch(t)},e.prototype.callback=function(t){return this.clear(this.popovers),this.popovers=this.buildPopovers(t)},e.prototype.buildTitleFor=function(t){return $(t).find('[title="*"]').val()},e.prototype.buildContentFor=function(t,e){var n,i;return i=$(t).filter("[data-type]").data("type"),n=(e.ticketsList[i]||[]).map(function(t){return App.Ticket.fullLocal(t)}),this.buildHtmlContent({tickets:n})},e}(App.PopoverProvider)}.call(this),function(){App.PrettyDate=function(){function t(){}return t.humanTime=function(t,e,n,i){var s
,r,o,a,l,c,p,u,h,d;return null==n&&(n=!0),null==i&&(i=void 0),t?(a=((o=new Date)-(r=new Date(t)))/1e3,"",e&&(0<a&&"-",0<=a?u='class="label label-danger"':-3600<a&&(u='class="label label-warning"')),l="future",-1<a&&(l="past"),a.toString().match("-")&&(a=a.toString().replace("-",""),a=parseFloat(a)),a<60?App.i18n.translateInline("just now"):(void 0===i&&window.App&&window.App.Config&&(i=window.App.Config.get("pretty_date_format")),"timestamp"===i?(p=App.i18n.translateTimestamp(t),e&&(p="<span "+u+">"+p+"</span>"),p):"absolute"!==i||"past"!==l&&"future"!==l?"past"===l&&!e&&604800<a?App.i18n.translateDate(t):(p="",s=0,86400<=a&&(s++,p=(h=Math.floor(a/86400))+" "+(n?1<h||0===h?App.i18n.translateInline("days"):App.i18n.translateInline("day"):App.i18n.translateInline("d")),a-=86400*h,9<=h||a<3600||2===s)||3600<=a&&(s++,""!==p&&(p+=" "),p=p+(h=Math.floor(a/3600%24))+" "+(n?1<h||0===h?App.i18n.translateInline("hours"):App.i18n.translateInline("hour"):App.i18n.translateInline("h")),a-=3600*h,9<=h||a<60||2===s)||(""!==p&&(p+=" "),p=p+(h=Math.floor(a/60%60))+" "+(n?1<h||0===h?App.i18n.translateInline("minutes"):App.i18n.translateInline("minute"):App.i18n.translateInline("m"))),p="past"===l?App.i18n.translateInline("%s ago",p):App.i18n.translateInline("in %s",p),e&&(p="<span "+u+">"+p+"</span>"),p):(d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][r.getDay()],c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r.getMonth()],p=a<518400?App.i18n.translateInline(d)+" "+r.getHours()+":"+this.s(r.getMinutes(),2):r.getYear()===o.getYear()?App.i18n.translateInline(d)+" "+r.getDate()+". "+App.i18n.translateInline(c)+" "+r.getHours()+":"+this.s(r.getMinutes(),2):App.i18n.translateInline(d)+" "+App.i18n.translateTimestamp(t),e&&(p="<span "+u+">"+p+"</span>"),p))):""},t.s=function(t,e){for(;t.toString().length<e;)t="0"+t;return t},t}()}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SearchableSelect=function(t){function e(){this.highlightItem=n(this.highlightItem,this),this.onInput=n(this.onInput,this),this.navigate=n(this.navigate,this),this.toggle=n(this.toggle,this),this.onKeyUp=n(this.onKeyUp,this),this.onDropdownHidden=n(this.onDropdownHidden,this),this.onDropdownShown=n(this.onDropdownShown,this),this.element=n(this.element,this),e.__super__.constructor.apply(this,arguments),this.render()}return i(e,t),e.prototype.events={"input .js-input":"onInput","blur .js-input":"onBlur","focus .js-input":"onFocus","focus .js-shadow":"onShadowFocus","change .js-shadow":"onShadowChange","click .js-option":"selectItem","click .js-enter":"navigateIn","click .js-back":"navigateOut","mouseenter .js-option":"highlightItem","mouseenter .js-enter":"highlightItem","mouseenter .js-back":"highlightItem","shown.bs.dropdown":"onDropdownShown","hidden.bs.dropdown":"onDropdownHidden","keyup .js-input":"onKeyUp"},e.prototype.elements={".js-dropdown":"dropdown",".js-option, .js-enter":"optionItems",".js-input":"input",".js-shadow":"shadowInput",".js-optionsList":"optionsList",".js-optionsSubmenu":"optionsSubmenu",".js-autocomplete-invisible":"invisiblePart",".js-autocomplete-visible":"visiblePart"},e.prototype.className="searchableSelect dropdown dropdown--actions",e.prototype.element=function(){return this.el},e.prototype.render=function(){return this.updateAttributeValueName(),this.html(App.view("generic/searchable_select")({attribute:this.attribute,options:this.renderAllOptions("",this.attribute.options,0),submenus:this.renderSubmenus(this.attribute.options)})),this.currentMenu=this.findMenuContainingValue(this.attribute.value),this.level=this.getIndex(this.currentMenu)},e.prototype.renderSubmenus=function(t){var e,n,i,s;if(e="",t)for(n=0,i=t.length;n<i;n++)(s=t[n]).children&&(e+=App.view("generic/searchable_select_submenu")({options:this.renderOptions(s.children),parentValue:s.value,title:s.name}),this.hasSubmenu(s.children)&&(e+=this.renderSubmenus(s.children)));return e},e.prototype.updateAttributeValueName=function(){var t;return(t=_.find(this.attribute.options,function(t){return t.selected}))?(this.attribute.valueName=t.name,this.attribute.value=t.value):this.attribute.unknown&&this.attribute.value?this.attribute.valueName=this.attribute.value:this.hasSubmenu(this.attribute.options)?this.attribute.valueName=this.getName(this.attribute.value,this.attribute.options):void 0},e.prototype.hasSubmenu=function(t){var e,n;if(!t)return!1;for(e=0,n=t.length;e<n;e++)if(t[e].children)return!0;return!1},e.prototype.getName=function(t,e){var n,i,s,r;for(n=0,i=e.length;n<i;n++){if((r=e[n]).value===t)return r.name;if(r.children&&void 0!==(s=this.getName(t,r.children)))return s}},e.prototype.renderOptions=function(t){var e,n,i,s;for(e="",n=0,i=t.length;n<i;n++)s=t[n],e+=App.view("generic/searchable_select_option")({option:s,"class":s.children?"js-enter":"js-option"});return e},e.prototype.renderAllOptions=function(t,e,n){var i,s,r,o,a;if(s="",e)for(r=0,o=e.length;r<o;r++)i=(a=e[r]).children?"js-enter":"js-option",n&&0<n&&(i+=" is-hidden is-child"),s+=App.view("generic/searchable_select_option")({option:a,"class":i,detail:t}),a.children&&(s+=this.renderAllOptions(t+" \u2014 "+a.name,a.children,n+1));return s},e.prototype.onDropdownShown=function(){return this.input.on("click",this.stopPropagation),this.highlightFirst(),0<this.level&&this.showSubmenu(this.currentMenu),this.isOpen=!0},e.prototype.onDropdownHidden=function(){if(this.input.off("click",this.stopPropagation),this.unhighlightCurrentItem(),this.isOpen=!1,!this.input.val())return this.updateAttributeValueName(),this.input.val(this.attribute.valueName)},e.prototype.onKeyUp=function(){if(""===this.input.val().trim())return this.shadowInput.val("")},e.prototype.toggle=function(){return this.currentItem=null,this.$('[data-toggle="dropdown"]').dropdown("toggle")},e.prototype.stopPropagation=function(t){return t.stopPropagation()},e.prototype.navigate=function(t){switch(t.keyCode){case 40:return this.nudge(t,1);case 38:return this.nudge(t,-1);case 39:return this.autocompleteOrNavigateIn(t);case 37:return this.autocompleteOrNavigateOut(t);case 13:return this.onEnter(t);case 27:return this.onEscape(t);case 9:return this.onTab(t)}},e.prototype.onEscape=function(){if(this.isOpen)return event.stopPropagation(),this.toggle()},e.prototype.getCurrentOptions=function(){return this.currentMenu.find(".js-option, .js-enter, .js-back")},e.prototype.getOptionIndex=function(t,e){return t.find(".js-option, .js-enter").filter('[data-value="'+e+'"]').index()},e.prototype.nudge=function(t,e){var n,i,s,r;return this.isOpen?(s=this.getCurrentOptions(),t.preventDefault(),r=s.not(".is-hidden"),i=s.filter(".is-active"),n=r.index(i),(n+=e)<0||n>r.size()-1?void 0:(this.unhighlightCurrentItem(),this.currentItem=r.eq(n),this.currentItem.addClass("is-active"),this.clearAutocomplete())):this.toggle()},e.prototype.autocompleteOrNavigateIn=function(t){return this.currentItem.hasClass("js-enter")?this.navigateIn(t):this.fillWithAutocompleteSuggestion(t)},e.prototype.autocompleteOrNavigateOut=function(t){return 0!==this.level?this.navigateOut(t):this.fillWithAutocompleteSuggestion(t)},e.prototype.fillWithAutocompleteSuggestion=function(t){var e;if(this.suggestion)return e=39===t.keyCode?this.suggestion.length:this.invisiblePart.text().length+1,this.input.val(this.suggestion),this.shadowInput.val(this.suggestionValue),this.clearAutocomplete(),this.toggle(),this.input.prop("selectionStart",e),this.input.prop("selectionEnd",e)},e.prototype.autocomplete=function(t,e){var n;return this.suggestion=e,this.suggestionValue=t,n=e.indexOf(this.query),this.query&&0===n?(this.invisiblePart.text(this.query),this.visiblePart.text(e.slice(this.query.length))):this.clearAutocomplete()},e.prototype.clearAutocomplete=function(){return this.suggestion=null,this.visiblePart.text(""),this.invisiblePart.text("")},e.prototype.selectItem=function(t){if(t.currentTarget.textContent)return this.input.val(t.currentTarget.textContent.trim()),this.input.trigger("change"),this.shadowInput.val(t.currentTarget.getAttribute("data-value")),this.shadowInput.trigger("change")},e.prototype.navigateIn=function(t){return t.stopPropagation(),this.selectItem(t),this.navigateDepth(1)},e.prototype.navigateOut=function(t){return t.stopPropagation(),this.navigateDepth(-1)},e.prototype.navigateDepth=function(t){var e,n;if(!this.animating)return 0<t?(e=this.currentItem.attr("data-value"),n=this.optionsSubmenu.filter('[data-parent-value="'+e+'"]')):n=this.findMenuContainingValue(this.currentMenu.attr("data-parent-value")),this.animateToSubmenu(n,t),this.level+=t},e.prototype.animateToSubmenu=function(t,e){var n,i,s,r;return this.animating=!0,t.prop("hidden",!1),this.dropdown.height(Math.max(t.height(),this.currentMenu.height())),n=this.currentItem,this.currentMenu.data("current_item_index",this.currentItem.index()),i=t.data("current_item_index")||1,-1===e&&(s=this.currentMenu.attr("data-parent-value"),i=this.getOptionIndex(t,s)),this.currentItem=t.children().eq(i),this.currentItem.addClass("is-active"),t.velocity({properties:{translateX:[0,100*e+"%"]},options:{duration:240}}),this.currentMenu.velocity({properties:{translateX:[-100*e+"%",0]},options:{duration:240,complete:(r=this,function(){return n.removeClass("is-active"),$.Velocity.hook(r.currentMenu,"translateX",""),r.currentMenu.prop("hidden",!0),r.dropdown.height(t.height()),r.currentMenu=t,r.animating=!1})}})},e.prototype.showSubmenu=function(t){return this.currentMenu.prop("hidden",!0),t.prop("hidden",!1),this.dropdown.height(t.height())},e.prototype.findMenuContainingValue=function(t){var e;return t?(!t.split&&t.toString&&(t=t.toString()),1===(e=t.split("::")).length?this.optionsList:(e.pop(),this.optionsSubmenu.filter('[data-parent-value="'+e.join("::")+'"]'))):this.optionsList},e.prototype.getIndex=function(t){var e;return(e=t.attr("data-parent-value"))?e.split("::").length:0},e.prototype.onTab=function(t){if(this.isOpen)return t.preventDefault()},e.prototype.onEnter=function(t){var e,n;return this.currentItem&&this.currentItem.hasClass("js-back")?this.navigateOut(t):(this.clearAutocomplete(),this.isOpen?(t.preventDefault(),!this.currentItem&&this.attribute.unknown||(n=this.currentItem.text().trim(),e=this.currentItem.attr("data-value"),this.input.val(n),this.shadowInput.val(e)),this.input.trigger("change"),this.shadowInput.trigger("change"),this.currentItem&&this.currentItem.hasClass("js-enter")?(this.navigateIn(t),void(this.currentItem=null)):(this.currentItem=null,this.toggle())):void(""===this.shadowInput.val()?(t.preventDefault(),this.toggle()):(this.trigger("enter"),this.el.trigger("enter"))))},e.prototype.onBlur=function(){return this.clearAutocomplete(),this.input.off("keydown.searchable_select")},e.prototype.onFocus=function(){var t;return this.input.on("keydown.searchable_select",this.navigate),t=this.input.val().length,this.input.prop("selectionStart",t),this.input.prop("selectionEnd",t)},e.prototype.onShadowFocus=function(){return this.input.focus()},e.prototype.onShadowChange=function(){var t,e,n,i,s,r;if(r=this.shadowInput.val(),Array.isArray(this.attribute.options)){for(s=[],t=0,e=(i=this.attribute.options).length;t<e;t++)n=i[t],s.push(n.selected=n.value+""===r);return s}},e.prototype.onInput=function(){if(this.isOpen||this.toggle(),this.query=this.input.val(),this.filterByQuery(this.query),this.attribute.unknown)return this.shadowInput.val(this.query)},e.prototype.filterByQuery=function(t){var e;return t=escapeRegExp(t),e=new RegExp(t.split(" ").join(".*"),"i"),this.optionsList.addClass("is-filtered"),this.optionItems.addClass("is-hidden").filter(function(){return this.textContent.match(e)}).removeClass("is-hidden"),t||this.optionItems.filter(".is-child").addClass("is-hidden"),this.attribute.unknown&&this.optionItems.length===this.optionItems.filter(".is-hidden").length?(this.optionItems.not(".is-child").removeClass("is-hidden"),this.unhighlightCurrentItem(),this.optionsList.removeClass("is-filtered")):this.highlightFirst(!0)},e.prototype.highlightFirst=function(t){if(this.unhighlightCurrentItem(),this.currentItem=this.getCurrentOptions().not(".is-hidden").first(),this.currentItem.addClass("is-active"),t)return this.autocomplete(this.currentItem.attr("data-value"),this.currentItem.text().trim())},e.prototype.highlightItem=function(t){return this.unhighlightCurrentItem(),this.currentItem=$(t.currentTarget),this.currentItem.addClass("is-active")},e.prototype.unhighlightCurrentItem=function(){if(this.currentItem)return this.currentItem.removeClass("is-active"),this.currentItem=null},e}(Spine.Controller)}.call(this),function(){var e,i=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;App.TaskManager=function(){function t(){}var n;return n=void 0,t.init=function(t){if(null==t&&(t={}),!t.force)return null!=n?n:n=new e(t);n=new e(t)},t.all=function(){return n.all()},t.allWithMeta=function(){return n?n.allWithMeta():[]},t.execute=function(t){if(n)return n.execute(t)},t.get=function(t){if(n)return n.get(t)},t.update=function(t,e){if(n)return n.update(t,e)},t.remove=function(t){if(n)return n.remove(t)},t.notify=function(t){if(n)return n.notify(t)},t.mute=function(t){if(n)return n.mute(t)},t.reorder=function(t){if(n)return n.reorder(t)},t.touch=function(t){if(n)return n.touch(t)},t.reset=function(){if(n)return n.reset()},t.tasksInitial=function(){return void 0===n&&null==n&&(n=new e),n.tasksInitial()},t.worker=function(t){if(n)return n.worker(t)},t.ensureWorker=function(t,e){if(n)return n.ensureWorker(t,e)},t.nextTaskUrl=function(){if(n)return n.nextTaskUrl()},t.TaskbarId=function(){if(n)return n.TaskbarId()},t.hideAll=function(){if(n)return n.showControllerHideOthers()},t.preferencesSubscribe=function(t,e){if(n)return n.preferencesSubscribe(t,e)},t.preferencesUnsubscribe=function(t){if(n)return n.preferencesUnsubscribe(t)},t.preferencesTrigger=function(t){if(n)return n.preferencesTrigger(t)},t.tasksAutoCleanupDelayTime=function(t){if(n)return t?n.tasksAutoCleanupDelayTime=t:n.tasksAutoCleanupDelayTime},t.tasksAutoCleanupTaskMax=function(t){if(n)return t?n.maxTaskCount=t:n.maxTaskCount},t}(),e=function(t){function n(t){var e;null==t&&(t={}),this.preferencesTrigger=i(this.preferencesTrigger,this),this.preferencesUnsubscribe=i(this.preferencesUnsubscribe,this),this.preferencesSubscribe=i(this.preferencesSubscribe,this),this.tasksInitial=i(this.tasksInitial,this),this.tasksAutoCleanup=i(this.tasksAutoCleanup,this),this.tasksAutoCleanupDelay=i(this.tasksAutoCleanupDelay,this),this.taskUpdateLoop=i(this.taskUpdateLoop,this),this.taskUpdateTrigger=i(this.taskUpdateTrigger,this),this.TaskbarId=i(this.TaskbarId,this),this.nextTaskUrl=i(this.nextTaskUrl,this),this.reset=i(this.reset,this),this.release=i(this.release,this),this.reorder=i(this.reorder,this),this.mute=i(this.mute,this),this.notify=i(this.notify,this),this.remove=i(this.remove,this),this.update=i(this.update,this),this.getWithMeta=i(this.getWithMeta,this),this.get=i(this.get,this),this.hide=i(this.hide,this),this.show=i(this.show,this),this.showControllerHideOthers=i(this.showControllerHideOthers,this),this.startController=i(this.startController,this),this.ensureWorker=i(this.ensureWorker,this),n.__super__.constructor.apply(this,arguments),t.el?this.el=t.el:this.el=$("#app"),this.offlineModus=t.offlineModus,this.tasksInitial(),this.bind("taskbar:preferences",(e=this,function(t){return e.tasksPreferences[t.key]=t.preferences,e.preferencesTrigger(t.key)}))}return s(n,t),n.extend(App.PopoverProvidable),n.include(App.LogInclude),n.prototype.init=function(){return this.domStore={},this.shownStore={},this.workers={},this.allTasksByKey={},this.tasksToUpdate={},this.tasksPreferences={},this.tasksPreferencesCallbacks={},this.tasksAutoCleanupDelayTime=12e3,this.activeTaskHistory=[],this.queue=[],this.queueRunning=!1,this.maxTaskCount=30},n.prototype.all=function(){var t,e,n,i;for(e in t=[],n=this.allTasksByKey)i=n[e],t.push(i);return _.sortBy(t,function(t){return t.prio})},n.prototype.allWithMeta=function(){var t,e,n,i;for(e=0,n=(t=this.all()).length;e<n;e++)i=t[e],i=this.getMeta(i);return t},n.prototype.getMeta=function(t){var e,n,i,s,r;if(i={url:"#",id:!1,iconClass:"loading",title:App.i18n.translateInline("Loading..."),head:App.i18n.translateInline("Loading...")},(r=App.TaskManager.worker(t.key))&&r.meta&&(e=r.meta(t)))for(n in e)s=e[n],i[n]=s;return t.meta=i,t},n.prototype.newPrio=function(){var t,e,n,i,s;for(n=1,t=0,e=(i=this.all()).length;t<e;t++)(s=i[t]).prio&&s.prio>n&&(n=s.prio);return++n},n.prototype.domID=function(t){return"content_permanent_"+t},n.prototype.worker=function(t){if(this.workers[t])return this.workers[t]},n.prototype.ensureWorker=function(t,e){var n,i;{if(!(n=this.worker(t)))return this.one("TaskManager::"+t+"::WorkerStarted",(i=this,function(){return i.ensureWorker(t,e),!0}));e(n)}},n.prototype.execute=function(t){return this.queue.push(t),this.run()},n.prototype.run=function(){var t,e,n;if(this.queue[0]&&!this.queueRunning){for(this.queueRunning=!0,n=[];;){e=this.queue.shift();try{this.executeSingel(e)}catch(i){t=i,this.log("error","executeSingel task:",e.key,t)}if(!this.queue[0]){this.queueRunning=!1;break}n.push(void 0)}return n}},n.prototype.executeSingel=function(n){var t,e,i,s,r;if(n.key=App.Utils.htmlAttributeCleanup(n.key),!n.init||!this.workers[n.key]){if(n.init&&(n.params.init=!0),n.params&&(n.show?n.params.shown=!0:delete n.params.shown),n.show&&this.activeTaskHistory.push(_.clone(n)),(s=this.get(n.key))||this.workers[n.key]||n.persistent||((s=new App.Taskbar).load({key:n.key,params:n.params,callback:n.controller,client_id:123,prio:this.newPrio(),notify:!1,active:n.show}),this.allTasksByKey[n.key]=s.attributes(),this.touch(n.key),(r=this).tasksToUpdate[n.key]="inCreate",s.save({done:function(){var t,e;for(e in"inCreate"===r.tasksToUpdate[n.key]&&delete r.tasksToUpdate[n.key],r.allTasksByKey[n.key]=this.attributes(),r.tasksPreferences[n.key]=clone(this.preferences),r.preferencesTrigger(n.key),t=[],r.allTasks)r.allTasks[e]&&r.allTasks[e].key===this.key?(s=this.attributes(),t.push(r.allTasks[e]=s)):t.push(void 0);return t},fail:function(){if("inCreate"===r.tasksToUpdate[n.key])return delete r.tasksToUpdate[n.key]}})),n.show&&this.$("#content").empty(),n.show)for(e in i=this.allTasksByKey)s=i[e],e!==n.key?s.active&&(s.active=!1,this.taskUpdate(s)):(t=!1,s.active||(t=!0,s.active=!0),s.notify&&(t=!0,s.notify=!1),t&&this.taskUpdate(s));return this.startController(n)}},n.prototype.startController=function(t){var e,n,i,s;return this.log("debug","controller start try...",t),s=_.clone(t.params),e=this.domID(t.key),(n=this.domStore[e])?i=n.el:(i=$('<div id="'+e+'" class="content horizontal flex"></div>'),this.domStore[e]={el:i}),s.el=i,s.task_key=t.key,s.taskKey=t.key,t.show||(s.doNotLog=1),this.workers[t.key]||(this.workers[t.key]=new App[t.controller](s),App.Event.trigger("TaskManager::"+t.key+"::WorkerStarted")),t.show?this.showControllerHideOthers(t.key,s):this.hide(t.key),this.tasksAutoCleanupDelay()},n.prototype.showControllerHideOthers=function(t,e){var n,i;for(n in this.workers)n!==t&&!1!==this.shownStore[n]&&this.hide(n);for(n in this.$("#content").addClass("hide"),i=[],this.workers)n===t?i.push(this.show(n,e)):i.push(void 0);return i},n.prototype.show=function(t,e){var n,i,s;return n=this.workers[t],this.shownStore[t]=!0,this.preferencesTrigger(t),i=this.domID(t),s=this.domStore[i],!this.$("#"+i).get(0)&&s&&s.el?(this.frontendTimeUpdateElement(s.el),this.el.append(s.el),this.$("#"+i).removeClass("hide").addClass("active"),n&&s.position&&n.setPosition(s.position)):this.$("#"+i).removeClass("hide").addClass("active"),n&&(n.active&&_.isFunction(n.active)&&n.active(!0),n.show&&_.isFunction(n.show)&&n.show(e)),!0},n.prototype.hide=function(t){var e,n,i,s,r;return e=this.workers[t],this.shownStore[t]=!1,(s=this.$("#"+this.domID(t))).get(0)&&(n=this.domID(t),i=this.domStore[n],e&&_.isFunction(e.currentPosition)?(r=e.currentPosition(),i.position=r,s.addClass("hide").removeClass("active"),i.el=s.detach()):s.addClass("hide").removeClass("active")),!!e&&(e.active&&_.isFunction(e.active)&&e.active(!1),e.hide&&_.isFunction(e.hide)&&e.hide(),this.delayedRemoveAnyPopover(),!0)},n.prototype.get=function(t){return this.allTasksByKey[t]},n.prototype.getWithMeta=function(t){var e;if(e=this.get(t))return this.getMeta(e)},n.prototype.update=function(t,e){var n,i,s,r;if(!(s=this.get(t)))throw"No such task with '"+t+"' to update";for(n in e)r=e[n],s[n]=r;return i=!1,1===Object.keys(e).length&&e.state&&(i=!0),this.taskUpdate(s,i)},n.prototype.remove=function(t){var e;if(e=this.allTasksByKey[t],delete this.allTasksByKey[t],e)return App.Event.trigger("taskRemove",[e]),this.taskDestroy(e),this.release(t)},n.prototype.notify=function(t){var e;if(!(e=this.get(t)))throw"No such task with '"+t+"' to notify";if(!e.notify)return e.notify=!0,this.taskUpdate(e)},n.prototype.mute=function(t){var e;if(!(e=this.get(t)))throw"No such task with '"+t+"' to mute";if(e.notify)return e.notify=!1,this.taskUpdate(e)},n.prototype.reorder=function(t){var e,n,i,s,r;for(e=s=0,i=t.length;e<i;e++){if(n=t[e],!(r=this.get(n)))throw"No such task with '"+n+"' of order";s++,r.prio!==s&&(r.prio=s,this.taskUpdate(r,!0))}return App.Event.trigger("taskCollectionOrderSet",t)},n.prototype.release=function(t){var e,n,i;e=this.domID(t),(i=this.domStore[e])&&(i.el&&($("#app").append('<div id="'+e+'_trash" class="hide"></div>'),$("#app #"+e+"_trash").append(i.el).remove(),i.el=void 0),i=void 0),delete this.domStore[this.domID(t)],this.workers[t],delete this.workers[t],delete this.tasksPreferences[t];try{return(n=this.$("#"+this.domID(t))).html(""),n.remove()}catch(s){return this.log("notice","invalid key '"+t+"'")}},n.prototype.reset=function(){var t,e,n;for(t in e=this.allTasksByKey)e[t],this.release(t);for(t in n=this.workers)n[t],this.release(t);return this.init(),App.Taskbar.deleteAll(),App.Event.trigger("taskInit")},n.prototype.nextTaskUrl=function(){for(var t,e,n,i;(e=this.activeTaskHistory.pop())&&e.key;)if((t=this.workers[e.key])&&t.url)return t.url();return!!((n=(i=this.all())[i.length-1])&&(t=this.workers[n.key])&&t.url)&&t.url()},n.prototype.TaskbarId=function(){return this.TaskbarIdInt||(this.TaskbarIdInt=Math.floor(99999999*Math.random())),this.TaskbarIdInt},n.prototype.taskUpdate=function(t,e){if(null==e&&(e=!1),this.log("debug","UPDATE task",t,e),"inCreate"!==this.tasksToUpdate[t.key]&&(this.tasksToUpdate[t.key]="toUpdate",this.taskUpdateTrigger(),!e))return this.touch(t.key)},n.prototype.touch=function(e){var t,n;return n=this,t=function(){var t;if(t=n.getWithMeta(e))return t.active&&t.meta&&n.title(t.meta.title),App.Event.trigger("taskUpdate",[t])},App.Delay.set(t,20,"task-"+e,void 0)},n.prototype.taskUpdateTrigger=function(){return App.Delay.set(this.taskUpdateLoop,2e3,"check_update_to_server_pending","task",!0)},n.prototype.taskUpdateLoop=function(){var t,e,n,i,s;if(!this.offlineModus){for(t in e=[],this.tasksToUpdate)if(t&&(n=this.get(t)))if("toUpdate"===this.tasksToUpdate[n.key]){if(this.tasksToUpdate[n.key]="inProgress",!(i=App.Taskbar.findByAttribute("key",n.key))){delete s.tasksToUpdate[this.key];continue}i.load(n),i.isOnline()?(s=this,e.push(i.save({done:function(){if("inProgress"===s.tasksToUpdate[this.key])return delete s.tasksToUpdate[this.key]},fail:function(){if(s.log("error","can't update task",this),"inProgress"===s.tasksToUpdate[this.key])return delete s.tasksToUpdate[this.key]}}))):e.push(void 0)}else e.push(void 0);return e}},n.prototype.taskDestroy=function(t){var e;if("inProgress"!==this.tasksToUpdate[t.key]&&"inCreate"!==this.tasksToUpdate[t.key]){if(delete this.tasksToUpdate[t.key],delete this.tasksPreferences[t.key],t.id&&App.Taskbar.exists(t.id))return App.Taskbar.destroy(t.id)}else App.Delay.set((e=this,function(){return e.taskDestroy(t)}),800,void 0,"task",!0)},n.prototype.tasksAutoCleanupDelay=function(){var t,e;return e=this,t=function(){return e.tasksAutoCleanup()},App.Delay.set(t,this.tasksAutoCleanupDelayTime,"task-autocleanup",void 0,!0)},n.prototype.tasksAutoCleanup=function(){var t,e,n,i,s,r,o,a;if(a=this,(t=function(){return Object.keys(a.allTasksByKey).length})()>this.maxTaskCount){for(i=[],e=0,n=(r=this.offlineModus?this.all():App.Taskbar.search({sortBy:"updated_at",order:"ASC"})).length;e<n;e++)if(s=r[e],t()>this.maxTaskCount)if(s.active)i.push(void 0);else if(o=App.TaskManager.worker(s.key)){if(o.changed&&o.changed())continue;this.log("notice","More then "+this.maxTaskCount+" tasks open, close oldest untouched task "+s.key),i.push(this.remove(s.key))}else i.push(void 0);else i.push(void 0);return i}},n.prototype.tasksInitial=function(){var t,e,n,i,s,r,o,a,l,c,p;for(this.init(),n=0,s=(c=App.Taskbar.all()).length;n<s;n++)(a=c[n]).active=!1,this.allTasksByKey[a.key]=a.attributes(),this.tasksPreferences[a.key]=a.preferences;if(App.Event.trigger("taskbar:init"),l=0,r=App.Config.get("permanentTask"))for(i in r)(t=r[i]).permission&&!this.permissionCheck(t.permission)||(l+=1,function(i){return function(t,e,n){return App.Delay.set(function(){return i.execute({key:t,controller:e.controller,params:{},show:!1,persistent:!0,init:!0})},350*n,void 0,"task",!0)}}(this)(i,t,l));for(i in o=this.allTasksByKey,p=this,e=function(t,e){return App.Delay.set(function(){return p.execute({key:t.key,controller:t.callback,params:t.params,show:!1,persistent:!1,init:!0})},350*e,void 0,"task",!0)},o)e(a=o[i],l+=1);return App.Event.trigger("taskbar:ready")},n.prototype.preferencesSubscribe=function(t,e){var n;return this.tasksPreferencesCallbacks[t]||(this.tasksPreferencesCallbacks[t]={}),n=""+t+Math.floor(999999*Math.random()),this.tasksPreferencesCallbacks[t][n]=e,n},n.prototype.preferencesUnsubscribe=function(t){var e,n,i,s,r,o;if(this.tasksPreferencesCallbacks){for(e in n=this.tasksPreferencesCallbacks)for(r in o=n[e])o[r],r===t&&delete o[r];for(e in s=[],i=this.tasksPreferencesCallbacks)o=i[e],_.isEmpty(o)?s.push(delete this.tasksPreferencesCallbacks[e]):s.push(void 0);return s}},n.prototype.preferencesTrigger=function(t){var e,n,i,s;if(this.tasksPreferencesCallbacks[t]&&this.tasksPreferences[t]){for(s in i=[],n=this.tasksPreferencesCallbacks[t])e=n[s],i.push(e(this.tasksPreferences[t]));return i}},n}(App.Controller)}.call(this),function(){var e,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.event="ticket_create_attributes",e.prototype.restEndpoint="/ticket_create",e}(App._CollectionSingletonBase),App.TicketCreateCollection=function(){function t(){}var n;return n=new e,t.get=function(){return n.get()},t.one=function(t,e){return null==e&&(e=!0),n.bind(t,e,!0)},t.bind=function(t,e){return null==e&&(e=!0),n.bind(t,e,!1)},t.unbind=function(t){return n.unbind(t)},t.unbindById=function(t){return n.unbindById(t)},t.trigger=function(){return n.trigger()},t.fetch=function(){return n.fetch()},t}()}.call(this),function(){var n,i=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;App.UserOrganizationAutocompletion=function(t){function e(){return this.buildObjectItem=i(this.buildObjectItem,this),this.newObject=i(this.newObject,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.objectSingle="User",e.prototype.objectIcon="user",e.prototype.inactiveObjectIcon="inactive-user",e.prototype.objectSingels="People",e.prototype.objectCreate="Create new Customer",e.prototype.referenceAttribute="member_ids",e.prototype.newObject=function(t){return t&&t.preventDefault(),new n({parent:this,container:this.el.closest(".content")})},e.prototype.buildObjectItem=function(t){var e,n;return n=t.displayName(),this.Config.get("ui_user_organization_selector_with_email")&&!_.isEmpty(t.email)&&(n+=" <"+t.email+">"),e=this.objectIcon,!1===t.active&&this.inactiveObjectIcon&&(e=this.inactiveObjectIcon),App.view(this.templateObjectItem)({realname:n,object:t,icon:e})},e}(App.ObjectOrganizationAutocompletion),n=function(t){function e(){return this.onSubmit=i(this.onSubmit,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.buttonClose=!0,e.prototype.buttonCancel=!0,e.prototype.buttonSubmit=!0,e.prototype.head="User",e.prototype.headPrefix="New",e.prototype.content=function(){return this.controller=new App.ControllerForm({model:App.User,screen:"edit",autofocus:!0}),this.controller.form},e.prototype.onSubmit=function(n){var t,e,i,s,r,o;if(!(e=this.formParam(n.target)).login&&e.email&&(e.login=e.email),!e.role_ids||_.isEmpty(e.role_ids)){for(i in s=[],App.Role.all())i&&!0===i.active&&!0===i.default_at_signup&&s.push(i.id);e.role_ids=s}return this.log("notice","updateAttributes",e),(o=new App.User).load(e),(t=o.validate())?(this.log("error",t),void this.formValidate({form:n.target,errors:t})):(r=this,o.save({done:function(){var t;return t=function(t){return r.parent.el.find("[name=customer_id]").val(t.id).trigger("change"),r.parent.close(),r.close()},App.User.full(this.id,t,!0)},fail:function(t,e){return r.log("errors",e),r.formEnable(n),r.controller.showAlert(e.error_human||e.error||"Unable to create object!")}}))},e}(App.ControllerModal)}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.templateName="user_ticket_list",e.prototype.fetch=function(n){return this.params.parentController.ajax({type:"GET",url:App.Config.get("api_path")+"/ticket_customer",data:{customer_id:n.user_id},processData:!0,success:(i=this,function(t){var e;return App.Collection.loadAssets(t.assets),e={open:t.ticket_ids_open,closed:t.ticket_ids_closed},i.callback({ticketsList:e,selector:n.selector})})});var i},e.prototype.build=function(t){if(this.checkPermissions())return this.fetch(t)},e.prototype.callback=function(t){return this.clear(this.popovers),this.popovers=this.buildPopovers(t)},e.prototype.buildTitleFor=function(t){return $(t).find('[title="*"]').val()},e.prototype.buildContentFor=function(t,e){var n,i;return i=$(t).filter("[data-type]").data("type"),n=(e.ticketsList[i]||[]).map(function(t){return App.Ticket.fullLocal(t)}),this.buildHtmlContent({ticketList:App.view("generic/ticket_list")({tickets:n,show_id:!0})})},e}(App.PopoverProvider),App.PopoverProvider.registerProvider("UserTicket",t)}.call(this),function(){var e=[].slice;App.Utils=function(){function t(){}return t.mapTagAttributes={TABLE:["align","bgcolor","border","cellpadding","cellspacing","frame","rules","sortable","summary","width","style"],TD:["abbr","align","axis","colspan","headers","rowspan","valign","width","style"],TH:["abbr","align","axis","colspan","headers","rowspan","scope","sorted","valign","width","style"],TR:["width","style"],A:["href","hreflang","name","rel"],IMG:["align","alt","border","height","src","srcset","width","style"]},t.mapCss={TABLE:["background","background-color","color","font-size","vertical-align","margin","margin-top","margin-right","margin-bottom","margin-left","padding","padding-top","padding-right","padding-bottom","padding-left","text-align","border","border-top","border-right","border-bottom","border-left","border-collapse","border-style","border-spacing","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style"],TH:["background","background-color","color","font-size","vertical-align","margin","margin-top","margin-right","margin-bottom","margin-left","padding","padding-top","padding-right","padding-bottom","padding-left","text-align","border","border-top","border-right","border-bottom","border-left","border-collapse","border-style","border-spacing","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color",
"border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style"],TR:["background","background-color","color","font-size","vertical-align","margin","margin-top","margin-right","margin-bottom","margin-left","padding","padding-top","padding-right","padding-bottom","padding-left","text-align","border","border-top","border-right","border-bottom","border-left","border-collapse","border-style","border-spacing","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style"],TD:["background","background-color","color","font-size","vertical-align","margin","margin-top","margin-right","margin-bottom","margin-left","padding","padding-top","padding-right","padding-bottom","padding-left","text-align","border","border-top","border-right","border-bottom","border-left","border-collapse","border-style","border-spacing","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style"],IMG:["width","height"]},t.textCleanup=function(t){return $.trim(t).replace(/(\r\n|\n\r)/g,"\n").replace(/\r/g,"\n").replace(/[ ]\n/g,"\n").replace(/\n{3,20}/g,"\n\n")},t.text2html=function(t){return t=this.textCleanup(t),(t="<div>"+(t=(t=(t=this.linkify(t)).replace(/(\n\r|\r\n|\r)/g,"\n")).replace(/  /g," &nbsp;")).replace(/\n/g,"</div><div>")+"</div>").replace(/<div><\/div>/g,"<div><br></div>")},t.html2text=function(t,e){return t?e?(t=t.replace(/([A-z])\n([A-z])/gm,"$1 $2").replace(/\n|\r/g,"").replace(/<(br|hr)>/g,"\n").replace(/<(br|hr)\/>/g,"\n").replace(/<\/(div|p|blockquote|form|textarea|address|tr)>/g,"\n"),$("<div>"+t+"</div>").text()):(t=(t=t.replace(/([A-z])\n([A-z])/gm,"$1 $2").replace(/>\n/g,">").replace(/\n|\r/g,"")).replace(/<(br|hr)>/g,"\n").replace(/<(br|hr)\/>/g,"\n").replace(/<(div)(|.+?)>/g,"").replace(/<(p|blockquote|form|textarea|address|tr)(|.+?)>/g,"\n").replace(/<\/(div|p|blockquote|form|textarea|address|tr)>/g,"\n"),$("<div>"+t+"</div>").text().trim().replace(/\n{3,20}/g,"\n\n")):t},t.linkify=function(t){return window.linkify(t)},t.phoneify=function(t){return _.isEmpty(t)?t:"tel:"+(t=t.replace(/[^0-9,\+,#,\*]+/g,"").replace(/(.)\+/,"$1"))},t.wrap=function(t,e){var n,i,s,r,o,a,l,c,p,u,h,d;for(null==e&&(e=82),h="",s=n=0,o=(l=t.split(/\n/)).length;s<o;s++){for(n+=1,d="",r=p=i=0,a=(u=l[s].split(/\s/)).length;r<a;r++)i+=1,p+(c=u[r]).length>e&&(p=0,d=d.trim(),h+=d+="\n",d=""),p+=c.length,d+=c,i!==u.length&&(p+=1,d+=" ");h+=d,d="",n!==l.length&&(h+="\n")}return h},t.quote=function(t,e){return null==e&&(e=82),t=this.textCleanup(t),t=this.wrap(t,e),$.trim(t).replace(/^(.*)$/gm,function(t){return t?"> "+t:">"})},t.escapeRegExp=function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},t.htmlEscape=function(t){return t&&t.replace?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):t},t.htmlStrip=function(t){for(var e,n,i;(n=t.get(0))&&(e=n.firstChild)&&1===e.nodeType&&"BR"===e.tagName&&e.remove;)e.remove();for(i=[];(n=t.get(0))&&(e=n.lastChild)&&1===e.nodeType&&"BR"===e.tagName&&e.remove;)i.push(e.remove());return i},t.htmlLastLineEmpty=function(t){var e,n;return!!(n=t.get(0))&&(!!(e=n.lastChild)&&(1===e.nodeType&&"BR"===e.tagName))},t.htmlRemoveTags=function(t){return t=this._checkTypeOf(t),this._removeComments(t),this._removeWordMarkup(t),t.find("div, span, p, li, ul, ol, a, b, u, i, label, small, strong, strike, pre, code, center, blockquote, form, fieldset, textarea, font, address, table, thead, tbody, tr, th, td, h1, h2, h3, h4, h5, h6").replaceWith(function(){return $(this).contents()}),t.find("div, span, p, li, ul, ol, a, b, u, i, label, small, strong, strike, pre, code, center, blockquote, form, fieldset, textarea, font, table, thead, tbody, tr, th, td, h1, h2, h3, h4, h5, h6, br, hr, img, svg, input, select, button, style, applet, embed, noframes, canvas, script, frame, iframe, meta, link, title, head").remove(),t},t.htmlRemoveRichtext=function(t,e){return null==e&&(e=!0),t&&(t=this._checkTypeOf(t),this._removeComments(t),this._removeWordMarkup(t),t.find("li, ul, ol, a, b, u, i, label, small, strong, strike, pre, code, center, blockquote, form, fieldset, textarea, font, address, table, thead, tbody, tr, th, td, h1, h2, h3, h4, h5, h6").replaceWith(function(){return $(this).contents()}),t.find("li, ul, ol, a, b, u, i, label, small, strong, strike, pre, code, center, blockquote, form, fieldset, textarea, font, address, table, thead, tbody, tr, th, td, h1, h2, h3, h4, h5, h6, hr, img, svg, input, select, button, style, applet, embed, noframes, canvas, script, frame, iframe, meta, link, title, head").remove(),this._removeAttributes(t,e)),t},t.htmlCleanup=function(t){var i;return t&&(t=this._checkTypeOf(t),this._removeComments(t),this._removeWordMarkup(t),this._stripDoubleDomainAnchors(t),t.find("font, small, time, form, label").replaceWith(function(){return $(this).contents()}),i="div",t.find("textarea").each(function(){var t,e,n;return e=this.outerHTML,n=new RegExp("<"+this.tagName,"i"),t=e.replace(n,"<"+i),n=new RegExp("</"+this.tagName,"i"),t=t.replace(n,"</"+i),$(this).replaceWith(t)}),t.find("font, svg, input, select, button, style, applet, embed, noframes, canvas, script, frame, iframe, meta, link, title, head, fieldset").remove(),this._cleanAttributes(t)),t},t._checkTypeOf=function(t){var e;if("string"!=typeof t)return t;try{return 1<(e=$(t)).length?$("<div>"+t+"</div>"):e&&e.get(0)?e:$("<div>"+t+"</div>")}catch(n){return n,$("<div>"+t+"</div>")}},t._cleanAttribute=function(t){var e,n,i,s,r,o,a,l,c,p,u,h,d,f,m;if(t){if(this.mapTagAttributes[t.nodeName])for(s=0,l=(n=t.attributes).length;s<l;s++)(e=n[s])&&e.name&&!_.contains(this.mapTagAttributes[t.nodeName],e.name)&&t.removeAttribute(e.name);else this._removeAttribute(t);if(this.mapCss[t.nodeName]){for(m="",r=0,c=(i=t.style).length;r<c;r++)m+=(h=i[r])+":"+i[h]+";";if(m&&m.split){for(f="",a=0,p=(d=m.split(";")).length;a<p;a++)(h=(u=d[a]).split(":"))[0]&&h[0].trim&&(o=h[0].trim(),_.contains(this.mapCss[t.nodeName],o)&&(f+=u+";"));return""!==f?t.setAttribute("style",f):t.removeAttribute("style")}}}},t._cleanAttributes=function(t,e){var n,i;return null==e&&(e=!0),e&&t.each((n=this,function(t,e){return n._cleanAttribute(e)})),t.find("*").each((i=this,function(t,e){return i._cleanAttribute(e)})),t},t._removeAttribute=function(t){var e,n,i,s,r;if(t){for(e=$(t),i=0,s=(r=t.attributes).length;i<s;i++)(n=r[i])&&n.name&&t.removeAttribute(n.name);return e.removeAttr("style").removeAttr("class").removeAttr("lang").removeAttr("type").removeAttr("align").removeAttr("id").removeAttr("wrap").removeAttr("title").removeAttrs(/data-/)}},t._removeAttributes=function(t,e){var n,i;return null==e&&(e=!0),e&&t.each((n=this,function(t,e){return n._removeAttribute(e)})),t.find("*").each((i=this,function(t,e){return i._removeAttribute(e)})),t},t._removeComments=function(t){return t.contents().each(function(){if(8===this.nodeType)return $(this).remove()}),t},t._removeWordMarkup=function(t){var e,n,i;return t.get(0)?(n=!1,e=t.get(0).outerHTML,i=new RegExp("<(/w|w):[A-Za-z]"),e.match(i)&&(n=!0,e=e.replace(i,"")),i=new RegExp("<(/o|o):[A-Za-z]"),e.match(i)&&(n=!0,e=e.replace(i,"")),n?window.word_filter(t):t):t},t._stripDoubleDomainAnchors=function(t){return t.find("a").each(function(){var t,e;if(null!=(e=$(this).attr("href")))return t=e.replace(/^https?:\/\/.*(?=(https?|#{config.http_type}):\/\/)/,""),e!==t?$(this).attr("href",t):void 0})},t.signatureCheck=function(t,e){var n,i,s;return n=(n=$("<div>"+t+"</div>").text().trim()).replace(/(\n|\r|\t)/g,""),s=(s=$("<div>"+e+"</div>").text().trim()).replace(/(\n|\r|\t)/g,""),i=new RegExp(function(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}(s),"mi"),!n.match(i)},t.signatureIdentifyByPlaintext=function(t,e,n){var a,i,s,r,o,l,c;if(null==e&&(e=!1),null==n&&(n=!1),c=(l=this.html2text(t)).split("\n"),!e&&c.length<10&&l.length<300)return t;if(r=function(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")},a=function(t){return t.match(/(<|>|&)/)&&(t=t.replace(/(.+?)(<|>|&).+?$/,"$1").trim()),t},function(t,e){var n,i,s,r,o;for(n=r=0,i=t.length;n<i;n++)if(r+=1,(s=t[n])&&s.match(/^\s{0,10}--\s{0,10}$/))return o={line:s,lineCount:r,type:"separator"},void e.push(o)}(c,s=[]),function(t,e){var n,i,s,r,o;for(n=r=0,i=t.length;n<i;n++){if(r+=1,(s=t[n])&&s.match(/^(Am)\s.{6,20}\s(um)\s.{3,10}\s(schrieb)\s.{1,250}:/))return o={line:a(s),lineCount:r,type:"thunderbird"},void e.push(o);if(s&&s.match(/^(On)\s.{6,20}\s.{3,10},\s.{1,250}(wrote):/))return o={line:a(s),lineCount:r,type:"thunderbird"},void e.push(o);if(s&&s.match(/^.{1,250}\s(wrote),\son\s.{3,20}:/))return o={line:a(s),lineCount:r,type:"thunderbird"},void e.push(o)}}(c,s),function(t,e){var n,i,s,r,o;for(n=r=0,i=t.length;n<i;n++){if(r+=1,(s=t[n])&&s.match(/^(On)\s.{6,20}\s.{3,10}\s.{1,250}\s(wrote):/))return o={line:a(s),lineCount:r,type:"apple"},void e.push(o);if(s&&s.match(/^(Am)\s.{6,20}\s(um)\s.{3,10}\s(schrieb)\s.{1,250}:/))return o={line:a(s),lineCount:r,type:"apple"},void e.push(o)}}(c,s),function(t,e){var n,i,s,r,o;for(n=r=0,i=t.length;n<i;n++)if(r+=1,(s=t[n])&&s.match(/^.{6,10}\s.{3,10}\s-\s.{1,250}\s(wrote|schrieb|a \xe9crit|escribi\xf3):/))return o={line:a(s),lineCount:r,type:"Otrs"},void e.push(o)}(c,s),function(t,e){var n,i,s,r,o,a,l,c;for(i=void(a=0),c=5,s=n=0,r=t.length;s<r;s++)if(o=t[s],a+=1,i){if(o&&o.match(/^(Subject|Betreff|Objet)(\s|):\s.+?/))return l={line:i,lineCount:a,type:"Ms"},void e.push(l);n+c<a&&(i=void 0)}else o&&o.match(/^(From|Von|De)(\s|):\s.+?/)&&(i=o.replace(/\s{0,5}(\[|<).+?(\]|>)/g,""),n=a)}(c,s),function(t,e){var n,i,s,r,o;for(n=r=0,i=t.length;n<i;n++)if(r+=1,(s=t[n])&&s.match(/^.{1,250}\s(wrote|schrieb|a \xe9crit|escribi\xf3):/))return o={line:a(s),lineCount:r,type:"Word14"},void e.push(o)}(c,s),function(t,e){var n,i,s,r,o;for(n=r=0,i=t.length;n<i;n++)if(r+=1,(s=t[n])&&s.match(/.{1,250}\s(wrote|schrieb|a \xe9crit|escribi\xf3)\s.{1,250}:/))return o={line:a(s),lineCount:r,type:"gmail"},void e.push(o)}(c,s),i='<span class="js-signatureMarker"></span>',!s||!s[0]||n){if(o=new RegExp('(<div data-signature="true" data-signature-id=".{1,5}">)'),t.match(o))return t.replace(o,i+"$1");if(o=new RegExp('(<div data-signature-id=".{1,5}" data-signature="true">)'),t.match(o))return t.replace(o,i+"$1")}return(s&&s[0]||(o=new RegExp('(<blockquote type="cite">)'),!t.match(o)))&&(s&&s[0]||(o=new RegExp('(<blockquote class="(ecxgmail_quote|gmail_quote)">)'),!t.match(o)))?s&&s[0]?"separator"===(s=_.sortBy(s,"lineCount"))[0].type?(o=new RegExp(">(s{0,10}"+r(App.Utils.htmlEscape(s[0].line))+")s{0,10}<"),t.replace(o,">"+i+"$1<")):(o=new RegExp(">(s{0,10}"+r(App.Utils.htmlEscape(s[0].line))+")"),t.replace(o,">"+i+"$1")):t:t.replace(o,i+"$1")},t.isMicrosoftOffice=function(t){var e;return e=new RegExp("-----(Urspr\xfcngliche Nachricht|Original Message|Mensaje original|Message d'origine|Messaggio originale|\u90ae\u4ef6\u539f\u4ef6|\u539f\u59cb\u90f5\u4ef6)-----"),t.match(e)},t.signatureIdentifyByHtml=function(t){var e,n,i;return this.isMicrosoftOffice(t)?this.signatureIdentifyByPlaintext(t):1===(e=$($.parseHTML(t))).length&&(null!=(n=$(e[0]))&&null!=(i=n.children())?i.length:void 0)?(e[0].innerHTML=this.signatureIdentifyByHtmlHelper(e[0].innerHTML),e[0].outerHTML):this.signatureIdentifyByHtmlHelper(t)},t.signatureIdentifyByHtmlHelper=function(t,e){var i,s,r,n,o,a,l;return null==e&&(e=!1),s=[],i=[],l=[],r=function(t){var e;return"BLOCKQUOTE"===(e=(t=$(t)).prop("tagName"))||(!("DIV"!==e||!t.data("signature")&&"yahoo_quoted"!==t.prop("class"))||_.some(t.children(),function(t){return r(t)}))},$("<div/>").html(t).contents().each(function(t,e){var n;if(n=$(e).text(),e.nodeType===Node.TEXT_NODE){if(l.push($("<div>").text(n).html()),n.trim().length)return i.push(t)}else if(e.nodeType===Node.ELEMENT_NODE){if(l.push(e.outerHTML),r(e))return s.push(t);if(n.trim().length)return i.push(t)}}),a=_.max(i||0),(s=_.filter(s,function(t){return a<=t})).length?(n=_.min(s),o='<span class="js-signatureMarker"></span>',l.splice(n,0,o),l.join("")):t},t.replaceTags=function(t,h,d){return null==d&&(d=!1),t.replace(/#\{\s{0,2}(.+?)\s{0,2}\}/g,function(t,e){var n,i,s,r,o,a,l,c,p,u;for(l=(e=e.replace(/<.+?>/g,"")).split(/\./),i=h,s=void 0,r=0,o=l.length;r<o;r++){if(a=l[r],!("object"==typeof i&&a in i)){i="";break}i=(s=i)[a]}return u=void 0,"function"==typeof i?u=i():null!=i&&i.toString?((null!=s&&null!=(p=s.constructor)?p.className:void 0)&&(null!=(c=App[s.constructor.className])?c.attributesGet:void 0)&&(null!=(n=c.attributesGet())?n[a]:void 0)&&("datetime"===n[a].tag?u=App.i18n.translateTimestamp(i):"date"===n[a].tag&&(u=App.i18n.translateDate(i))),u||(u=i.toString())):u="",""===u&&(u="-"),d&&(u=encodeURIComponent(u)),u})},t.removeEmptyLines=function(t){return t.replace(/^\s*[\r\n]/gm,"")},t.htmlAttributeCleanup=function(t){return t.replace(/((?![-a-zA-Z0-9_]+).|\n|\r|\t)/gm,"")},t.formDiff=function(t,e){var n,i;return i=clone(t),this._formDiffNormalizer(i),n=clone(e),this._formDiffNormalizer(n),this._formDiffChanges(i,n)},t._formDiffChanges=function(t,e,n){var i,s;for(i in null==n&&(n={}),t)t[i],t[i]!==e[i]&&(_.isArray(t[i])&&_.isArray(e[i])?(s=_.difference(t[i],e[i]),_.isEmpty(s)||(n[i]=s)):_.isObject(t[i])&&_.isObject(e[i])?n=this._formDiffChanges(t[i],e[i],n):""===t[i]&&null==e[i]||(n[i]=t[i]));return n},t._formDiffNormalizer=function(t){var e,n,i,s,r,o;if(void 0!==t){if(_.isArray(t)){for(r=[],e=n=0,s=t.length;0<=s?n<s:s<n;e=0<=s?++n:--n)r.push(t[e]=this._formDiffNormalizer(t[e]));return r}if(_.isObject(t)){for(i in o=[],t)t[i],_.isArray(t[i])?o.push(this._formDiffNormalizer(t[i])):_.isObject(t[i])?o.push(this._formDiffNormalizer(t[i])):o.push(t[i]=this._formDiffNormalizerItem(i,t[i]));return o}return this._formDiffNormalizerItem("",t)}},t._formDiffNormalizerItem=function(t,e){return"owner_id"===t&&"1"===e.toString()?e="":"number"==typeof e?e=e.toString():null===e&&(e=void 0),e},t.checkAttachmentReference=function(t){var e,n,i,s,r,o,a,l;if(!t)return!1;for((a=$("<div>"+t+"</div>")).find("blockquote").remove(),o=a.text(),i=0,s=(r=["Attachment","attachment","Attached","attached","Enclosed","enclosed","Enclosure","enclosure"]).length;i<s;i++){if(l=r[i],n=new RegExp("\\W"+l+"\\W","i"),o.match(n))return l;if(e=App.i18n.translateContent(l),n=new RegExp("\\W"+e+"\\W","i"),o.match(n))return e}return!1},t.humanFileSize=function(t){return 1048576<t?t=Math.round(10*t/1048576)/10+" MB":1024<t?t=Math.round(t/1024)+" KB":t+=" Bytes",t},t.decimal=function(t,e){var n,i;return null==e&&(e=2),void 0===t?"":null===t?"":(t.toString&&(t=t.toString()),""===t?t:t.match(/[A-z]/)?t:(n=function(t,e){for(;t.toString().length<e;)t+="0";return t},(i=t.match(/^(.+?)\.(.+?)$/))&&i[2]?0<e-i[2].length?i[1]+"."+n(i[2],e):i[1]+"."+i[2].substr(0,e):t+"."+n(0,e)))},t.sortByValue=function(t,e){var n,i,s,r,o,a,l,c,p;for(s in null==e&&(e="ASC"),n=[],i={},t)p=(c=t[s]).toString().toLowerCase(),n.push(p),i[p]=[s,c];for(n=n.sort(),"DESC"===e&&(n=n.reverse()),a={},r=0,o=n.length;r<o;r++)a[(l=i[s=n[r]])[0]]=l[1];return a},t.sortByKey=function(t,e){var n,i,s,r,o,a;for(i in null==e&&(e="ASC"),n=[],t)t[i],s=i.toString?i.toString().toLowerCase():i,n.push(s);for(n=n.sort(),"DESC"===e&&(n=n.reverse()),a={},r=0,o=n.length;r<o;r++)a[i=n[r]]=t[i];return a},t.formatTime=function(t,e){if(void 0===t)return"";if(null===t)return"";for(t.toString&&(t=t.toString());t.length<e;)t="0"+t;return t},t.icon=function(t,e){var n,i,s,r;if(null==e&&(e=""),t){if(n={ltr:{start:"left",end:"right"},rtl:{start:"right",end:"left"}},0<t.indexOf("{"))for(i in s=n[App.i18n.dir()])r=s[i],t=t.replace("{"+i+"}",r);return'<svg class="icon icon-'+t+" "+e+'"><use xlink:href="'+(window.svgPolyfill?"":"assets/images/icons.svg")+"#icon-"+t+'" /></svg>'}},t.fontIcon=function(t,e,n){return null==n&&(n=""),this.loadIconFont(e),'<i class="icon '+n+'" data-font="'+e+'">'+String.fromCharCode("0x"+t)+"</i>"},t.loadIconFont=function(t){var e;if(!$('[data-icon-font="'+t+'"]').length)return e="@font-face {\n  font-family: '"+t+"';\n  src: url('"+("assets/icon-fonts/"+t+".woff")+"');\n  font-weight: normal;\n  font-style: normal;\n}\n\n[data-font=\""+t+"\"] {\n  font-family: '"+t+"';\n}",$('<style data-icon-font="'+t+'">').appendTo("head").text(e)},t.loadIconFontInfo=function(t,e){return $.getJSON("assets/icon-fonts/"+t+".json",function(t){return e(t.icons)})},t.getScrollBarWidth=function(){var t,e;return t=$("<div>").css({visibility:"hidden",width:100,overflow:"scroll"}).appendTo("body"),e=$("<div>").css({width:"100%"}).appendTo(t).outerWidth(),t.remove(),100-e},t.diffPositionAdd=function(t,e){var n,l;return!!(l=function(t,e,n){var i,s,r,o,a;for(s in e)if(t[s]!==e[s]){if(o=parseInt(s),_.contains(t,e[s]))return!1;for(r in t.splice(o,0,e[s]),a=0,t)if(e[r]===e[s]){a=parseInt(r);break}i={position:a,id:e[s]},n.push(i),l(t,e,n)}return!0})(t,e,n=[])&&n},t.textLengthWithUrl=function(t,e){var n;return null==e&&(e=23),t?(n=Array(e+1).join("X"),(t=t.replace(/http(s|):\/\/[-A-Za-z0-9+&@#\/%?=~_\|!:,.;]+[-A-Za-z0-9+&@#\/%=~_|]/gim,n)).length):0},t.parseAddressListLocal=function(t){var e,n,i,s,r,o,a,l,c;if(l=emailAddresses.parseAddressList(t),c=[],!_.isEmpty(l)){for(e=0,i=l.length;e<i;e++)(a=l[e])&&a.address&&c.push(a.address);return c}if(_.isEmpty(l)&&t.match("@"))for(o=/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/,n=0,s=(l=t.split(",")).length;n<s;n++)(a=l[n])&&a.match("@")&&(r=a.match(o))&&r[0]&&c.push(r[0]);return c},t.contentTypeCleanup=function(t){return t?t=t.replace(/^(.+?\/.+?)(\b|\s).+?$/,"$1"):t},t.getRecipientArticle=function(t,e,n,i,s,r){var o,a,l,c,p,u,h,d,f,m,g,v,y,b,w,k,T,A,S,C,x;if(null==s&&(s=[]),l={to:"",cc:"",body:"",in_reply_to:""},e.message_id&&(l.in_reply_to=e.message_id),"phone"===i.name)return"Agent"===e.sender.name?(null!=(T=e.to)?T.match(/@/):void 0)&&(l.to=e.to):(null!=(A=e.from)?A.match(/@/):void 0)&&(l.to=App.Utils.parseAddressListLocal(e.from).join(", ")),(l.to&&!l.to.match(/@/)||!l.to)&&(l.to=t.customer.email),l;if("email"===i.name||"web"===i.name){for(v=[],u=0,f=s.length;u<f;u++)(a=s[u])&&!_.isEmpty(a.email)&&v.push(a.email.toString().toLowerCase());if(p=function(t){return!_.isEmpty(t)&&_.contains(v,t.toString().toLowerCase())},c=void 0,n&&n.email&&(c=n.email.toLowerCase()),C=!1,!_.isEmpty(e.from)&&(x=App.Utils.parseAddressListLocal(e.from)))for(h=0,m=x.length;h<m;h++)(S=x[h])&&S.match("@")&&(C=p(S));if(w=!1,!_.isEmpty(e.to)&&(k=App.Utils.parseAddressListLocal(e.to))&&k[0])for(d=0,g=k.length;d<g&&(y=k[d],!0!==(w=p(y)));d++);C?l.to=e.to:"Agent"===e.sender.name&&c&&e.from&&e.from.toString().toLowerCase().match(c)&&!w?l.to=e.to:(e.reply_to?l.to=e.reply_to:l.to=e.from,l.to&&!l.to.match(/@/)&&(l.to=e.created_by.email)),b={},o=function(t,e){return k=(k=App.Utils.parseAddressListLocal(t)).map(function(t){return t.toString().toLowerCase()}),k=_.reject(k,function(t){return _.isEmpty(t)}),k=_.reject(k,function(t){return p(t)}),k=_.reject(k,function(t){return b[t]}),k=_.each(k,function(t){return b[t]=!0}),_.isEmpty(e)||k.push(e),(k=k.map(function(t){return t.replace(/'(\S+@\S+\.\S+)'/,"$1")})).join(", ")},l.to&&(l.to=o(l.to)),r&&(e.from&&(l.to=o(e.from,l.to)),e.to&&(l.to=o(e.to,l.to)),e.cc&&(l.cc=o(e.cc,l.cc)))}return l},t.tokanice=function(t,e){var n,i;return i=App.Config.get("api_path")+"/users/search",n=function(){return $(t).tokenfield({createTokensOnBlur:!0,autocomplete:{source:i,minLength:2}}).on("tokenfield:createtoken",function(t){return"email"===e&&!t.attrs.value.match(/@/)||t.attrs.value.match(/\s/)?(t.preventDefault(),!1):(t.attrs.label=t.attrs.value,!0)})},App.Delay.set(n,500,void 0,"tags")},t.htmlImage2DataUrl=function(t){return t&&t.match(/<img/i)?((t=this._checkTypeOf("<div>"+t+"</div>")).find("img").each(function(){var t,e;if(null!=(e=$(this).attr("src"))&&!e.match(/^(data|cid):/i))return t=App.Utils._htmlImage2DataUrl(this),$(this).attr("src",t)}),t.get(0).innerHTML):t},t._htmlImage2DataUrl=function(t,e){var n,i,s;null==e&&(e={}),(n=document.createElement("canvas")).width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0);try{return i=n.toDataURL("image/png"),e.success&&e.success(t,i),i}catch(r){s=r,App.Log.notice("Utils","Can't insert image from "+t.src,s),e.fail&&e.fail(t)}},t.htmlImage2DataUrlAsyncInline=function(t,i){return null==i&&(i={}),t.find("img").each(function(){var t;if(null!=(t=$(this).attr("src"))&&!t.match(/^(data|cid):/i))return App.Utils._htmlImage2DataUrlAsync(this,{success:function(t,e){var n;if((n=$(t)).attr("src",e),n.css("max-width","100%"),i.success)return i.success(t,e)},fail:function(t){if(t.remove(),i.fail)return i.fail(t)}})})},t.htmlImage2DataUrlAsync=function(t,e){var i,s,r;return r=this._checkTypeOf("<div>"+t+"</div>"),s=r.find("img").toArray().filter(function(t){return!t.src.match(/^(data|cid):/i)}),(i=function(){var n;return(n=s.pop())?App.Utils._htmlImage2DataUrlAsync(n,{success:function(t,e){return $(n).attr("src",e),i()},fail:function(){return $(n).remove(),i()}}):e(r[0].innerHTML)})()},t._htmlImage2DataUrlAsync=function(t,e){var n;return null==e&&(e={}),(n=new Image).crossOrigin="anonymous",n.onload=function(){return App.Utils._htmlImage2DataUrl(t,e)},n.onerror=function(){if(App.Log.notice("Utils","Unable to load image from "+t.src),e.fail)return e.fail(t)},n.src=t.src},t.baseUrl=function(){var t,e;return t=App.Config.get("fqdn"),e=App.Config.get("http_type"),t&&"zammad.example.com"!==t?e+"://"+t:window.location.origin},t.joinUrlComponents=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],Array.isArray(t[0])&&(t=t[0]),t.filter(function(t){return null!=t}).join("/")},t.clipboardHtmlIsWithText=function(t){var e;return!!t&&(!(!(e=jQuery(jQuery.parseHTML(t)))||!e.text)&&0!==e.text().trim().length)},t.clipboardHtmlInsertPreperation=function(t,e){var n,i,s,r;return!(i=(n="textonly"===e.mode?e.multiline?App.Utils.htmlRemoveRichtext(t):App.Utils.htmlRemoveTags(t):App.Utils.htmlCleanup(t)).html())&&n&&n.text&&n.text()&&(i=App.Utils.text2html(n.text())),i&&""!==i||((s=jQuery(jQuery.parseHTML(t)))&&(r=s.text().trim()),r&&(i=App.Utils.text2html(r))),i},t}()}.call(this),function(){var a,n,l=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.WebSocket=function(){function t(){}var e;return e=void 0,t.connect=function(){return void 0===e&&null==e&&(e=new n),e},t.close=function(t){return void 0===e&&null==e&&(e=new n),e.close(t)},t.send=function(t){return void 0===e&&null==e&&(e=new n),e.send(t)},t.auth=function(t){return void 0===e&&null==e&&(e=new n),e.auth(t)},t.channel=function(){return void 0===e&&null==e&&(e=new n),e.channel()},t._spool=function(){return void 0===e&&null==e&&(e=new n),e.spool()},t.support=function(){return void 0===e&&null==e&&(e=new n),e.support()},t.queue=function(){return void 0===e&&null==e&&(e=new n),e.queue},t}(),n=function(t){function o(t){var e,n,i,s,r;this.args=t,this._ajaxReceive=l(this._ajaxReceive,this),this._ajaxSendQueue=l(this._ajaxSendQueue,this),this._ajaxSend=l(this._ajaxSend,this),this._ajaxInit=l(this._ajaxInit,this),this._receiveMessage=l(this._receiveMessage,this),this.connect=l(this.connect,this),this.ping=l(this.ping,this),this.close=l(this.close,this),this.spool=l(this.spool,this),this.auth=l(this.auth,this),this.send=l(this.send,this),o.__super__.constructor.apply(this,arguments),this.backend=this.Config.get("websocket_backend")||"websocket",App.Event.bind("auth",(e=this,function(){return e.auth()}),"ws"),App.Event.bind("ws:send",(n=this,function(t){return n.send(t)}),"ws"),App.Event.bind("ws:login",(i=this,function(){return i.spool()}),"ws"),App.Event.bind("spool:sent",(s=this,function(t){return s.lastSpoolMessage=t.timestamp,s.sentSpoolFinished=!0,App.Delay.clear("reset-spool-sent-if-not-returned","ws")}),"ws"),this.connect(),$(document).bind("visibilitychange",(r=this,function(){if(r.log("debug","visibilitychange"),!document.hidden&&r.connectionEstablished)return r.log("debug","ping"),r.ping()}))}return i(o,t),o.include(App.LogInclude),o.prototype.queue=[],o.prototype.supported=!0,o.prototype.lastSpoolMessage=void 0,o.prototype.sentSpoolFinished=!0,o.prototype.connectionKeepDown=!1,o.prototype.connectionEstablished=!1,o.prototype.connectionWasEstablished=!1,o.prototype.tryToConnect=!1,o.prototype.backend=void 0,o.prototype.backend_port="",o.prototype.client_id=void 0,o.prototype.error=!1,o.prototype.channel=function(){if(this.connectionEstablished)return this.backend},o.prototype.support=function(){return this.supported},o.prototype.send=function(t){var e;return"ajax"===this.backend?this._ajaxSend(t):1!==this.ws.readyState?this.queue.push(t):(e=JSON.stringify(t),this.ws.send(e))},o.prototype.auth=function(t){if(this.supported)return t={event:"login",session_id:App.Config.get("session_id"),fingerprint:App.Browser.fingerprint()},this.send(t)},o.prototype.spool=function(){var t,e,n;if(this.sentSpoolFinished)return this.sentSpoolFinished=!1,t={event:"spool"},this.lastSpoolMessage&&(t.timestamp=this.lastSpoolMessage),this.log("debug","spool",t),n=this,e=function(){return n.sentSpoolFinished=!0},App.Delay.set(e,6e4,"reset-spool-sent-finished-if-not-returned","ws"),this.send(t)},o.prototype.close=function(t){if(null==t&&(t={}),t.force&&(this.connectionKeepDown=!0),"ajax"!==this.backend)return this.ws.close()},o.prototype.ping=function(){var t,e;if("ajax"!==this.backend)return this.log("debug","send websocket ping"),this.send({event:"ping"}),App.Delay.clear("websocket-ping-check","ws"),e=this,t=function(){return e.log("debug","no websocket ping response, reconnect..."),e.close()},App.Delay.set(t,9e4,"websocket-ping-check","ws")},o.prototype.pong=function(){if("ajax"!==this.backend)return this.log("debug","received websocket pong"),App.Delay.set(this.ping,6e4,"websocket-pong","ws")},o.prototype.connect=function(){var s,t,r,n,e,i;return window.WebSocket?(t="ws://","https:"===window.location.protocol&&(t="wss://"),"websocket"===this.backend?(s="",window.location.port&&""!==window.location.port&&(s=":"+window.location.port),this.ws=new window.WebSocket(""+t+window.location.hostname+s+"/ws")):"websocketPort"===this.backend?(this.backend_port=App.Config.get("websocket_port")||"6042",this.ws=new window.WebSocket(""+t+window.location.hostname+":"+this.backend_port+"/")):this._ajaxInit(),this.ws.onopen=(r=this,function(){var t,e,n,i;for(r.backend_port&&(s=":"+r.backend_port),r.log("debug","new websocket ("+r.channel()+s+") connection open"),r.connectionEstablished=!0,r.connectionWasEstablished=!0,App.Delay.clear("websocket-no-connection-try-reconnect-message","ws"),r.error&&(r.error.close(),r.error=!1,r.tryToConnect=!1),r.auth(),t=0,n=(i=r.queue).length;t<n;t++)e=i[t],r.log("debug","empty ws queue",e),r.send(e);return r.queue=[],App.Delay.set(r.ping,6e4,"websocket-send-ping-to-heck-connection","ws")}),this.ws.onmessage=(n=this,function(t){var e;return e=JSON.parse(t.data),n.log("debug","ws:onmessage",e),n._receiveMessage(e)}),this.ws.onclose=(e=this,function(){var t;if(e.log("debug","close websocket connection"),!e.connectionKeepDown){if(e.connectionEstablished&&(e.connectionEstablished=!1),!e.connectionWasEstablished){if("websocket"===e.backend)return e.log("debug","no websocket connection on /ws, use :port/"),e.backend="websocketPort",void e.connect();if("websocketPort"===e.backend)return e.backend_port&&(s=":"+e.backend_port),e.log("debug","no websocket connection on port "+s+", use ajax long polling as fallback"),e.backend="ajax",void e.connect()}return e.error||(t=function(){return e.error=new a},e.tryToConnect||App.Delay.set(t,7e3,"websocket-no-connection-try-reconnect-message","ws"),e.tryToConnect=!0),App.Delay.set(e.connect,4500,"websocket-try-reconnect-after-x-sec","ws")}}),this.ws.onerror=(i=this,function(t){return i.log("debug","ws:onerror",t)})):(this.supported=!1,this.backend="ajax",this.log("debug","no support of websocket, use ajax long polling"),void this._ajaxInit())},o.prototype._receiveMessage=function(t){var e,n,i,s;for(null==t&&(t=[]),s=[],e=0,i=t.length;e<i;e++)n=t[e],this.log("debug","onmessage",n),n.spool&&(this.lastSpoolMessage=Math.round(+new Date/1e3)),"pong"===n.event&&this.pong(),n.event?(this.log("debug","onmessage event: "+n.event),s.push(App.Event.trigger(n.event,n.data))):s.push(void 0);return s},o.prototype._ajaxInit=function(t){var e,n;if(null==t&&(t={}),!this._ajaxInitDone||t.force)return App.Ajax.request({id:"ws-login",type:"POST",url:this.Config.get("api_path")+"/message_send",data:JSON.stringify({data:{event:"login"}}),processData:!1,queue:!1,success:(n=this,function(t){return t.client_id&&(n.log("debug","ajax:new client_id",t.client_id),n.client_id=t.client_id,n._ajaxReceive(),n._ajaxSendQueue()),n._ajaxInitDone=!0}),error:(e=this,function(){var t;return e._ajaxInitDone=!0,t=function(){return e._ajaxInit({force:!0})},App.Delay.set(t,1e4,"_ajaxInit-reconnect-on-error","ws")})})},o.prototype._ajaxSend=function(t){return this.log("debug","ajax:sendmessage",t),this.client_id&&void 0!==this.client_id&&this._ajaxInitDone?(this.queue.push(t),this._ajaxSendQueue()):(this._ajaxInit(),this.queue.push(t))},o.prototype._ajaxSendQueue=function(){var t,e;for(e=[];!_.isEmpty(this.queue);)t=this.queue.shift(),e.push(App.Ajax.request({type:"POST",url:this.Config.get("api_path")+"/message_send",data:JSON.stringify({client_id:this.client_id,data:t}),processData:!1,queue:!0,success:function(e){return function(t){if(t&&t.error)return e.client_id=void 0,e._ajaxInit({force:!0})}}(this),error:function(t){return function(){return t.client_id=void 0,t._ajaxInit({force:!0})}}(this)}));return e},o.prototype._ajaxReceive=function(){var t,e;if(this.client_id&&!0!==this._ajaxReceiveWorking)return this._ajaxReceiveWorking=!0,App.Ajax.request({id:"message_receive",type:"POST",url:this.Config.get("api_path")+"/message_receive",data:JSON.stringify({client_id:this.client_id}),processData:!1,success:(e=this,function(t){return e.log("debug","ajax:onmessage",t),e._receiveMessage(t),t&&t.error&&(e.client_id=void 0,e._ajaxInit({force:!0})),e._ajaxReceiveWorking=!1,e._ajaxReceive()}),error:(t=this,function(){return t.client_id=void 0,t._ajaxInit({force:!0}),t._ajaxReceiveWorking=!1})})},o}(App.Controller),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.buttonClose=!1,e.prototype.buttonCancel=!1,e.prototype.buttonSubmit=!1,e.prototype.backdrop="static",e.prototype.keyboard=!1,e.prototype.head="Lost network connection!",e.prototype.content=function(){return"Trying to reconnect..."},e}(App.ControllerModal)}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;App.SearchableAjaxSelect=function(t){function l(){this.showLoader=e(this.showLoader,this),this.renderResponse=e(this.renderResponse,this),this.onInput=e(this.onInput,this),l.__super__.constructor.apply(this,arguments),this.searchResultCache={}}return n(l,t),l.prototype.onInput=function(t){var e,n,i,s,r,o,a;return l.__super__.onInput.apply(this,arguments),i=underscored(this.options.attribute.object),s=this.input.val(),n=i+"+"+s,this.searchResultCache[n]?(App.Ajax.abort(this.options.attribute.id),void this.renderResponse(this.searchResultCache[n],s)):(this.loaderTimeoutId||(this.loaderTimeoutId=setTimeout(this.showLoader,1e3)),e={id:this.options.attribute.id,type:"GET",url:App.Config.get("api_path")+"/search/"+i,data:{query:s,limit:this.options.attribute.limit},processData:!0,success:(a=this,function(t){return a.searchResultCache[n]=t,a.renderResponse(t,s)})},(null!=(r=this.delegate)?r.getAjaxAttributes:void 0)&&(e=null!=(o=this.delegate)&&"function"==typeof o.getAjaxAttributes?o.getAjaxAttributes(this,e):void 0),App.Ajax.request(e))},l.prototype.renderResponse=function(e,t){var n,i;return clearTimeout(this.loaderTimeoutId),this.loaderTimeoutId=void 0,this.el.removeClass("is-loading"),App.Collection.loadAssets(e.assets),n=e.result.map((i=this,function(t){return i.useAjaxDetails?i.renderResponseItemAjax(t,e):i.renderResponseItem(t)})).filter(function(t){return null!=t}),this.optionsList.html(this.renderOptions(n)),this.refreshElements(),
this.filterByQuery(t)},l.prototype.renderResponseItemAjax=function(e,t){var n;if(n=_.find(t.details,function(t){return t.type===e.type&&t.id===e.id}))return{name:n.title,value:e.id}},l.prototype.renderResponseItem=function(t){var e,n;if(e=null!=(n=App[t.type.replace(/::/g,"")])?n.find(t.id):void 0)return{name:e instanceof App.Ticket?"#"+e.number+" - "+e.title:e.displayName(),value:e.id}},l.prototype.showLoader=function(){return this.el.addClass("is-loading")},l}(App.SearchableSelect)}.call(this);window.console||(window.console={}),console.log||(console.log=function(){}),Date.prototype.getWeek=function(){var t=new Date(this.getFullYear(),0,1);return Math.ceil(((this-t)/864e5+t.getDay()+1)/7)},jQuery.event.special.remove={remove:function(t){t.handler&&t.handler()}},$("body").on("click",".checkbox-replacement, .radio-replacement",function(t){$(t.currentTarget).find("input").addClass("is-active")}),$("body").on("blur",".checkbox-replacement input, .radio-replacement input",function(){$(this).removeClass("is-active")}),jQuery.fn.removeAttrs=function(i){return this.each(function(){var n=$(this);$.each(this.attributes,function(t,e){e&&e.specified&&i.test(e.name)&&n.removeAttr(e.name)})})},jQuery.fn.extend({serializeArrayWithType:function(){var r=/\r?\n/g,e=/^(?:submit|button|image|reset|file)$/i,n=/^(?:input|select|textarea|keygen)/i,i=/^(?:checkbox|radio)$/i;return this.map(function(){var t=jQuery.prop(this,"elements");return t?jQuery.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&n.test(this.nodeName)&&!e.test(t)&&(this.checked||!i.test(t))}).map(function(t,e){var n=jQuery(this),i=n.val(),s=n.data("field-type");return null==i?n.prop("multiple")?{name:e.name,value:null,type:s}:null:jQuery.isArray(i)?jQuery.map(i,function(t){return{name:e.name,value:t.replace(r,"\r\n"),type:s}}):{name:e.name,value:i.replace(r,"\r\n"),type:s}}).get()}}),jQuery(function(){new App.Run});